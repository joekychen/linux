<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › net › wireless › ath › ath6kl › core.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>core.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright (c) 2010-2011 Atheros Communications Inc.</span>
<span class="cm"> * Copyright (c) 2011-2012 Qualcomm Atheros, Inc.</span>
<span class="cm"> *</span>
<span class="cm"> * Permission to use, copy, modify, and/or distribute this software for any</span>
<span class="cm"> * purpose with or without fee is hereby granted, provided that the above</span>
<span class="cm"> * copyright notice and this permission notice appear in all copies.</span>
<span class="cm"> *</span>
<span class="cm"> * THE SOFTWARE IS PROVIDED &quot;AS IS&quot; AND THE AUTHOR DISCLAIMS ALL WARRANTIES</span>
<span class="cm"> * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF</span>
<span class="cm"> * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR</span>
<span class="cm"> * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES</span>
<span class="cm"> * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN</span>
<span class="cm"> * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF</span>
<span class="cm"> * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef CORE_H</span>
<span class="cp">#define CORE_H</span>

<span class="cp">#include &lt;linux/etherdevice.h&gt;</span>
<span class="cp">#include &lt;linux/rtnetlink.h&gt;</span>
<span class="cp">#include &lt;linux/firmware.h&gt;</span>
<span class="cp">#include &lt;linux/sched.h&gt;</span>
<span class="cp">#include &lt;linux/circ_buf.h&gt;</span>
<span class="cp">#include &lt;net/cfg80211.h&gt;</span>
<span class="cp">#include &quot;htc.h&quot;</span>
<span class="cp">#include &quot;wmi.h&quot;</span>
<span class="cp">#include &quot;bmi.h&quot;</span>
<span class="cp">#include &quot;target.h&quot;</span>

<span class="cp">#define MAX_ATH6KL                        1</span>
<span class="cp">#define ATH6KL_MAX_RX_BUFFERS             16</span>
<span class="cp">#define ATH6KL_BUFFER_SIZE                1664</span>
<span class="cp">#define ATH6KL_MAX_AMSDU_RX_BUFFERS       4</span>
<span class="cp">#define ATH6KL_AMSDU_REFILL_THRESHOLD     3</span>
<span class="cp">#define ATH6KL_AMSDU_BUFFER_SIZE     (WMI_MAX_AMSDU_RX_DATA_FRAME_LENGTH + 128)</span>
<span class="cp">#define MAX_MSDU_SUBFRAME_PAYLOAD_LEN	1508</span>
<span class="cp">#define MIN_MSDU_SUBFRAME_PAYLOAD_LEN	46</span>

<span class="cp">#define USER_SAVEDKEYS_STAT_INIT     0</span>
<span class="cp">#define USER_SAVEDKEYS_STAT_RUN      1</span>

<span class="cp">#define ATH6KL_TX_TIMEOUT      10</span>
<span class="cp">#define ATH6KL_MAX_ENDPOINTS   4</span>
<span class="cp">#define MAX_NODE_NUM           15</span>

<span class="cp">#define ATH6KL_APSD_ALL_FRAME		0xFFFF</span>
<span class="cp">#define ATH6KL_APSD_NUM_OF_AC		0x4</span>
<span class="cp">#define ATH6KL_APSD_FRAME_MASK		0xF</span>

<span class="cm">/* Extra bytes for htc header alignment */</span>
<span class="cp">#define ATH6KL_HTC_ALIGN_BYTES 3</span>

<span class="cm">/* MAX_HI_COOKIE_NUM are reserved for high priority traffic */</span>
<span class="cp">#define MAX_DEF_COOKIE_NUM                180</span>
<span class="cp">#define MAX_HI_COOKIE_NUM                 18	</span><span class="cm">/* 10% of MAX_COOKIE_NUM */</span><span class="cp"></span>
<span class="cp">#define MAX_COOKIE_NUM                 (MAX_DEF_COOKIE_NUM + MAX_HI_COOKIE_NUM)</span>

<span class="cp">#define MAX_DEFAULT_SEND_QUEUE_DEPTH      (MAX_DEF_COOKIE_NUM / WMM_NUM_AC)</span>

<span class="cp">#define DISCON_TIMER_INTVAL               10000  </span><span class="cm">/* in msec */</span><span class="cp"></span>

<span class="cm">/* Channel dwell time in fg scan */</span>
<span class="cp">#define ATH6KL_FG_SCAN_INTERVAL		50 </span><span class="cm">/* in ms */</span><span class="cp"></span>

<span class="cm">/* includes also the null byte */</span>
<span class="cp">#define ATH6KL_FIRMWARE_MAGIC               &quot;QCA-ATH6KL&quot;</span>

<span class="k">enum</span> <span class="n">ath6kl_fw_ie_type</span> <span class="p">{</span>
	<span class="n">ATH6KL_FW_IE_FW_VERSION</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">ATH6KL_FW_IE_TIMESTAMP</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">ATH6KL_FW_IE_OTP_IMAGE</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">ATH6KL_FW_IE_FW_IMAGE</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">ATH6KL_FW_IE_PATCH_IMAGE</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">ATH6KL_FW_IE_RESERVED_RAM_SIZE</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">ATH6KL_FW_IE_CAPABILITIES</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">ATH6KL_FW_IE_PATCH_ADDR</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">ATH6KL_FW_IE_BOARD_ADDR</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">ATH6KL_FW_IE_VIF_MAX</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">ath6kl_fw_capability</span> <span class="p">{</span>
	<span class="n">ATH6KL_FW_CAPABILITY_HOST_P2P</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">ATH6KL_FW_CAPABILITY_SCHED_SCAN</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>

	<span class="cm">/*</span>
<span class="cm">	 * Firmware is capable of supporting P2P mgmt operations on a</span>
<span class="cm">	 * station interface. After group formation, the station</span>
<span class="cm">	 * interface will become a P2P client/GO interface as the case may be</span>
<span class="cm">	 */</span>
	<span class="n">ATH6KL_FW_CAPABILITY_STA_P2PDEV_DUPLEX</span><span class="p">,</span>

	<span class="cm">/*</span>
<span class="cm">	 * Firmware has support to cleanup inactive stations</span>
<span class="cm">	 * in AP mode.</span>
<span class="cm">	 */</span>
	<span class="n">ATH6KL_FW_CAPABILITY_INACTIVITY_TIMEOUT</span><span class="p">,</span>

	<span class="cm">/* Firmware has support to override rsn cap of rsn ie */</span>
	<span class="n">ATH6KL_FW_CAPABILITY_RSN_CAP_OVERRIDE</span><span class="p">,</span>

	<span class="cm">/* this needs to be last */</span>
	<span class="n">ATH6KL_FW_CAPABILITY_MAX</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define ATH6KL_CAPABILITY_LEN (ALIGN(ATH6KL_FW_CAPABILITY_MAX, 32) / 32)</span>

<span class="k">struct</span> <span class="n">ath6kl_fw_ie</span> <span class="p">{</span>
	<span class="n">__le32</span> <span class="n">id</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">len</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>

<span class="cp">#define ATH6KL_FW_API2_FILE &quot;fw-2.bin&quot;</span>
<span class="cp">#define ATH6KL_FW_API3_FILE &quot;fw-3.bin&quot;</span>

<span class="cm">/* AR6003 1.0 definitions */</span>
<span class="cp">#define AR6003_HW_1_0_VERSION                 0x300002ba</span>

<span class="cm">/* AR6003 2.0 definitions */</span>
<span class="cp">#define AR6003_HW_2_0_VERSION                 0x30000384</span>
<span class="cp">#define AR6003_HW_2_0_PATCH_DOWNLOAD_ADDRESS  0x57e910</span>
<span class="cp">#define AR6003_HW_2_0_FW_DIR			&quot;ath6k/AR6003/hw2.0&quot;</span>
<span class="cp">#define AR6003_HW_2_0_OTP_FILE			&quot;otp.bin.z77&quot;</span>
<span class="cp">#define AR6003_HW_2_0_FIRMWARE_FILE		&quot;athwlan.bin.z77&quot;</span>
<span class="cp">#define AR6003_HW_2_0_TCMD_FIRMWARE_FILE	&quot;athtcmd_ram.bin&quot;</span>
<span class="cp">#define AR6003_HW_2_0_PATCH_FILE		&quot;data.patch.bin&quot;</span>
<span class="cp">#define AR6003_HW_2_0_BOARD_DATA_FILE AR6003_HW_2_0_FW_DIR &quot;/bdata.bin&quot;</span>
<span class="cp">#define AR6003_HW_2_0_DEFAULT_BOARD_DATA_FILE \</span>
<span class="cp">			AR6003_HW_2_0_FW_DIR &quot;/bdata.SD31.bin&quot;</span>

<span class="cm">/* AR6003 3.0 definitions */</span>
<span class="cp">#define AR6003_HW_2_1_1_VERSION                 0x30000582</span>
<span class="cp">#define AR6003_HW_2_1_1_FW_DIR			&quot;ath6k/AR6003/hw2.1.1&quot;</span>
<span class="cp">#define AR6003_HW_2_1_1_OTP_FILE		&quot;otp.bin&quot;</span>
<span class="cp">#define AR6003_HW_2_1_1_FIRMWARE_FILE		&quot;athwlan.bin&quot;</span>
<span class="cp">#define AR6003_HW_2_1_1_TCMD_FIRMWARE_FILE	&quot;athtcmd_ram.bin&quot;</span>
<span class="cp">#define AR6003_HW_2_1_1_UTF_FIRMWARE_FILE	&quot;utf.bin&quot;</span>
<span class="cp">#define AR6003_HW_2_1_1_TESTSCRIPT_FILE	&quot;nullTestFlow.bin&quot;</span>
<span class="cp">#define AR6003_HW_2_1_1_PATCH_FILE		&quot;data.patch.bin&quot;</span>
<span class="cp">#define AR6003_HW_2_1_1_BOARD_DATA_FILE AR6003_HW_2_1_1_FW_DIR &quot;/bdata.bin&quot;</span>
<span class="cp">#define AR6003_HW_2_1_1_DEFAULT_BOARD_DATA_FILE	\</span>
<span class="cp">			AR6003_HW_2_1_1_FW_DIR &quot;/bdata.SD31.bin&quot;</span>

<span class="cm">/* AR6004 1.0 definitions */</span>
<span class="cp">#define AR6004_HW_1_0_VERSION                 0x30000623</span>
<span class="cp">#define AR6004_HW_1_0_FW_DIR			&quot;ath6k/AR6004/hw1.0&quot;</span>
<span class="cp">#define AR6004_HW_1_0_FIRMWARE_FILE		&quot;fw.ram.bin&quot;</span>
<span class="cp">#define AR6004_HW_1_0_BOARD_DATA_FILE         AR6004_HW_1_0_FW_DIR &quot;/bdata.bin&quot;</span>
<span class="cp">#define AR6004_HW_1_0_DEFAULT_BOARD_DATA_FILE \</span>
<span class="cp">	AR6004_HW_1_0_FW_DIR &quot;/bdata.DB132.bin&quot;</span>

<span class="cm">/* AR6004 1.1 definitions */</span>
<span class="cp">#define AR6004_HW_1_1_VERSION                 0x30000001</span>
<span class="cp">#define AR6004_HW_1_1_FW_DIR			&quot;ath6k/AR6004/hw1.1&quot;</span>
<span class="cp">#define AR6004_HW_1_1_FIRMWARE_FILE		&quot;fw.ram.bin&quot;</span>
<span class="cp">#define AR6004_HW_1_1_BOARD_DATA_FILE         AR6004_HW_1_1_FW_DIR &quot;/bdata.bin&quot;</span>
<span class="cp">#define AR6004_HW_1_1_DEFAULT_BOARD_DATA_FILE \</span>
<span class="cp">	AR6004_HW_1_1_FW_DIR &quot;/bdata.DB132.bin&quot;</span>

<span class="cm">/* AR6004 1.2 definitions */</span>
<span class="cp">#define AR6004_HW_1_2_VERSION                 0x300007e8</span>
<span class="cp">#define AR6004_HW_1_2_FW_DIR			&quot;ath6k/AR6004/hw1.2&quot;</span>
<span class="cp">#define AR6004_HW_1_2_FIRMWARE_FILE           &quot;fw.ram.bin&quot;</span>
<span class="cp">#define AR6004_HW_1_2_BOARD_DATA_FILE         AR6004_HW_1_2_FW_DIR &quot;/bdata.bin&quot;</span>
<span class="cp">#define AR6004_HW_1_2_DEFAULT_BOARD_DATA_FILE \</span>
<span class="cp">	AR6004_HW_1_2_FW_DIR &quot;/bdata.bin&quot;</span>

<span class="cm">/* Per STA data, used in AP mode */</span>
<span class="cp">#define STA_PS_AWAKE		BIT(0)</span>
<span class="cp">#define	STA_PS_SLEEP		BIT(1)</span>
<span class="cp">#define	STA_PS_POLLED		BIT(2)</span>
<span class="cp">#define STA_PS_APSD_TRIGGER     BIT(3)</span>
<span class="cp">#define STA_PS_APSD_EOSP        BIT(4)</span>

<span class="cm">/* HTC TX packet tagging definitions */</span>
<span class="cp">#define ATH6KL_CONTROL_PKT_TAG    HTC_TX_PACKET_TAG_USER_DEFINED</span>
<span class="cp">#define ATH6KL_DATA_PKT_TAG       (ATH6KL_CONTROL_PKT_TAG + 1)</span>

<span class="cp">#define AR6003_CUST_DATA_SIZE 16</span>

<span class="cp">#define AGGR_WIN_IDX(x, y)          ((x) % (y))</span>
<span class="cp">#define AGGR_INCR_IDX(x, y)         AGGR_WIN_IDX(((x) + 1), (y))</span>
<span class="cp">#define AGGR_DCRM_IDX(x, y)         AGGR_WIN_IDX(((x) - 1), (y))</span>
<span class="cp">#define ATH6KL_MAX_SEQ_NO		0xFFF</span>
<span class="cp">#define ATH6KL_NEXT_SEQ_NO(x)		(((x) + 1) &amp; ATH6KL_MAX_SEQ_NO)</span>

<span class="cp">#define NUM_OF_TIDS         8</span>
<span class="cp">#define AGGR_SZ_DEFAULT     8</span>

<span class="cp">#define AGGR_WIN_SZ_MIN     2</span>
<span class="cp">#define AGGR_WIN_SZ_MAX     8</span>

<span class="cp">#define TID_WINDOW_SZ(_x)   ((_x) &lt;&lt; 1)</span>

<span class="cp">#define AGGR_NUM_OF_FREE_NETBUFS    16</span>

<span class="cp">#define AGGR_RX_TIMEOUT     400	</span><span class="cm">/* in ms */</span><span class="cp"></span>

<span class="cp">#define WMI_TIMEOUT (2 * HZ)</span>

<span class="cp">#define MBOX_YIELD_LIMIT 99</span>

<span class="cp">#define ATH6KL_DEFAULT_LISTEN_INTVAL	100 </span><span class="cm">/* in TUs */</span><span class="cp"></span>
<span class="cp">#define ATH6KL_DEFAULT_BMISS_TIME	1500</span>
<span class="cp">#define ATH6KL_MAX_WOW_LISTEN_INTL	300 </span><span class="cm">/* in TUs */</span><span class="cp"></span>
<span class="cp">#define ATH6KL_MAX_BMISS_TIME		5000</span>

<span class="cm">/* configuration lags */</span>
<span class="cm">/*</span>
<span class="cm"> * ATH6KL_CONF_IGNORE_ERP_BARKER: Ignore the barker premable in</span>
<span class="cm"> * ERP IE of beacon to determine the short premable support when</span>
<span class="cm"> * sending (Re)Assoc req.</span>
<span class="cm"> * ATH6KL_CONF_IGNORE_PS_FAIL_EVT_IN_SCAN: Don&#39;t send the power</span>
<span class="cm"> * module state transition failure events which happen during</span>
<span class="cm"> * scan, to the host.</span>
<span class="cm"> */</span>
<span class="cp">#define ATH6KL_CONF_IGNORE_ERP_BARKER		BIT(0)</span>
<span class="cp">#define ATH6KL_CONF_IGNORE_PS_FAIL_EVT_IN_SCAN  BIT(1)</span>
<span class="cp">#define ATH6KL_CONF_ENABLE_11N			BIT(2)</span>
<span class="cp">#define ATH6KL_CONF_ENABLE_TX_BURST		BIT(3)</span>
<span class="cp">#define ATH6KL_CONF_UART_DEBUG			BIT(4)</span>

<span class="cp">#define P2P_WILDCARD_SSID_LEN			7 </span><span class="cm">/* DIRECT- */</span><span class="cp"></span>

<span class="k">enum</span> <span class="n">wlan_low_pwr_state</span> <span class="p">{</span>
	<span class="n">WLAN_POWER_STATE_ON</span><span class="p">,</span>
	<span class="n">WLAN_POWER_STATE_CUT_PWR</span><span class="p">,</span>
	<span class="n">WLAN_POWER_STATE_DEEP_SLEEP</span><span class="p">,</span>
	<span class="n">WLAN_POWER_STATE_WOW</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">sme_state</span> <span class="p">{</span>
	<span class="n">SME_DISCONNECTED</span><span class="p">,</span>
	<span class="n">SME_CONNECTING</span><span class="p">,</span>
	<span class="n">SME_CONNECTED</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">skb_hold_q</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">is_amsdu</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">seq_no</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">rxtid</span> <span class="p">{</span>
	<span class="n">bool</span> <span class="n">aggr</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">progress</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">timer_mon</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">win_sz</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">seq_next</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">hold_q_sz</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">skb_hold_q</span> <span class="o">*</span><span class="n">hold_q</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sk_buff_head</span> <span class="n">q</span><span class="p">;</span>

	<span class="cm">/*</span>
<span class="cm">	 * FIXME: No clue what this should protect. Apparently it should</span>
<span class="cm">	 * protect some of the fields above but they are also accessed</span>
<span class="cm">	 * without taking the lock.</span>
<span class="cm">	 */</span>
	<span class="n">spinlock_t</span> <span class="n">lock</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">rxtid_stats</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">num_into_aggr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">num_dups</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">num_oow</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">num_mpdu</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">num_amsdu</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">num_delivered</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">num_timeouts</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">num_hole</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">num_bar</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">aggr_info_conn</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">aggr_sz</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">timer_scheduled</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">timer_list</span> <span class="n">timer</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">rxtid</span> <span class="n">rx_tid</span><span class="p">[</span><span class="n">NUM_OF_TIDS</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">rxtid_stats</span> <span class="n">stat</span><span class="p">[</span><span class="n">NUM_OF_TIDS</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">aggr_info</span> <span class="o">*</span><span class="n">aggr_info</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">aggr_info</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">aggr_info_conn</span> <span class="o">*</span><span class="n">aggr_conn</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sk_buff_head</span> <span class="n">rx_amsdu_freeq</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath6kl_wep_key</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">key_index</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">key_len</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">key</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>
<span class="p">};</span>

<span class="cp">#define ATH6KL_KEY_SEQ_LEN 8</span>

<span class="k">struct</span> <span class="n">ath6kl_key</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">key</span><span class="p">[</span><span class="n">WLAN_MAX_KEY_LEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">key_len</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">seq</span><span class="p">[</span><span class="n">ATH6KL_KEY_SEQ_LEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">seq_len</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">cipher</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath6kl_node_mapping</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">mac_addr</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">ep_id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">tx_pend</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath6kl_cookie</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">map_no</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">htc_packet</span> <span class="n">htc_pkt</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath6kl_cookie</span> <span class="o">*</span><span class="n">arc_list_next</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath6kl_mgmt_buff</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">list</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">freq</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">wait</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">id</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">no_cck</span><span class="p">;</span>
	<span class="kt">size_t</span> <span class="n">len</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">buf</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath6kl_sta</span> <span class="p">{</span>
	<span class="n">u16</span> <span class="n">sta_flags</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">mac</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">aid</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">keymgmt</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">ucipher</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">auth</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">wpa_ie</span><span class="p">[</span><span class="n">ATH6KL_MAX_IE</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">sk_buff_head</span> <span class="n">psq</span><span class="p">;</span>

	<span class="cm">/* protects psq, mgmt_psq, apsdq, and mgmt_psq_len fields */</span>
	<span class="n">spinlock_t</span> <span class="n">psq_lock</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">mgmt_psq</span><span class="p">;</span>
	<span class="kt">size_t</span> <span class="n">mgmt_psq_len</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">apsd_info</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sk_buff_head</span> <span class="n">apsdq</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">aggr_info_conn</span> <span class="o">*</span><span class="n">aggr_conn</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath6kl_version</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">target_ver</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">wlan_ver</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">abi_ver</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath6kl_bmi</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">cmd_credits</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">done_sent</span><span class="p">;</span>
	<span class="n">u8</span> <span class="o">*</span><span class="n">cmd_buf</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">max_data_size</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">max_cmd_size</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">target_stats</span> <span class="p">{</span>
	<span class="n">u64</span> <span class="n">tx_pkt</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">tx_byte</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">tx_ucast_pkt</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">tx_ucast_byte</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">tx_mcast_pkt</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">tx_mcast_byte</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">tx_bcast_pkt</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">tx_bcast_byte</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">tx_rts_success_cnt</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">tx_pkt_per_ac</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>

	<span class="n">u64</span> <span class="n">tx_err</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">tx_fail_cnt</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">tx_retry_cnt</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">tx_mult_retry_cnt</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">tx_rts_fail_cnt</span><span class="p">;</span>

	<span class="n">u64</span> <span class="n">rx_pkt</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">rx_byte</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">rx_ucast_pkt</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">rx_ucast_byte</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">rx_mcast_pkt</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">rx_mcast_byte</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">rx_bcast_pkt</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">rx_bcast_byte</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">rx_frgment_pkt</span><span class="p">;</span>

	<span class="n">u64</span> <span class="n">rx_err</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">rx_crc_err</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">rx_key_cache_miss</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">rx_decrypt_err</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">rx_dupl_frame</span><span class="p">;</span>

	<span class="n">u64</span> <span class="n">tkip_local_mic_fail</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">tkip_cnter_measures_invoked</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">tkip_replays</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">tkip_fmt_err</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">ccmp_fmt_err</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">ccmp_replays</span><span class="p">;</span>

	<span class="n">u64</span> <span class="n">pwr_save_fail_cnt</span><span class="p">;</span>

	<span class="n">u64</span> <span class="n">cs_bmiss_cnt</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">cs_low_rssi_cnt</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">cs_connect_cnt</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">cs_discon_cnt</span><span class="p">;</span>

	<span class="n">s32</span> <span class="n">tx_ucast_rate</span><span class="p">;</span>
	<span class="n">s32</span> <span class="n">rx_ucast_rate</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">lq_val</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">wow_pkt_dropped</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">wow_evt_discarded</span><span class="p">;</span>

	<span class="n">s16</span> <span class="n">noise_floor_calib</span><span class="p">;</span>
	<span class="n">s16</span> <span class="n">cs_rssi</span><span class="p">;</span>
	<span class="n">s16</span> <span class="n">cs_ave_beacon_rssi</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">cs_ave_beacon_snr</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">cs_last_roam_msec</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">cs_snr</span><span class="p">;</span>

	<span class="n">u8</span> <span class="n">wow_host_pkt_wakeups</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">wow_host_evt_wakeups</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">arp_received</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">arp_matched</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">arp_replied</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath6kl_mbox_info</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">htc_addr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">htc_ext_addr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">htc_ext_sz</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">block_size</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">gmbox_addr</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">gmbox_sz</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * 802.11i defines an extended IV for use with non-WEP ciphers.</span>
<span class="cm"> * When the EXTIV bit is set in the key id byte an additional</span>
<span class="cm"> * 4 bytes immediately follow the IV for TKIP.  For CCMP the</span>
<span class="cm"> * EXTIV bit is likewise set but the 8 bytes represent the</span>
<span class="cm"> * CCMP header rather than IV+extended-IV.</span>
<span class="cm"> */</span>

<span class="cp">#define ATH6KL_KEYBUF_SIZE 16</span>
<span class="cp">#define ATH6KL_MICBUF_SIZE (8+8)	</span><span class="cm">/* space for both tx and rx */</span><span class="cp"></span>

<span class="cp">#define ATH6KL_KEY_XMIT  0x01</span>
<span class="cp">#define ATH6KL_KEY_RECV  0x02</span>
<span class="cp">#define ATH6KL_KEY_DEFAULT   0x80	</span><span class="cm">/* default xmit key */</span><span class="cp"></span>

<span class="cm">/* Initial group key for AP mode */</span>
<span class="k">struct</span> <span class="n">ath6kl_req_key</span> <span class="p">{</span>
	<span class="n">bool</span> <span class="n">valid</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">key_index</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">key_type</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">key</span><span class="p">[</span><span class="n">WLAN_MAX_KEY_LEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">key_len</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">ath6kl_hif_type</span> <span class="p">{</span>
	<span class="n">ATH6KL_HIF_TYPE_SDIO</span><span class="p">,</span>
	<span class="n">ATH6KL_HIF_TYPE_USB</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">ath6kl_htc_type</span> <span class="p">{</span>
	<span class="n">ATH6KL_HTC_TYPE_MBOX</span><span class="p">,</span>
	<span class="n">ATH6KL_HTC_TYPE_PIPE</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* Max number of filters that hw supports */</span>
<span class="cp">#define ATH6K_MAX_MC_FILTERS_PER_LIST 7</span>
<span class="k">struct</span> <span class="n">ath6kl_mc_filter</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">list</span><span class="p">;</span>
	<span class="kt">char</span> <span class="n">hw_addr</span><span class="p">[</span><span class="n">ATH6KL_MCAST_FILTER_MAC_ADDR_SIZE</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath6kl_htcap</span> <span class="p">{</span>
	<span class="n">bool</span> <span class="n">ht_enable</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">ampdu_factor</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">cap_info</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Driver&#39;s maximum limit, note that some firmwares support only one vif</span>
<span class="cm"> * and the runtime (current) limit must be checked from ar-&gt;vif_max.</span>
<span class="cm"> */</span>
<span class="cp">#define ATH6KL_VIF_MAX	3</span>

<span class="cm">/* vif flags info */</span>
<span class="k">enum</span> <span class="n">ath6kl_vif_state</span> <span class="p">{</span>
	<span class="n">CONNECTED</span><span class="p">,</span>
	<span class="n">CONNECT_PEND</span><span class="p">,</span>
	<span class="n">WMM_ENABLED</span><span class="p">,</span>
	<span class="n">NETQ_STOPPED</span><span class="p">,</span>
	<span class="n">DTIM_EXPIRED</span><span class="p">,</span>
	<span class="n">NETDEV_REGISTERED</span><span class="p">,</span>
	<span class="n">CLEAR_BSSFILTER_ON_BEACON</span><span class="p">,</span>
	<span class="n">DTIM_PERIOD_AVAIL</span><span class="p">,</span>
	<span class="n">WLAN_ENABLED</span><span class="p">,</span>
	<span class="n">STATS_UPDATE_PEND</span><span class="p">,</span>
	<span class="n">HOST_SLEEP_MODE_CMD_PROCESSED</span><span class="p">,</span>
	<span class="n">NETDEV_MCAST_ALL_ON</span><span class="p">,</span>
	<span class="n">NETDEV_MCAST_ALL_OFF</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath6kl_vif</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">list</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">wireless_dev</span> <span class="n">wdev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">ndev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">;</span>
	<span class="cm">/* Lock to protect vif specific net_stats and flags */</span>
	<span class="n">spinlock_t</span> <span class="n">if_lock</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">fw_vif_idx</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">flags</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">ssid_len</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">ssid</span><span class="p">[</span><span class="n">IEEE80211_MAX_SSID_LEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">dot11_auth_mode</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">auth_mode</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">prwise_crypto</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">prwise_crypto_len</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">grp_crypto</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">grp_crypto_len</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">def_txkey_index</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">next_mode</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">nw_type</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bssid</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">req_bssid</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u16</span> <span class="n">ch_hint</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">bss_ch</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath6kl_wep_key</span> <span class="n">wep_key_list</span><span class="p">[</span><span class="n">WMI_MAX_KEY_INDEX</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">ath6kl_key</span> <span class="n">keys</span><span class="p">[</span><span class="n">WMI_MAX_KEY_INDEX</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">aggr_info</span> <span class="o">*</span><span class="n">aggr_cntxt</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath6kl_htcap</span> <span class="n">htcap</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">timer_list</span> <span class="n">disconnect_timer</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">timer_list</span> <span class="n">sched_scan_timer</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">cfg80211_scan_request</span> <span class="o">*</span><span class="n">scan_req</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">sme_state</span> <span class="n">sme_state</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">reconnect_flag</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">last_roc_id</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">last_cancel_roc_id</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">send_action_id</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">probe_req_report</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">next_chan</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">nl80211_channel_type</span> <span class="n">next_ch_type</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">ieee80211_band</span> <span class="n">next_ch_band</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">assoc_bss_beacon_int</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">listen_intvl_t</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">bmiss_time_t</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">bg_scan_period</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">assoc_bss_dtim_period</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">net_device_stats</span> <span class="n">net_stats</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">target_stats</span> <span class="n">target_stats</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">wmi_connect_cmd</span> <span class="n">profile</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">mc_filter</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define WOW_LIST_ID		0</span>
<span class="cp">#define WOW_HOST_REQ_DELAY	500 </span><span class="cm">/* ms */</span><span class="cp"></span>

<span class="cp">#define ATH6KL_SCHED_SCAN_RESULT_DELAY 5000 </span><span class="cm">/* ms */</span><span class="cp"></span>

<span class="cm">/* Flag info */</span>
<span class="k">enum</span> <span class="n">ath6kl_dev_state</span> <span class="p">{</span>
	<span class="n">WMI_ENABLED</span><span class="p">,</span>
	<span class="n">WMI_READY</span><span class="p">,</span>
	<span class="n">WMI_CTRL_EP_FULL</span><span class="p">,</span>
	<span class="n">TESTMODE</span><span class="p">,</span>
	<span class="n">DESTROY_IN_PROGRESS</span><span class="p">,</span>
	<span class="n">SKIP_SCAN</span><span class="p">,</span>
	<span class="n">ROAM_TBL_PEND</span><span class="p">,</span>
	<span class="n">FIRST_BOOT</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">ath6kl_state</span> <span class="p">{</span>
	<span class="n">ATH6KL_STATE_OFF</span><span class="p">,</span>
	<span class="n">ATH6KL_STATE_ON</span><span class="p">,</span>
	<span class="n">ATH6KL_STATE_SUSPENDING</span><span class="p">,</span>
	<span class="n">ATH6KL_STATE_RESUMING</span><span class="p">,</span>
	<span class="n">ATH6KL_STATE_DEEPSLEEP</span><span class="p">,</span>
	<span class="n">ATH6KL_STATE_CUTPOWER</span><span class="p">,</span>
	<span class="n">ATH6KL_STATE_WOW</span><span class="p">,</span>
	<span class="n">ATH6KL_STATE_SCHED_SCAN</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath6kl</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">wiphy</span> <span class="o">*</span><span class="n">wiphy</span><span class="p">;</span>

	<span class="k">enum</span> <span class="n">ath6kl_state</span> <span class="n">state</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">testmode</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">ath6kl_bmi</span> <span class="n">bmi</span><span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">ath6kl_hif_ops</span> <span class="o">*</span><span class="n">hif_ops</span><span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">ath6kl_htc_ops</span> <span class="o">*</span><span class="n">htc_ops</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">wmi</span> <span class="o">*</span><span class="n">wmi</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">tx_pending</span><span class="p">[</span><span class="n">ENDPOINT_MAX</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">total_tx_data_pend</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">htc_target</span> <span class="o">*</span><span class="n">htc_target</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">ath6kl_hif_type</span> <span class="n">hif_type</span><span class="p">;</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">hif_priv</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">vif_list</span><span class="p">;</span>
	<span class="cm">/* Lock to avoid race in vif_list entries among add/del/traverse */</span>
	<span class="n">spinlock_t</span> <span class="n">list_lock</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">num_vif</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">vif_max</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">max_norm_iface</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">avail_idx_map</span><span class="p">;</span>

	<span class="cm">/*</span>
<span class="cm">	 * Protects at least amsdu_rx_buffer_queue, ath6kl_alloc_cookie()</span>
<span class="cm">	 * calls, tx_pending and total_tx_data_pend.</span>
<span class="cm">	 */</span>
	<span class="n">spinlock_t</span> <span class="n">lock</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">semaphore</span> <span class="n">sem</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">lrssi_roam_threshold</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath6kl_version</span> <span class="n">version</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">target_type</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">tx_pwr</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath6kl_node_mapping</span> <span class="n">node_map</span><span class="p">[</span><span class="n">MAX_NODE_NUM</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">ibss_ps_enable</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">ibss_if_active</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">node_num</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">next_ep_id</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath6kl_cookie</span> <span class="o">*</span><span class="n">cookie_list</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">cookie_count</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">htc_endpoint_id</span> <span class="n">ac2ep_map</span><span class="p">[</span><span class="n">WMM_NUM_AC</span><span class="p">];</span>
	<span class="n">bool</span> <span class="n">ac_stream_active</span><span class="p">[</span><span class="n">WMM_NUM_AC</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">ac_stream_pri_map</span><span class="p">[</span><span class="n">WMM_NUM_AC</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">hiac_stream_active_pri</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">ep2ac_map</span><span class="p">[</span><span class="n">ENDPOINT_MAX</span><span class="p">];</span>
	<span class="k">enum</span> <span class="n">htc_endpoint_id</span> <span class="n">ctrl_ep</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath6kl_htc_credit_info</span> <span class="n">credit_state_info</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">connect_ctrl_flags</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">user_key_ctrl</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">usr_bss_filter</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath6kl_sta</span> <span class="n">sta_list</span><span class="p">[</span><span class="n">AP_MAX_NUM_STA</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">sta_list_index</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath6kl_req_key</span> <span class="n">ap_mode_bkey</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sk_buff_head</span> <span class="n">mcastpsq</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">want_ch_switch</span><span class="p">;</span>

	<span class="cm">/*</span>
<span class="cm">	 * FIXME: protects access to mcastpsq but is actually useless as</span>
<span class="cm">	 * all skbe_queue_*() functions provide serialisation themselves</span>
<span class="cm">	 */</span>
	<span class="n">spinlock_t</span> <span class="n">mcastpsq_lock</span><span class="p">;</span>

	<span class="n">u8</span> <span class="n">intra_bss</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">wmi_ap_mode_stat</span> <span class="n">ap_stats</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">ap_country_code</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">amsdu_rx_buffer_queue</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">rx_meta_ver</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">wlan_low_pwr_state</span> <span class="n">wlan_pwr_state</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">mac_addr</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
<span class="cp">#define AR_MCAST_FILTER_MAC_ADDR_SIZE  4</span>
	<span class="k">struct</span> <span class="p">{</span>
		<span class="kt">void</span> <span class="o">*</span><span class="n">rx_report</span><span class="p">;</span>
		<span class="kt">size_t</span> <span class="n">rx_report_len</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">tm</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">ath6kl_hw</span> <span class="p">{</span>
		<span class="n">u32</span> <span class="n">id</span><span class="p">;</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">;</span>
		<span class="n">u32</span> <span class="n">dataset_patch_addr</span><span class="p">;</span>
		<span class="n">u32</span> <span class="n">app_load_addr</span><span class="p">;</span>
		<span class="n">u32</span> <span class="n">app_start_override_addr</span><span class="p">;</span>
		<span class="n">u32</span> <span class="n">board_ext_data_addr</span><span class="p">;</span>
		<span class="n">u32</span> <span class="n">reserved_ram_size</span><span class="p">;</span>
		<span class="n">u32</span> <span class="n">board_addr</span><span class="p">;</span>
		<span class="n">u32</span> <span class="n">refclk_hz</span><span class="p">;</span>
		<span class="n">u32</span> <span class="n">uarttx_pin</span><span class="p">;</span>
		<span class="n">u32</span> <span class="n">testscript_addr</span><span class="p">;</span>
		<span class="k">enum</span> <span class="n">wmi_phy_cap</span> <span class="n">cap</span><span class="p">;</span>

		<span class="k">struct</span> <span class="n">ath6kl_hw_fw</span> <span class="p">{</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">dir</span><span class="p">;</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">otp</span><span class="p">;</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">fw</span><span class="p">;</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">tcmd</span><span class="p">;</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">patch</span><span class="p">;</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">utf</span><span class="p">;</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">testscript</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">fw</span><span class="p">;</span>

		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">fw_board</span><span class="p">;</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">fw_default_board</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">hw</span><span class="p">;</span>

	<span class="n">u16</span> <span class="n">conf_flags</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">suspend_mode</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">wow_suspend_mode</span><span class="p">;</span>
	<span class="n">wait_queue_head_t</span> <span class="n">event_wq</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath6kl_mbox_info</span> <span class="n">mbox_info</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">ath6kl_cookie</span> <span class="n">cookie_mem</span><span class="p">[</span><span class="n">MAX_COOKIE_NUM</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">flag</span><span class="p">;</span>

	<span class="n">u8</span> <span class="o">*</span><span class="n">fw_board</span><span class="p">;</span>
	<span class="kt">size_t</span> <span class="n">fw_board_len</span><span class="p">;</span>

	<span class="n">u8</span> <span class="o">*</span><span class="n">fw_otp</span><span class="p">;</span>
	<span class="kt">size_t</span> <span class="n">fw_otp_len</span><span class="p">;</span>

	<span class="n">u8</span> <span class="o">*</span><span class="n">fw</span><span class="p">;</span>
	<span class="kt">size_t</span> <span class="n">fw_len</span><span class="p">;</span>

	<span class="n">u8</span> <span class="o">*</span><span class="n">fw_patch</span><span class="p">;</span>
	<span class="kt">size_t</span> <span class="n">fw_patch_len</span><span class="p">;</span>

	<span class="n">u8</span> <span class="o">*</span><span class="n">fw_testscript</span><span class="p">;</span>
	<span class="kt">size_t</span> <span class="n">fw_testscript_len</span><span class="p">;</span>

	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">fw_api</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">fw_capabilities</span><span class="p">[</span><span class="n">ATH6KL_CAPABILITY_LEN</span><span class="p">];</span>

	<span class="k">struct</span> <span class="n">workqueue_struct</span> <span class="o">*</span><span class="n">ath6kl_wq</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">dentry</span> <span class="o">*</span><span class="n">debugfs_phy</span><span class="p">;</span>

	<span class="n">bool</span> <span class="n">p2p</span><span class="p">;</span>

	<span class="n">bool</span> <span class="n">wiphy_registered</span><span class="p">;</span>

<span class="cp">#ifdef CONFIG_ATH6KL_DEBUG</span>
	<span class="k">struct</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="n">sk_buff_head</span> <span class="n">fwlog_queue</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">completion</span> <span class="n">fwlog_completion</span><span class="p">;</span>
		<span class="n">bool</span> <span class="n">fwlog_open</span><span class="p">;</span>

		<span class="n">u32</span> <span class="n">fwlog_mask</span><span class="p">;</span>

		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dbgfs_diag_reg</span><span class="p">;</span>
		<span class="n">u32</span> <span class="n">diag_reg_addr_wr</span><span class="p">;</span>
		<span class="n">u32</span> <span class="n">diag_reg_val_wr</span><span class="p">;</span>

		<span class="k">struct</span> <span class="p">{</span>
			<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">invalid_rate</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">war_stats</span><span class="p">;</span>

		<span class="n">u8</span> <span class="o">*</span><span class="n">roam_tbl</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">roam_tbl_len</span><span class="p">;</span>

		<span class="n">u8</span> <span class="n">keepalive</span><span class="p">;</span>
		<span class="n">u8</span> <span class="n">disc_timeout</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">debug</span><span class="p">;</span>
<span class="cp">#endif </span><span class="cm">/* CONFIG_ATH6KL_DEBUG */</span><span class="cp"></span>
<span class="p">};</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="nf">ath6kl_priv</span><span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">((</span><span class="k">struct</span> <span class="n">ath6kl_vif</span> <span class="o">*</span><span class="p">)</span> <span class="n">netdev_priv</span><span class="p">(</span><span class="n">dev</span><span class="p">))</span><span class="o">-&gt;</span><span class="n">ar</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="nf">ath6kl_get_hi_item_addr</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">,</span>
					  <span class="n">u32</span> <span class="n">item_offset</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">addr</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ar</span><span class="o">-&gt;</span><span class="n">target_type</span> <span class="o">==</span> <span class="n">TARGET_TYPE_AR6003</span><span class="p">)</span>
		<span class="n">addr</span> <span class="o">=</span> <span class="n">ATH6KL_AR6003_HI_START_ADDR</span> <span class="o">+</span> <span class="n">item_offset</span><span class="p">;</span>
	<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">ar</span><span class="o">-&gt;</span><span class="n">target_type</span> <span class="o">==</span> <span class="n">TARGET_TYPE_AR6004</span><span class="p">)</span>
		<span class="n">addr</span> <span class="o">=</span> <span class="n">ATH6KL_AR6004_HI_START_ADDR</span> <span class="o">+</span> <span class="n">item_offset</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">addr</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">ath6kl_configure_target</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_detect_error</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">ptr</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">disconnect_timer_handler</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">ptr</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">init_netdev</span><span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_cookie_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_cookie_cleanup</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_rx</span><span class="p">(</span><span class="k">struct</span> <span class="n">htc_target</span> <span class="o">*</span><span class="n">target</span><span class="p">,</span> <span class="k">struct</span> <span class="n">htc_packet</span> <span class="o">*</span><span class="n">packet</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_tx_complete</span><span class="p">(</span><span class="k">struct</span> <span class="n">htc_target</span> <span class="o">*</span><span class="n">context</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">list_head</span> <span class="o">*</span><span class="n">packet_queue</span><span class="p">);</span>
<span class="k">enum</span> <span class="n">htc_send_full_action</span> <span class="n">ath6kl_tx_queue_full</span><span class="p">(</span><span class="k">struct</span> <span class="n">htc_target</span> <span class="o">*</span><span class="n">target</span><span class="p">,</span>
					       <span class="k">struct</span> <span class="n">htc_packet</span> <span class="o">*</span><span class="n">packet</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_stop_txrx</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_cleanup_amsdu_rxbufs</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ath6kl_diag_write32</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">,</span> <span class="n">u32</span> <span class="n">address</span><span class="p">,</span> <span class="n">__le32</span> <span class="n">value</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ath6kl_diag_write</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">,</span> <span class="n">u32</span> <span class="n">address</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="n">u32</span> <span class="n">length</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ath6kl_diag_read32</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">,</span> <span class="n">u32</span> <span class="n">address</span><span class="p">,</span> <span class="n">u32</span> <span class="o">*</span><span class="n">value</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ath6kl_diag_read</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">,</span> <span class="n">u32</span> <span class="n">address</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="n">u32</span> <span class="n">length</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ath6kl_read_fwlogs</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_init_profile_info</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl_vif</span> <span class="o">*</span><span class="n">vif</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_tx_data_cleanup</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">ath6kl_cookie</span> <span class="o">*</span><span class="n">ath6kl_alloc_cookie</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_free_cookie</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ath6kl_cookie</span> <span class="o">*</span><span class="n">cookie</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ath6kl_data_tx</span><span class="p">(</span><span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">,</span> <span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">aggr_info</span> <span class="o">*</span><span class="n">aggr_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl_vif</span> <span class="o">*</span><span class="n">vif</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">aggr_conn_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl_vif</span> <span class="o">*</span><span class="n">vif</span><span class="p">,</span> <span class="k">struct</span> <span class="n">aggr_info</span> <span class="o">*</span><span class="n">aggr_info</span><span class="p">,</span>
		    <span class="k">struct</span> <span class="n">aggr_info_conn</span> <span class="o">*</span><span class="n">aggr_conn</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_rx_refill</span><span class="p">(</span><span class="k">struct</span> <span class="n">htc_target</span> <span class="o">*</span><span class="n">target</span><span class="p">,</span>
		      <span class="k">enum</span> <span class="n">htc_endpoint_id</span> <span class="n">endpoint</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_refill_amsdu_rxbufs</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">,</span> <span class="kt">int</span> <span class="n">count</span><span class="p">);</span>
<span class="k">struct</span> <span class="n">htc_packet</span> <span class="o">*</span><span class="n">ath6kl_alloc_amsdu_rxbuf</span><span class="p">(</span><span class="k">struct</span> <span class="n">htc_target</span> <span class="o">*</span><span class="n">target</span><span class="p">,</span>
					    <span class="k">enum</span> <span class="n">htc_endpoint_id</span> <span class="n">endpoint</span><span class="p">,</span>
					    <span class="kt">int</span> <span class="n">len</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">aggr_module_destroy</span><span class="p">(</span><span class="k">struct</span> <span class="n">aggr_info</span> <span class="o">*</span><span class="n">aggr_info</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">aggr_reset_state</span><span class="p">(</span><span class="k">struct</span> <span class="n">aggr_info_conn</span> <span class="o">*</span><span class="n">aggr_conn</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">ath6kl_sta</span> <span class="o">*</span><span class="n">ath6kl_find_sta</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl_vif</span> <span class="o">*</span><span class="n">vif</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">node_addr</span><span class="p">);</span>
<span class="k">struct</span> <span class="n">ath6kl_sta</span> <span class="o">*</span><span class="n">ath6kl_find_sta_by_aid</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">,</span> <span class="n">u8</span> <span class="n">aid</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">ath6kl_ready_event</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">devt</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">datap</span><span class="p">,</span> <span class="n">u32</span> <span class="n">sw_ver</span><span class="p">,</span> <span class="n">u32</span> <span class="n">abi_ver</span><span class="p">,</span>
			<span class="k">enum</span> <span class="n">wmi_phy_cap</span> <span class="n">cap</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ath6kl_control_tx</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">devt</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">,</span>
		      <span class="k">enum</span> <span class="n">htc_endpoint_id</span> <span class="n">eid</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_connect_event</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl_vif</span> <span class="o">*</span><span class="n">vif</span><span class="p">,</span> <span class="n">u16</span> <span class="n">channel</span><span class="p">,</span>
			  <span class="n">u8</span> <span class="o">*</span><span class="n">bssid</span><span class="p">,</span> <span class="n">u16</span> <span class="n">listen_int</span><span class="p">,</span>
			  <span class="n">u16</span> <span class="n">beacon_int</span><span class="p">,</span> <span class="k">enum</span> <span class="n">network_type</span> <span class="n">net_type</span><span class="p">,</span>
			  <span class="n">u8</span> <span class="n">beacon_ie_len</span><span class="p">,</span> <span class="n">u8</span> <span class="n">assoc_req_len</span><span class="p">,</span>
			  <span class="n">u8</span> <span class="n">assoc_resp_len</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">assoc_info</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_connect_ap_mode_bss</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl_vif</span> <span class="o">*</span><span class="n">vif</span><span class="p">,</span> <span class="n">u16</span> <span class="n">channel</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_connect_ap_mode_sta</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl_vif</span> <span class="o">*</span><span class="n">vif</span><span class="p">,</span> <span class="n">u16</span> <span class="n">aid</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">mac_addr</span><span class="p">,</span>
				<span class="n">u8</span> <span class="n">keymgmt</span><span class="p">,</span> <span class="n">u8</span> <span class="n">ucipher</span><span class="p">,</span> <span class="n">u8</span> <span class="n">auth</span><span class="p">,</span>
				<span class="n">u8</span> <span class="n">assoc_req_len</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">assoc_info</span><span class="p">,</span> <span class="n">u8</span> <span class="n">apsd_info</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_disconnect_event</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl_vif</span> <span class="o">*</span><span class="n">vif</span><span class="p">,</span> <span class="n">u8</span> <span class="n">reason</span><span class="p">,</span>
			     <span class="n">u8</span> <span class="o">*</span><span class="n">bssid</span><span class="p">,</span> <span class="n">u8</span> <span class="n">assoc_resp_len</span><span class="p">,</span>
			     <span class="n">u8</span> <span class="o">*</span><span class="n">assoc_info</span><span class="p">,</span> <span class="n">u16</span> <span class="n">prot_reason_status</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_tkip_micerr_event</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl_vif</span> <span class="o">*</span><span class="n">vif</span><span class="p">,</span> <span class="n">u8</span> <span class="n">keyid</span><span class="p">,</span> <span class="n">bool</span> <span class="n">ismcast</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_txpwr_rx_evt</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">devt</span><span class="p">,</span> <span class="n">u8</span> <span class="n">tx_pwr</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_scan_complete_evt</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl_vif</span> <span class="o">*</span><span class="n">vif</span><span class="p">,</span> <span class="kt">int</span> <span class="n">status</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_tgt_stats_event</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl_vif</span> <span class="o">*</span><span class="n">vif</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">ptr</span><span class="p">,</span> <span class="n">u32</span> <span class="n">len</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_indicate_tx_activity</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">devt</span><span class="p">,</span> <span class="n">u8</span> <span class="n">traffic_class</span><span class="p">,</span> <span class="n">bool</span> <span class="n">active</span><span class="p">);</span>
<span class="k">enum</span> <span class="n">htc_endpoint_id</span> <span class="n">ath6kl_ac2_endpoint_id</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">devt</span><span class="p">,</span> <span class="n">u8</span> <span class="n">ac</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">ath6kl_pspoll_event</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl_vif</span> <span class="o">*</span><span class="n">vif</span><span class="p">,</span> <span class="n">u8</span> <span class="n">aid</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">ath6kl_dtimexpiry_event</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl_vif</span> <span class="o">*</span><span class="n">vif</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_disconnect</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl_vif</span> <span class="o">*</span><span class="n">vif</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">aggr_recv_delba_req_evt</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl_vif</span> <span class="o">*</span><span class="n">vif</span><span class="p">,</span> <span class="n">u8</span> <span class="n">tid</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">aggr_recv_addba_req_evt</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl_vif</span> <span class="o">*</span><span class="n">vif</span><span class="p">,</span> <span class="n">u8</span> <span class="n">tid</span><span class="p">,</span> <span class="n">u16</span> <span class="n">seq_no</span><span class="p">,</span>
			     <span class="n">u8</span> <span class="n">win_sz</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_wakeup_event</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">ath6kl_reset_device</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">,</span> <span class="n">u32</span> <span class="n">target_type</span><span class="p">,</span>
			 <span class="n">bool</span> <span class="n">wait_fot_compltn</span><span class="p">,</span> <span class="n">bool</span> <span class="n">cold_reset</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_init_control_info</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl_vif</span> <span class="o">*</span><span class="n">vif</span><span class="p">);</span>
<span class="k">struct</span> <span class="n">ath6kl_vif</span> <span class="o">*</span><span class="n">ath6kl_vif_first</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_cleanup_vif</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl_vif</span> <span class="o">*</span><span class="n">vif</span><span class="p">,</span> <span class="n">bool</span> <span class="n">wmi_ready</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ath6kl_init_hw_start</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ath6kl_init_hw_stop</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ath6kl_init_fetch_firmwares</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ath6kl_init_hw_params</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">ath6kl_check_wow_status</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">ath6kl_core_tx_complete</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_core_rx_complete</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">,</span> <span class="n">u8</span> <span class="n">pipe</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ath6kl_core_create</span><span class="p">(</span><span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ath6kl_core_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">,</span> <span class="k">enum</span> <span class="n">ath6kl_htc_type</span> <span class="n">htc_type</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_core_cleanup</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath6kl_core_destroy</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath6kl</span> <span class="o">*</span><span class="n">ar</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* CORE_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
