<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › net › wireless › ath › ath5k › reg.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>reg.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright (c) 2006-2008 Nick Kossifidis &lt;mickflemm@gmail.com&gt;</span>
<span class="cm"> * Copyright (c) 2004-2008 Reyk Floeter &lt;reyk@openbsd.org&gt;</span>
<span class="cm"> * Copyright (c) 2007-2008 Michael Taylor &lt;mike.taylor@apprion.com&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * Permission to use, copy, modify, and distribute this software for any</span>
<span class="cm"> * purpose with or without fee is hereby granted, provided that the above</span>
<span class="cm"> * copyright notice and this permission notice appear in all copies.</span>
<span class="cm"> *</span>
<span class="cm"> * THE SOFTWARE IS PROVIDED &quot;AS IS&quot; AND THE AUTHOR DISCLAIMS ALL WARRANTIES</span>
<span class="cm"> * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF</span>
<span class="cm"> * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR</span>
<span class="cm"> * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES</span>
<span class="cm"> * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN</span>
<span class="cm"> * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF</span>
<span class="cm"> * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * Register values for Atheros 5210/5211/5212 cards from OpenBSD&#39;s ar5k</span>
<span class="cm"> * maintained by Reyk Floeter</span>
<span class="cm"> *</span>
<span class="cm"> * I tried to document those registers by looking at ar5k code, some</span>
<span class="cm"> * 802.11 (802.11e mostly) papers and by reading various public available</span>
<span class="cm"> * Atheros presentations and papers like these:</span>
<span class="cm"> *</span>
<span class="cm"> * 5210 - http://nova.stanford.edu/~bbaas/ps/isscc2002_slides.pdf</span>
<span class="cm"> *</span>
<span class="cm"> * 5211 - http://www.hotchips.org/archives/hc14/3_Tue/16_mcfarland.pdf</span>
<span class="cm"> *</span>
<span class="cm"> * This file also contains register values found on a memory dump of</span>
<span class="cm"> * Atheros&#39;s ART program (Atheros Radio Test), on ath9k, on legacy-hal</span>
<span class="cm"> * released by Atheros and on various debug messages found on the net.</span>
<span class="cm"> */</span>

<span class="cp">#include &quot;../reg.h&quot;</span>

<span class="cm">/*====MAC DMA REGISTERS====*/</span>

<span class="cm">/*</span>
<span class="cm"> * AR5210-Specific TXDP registers</span>
<span class="cm"> * 5210 has only 2 transmit queues so no DCU/QCU, just</span>
<span class="cm"> * 2 transmit descriptor pointers...</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_NOQCU_TXDP0	0x0000		</span><span class="cm">/* Queue 0 - data */</span><span class="cp"></span>
<span class="cp">#define AR5K_NOQCU_TXDP1	0x0004		</span><span class="cm">/* Queue 1 - beacons */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Mac Control Register</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_CR		0x0008			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_CR_TXE0	0x00000001	</span><span class="cm">/* TX Enable for queue 0 on 5210 */</span><span class="cp"></span>
<span class="cp">#define AR5K_CR_TXE1	0x00000002	</span><span class="cm">/* TX Enable for queue 1 on 5210 */</span><span class="cp"></span>
<span class="cp">#define	AR5K_CR_RXE	0x00000004	</span><span class="cm">/* RX Enable */</span><span class="cp"></span>
<span class="cp">#define AR5K_CR_TXD0	0x00000008	</span><span class="cm">/* TX Disable for queue 0 on 5210 */</span><span class="cp"></span>
<span class="cp">#define AR5K_CR_TXD1	0x00000010	</span><span class="cm">/* TX Disable for queue 1 on 5210 */</span><span class="cp"></span>
<span class="cp">#define	AR5K_CR_RXD	0x00000020	</span><span class="cm">/* RX Disable */</span><span class="cp"></span>
<span class="cp">#define	AR5K_CR_SWI	0x00000040	</span><span class="cm">/* Software Interrupt */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * RX Descriptor Pointer register</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_RXDP	0x000c</span>

<span class="cm">/*</span>
<span class="cm"> * Configuration and status register</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_CFG		0x0014			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_CFG_SWTD		0x00000001	</span><span class="cm">/* Byte-swap TX descriptor (for big endian archs) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_CFG_SWTB		0x00000002	</span><span class="cm">/* Byte-swap TX buffer */</span><span class="cp"></span>
<span class="cp">#define	AR5K_CFG_SWRD		0x00000004	</span><span class="cm">/* Byte-swap RX descriptor */</span><span class="cp"></span>
<span class="cp">#define	AR5K_CFG_SWRB		0x00000008	</span><span class="cm">/* Byte-swap RX buffer */</span><span class="cp"></span>
<span class="cp">#define	AR5K_CFG_SWRG		0x00000010	</span><span class="cm">/* Byte-swap Register access */</span><span class="cp"></span>
<span class="cp">#define AR5K_CFG_IBSS		0x00000020	</span><span class="cm">/* 0-BSS, 1-IBSS [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_CFG_PHY_OK		0x00000100	</span><span class="cm">/* [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_CFG_EEBS		0x00000200	</span><span class="cm">/* EEPROM is busy */</span><span class="cp"></span>
<span class="cp">#define	AR5K_CFG_CLKGD		0x00000400	</span><span class="cm">/* Clock gated (Disable dynamic clock) */</span><span class="cp"></span>
<span class="cp">#define AR5K_CFG_TXCNT		0x00007800	</span><span class="cm">/* Tx frame count (?) [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_CFG_TXCNT_S	11</span>
<span class="cp">#define AR5K_CFG_TXFSTAT	0x00008000	</span><span class="cm">/* Tx frame status (?) [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_CFG_TXFSTRT	0x00010000	</span><span class="cm">/* [5210] */</span><span class="cp"></span>
<span class="cp">#define	AR5K_CFG_PCI_THRES	0x00060000	</span><span class="cm">/* PCI Master req q threshold [5211+] */</span><span class="cp"></span>
<span class="cp">#define	AR5K_CFG_PCI_THRES_S	17</span>

<span class="cm">/*</span>
<span class="cm"> * Interrupt enable register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_IER		0x0024		</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_IER_DISABLE	0x00000000	</span><span class="cm">/* Disable card interrupts */</span><span class="cp"></span>
<span class="cp">#define AR5K_IER_ENABLE		0x00000001	</span><span class="cm">/* Enable card interrupts */</span><span class="cp"></span>


<span class="cm">/*</span>
<span class="cm"> * 0x0028 is Beacon Control Register on 5210</span>
<span class="cm"> * and first RTS duration register on 5211</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * Beacon control register [5210]</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_BCR		0x0028		</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_BCR_AP		0x00000000	</span><span class="cm">/* AP mode */</span><span class="cp"></span>
<span class="cp">#define AR5K_BCR_ADHOC		0x00000001	</span><span class="cm">/* Ad-Hoc mode */</span><span class="cp"></span>
<span class="cp">#define AR5K_BCR_BDMAE		0x00000002	</span><span class="cm">/* DMA enable */</span><span class="cp"></span>
<span class="cp">#define AR5K_BCR_TQ1FV		0x00000004	</span><span class="cm">/* Use Queue1 for CAB traffic */</span><span class="cp"></span>
<span class="cp">#define AR5K_BCR_TQ1V		0x00000008	</span><span class="cm">/* Use Queue1 for Beacon traffic */</span><span class="cp"></span>
<span class="cp">#define AR5K_BCR_BCGET		0x00000010</span>

<span class="cm">/*</span>
<span class="cm"> * First RTS duration register [5211]</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_RTSD0		0x0028		</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_RTSD0_6		0x000000ff	</span><span class="cm">/* 6Mb RTS duration mask (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_RTSD0_6_S		0		</span><span class="cm">/* 6Mb RTS duration shift (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_RTSD0_9		0x0000ff00	</span><span class="cm">/* 9Mb*/</span><span class="cp"></span>
<span class="cp">#define	AR5K_RTSD0_9_S		8</span>
<span class="cp">#define	AR5K_RTSD0_12		0x00ff0000	</span><span class="cm">/* 12Mb*/</span><span class="cp"></span>
<span class="cp">#define	AR5K_RTSD0_12_S		16</span>
<span class="cp">#define	AR5K_RTSD0_18		0xff000000	</span><span class="cm">/* 16Mb*/</span><span class="cp"></span>
<span class="cp">#define	AR5K_RTSD0_18_S		24</span>


<span class="cm">/*</span>
<span class="cm"> * 0x002c is Beacon Status Register on 5210</span>
<span class="cm"> * and second RTS duration register on 5211</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * Beacon status register [5210]</span>
<span class="cm"> *</span>
<span class="cm"> * As i can see in ar5k_ar5210_tx_start Reyk uses some of the values of BCR</span>
<span class="cm"> * for this register, so i guess TQ1V,TQ1FV and BDMAE have the same meaning</span>
<span class="cm"> * here and SNP/SNAP means &quot;snapshot&quot; (so this register gets synced with BCR).</span>
<span class="cm"> * So SNAPPEDBCRVALID should also stand for &quot;snapped BCR -values- valid&quot;, so i</span>
<span class="cm"> * renamed it to SNAPSHOTSVALID to make more sense. I really have no idea what</span>
<span class="cm"> * else can it be. I also renamed SNPBCMD to SNPADHOC to match BCR.</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_BSR		0x002c			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_BSR_BDLYSW		0x00000001	</span><span class="cm">/* SW Beacon delay (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_BSR_BDLYDMA	0x00000002	</span><span class="cm">/* DMA Beacon delay (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_BSR_TXQ1F		0x00000004	</span><span class="cm">/* Beacon queue (1) finished */</span><span class="cp"></span>
<span class="cp">#define AR5K_BSR_ATIMDLY	0x00000008	</span><span class="cm">/* ATIM delay (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_BSR_SNPADHOC	0x00000100	</span><span class="cm">/* Ad-hoc mode set (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_BSR_SNPBDMAE	0x00000200	</span><span class="cm">/* Beacon DMA enabled (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_BSR_SNPTQ1FV	0x00000400	</span><span class="cm">/* Queue1 is used for CAB traffic (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_BSR_SNPTQ1V	0x00000800	</span><span class="cm">/* Queue1 is used for Beacon traffic (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_BSR_SNAPSHOTSVALID	0x00001000	</span><span class="cm">/* BCR snapshots are valid (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_BSR_SWBA_CNT	0x00ff0000</span>

<span class="cm">/*</span>
<span class="cm"> * Second RTS duration register [5211]</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_RTSD1		0x002c			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_RTSD1_24		0x000000ff	</span><span class="cm">/* 24Mb */</span><span class="cp"></span>
<span class="cp">#define	AR5K_RTSD1_24_S		0</span>
<span class="cp">#define	AR5K_RTSD1_36		0x0000ff00	</span><span class="cm">/* 36Mb */</span><span class="cp"></span>
<span class="cp">#define	AR5K_RTSD1_36_S		8</span>
<span class="cp">#define	AR5K_RTSD1_48		0x00ff0000	</span><span class="cm">/* 48Mb */</span><span class="cp"></span>
<span class="cp">#define	AR5K_RTSD1_48_S		16</span>
<span class="cp">#define	AR5K_RTSD1_54		0xff000000	</span><span class="cm">/* 54Mb */</span><span class="cp"></span>
<span class="cp">#define	AR5K_RTSD1_54_S		24</span>


<span class="cm">/*</span>
<span class="cm"> * Transmit configuration register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_TXCFG			0x0030			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_TXCFG_SDMAMR		0x00000007	</span><span class="cm">/* DMA size (read) */</span><span class="cp"></span>
<span class="cp">#define AR5K_TXCFG_SDMAMR_S		0</span>
<span class="cp">#define AR5K_TXCFG_B_MODE		0x00000008	</span><span class="cm">/* Set b mode for 5111 (enable 2111) */</span><span class="cp"></span>
<span class="cp">#define AR5K_TXCFG_TXFSTP		0x00000008	</span><span class="cm">/* TX DMA full Stop [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_TXCFG_TXFULL		0x000003f0	</span><span class="cm">/* TX Trigger level mask */</span><span class="cp"></span>
<span class="cp">#define AR5K_TXCFG_TXFULL_S		4</span>
<span class="cp">#define AR5K_TXCFG_TXFULL_0B		0x00000000</span>
<span class="cp">#define AR5K_TXCFG_TXFULL_64B		0x00000010</span>
<span class="cp">#define AR5K_TXCFG_TXFULL_128B		0x00000020</span>
<span class="cp">#define AR5K_TXCFG_TXFULL_192B		0x00000030</span>
<span class="cp">#define AR5K_TXCFG_TXFULL_256B		0x00000040</span>
<span class="cp">#define AR5K_TXCFG_TXCONT_EN		0x00000080</span>
<span class="cp">#define AR5K_TXCFG_DMASIZE		0x00000100	</span><span class="cm">/* Flag for passing DMA size [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_TXCFG_JUMBO_DESC_EN	0x00000400	</span><span class="cm">/* Enable jumbo tx descriptors [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_TXCFG_ADHOC_BCN_ATIM	0x00000800	</span><span class="cm">/* Adhoc Beacon ATIM Policy */</span><span class="cp"></span>
<span class="cp">#define AR5K_TXCFG_ATIM_WINDOW_DEF_DIS	0x00001000	</span><span class="cm">/* Disable ATIM window defer [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_TXCFG_RTSRND		0x00001000	</span><span class="cm">/* [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_TXCFG_FRMPAD_DIS		0x00002000	</span><span class="cm">/* [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_TXCFG_RDY_CBR_DIS		0x00004000	</span><span class="cm">/* Ready time CBR disable [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_TXCFG_JUMBO_FRM_MODE	0x00008000	</span><span class="cm">/* Jumbo frame mode [5211+] */</span><span class="cp"></span>
<span class="cp">#define	AR5K_TXCFG_DCU_DBL_BUF_DIS	0x00008000	</span><span class="cm">/* Disable double buffering on DCU */</span><span class="cp"></span>
<span class="cp">#define AR5K_TXCFG_DCU_CACHING_DIS	0x00010000	</span><span class="cm">/* Disable DCU caching */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Receive configuration register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_RXCFG		0x0034			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_RXCFG_SDMAMW	0x00000007	</span><span class="cm">/* DMA size (write) */</span><span class="cp"></span>
<span class="cp">#define AR5K_RXCFG_SDMAMW_S	0</span>
<span class="cp">#define AR5K_RXCFG_ZLFDMA	0x00000008	</span><span class="cm">/* Enable Zero-length frame DMA */</span><span class="cp"></span>
<span class="cp">#define	AR5K_RXCFG_DEF_ANTENNA	0x00000010	</span><span class="cm">/* Default antenna (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_RXCFG_JUMBO_RXE	0x00000020	</span><span class="cm">/* Enable jumbo rx descriptors [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_RXCFG_JUMBO_WRAP	0x00000040	</span><span class="cm">/* Wrap jumbo frames [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_RXCFG_SLE_ENTRY	0x00000080	</span><span class="cm">/* Sleep entry policy */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Receive jumbo descriptor last address register</span>
<span class="cm"> * Only found in 5211 (?)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_RXJLA		0x0038</span>

<span class="cm">/*</span>
<span class="cm"> * MIB control register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_MIBC		0x0040			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_MIBC_COW		0x00000001	</span><span class="cm">/* Counter Overflow Warning */</span><span class="cp"></span>
<span class="cp">#define AR5K_MIBC_FMC		0x00000002	</span><span class="cm">/* Freeze MIB Counters  */</span><span class="cp"></span>
<span class="cp">#define AR5K_MIBC_CMC		0x00000004	</span><span class="cm">/* Clear MIB Counters  */</span><span class="cp"></span>
<span class="cp">#define AR5K_MIBC_MCS		0x00000008	</span><span class="cm">/* MIB counter strobe, increment all */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Timeout prescale register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_TOPS		0x0044</span>
<span class="cp">#define	AR5K_TOPS_M		0x0000ffff</span>

<span class="cm">/*</span>
<span class="cm"> * Receive timeout register (no frame received)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_RXNOFRM		0x0048</span>
<span class="cp">#define	AR5K_RXNOFRM_M		0x000003ff</span>

<span class="cm">/*</span>
<span class="cm"> * Transmit timeout register (no frame sent)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_TXNOFRM		0x004c</span>
<span class="cp">#define	AR5K_TXNOFRM_M		0x000003ff</span>
<span class="cp">#define	AR5K_TXNOFRM_QCU	0x000ffc00</span>
<span class="cp">#define	AR5K_TXNOFRM_QCU_S	10</span>

<span class="cm">/*</span>
<span class="cm"> * Receive frame gap timeout register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_RPGTO		0x0050</span>
<span class="cp">#define AR5K_RPGTO_M		0x000003ff</span>

<span class="cm">/*</span>
<span class="cm"> * Receive frame count limit register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_RFCNT		0x0054</span>
<span class="cp">#define AR5K_RFCNT_M		0x0000001f	</span><span class="cm">/* [5211+] (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_RFCNT_RFCL		0x0000000f	</span><span class="cm">/* [5210] */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Misc settings register</span>
<span class="cm"> * (reserved0-3)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_MISC		0x0058			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_MISC_DMA_OBS_M	0x000001e0</span>
<span class="cp">#define	AR5K_MISC_DMA_OBS_S	5</span>
<span class="cp">#define	AR5K_MISC_MISC_OBS_M	0x00000e00</span>
<span class="cp">#define	AR5K_MISC_MISC_OBS_S	9</span>
<span class="cp">#define	AR5K_MISC_MAC_OBS_LSB_M	0x00007000</span>
<span class="cp">#define	AR5K_MISC_MAC_OBS_LSB_S	12</span>
<span class="cp">#define	AR5K_MISC_MAC_OBS_MSB_M	0x00038000</span>
<span class="cp">#define	AR5K_MISC_MAC_OBS_MSB_S	15</span>
<span class="cp">#define AR5K_MISC_LED_DECAY	0x001c0000	</span><span class="cm">/* [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_MISC_LED_BLINK	0x00e00000	</span><span class="cm">/* [5210] */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * QCU/DCU clock gating register (5311)</span>
<span class="cm"> * (reserved4-5)</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_QCUDCU_CLKGT	0x005c			</span><span class="cm">/* Register Address (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_QCUDCU_CLKGT_QCU	0x0000ffff	</span><span class="cm">/* Mask for QCU clock */</span><span class="cp"></span>
<span class="cp">#define	AR5K_QCUDCU_CLKGT_DCU	0x07ff0000	</span><span class="cm">/* Mask for DCU clock */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Interrupt Status Registers</span>
<span class="cm"> *</span>
<span class="cm"> * For 5210 there is only one status register but for</span>
<span class="cm"> * 5211/5212 we have one primary and 4 secondary registers.</span>
<span class="cm"> * So we have AR5K_ISR for 5210 and AR5K_PISR /SISRx for 5211/5212.</span>
<span class="cm"> * Most of these bits are common for all chipsets.</span>
<span class="cm"> *</span>
<span class="cm"> * NOTE: On 5211+ TXOK, TXDESC, TXERR, TXEOL and TXURN contain</span>
<span class="cm"> * the logical OR from per-queue interrupt bits found on SISR registers</span>
<span class="cm"> * (see below).</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_ISR		0x001c			</span><span class="cm">/* Register Address [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_PISR		0x0080			</span><span class="cm">/* Register Address [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_RXOK		0x00000001	</span><span class="cm">/* Frame successfully received */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_RXDESC		0x00000002	</span><span class="cm">/* RX descriptor request */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_RXERR		0x00000004	</span><span class="cm">/* Receive error */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_RXNOFRM	0x00000008	</span><span class="cm">/* No frame received (receive timeout) */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_RXEOL		0x00000010	</span><span class="cm">/* Empty RX descriptor */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_RXORN		0x00000020	</span><span class="cm">/* Receive FIFO overrun */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_TXOK		0x00000040	</span><span class="cm">/* Frame successfully transmitted */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_TXDESC		0x00000080	</span><span class="cm">/* TX descriptor request */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_TXERR		0x00000100	</span><span class="cm">/* Transmit error */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_TXNOFRM	0x00000200	</span><span class="cm">/* No frame transmitted (transmit timeout)</span>
<span class="cm">						 * NOTE: We don&#39;t have per-queue info for this</span>
<span class="cm">						 * one, but we can enable it per-queue through</span>
<span class="cm">						 * TXNOFRM_QCU field on TXNOFRM register */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_TXEOL		0x00000400	</span><span class="cm">/* Empty TX descriptor */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_TXURN		0x00000800	</span><span class="cm">/* Transmit FIFO underrun */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_MIB		0x00001000	</span><span class="cm">/* Update MIB counters */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_SWI		0x00002000	</span><span class="cm">/* Software interrupt */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_RXPHY		0x00004000	</span><span class="cm">/* PHY error */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_RXKCM		0x00008000	</span><span class="cm">/* RX Key cache miss */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_SWBA		0x00010000	</span><span class="cm">/* Software beacon alert */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_BRSSI		0x00020000	</span><span class="cm">/* Beacon rssi below threshold (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_BMISS		0x00040000	</span><span class="cm">/* Beacon missed */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_HIUERR		0x00080000	</span><span class="cm">/* Host Interface Unit error [5211+]</span>
<span class="cm">						 * &#39;or&#39; of MCABT, SSERR, DPERR from SISR2 */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_BNR		0x00100000	</span><span class="cm">/* Beacon not ready [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_MCABT		0x00100000	</span><span class="cm">/* Master Cycle Abort [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_RXCHIRP	0x00200000	</span><span class="cm">/* CHIRP Received [5212+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_SSERR		0x00200000	</span><span class="cm">/* Signaled System Error [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_DPERR		0x00400000	</span><span class="cm">/* Bus parity error [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_RXDOPPLER	0x00400000	</span><span class="cm">/* Doppler chirp received [5212+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_TIM		0x00800000	</span><span class="cm">/* [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_BCNMISC	0x00800000	</span><span class="cm">/* Misc beacon related interrupt</span>
<span class="cm">						 * &#39;or&#39; of TIM, CAB_END, DTIM_SYNC, BCN_TIMEOUT,</span>
<span class="cm">						 * CAB_TIMEOUT and DTIM bits from SISR2 [5212+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_GPIO		0x01000000	</span><span class="cm">/* GPIO (rf kill) */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_QCBRORN	0x02000000	</span><span class="cm">/* QCU CBR overrun [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_QCBRURN	0x04000000	</span><span class="cm">/* QCU CBR underrun [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_ISR_QTRIG		0x08000000	</span><span class="cm">/* QCU scheduling trigger [5211+] */</span><span class="cp"></span>

<span class="cp">#define	AR5K_ISR_BITS_FROM_SISRS	(AR5K_ISR_TXOK | AR5K_ISR_TXDESC |\</span>
<span class="cp">					AR5K_ISR_TXERR | AR5K_ISR_TXEOL |\</span>
<span class="cp">					AR5K_ISR_TXURN | AR5K_ISR_HIUERR |\</span>
<span class="cp">					AR5K_ISR_BCNMISC | AR5K_ISR_QCBRORN |\</span>
<span class="cp">					AR5K_ISR_QCBRURN | AR5K_ISR_QTRIG)</span>

<span class="cm">/*</span>
<span class="cm"> * Secondary status registers [5211+] (0 - 4)</span>
<span class="cm"> *</span>
<span class="cm"> * These give the status for each QCU, only QCUs 0-9 are</span>
<span class="cm"> * represented.</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_SISR0		0x0084			</span><span class="cm">/* Register Address [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_SISR0_QCU_TXOK	0x000003ff	</span><span class="cm">/* Mask for QCU_TXOK */</span><span class="cp"></span>
<span class="cp">#define AR5K_SISR0_QCU_TXOK_S	0</span>
<span class="cp">#define AR5K_SISR0_QCU_TXDESC	0x03ff0000	</span><span class="cm">/* Mask for QCU_TXDESC */</span><span class="cp"></span>
<span class="cp">#define AR5K_SISR0_QCU_TXDESC_S	16</span>

<span class="cp">#define AR5K_SISR1		0x0088			</span><span class="cm">/* Register Address [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_SISR1_QCU_TXERR	0x000003ff	</span><span class="cm">/* Mask for QCU_TXERR */</span><span class="cp"></span>
<span class="cp">#define AR5K_SISR1_QCU_TXERR_S	0</span>
<span class="cp">#define AR5K_SISR1_QCU_TXEOL	0x03ff0000	</span><span class="cm">/* Mask for QCU_TXEOL */</span><span class="cp"></span>
<span class="cp">#define AR5K_SISR1_QCU_TXEOL_S	16</span>

<span class="cp">#define AR5K_SISR2		0x008c			</span><span class="cm">/* Register Address [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_SISR2_QCU_TXURN	0x000003ff	</span><span class="cm">/* Mask for QCU_TXURN */</span><span class="cp"></span>
<span class="cp">#define	AR5K_SISR2_QCU_TXURN_S	0</span>
<span class="cp">#define	AR5K_SISR2_MCABT	0x00010000	</span><span class="cm">/* Master Cycle Abort */</span><span class="cp"></span>
<span class="cp">#define	AR5K_SISR2_SSERR	0x00020000	</span><span class="cm">/* Signaled System Error */</span><span class="cp"></span>
<span class="cp">#define	AR5K_SISR2_DPERR	0x00040000	</span><span class="cm">/* Bus parity error */</span><span class="cp"></span>
<span class="cp">#define	AR5K_SISR2_TIM		0x01000000	</span><span class="cm">/* [5212+] */</span><span class="cp"></span>
<span class="cp">#define	AR5K_SISR2_CAB_END	0x02000000	</span><span class="cm">/* [5212+] */</span><span class="cp"></span>
<span class="cp">#define	AR5K_SISR2_DTIM_SYNC	0x04000000	</span><span class="cm">/* DTIM sync lost [5212+] */</span><span class="cp"></span>
<span class="cp">#define	AR5K_SISR2_BCN_TIMEOUT	0x08000000	</span><span class="cm">/* Beacon Timeout [5212+] */</span><span class="cp"></span>
<span class="cp">#define	AR5K_SISR2_CAB_TIMEOUT	0x10000000	</span><span class="cm">/* CAB Timeout [5212+] */</span><span class="cp"></span>
<span class="cp">#define	AR5K_SISR2_DTIM		0x20000000	</span><span class="cm">/* [5212+] */</span><span class="cp"></span>
<span class="cp">#define	AR5K_SISR2_TSFOOR	0x80000000	</span><span class="cm">/* TSF Out of range */</span><span class="cp"></span>

<span class="cp">#define AR5K_SISR3		0x0090			</span><span class="cm">/* Register Address [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_SISR3_QCBRORN	0x000003ff	</span><span class="cm">/* Mask for QCBRORN */</span><span class="cp"></span>
<span class="cp">#define AR5K_SISR3_QCBRORN_S	0</span>
<span class="cp">#define AR5K_SISR3_QCBRURN	0x03ff0000	</span><span class="cm">/* Mask for QCBRURN */</span><span class="cp"></span>
<span class="cp">#define AR5K_SISR3_QCBRURN_S	16</span>

<span class="cp">#define AR5K_SISR4		0x0094			</span><span class="cm">/* Register Address [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_SISR4_QTRIG	0x000003ff	</span><span class="cm">/* Mask for QTRIG */</span><span class="cp"></span>
<span class="cp">#define AR5K_SISR4_QTRIG_S	0</span>

<span class="cm">/*</span>
<span class="cm"> * Shadow read-and-clear interrupt status registers [5211+]</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_RAC_PISR		0x00c0		</span><span class="cm">/* Read and clear PISR */</span><span class="cp"></span>
<span class="cp">#define AR5K_RAC_SISR0		0x00c4		</span><span class="cm">/* Read and clear SISR0 */</span><span class="cp"></span>
<span class="cp">#define AR5K_RAC_SISR1		0x00c8		</span><span class="cm">/* Read and clear SISR1 */</span><span class="cp"></span>
<span class="cp">#define AR5K_RAC_SISR2		0x00cc		</span><span class="cm">/* Read and clear SISR2 */</span><span class="cp"></span>
<span class="cp">#define AR5K_RAC_SISR3		0x00d0		</span><span class="cm">/* Read and clear SISR3 */</span><span class="cp"></span>
<span class="cp">#define AR5K_RAC_SISR4		0x00d4		</span><span class="cm">/* Read and clear SISR4 */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Interrupt Mask Registers</span>
<span class="cm"> *</span>
<span class="cm"> * As with ISRs 5210 has one IMR (AR5K_IMR) and 5211/5212 has one primary</span>
<span class="cm"> * (AR5K_PIMR) and 4 secondary IMRs (AR5K_SIMRx). Note that ISR/IMR flags match.</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_IMR		0x0020			</span><span class="cm">/* Register Address [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_PIMR		0x00a0			</span><span class="cm">/* Register Address [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_RXOK		0x00000001	</span><span class="cm">/* Frame successfully received*/</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_RXDESC		0x00000002	</span><span class="cm">/* RX descriptor request*/</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_RXERR		0x00000004	</span><span class="cm">/* Receive error*/</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_RXNOFRM	0x00000008	</span><span class="cm">/* No frame received (receive timeout)*/</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_RXEOL		0x00000010	</span><span class="cm">/* Empty RX descriptor*/</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_RXORN		0x00000020	</span><span class="cm">/* Receive FIFO overrun*/</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_TXOK		0x00000040	</span><span class="cm">/* Frame successfully transmitted*/</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_TXDESC		0x00000080	</span><span class="cm">/* TX descriptor request*/</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_TXERR		0x00000100	</span><span class="cm">/* Transmit error*/</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_TXNOFRM	0x00000200	</span><span class="cm">/* No frame transmitted (transmit timeout)*/</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_TXEOL		0x00000400	</span><span class="cm">/* Empty TX descriptor*/</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_TXURN		0x00000800	</span><span class="cm">/* Transmit FIFO underrun*/</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_MIB		0x00001000	</span><span class="cm">/* Update MIB counters*/</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_SWI		0x00002000	</span><span class="cm">/* Software interrupt */</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_RXPHY		0x00004000	</span><span class="cm">/* PHY error*/</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_RXKCM		0x00008000	</span><span class="cm">/* RX Key cache miss */</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_SWBA		0x00010000	</span><span class="cm">/* Software beacon alert*/</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_BRSSI		0x00020000	</span><span class="cm">/* Beacon rssi below threshold (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_BMISS		0x00040000	</span><span class="cm">/* Beacon missed*/</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_HIUERR		0x00080000	</span><span class="cm">/* Host Interface Unit error [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_BNR		0x00100000	</span><span class="cm">/* Beacon not ready [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_MCABT		0x00100000	</span><span class="cm">/* Master Cycle Abort [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_RXCHIRP	0x00200000	</span><span class="cm">/* CHIRP Received [5212+]*/</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_SSERR		0x00200000	</span><span class="cm">/* Signaled System Error [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_DPERR		0x00400000	</span><span class="cm">/* Det par Error (?) [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_RXDOPPLER	0x00400000	</span><span class="cm">/* Doppler chirp received [5212+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_TIM		0x00800000	</span><span class="cm">/* [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_BCNMISC	0x00800000	</span><span class="cm">/* &#39;or&#39; of TIM, CAB_END, DTIM_SYNC, BCN_TIMEOUT,</span>
<span class="cm">						CAB_TIMEOUT and DTIM bits from SISR2 [5212+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_GPIO		0x01000000	</span><span class="cm">/* GPIO (rf kill)*/</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_QCBRORN	0x02000000	</span><span class="cm">/* QCU CBR overrun (?) [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_QCBRURN	0x04000000	</span><span class="cm">/* QCU CBR underrun (?) [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_IMR_QTRIG		0x08000000	</span><span class="cm">/* QCU scheduling trigger [5211+] */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Secondary interrupt mask registers [5211+] (0 - 4)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_SIMR0		0x00a4			</span><span class="cm">/* Register Address [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_SIMR0_QCU_TXOK	0x000003ff	</span><span class="cm">/* Mask for QCU_TXOK */</span><span class="cp"></span>
<span class="cp">#define AR5K_SIMR0_QCU_TXOK_S	0</span>
<span class="cp">#define AR5K_SIMR0_QCU_TXDESC	0x03ff0000	</span><span class="cm">/* Mask for QCU_TXDESC */</span><span class="cp"></span>
<span class="cp">#define AR5K_SIMR0_QCU_TXDESC_S	16</span>

<span class="cp">#define AR5K_SIMR1		0x00a8			</span><span class="cm">/* Register Address [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_SIMR1_QCU_TXERR	0x000003ff	</span><span class="cm">/* Mask for QCU_TXERR */</span><span class="cp"></span>
<span class="cp">#define AR5K_SIMR1_QCU_TXERR_S	0</span>
<span class="cp">#define AR5K_SIMR1_QCU_TXEOL	0x03ff0000	</span><span class="cm">/* Mask for QCU_TXEOL */</span><span class="cp"></span>
<span class="cp">#define AR5K_SIMR1_QCU_TXEOL_S	16</span>

<span class="cp">#define AR5K_SIMR2		0x00ac			</span><span class="cm">/* Register Address [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_SIMR2_QCU_TXURN	0x000003ff	</span><span class="cm">/* Mask for QCU_TXURN */</span><span class="cp"></span>
<span class="cp">#define AR5K_SIMR2_QCU_TXURN_S	0</span>
<span class="cp">#define	AR5K_SIMR2_MCABT	0x00010000	</span><span class="cm">/* Master Cycle Abort */</span><span class="cp"></span>
<span class="cp">#define	AR5K_SIMR2_SSERR	0x00020000	</span><span class="cm">/* Signaled System Error */</span><span class="cp"></span>
<span class="cp">#define	AR5K_SIMR2_DPERR	0x00040000	</span><span class="cm">/* Bus parity error */</span><span class="cp"></span>
<span class="cp">#define	AR5K_SIMR2_TIM		0x01000000	</span><span class="cm">/* [5212+] */</span><span class="cp"></span>
<span class="cp">#define	AR5K_SIMR2_CAB_END	0x02000000	</span><span class="cm">/* [5212+] */</span><span class="cp"></span>
<span class="cp">#define	AR5K_SIMR2_DTIM_SYNC	0x04000000	</span><span class="cm">/* DTIM Sync lost [5212+] */</span><span class="cp"></span>
<span class="cp">#define	AR5K_SIMR2_BCN_TIMEOUT	0x08000000	</span><span class="cm">/* Beacon Timeout [5212+] */</span><span class="cp"></span>
<span class="cp">#define	AR5K_SIMR2_CAB_TIMEOUT	0x10000000	</span><span class="cm">/* CAB Timeout [5212+] */</span><span class="cp"></span>
<span class="cp">#define	AR5K_SIMR2_DTIM		0x20000000	</span><span class="cm">/* [5212+] */</span><span class="cp"></span>
<span class="cp">#define	AR5K_SIMR2_TSFOOR	0x80000000	</span><span class="cm">/* TSF OOR (?) */</span><span class="cp"></span>

<span class="cp">#define AR5K_SIMR3		0x00b0			</span><span class="cm">/* Register Address [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_SIMR3_QCBRORN	0x000003ff	</span><span class="cm">/* Mask for QCBRORN */</span><span class="cp"></span>
<span class="cp">#define AR5K_SIMR3_QCBRORN_S	0</span>
<span class="cp">#define AR5K_SIMR3_QCBRURN	0x03ff0000	</span><span class="cm">/* Mask for QCBRURN */</span><span class="cp"></span>
<span class="cp">#define AR5K_SIMR3_QCBRURN_S	16</span>

<span class="cp">#define AR5K_SIMR4		0x00b4			</span><span class="cm">/* Register Address [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_SIMR4_QTRIG	0x000003ff	</span><span class="cm">/* Mask for QTRIG */</span><span class="cp"></span>
<span class="cp">#define AR5K_SIMR4_QTRIG_S	0</span>

<span class="cm">/*</span>
<span class="cm"> * DMA Debug registers 0-7</span>
<span class="cm"> * 0xe0 - 0xfc</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * Decompression mask registers [5212+]</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_DCM_ADDR		0x0400		</span><span class="cm">/*Decompression mask address (index) */</span><span class="cp"></span>
<span class="cp">#define AR5K_DCM_DATA		0x0404		</span><span class="cm">/*Decompression mask data */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Wake On Wireless pattern control register [5212+]</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_WOW_PCFG			0x0410			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_WOW_PCFG_PAT_MATCH_EN	0x00000001	</span><span class="cm">/* Pattern match enable */</span><span class="cp"></span>
<span class="cp">#define	AR5K_WOW_PCFG_LONG_FRAME_POL	0x00000002	</span><span class="cm">/* Long frame policy */</span><span class="cp"></span>
<span class="cp">#define	AR5K_WOW_PCFG_WOBMISS		0x00000004	</span><span class="cm">/* Wake on bea(con) miss (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_WOW_PCFG_PAT_0_EN		0x00000100	</span><span class="cm">/* Enable pattern 0 */</span><span class="cp"></span>
<span class="cp">#define	AR5K_WOW_PCFG_PAT_1_EN		0x00000200	</span><span class="cm">/* Enable pattern 1 */</span><span class="cp"></span>
<span class="cp">#define	AR5K_WOW_PCFG_PAT_2_EN		0x00000400	</span><span class="cm">/* Enable pattern 2 */</span><span class="cp"></span>
<span class="cp">#define	AR5K_WOW_PCFG_PAT_3_EN		0x00000800	</span><span class="cm">/* Enable pattern 3 */</span><span class="cp"></span>
<span class="cp">#define	AR5K_WOW_PCFG_PAT_4_EN		0x00001000	</span><span class="cm">/* Enable pattern 4 */</span><span class="cp"></span>
<span class="cp">#define	AR5K_WOW_PCFG_PAT_5_EN		0x00002000	</span><span class="cm">/* Enable pattern 5 */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Wake On Wireless pattern index register (?) [5212+]</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_WOW_PAT_IDX	0x0414</span>

<span class="cm">/*</span>
<span class="cm"> * Wake On Wireless pattern data register [5212+]</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_WOW_PAT_DATA	0x0418			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_WOW_PAT_DATA_0_3_V	0x00000001	</span><span class="cm">/* Pattern 0, 3 value */</span><span class="cp"></span>
<span class="cp">#define	AR5K_WOW_PAT_DATA_1_4_V	0x00000100	</span><span class="cm">/* Pattern 1, 4 value */</span><span class="cp"></span>
<span class="cp">#define	AR5K_WOW_PAT_DATA_2_5_V	0x00010000	</span><span class="cm">/* Pattern 2, 5 value */</span><span class="cp"></span>
<span class="cp">#define	AR5K_WOW_PAT_DATA_0_3_M	0x01000000	</span><span class="cm">/* Pattern 0, 3 mask */</span><span class="cp"></span>
<span class="cp">#define	AR5K_WOW_PAT_DATA_1_4_M	0x04000000	</span><span class="cm">/* Pattern 1, 4 mask */</span><span class="cp"></span>
<span class="cp">#define	AR5K_WOW_PAT_DATA_2_5_M	0x10000000	</span><span class="cm">/* Pattern 2, 5 mask */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Decompression configuration registers [5212+]</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_DCCFG		0x0420			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_DCCFG_GLOBAL_EN	0x00000001	</span><span class="cm">/* Enable decompression on all queues */</span><span class="cp"></span>
<span class="cp">#define AR5K_DCCFG_BYPASS_EN	0x00000002	</span><span class="cm">/* Bypass decompression */</span><span class="cp"></span>
<span class="cp">#define AR5K_DCCFG_BCAST_EN	0x00000004	</span><span class="cm">/* Enable decompression for bcast frames */</span><span class="cp"></span>
<span class="cp">#define AR5K_DCCFG_MCAST_EN	0x00000008	</span><span class="cm">/* Enable decompression for mcast frames */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Compression configuration registers [5212+]</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_CCFG		0x0600			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_CCFG_WINDOW_SIZE	0x00000007	</span><span class="cm">/* Compression window size */</span><span class="cp"></span>
<span class="cp">#define	AR5K_CCFG_CPC_EN	0x00000008	</span><span class="cm">/* Enable performance counters */</span><span class="cp"></span>

<span class="cp">#define AR5K_CCFG_CCU		0x0604			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_CCFG_CCU_CUP_EN	0x00000001	</span><span class="cm">/* CCU Catchup enable */</span><span class="cp"></span>
<span class="cp">#define AR5K_CCFG_CCU_CREDIT	0x00000002	</span><span class="cm">/* CCU Credit (field) */</span><span class="cp"></span>
<span class="cp">#define AR5K_CCFG_CCU_CD_THRES	0x00000080	</span><span class="cm">/* CCU Cyc(lic?) debt threshold (field) */</span><span class="cp"></span>
<span class="cp">#define AR5K_CCFG_CCU_CUP_LCNT	0x00010000	</span><span class="cm">/* CCU Catchup lit(?) count */</span><span class="cp"></span>
<span class="cp">#define	AR5K_CCFG_CCU_INIT	0x00100200	</span><span class="cm">/* Initial value during reset */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Compression performance counter registers [5212+]</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_CPC0		0x0610		</span><span class="cm">/* Compression performance counter 0 */</span><span class="cp"></span>
<span class="cp">#define AR5K_CPC1		0x0614		</span><span class="cm">/* Compression performance counter 1*/</span><span class="cp"></span>
<span class="cp">#define AR5K_CPC2		0x0618		</span><span class="cm">/* Compression performance counter 2 */</span><span class="cp"></span>
<span class="cp">#define AR5K_CPC3		0x061c		</span><span class="cm">/* Compression performance counter 3 */</span><span class="cp"></span>
<span class="cp">#define AR5K_CPCOVF		0x0620		</span><span class="cm">/* Compression performance overflow */</span><span class="cp"></span>


<span class="cm">/*</span>
<span class="cm"> * Queue control unit (QCU) registers [5211+]</span>
<span class="cm"> *</span>
<span class="cm"> * Card has 12 TX Queues but i see that only 0-9 are used (?)</span>
<span class="cm"> * both in binary HAL (see ah.h) and ar5k. Each queue has it&#39;s own</span>
<span class="cm"> * TXDP at addresses 0x0800 - 0x082c, a CBR (Constant Bit Rate)</span>
<span class="cm"> * configuration register (0x08c0 - 0x08ec), a ready time configuration</span>
<span class="cm"> * register (0x0900 - 0x092c), a misc configuration register (0x09c0 -</span>
<span class="cm"> * 0x09ec) and a status register (0x0a00 - 0x0a2c). We also have some</span>
<span class="cm"> * global registers, QCU transmit enable/disable and &quot;one shot arm (?)&quot;</span>
<span class="cm"> * set/clear, which contain status for all queues (we shift by 1 for each</span>
<span class="cm"> * queue). To access these registers easily we define some macros here</span>
<span class="cm"> * that are used inside HAL. For more infos check out *_tx_queue functs.</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * Generic QCU Register access macros</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_QUEUE_REG(_r, _q)		(((_q) &lt;&lt; 2) + _r)</span>
<span class="cp">#define AR5K_QCU_GLOBAL_READ(_r, _q)	(AR5K_REG_READ(_r) &amp; (1 &lt;&lt; _q))</span>
<span class="cp">#define AR5K_QCU_GLOBAL_WRITE(_r, _q)	AR5K_REG_WRITE(_r, (1 &lt;&lt; _q))</span>

<span class="cm">/*</span>
<span class="cm"> * QCU Transmit descriptor pointer registers</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_QCU_TXDP_BASE	0x0800		</span><span class="cm">/* Register Address - Queue0 TXDP */</span><span class="cp"></span>
<span class="cp">#define AR5K_QUEUE_TXDP(_q)	AR5K_QUEUE_REG(AR5K_QCU_TXDP_BASE, _q)</span>

<span class="cm">/*</span>
<span class="cm"> * QCU Transmit enable register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_QCU_TXE		0x0840</span>
<span class="cp">#define AR5K_ENABLE_QUEUE(_q)	AR5K_QCU_GLOBAL_WRITE(AR5K_QCU_TXE, _q)</span>
<span class="cp">#define AR5K_QUEUE_ENABLED(_q)	AR5K_QCU_GLOBAL_READ(AR5K_QCU_TXE, _q)</span>

<span class="cm">/*</span>
<span class="cm"> * QCU Transmit disable register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_QCU_TXD		0x0880</span>
<span class="cp">#define AR5K_DISABLE_QUEUE(_q)	AR5K_QCU_GLOBAL_WRITE(AR5K_QCU_TXD, _q)</span>
<span class="cp">#define AR5K_QUEUE_DISABLED(_q)	AR5K_QCU_GLOBAL_READ(AR5K_QCU_TXD, _q)</span>

<span class="cm">/*</span>
<span class="cm"> * QCU Constant Bit Rate configuration registers</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_QCU_CBRCFG_BASE		0x08c0	</span><span class="cm">/* Register Address - Queue0 CBRCFG */</span><span class="cp"></span>
<span class="cp">#define	AR5K_QCU_CBRCFG_INTVAL		0x00ffffff	</span><span class="cm">/* CBR Interval mask */</span><span class="cp"></span>
<span class="cp">#define AR5K_QCU_CBRCFG_INTVAL_S	0</span>
<span class="cp">#define	AR5K_QCU_CBRCFG_ORN_THRES	0xff000000	</span><span class="cm">/* CBR overrun threshold mask */</span><span class="cp"></span>
<span class="cp">#define AR5K_QCU_CBRCFG_ORN_THRES_S	24</span>
<span class="cp">#define	AR5K_QUEUE_CBRCFG(_q)		AR5K_QUEUE_REG(AR5K_QCU_CBRCFG_BASE, _q)</span>

<span class="cm">/*</span>
<span class="cm"> * QCU Ready time configuration registers</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_QCU_RDYTIMECFG_BASE	0x0900	</span><span class="cm">/* Register Address - Queue0 RDYTIMECFG */</span><span class="cp"></span>
<span class="cp">#define	AR5K_QCU_RDYTIMECFG_INTVAL	0x00ffffff	</span><span class="cm">/* Ready time interval mask */</span><span class="cp"></span>
<span class="cp">#define AR5K_QCU_RDYTIMECFG_INTVAL_S	0</span>
<span class="cp">#define	AR5K_QCU_RDYTIMECFG_ENABLE	0x01000000	</span><span class="cm">/* Ready time enable mask */</span><span class="cp"></span>
<span class="cp">#define AR5K_QUEUE_RDYTIMECFG(_q)	AR5K_QUEUE_REG(AR5K_QCU_RDYTIMECFG_BASE, _q)</span>

<span class="cm">/*</span>
<span class="cm"> * QCU one shot arm set registers</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_QCU_ONESHOTARM_SET		0x0940	</span><span class="cm">/* Register Address -QCU &quot;one shot arm set (?)&quot; */</span><span class="cp"></span>
<span class="cp">#define	AR5K_QCU_ONESHOTARM_SET_M	0x0000ffff</span>

<span class="cm">/*</span>
<span class="cm"> * QCU one shot arm clear registers</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_QCU_ONESHOTARM_CLEAR	0x0980	</span><span class="cm">/* Register Address -QCU &quot;one shot arm clear (?)&quot; */</span><span class="cp"></span>
<span class="cp">#define	AR5K_QCU_ONESHOTARM_CLEAR_M	0x0000ffff</span>

<span class="cm">/*</span>
<span class="cm"> * QCU misc registers</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_QCU_MISC_BASE		0x09c0			</span><span class="cm">/* Register Address -Queue0 MISC */</span><span class="cp"></span>
<span class="cp">#define	AR5K_QCU_MISC_FRSHED_M		0x0000000f	</span><span class="cm">/* Frame scheduling mask */</span><span class="cp"></span>
<span class="cp">#define	AR5K_QCU_MISC_FRSHED_ASAP		0	</span><span class="cm">/* ASAP */</span><span class="cp"></span>
<span class="cp">#define	AR5K_QCU_MISC_FRSHED_CBR		1	</span><span class="cm">/* Constant Bit Rate */</span><span class="cp"></span>
<span class="cp">#define	AR5K_QCU_MISC_FRSHED_DBA_GT		2	</span><span class="cm">/* DMA Beacon alert gated */</span><span class="cp"></span>
<span class="cp">#define	AR5K_QCU_MISC_FRSHED_TIM_GT		3	</span><span class="cm">/* TIMT gated */</span><span class="cp"></span>
<span class="cp">#define	AR5K_QCU_MISC_FRSHED_BCN_SENT_GT	4	</span><span class="cm">/* Beacon sent gated */</span><span class="cp"></span>
<span class="cp">#define	AR5K_QCU_MISC_ONESHOT_ENABLE	0x00000010	</span><span class="cm">/* Oneshot enable */</span><span class="cp"></span>
<span class="cp">#define	AR5K_QCU_MISC_CBREXP_DIS	0x00000020	</span><span class="cm">/* Disable CBR expired counter (normal queue) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_QCU_MISC_CBREXP_BCN_DIS	0x00000040	</span><span class="cm">/* Disable CBR expired counter (beacon queue) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_QCU_MISC_BCN_ENABLE	0x00000080	</span><span class="cm">/* Enable Beacon use */</span><span class="cp"></span>
<span class="cp">#define	AR5K_QCU_MISC_CBR_THRES_ENABLE	0x00000100	</span><span class="cm">/* CBR expired threshold enabled */</span><span class="cp"></span>
<span class="cp">#define	AR5K_QCU_MISC_RDY_VEOL_POLICY	0x00000200	</span><span class="cm">/* TXE reset when RDYTIME expired or VEOL */</span><span class="cp"></span>
<span class="cp">#define	AR5K_QCU_MISC_CBR_RESET_CNT	0x00000400	</span><span class="cm">/* CBR threshold (counter) reset */</span><span class="cp"></span>
<span class="cp">#define	AR5K_QCU_MISC_DCU_EARLY		0x00000800	</span><span class="cm">/* DCU early termination */</span><span class="cp"></span>
<span class="cp">#define AR5K_QCU_MISC_DCU_CMP_EN	0x00001000	</span><span class="cm">/* Enable frame compression */</span><span class="cp"></span>
<span class="cp">#define AR5K_QUEUE_MISC(_q)		AR5K_QUEUE_REG(AR5K_QCU_MISC_BASE, _q)</span>


<span class="cm">/*</span>
<span class="cm"> * QCU status registers</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_QCU_STS_BASE	0x0a00			</span><span class="cm">/* Register Address - Queue0 STS */</span><span class="cp"></span>
<span class="cp">#define	AR5K_QCU_STS_FRMPENDCNT	0x00000003	</span><span class="cm">/* Frames pending counter */</span><span class="cp"></span>
<span class="cp">#define	AR5K_QCU_STS_CBREXPCNT	0x0000ff00	</span><span class="cm">/* CBR expired counter */</span><span class="cp"></span>
<span class="cp">#define	AR5K_QUEUE_STATUS(_q)	AR5K_QUEUE_REG(AR5K_QCU_STS_BASE, _q)</span>

<span class="cm">/*</span>
<span class="cm"> * QCU ready time shutdown register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_QCU_RDYTIMESHDN	0x0a40</span>
<span class="cp">#define AR5K_QCU_RDYTIMESHDN_M	0x000003ff</span>

<span class="cm">/*</span>
<span class="cm"> * QCU compression buffer base registers [5212+]</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_QCU_CBB_SELECT	0x0b00</span>
<span class="cp">#define AR5K_QCU_CBB_ADDR	0x0b04</span>
<span class="cp">#define AR5K_QCU_CBB_ADDR_S	9</span>

<span class="cm">/*</span>
<span class="cm"> * QCU compression buffer configuration register [5212+]</span>
<span class="cm"> * (buffer size)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_QCU_CBCFG		0x0b08</span>



<span class="cm">/*</span>
<span class="cm"> * Distributed Coordination Function (DCF) control unit (DCU)</span>
<span class="cm"> * registers [5211+]</span>
<span class="cm"> *</span>
<span class="cm"> * These registers control the various characteristics of each queue</span>
<span class="cm"> * for 802.11e (WME) compatibility so they go together with</span>
<span class="cm"> * QCU registers in pairs. For each queue we have a QCU mask register,</span>
<span class="cm"> * (0x1000 - 0x102c), a local-IFS settings register (0x1040 - 0x106c),</span>
<span class="cm"> * a retry limit register (0x1080 - 0x10ac), a channel time register</span>
<span class="cm"> * (0x10c0 - 0x10ec), a misc-settings register (0x1100 - 0x112c) and</span>
<span class="cm"> * a sequence number register (0x1140 - 0x116c). It seems that &quot;global&quot;</span>
<span class="cm"> * registers here affect all queues (see use of DCU_GBL_IFS_SLOT in ar5k).</span>
<span class="cm"> * We use the same macros here for easier register access.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * DCU QCU mask registers</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_DCU_QCUMASK_BASE	0x1000		</span><span class="cm">/* Register Address -Queue0 DCU_QCUMASK */</span><span class="cp"></span>
<span class="cp">#define AR5K_DCU_QCUMASK_M	0x000003ff</span>
<span class="cp">#define AR5K_QUEUE_QCUMASK(_q)	AR5K_QUEUE_REG(AR5K_DCU_QCUMASK_BASE, _q)</span>

<span class="cm">/*</span>
<span class="cm"> * DCU local Inter Frame Space settings register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_DCU_LCL_IFS_BASE		0x1040			</span><span class="cm">/* Register Address -Queue0 DCU_LCL_IFS */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_LCL_IFS_CW_MIN	        0x000003ff	</span><span class="cm">/* Minimum Contention Window */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_LCL_IFS_CW_MIN_S	0</span>
<span class="cp">#define	AR5K_DCU_LCL_IFS_CW_MAX	        0x000ffc00	</span><span class="cm">/* Maximum Contention Window */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_LCL_IFS_CW_MAX_S	10</span>
<span class="cp">#define	AR5K_DCU_LCL_IFS_AIFS		0x0ff00000	</span><span class="cm">/* Arbitrated Interframe Space */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_LCL_IFS_AIFS_S		20</span>
<span class="cp">#define	AR5K_DCU_LCL_IFS_AIFS_MAX	0xfc		</span><span class="cm">/* Anything above that can cause DCU to hang */</span><span class="cp"></span>
<span class="cp">#define	AR5K_QUEUE_DFS_LOCAL_IFS(_q)	AR5K_QUEUE_REG(AR5K_DCU_LCL_IFS_BASE, _q)</span>

<span class="cm">/*</span>
<span class="cm"> * DCU retry limit registers</span>
<span class="cm"> * all these fields don&#39;t allow zero values</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_DCU_RETRY_LMT_BASE		0x1080			</span><span class="cm">/* Register Address -Queue0 DCU_RETRY_LMT */</span><span class="cp"></span>
<span class="cp">#define AR5K_DCU_RETRY_LMT_RTS		0x0000000f	</span><span class="cm">/* RTS failure limit. Transmission fails if no CTS is received for this number of times */</span><span class="cp"></span>
<span class="cp">#define AR5K_DCU_RETRY_LMT_RTS_S	0</span>
<span class="cp">#define AR5K_DCU_RETRY_LMT_STA_RTS	0x00003f00	</span><span class="cm">/* STA RTS failure limit. If exceeded CW reset */</span><span class="cp"></span>
<span class="cp">#define AR5K_DCU_RETRY_LMT_STA_RTS_S	8</span>
<span class="cp">#define AR5K_DCU_RETRY_LMT_STA_DATA	0x000fc000	</span><span class="cm">/* STA data failure limit. If exceeded CW reset. */</span><span class="cp"></span>
<span class="cp">#define AR5K_DCU_RETRY_LMT_STA_DATA_S	14</span>
<span class="cp">#define	AR5K_QUEUE_DFS_RETRY_LIMIT(_q)	AR5K_QUEUE_REG(AR5K_DCU_RETRY_LMT_BASE, _q)</span>

<span class="cm">/*</span>
<span class="cm"> * DCU channel time registers</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_DCU_CHAN_TIME_BASE		0x10c0			</span><span class="cm">/* Register Address -Queue0 DCU_CHAN_TIME */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_CHAN_TIME_DUR		0x000fffff	</span><span class="cm">/* Channel time duration */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_CHAN_TIME_DUR_S	0</span>
<span class="cp">#define	AR5K_DCU_CHAN_TIME_ENABLE	0x00100000	</span><span class="cm">/* Enable channel time */</span><span class="cp"></span>
<span class="cp">#define AR5K_QUEUE_DFS_CHANNEL_TIME(_q)	AR5K_QUEUE_REG(AR5K_DCU_CHAN_TIME_BASE, _q)</span>

<span class="cm">/*</span>
<span class="cm"> * DCU misc registers [5211+]</span>
<span class="cm"> *</span>
<span class="cm"> * Note: Arbiter lockout control controls the</span>
<span class="cm"> * behaviour on low priority queues when we have multiple queues</span>
<span class="cm"> * with pending frames. Intra-frame lockout means we wait until</span>
<span class="cm"> * the queue&#39;s current frame transmits (with post frame backoff and bursting)</span>
<span class="cm"> * before we transmit anything else and global lockout means we</span>
<span class="cm"> * wait for the whole queue to finish before higher priority queues</span>
<span class="cm"> * can transmit (this is used on beacon and CAB queues).</span>
<span class="cm"> * No lockout means there is no special handling.</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_DCU_MISC_BASE		0x1100			</span><span class="cm">/* Register Address -Queue0 DCU_MISC */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_MISC_BACKOFF		0x0000003f	</span><span class="cm">/* Mask for backoff threshold */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_MISC_ETS_RTS_POL	0x00000040	</span><span class="cm">/* End of transmission series</span>
<span class="cm">							station RTS/data failure count</span>
<span class="cm">							reset policy (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_DCU_MISC_ETS_CW_POL	0x00000080	</span><span class="cm">/* End of transmission series</span>
<span class="cm">							CW reset policy */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_MISC_FRAG_WAIT		0x00000100	</span><span class="cm">/* Wait for next fragment */</span><span class="cp"></span>
<span class="cp">#define AR5K_DCU_MISC_BACKOFF_FRAG	0x00000200	</span><span class="cm">/* Enable backoff while bursting */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_MISC_HCFPOLL_ENABLE	0x00000800	</span><span class="cm">/* CF - Poll enable */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_MISC_BACKOFF_PERSIST	0x00001000	</span><span class="cm">/* Persistent backoff */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_MISC_FRMPRFTCH_ENABLE	0x00002000	</span><span class="cm">/* Enable frame pre-fetch */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_MISC_VIRTCOL		0x0000c000	</span><span class="cm">/* Mask for Virtual Collision (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_MISC_VIRTCOL_NORMAL	0</span>
<span class="cp">#define	AR5K_DCU_MISC_VIRTCOL_IGNORE	1</span>
<span class="cp">#define	AR5K_DCU_MISC_BCN_ENABLE	0x00010000	</span><span class="cm">/* Enable Beacon use */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_MISC_ARBLOCK_CTL	0x00060000	</span><span class="cm">/* Arbiter lockout control mask */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_MISC_ARBLOCK_CTL_S	17</span>
<span class="cp">#define	AR5K_DCU_MISC_ARBLOCK_CTL_NONE		0	</span><span class="cm">/* No arbiter lockout */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_MISC_ARBLOCK_CTL_INTFRM	1	</span><span class="cm">/* Intra-frame lockout */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_MISC_ARBLOCK_CTL_GLOBAL	2	</span><span class="cm">/* Global lockout */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_MISC_ARBLOCK_IGNORE	0x00080000	</span><span class="cm">/* Ignore Arbiter lockout */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_MISC_SEQ_NUM_INCR_DIS	0x00100000	</span><span class="cm">/* Disable sequence number increment */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_MISC_POST_FR_BKOFF_DIS	0x00200000	</span><span class="cm">/* Disable post-frame backoff */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_MISC_VIRT_COLL_POLICY	0x00400000	</span><span class="cm">/* Virtual Collision cw policy */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_MISC_BLOWN_IFS_POLICY	0x00800000	</span><span class="cm">/* Blown IFS policy (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_MISC_SEQNUM_CTL	0x01000000	</span><span class="cm">/* Sequence number control (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_QUEUE_DFS_MISC(_q)		AR5K_QUEUE_REG(AR5K_DCU_MISC_BASE, _q)</span>

<span class="cm">/*</span>
<span class="cm"> * DCU frame sequence number registers</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_DCU_SEQNUM_BASE		0x1140</span>
<span class="cp">#define	AR5K_DCU_SEQNUM_M		0x00000fff</span>
<span class="cp">#define	AR5K_QUEUE_DCU_SEQNUM(_q)	AR5K_QUEUE_REG(AR5K_DCU_SEQNUM_BASE, _q)</span>

<span class="cm">/*</span>
<span class="cm"> * DCU global IFS SIFS register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_DCU_GBL_IFS_SIFS	0x1030</span>
<span class="cp">#define AR5K_DCU_GBL_IFS_SIFS_M	0x0000ffff</span>

<span class="cm">/*</span>
<span class="cm"> * DCU global IFS slot interval register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_DCU_GBL_IFS_SLOT	0x1070</span>
<span class="cp">#define AR5K_DCU_GBL_IFS_SLOT_M	0x0000ffff</span>

<span class="cm">/*</span>
<span class="cm"> * DCU global IFS EIFS register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_DCU_GBL_IFS_EIFS	0x10b0</span>
<span class="cp">#define AR5K_DCU_GBL_IFS_EIFS_M	0x0000ffff</span>

<span class="cm">/*</span>
<span class="cm"> * DCU global IFS misc register</span>
<span class="cm"> *</span>
<span class="cm"> * LFSR stands for Linear Feedback Shift Register</span>
<span class="cm"> * and it&#39;s used for generating pseudo-random</span>
<span class="cm"> * number sequences.</span>
<span class="cm"> *</span>
<span class="cm"> * (If i understand correctly, random numbers are</span>
<span class="cm"> * used for idle sensing -multiplied with cwmin/max etc-)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_DCU_GBL_IFS_MISC			0x10f0			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_GBL_IFS_MISC_LFSR_SLICE	0x00000007	</span><span class="cm">/* LFSR Slice Select */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_GBL_IFS_MISC_TURBO_MODE	0x00000008	</span><span class="cm">/* Turbo mode */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_GBL_IFS_MISC_SIFS_DUR_USEC	0x000003f0	</span><span class="cm">/* SIFS Duration mask */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_GBL_IFS_MISC_SIFS_DUR_USEC_S	4</span>
<span class="cp">#define	AR5K_DCU_GBL_IFS_MISC_USEC_DUR		0x000ffc00	</span><span class="cm">/* USEC Duration mask */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_GBL_IFS_MISC_USEC_DUR_S	10</span>
<span class="cp">#define	AR5K_DCU_GBL_IFS_MISC_DCU_ARB_DELAY	0x00300000	</span><span class="cm">/* DCU Arbiter delay mask */</span><span class="cp"></span>
<span class="cp">#define AR5K_DCU_GBL_IFS_MISC_SIFS_CNT_RST	0x00400000	</span><span class="cm">/* SIFS cnt reset policy (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_DCU_GBL_IFS_MISC_AIFS_CNT_RST	0x00800000	</span><span class="cm">/* AIFS cnt reset policy (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_DCU_GBL_IFS_MISC_RND_LFSR_SL_DIS	0x01000000	</span><span class="cm">/* Disable random LFSR slice */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * DCU frame prefetch control register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_DCU_FP			0x1230			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_DCU_FP_NOBURST_DCU_EN	0x00000001	</span><span class="cm">/* Enable non-burst prefetch on DCU (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_DCU_FP_NOBURST_EN		0x00000010	</span><span class="cm">/* Enable non-burst prefetch (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_DCU_FP_BURST_DCU_EN	0x00000020	</span><span class="cm">/* Enable burst prefetch on DCU (?) */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * DCU transmit pause control/status register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_DCU_TXP		0x1270			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_TXP_M		0x000003ff	</span><span class="cm">/* Tx pause mask */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DCU_TXP_STATUS	0x00010000	</span><span class="cm">/* Tx pause status */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * DCU transmit filter table 0 (32 entries)</span>
<span class="cm"> * each entry contains a 32bit slice of the</span>
<span class="cm"> * 128bit tx filter for each DCU (4 slices per DCU)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_DCU_TX_FILTER_0_BASE	0x1038</span>
<span class="cp">#define	AR5K_DCU_TX_FILTER_0(_n)	(AR5K_DCU_TX_FILTER_0_BASE + (_n * 64))</span>

<span class="cm">/*</span>
<span class="cm"> * DCU transmit filter table 1 (16 entries)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_DCU_TX_FILTER_1_BASE	0x103c</span>
<span class="cp">#define	AR5K_DCU_TX_FILTER_1(_n)	(AR5K_DCU_TX_FILTER_1_BASE + (_n * 64))</span>

<span class="cm">/*</span>
<span class="cm"> * DCU clear transmit filter register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_DCU_TX_FILTER_CLR	0x143c</span>

<span class="cm">/*</span>
<span class="cm"> * DCU set transmit filter register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_DCU_TX_FILTER_SET	0x147c</span>

<span class="cm">/*</span>
<span class="cm"> * Reset control register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_RESET_CTL		0x4000			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_RESET_CTL_PCU	0x00000001	</span><span class="cm">/* Protocol Control Unit reset */</span><span class="cp"></span>
<span class="cp">#define AR5K_RESET_CTL_DMA	0x00000002	</span><span class="cm">/* DMA (Rx/Tx) reset [5210] */</span><span class="cp"></span>
<span class="cp">#define	AR5K_RESET_CTL_BASEBAND	0x00000002	</span><span class="cm">/* Baseband reset [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_RESET_CTL_MAC	0x00000004	</span><span class="cm">/* MAC reset (PCU+Baseband ?) [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_RESET_CTL_PHY	0x00000008	</span><span class="cm">/* PHY reset [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_RESET_CTL_PCI	0x00000010	</span><span class="cm">/* PCI Core reset (interrupts etc) */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Sleep control register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_SLEEP_CTL			0x4004			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_SLEEP_CTL_SLDUR		0x0000ffff	</span><span class="cm">/* Sleep duration mask */</span><span class="cp"></span>
<span class="cp">#define AR5K_SLEEP_CTL_SLDUR_S		0</span>
<span class="cp">#define AR5K_SLEEP_CTL_SLE		0x00030000	</span><span class="cm">/* Sleep enable mask */</span><span class="cp"></span>
<span class="cp">#define AR5K_SLEEP_CTL_SLE_S		16</span>
<span class="cp">#define AR5K_SLEEP_CTL_SLE_WAKE		0x00000000	</span><span class="cm">/* Force chip awake */</span><span class="cp"></span>
<span class="cp">#define AR5K_SLEEP_CTL_SLE_SLP		0x00010000	</span><span class="cm">/* Force chip sleep */</span><span class="cp"></span>
<span class="cp">#define AR5K_SLEEP_CTL_SLE_ALLOW	0x00020000	</span><span class="cm">/* Normal sleep policy */</span><span class="cp"></span>
<span class="cp">#define AR5K_SLEEP_CTL_SLE_UNITS	0x00000008	</span><span class="cm">/* [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_SLEEP_CTL_DUR_TIM_POL	0x00040000	</span><span class="cm">/* Sleep duration timing policy */</span><span class="cp"></span>
<span class="cp">#define AR5K_SLEEP_CTL_DUR_WRITE_POL	0x00080000	</span><span class="cm">/* Sleep duration write policy */</span><span class="cp"></span>
<span class="cp">#define AR5K_SLEEP_CTL_SLE_POL		0x00100000	</span><span class="cm">/* Sleep policy mode */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Interrupt pending register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_INTPEND	0x4008</span>
<span class="cp">#define AR5K_INTPEND_M	0x00000001</span>

<span class="cm">/*</span>
<span class="cm"> * Sleep force register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_SFR	0x400c</span>
<span class="cp">#define AR5K_SFR_EN	0x00000001</span>

<span class="cm">/*</span>
<span class="cm"> * PCI configuration register</span>
<span class="cm"> * TODO: Fix LED stuff</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_PCICFG			0x4010			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_PCICFG_EEAE		0x00000001	</span><span class="cm">/* Eeprom access enable [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_PCICFG_SLEEP_CLOCK_EN	0x00000002	</span><span class="cm">/* Enable sleep clock */</span><span class="cp"></span>
<span class="cp">#define AR5K_PCICFG_CLKRUNEN		0x00000004	</span><span class="cm">/* CLKRUN enable [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_PCICFG_EESIZE		0x00000018	</span><span class="cm">/* Mask for EEPROM size [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_PCICFG_EESIZE_S		3</span>
<span class="cp">#define AR5K_PCICFG_EESIZE_4K		0		</span><span class="cm">/* 4K */</span><span class="cp"></span>
<span class="cp">#define AR5K_PCICFG_EESIZE_8K		1		</span><span class="cm">/* 8K */</span><span class="cp"></span>
<span class="cp">#define AR5K_PCICFG_EESIZE_16K		2		</span><span class="cm">/* 16K */</span><span class="cp"></span>
<span class="cp">#define AR5K_PCICFG_EESIZE_FAIL		3		</span><span class="cm">/* Failed to get size [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_PCICFG_LED			0x00000060	</span><span class="cm">/* Led status [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_PCICFG_LED_NONE		0x00000000	</span><span class="cm">/* Default [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_PCICFG_LED_PEND		0x00000020	</span><span class="cm">/* Scan / Auth pending */</span><span class="cp"></span>
<span class="cp">#define AR5K_PCICFG_LED_ASSOC		0x00000040	</span><span class="cm">/* Associated */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PCICFG_BUS_SEL		0x00000380	</span><span class="cm">/* Mask for &quot;bus select&quot; [5211+] (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_PCICFG_CBEFIX_DIS		0x00000400	</span><span class="cm">/* Disable CBE fix */</span><span class="cp"></span>
<span class="cp">#define AR5K_PCICFG_SL_INTEN		0x00000800	</span><span class="cm">/* Enable interrupts when asleep */</span><span class="cp"></span>
<span class="cp">#define AR5K_PCICFG_LED_BCTL		0x00001000	</span><span class="cm">/* Led blink (?) [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_PCICFG_RETRY_FIX		0x00001000	</span><span class="cm">/* Enable pci core retry fix */</span><span class="cp"></span>
<span class="cp">#define AR5K_PCICFG_SL_INPEN		0x00002000	</span><span class="cm">/* Sleep even with pending interrupts*/</span><span class="cp"></span>
<span class="cp">#define AR5K_PCICFG_SPWR_DN		0x00010000	</span><span class="cm">/* Mask for power status */</span><span class="cp"></span>
<span class="cp">#define AR5K_PCICFG_LEDMODE		0x000e0000	</span><span class="cm">/* Ledmode [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_PCICFG_LEDMODE_PROP	0x00000000	</span><span class="cm">/* Blink on standard traffic [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_PCICFG_LEDMODE_PROM	0x00020000	</span><span class="cm">/* Default mode (blink on any traffic) [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_PCICFG_LEDMODE_PWR		0x00040000	</span><span class="cm">/* Some other blinking mode  (?) [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_PCICFG_LEDMODE_RAND	0x00060000	</span><span class="cm">/* Random blinking (?) [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_PCICFG_LEDBLINK		0x00700000	</span><span class="cm">/* Led blink rate */</span><span class="cp"></span>
<span class="cp">#define AR5K_PCICFG_LEDBLINK_S		20</span>
<span class="cp">#define AR5K_PCICFG_LEDSLOW		0x00800000	</span><span class="cm">/* Slowest led blink rate [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_PCICFG_LEDSTATE				\</span>
<span class="cp">	(AR5K_PCICFG_LED | AR5K_PCICFG_LEDMODE |	\</span>
<span class="cp">	AR5K_PCICFG_LEDBLINK | AR5K_PCICFG_LEDSLOW)</span>
<span class="cp">#define	AR5K_PCICFG_SLEEP_CLOCK_RATE	0x03000000	</span><span class="cm">/* Sleep clock rate */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PCICFG_SLEEP_CLOCK_RATE_S	24</span>

<span class="cm">/*</span>
<span class="cm"> * &quot;General Purpose Input/Output&quot; (GPIO) control register</span>
<span class="cm"> *</span>
<span class="cm"> * I&#39;m not sure about this but after looking at the code</span>
<span class="cm"> * for all chipsets here is what i got.</span>
<span class="cm"> *</span>
<span class="cm"> * We have 6 GPIOs (pins), each GPIO has 4 modes (2 bits)</span>
<span class="cm"> * Mode 0 -&gt; always input</span>
<span class="cm"> * Mode 1 -&gt; output when GPIODO for this GPIO is set to 0</span>
<span class="cm"> * Mode 2 -&gt; output when GPIODO for this GPIO is set to 1</span>
<span class="cm"> * Mode 3 -&gt; always output</span>
<span class="cm"> *</span>
<span class="cm"> * For more infos check out get_gpio/set_gpio and</span>
<span class="cm"> * set_gpio_input/set_gpio_output functs.</span>
<span class="cm"> * For more infos on gpio interrupt check out set_gpio_intr.</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_NUM_GPIO	6</span>

<span class="cp">#define AR5K_GPIOCR		0x4014				</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_GPIOCR_INT_ENA	0x00008000		</span><span class="cm">/* Enable GPIO interrupt */</span><span class="cp"></span>
<span class="cp">#define AR5K_GPIOCR_INT_SELL	0x00000000		</span><span class="cm">/* Generate interrupt when pin is low */</span><span class="cp"></span>
<span class="cp">#define AR5K_GPIOCR_INT_SELH	0x00010000		</span><span class="cm">/* Generate interrupt when pin is high */</span><span class="cp"></span>
<span class="cp">#define AR5K_GPIOCR_IN(n)	(0 &lt;&lt; ((n) * 2))	</span><span class="cm">/* Mode 0 for pin n */</span><span class="cp"></span>
<span class="cp">#define AR5K_GPIOCR_OUT0(n)	(1 &lt;&lt; ((n) * 2))	</span><span class="cm">/* Mode 1 for pin n */</span><span class="cp"></span>
<span class="cp">#define AR5K_GPIOCR_OUT1(n)	(2 &lt;&lt; ((n) * 2))	</span><span class="cm">/* Mode 2 for pin n */</span><span class="cp"></span>
<span class="cp">#define AR5K_GPIOCR_OUT(n)	(3 &lt;&lt; ((n) * 2))	</span><span class="cm">/* Mode 3 for pin n */</span><span class="cp"></span>
<span class="cp">#define AR5K_GPIOCR_INT_SEL(n)	((n) &lt;&lt; 12)		</span><span class="cm">/* Interrupt for GPIO pin n */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * &quot;General Purpose Input/Output&quot; (GPIO) data output register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_GPIODO	0x4018</span>

<span class="cm">/*</span>
<span class="cm"> * &quot;General Purpose Input/Output&quot; (GPIO) data input register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_GPIODI	0x401c</span>
<span class="cp">#define AR5K_GPIODI_M	0x0000002f</span>

<span class="cm">/*</span>
<span class="cm"> * Silicon revision register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_SREV		0x4020			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_SREV_REV		0x0000000f	</span><span class="cm">/* Mask for revision */</span><span class="cp"></span>
<span class="cp">#define AR5K_SREV_REV_S		0</span>
<span class="cp">#define AR5K_SREV_VER		0x000000ff	</span><span class="cm">/* Mask for version */</span><span class="cp"></span>
<span class="cp">#define AR5K_SREV_VER_S		4</span>

<span class="cm">/*</span>
<span class="cm"> * TXE write posting register</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_TXEPOST	0x4028</span>

<span class="cm">/*</span>
<span class="cm"> * QCU sleep mask</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_QCU_SLEEP_MASK	0x402c</span>

<span class="cm">/* 0x4068 is compression buffer configuration</span>
<span class="cm"> * register on 5414 and pm configuration register</span>
<span class="cm"> * on 5424 and newer pci-e chips. */</span>

<span class="cm">/*</span>
<span class="cm"> * Compression buffer configuration</span>
<span class="cm"> * register (enable/disable) [5414]</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_5414_CBCFG		0x4068</span>
<span class="cp">#define AR5K_5414_CBCFG_BUF_DIS	0x10	</span><span class="cm">/* Disable buffer */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * PCI-E Power management configuration</span>
<span class="cm"> * and status register [5424+]</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PCIE_PM_CTL		0x4068			</span><span class="cm">/* Register address */</span><span class="cp"></span>
<span class="cm">/* Only 5424 */</span>
<span class="cp">#define	AR5K_PCIE_PM_CTL_L1_WHEN_D2	0x00000001	</span><span class="cm">/* enable PCIe core enter L1</span>
<span class="cm">							when d2_sleep_en is asserted */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PCIE_PM_CTL_L0_L0S_CLEAR	0x00000002	</span><span class="cm">/* Clear L0 and L0S counters */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PCIE_PM_CTL_L0_L0S_EN	0x00000004	</span><span class="cm">/* Start L0 nd L0S counters */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PCIE_PM_CTL_LDRESET_EN	0x00000008	</span><span class="cm">/* Enable reset when link goes</span>
<span class="cm">							down */</span><span class="cp"></span>
<span class="cm">/* Wake On Wireless */</span>
<span class="cp">#define	AR5K_PCIE_PM_CTL_PME_EN		0x00000010	</span><span class="cm">/* PME Enable */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PCIE_PM_CTL_AUX_PWR_DET	0x00000020	</span><span class="cm">/* Aux power detect */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PCIE_PM_CTL_PME_CLEAR	0x00000040	</span><span class="cm">/* Clear PME */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PCIE_PM_CTL_PSM_D0		0x00000080</span>
<span class="cp">#define	AR5K_PCIE_PM_CTL_PSM_D1		0x00000100</span>
<span class="cp">#define	AR5K_PCIE_PM_CTL_PSM_D2		0x00000200</span>
<span class="cp">#define	AR5K_PCIE_PM_CTL_PSM_D3		0x00000400</span>

<span class="cm">/*</span>
<span class="cm"> * PCI-E Workaround enable register</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PCIE_WAEN	0x407c</span>

<span class="cm">/*</span>
<span class="cm"> * PCI-E Serializer/Deserializer</span>
<span class="cm"> * registers</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PCIE_SERDES	0x4080</span>
<span class="cp">#define	AR5K_PCIE_SERDES_RESET	0x4084</span>

<span class="cm">/*====EEPROM REGISTERS====*/</span>

<span class="cm">/*</span>
<span class="cm"> * EEPROM access registers</span>
<span class="cm"> *</span>
<span class="cm"> * Here we got a difference between 5210/5211-12</span>
<span class="cm"> * read data register for 5210 is at 0x6800 and</span>
<span class="cm"> * status register is at 0x6c00. There is also</span>
<span class="cm"> * no eeprom command register on 5210 and the</span>
<span class="cm"> * offsets are different.</span>
<span class="cm"> *</span>
<span class="cm"> * To read eeprom data for a specific offset:</span>
<span class="cm"> * 5210 - enable eeprom access (AR5K_PCICFG_EEAE)</span>
<span class="cm"> *        read AR5K_EEPROM_BASE +(4 * offset)</span>
<span class="cm"> *        check the eeprom status register</span>
<span class="cm"> *        and read eeprom data register.</span>
<span class="cm"> *</span>
<span class="cm"> * 5211 - write offset to AR5K_EEPROM_BASE</span>
<span class="cm"> * 5212   write AR5K_EEPROM_CMD_READ on AR5K_EEPROM_CMD</span>
<span class="cm"> *        check the eeprom status register</span>
<span class="cm"> *        and read eeprom data register.</span>
<span class="cm"> *</span>
<span class="cm"> * To write eeprom data for a specific offset:</span>
<span class="cm"> * 5210 - enable eeprom access (AR5K_PCICFG_EEAE)</span>
<span class="cm"> *        write data to AR5K_EEPROM_BASE +(4 * offset)</span>
<span class="cm"> *        check the eeprom status register</span>
<span class="cm"> * 5211 - write AR5K_EEPROM_CMD_RESET on AR5K_EEPROM_CMD</span>
<span class="cm"> * 5212   write offset to AR5K_EEPROM_BASE</span>
<span class="cm"> *        write data to data register</span>
<span class="cm"> *	  write AR5K_EEPROM_CMD_WRITE on AR5K_EEPROM_CMD</span>
<span class="cm"> *        check the eeprom status register</span>
<span class="cm"> *</span>
<span class="cm"> * For more infos check eeprom_* functs and the ar5k.c</span>
<span class="cm"> * file posted in madwifi-devel mailing list.</span>
<span class="cm"> * http://sourceforge.net/mailarchive/message.php?msg_id=8966525</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_EEPROM_BASE	0x6000</span>

<span class="cm">/*</span>
<span class="cm"> * EEPROM data register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_EEPROM_DATA_5211	0x6004</span>
<span class="cp">#define AR5K_EEPROM_DATA_5210	0x6800</span>
<span class="cp">#define	AR5K_EEPROM_DATA	(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">				AR5K_EEPROM_DATA_5210 : AR5K_EEPROM_DATA_5211)</span>

<span class="cm">/*</span>
<span class="cm"> * EEPROM command register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_EEPROM_CMD		0x6008			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_EEPROM_CMD_READ	0x00000001	</span><span class="cm">/* EEPROM read */</span><span class="cp"></span>
<span class="cp">#define AR5K_EEPROM_CMD_WRITE	0x00000002	</span><span class="cm">/* EEPROM write */</span><span class="cp"></span>
<span class="cp">#define AR5K_EEPROM_CMD_RESET	0x00000004	</span><span class="cm">/* EEPROM reset */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * EEPROM status register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_EEPROM_STAT_5210	0x6c00			</span><span class="cm">/* Register Address [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_EEPROM_STAT_5211	0x600c			</span><span class="cm">/* Register Address [5211+] */</span><span class="cp"></span>
<span class="cp">#define	AR5K_EEPROM_STATUS	(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">				AR5K_EEPROM_STAT_5210 : AR5K_EEPROM_STAT_5211)</span>
<span class="cp">#define AR5K_EEPROM_STAT_RDERR	0x00000001	</span><span class="cm">/* EEPROM read failed */</span><span class="cp"></span>
<span class="cp">#define AR5K_EEPROM_STAT_RDDONE	0x00000002	</span><span class="cm">/* EEPROM read successful */</span><span class="cp"></span>
<span class="cp">#define AR5K_EEPROM_STAT_WRERR	0x00000004	</span><span class="cm">/* EEPROM write failed */</span><span class="cp"></span>
<span class="cp">#define AR5K_EEPROM_STAT_WRDONE	0x00000008	</span><span class="cm">/* EEPROM write successful */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * EEPROM config register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_EEPROM_CFG			0x6010			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_EEPROM_CFG_SIZE		0x00000003		</span><span class="cm">/* Size determination override */</span><span class="cp"></span>
<span class="cp">#define AR5K_EEPROM_CFG_SIZE_AUTO	0</span>
<span class="cp">#define AR5K_EEPROM_CFG_SIZE_4KBIT	1</span>
<span class="cp">#define AR5K_EEPROM_CFG_SIZE_8KBIT	2</span>
<span class="cp">#define AR5K_EEPROM_CFG_SIZE_16KBIT	3</span>
<span class="cp">#define AR5K_EEPROM_CFG_WR_WAIT_DIS	0x00000004	</span><span class="cm">/* Disable write wait */</span><span class="cp"></span>
<span class="cp">#define AR5K_EEPROM_CFG_CLK_RATE	0x00000018	</span><span class="cm">/* Clock rate */</span><span class="cp"></span>
<span class="cp">#define AR5K_EEPROM_CFG_CLK_RATE_S		3</span>
<span class="cp">#define AR5K_EEPROM_CFG_CLK_RATE_156KHZ	0</span>
<span class="cp">#define AR5K_EEPROM_CFG_CLK_RATE_312KHZ	1</span>
<span class="cp">#define AR5K_EEPROM_CFG_CLK_RATE_625KHZ	2</span>
<span class="cp">#define AR5K_EEPROM_CFG_PROT_KEY	0x00ffff00      </span><span class="cm">/* Protection key */</span><span class="cp"></span>
<span class="cp">#define AR5K_EEPROM_CFG_PROT_KEY_S	8</span>
<span class="cp">#define AR5K_EEPROM_CFG_LIND_EN		0x01000000	</span><span class="cm">/* Enable length indicator (?) */</span><span class="cp"></span>


<span class="cm">/*</span>
<span class="cm"> * TODO: Wake On Wireless registers</span>
<span class="cm"> * Range 0x7000 - 0x7ce0</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * Protocol Control Unit (PCU) registers</span>
<span class="cm"> */</span>
<span class="cm">/*</span>
<span class="cm"> * Used for checking initial register writes</span>
<span class="cm"> * during channel reset (see reset func)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_PCU_MIN	0x8000</span>
<span class="cp">#define AR5K_PCU_MAX	0x8fff</span>

<span class="cm">/*</span>
<span class="cm"> * First station id register (Lower 32 bits of MAC address)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_STA_ID0		0x8000</span>
<span class="cp">#define	AR5K_STA_ID0_ARRD_L32	0xffffffff</span>

<span class="cm">/*</span>
<span class="cm"> * Second station id register (Upper 16 bits of MAC address + PCU settings)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_STA_ID1			0x8004			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_STA_ID1_ADDR_U16		0x0000ffff	</span><span class="cm">/* Upper 16 bits of MAC address */</span><span class="cp"></span>
<span class="cp">#define AR5K_STA_ID1_AP			0x00010000	</span><span class="cm">/* Set AP mode */</span><span class="cp"></span>
<span class="cp">#define AR5K_STA_ID1_ADHOC		0x00020000	</span><span class="cm">/* Set Ad-Hoc mode */</span><span class="cp"></span>
<span class="cp">#define AR5K_STA_ID1_PWR_SV		0x00040000	</span><span class="cm">/* Power save reporting */</span><span class="cp"></span>
<span class="cp">#define AR5K_STA_ID1_NO_KEYSRCH		0x00080000	</span><span class="cm">/* No key search */</span><span class="cp"></span>
<span class="cp">#define AR5K_STA_ID1_NO_PSPOLL		0x00100000	</span><span class="cm">/* No power save polling [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_STA_ID1_PCF_5211		0x00100000	</span><span class="cm">/* Enable PCF on [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_STA_ID1_PCF_5210		0x00200000	</span><span class="cm">/* Enable PCF on [5210]*/</span><span class="cp"></span>
<span class="cp">#define	AR5K_STA_ID1_PCF		(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">					AR5K_STA_ID1_PCF_5210 : AR5K_STA_ID1_PCF_5211)</span>
<span class="cp">#define AR5K_STA_ID1_DEFAULT_ANTENNA	0x00200000	</span><span class="cm">/* Use default antenna */</span><span class="cp"></span>
<span class="cp">#define AR5K_STA_ID1_DESC_ANTENNA	0x00400000	</span><span class="cm">/* Update antenna from descriptor */</span><span class="cp"></span>
<span class="cp">#define AR5K_STA_ID1_RTS_DEF_ANTENNA	0x00800000	</span><span class="cm">/* Use default antenna for RTS */</span><span class="cp"></span>
<span class="cp">#define AR5K_STA_ID1_ACKCTS_6MB		0x01000000	</span><span class="cm">/* Rate to use for ACK/CTS. 0: highest mandatory rate &lt;= RX rate; 1: 1Mbps in B mode */</span><span class="cp"></span>
<span class="cp">#define AR5K_STA_ID1_BASE_RATE_11B	0x02000000	</span><span class="cm">/* 802.11b base rate. 0: 1, 2, 5.5 and 11Mbps; 1: 1 and 2Mbps. [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_STA_ID1_SELFGEN_DEF_ANT	0x04000000	</span><span class="cm">/* Use def. antenna for self generated frames */</span><span class="cp"></span>
<span class="cp">#define AR5K_STA_ID1_CRYPT_MIC_EN	0x08000000	</span><span class="cm">/* Enable MIC */</span><span class="cp"></span>
<span class="cp">#define AR5K_STA_ID1_KEYSRCH_MODE	0x10000000	</span><span class="cm">/* Look up key when key id != 0 */</span><span class="cp"></span>
<span class="cp">#define AR5K_STA_ID1_PRESERVE_SEQ_NUM	0x20000000	</span><span class="cm">/* Preserve sequence number */</span><span class="cp"></span>
<span class="cp">#define AR5K_STA_ID1_CBCIV_ENDIAN	0x40000000	</span><span class="cm">/* ??? */</span><span class="cp"></span>
<span class="cp">#define AR5K_STA_ID1_KEYSRCH_MCAST	0x80000000	</span><span class="cm">/* Do key cache search for mcast frames */</span><span class="cp"></span>

<span class="cp">#define	AR5K_STA_ID1_ANTENNA_SETTINGS	(AR5K_STA_ID1_DEFAULT_ANTENNA | \</span>
<span class="cp">					AR5K_STA_ID1_DESC_ANTENNA | \</span>
<span class="cp">					AR5K_STA_ID1_RTS_DEF_ANTENNA | \</span>
<span class="cp">					AR5K_STA_ID1_SELFGEN_DEF_ANT)</span>

<span class="cm">/*</span>
<span class="cm"> * First BSSID register (MAC address, lower 32bits)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_BSS_ID0	0x8008</span>

<span class="cm">/*</span>
<span class="cm"> * Second BSSID register (MAC address in upper 16 bits)</span>
<span class="cm"> *</span>
<span class="cm"> * AID: Association ID</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_BSS_ID1		0x800c</span>
<span class="cp">#define AR5K_BSS_ID1_AID	0xffff0000</span>
<span class="cp">#define AR5K_BSS_ID1_AID_S	16</span>

<span class="cm">/*</span>
<span class="cm"> * Backoff slot time register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_SLOT_TIME	0x8010</span>

<span class="cm">/*</span>
<span class="cm"> * ACK/CTS timeout register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_TIME_OUT		0x8014			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_TIME_OUT_ACK	0x00001fff	</span><span class="cm">/* ACK timeout mask */</span><span class="cp"></span>
<span class="cp">#define AR5K_TIME_OUT_ACK_S	0</span>
<span class="cp">#define AR5K_TIME_OUT_CTS	0x1fff0000	</span><span class="cm">/* CTS timeout mask */</span><span class="cp"></span>
<span class="cp">#define AR5K_TIME_OUT_CTS_S	16</span>

<span class="cm">/*</span>
<span class="cm"> * RSSI threshold register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_RSSI_THR			0x8018		</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_RSSI_THR_M			0x000000ff	</span><span class="cm">/* Mask for RSSI threshold [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_RSSI_THR_BMISS_5210	0x00000700	</span><span class="cm">/* Mask for Beacon Missed threshold [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_RSSI_THR_BMISS_5210_S	8</span>
<span class="cp">#define AR5K_RSSI_THR_BMISS_5211	0x0000ff00	</span><span class="cm">/* Mask for Beacon Missed threshold [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_RSSI_THR_BMISS_5211_S	8</span>
<span class="cp">#define	AR5K_RSSI_THR_BMISS		(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">					AR5K_RSSI_THR_BMISS_5210 : AR5K_RSSI_THR_BMISS_5211)</span>
<span class="cp">#define	AR5K_RSSI_THR_BMISS_S		8</span>

<span class="cm">/*</span>
<span class="cm"> * 5210 has more PCU registers because there is no QCU/DCU</span>
<span class="cm"> * so queue parameters are set here, this way a lot common</span>
<span class="cm"> * registers have different address for 5210. To make things</span>
<span class="cm"> * easier we define a macro based on ah-&gt;ah_version for common</span>
<span class="cm"> * registers with different addresses and common flags.</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * Retry limit register</span>
<span class="cm"> *</span>
<span class="cm"> * Retry limit register for 5210 (no QCU/DCU so it&#39;s done in PCU)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_NODCU_RETRY_LMT		0x801c			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_NODCU_RETRY_LMT_SH_RETRY	0x0000000f	</span><span class="cm">/* Short retry limit mask */</span><span class="cp"></span>
<span class="cp">#define AR5K_NODCU_RETRY_LMT_SH_RETRY_S	0</span>
<span class="cp">#define AR5K_NODCU_RETRY_LMT_LG_RETRY	0x000000f0	</span><span class="cm">/* Long retry mask */</span><span class="cp"></span>
<span class="cp">#define AR5K_NODCU_RETRY_LMT_LG_RETRY_S	4</span>
<span class="cp">#define AR5K_NODCU_RETRY_LMT_SSH_RETRY	0x00003f00	</span><span class="cm">/* Station short retry limit mask */</span><span class="cp"></span>
<span class="cp">#define AR5K_NODCU_RETRY_LMT_SSH_RETRY_S	8</span>
<span class="cp">#define AR5K_NODCU_RETRY_LMT_SLG_RETRY	0x000fc000	</span><span class="cm">/* Station long retry limit mask */</span><span class="cp"></span>
<span class="cp">#define AR5K_NODCU_RETRY_LMT_SLG_RETRY_S	14</span>
<span class="cp">#define AR5K_NODCU_RETRY_LMT_CW_MIN	0x3ff00000	</span><span class="cm">/* Minimum contention window mask */</span><span class="cp"></span>
<span class="cp">#define AR5K_NODCU_RETRY_LMT_CW_MIN_S	20</span>

<span class="cm">/*</span>
<span class="cm"> * Transmit latency register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_USEC_5210			0x8020			</span><span class="cm">/* Register Address [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_USEC_5211			0x801c			</span><span class="cm">/* Register Address [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_USEC			(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">					AR5K_USEC_5210 : AR5K_USEC_5211)</span>
<span class="cp">#define AR5K_USEC_1			0x0000007f	</span><span class="cm">/* clock cycles for 1us */</span><span class="cp"></span>
<span class="cp">#define AR5K_USEC_1_S			0</span>
<span class="cp">#define AR5K_USEC_32			0x00003f80	</span><span class="cm">/* clock cycles for 1us while on 32MHz clock */</span><span class="cp"></span>
<span class="cp">#define AR5K_USEC_32_S			7</span>
<span class="cp">#define AR5K_USEC_TX_LATENCY_5211	0x007fc000</span>
<span class="cp">#define AR5K_USEC_TX_LATENCY_5211_S	14</span>
<span class="cp">#define AR5K_USEC_RX_LATENCY_5211	0x1f800000</span>
<span class="cp">#define AR5K_USEC_RX_LATENCY_5211_S	23</span>
<span class="cp">#define AR5K_USEC_TX_LATENCY_5210	0x000fc000	</span><span class="cm">/* also for 5311 */</span><span class="cp"></span>
<span class="cp">#define AR5K_USEC_TX_LATENCY_5210_S	14</span>
<span class="cp">#define AR5K_USEC_RX_LATENCY_5210	0x03f00000	</span><span class="cm">/* also for 5311 */</span><span class="cp"></span>
<span class="cp">#define AR5K_USEC_RX_LATENCY_5210_S	20</span>

<span class="cm">/*</span>
<span class="cm"> * PCU beacon control register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_BEACON_5210	0x8024			</span><span class="cm">/*Register Address [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_BEACON_5211	0x8020			</span><span class="cm">/*Register Address [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_BEACON		(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">				AR5K_BEACON_5210 : AR5K_BEACON_5211)</span>
<span class="cp">#define AR5K_BEACON_PERIOD	0x0000ffff	</span><span class="cm">/* Mask for beacon period */</span><span class="cp"></span>
<span class="cp">#define AR5K_BEACON_PERIOD_S	0</span>
<span class="cp">#define AR5K_BEACON_TIM		0x007f0000	</span><span class="cm">/* Mask for TIM offset */</span><span class="cp"></span>
<span class="cp">#define AR5K_BEACON_TIM_S	16</span>
<span class="cp">#define AR5K_BEACON_ENABLE	0x00800000	</span><span class="cm">/* Enable beacons */</span><span class="cp"></span>
<span class="cp">#define AR5K_BEACON_RESET_TSF	0x01000000	</span><span class="cm">/* Force TSF reset */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * CFP period register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_CFP_PERIOD_5210	0x8028</span>
<span class="cp">#define AR5K_CFP_PERIOD_5211	0x8024</span>
<span class="cp">#define AR5K_CFP_PERIOD		(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">				AR5K_CFP_PERIOD_5210 : AR5K_CFP_PERIOD_5211)</span>

<span class="cm">/*</span>
<span class="cm"> * Next beacon time register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_TIMER0_5210	0x802c</span>
<span class="cp">#define AR5K_TIMER0_5211	0x8028</span>
<span class="cp">#define AR5K_TIMER0		(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">				AR5K_TIMER0_5210 : AR5K_TIMER0_5211)</span>

<span class="cm">/*</span>
<span class="cm"> * Next DMA beacon alert register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_TIMER1_5210	0x8030</span>
<span class="cp">#define AR5K_TIMER1_5211	0x802c</span>
<span class="cp">#define AR5K_TIMER1		(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">				AR5K_TIMER1_5210 : AR5K_TIMER1_5211)</span>

<span class="cm">/*</span>
<span class="cm"> * Next software beacon alert register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_TIMER2_5210	0x8034</span>
<span class="cp">#define AR5K_TIMER2_5211	0x8030</span>
<span class="cp">#define AR5K_TIMER2		(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">				AR5K_TIMER2_5210 : AR5K_TIMER2_5211)</span>

<span class="cm">/*</span>
<span class="cm"> * Next ATIM window time register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_TIMER3_5210	0x8038</span>
<span class="cp">#define AR5K_TIMER3_5211	0x8034</span>
<span class="cp">#define AR5K_TIMER3		(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">				AR5K_TIMER3_5210 : AR5K_TIMER3_5211)</span>


<span class="cm">/*</span>
<span class="cm"> * 5210 First inter frame spacing register (IFS)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_IFS0		0x8040</span>
<span class="cp">#define AR5K_IFS0_SIFS		0x000007ff</span>
<span class="cp">#define AR5K_IFS0_SIFS_S	0</span>
<span class="cp">#define AR5K_IFS0_DIFS		0x007ff800</span>
<span class="cp">#define AR5K_IFS0_DIFS_S	11</span>

<span class="cm">/*</span>
<span class="cm"> * 5210 Second inter frame spacing register (IFS)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_IFS1		0x8044</span>
<span class="cp">#define AR5K_IFS1_PIFS		0x00000fff</span>
<span class="cp">#define AR5K_IFS1_PIFS_S	0</span>
<span class="cp">#define AR5K_IFS1_EIFS		0x03fff000</span>
<span class="cp">#define AR5K_IFS1_EIFS_S	12</span>
<span class="cp">#define AR5K_IFS1_CS_EN		0x04000000</span>
<span class="cp">#define AR5K_IFS1_CS_EN_S	26</span>

<span class="cm">/*</span>
<span class="cm"> * CFP duration register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_CFP_DUR_5210	0x8048</span>
<span class="cp">#define AR5K_CFP_DUR_5211	0x8038</span>
<span class="cp">#define AR5K_CFP_DUR		(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">				AR5K_CFP_DUR_5210 : AR5K_CFP_DUR_5211)</span>

<span class="cm">/*</span>
<span class="cm"> * Receive filter register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_RX_FILTER_5210	0x804c			</span><span class="cm">/* Register Address [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_RX_FILTER_5211	0x803c			</span><span class="cm">/* Register Address [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_RX_FILTER		(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">				AR5K_RX_FILTER_5210 : AR5K_RX_FILTER_5211)</span>
<span class="cp">#define	AR5K_RX_FILTER_UCAST	0x00000001	</span><span class="cm">/* Don&#39;t filter unicast frames */</span><span class="cp"></span>
<span class="cp">#define	AR5K_RX_FILTER_MCAST	0x00000002	</span><span class="cm">/* Don&#39;t filter multicast frames */</span><span class="cp"></span>
<span class="cp">#define	AR5K_RX_FILTER_BCAST	0x00000004	</span><span class="cm">/* Don&#39;t filter broadcast frames */</span><span class="cp"></span>
<span class="cp">#define	AR5K_RX_FILTER_CONTROL	0x00000008	</span><span class="cm">/* Don&#39;t filter control frames */</span><span class="cp"></span>
<span class="cp">#define	AR5K_RX_FILTER_BEACON	0x00000010	</span><span class="cm">/* Don&#39;t filter beacon frames */</span><span class="cp"></span>
<span class="cp">#define	AR5K_RX_FILTER_PROM	0x00000020	</span><span class="cm">/* Set promiscuous mode */</span><span class="cp"></span>
<span class="cp">#define	AR5K_RX_FILTER_XRPOLL	0x00000040	</span><span class="cm">/* Don&#39;t filter XR poll frame [5212+] */</span><span class="cp"></span>
<span class="cp">#define	AR5K_RX_FILTER_PROBEREQ 0x00000080	</span><span class="cm">/* Don&#39;t filter probe requests [5212+] */</span><span class="cp"></span>
<span class="cp">#define	AR5K_RX_FILTER_PHYERR_5212	0x00000100	</span><span class="cm">/* Don&#39;t filter phy errors [5212+] */</span><span class="cp"></span>
<span class="cp">#define	AR5K_RX_FILTER_RADARERR_5212	0x00000200	</span><span class="cm">/* Don&#39;t filter phy radar errors [5212+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_RX_FILTER_PHYERR_5211	0x00000040	</span><span class="cm">/* [5211] */</span><span class="cp"></span>
<span class="cp">#define AR5K_RX_FILTER_RADARERR_5211	0x00000080	</span><span class="cm">/* [5211] */</span><span class="cp"></span>
<span class="cp">#define AR5K_RX_FILTER_PHYERR  \</span>
<span class="cp">	((ah-&gt;ah_version == AR5K_AR5211 ? \</span>
<span class="cp">	AR5K_RX_FILTER_PHYERR_5211 : AR5K_RX_FILTER_PHYERR_5212))</span>
<span class="cp">#define        AR5K_RX_FILTER_RADARERR \</span>
<span class="cp">	((ah-&gt;ah_version == AR5K_AR5211 ? \</span>
<span class="cp">	AR5K_RX_FILTER_RADARERR_5211 : AR5K_RX_FILTER_RADARERR_5212))</span>

<span class="cm">/*</span>
<span class="cm"> * Multicast filter register (lower 32 bits)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_MCAST_FILTER0_5210	0x8050</span>
<span class="cp">#define AR5K_MCAST_FILTER0_5211	0x8040</span>
<span class="cp">#define AR5K_MCAST_FILTER0	(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">				AR5K_MCAST_FILTER0_5210 : AR5K_MCAST_FILTER0_5211)</span>

<span class="cm">/*</span>
<span class="cm"> * Multicast filter register (higher 16 bits)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_MCAST_FILTER1_5210	0x8054</span>
<span class="cp">#define AR5K_MCAST_FILTER1_5211	0x8044</span>
<span class="cp">#define AR5K_MCAST_FILTER1	(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">				AR5K_MCAST_FILTER1_5210 : AR5K_MCAST_FILTER1_5211)</span>


<span class="cm">/*</span>
<span class="cm"> * Transmit mask register (lower 32 bits) [5210]</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_TX_MASK0	0x8058</span>

<span class="cm">/*</span>
<span class="cm"> * Transmit mask register (higher 16 bits) [5210]</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_TX_MASK1	0x805c</span>

<span class="cm">/*</span>
<span class="cm"> * Clear transmit mask [5210]</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_CLR_TMASK	0x8060</span>

<span class="cm">/*</span>
<span class="cm"> * Trigger level register (before transmission) [5210]</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_TRIG_LVL	0x8064</span>


<span class="cm">/*</span>
<span class="cm"> * PCU Diagnostic register</span>
<span class="cm"> *</span>
<span class="cm"> * Used for tweaking/diagnostics.</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_DIAG_SW_5210		0x8068			</span><span class="cm">/* Register Address [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_DIAG_SW_5211		0x8048			</span><span class="cm">/* Register Address [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_DIAG_SW			(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">					AR5K_DIAG_SW_5210 : AR5K_DIAG_SW_5211)</span>
<span class="cp">#define AR5K_DIAG_SW_DIS_WEP_ACK	0x00000001	</span><span class="cm">/* Disable ACKs if WEP key is invalid */</span><span class="cp"></span>
<span class="cp">#define AR5K_DIAG_SW_DIS_ACK		0x00000002	</span><span class="cm">/* Disable ACKs */</span><span class="cp"></span>
<span class="cp">#define AR5K_DIAG_SW_DIS_CTS		0x00000004	</span><span class="cm">/* Disable CTSs */</span><span class="cp"></span>
<span class="cp">#define AR5K_DIAG_SW_DIS_ENC		0x00000008	</span><span class="cm">/* Disable HW encryption */</span><span class="cp"></span>
<span class="cp">#define AR5K_DIAG_SW_DIS_DEC		0x00000010	</span><span class="cm">/* Disable HW decryption */</span><span class="cp"></span>
<span class="cp">#define AR5K_DIAG_SW_DIS_TX_5210	0x00000020	</span><span class="cm">/* Disable transmit [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_DIAG_SW_DIS_RX_5210	0x00000040	</span><span class="cm">/* Disable receive */</span><span class="cp"></span>
<span class="cp">#define AR5K_DIAG_SW_DIS_RX_5211	0x00000020</span>
<span class="cp">#define	AR5K_DIAG_SW_DIS_RX		(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">					AR5K_DIAG_SW_DIS_RX_5210 : AR5K_DIAG_SW_DIS_RX_5211)</span>
<span class="cp">#define AR5K_DIAG_SW_LOOP_BACK_5210	0x00000080	</span><span class="cm">/* TX Data Loopback (i guess it goes with DIS_TX) [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_DIAG_SW_LOOP_BACK_5211	0x00000040</span>
<span class="cp">#define AR5K_DIAG_SW_LOOP_BACK		(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">					AR5K_DIAG_SW_LOOP_BACK_5210 : AR5K_DIAG_SW_LOOP_BACK_5211)</span>
<span class="cp">#define AR5K_DIAG_SW_CORR_FCS_5210	0x00000100	</span><span class="cm">/* Generate invalid TX FCS */</span><span class="cp"></span>
<span class="cp">#define AR5K_DIAG_SW_CORR_FCS_5211	0x00000080</span>
<span class="cp">#define AR5K_DIAG_SW_CORR_FCS		(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">					AR5K_DIAG_SW_CORR_FCS_5210 : AR5K_DIAG_SW_CORR_FCS_5211)</span>
<span class="cp">#define AR5K_DIAG_SW_CHAN_INFO_5210	0x00000200	</span><span class="cm">/* Add 56 bytes of channel info before the frame data in the RX buffer */</span><span class="cp"></span>
<span class="cp">#define AR5K_DIAG_SW_CHAN_INFO_5211	0x00000100</span>
<span class="cp">#define AR5K_DIAG_SW_CHAN_INFO		(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">					AR5K_DIAG_SW_CHAN_INFO_5210 : AR5K_DIAG_SW_CHAN_INFO_5211)</span>
<span class="cp">#define AR5K_DIAG_SW_EN_SCRAM_SEED_5210	0x00000400	</span><span class="cm">/* Enable fixed scrambler seed */</span><span class="cp"></span>
<span class="cp">#define AR5K_DIAG_SW_EN_SCRAM_SEED_5211	0x00000200</span>
<span class="cp">#define AR5K_DIAG_SW_EN_SCRAM_SEED	(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">					AR5K_DIAG_SW_EN_SCRAM_SEED_5210 : AR5K_DIAG_SW_EN_SCRAM_SEED_5211)</span>
<span class="cp">#define AR5K_DIAG_SW_ECO_ENABLE		0x00000400	</span><span class="cm">/* [5211+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_DIAG_SW_SCVRAM_SEED	0x0003f800	</span><span class="cm">/* [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_DIAG_SW_SCRAM_SEED_M	0x0001fc00	</span><span class="cm">/* Scrambler seed mask */</span><span class="cp"></span>
<span class="cp">#define AR5K_DIAG_SW_SCRAM_SEED_S	10</span>
<span class="cp">#define AR5K_DIAG_SW_DIS_SEQ_INC_5210	0x00040000	</span><span class="cm">/* Disable seqnum increment (?)[5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_DIAG_SW_FRAME_NV0_5210	0x00080000</span>
<span class="cp">#define AR5K_DIAG_SW_FRAME_NV0_5211	0x00020000	</span><span class="cm">/* Accept frames of non-zero protocol number */</span><span class="cp"></span>
<span class="cp">#define	AR5K_DIAG_SW_FRAME_NV0		(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">					AR5K_DIAG_SW_FRAME_NV0_5210 : AR5K_DIAG_SW_FRAME_NV0_5211)</span>
<span class="cp">#define AR5K_DIAG_SW_OBSPT_M		0x000c0000	</span><span class="cm">/* Observation point select (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_DIAG_SW_OBSPT_S		18</span>
<span class="cp">#define AR5K_DIAG_SW_RX_CLEAR_HIGH	0x00100000	</span><span class="cm">/* Ignore carrier sense */</span><span class="cp"></span>
<span class="cp">#define AR5K_DIAG_SW_IGNORE_CARR_SENSE	0x00200000	</span><span class="cm">/* Ignore virtual carrier sense */</span><span class="cp"></span>
<span class="cp">#define AR5K_DIAG_SW_CHANNEL_IDLE_HIGH	0x00400000	</span><span class="cm">/* Force channel idle high */</span><span class="cp"></span>
<span class="cp">#define AR5K_DIAG_SW_PHEAR_ME		0x00800000	</span><span class="cm">/* ??? */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * TSF (clock) register (lower 32 bits)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_TSF_L32_5210	0x806c</span>
<span class="cp">#define AR5K_TSF_L32_5211	0x804c</span>
<span class="cp">#define	AR5K_TSF_L32		(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">				AR5K_TSF_L32_5210 : AR5K_TSF_L32_5211)</span>

<span class="cm">/*</span>
<span class="cm"> * TSF (clock) register (higher 32 bits)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_TSF_U32_5210	0x8070</span>
<span class="cp">#define AR5K_TSF_U32_5211	0x8050</span>
<span class="cp">#define	AR5K_TSF_U32		(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">				AR5K_TSF_U32_5210 : AR5K_TSF_U32_5211)</span>

<span class="cm">/*</span>
<span class="cm"> * Last beacon timestamp register (Read Only)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_LAST_TSTP	0x8080</span>

<span class="cm">/*</span>
<span class="cm"> * ADDAC test register [5211+]</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_ADDAC_TEST			0x8054			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_ADDAC_TEST_TXCONT		0x00000001	</span><span class="cm">/* Test continuous tx */</span><span class="cp"></span>
<span class="cp">#define AR5K_ADDAC_TEST_TST_MODE	0x00000002	</span><span class="cm">/* Test mode */</span><span class="cp"></span>
<span class="cp">#define AR5K_ADDAC_TEST_LOOP_EN		0x00000004	</span><span class="cm">/* Enable loop */</span><span class="cp"></span>
<span class="cp">#define AR5K_ADDAC_TEST_LOOP_LEN	0x00000008	</span><span class="cm">/* Loop length (field) */</span><span class="cp"></span>
<span class="cp">#define AR5K_ADDAC_TEST_USE_U8		0x00004000	</span><span class="cm">/* Use upper 8 bits */</span><span class="cp"></span>
<span class="cp">#define AR5K_ADDAC_TEST_MSB		0x00008000	</span><span class="cm">/* State of MSB */</span><span class="cp"></span>
<span class="cp">#define AR5K_ADDAC_TEST_TRIG_SEL	0x00010000	</span><span class="cm">/* Trigger select */</span><span class="cp"></span>
<span class="cp">#define AR5K_ADDAC_TEST_TRIG_PTY	0x00020000	</span><span class="cm">/* Trigger polarity */</span><span class="cp"></span>
<span class="cp">#define AR5K_ADDAC_TEST_RXCONT		0x00040000	</span><span class="cm">/* Continuous capture */</span><span class="cp"></span>
<span class="cp">#define AR5K_ADDAC_TEST_CAPTURE		0x00080000	</span><span class="cm">/* Begin capture */</span><span class="cp"></span>
<span class="cp">#define AR5K_ADDAC_TEST_TST_ARM		0x00100000	</span><span class="cm">/* ARM rx buffer for capture */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Default antenna register [5211+]</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_DEFAULT_ANTENNA	0x8058</span>

<span class="cm">/*</span>
<span class="cm"> * Frame control QoS mask register (?) [5211+]</span>
<span class="cm"> * (FC_QOS_MASK)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_FRAME_CTL_QOSM	0x805c</span>

<span class="cm">/*</span>
<span class="cm"> * Seq mask register (?) [5211+]</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_SEQ_MASK	0x8060</span>

<span class="cm">/*</span>
<span class="cm"> * Retry count register [5210]</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_RETRY_CNT		0x8084			</span><span class="cm">/* Register Address [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_RETRY_CNT_SSH	0x0000003f	</span><span class="cm">/* Station short retry count (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_RETRY_CNT_SLG	0x00000fc0	</span><span class="cm">/* Station long retry count (?) */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Back-off status register [5210]</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_BACKOFF		0x8088			</span><span class="cm">/* Register Address [5210] */</span><span class="cp"></span>
<span class="cp">#define AR5K_BACKOFF_CW		0x000003ff	</span><span class="cm">/* Backoff Contention Window (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_BACKOFF_CNT	0x03ff0000	</span><span class="cm">/* Backoff count (?) */</span><span class="cp"></span>



<span class="cm">/*</span>
<span class="cm"> * NAV register (current)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_NAV_5210		0x808c</span>
<span class="cp">#define AR5K_NAV_5211		0x8084</span>
<span class="cp">#define	AR5K_NAV		(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">				AR5K_NAV_5210 : AR5K_NAV_5211)</span>

<span class="cm">/*</span>
<span class="cm"> * MIB counters:</span>
<span class="cm"> *</span>
<span class="cm"> * max value is 0xc000, if this is reached we get a MIB interrupt.</span>
<span class="cm"> * they can be controlled via AR5K_MIBC and are cleared on read.</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * RTS success (MIB counter)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_RTS_OK_5210	0x8090</span>
<span class="cp">#define AR5K_RTS_OK_5211	0x8088</span>
<span class="cp">#define	AR5K_RTS_OK		(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">				AR5K_RTS_OK_5210 : AR5K_RTS_OK_5211)</span>

<span class="cm">/*</span>
<span class="cm"> * RTS failure (MIB counter)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_RTS_FAIL_5210	0x8094</span>
<span class="cp">#define AR5K_RTS_FAIL_5211	0x808c</span>
<span class="cp">#define	AR5K_RTS_FAIL		(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">				AR5K_RTS_FAIL_5210 : AR5K_RTS_FAIL_5211)</span>

<span class="cm">/*</span>
<span class="cm"> * ACK failure (MIB counter)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_ACK_FAIL_5210	0x8098</span>
<span class="cp">#define AR5K_ACK_FAIL_5211	0x8090</span>
<span class="cp">#define	AR5K_ACK_FAIL		(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">				AR5K_ACK_FAIL_5210 : AR5K_ACK_FAIL_5211)</span>

<span class="cm">/*</span>
<span class="cm"> * FCS failure (MIB counter)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_FCS_FAIL_5210	0x809c</span>
<span class="cp">#define AR5K_FCS_FAIL_5211	0x8094</span>
<span class="cp">#define	AR5K_FCS_FAIL		(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">				AR5K_FCS_FAIL_5210 : AR5K_FCS_FAIL_5211)</span>

<span class="cm">/*</span>
<span class="cm"> * Beacon count register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_BEACON_CNT_5210	0x80a0</span>
<span class="cp">#define AR5K_BEACON_CNT_5211	0x8098</span>
<span class="cp">#define	AR5K_BEACON_CNT		(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">				AR5K_BEACON_CNT_5210 : AR5K_BEACON_CNT_5211)</span>


<span class="cm">/*===5212 Specific PCU registers===*/</span>

<span class="cm">/*</span>
<span class="cm"> * Transmit power control register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_TPC			0x80e8</span>
<span class="cp">#define AR5K_TPC_ACK			0x0000003f	</span><span class="cm">/* ack frames */</span><span class="cp"></span>
<span class="cp">#define AR5K_TPC_ACK_S			0</span>
<span class="cp">#define AR5K_TPC_CTS			0x00003f00	</span><span class="cm">/* cts frames */</span><span class="cp"></span>
<span class="cp">#define AR5K_TPC_CTS_S			8</span>
<span class="cp">#define AR5K_TPC_CHIRP			0x003f0000	</span><span class="cm">/* chirp frames */</span><span class="cp"></span>
<span class="cp">#define AR5K_TPC_CHIRP_S		16</span>
<span class="cp">#define AR5K_TPC_DOPPLER		0x0f000000	</span><span class="cm">/* doppler chirp span */</span><span class="cp"></span>
<span class="cp">#define AR5K_TPC_DOPPLER_S		24</span>

<span class="cm">/*</span>
<span class="cm"> * XR (eXtended Range) mode register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_XRMODE			0x80c0			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_XRMODE_POLL_TYPE_M		0x0000003f	</span><span class="cm">/* Mask for Poll type (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_XRMODE_POLL_TYPE_S		0</span>
<span class="cp">#define	AR5K_XRMODE_POLL_SUBTYPE_M	0x0000003c	</span><span class="cm">/* Mask for Poll subtype (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_XRMODE_POLL_SUBTYPE_S	2</span>
<span class="cp">#define	AR5K_XRMODE_POLL_WAIT_ALL	0x00000080	</span><span class="cm">/* Wait for poll */</span><span class="cp"></span>
<span class="cp">#define	AR5K_XRMODE_SIFS_DELAY		0x000fff00	</span><span class="cm">/* Mask for SIFS delay */</span><span class="cp"></span>
<span class="cp">#define	AR5K_XRMODE_FRAME_HOLD_M	0xfff00000	</span><span class="cm">/* Mask for frame hold (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_XRMODE_FRAME_HOLD_S	20</span>

<span class="cm">/*</span>
<span class="cm"> * XR delay register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_XRDELAY			0x80c4			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_XRDELAY_SLOT_DELAY_M	0x0000ffff	</span><span class="cm">/* Mask for slot delay */</span><span class="cp"></span>
<span class="cp">#define AR5K_XRDELAY_SLOT_DELAY_S	0</span>
<span class="cp">#define AR5K_XRDELAY_CHIRP_DELAY_M	0xffff0000	</span><span class="cm">/* Mask for CHIRP data delay */</span><span class="cp"></span>
<span class="cp">#define AR5K_XRDELAY_CHIRP_DELAY_S	16</span>

<span class="cm">/*</span>
<span class="cm"> * XR timeout register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_XRTIMEOUT			0x80c8			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_XRTIMEOUT_CHIRP_M		0x0000ffff	</span><span class="cm">/* Mask for CHIRP timeout */</span><span class="cp"></span>
<span class="cp">#define AR5K_XRTIMEOUT_CHIRP_S		0</span>
<span class="cp">#define AR5K_XRTIMEOUT_POLL_M		0xffff0000	</span><span class="cm">/* Mask for Poll timeout */</span><span class="cp"></span>
<span class="cp">#define AR5K_XRTIMEOUT_POLL_S		16</span>

<span class="cm">/*</span>
<span class="cm"> * XR chirp register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_XRCHIRP			0x80cc			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_XRCHIRP_SEND		0x00000001	</span><span class="cm">/* Send CHIRP */</span><span class="cp"></span>
<span class="cp">#define AR5K_XRCHIRP_GAP		0xffff0000	</span><span class="cm">/* Mask for CHIRP gap (?) */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * XR stomp register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_XRSTOMP			0x80d0			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_XRSTOMP_TX			0x00000001	</span><span class="cm">/* Stomp Tx (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_XRSTOMP_RX			0x00000002	</span><span class="cm">/* Stomp Rx (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_XRSTOMP_TX_RSSI		0x00000004	</span><span class="cm">/* Stomp Tx RSSI (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_XRSTOMP_TX_BSSID		0x00000008	</span><span class="cm">/* Stomp Tx BSSID (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_XRSTOMP_DATA		0x00000010	</span><span class="cm">/* Stomp data (?)*/</span><span class="cp"></span>
<span class="cp">#define AR5K_XRSTOMP_RSSI_THRES		0x0000ff00	</span><span class="cm">/* Mask for XR RSSI threshold */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * First enhanced sleep register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_SLEEP0			0x80d4			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_SLEEP0_NEXT_DTIM		0x0007ffff	</span><span class="cm">/* Mask for next DTIM (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_SLEEP0_NEXT_DTIM_S		0</span>
<span class="cp">#define AR5K_SLEEP0_ASSUME_DTIM		0x00080000	</span><span class="cm">/* Assume DTIM */</span><span class="cp"></span>
<span class="cp">#define AR5K_SLEEP0_ENH_SLEEP_EN	0x00100000	</span><span class="cm">/* Enable enhanced sleep control */</span><span class="cp"></span>
<span class="cp">#define AR5K_SLEEP0_CABTO		0xff000000	</span><span class="cm">/* Mask for CAB Time Out */</span><span class="cp"></span>
<span class="cp">#define AR5K_SLEEP0_CABTO_S		24</span>

<span class="cm">/*</span>
<span class="cm"> * Second enhanced sleep register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_SLEEP1			0x80d8			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_SLEEP1_NEXT_TIM		0x0007ffff	</span><span class="cm">/* Mask for next TIM (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_SLEEP1_NEXT_TIM_S		0</span>
<span class="cp">#define AR5K_SLEEP1_BEACON_TO		0xff000000	</span><span class="cm">/* Mask for Beacon Time Out */</span><span class="cp"></span>
<span class="cp">#define AR5K_SLEEP1_BEACON_TO_S		24</span>

<span class="cm">/*</span>
<span class="cm"> * Third enhanced sleep register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_SLEEP2			0x80dc			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_SLEEP2_TIM_PER		0x0000ffff	</span><span class="cm">/* Mask for TIM period (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_SLEEP2_TIM_PER_S		0</span>
<span class="cp">#define AR5K_SLEEP2_DTIM_PER		0xffff0000	</span><span class="cm">/* Mask for DTIM period (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_SLEEP2_DTIM_PER_S		16</span>

<span class="cm">/*</span>
<span class="cm"> * TX power control (TPC) register</span>
<span class="cm"> *</span>
<span class="cm"> * XXX: PCDAC steps (0.5dBm) or dBm ?</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_TXPC			0x80e8			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_TXPC_ACK_M			0x0000003f	</span><span class="cm">/* ACK tx power */</span><span class="cp"></span>
<span class="cp">#define AR5K_TXPC_ACK_S			0</span>
<span class="cp">#define AR5K_TXPC_CTS_M			0x00003f00	</span><span class="cm">/* CTS tx power */</span><span class="cp"></span>
<span class="cp">#define AR5K_TXPC_CTS_S			8</span>
<span class="cp">#define AR5K_TXPC_CHIRP_M		0x003f0000	</span><span class="cm">/* CHIRP tx power */</span><span class="cp"></span>
<span class="cp">#define AR5K_TXPC_CHIRP_S		16</span>
<span class="cp">#define AR5K_TXPC_DOPPLER		0x0f000000	</span><span class="cm">/* Doppler chirp span (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_TXPC_DOPPLER_S		24</span>

<span class="cm">/*</span>
<span class="cm"> * Profile count registers</span>
<span class="cm"> *</span>
<span class="cm"> * These registers can be cleared and frozen with ATH5K_MIBC, but they do not</span>
<span class="cm"> * generate a MIB interrupt.</span>
<span class="cm"> * Instead of overflowing, they shift by one bit to the right. All registers</span>
<span class="cm"> * shift together, i.e. when one reaches the max, all shift at the same time by</span>
<span class="cm"> * one bit to the right. This way we should always get consistent values.</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_PROFCNT_TX			0x80ec	</span><span class="cm">/* Tx count */</span><span class="cp"></span>
<span class="cp">#define AR5K_PROFCNT_RX			0x80f0	</span><span class="cm">/* Rx count */</span><span class="cp"></span>
<span class="cp">#define AR5K_PROFCNT_RXCLR		0x80f4	</span><span class="cm">/* Busy count */</span><span class="cp"></span>
<span class="cp">#define AR5K_PROFCNT_CYCLE		0x80f8	</span><span class="cm">/* Cycle counter */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Quiet period control registers</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_QUIET_CTL1			0x80fc			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_QUIET_CTL1_NEXT_QT_TSF	0x0000ffff	</span><span class="cm">/* Next quiet period TSF (TU) */</span><span class="cp"></span>
<span class="cp">#define AR5K_QUIET_CTL1_NEXT_QT_TSF_S	0</span>
<span class="cp">#define AR5K_QUIET_CTL1_QT_EN		0x00010000	</span><span class="cm">/* Enable quiet period */</span><span class="cp"></span>
<span class="cp">#define AR5K_QUIET_CTL1_ACK_CTS_EN	0x00020000	</span><span class="cm">/* Send ACK/CTS during quiet period */</span><span class="cp"></span>

<span class="cp">#define AR5K_QUIET_CTL2			0x8100			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_QUIET_CTL2_QT_PER		0x0000ffff	</span><span class="cm">/* Mask for quiet period periodicity */</span><span class="cp"></span>
<span class="cp">#define AR5K_QUIET_CTL2_QT_PER_S	0</span>
<span class="cp">#define AR5K_QUIET_CTL2_QT_DUR		0xffff0000	</span><span class="cm">/* Mask for quiet period duration */</span><span class="cp"></span>
<span class="cp">#define AR5K_QUIET_CTL2_QT_DUR_S	16</span>

<span class="cm">/*</span>
<span class="cm"> * TSF parameter register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_TSF_PARM			0x8104			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_TSF_PARM_INC		0x000000ff	</span><span class="cm">/* Mask for TSF increment */</span><span class="cp"></span>
<span class="cp">#define AR5K_TSF_PARM_INC_S		0</span>

<span class="cm">/*</span>
<span class="cm"> * QoS NOACK policy</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_QOS_NOACK			0x8108			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_QOS_NOACK_2BIT_VALUES	0x0000000f	</span><span class="cm">/* ??? */</span><span class="cp"></span>
<span class="cp">#define AR5K_QOS_NOACK_2BIT_VALUES_S	0</span>
<span class="cp">#define AR5K_QOS_NOACK_BIT_OFFSET	0x00000070	</span><span class="cm">/* ??? */</span><span class="cp"></span>
<span class="cp">#define AR5K_QOS_NOACK_BIT_OFFSET_S	4</span>
<span class="cp">#define AR5K_QOS_NOACK_BYTE_OFFSET	0x00000180	</span><span class="cm">/* ??? */</span><span class="cp"></span>
<span class="cp">#define AR5K_QOS_NOACK_BYTE_OFFSET_S	7</span>

<span class="cm">/*</span>
<span class="cm"> * PHY error filter register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_PHY_ERR_FIL		0x810c</span>
<span class="cp">#define AR5K_PHY_ERR_FIL_RADAR		0x00000020	</span><span class="cm">/* Radar signal */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_ERR_FIL_OFDM		0x00020000	</span><span class="cm">/* OFDM false detect (ANI) */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_ERR_FIL_CCK		0x02000000	</span><span class="cm">/* CCK false detect (ANI) */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * XR latency register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_XRLAT_TX		0x8110</span>

<span class="cm">/*</span>
<span class="cm"> * ACK SIFS register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_ACKSIFS		0x8114			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_ACKSIFS_INC	0x00000000	</span><span class="cm">/* ACK SIFS Increment (field) */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * MIC QoS control register (?)</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_MIC_QOS_CTL		0x8118			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_MIC_QOS_CTL_OFF(_n)	(1 &lt;&lt; (_n * 2))</span>
<span class="cp">#define	AR5K_MIC_QOS_CTL_MQ_EN		0x00010000	</span><span class="cm">/* Enable MIC QoS */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * MIC QoS select register (?)</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_MIC_QOS_SEL		0x811c</span>
<span class="cp">#define	AR5K_MIC_QOS_SEL_OFF(_n)	(1 &lt;&lt; (_n * 4))</span>

<span class="cm">/*</span>
<span class="cm"> * Misc mode control register (?)</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_MISC_MODE			0x8120			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_MISC_MODE_FBSSID_MATCH	0x00000001	</span><span class="cm">/* Force BSSID match */</span><span class="cp"></span>
<span class="cp">#define	AR5K_MISC_MODE_ACKSIFS_MEM	0x00000002	</span><span class="cm">/* ACK SIFS memory (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_MISC_MODE_COMBINED_MIC	0x00000004	</span><span class="cm">/* use rx/tx MIC key */</span><span class="cp"></span>
<span class="cm">/* more bits */</span>

<span class="cm">/*</span>
<span class="cm"> * OFDM Filter counter</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_OFDM_FIL_CNT		0x8124</span>

<span class="cm">/*</span>
<span class="cm"> * CCK Filter counter</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_CCK_FIL_CNT		0x8128</span>

<span class="cm">/*</span>
<span class="cm"> * PHY Error Counters (same masks as AR5K_PHY_ERR_FIL)</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHYERR_CNT1		0x812c</span>
<span class="cp">#define	AR5K_PHYERR_CNT1_MASK		0x8130</span>

<span class="cp">#define	AR5K_PHYERR_CNT2		0x8134</span>
<span class="cp">#define	AR5K_PHYERR_CNT2_MASK		0x8138</span>

<span class="cm">/* if the PHY Error Counters reach this maximum, we get MIB interrupts */</span>
<span class="cp">#define ATH5K_PHYERR_CNT_MAX		0x00c00000</span>

<span class="cm">/*</span>
<span class="cm"> * TSF Threshold register (?)</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_TSF_THRES			0x813c</span>

<span class="cm">/*</span>
<span class="cm"> * TODO: Wake On Wireless registers</span>
<span class="cm"> * Range: 0x8147 - 0x818c</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * Rate -&gt; ACK SIFS mapping table (32 entries)</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_RATE_ACKSIFS_BASE		0x8680			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_RATE_ACKSIFS(_n)		(AR5K_RATE_ACKSIFS_BSE + ((_n) &lt;&lt; 2))</span>
<span class="cp">#define	AR5K_RATE_ACKSIFS_NORMAL	0x00000001	</span><span class="cm">/* Normal SIFS (field) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_RATE_ACKSIFS_TURBO		0x00000400	</span><span class="cm">/* Turbo SIFS (field) */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Rate -&gt; duration mapping table (32 entries)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_RATE_DUR_BASE		0x8700</span>
<span class="cp">#define AR5K_RATE_DUR(_n)		(AR5K_RATE_DUR_BASE + ((_n) &lt;&lt; 2))</span>

<span class="cm">/*</span>
<span class="cm"> * Rate -&gt; db mapping table</span>
<span class="cm"> * (8 entries, each one has 4 8bit fields)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_RATE2DB_BASE		0x87c0</span>
<span class="cp">#define AR5K_RATE2DB(_n)		(AR5K_RATE2DB_BASE + ((_n) &lt;&lt; 2))</span>

<span class="cm">/*</span>
<span class="cm"> * db -&gt; Rate mapping table</span>
<span class="cm"> * (8 entries, each one has 4 8bit fields)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_DB2RATE_BASE		0x87e0</span>
<span class="cp">#define AR5K_DB2RATE(_n)		(AR5K_DB2RATE_BASE + ((_n) &lt;&lt; 2))</span>

<span class="cm">/*===5212 end===*/</span>

<span class="cp">#define AR5K_KEYTABLE_SIZE_5210		64</span>
<span class="cp">#define AR5K_KEYTABLE_SIZE_5211		128</span>

<span class="cm">/*===PHY REGISTERS===*/</span>

<span class="cm">/*</span>
<span class="cm"> * PHY registers start</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_BASE			0x9800</span>
<span class="cp">#define	AR5K_PHY(_n)			(AR5K_PHY_BASE + ((_n) &lt;&lt; 2))</span>

<span class="cm">/*</span>
<span class="cm"> * TST_2 (Misc config parameters)</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_TST2			0x9800			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_TST2_TRIG_SEL		0x00000007	</span><span class="cm">/* Trigger select (?)*/</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_TST2_TRIG		0x00000010	</span><span class="cm">/* Trigger (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_TST2_CBUS_MODE		0x00000060	</span><span class="cm">/* Cardbus mode (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_TST2_CLK32		0x00000400	</span><span class="cm">/* CLK_OUT is CLK32 (32kHz external) */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_TST2_CHANCOR_DUMP_EN	0x00000800	</span><span class="cm">/* Enable Chancor dump (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_TST2_EVEN_CHANCOR_DUMP	0x00001000	</span><span class="cm">/* Even Chancor dump (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_TST2_RFSILENT_EN	0x00002000	</span><span class="cm">/* Enable RFSILENT */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_TST2_ALT_RFDATA	0x00004000	</span><span class="cm">/* Alternate RFDATA (5-2GHz switch ?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_TST2_MINI_OBS_EN	0x00008000	</span><span class="cm">/* Enable mini OBS (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_TST2_RX2_IS_RX5_INV	0x00010000	</span><span class="cm">/* 2GHz rx path is the 5GHz path inverted (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_TST2_SLOW_CLK160	0x00020000	</span><span class="cm">/* Slow CLK160 (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_TST2_AGC_OBS_SEL_3	0x00040000	</span><span class="cm">/* AGC OBS Select 3 (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_TST2_BBB_OBS_SEL	0x00080000	</span><span class="cm">/* BB OBS Select (field ?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_TST2_ADC_OBS_SEL	0x00800000	</span><span class="cm">/* ADC OBS Select (field ?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_TST2_RX_CLR_SEL	0x08000000	</span><span class="cm">/* RX Clear Select (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_TST2_FORCE_AGC_CLR	0x10000000	</span><span class="cm">/* Force AGC clear (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_SHIFT_2GHZ		0x00004007	</span><span class="cm">/* Used to access 2GHz radios */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_SHIFT_5GHZ		0x00000007	</span><span class="cm">/* Used to access 5GHz radios (default) */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * PHY frame control register [5110] /turbo mode register [5111+]</span>
<span class="cm"> *</span>
<span class="cm"> * There is another frame control register for [5111+]</span>
<span class="cm"> * at address 0x9944 (see below) but the 2 first flags</span>
<span class="cm"> * are common here between 5110 frame control register</span>
<span class="cm"> * and [5111+] turbo mode register, so this also works as</span>
<span class="cm"> * a &quot;turbo mode register&quot; for 5110. We treat this one as</span>
<span class="cm"> * a frame control register for 5110 below.</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_TURBO			0x9804			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_TURBO_MODE		0x00000001	</span><span class="cm">/* Enable turbo mode */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_TURBO_SHORT		0x00000002	</span><span class="cm">/* Set short symbols to turbo mode */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_TURBO_MIMO		0x00000004	</span><span class="cm">/* Set turbo for mimo */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * PHY agility command register</span>
<span class="cm"> * (aka TST_1)</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_AGC			0x9808			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_TST1			0x9808</span>
<span class="cp">#define	AR5K_PHY_AGC_DISABLE		0x08000000	</span><span class="cm">/* Disable AGC to A2 (?)*/</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_TST1_TXHOLD		0x00003800	</span><span class="cm">/* Set tx hold (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_TST1_TXSRC_SRC		0x00000002	</span><span class="cm">/* Used with bit 7 (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_TST1_TXSRC_SRC_S	1</span>
<span class="cp">#define	AR5K_PHY_TST1_TXSRC_ALT		0x00000080	</span><span class="cm">/* Set input to tsdac (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_TST1_TXSRC_ALT_S	7</span>


<span class="cm">/*</span>
<span class="cm"> * PHY timing register 3 [5112+]</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_TIMING_3		0x9814</span>
<span class="cp">#define	AR5K_PHY_TIMING_3_DSC_MAN	0xfffe0000</span>
<span class="cp">#define	AR5K_PHY_TIMING_3_DSC_MAN_S	17</span>
<span class="cp">#define	AR5K_PHY_TIMING_3_DSC_EXP	0x0001e000</span>
<span class="cp">#define	AR5K_PHY_TIMING_3_DSC_EXP_S	13</span>

<span class="cm">/*</span>
<span class="cm"> * PHY chip revision register</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_CHIP_ID		0x9818</span>

<span class="cm">/*</span>
<span class="cm"> * PHY activation register</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_ACT			0x981c			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_ACT_ENABLE		0x00000001	</span><span class="cm">/* Activate PHY */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_ACT_DISABLE		0x00000002	</span><span class="cm">/* Deactivate PHY */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * PHY RF control registers</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_PHY_RF_CTL2		0x9824			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_RF_CTL2_TXF2TXD_START	0x0000000f	</span><span class="cm">/* TX frame to TX data start */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_RF_CTL2_TXF2TXD_START_S	0</span>

<span class="cp">#define AR5K_PHY_RF_CTL3		0x9828			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_RF_CTL3_TXE2XLNA_ON	0x0000ff00	</span><span class="cm">/* TX end to XLNA on */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_RF_CTL3_TXE2XLNA_ON_S	8</span>

<span class="cp">#define	AR5K_PHY_ADC_CTL			0x982c</span>
<span class="cp">#define	AR5K_PHY_ADC_CTL_INBUFGAIN_OFF		0x00000003</span>
<span class="cp">#define	AR5K_PHY_ADC_CTL_INBUFGAIN_OFF_S	0</span>
<span class="cp">#define	AR5K_PHY_ADC_CTL_PWD_DAC_OFF		0x00002000</span>
<span class="cp">#define	AR5K_PHY_ADC_CTL_PWD_BAND_GAP_OFF	0x00004000</span>
<span class="cp">#define	AR5K_PHY_ADC_CTL_PWD_ADC_OFF		0x00008000</span>
<span class="cp">#define	AR5K_PHY_ADC_CTL_INBUFGAIN_ON		0x00030000</span>
<span class="cp">#define	AR5K_PHY_ADC_CTL_INBUFGAIN_ON_S		16</span>

<span class="cp">#define AR5K_PHY_RF_CTL4		0x9834			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_RF_CTL4_TXF2XPA_A_ON	0x00000001	</span><span class="cm">/* TX frame to XPA A on (field) */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_RF_CTL4_TXF2XPA_B_ON	0x00000100	</span><span class="cm">/* TX frame to XPA B on (field) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_RF_CTL4_TXE2XPA_A_OFF	0x00010000	</span><span class="cm">/* TX end to XPA A off (field) */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_RF_CTL4_TXE2XPA_B_OFF	0x01000000	</span><span class="cm">/* TX end to XPA B off (field) */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Pre-Amplifier control register</span>
<span class="cm"> * (XPA -&gt; external pre-amplifier)</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_PA_CTL			0x9838			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_PA_CTL_XPA_A_HI	0x00000001	</span><span class="cm">/* XPA A high (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_PA_CTL_XPA_B_HI	0x00000002	</span><span class="cm">/* XPA B high (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_PA_CTL_XPA_A_EN	0x00000004	</span><span class="cm">/* Enable XPA A */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_PA_CTL_XPA_B_EN	0x00000008	</span><span class="cm">/* Enable XPA B */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * PHY settling register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_PHY_SETTLING		0x9844			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_SETTLING_AGC		0x0000007f	</span><span class="cm">/* AGC settling time */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_SETTLING_AGC_S		0</span>
<span class="cp">#define	AR5K_PHY_SETTLING_SWITCH	0x00003f80	</span><span class="cm">/* Switch settling time */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_SETTLING_SWITCH_S	7</span>

<span class="cm">/*</span>
<span class="cm"> * PHY Gain registers</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_PHY_GAIN			0x9848			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_GAIN_TXRX_ATTEN	0x0003f000	</span><span class="cm">/* TX-RX Attenuation */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_GAIN_TXRX_ATTEN_S	12</span>
<span class="cp">#define	AR5K_PHY_GAIN_TXRX_RF_MAX	0x007c0000</span>
<span class="cp">#define	AR5K_PHY_GAIN_TXRX_RF_MAX_S	18</span>

<span class="cp">#define	AR5K_PHY_GAIN_OFFSET		0x984c			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_GAIN_OFFSET_RXTX_FLAG	0x00020000	</span><span class="cm">/* RX-TX flag (?) */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Desired ADC/PGA size register</span>
<span class="cm"> * (for more infos read ANI patent)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_PHY_DESIRED_SIZE		0x9850			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_DESIRED_SIZE_ADC	0x000000ff	</span><span class="cm">/* ADC desired size */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_DESIRED_SIZE_ADC_S	0</span>
<span class="cp">#define	AR5K_PHY_DESIRED_SIZE_PGA	0x0000ff00	</span><span class="cm">/* PGA desired size */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_DESIRED_SIZE_PGA_S	8</span>
<span class="cp">#define	AR5K_PHY_DESIRED_SIZE_TOT	0x0ff00000	</span><span class="cm">/* Total desired size */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_DESIRED_SIZE_TOT_S	20</span>

<span class="cm">/*</span>
<span class="cm"> * PHY signal register</span>
<span class="cm"> * (for more infos read ANI patent)</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_SIG			0x9858			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_SIG_FIRSTEP		0x0003f000	</span><span class="cm">/* FIRSTEP */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_SIG_FIRSTEP_S		12</span>
<span class="cp">#define	AR5K_PHY_SIG_FIRPWR		0x03fc0000	</span><span class="cm">/* FIPWR */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_SIG_FIRPWR_S		18</span>

<span class="cm">/*</span>
<span class="cm"> * PHY coarse agility control register</span>
<span class="cm"> * (for more infos read ANI patent)</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_AGCCOARSE		0x985c			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_AGCCOARSE_LO		0x00007f80	</span><span class="cm">/* AGC Coarse low */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_AGCCOARSE_LO_S		7</span>
<span class="cp">#define	AR5K_PHY_AGCCOARSE_HI		0x003f8000	</span><span class="cm">/* AGC Coarse high */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_AGCCOARSE_HI_S		15</span>

<span class="cm">/*</span>
<span class="cm"> * PHY agility control register</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_AGCCTL			0x9860			</span><span class="cm">/* Register address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_AGCCTL_CAL		0x00000001	</span><span class="cm">/* Enable PHY calibration */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_AGCCTL_NF		0x00000002	</span><span class="cm">/* Enable Noise Floor calibration */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_AGCCTL_OFDM_DIV_DIS	0x00000008	</span><span class="cm">/* Disable antenna diversity on OFDM modes */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_AGCCTL_NF_EN		0x00008000	</span><span class="cm">/* Enable nf calibration to happen (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_AGCTL_FLTR_CAL		0x00010000	</span><span class="cm">/* Allow filter calibration (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_AGCCTL_NF_NOUPDATE	0x00020000	</span><span class="cm">/* Don&#39;t update nf automatically */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * PHY noise floor status register (CCA = Clear Channel Assessment)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_PHY_NF			0x9864			</span><span class="cm">/* Register address */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_NF_M			0x000001ff	</span><span class="cm">/* Noise floor, written to hardware in 1/2 dBm units */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_NF_SVAL(_n)           (((_n) &amp; AR5K_PHY_NF_M) | (1 &lt;&lt; 9))</span>
<span class="cp">#define	AR5K_PHY_NF_THRESH62		0x0007f000	</span><span class="cm">/* Thresh62 -check ANI patent- (field) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_NF_THRESH62_S		12</span>
<span class="cp">#define	AR5K_PHY_NF_MINCCA_PWR		0x0ff80000	</span><span class="cm">/* Minimum measured noise level, read from hardware in 1 dBm units */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_NF_MINCCA_PWR_S	19</span>

<span class="cm">/*</span>
<span class="cm"> * PHY ADC saturation register [5110]</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_ADCSAT			0x9868</span>
<span class="cp">#define	AR5K_PHY_ADCSAT_ICNT		0x0001f800</span>
<span class="cp">#define	AR5K_PHY_ADCSAT_ICNT_S		11</span>
<span class="cp">#define	AR5K_PHY_ADCSAT_THR		0x000007e0</span>
<span class="cp">#define	AR5K_PHY_ADCSAT_THR_S		5</span>

<span class="cm">/*</span>
<span class="cm"> * PHY Weak ofdm signal detection threshold registers (ANI) [5212+]</span>
<span class="cm"> */</span>

<span class="cm">/* High thresholds */</span>
<span class="cp">#define AR5K_PHY_WEAK_OFDM_HIGH_THR		0x9868</span>
<span class="cp">#define AR5K_PHY_WEAK_OFDM_HIGH_THR_M2_COUNT	0x0000001f</span>
<span class="cp">#define AR5K_PHY_WEAK_OFDM_HIGH_THR_M2_COUNT_S	0</span>
<span class="cp">#define AR5K_PHY_WEAK_OFDM_HIGH_THR_M1		0x00fe0000</span>
<span class="cp">#define AR5K_PHY_WEAK_OFDM_HIGH_THR_M1_S	17</span>
<span class="cp">#define AR5K_PHY_WEAK_OFDM_HIGH_THR_M2		0x7f000000</span>
<span class="cp">#define AR5K_PHY_WEAK_OFDM_HIGH_THR_M2_S	24</span>

<span class="cm">/* Low thresholds */</span>
<span class="cp">#define AR5K_PHY_WEAK_OFDM_LOW_THR		0x986c</span>
<span class="cp">#define AR5K_PHY_WEAK_OFDM_LOW_THR_SELFCOR_EN	0x00000001</span>
<span class="cp">#define AR5K_PHY_WEAK_OFDM_LOW_THR_M2_COUNT	0x00003f00</span>
<span class="cp">#define AR5K_PHY_WEAK_OFDM_LOW_THR_M2_COUNT_S	8</span>
<span class="cp">#define AR5K_PHY_WEAK_OFDM_LOW_THR_M1		0x001fc000</span>
<span class="cp">#define AR5K_PHY_WEAK_OFDM_LOW_THR_M1_S		14</span>
<span class="cp">#define AR5K_PHY_WEAK_OFDM_LOW_THR_M2		0x0fe00000</span>
<span class="cp">#define AR5K_PHY_WEAK_OFDM_LOW_THR_M2_S		21</span>


<span class="cm">/*</span>
<span class="cm"> * PHY sleep registers [5112+]</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_PHY_SCR			0x9870</span>

<span class="cp">#define AR5K_PHY_SLMT			0x9874</span>
<span class="cp">#define AR5K_PHY_SLMT_32MHZ		0x0000007f</span>

<span class="cp">#define AR5K_PHY_SCAL			0x9878</span>
<span class="cp">#define AR5K_PHY_SCAL_32MHZ		0x0000000e</span>
<span class="cp">#define	AR5K_PHY_SCAL_32MHZ_5311	0x00000008</span>
<span class="cp">#define	AR5K_PHY_SCAL_32MHZ_2417	0x0000000a</span>
<span class="cp">#define	AR5K_PHY_SCAL_32MHZ_HB63	0x00000032</span>

<span class="cm">/*</span>
<span class="cm"> * PHY PLL (Phase Locked Loop) control register</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_PLL			0x987c</span>
<span class="cp">#define	AR5K_PHY_PLL_20MHZ		0x00000013	</span><span class="cm">/* For half rate (?) */</span><span class="cp"></span>
<span class="cm">/* 40MHz -&gt; 5GHz band */</span>
<span class="cp">#define	AR5K_PHY_PLL_40MHZ_5211		0x00000018</span>
<span class="cp">#define	AR5K_PHY_PLL_40MHZ_5212		0x000000aa</span>
<span class="cp">#define	AR5K_PHY_PLL_40MHZ_5413		0x00000004</span>
<span class="cp">#define	AR5K_PHY_PLL_40MHZ		(ah-&gt;ah_version == AR5K_AR5211 ? \</span>
<span class="cp">					AR5K_PHY_PLL_40MHZ_5211 : AR5K_PHY_PLL_40MHZ_5212)</span>
<span class="cm">/* 44MHz -&gt; 2.4GHz band */</span>
<span class="cp">#define	AR5K_PHY_PLL_44MHZ_5211		0x00000019</span>
<span class="cp">#define	AR5K_PHY_PLL_44MHZ_5212		0x000000ab</span>
<span class="cp">#define	AR5K_PHY_PLL_44MHZ		(ah-&gt;ah_version == AR5K_AR5211 ? \</span>
<span class="cp">					AR5K_PHY_PLL_44MHZ_5211 : AR5K_PHY_PLL_44MHZ_5212)</span>

<span class="cp">#define AR5K_PHY_PLL_RF5111		0x00000000</span>
<span class="cp">#define AR5K_PHY_PLL_RF5112		0x00000040</span>
<span class="cp">#define	AR5K_PHY_PLL_HALF_RATE		0x00000100</span>
<span class="cp">#define	AR5K_PHY_PLL_QUARTER_RATE	0x00000200</span>

<span class="cm">/*</span>
<span class="cm"> * RF Buffer register</span>
<span class="cm"> *</span>
<span class="cm"> * It&#39;s obvious from the code that 0x989c is the buffer register but</span>
<span class="cm"> * for the other special registers that we write to after sending each</span>
<span class="cm"> * packet, i have no idea. So I&#39;ll name them BUFFER_CONTROL_X registers</span>
<span class="cm"> * for now. It&#39;s interesting that they are also used for some other operations.</span>
<span class="cm"> */</span>

<span class="cp">#define AR5K_RF_BUFFER			0x989c</span>
<span class="cp">#define AR5K_RF_BUFFER_CONTROL_0	0x98c0	</span><span class="cm">/* Channel on 5110 */</span><span class="cp"></span>
<span class="cp">#define AR5K_RF_BUFFER_CONTROL_1	0x98c4	</span><span class="cm">/* Bank 7 on 5112 */</span><span class="cp"></span>
<span class="cp">#define AR5K_RF_BUFFER_CONTROL_2	0x98cc	</span><span class="cm">/* Bank 7 on 5111 */</span><span class="cp"></span>

<span class="cp">#define AR5K_RF_BUFFER_CONTROL_3	0x98d0	</span><span class="cm">/* Bank 2 on 5112 */</span><span class="cp"></span>
						<span class="cm">/* Channel set on 5111 */</span>
						<span class="cm">/* Used to read radio revision*/</span>

<span class="cp">#define AR5K_RF_BUFFER_CONTROL_4	0x98d4  </span><span class="cm">/* RF Stage register on 5110 */</span><span class="cp"></span>
						<span class="cm">/* Bank 0,1,2,6 on 5111 */</span>
						<span class="cm">/* Bank 1 on 5112 */</span>
						<span class="cm">/* Used during activation on 5111 */</span>

<span class="cp">#define AR5K_RF_BUFFER_CONTROL_5	0x98d8	</span><span class="cm">/* Bank 3 on 5111 */</span><span class="cp"></span>
						<span class="cm">/* Used during activation on 5111 */</span>
						<span class="cm">/* Channel on 5112 */</span>
						<span class="cm">/* Bank 6 on 5112 */</span>

<span class="cp">#define AR5K_RF_BUFFER_CONTROL_6	0x98dc	</span><span class="cm">/* Bank 3 on 5112 */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * PHY RF stage register [5210]</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_PHY_RFSTG			0x98d4</span>
<span class="cp">#define AR5K_PHY_RFSTG_DISABLE		0x00000021</span>

<span class="cm">/*</span>
<span class="cm"> * BIN masks (?)</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_BIN_MASK_1	0x9900</span>
<span class="cp">#define	AR5K_PHY_BIN_MASK_2	0x9904</span>
<span class="cp">#define	AR5K_PHY_BIN_MASK_3	0x9908</span>

<span class="cp">#define	AR5K_PHY_BIN_MASK_CTL		0x990c</span>
<span class="cp">#define	AR5K_PHY_BIN_MASK_CTL_MASK_4	0x00003fff</span>
<span class="cp">#define	AR5K_PHY_BIN_MASK_CTL_MASK_4_S	0</span>
<span class="cp">#define	AR5K_PHY_BIN_MASK_CTL_RATE	0xff000000</span>
<span class="cp">#define	AR5K_PHY_BIN_MASK_CTL_RATE_S	24</span>

<span class="cm">/*</span>
<span class="cm"> * PHY Antenna control register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_PHY_ANT_CTL		0x9910			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_ANT_CTL_TXRX_EN	0x00000001	</span><span class="cm">/* Enable TX/RX (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_ANT_CTL_SECTORED_ANT	0x00000004	</span><span class="cm">/* Sectored Antenna */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_ANT_CTL_HITUNE5	0x00000008	</span><span class="cm">/* Hitune5 (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_ANT_CTL_SWTABLE_IDLE	0x000003f0	</span><span class="cm">/* Switch table idle (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_ANT_CTL_SWTABLE_IDLE_S	4</span>

<span class="cm">/*</span>
<span class="cm"> * PHY receiver delay register [5111+]</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_RX_DELAY		0x9914			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_RX_DELAY_M		0x00003fff	</span><span class="cm">/* Mask for RX activate to receive delay (/100ns) */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * PHY max rx length register (?) [5111]</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_MAX_RX_LEN		0x991c</span>

<span class="cm">/*</span>
<span class="cm"> * PHY timing register 4</span>
<span class="cm"> * I(nphase)/Q(adrature) calibration register [5111+]</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_IQ			0x9920			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_IQ_CORR_Q_Q_COFF	0x0000001f	</span><span class="cm">/* Mask for q correction info */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_IQ_CORR_Q_Q_COFF_S	0</span>
<span class="cp">#define	AR5K_PHY_IQ_CORR_Q_I_COFF	0x000007e0	</span><span class="cm">/* Mask for i correction info */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_IQ_CORR_Q_I_COFF_S	5</span>
<span class="cp">#define	AR5K_PHY_IQ_CORR_ENABLE		0x00000800	</span><span class="cm">/* Enable i/q correction */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_IQ_CAL_NUM_LOG_MAX	0x0000f000	</span><span class="cm">/* Mask for max number of samples in log scale */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_IQ_CAL_NUM_LOG_MAX_S	12</span>
<span class="cp">#define	AR5K_PHY_IQ_RUN			0x00010000	</span><span class="cm">/* Run i/q calibration */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_IQ_USE_PT_DF		0x00020000	</span><span class="cm">/* Use pilot track df (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_IQ_EARLY_TRIG_THR	0x00200000	</span><span class="cm">/* Early trigger threshold (?) (field) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_IQ_PILOT_MASK_EN	0x10000000	</span><span class="cm">/* Enable pilot mask (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_IQ_CHAN_MASK_EN	0x20000000	</span><span class="cm">/* Enable channel mask (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_IQ_SPUR_FILT_EN	0x40000000	</span><span class="cm">/* Enable spur filter */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_IQ_SPUR_RSSI_EN	0x80000000	</span><span class="cm">/* Enable spur rssi */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * PHY timing register 5</span>
<span class="cm"> * OFDM Self-correlator Cyclic RSSI threshold params</span>
<span class="cm"> * (Check out bb_cycpwr_thr1 on ANI patent)</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_OFDM_SELFCORR			0x9924			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_OFDM_SELFCORR_CYPWR_THR1_EN	0x00000001	</span><span class="cm">/* Enable cyclic RSSI thr 1 */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_OFDM_SELFCORR_CYPWR_THR1	0x000000fe	</span><span class="cm">/* Mask for Cyclic RSSI threshold 1 */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_OFDM_SELFCORR_CYPWR_THR1_S	1</span>
<span class="cp">#define	AR5K_PHY_OFDM_SELFCORR_CYPWR_THR3	0x00000100	</span><span class="cm">/* Cyclic RSSI threshold 3 (field) (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_OFDM_SELFCORR_RSSI_1ATHR_EN	0x00008000	</span><span class="cm">/* Enable 1A RSSI threshold (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_OFDM_SELFCORR_RSSI_1ATHR	0x00010000	</span><span class="cm">/* 1A RSSI threshold (field) (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_OFDM_SELFCORR_LSCTHR_HIRSSI	0x00800000	</span><span class="cm">/* Long sc threshold hi rssi (?) */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * PHY-only warm reset register</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_WARM_RESET		0x9928</span>

<span class="cm">/*</span>
<span class="cm"> * PHY-only control register</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_PHY_CTL			0x992c			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_CTL_RX_DRAIN_RATE	0x00000001	</span><span class="cm">/* RX drain rate (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_CTL_LATE_TX_SIG_SYM	0x00000002	</span><span class="cm">/* Late tx signal symbol (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_CTL_GEN_SCRAMBLER	0x00000004	</span><span class="cm">/* Generate scrambler */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_CTL_TX_ANT_SEL		0x00000008	</span><span class="cm">/* TX antenna select */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_CTL_TX_ANT_STATIC	0x00000010	</span><span class="cm">/* Static TX antenna */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_CTL_RX_ANT_SEL		0x00000020	</span><span class="cm">/* RX antenna select */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_CTL_RX_ANT_STATIC	0x00000040	</span><span class="cm">/* Static RX antenna */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_CTL_LOW_FREQ_SLE_EN	0x00000080	</span><span class="cm">/* Enable low freq sleep */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * PHY PAPD probe register [5111+]</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_PAPD_PROBE		0x9930</span>
<span class="cp">#define	AR5K_PHY_PAPD_PROBE_SH_HI_PAR	0x00000001</span>
<span class="cp">#define	AR5K_PHY_PAPD_PROBE_PCDAC_BIAS	0x00000002</span>
<span class="cp">#define	AR5K_PHY_PAPD_PROBE_COMP_GAIN	0x00000040</span>
<span class="cp">#define	AR5K_PHY_PAPD_PROBE_TXPOWER	0x00007e00</span>
<span class="cp">#define	AR5K_PHY_PAPD_PROBE_TXPOWER_S	9</span>
<span class="cp">#define	AR5K_PHY_PAPD_PROBE_TX_NEXT	0x00008000</span>
<span class="cp">#define	AR5K_PHY_PAPD_PROBE_PREDIST_EN	0x00010000</span>
<span class="cp">#define	AR5K_PHY_PAPD_PROBE_TYPE	0x01800000	</span><span class="cm">/* [5112+] */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_PAPD_PROBE_TYPE_S	23</span>
<span class="cp">#define	AR5K_PHY_PAPD_PROBE_TYPE_OFDM	0</span>
<span class="cp">#define	AR5K_PHY_PAPD_PROBE_TYPE_XR	1</span>
<span class="cp">#define	AR5K_PHY_PAPD_PROBE_TYPE_CCK	2</span>
<span class="cp">#define	AR5K_PHY_PAPD_PROBE_GAINF	0xfe000000</span>
<span class="cp">#define	AR5K_PHY_PAPD_PROBE_GAINF_S	25</span>
<span class="cp">#define	AR5K_PHY_PAPD_PROBE_INI_5111	0x00004883	</span><span class="cm">/* [5212+] */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_PAPD_PROBE_INI_5112	0x00004882	</span><span class="cm">/* [5212+] */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * PHY TX rate power registers [5112+]</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_TXPOWER_RATE1			0x9934</span>
<span class="cp">#define	AR5K_PHY_TXPOWER_RATE2			0x9938</span>
<span class="cp">#define	AR5K_PHY_TXPOWER_RATE_MAX		0x993c</span>
<span class="cp">#define	AR5K_PHY_TXPOWER_RATE_MAX_TPC_ENABLE	0x00000040</span>
<span class="cp">#define	AR5K_PHY_TXPOWER_RATE3			0xa234</span>
<span class="cp">#define	AR5K_PHY_TXPOWER_RATE4			0xa238</span>

<span class="cm">/*</span>
<span class="cm"> * PHY frame control register [5111+]</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_FRAME_CTL_5210		0x9804</span>
<span class="cp">#define	AR5K_PHY_FRAME_CTL_5211		0x9944</span>
<span class="cp">#define	AR5K_PHY_FRAME_CTL		(ah-&gt;ah_version == AR5K_AR5210 ? \</span>
<span class="cp">					AR5K_PHY_FRAME_CTL_5210 : AR5K_PHY_FRAME_CTL_5211)</span>
<span class="cm">/*---[5111+]---*/</span>
<span class="cp">#define	AR5K_PHY_FRAME_CTL_WIN_LEN	0x00000003	</span><span class="cm">/* Force window length (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_FRAME_CTL_WIN_LEN_S	0</span>
<span class="cp">#define	AR5K_PHY_FRAME_CTL_TX_CLIP	0x00000038	</span><span class="cm">/* Mask for tx clip (?) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_FRAME_CTL_TX_CLIP_S	3</span>
<span class="cp">#define	AR5K_PHY_FRAME_CTL_PREP_CHINFO	0x00010000	</span><span class="cm">/* Prepend chan info */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_FRAME_CTL_EMU		0x80000000</span>
<span class="cp">#define	AR5K_PHY_FRAME_CTL_EMU_S	31</span>
<span class="cm">/*---[5110/5111]---*/</span>
<span class="cp">#define	AR5K_PHY_FRAME_CTL_TIMING_ERR	0x01000000	</span><span class="cm">/* PHY timing error */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_FRAME_CTL_PARITY_ERR	0x02000000	</span><span class="cm">/* Parity error */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_FRAME_CTL_ILLRATE_ERR	0x04000000	</span><span class="cm">/* Illegal rate */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_FRAME_CTL_ILLLEN_ERR	0x08000000	</span><span class="cm">/* Illegal length */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_FRAME_CTL_SERVICE_ERR	0x20000000</span>
<span class="cp">#define	AR5K_PHY_FRAME_CTL_TXURN_ERR	0x40000000	</span><span class="cm">/* TX underrun */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_FRAME_CTL_INI	\</span>
<span class="cp">			(AR5K_PHY_FRAME_CTL_SERVICE_ERR | \</span>
<span class="cp">			 AR5K_PHY_FRAME_CTL_TXURN_ERR | \</span>
<span class="cp">			 AR5K_PHY_FRAME_CTL_ILLLEN_ERR | \</span>
<span class="cp">			 AR5K_PHY_FRAME_CTL_ILLRATE_ERR | \</span>
<span class="cp">			 AR5K_PHY_FRAME_CTL_PARITY_ERR | \</span>
<span class="cp">			 AR5K_PHY_FRAME_CTL_TIMING_ERR)</span>

<span class="cm">/*</span>
<span class="cm"> * PHY Tx Power adjustment register [5212A+]</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_TX_PWR_ADJ			0x994c</span>
<span class="cp">#define	AR5K_PHY_TX_PWR_ADJ_CCK_GAIN_DELTA	0x00000fc0</span>
<span class="cp">#define	AR5K_PHY_TX_PWR_ADJ_CCK_GAIN_DELTA_S	6</span>
<span class="cp">#define	AR5K_PHY_TX_PWR_ADJ_CCK_PCDAC_INDEX	0x00fc0000</span>
<span class="cp">#define	AR5K_PHY_TX_PWR_ADJ_CCK_PCDAC_INDEX_S	18</span>

<span class="cm">/*</span>
<span class="cm"> * PHY radar detection register [5111+]</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_RADAR			0x9954</span>
<span class="cp">#define	AR5K_PHY_RADAR_ENABLE		0x00000001</span>
<span class="cp">#define	AR5K_PHY_RADAR_DISABLE		0x00000000</span>
<span class="cp">#define AR5K_PHY_RADAR_INBANDTHR	0x0000003e	</span><span class="cm">/* Inband threshold</span>
<span class="cm">							5-bits, units unknown {0..31}</span>
<span class="cm">							(? MHz ?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_RADAR_INBANDTHR_S	1</span>

<span class="cp">#define AR5K_PHY_RADAR_PRSSI_THR	0x00000fc0	</span><span class="cm">/* Pulse RSSI/SNR threshold</span>
<span class="cm">							6-bits, dBm range {0..63}</span>
<span class="cm">							in dBm units. */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_RADAR_PRSSI_THR_S	6</span>

<span class="cp">#define AR5K_PHY_RADAR_PHEIGHT_THR	0x0003f000	</span><span class="cm">/* Pulse height threshold</span>
<span class="cm">							6-bits, dBm range {0..63}</span>
<span class="cm">							in dBm units. */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_RADAR_PHEIGHT_THR_S	12</span>

<span class="cp">#define AR5K_PHY_RADAR_RSSI_THR		0x00fc0000	</span><span class="cm">/* Radar RSSI/SNR threshold.</span>
<span class="cm">							6-bits, dBm range {0..63}</span>
<span class="cm">							in dBm units. */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_RADAR_RSSI_THR_S	18</span>

<span class="cp">#define AR5K_PHY_RADAR_FIRPWR_THR	0x7f000000	</span><span class="cm">/* Finite Impulse Response</span>
<span class="cm">							filter power out threshold.</span>
<span class="cm">							7-bits, standard power range</span>
<span class="cm">							{0..127} in 1/2 dBm units. */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_RADAR_FIRPWR_THRS	24</span>

<span class="cm">/*</span>
<span class="cm"> * PHY antenna switch table registers</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_PHY_ANT_SWITCH_TABLE_0	0x9960</span>
<span class="cp">#define AR5K_PHY_ANT_SWITCH_TABLE_1	0x9964</span>

<span class="cm">/*</span>
<span class="cm"> * PHY Noise floor threshold</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_PHY_NFTHRES		0x9968</span>

<span class="cm">/*</span>
<span class="cm"> * Sigma Delta register (?) [5213]</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_PHY_SIGMA_DELTA		0x996C</span>
<span class="cp">#define AR5K_PHY_SIGMA_DELTA_ADC_SEL	0x00000003</span>
<span class="cp">#define AR5K_PHY_SIGMA_DELTA_ADC_SEL_S	0</span>
<span class="cp">#define AR5K_PHY_SIGMA_DELTA_FILT2	0x000000f8</span>
<span class="cp">#define AR5K_PHY_SIGMA_DELTA_FILT2_S	3</span>
<span class="cp">#define AR5K_PHY_SIGMA_DELTA_FILT1	0x00001f00</span>
<span class="cp">#define AR5K_PHY_SIGMA_DELTA_FILT1_S	8</span>
<span class="cp">#define AR5K_PHY_SIGMA_DELTA_ADC_CLIP	0x01ffe000</span>
<span class="cp">#define AR5K_PHY_SIGMA_DELTA_ADC_CLIP_S	13</span>

<span class="cm">/*</span>
<span class="cm"> * RF restart register [5112+] (?)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_PHY_RESTART		0x9970		</span><span class="cm">/* restart */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_RESTART_DIV_GC		0x001c0000	</span><span class="cm">/* Fast diversity gc_limit (?) */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_RESTART_DIV_GC_S	18</span>

<span class="cm">/*</span>
<span class="cm"> * RF Bus access request register (for synth-only channel switching)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_PHY_RFBUS_REQ		0x997C</span>
<span class="cp">#define AR5K_PHY_RFBUS_REQ_REQUEST	0x00000001</span>

<span class="cm">/*</span>
<span class="cm"> * Spur mitigation masks (?)</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_PHY_TIMING_7		0x9980</span>
<span class="cp">#define AR5K_PHY_TIMING_8		0x9984</span>
<span class="cp">#define AR5K_PHY_TIMING_8_PILOT_MASK_2		0x000fffff</span>
<span class="cp">#define AR5K_PHY_TIMING_8_PILOT_MASK_2_S	0</span>

<span class="cp">#define AR5K_PHY_BIN_MASK2_1		0x9988</span>
<span class="cp">#define AR5K_PHY_BIN_MASK2_2		0x998c</span>
<span class="cp">#define AR5K_PHY_BIN_MASK2_3		0x9990</span>

<span class="cp">#define AR5K_PHY_BIN_MASK2_4		0x9994</span>
<span class="cp">#define AR5K_PHY_BIN_MASK2_4_MASK_4	0x00003fff</span>
<span class="cp">#define AR5K_PHY_BIN_MASK2_4_MASK_4_S	0</span>

<span class="cp">#define AR5K_PHY_TIMING_9			0x9998</span>
<span class="cp">#define AR5K_PHY_TIMING_10			0x999c</span>
<span class="cp">#define AR5K_PHY_TIMING_10_PILOT_MASK_2		0x000fffff</span>
<span class="cp">#define AR5K_PHY_TIMING_10_PILOT_MASK_2_S	0</span>

<span class="cm">/*</span>
<span class="cm"> * Spur mitigation control</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_PHY_TIMING_11			0x99a0		</span><span class="cm">/* Register address */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_TIMING_11_SPUR_DELTA_PHASE	0x000fffff	</span><span class="cm">/* Spur delta phase */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_TIMING_11_SPUR_DELTA_PHASE_S	0</span>
<span class="cp">#define AR5K_PHY_TIMING_11_SPUR_FREQ_SD		0x3ff00000	</span><span class="cm">/* Freq sigma delta */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_TIMING_11_SPUR_FREQ_SD_S	20</span>
<span class="cp">#define AR5K_PHY_TIMING_11_USE_SPUR_IN_AGC	0x40000000	</span><span class="cm">/* Spur filter in AGC detector */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_TIMING_11_USE_SPUR_IN_SELFCOR	0x80000000	</span><span class="cm">/* Spur filter in OFDM self correlator */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Gain tables</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_BB_GAIN_BASE		0x9b00	</span><span class="cm">/* BaseBand Amplifier Gain table base address */</span><span class="cp"></span>
<span class="cp">#define AR5K_BB_GAIN(_n)		(AR5K_BB_GAIN_BASE + ((_n) &lt;&lt; 2))</span>
<span class="cp">#define	AR5K_RF_GAIN_BASE		0x9a00	</span><span class="cm">/* RF Amplifier Gain table base address */</span><span class="cp"></span>
<span class="cp">#define AR5K_RF_GAIN(_n)		(AR5K_RF_GAIN_BASE + ((_n) &lt;&lt; 2))</span>

<span class="cm">/*</span>
<span class="cm"> * PHY timing IQ calibration result register [5111+]</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_IQRES_CAL_PWR_I	0x9c10	</span><span class="cm">/* I (Inphase) power value */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_IQRES_CAL_PWR_Q	0x9c14	</span><span class="cm">/* Q (Quadrature) power value */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_IQRES_CAL_CORR		0x9c18	</span><span class="cm">/* I/Q Correlation */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * PHY current RSSI register [5111+]</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_CURRENT_RSSI	0x9c1c</span>

<span class="cm">/*</span>
<span class="cm"> * PHY RF Bus grant register</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_RFBUS_GRANT	0x9c20</span>
<span class="cp">#define	AR5K_PHY_RFBUS_GRANT_OK	0x00000001</span>

<span class="cm">/*</span>
<span class="cm"> * PHY ADC test register</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_ADC_TEST	0x9c24</span>
<span class="cp">#define	AR5K_PHY_ADC_TEST_I	0x00000001</span>
<span class="cp">#define	AR5K_PHY_ADC_TEST_Q	0x00000200</span>

<span class="cm">/*</span>
<span class="cm"> * PHY DAC test register</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_DAC_TEST	0x9c28</span>
<span class="cp">#define	AR5K_PHY_DAC_TEST_I	0x00000001</span>
<span class="cp">#define	AR5K_PHY_DAC_TEST_Q	0x00000200</span>

<span class="cm">/*</span>
<span class="cm"> * PHY PTAT register (?)</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_PTAT		0x9c2c</span>

<span class="cm">/*</span>
<span class="cm"> * PHY Illegal TX rate register [5112+]</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_BAD_TX_RATE	0x9c30</span>

<span class="cm">/*</span>
<span class="cm"> * PHY SPUR Power register [5112+]</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_SPUR_PWR	0x9c34			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_SPUR_PWR_I	0x00000001	</span><span class="cm">/* SPUR Power estimate for I (field) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_SPUR_PWR_Q	0x00000100	</span><span class="cm">/* SPUR Power estimate for Q (field) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_SPUR_PWR_FILT	0x00010000	</span><span class="cm">/* Power with SPUR removed (field) */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * PHY Channel status register [5112+] (?)</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_CHAN_STATUS		0x9c38</span>
<span class="cp">#define	AR5K_PHY_CHAN_STATUS_BT_ACT	0x00000001</span>
<span class="cp">#define	AR5K_PHY_CHAN_STATUS_RX_CLR_RAW	0x00000002</span>
<span class="cp">#define	AR5K_PHY_CHAN_STATUS_RX_CLR_MAC	0x00000004</span>
<span class="cp">#define	AR5K_PHY_CHAN_STATUS_RX_CLR_PAP	0x00000008</span>

<span class="cm">/*</span>
<span class="cm"> * Heavy clip enable register</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_HEAVY_CLIP_ENABLE	0x99e0</span>

<span class="cm">/*</span>
<span class="cm"> * PHY clock sleep registers [5112+]</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_PHY_SCLOCK			0x99f0</span>
<span class="cp">#define AR5K_PHY_SCLOCK_32MHZ		0x0000000c</span>
<span class="cp">#define AR5K_PHY_SDELAY			0x99f4</span>
<span class="cp">#define AR5K_PHY_SDELAY_32MHZ		0x000000ff</span>
<span class="cp">#define AR5K_PHY_SPENDING		0x99f8</span>


<span class="cm">/*</span>
<span class="cm"> * PHY PAPD I (power?) table (?)</span>
<span class="cm"> * (92! entries)</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_PAPD_I_BASE	0xa000</span>
<span class="cp">#define	AR5K_PHY_PAPD_I(_n)	(AR5K_PHY_PAPD_I_BASE + ((_n) &lt;&lt; 2))</span>

<span class="cm">/*</span>
<span class="cm"> * PHY PCDAC TX power table</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_PCDAC_TXPOWER_BASE	0xa180</span>
<span class="cp">#define	AR5K_PHY_PCDAC_TXPOWER(_n)	(AR5K_PHY_PCDAC_TXPOWER_BASE + ((_n) &lt;&lt; 2))</span>

<span class="cm">/*</span>
<span class="cm"> * PHY mode register [5111+]</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_MODE			0x0a200			</span><span class="cm">/* Register Address */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_MODE_MOD		0x00000001	</span><span class="cm">/* PHY Modulation bit */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_MODE_MOD_OFDM		0</span>
<span class="cp">#define AR5K_PHY_MODE_MOD_CCK		1</span>
<span class="cp">#define AR5K_PHY_MODE_FREQ		0x00000002	</span><span class="cm">/* Freq mode bit */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_MODE_FREQ_5GHZ		0</span>
<span class="cp">#define	AR5K_PHY_MODE_FREQ_2GHZ		2</span>
<span class="cp">#define AR5K_PHY_MODE_MOD_DYN		0x00000004	</span><span class="cm">/* Enable Dynamic OFDM/CCK mode [5112+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_MODE_RAD		0x00000008	</span><span class="cm">/* [5212+] */</span><span class="cp"></span>
<span class="cp">#define AR5K_PHY_MODE_RAD_RF5111	0</span>
<span class="cp">#define AR5K_PHY_MODE_RAD_RF5112	8</span>
<span class="cp">#define AR5K_PHY_MODE_XR		0x00000010	</span><span class="cm">/* Enable XR mode [5112+] */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_MODE_HALF_RATE		0x00000020	</span><span class="cm">/* Enable Half rate (test) */</span><span class="cp"></span>
<span class="cp">#define	AR5K_PHY_MODE_QUARTER_RATE	0x00000040	</span><span class="cm">/* Enable Quarter rat (test) */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * PHY CCK transmit control register [5111+ (?)]</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_PHY_CCKTXCTL		0xa204</span>
<span class="cp">#define AR5K_PHY_CCKTXCTL_WORLD		0x00000000</span>
<span class="cp">#define AR5K_PHY_CCKTXCTL_JAPAN		0x00000010</span>
<span class="cp">#define	AR5K_PHY_CCKTXCTL_SCRAMBLER_DIS	0x00000001</span>
<span class="cp">#define	AR5K_PHY_CCKTXCTK_DAC_SCALE	0x00000004</span>

<span class="cm">/*</span>
<span class="cm"> * PHY CCK Cross-correlator Barker RSSI threshold register [5212+]</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_PHY_CCK_CROSSCORR			0xa208</span>
<span class="cp">#define AR5K_PHY_CCK_CROSSCORR_WEAK_SIG_THR	0x0000003f</span>
<span class="cp">#define AR5K_PHY_CCK_CROSSCORR_WEAK_SIG_THR_S	0</span>

<span class="cm">/* Same address is used for antenna diversity activation */</span>
<span class="cp">#define	AR5K_PHY_FAST_ANT_DIV		0xa208</span>
<span class="cp">#define	AR5K_PHY_FAST_ANT_DIV_EN	0x00002000</span>

<span class="cm">/*</span>
<span class="cm"> * PHY 2GHz gain register [5111+]</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_GAIN_2GHZ			0xa20c</span>
<span class="cp">#define	AR5K_PHY_GAIN_2GHZ_MARGIN_TXRX		0x00fc0000</span>
<span class="cp">#define	AR5K_PHY_GAIN_2GHZ_MARGIN_TXRX_S	18</span>
<span class="cp">#define	AR5K_PHY_GAIN_2GHZ_INI_5111		0x6480416c</span>

<span class="cp">#define	AR5K_PHY_CCK_RX_CTL_4			0xa21c</span>
<span class="cp">#define	AR5K_PHY_CCK_RX_CTL_4_FREQ_EST_SHORT	0x01f80000</span>
<span class="cp">#define	AR5K_PHY_CCK_RX_CTL_4_FREQ_EST_SHORT_S	19</span>

<span class="cp">#define	AR5K_PHY_DAG_CCK_CTL			0xa228</span>
<span class="cp">#define	AR5K_PHY_DAG_CCK_CTL_EN_RSSI_THR	0x00000200</span>
<span class="cp">#define	AR5K_PHY_DAG_CCK_CTL_RSSI_THR		0x0001fc00</span>
<span class="cp">#define	AR5K_PHY_DAG_CCK_CTL_RSSI_THR_S		10</span>

<span class="cp">#define	AR5K_PHY_FAST_ADC	0xa24c</span>

<span class="cp">#define	AR5K_PHY_BLUETOOTH	0xa254</span>

<span class="cm">/*</span>
<span class="cm"> * Transmit Power Control register</span>
<span class="cm"> * [2413+]</span>
<span class="cm"> */</span>
<span class="cp">#define	AR5K_PHY_TPC_RG1		0xa258</span>
<span class="cp">#define	AR5K_PHY_TPC_RG1_NUM_PD_GAIN	0x0000c000</span>
<span class="cp">#define	AR5K_PHY_TPC_RG1_NUM_PD_GAIN_S	14</span>
<span class="cp">#define AR5K_PHY_TPC_RG1_PDGAIN_1	0x00030000</span>
<span class="cp">#define AR5K_PHY_TPC_RG1_PDGAIN_1_S	16</span>
<span class="cp">#define AR5K_PHY_TPC_RG1_PDGAIN_2	0x000c0000</span>
<span class="cp">#define AR5K_PHY_TPC_RG1_PDGAIN_2_S	18</span>
<span class="cp">#define AR5K_PHY_TPC_RG1_PDGAIN_3	0x00300000</span>
<span class="cp">#define AR5K_PHY_TPC_RG1_PDGAIN_3_S	20</span>

<span class="cp">#define	AR5K_PHY_TPC_RG5			0xa26C</span>
<span class="cp">#define	AR5K_PHY_TPC_RG5_PD_GAIN_OVERLAP	0x0000000F</span>
<span class="cp">#define	AR5K_PHY_TPC_RG5_PD_GAIN_OVERLAP_S	0</span>
<span class="cp">#define	AR5K_PHY_TPC_RG5_PD_GAIN_BOUNDARY_1	0x000003F0</span>
<span class="cp">#define	AR5K_PHY_TPC_RG5_PD_GAIN_BOUNDARY_1_S	4</span>
<span class="cp">#define	AR5K_PHY_TPC_RG5_PD_GAIN_BOUNDARY_2	0x0000FC00</span>
<span class="cp">#define	AR5K_PHY_TPC_RG5_PD_GAIN_BOUNDARY_2_S	10</span>
<span class="cp">#define	AR5K_PHY_TPC_RG5_PD_GAIN_BOUNDARY_3	0x003F0000</span>
<span class="cp">#define	AR5K_PHY_TPC_RG5_PD_GAIN_BOUNDARY_3_S	16</span>
<span class="cp">#define	AR5K_PHY_TPC_RG5_PD_GAIN_BOUNDARY_4	0x0FC00000</span>
<span class="cp">#define	AR5K_PHY_TPC_RG5_PD_GAIN_BOUNDARY_4_S	22</span>

<span class="cm">/*</span>
<span class="cm"> * PHY PDADC Tx power table</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_PHY_PDADC_TXPOWER_BASE	0xa280</span>
<span class="cp">#define	AR5K_PHY_PDADC_TXPOWER(_n)	(AR5K_PHY_PDADC_TXPOWER_BASE + ((_n) &lt;&lt; 2))</span>

<span class="cm">/*</span>
<span class="cm"> * Platform registers for WiSoC</span>
<span class="cm"> */</span>
<span class="cp">#define AR5K_AR5312_RESET		0xbc003020</span>
<span class="cp">#define AR5K_AR5312_RESET_BB0_COLD	0x00000004</span>
<span class="cp">#define AR5K_AR5312_RESET_BB1_COLD	0x00000200</span>
<span class="cp">#define AR5K_AR5312_RESET_WMAC0		0x00002000</span>
<span class="cp">#define AR5K_AR5312_RESET_BB0_WARM	0x00004000</span>
<span class="cp">#define AR5K_AR5312_RESET_WMAC1		0x00020000</span>
<span class="cp">#define AR5K_AR5312_RESET_BB1_WARM	0x00040000</span>

<span class="cp">#define AR5K_AR5312_ENABLE		0xbc003080</span>
<span class="cp">#define AR5K_AR5312_ENABLE_WLAN0    0x00000001</span>
<span class="cp">#define AR5K_AR5312_ENABLE_WLAN1    0x00000008</span>

<span class="cp">#define AR5K_AR2315_RESET		0xb1000004</span>
<span class="cp">#define AR5K_AR2315_RESET_WMAC		0x00000001</span>
<span class="cp">#define AR5K_AR2315_RESET_BB_WARM	0x00000002</span>

<span class="cp">#define AR5K_AR2315_AHB_ARB_CTL		0xb1000008</span>
<span class="cp">#define AR5K_AR2315_AHB_ARB_CTL_WLAN	0x00000002</span>

<span class="cp">#define AR5K_AR2315_BYTESWAP	0xb100000c</span>
<span class="cp">#define AR5K_AR2315_BYTESWAP_WMAC	0x00000002</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
