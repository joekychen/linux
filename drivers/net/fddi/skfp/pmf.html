<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › net › fddi › skfp › pmf.c

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>pmf.c</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/******************************************************************************</span>
<span class="cm"> *</span>
<span class="cm"> *	(C)Copyright 1998,1999 SysKonnect,</span>
<span class="cm"> *	a business unit of Schneider &amp; Koch &amp; Co. Datensysteme GmbH.</span>
<span class="cm"> *</span>
<span class="cm"> *	See the file &quot;skfddi.c&quot; for further information.</span>
<span class="cm"> *</span>
<span class="cm"> *	This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> *	it under the terms of the GNU General Public License as published by</span>
<span class="cm"> *	the Free Software Foundation; either version 2 of the License, or</span>
<span class="cm"> *	(at your option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> *	The information in this file is provided &quot;AS IS&quot; without warranty.</span>
<span class="cm"> *</span>
<span class="cm"> ******************************************************************************/</span>

<span class="cm">/*</span>
<span class="cm">	Parameter Management Frame processing for SMT 7.2</span>
<span class="cm">*/</span>

<span class="cp">#include &quot;h/types.h&quot;</span>
<span class="cp">#include &quot;h/fddi.h&quot;</span>
<span class="cp">#include &quot;h/smc.h&quot;</span>
<span class="cp">#include &quot;h/smt_p.h&quot;</span>

<span class="cp">#define KERNEL</span>
<span class="cp">#include &quot;h/smtstate.h&quot;</span>

<span class="cp">#ifndef	SLIM_SMT</span>

<span class="cp">#ifndef	lint</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="n">ID_sccs</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&quot;@(#)pmf.c	1.37 97/08/04 (C) SK &quot;</span> <span class="p">;</span>
<span class="cp">#endif</span>

<span class="k">static</span> <span class="kt">int</span> <span class="n">smt_authorize</span><span class="p">(</span><span class="k">struct</span> <span class="n">s_smc</span> <span class="o">*</span><span class="n">smc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">smt_header</span> <span class="o">*</span><span class="n">sm</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">smt_check_set_count</span><span class="p">(</span><span class="k">struct</span> <span class="n">s_smc</span> <span class="o">*</span><span class="n">smc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">smt_header</span> <span class="o">*</span><span class="n">sm</span><span class="p">);</span>
<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">s_p_tab</span><span class="o">*</span> <span class="n">smt_get_ptab</span><span class="p">(</span><span class="n">u_short</span> <span class="n">para</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">smt_mib_phys</span><span class="p">(</span><span class="k">struct</span> <span class="n">s_smc</span> <span class="o">*</span><span class="n">smc</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">smt_set_para</span><span class="p">(</span><span class="k">struct</span> <span class="n">s_smc</span> <span class="o">*</span><span class="n">smc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">smt_para</span> <span class="o">*</span><span class="n">pa</span><span class="p">,</span> <span class="kt">int</span> <span class="n">index</span><span class="p">,</span>
			<span class="kt">int</span> <span class="n">local</span><span class="p">,</span> <span class="kt">int</span> <span class="n">set</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">smt_add_para</span><span class="p">(</span><span class="k">struct</span> <span class="n">s_smc</span> <span class="o">*</span><span class="n">smc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">s_pcon</span> <span class="o">*</span><span class="n">pcon</span><span class="p">,</span> <span class="n">u_short</span> <span class="n">para</span><span class="p">,</span>
		  <span class="kt">int</span> <span class="n">index</span><span class="p">,</span> <span class="kt">int</span> <span class="n">local</span><span class="p">);</span>
<span class="k">static</span> <span class="n">SMbuf</span> <span class="o">*</span><span class="n">smt_build_pmf_response</span><span class="p">(</span><span class="k">struct</span> <span class="n">s_smc</span> <span class="o">*</span><span class="n">smc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">smt_header</span> <span class="o">*</span><span class="n">req</span><span class="p">,</span>
				     <span class="kt">int</span> <span class="n">set</span><span class="p">,</span> <span class="kt">int</span> <span class="n">local</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">port_to_mib</span><span class="p">(</span><span class="k">struct</span> <span class="n">s_smc</span> <span class="o">*</span><span class="n">smc</span><span class="p">,</span> <span class="kt">int</span> <span class="n">p</span><span class="p">);</span>

<span class="cp">#define MOFFSS(e)	offsetof(struct fddi_mib, e)</span>
<span class="cp">#define MOFFMS(e)	offsetof(struct fddi_mib_m, e)</span>
<span class="cp">#define MOFFAS(e)	offsetof(struct fddi_mib_a, e)</span>
<span class="cp">#define MOFFPS(e)	offsetof(struct fddi_mib_p, e)</span>


<span class="cp">#define AC_G	0x01		</span><span class="cm">/* Get */</span><span class="cp"></span>
<span class="cp">#define AC_GR	0x02		</span><span class="cm">/* Get/Set */</span><span class="cp"></span>
<span class="cp">#define AC_S	0x04		</span><span class="cm">/* Set */</span><span class="cp"></span>
<span class="cp">#define AC_NA	0x08</span>
<span class="cp">#define AC_GROUP	0x10		</span><span class="cm">/* Group */</span><span class="cp"></span>
<span class="cp">#define MS2BCLK(x)	((x)*12500L)</span>
<span class="cm">/*</span>
<span class="cm">	F	LFag (byte)</span>
<span class="cm">	B	byte</span>
<span class="cm">	S	u_short	16 bit</span>
<span class="cm">	C	Counter 32 bit</span>
<span class="cm">	L	Long 32 bit</span>
<span class="cm">	T	Timer_2	32 bit</span>
<span class="cm">	P	TimeStamp ;</span>
<span class="cm">	A	LongAddress (6 byte)</span>
<span class="cm">	E	Enum 16 bit</span>
<span class="cm">	R	ResId 16 Bit</span>
<span class="cm">*/</span>
<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">s_p_tab</span> <span class="p">{</span>
	<span class="n">u_short</span>	<span class="n">p_num</span> <span class="p">;</span>		<span class="cm">/* parameter code */</span>
	<span class="n">u_char</span>	<span class="n">p_access</span> <span class="p">;</span>	<span class="cm">/* access rights */</span>
	<span class="n">u_short</span>	<span class="n">p_offset</span> <span class="p">;</span>	<span class="cm">/* offset in mib */</span>
	<span class="kt">char</span>	<span class="n">p_swap</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">;</span>	<span class="cm">/* format string */</span>
<span class="p">}</span> <span class="n">p_tab</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* StationIdGrp */</span>
	<span class="p">{</span> <span class="n">SMT_P100A</span><span class="p">,</span><span class="n">AC_GROUP</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P100B</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTStationId</span><span class="p">),</span>	<span class="s">&quot;8&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P100D</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTOpVersionId</span><span class="p">),</span>	<span class="s">&quot;S&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P100E</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTHiVersionId</span><span class="p">),</span>	<span class="s">&quot;S&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P100F</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTLoVersionId</span><span class="p">),</span>	<span class="s">&quot;S&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P1010</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTManufacturerData</span><span class="p">),</span> <span class="s">&quot;D&quot;</span> <span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P1011</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTUserData</span><span class="p">),</span>	<span class="s">&quot;D&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P1012</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTMIBVersionId</span><span class="p">),</span>	<span class="s">&quot;S&quot;</span>	<span class="p">}</span> <span class="p">,</span>

	<span class="cm">/* StationConfigGrp */</span>
	<span class="p">{</span> <span class="n">SMT_P1014</span><span class="p">,</span><span class="n">AC_GROUP</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P1015</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTMac_Ct</span><span class="p">),</span>		<span class="s">&quot;B&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P1016</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTNonMaster_Ct</span><span class="p">),</span>	<span class="s">&quot;B&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P1017</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTMaster_Ct</span><span class="p">),</span>	<span class="s">&quot;B&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P1018</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTAvailablePaths</span><span class="p">),</span>	<span class="s">&quot;B&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P1019</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTConfigCapabilities</span><span class="p">),</span><span class="s">&quot;S&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P101A</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTConfigPolicy</span><span class="p">),</span>	<span class="s">&quot;wS&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P101B</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTConnectionPolicy</span><span class="p">),</span><span class="s">&quot;wS&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P101D</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTTT_Notify</span><span class="p">),</span>	<span class="s">&quot;wS&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P101E</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTStatRptPolicy</span><span class="p">),</span>	<span class="s">&quot;bB&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P101F</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTTrace_MaxExpiration</span><span class="p">),</span><span class="s">&quot;lL&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P1020</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTPORTIndexes</span><span class="p">),</span>	<span class="s">&quot;II&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P1021</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTMACIndexes</span><span class="p">),</span>	<span class="s">&quot;I&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P1022</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTBypassPresent</span><span class="p">),</span>	<span class="s">&quot;F&quot;</span>	<span class="p">}</span> <span class="p">,</span>

	<span class="cm">/* StatusGrp */</span>
	<span class="p">{</span> <span class="n">SMT_P1028</span><span class="p">,</span><span class="n">AC_GROUP</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P1029</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTECMState</span><span class="p">),</span>	<span class="s">&quot;E&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P102A</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTCF_State</span><span class="p">),</span>	<span class="s">&quot;E&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P102C</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTRemoteDisconnectFlag</span><span class="p">),</span><span class="s">&quot;F&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P102D</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTStationStatus</span><span class="p">),</span>	<span class="s">&quot;E&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P102E</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTPeerWrapFlag</span><span class="p">),</span>	<span class="s">&quot;F&quot;</span>	<span class="p">}</span> <span class="p">,</span>

	<span class="cm">/* MIBOperationGrp */</span>
	<span class="p">{</span> <span class="n">SMT_P1032</span><span class="p">,</span><span class="n">AC_GROUP</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P1033</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTTimeStamp</span><span class="p">),</span><span class="s">&quot;P&quot;</span>		<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P1034</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTTransitionTimeStamp</span><span class="p">),</span><span class="s">&quot;P&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="cm">/* NOTE : SMT_P1035 is already swapped ! SMT_P_SETCOUNT */</span>
	<span class="p">{</span> <span class="n">SMT_P1035</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTSetCount</span><span class="p">),</span><span class="s">&quot;4P&quot;</span>		<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P1036</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSMTLastSetStationId</span><span class="p">),</span><span class="s">&quot;8&quot;</span>	<span class="p">}</span> <span class="p">,</span>

	<span class="p">{</span> <span class="n">SMT_P103C</span><span class="p">,</span><span class="n">AC_S</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>				<span class="s">&quot;wS&quot;</span>	<span class="p">}</span> <span class="p">,</span>

	<span class="cm">/*</span>
<span class="cm">	 * PRIVATE EXTENSIONS</span>
<span class="cm">	 * only accessible locally to get/set passwd</span>
<span class="cm">	 */</span>
	<span class="p">{</span> <span class="n">SMT_P10F0</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiPRPMFPasswd</span><span class="p">),</span>	<span class="s">&quot;8&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P10F1</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiPRPMFStation</span><span class="p">),</span>	<span class="s">&quot;8&quot;</span>	<span class="p">}</span> <span class="p">,</span>
<span class="cp">#ifdef	ESS</span>
	<span class="p">{</span> <span class="n">SMT_P10F2</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiESSPayload</span><span class="p">),</span>		<span class="s">&quot;lL&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P10F3</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiESSOverhead</span><span class="p">),</span>	<span class="s">&quot;lL&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P10F4</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiESSMaxTNeg</span><span class="p">),</span>		<span class="s">&quot;lL&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P10F5</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiESSMinSegmentSize</span><span class="p">),</span>	<span class="s">&quot;lL&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P10F6</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiESSCategory</span><span class="p">),</span>	<span class="s">&quot;lL&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P10F7</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiESSSynchTxMode</span><span class="p">),</span>	<span class="s">&quot;wS&quot;</span>	<span class="p">}</span> <span class="p">,</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef	SBA</span>
	<span class="p">{</span> <span class="n">SMT_P10F8</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSBACommand</span><span class="p">),</span>		<span class="s">&quot;bF&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P10F9</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFSS</span><span class="p">(</span><span class="n">fddiSBAAvailable</span><span class="p">),</span>	<span class="s">&quot;bF&quot;</span>	<span class="p">}</span> <span class="p">,</span>
<span class="cp">#endif</span>
	<span class="cm">/* MAC Attributes */</span>
	<span class="p">{</span> <span class="n">SMT_P200A</span><span class="p">,</span><span class="n">AC_GROUP</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P200B</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACFrameStatusFunctions</span><span class="p">),</span><span class="s">&quot;S&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P200D</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACT_MaxCapabilitiy</span><span class="p">),</span><span class="s">&quot;T&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P200E</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACTVXCapabilitiy</span><span class="p">),</span><span class="s">&quot;T&quot;</span>	<span class="p">}</span> <span class="p">,</span>

	<span class="cm">/* ConfigGrp */</span>
	<span class="p">{</span> <span class="n">SMT_P2014</span><span class="p">,</span><span class="n">AC_GROUP</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2016</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACAvailablePaths</span><span class="p">),</span>	<span class="s">&quot;B&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2017</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACCurrentPath</span><span class="p">),</span>	<span class="s">&quot;S&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2018</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACUpstreamNbr</span><span class="p">),</span>	<span class="s">&quot;A&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2019</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACDownstreamNbr</span><span class="p">),</span>	<span class="s">&quot;A&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P201A</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACOldUpstreamNbr</span><span class="p">),</span>	<span class="s">&quot;A&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P201B</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACOldDownstreamNbr</span><span class="p">),</span><span class="s">&quot;A&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P201D</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACDupAddressTest</span><span class="p">),</span>	<span class="s">&quot;E&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2020</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACRequestedPaths</span><span class="p">),</span>	<span class="s">&quot;wS&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2021</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACDownstreamPORTType</span><span class="p">),</span><span class="s">&quot;E&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2022</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACIndex</span><span class="p">),</span>		<span class="s">&quot;S&quot;</span>	<span class="p">}</span> <span class="p">,</span>

	<span class="cm">/* AddressGrp */</span>
	<span class="p">{</span> <span class="n">SMT_P2028</span><span class="p">,</span><span class="n">AC_GROUP</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2029</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACSMTAddress</span><span class="p">),</span>	<span class="s">&quot;A&quot;</span>	<span class="p">}</span> <span class="p">,</span>

	<span class="cm">/* OperationGrp */</span>
	<span class="p">{</span> <span class="n">SMT_P2032</span><span class="p">,</span><span class="n">AC_GROUP</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2033</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACT_Req</span><span class="p">),</span>		<span class="s">&quot;T&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2034</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACT_Neg</span><span class="p">),</span>		<span class="s">&quot;T&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2035</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACT_Max</span><span class="p">),</span>		<span class="s">&quot;T&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2036</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACTvxValue</span><span class="p">),</span>	<span class="s">&quot;T&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2038</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACT_Pri0</span><span class="p">),</span>		<span class="s">&quot;T&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2039</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACT_Pri1</span><span class="p">),</span>		<span class="s">&quot;T&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P203A</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACT_Pri2</span><span class="p">),</span>		<span class="s">&quot;T&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P203B</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACT_Pri3</span><span class="p">),</span>		<span class="s">&quot;T&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P203C</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACT_Pri4</span><span class="p">),</span>		<span class="s">&quot;T&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P203D</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACT_Pri5</span><span class="p">),</span>		<span class="s">&quot;T&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P203E</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACT_Pri6</span><span class="p">),</span>		<span class="s">&quot;T&quot;</span>	<span class="p">}</span> <span class="p">,</span>


	<span class="cm">/* CountersGrp */</span>
	<span class="p">{</span> <span class="n">SMT_P2046</span><span class="p">,</span><span class="n">AC_GROUP</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2047</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACFrame_Ct</span><span class="p">),</span>	<span class="s">&quot;C&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2048</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACCopied_Ct</span><span class="p">),</span>	<span class="s">&quot;C&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2049</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACTransmit_Ct</span><span class="p">),</span>	<span class="s">&quot;C&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P204A</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACToken_Ct</span><span class="p">),</span>	<span class="s">&quot;C&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2051</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACError_Ct</span><span class="p">),</span>	<span class="s">&quot;C&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2052</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACLost_Ct</span><span class="p">),</span>		<span class="s">&quot;C&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2053</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACTvxExpired_Ct</span><span class="p">),</span>	<span class="s">&quot;C&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2054</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACNotCopied_Ct</span><span class="p">),</span>	<span class="s">&quot;C&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2056</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACRingOp_Ct</span><span class="p">),</span>	<span class="s">&quot;C&quot;</span>	<span class="p">}</span> <span class="p">,</span>

	<span class="cm">/* FrameErrorConditionGrp */</span>
	<span class="p">{</span> <span class="n">SMT_P205A</span><span class="p">,</span><span class="n">AC_GROUP</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P205F</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACFrameErrorThreshold</span><span class="p">),</span><span class="s">&quot;wS&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2060</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACFrameErrorRatio</span><span class="p">),</span>	<span class="s">&quot;S&quot;</span>	<span class="p">}</span> <span class="p">,</span>

	<span class="cm">/* NotCopiedConditionGrp */</span>
	<span class="p">{</span> <span class="n">SMT_P2064</span><span class="p">,</span><span class="n">AC_GROUP</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2067</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACNotCopiedThreshold</span><span class="p">),</span><span class="s">&quot;wS&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2069</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACNotCopiedRatio</span><span class="p">),</span>	<span class="s">&quot;S&quot;</span>	<span class="p">}</span> <span class="p">,</span>

	<span class="cm">/* StatusGrp */</span>
	<span class="p">{</span> <span class="n">SMT_P206E</span><span class="p">,</span><span class="n">AC_GROUP</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P206F</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACRMTState</span><span class="p">),</span>	<span class="s">&quot;S&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2070</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACDA_Flag</span><span class="p">),</span>	<span class="s">&quot;F&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2071</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACUNDA_Flag</span><span class="p">),</span>	<span class="s">&quot;F&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2072</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACFrameErrorFlag</span><span class="p">),</span>	<span class="s">&quot;F&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2073</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACNotCopiedFlag</span><span class="p">),</span>	<span class="s">&quot;F&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2074</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACMA_UnitdataAvailable</span><span class="p">),</span><span class="s">&quot;F&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2075</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACHardwarePresent</span><span class="p">),</span>	<span class="s">&quot;F&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P2076</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACMA_UnitdataEnable</span><span class="p">),</span><span class="s">&quot;bF&quot;</span>	<span class="p">}</span> <span class="p">,</span>

	<span class="cm">/*</span>
<span class="cm">	 * PRIVATE EXTENSIONS</span>
<span class="cm">	 * only accessible locally to get/set TMIN</span>
<span class="cm">	 */</span>
	<span class="p">{</span> <span class="n">SMT_P20F0</span><span class="p">,</span><span class="n">AC_NA</span>						<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P20F1</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFMS</span><span class="p">(</span><span class="n">fddiMACT_Min</span><span class="p">),</span>		<span class="s">&quot;lT&quot;</span>	<span class="p">}</span> <span class="p">,</span>

	<span class="cm">/* Path Attributes */</span>
	<span class="cm">/*</span>
<span class="cm">	 * DON&#39;t swap 320B,320F,3210: they are already swapped in swap_para()</span>
<span class="cm">	 */</span>
	<span class="p">{</span> <span class="n">SMT_P320A</span><span class="p">,</span><span class="n">AC_GROUP</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P320B</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFAS</span><span class="p">(</span><span class="n">fddiPATHIndex</span><span class="p">),</span>		<span class="s">&quot;r&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P320F</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFAS</span><span class="p">(</span><span class="n">fddiPATHSbaPayload</span><span class="p">),</span>	<span class="s">&quot;l4&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P3210</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFAS</span><span class="p">(</span><span class="n">fddiPATHSbaOverhead</span><span class="p">),</span>	<span class="s">&quot;l4&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="cm">/* fddiPATHConfiguration */</span>
	<span class="p">{</span> <span class="n">SMT_P3212</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>				<span class="s">&quot;&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P3213</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFAS</span><span class="p">(</span><span class="n">fddiPATHT_Rmode</span><span class="p">),</span>	<span class="s">&quot;lT&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P3214</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFAS</span><span class="p">(</span><span class="n">fddiPATHSbaAvailable</span><span class="p">),</span>	<span class="s">&quot;lL&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P3215</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFAS</span><span class="p">(</span><span class="n">fddiPATHTVXLowerBound</span><span class="p">),</span>	<span class="s">&quot;lT&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P3216</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFAS</span><span class="p">(</span><span class="n">fddiPATHT_MaxLowerBound</span><span class="p">),</span><span class="s">&quot;lT&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P3217</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFAS</span><span class="p">(</span><span class="n">fddiPATHMaxT_Req</span><span class="p">),</span>	<span class="s">&quot;lT&quot;</span>	<span class="p">}</span> <span class="p">,</span>

	<span class="cm">/* Port Attributes */</span>
	<span class="cm">/* ConfigGrp */</span>
	<span class="p">{</span> <span class="n">SMT_P400A</span><span class="p">,</span><span class="n">AC_GROUP</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P400C</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFPS</span><span class="p">(</span><span class="n">fddiPORTMy_Type</span><span class="p">),</span>	<span class="s">&quot;E&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P400D</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFPS</span><span class="p">(</span><span class="n">fddiPORTNeighborType</span><span class="p">),</span>	<span class="s">&quot;E&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P400E</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFPS</span><span class="p">(</span><span class="n">fddiPORTConnectionPolicies</span><span class="p">),</span><span class="s">&quot;bB&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P400F</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFPS</span><span class="p">(</span><span class="n">fddiPORTMacIndicated</span><span class="p">),</span>	<span class="s">&quot;2&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P4010</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFPS</span><span class="p">(</span><span class="n">fddiPORTCurrentPath</span><span class="p">),</span>	<span class="s">&quot;E&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P4011</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFPS</span><span class="p">(</span><span class="n">fddiPORTRequestedPaths</span><span class="p">),</span>	<span class="s">&quot;l4&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P4012</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFPS</span><span class="p">(</span><span class="n">fddiPORTMACPlacement</span><span class="p">),</span>	<span class="s">&quot;S&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P4013</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFPS</span><span class="p">(</span><span class="n">fddiPORTAvailablePaths</span><span class="p">),</span>	<span class="s">&quot;B&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P4016</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFPS</span><span class="p">(</span><span class="n">fddiPORTPMDClass</span><span class="p">),</span>	<span class="s">&quot;E&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P4017</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFPS</span><span class="p">(</span><span class="n">fddiPORTConnectionCapabilities</span><span class="p">),</span>	<span class="s">&quot;B&quot;</span><span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P401D</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFPS</span><span class="p">(</span><span class="n">fddiPORTIndex</span><span class="p">),</span>		<span class="s">&quot;R&quot;</span>	<span class="p">}</span> <span class="p">,</span>

	<span class="cm">/* OperationGrp */</span>
	<span class="p">{</span> <span class="n">SMT_P401E</span><span class="p">,</span><span class="n">AC_GROUP</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P401F</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFPS</span><span class="p">(</span><span class="n">fddiPORTMaint_LS</span><span class="p">),</span>	<span class="s">&quot;wE&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P4021</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFPS</span><span class="p">(</span><span class="n">fddiPORTBS_Flag</span><span class="p">),</span>	<span class="s">&quot;F&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P4022</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFPS</span><span class="p">(</span><span class="n">fddiPORTPC_LS</span><span class="p">),</span>		<span class="s">&quot;E&quot;</span>	<span class="p">}</span> <span class="p">,</span>

	<span class="cm">/* ErrorCtrsGrp */</span>
	<span class="p">{</span> <span class="n">SMT_P4028</span><span class="p">,</span><span class="n">AC_GROUP</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P4029</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFPS</span><span class="p">(</span><span class="n">fddiPORTEBError_Ct</span><span class="p">),</span>	<span class="s">&quot;C&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P402A</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFPS</span><span class="p">(</span><span class="n">fddiPORTLCTFail_Ct</span><span class="p">),</span>	<span class="s">&quot;C&quot;</span>	<span class="p">}</span> <span class="p">,</span>

	<span class="cm">/* LerGrp */</span>
	<span class="p">{</span> <span class="n">SMT_P4032</span><span class="p">,</span><span class="n">AC_GROUP</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P4033</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFPS</span><span class="p">(</span><span class="n">fddiPORTLer_Estimate</span><span class="p">),</span>	<span class="s">&quot;F&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P4034</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFPS</span><span class="p">(</span><span class="n">fddiPORTLem_Reject_Ct</span><span class="p">),</span>	<span class="s">&quot;C&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P4035</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFPS</span><span class="p">(</span><span class="n">fddiPORTLem_Ct</span><span class="p">),</span>		<span class="s">&quot;C&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P403A</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFPS</span><span class="p">(</span><span class="n">fddiPORTLer_Cutoff</span><span class="p">),</span>	<span class="s">&quot;bB&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P403B</span><span class="p">,</span><span class="n">AC_GR</span><span class="p">,</span>	<span class="n">MOFFPS</span><span class="p">(</span><span class="n">fddiPORTLer_Alarm</span><span class="p">),</span>	<span class="s">&quot;bB&quot;</span>	<span class="p">}</span> <span class="p">,</span>

	<span class="cm">/* StatusGrp */</span>
	<span class="p">{</span> <span class="n">SMT_P403C</span><span class="p">,</span><span class="n">AC_GROUP</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P403D</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFPS</span><span class="p">(</span><span class="n">fddiPORTConnectState</span><span class="p">),</span>	<span class="s">&quot;E&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P403E</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFPS</span><span class="p">(</span><span class="n">fddiPORTPCMStateX</span><span class="p">),</span>	<span class="s">&quot;E&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P403F</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFPS</span><span class="p">(</span><span class="n">fddiPORTPC_Withhold</span><span class="p">),</span>	<span class="s">&quot;E&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P4040</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFPS</span><span class="p">(</span><span class="n">fddiPORTLerFlag</span><span class="p">),</span>	<span class="s">&quot;F&quot;</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="n">SMT_P4041</span><span class="p">,</span><span class="n">AC_G</span><span class="p">,</span>	<span class="n">MOFFPS</span><span class="p">(</span><span class="n">fddiPORTHardwarePresent</span><span class="p">),</span><span class="s">&quot;F&quot;</span>	<span class="p">}</span> <span class="p">,</span>

	<span class="p">{</span> <span class="n">SMT_P4046</span><span class="p">,</span><span class="n">AC_S</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>				<span class="s">&quot;wS&quot;</span>	<span class="p">}</span> <span class="p">,</span>

	<span class="p">{</span> <span class="mi">0</span><span class="p">,</span>	<span class="n">AC_GROUP</span>	<span class="p">}</span> <span class="p">,</span>
	<span class="p">{</span> <span class="mi">0</span> <span class="p">}</span>
<span class="p">}</span> <span class="p">;</span>

<span class="kt">void</span> <span class="nf">smt_pmf_received_pack</span><span class="p">(</span><span class="k">struct</span> <span class="n">s_smc</span> <span class="o">*</span><span class="n">smc</span><span class="p">,</span> <span class="n">SMbuf</span> <span class="o">*</span><span class="n">mb</span><span class="p">,</span> <span class="kt">int</span> <span class="n">local</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">smt_header</span>	<span class="o">*</span><span class="n">sm</span> <span class="p">;</span>
	<span class="n">SMbuf</span>		<span class="o">*</span><span class="n">reply</span> <span class="p">;</span>

	<span class="n">sm</span> <span class="o">=</span> <span class="n">smtod</span><span class="p">(</span><span class="n">mb</span><span class="p">,</span><span class="k">struct</span> <span class="n">smt_header</span> <span class="o">*</span><span class="p">)</span> <span class="p">;</span>
	<span class="n">DB_SMT</span><span class="p">(</span><span class="s">&quot;SMT: processing PMF frame at %x len %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">sm</span><span class="p">,</span><span class="n">mb</span><span class="o">-&gt;</span><span class="n">sm_len</span><span class="p">)</span> <span class="p">;</span>
<span class="cp">#ifdef	DEBUG</span>
	<span class="n">dump_smt</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="n">sm</span><span class="p">,</span><span class="s">&quot;PMF Received&quot;</span><span class="p">)</span> <span class="p">;</span>
<span class="cp">#endif</span>
	<span class="cm">/*</span>
<span class="cm">	 * Start the watchdog: It may be a long, long packet and</span>
<span class="cm">	 * maybe the watchdog occurs ...</span>
<span class="cm">	 */</span>
	<span class="n">smt_start_watchdog</span><span class="p">(</span><span class="n">smc</span><span class="p">)</span> <span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">sm</span><span class="o">-&gt;</span><span class="n">smt_class</span> <span class="o">==</span> <span class="n">SMT_PMF_GET</span> <span class="o">||</span>
	    <span class="n">sm</span><span class="o">-&gt;</span><span class="n">smt_class</span> <span class="o">==</span> <span class="n">SMT_PMF_SET</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">reply</span> <span class="o">=</span> <span class="n">smt_build_pmf_response</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="n">sm</span><span class="p">,</span>
			<span class="n">sm</span><span class="o">-&gt;</span><span class="n">smt_class</span> <span class="o">==</span> <span class="n">SMT_PMF_SET</span><span class="p">,</span><span class="n">local</span><span class="p">)</span> <span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">reply</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">sm</span> <span class="o">=</span> <span class="n">smtod</span><span class="p">(</span><span class="n">reply</span><span class="p">,</span><span class="k">struct</span> <span class="n">smt_header</span> <span class="o">*</span><span class="p">)</span> <span class="p">;</span>
<span class="cp">#ifdef	DEBUG</span>
			<span class="n">dump_smt</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="n">sm</span><span class="p">,</span><span class="s">&quot;PMF Reply&quot;</span><span class="p">)</span> <span class="p">;</span>
<span class="cp">#endif</span>
			<span class="n">smt_send_frame</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="n">reply</span><span class="p">,</span><span class="n">FC_SMT_INFO</span><span class="p">,</span><span class="n">local</span><span class="p">)</span> <span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">SMbuf</span> <span class="o">*</span><span class="nf">smt_build_pmf_response</span><span class="p">(</span><span class="k">struct</span> <span class="n">s_smc</span> <span class="o">*</span><span class="n">smc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">smt_header</span> <span class="o">*</span><span class="n">req</span><span class="p">,</span>
				     <span class="kt">int</span> <span class="n">set</span><span class="p">,</span> <span class="kt">int</span> <span class="n">local</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">SMbuf</span>			<span class="o">*</span><span class="n">mb</span> <span class="p">;</span>
	<span class="k">struct</span> <span class="n">smt_header</span>	<span class="o">*</span><span class="n">smt</span> <span class="p">;</span>
	<span class="k">struct</span> <span class="n">smt_para</span>		<span class="o">*</span><span class="n">pa</span> <span class="p">;</span>
	<span class="k">struct</span> <span class="n">smt_p_reason</span>	<span class="o">*</span><span class="n">res</span> <span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">s_p_tab</span>	<span class="o">*</span><span class="n">pt</span> <span class="p">;</span>
	<span class="kt">int</span>			<span class="n">len</span> <span class="p">;</span>
	<span class="kt">int</span>			<span class="n">index</span> <span class="p">;</span>
	<span class="kt">int</span>			<span class="n">idx_end</span> <span class="p">;</span>
	<span class="kt">int</span>			<span class="n">error</span> <span class="p">;</span>
	<span class="kt">int</span>			<span class="n">range</span> <span class="p">;</span>
	<span class="n">SK_LOC_DECL</span><span class="p">(</span><span class="k">struct</span> <span class="n">s_pcon</span><span class="p">,</span><span class="n">pcon</span><span class="p">)</span> <span class="p">;</span>
	<span class="n">SK_LOC_DECL</span><span class="p">(</span><span class="k">struct</span> <span class="n">s_pcon</span><span class="p">,</span><span class="n">set_pcon</span><span class="p">)</span> <span class="p">;</span>

	<span class="cm">/*</span>
<span class="cm">	 * build SMT header</span>
<span class="cm">	 */</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">mb</span> <span class="o">=</span> <span class="n">smt_get_mbuf</span><span class="p">(</span><span class="n">smc</span><span class="p">)))</span>
		<span class="k">return</span> <span class="n">mb</span><span class="p">;</span>

	<span class="n">smt</span> <span class="o">=</span> <span class="n">smtod</span><span class="p">(</span><span class="n">mb</span><span class="p">,</span> <span class="k">struct</span> <span class="n">smt_header</span> <span class="o">*</span><span class="p">)</span> <span class="p">;</span>
	<span class="n">smt</span><span class="o">-&gt;</span><span class="n">smt_dest</span> <span class="o">=</span> <span class="n">req</span><span class="o">-&gt;</span><span class="n">smt_source</span> <span class="p">;</span>	<span class="cm">/* DA == source of request */</span>
	<span class="n">smt</span><span class="o">-&gt;</span><span class="n">smt_class</span> <span class="o">=</span> <span class="n">req</span><span class="o">-&gt;</span><span class="n">smt_class</span> <span class="p">;</span>	<span class="cm">/* same class (GET/SET) */</span>
	<span class="n">smt</span><span class="o">-&gt;</span><span class="n">smt_type</span> <span class="o">=</span> <span class="n">SMT_REPLY</span> <span class="p">;</span>
	<span class="n">smt</span><span class="o">-&gt;</span><span class="n">smt_version</span> <span class="o">=</span> <span class="n">SMT_VID_2</span> <span class="p">;</span>
	<span class="n">smt</span><span class="o">-&gt;</span><span class="n">smt_tid</span> <span class="o">=</span> <span class="n">req</span><span class="o">-&gt;</span><span class="n">smt_tid</span> <span class="p">;</span>		<span class="cm">/* same TID */</span>
	<span class="n">smt</span><span class="o">-&gt;</span><span class="n">smt_pad</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>
	<span class="n">smt</span><span class="o">-&gt;</span><span class="n">smt_len</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>

	<span class="cm">/*</span>
<span class="cm">	 * setup parameter status</span>
<span class="cm">	 */</span>
	<span class="n">pcon</span><span class="p">.</span><span class="n">pc_len</span> <span class="o">=</span> <span class="n">SMT_MAX_INFO_LEN</span> <span class="p">;</span>	<span class="cm">/* max para length */</span>
	<span class="n">pcon</span><span class="p">.</span><span class="n">pc_err</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>			<span class="cm">/* no error */</span>
	<span class="n">pcon</span><span class="p">.</span><span class="n">pc_badset</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>			<span class="cm">/* no bad set count */</span>
	<span class="n">pcon</span><span class="p">.</span><span class="n">pc_p</span> <span class="o">=</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span> <span class="p">(</span><span class="n">smt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">;</span>	<span class="cm">/* paras start here */</span>

	<span class="cm">/*</span>
<span class="cm">	 * check authoriziation and set count</span>
<span class="cm">	 */</span>
	<span class="n">error</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">set</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">local</span> <span class="o">&amp;&amp;</span> <span class="n">smt_authorize</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="n">req</span><span class="p">))</span>
			<span class="n">error</span> <span class="o">=</span> <span class="n">SMT_RDF_AUTHOR</span> <span class="p">;</span>
		<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">smt_check_set_count</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="n">req</span><span class="p">))</span>
			<span class="n">pcon</span><span class="p">.</span><span class="n">pc_badset</span> <span class="o">=</span> <span class="n">SMT_RDF_BADSET</span> <span class="p">;</span>
	<span class="p">}</span>
	<span class="cm">/*</span>
<span class="cm">	 * add reason code and all mandatory parameters</span>
<span class="cm">	 */</span>
	<span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">smt_p_reason</span> <span class="o">*</span><span class="p">)</span> <span class="n">pcon</span><span class="p">.</span><span class="n">pc_p</span> <span class="p">;</span>
	<span class="n">smt_add_para</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="o">&amp;</span><span class="n">pcon</span><span class="p">,(</span><span class="n">u_short</span><span class="p">)</span> <span class="n">SMT_P_REASON</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">;</span>
	<span class="n">smt_add_para</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="o">&amp;</span><span class="n">pcon</span><span class="p">,(</span><span class="n">u_short</span><span class="p">)</span> <span class="n">SMT_P1033</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">;</span>
	<span class="cm">/* update 1035 and 1036 later if set */</span>
	<span class="n">set_pcon</span> <span class="o">=</span> <span class="n">pcon</span> <span class="p">;</span>
	<span class="n">smt_add_para</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="o">&amp;</span><span class="n">pcon</span><span class="p">,(</span><span class="n">u_short</span><span class="p">)</span> <span class="n">SMT_P1035</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">;</span>
	<span class="n">smt_add_para</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="o">&amp;</span><span class="n">pcon</span><span class="p">,(</span><span class="n">u_short</span><span class="p">)</span> <span class="n">SMT_P1036</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">;</span>

	<span class="n">pcon</span><span class="p">.</span><span class="n">pc_err</span> <span class="o">=</span> <span class="n">error</span> <span class="p">;</span>
	<span class="n">len</span> <span class="o">=</span> <span class="n">req</span><span class="o">-&gt;</span><span class="n">smt_len</span> <span class="p">;</span>
	<span class="n">pa</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">smt_para</span> <span class="o">*</span><span class="p">)</span> <span class="p">(</span><span class="n">req</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">;</span>
	<span class="cm">/*</span>
<span class="cm">	 * process list of paras</span>
<span class="cm">	 */</span>
	<span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">pcon</span><span class="p">.</span><span class="n">pc_err</span> <span class="o">&amp;&amp;</span> <span class="n">len</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(((</span><span class="n">u_short</span><span class="p">)</span><span class="n">len</span> <span class="o">&lt;</span> <span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_len</span> <span class="o">+</span> <span class="n">PARA_LEN</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_len</span> <span class="o">&amp;</span> <span class="mi">3</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">pcon</span><span class="p">.</span><span class="n">pc_err</span> <span class="o">=</span> <span class="n">SMT_RDF_LENGTH</span> <span class="p">;</span>
			<span class="k">break</span> <span class="p">;</span>
		<span class="p">}</span>

		<span class="k">if</span> <span class="p">(((</span><span class="n">range</span> <span class="o">=</span> <span class="p">(</span><span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_type</span> <span class="o">&amp;</span> <span class="mh">0xf000</span><span class="p">))</span> <span class="o">==</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="o">||</span>
			<span class="n">range</span> <span class="o">==</span> <span class="mh">0x3000</span> <span class="o">||</span> <span class="n">range</span> <span class="o">==</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="p">{</span>
			<span class="cm">/*</span>
<span class="cm">			 * get index for PART,MAC ad PATH group</span>
<span class="cm">			 */</span>
			<span class="n">index</span> <span class="o">=</span> <span class="o">*</span><span class="p">((</span><span class="n">u_char</span> <span class="o">*</span><span class="p">)</span><span class="n">pa</span> <span class="o">+</span> <span class="n">PARA_LEN</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="p">;</span><span class="cm">/* index */</span>
			<span class="n">idx_end</span> <span class="o">=</span> <span class="n">index</span> <span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">set</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_len</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">pcon</span><span class="p">.</span><span class="n">pc_err</span> <span class="o">=</span> <span class="n">SMT_RDF_LENGTH</span> <span class="p">;</span>
				<span class="k">break</span> <span class="p">;</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">index</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">set</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">switch</span> <span class="p">(</span><span class="n">range</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">case</span> <span class="mh">0x2000</span> :
					<span class="n">index</span> <span class="o">=</span> <span class="n">INDEX_MAC</span> <span class="p">;</span>
					<span class="n">idx_end</span> <span class="o">=</span> <span class="n">index</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">NUMMACS</span> <span class="p">;</span>
					<span class="k">break</span> <span class="p">;</span>
				<span class="k">case</span> <span class="mh">0x3000</span> :
					<span class="n">index</span> <span class="o">=</span> <span class="n">INDEX_PATH</span> <span class="p">;</span>
					<span class="n">idx_end</span> <span class="o">=</span> <span class="n">index</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">NUMPATHS</span> <span class="p">;</span>
					<span class="k">break</span> <span class="p">;</span>
				<span class="k">case</span> <span class="mh">0x4000</span> :
					<span class="n">index</span> <span class="o">=</span> <span class="n">INDEX_PORT</span> <span class="p">;</span>
					<span class="n">idx_end</span> <span class="o">=</span> <span class="n">index</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">NUMPHYS</span> <span class="p">;</span>
<span class="cp">#ifndef	CONCENTRATOR</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">smc</span><span class="o">-&gt;</span><span class="n">s</span><span class="p">.</span><span class="n">sas</span> <span class="o">==</span> <span class="n">SMT_SAS</span><span class="p">)</span>
						<span class="n">idx_end</span> <span class="o">=</span> <span class="n">INDEX_PORT</span> <span class="p">;</span>
<span class="cp">#endif</span>
					<span class="k">break</span> <span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">else</span> <span class="p">{</span>
			<span class="cm">/*</span>
<span class="cm">			 * smt group has no index</span>
<span class="cm">			 */</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">set</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_len</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">pcon</span><span class="p">.</span><span class="n">pc_err</span> <span class="o">=</span> <span class="n">SMT_RDF_LENGTH</span> <span class="p">;</span>
				<span class="k">break</span> <span class="p">;</span>
			<span class="p">}</span>
			<span class="n">index</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>
			<span class="n">idx_end</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>
		<span class="p">}</span>
		<span class="k">while</span> <span class="p">(</span><span class="n">index</span> <span class="o">&lt;=</span> <span class="n">idx_end</span><span class="p">)</span> <span class="p">{</span>
			<span class="cm">/*</span>
<span class="cm">			 * if group</span>
<span class="cm">			 *	add all paras of group</span>
<span class="cm">			 */</span>
			<span class="n">pt</span> <span class="o">=</span> <span class="n">smt_get_ptab</span><span class="p">(</span><span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_type</span><span class="p">)</span> <span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">pt</span> <span class="o">&amp;&amp;</span> <span class="n">pt</span><span class="o">-&gt;</span><span class="n">p_access</span> <span class="o">==</span> <span class="n">AC_GROUP</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">set</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">pt</span><span class="o">++</span> <span class="p">;</span>
				<span class="k">while</span> <span class="p">(</span><span class="n">pt</span><span class="o">-&gt;</span><span class="n">p_access</span> <span class="o">==</span> <span class="n">AC_G</span> <span class="o">||</span>
					<span class="n">pt</span><span class="o">-&gt;</span><span class="n">p_access</span> <span class="o">==</span> <span class="n">AC_GR</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">smt_add_para</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="o">&amp;</span><span class="n">pcon</span><span class="p">,</span><span class="n">pt</span><span class="o">-&gt;</span><span class="n">p_num</span><span class="p">,</span>
						<span class="n">index</span><span class="p">,</span><span class="n">local</span><span class="p">);</span>
					<span class="n">pt</span><span class="o">++</span> <span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="cm">/*</span>
<span class="cm">			 * ignore</span>
<span class="cm">			 *	AUTHORIZATION in get/set</span>
<span class="cm">			 *	SET COUNT in set</span>
<span class="cm">			 */</span>
			<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_type</span> <span class="o">!=</span> <span class="n">SMT_P_AUTHOR</span> <span class="o">&amp;&amp;</span>
				 <span class="p">(</span><span class="o">!</span><span class="n">set</span> <span class="o">||</span> <span class="p">(</span><span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_type</span> <span class="o">!=</span> <span class="n">SMT_P1035</span><span class="p">)))</span> <span class="p">{</span>
				<span class="kt">int</span>	<span class="n">st</span> <span class="p">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">pcon</span><span class="p">.</span><span class="n">pc_badset</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">smt_add_para</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="o">&amp;</span><span class="n">pcon</span><span class="p">,</span><span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_type</span><span class="p">,</span>
						<span class="n">index</span><span class="p">,</span><span class="n">local</span><span class="p">)</span> <span class="p">;</span>
				<span class="p">}</span>
				<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">set</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">st</span> <span class="o">=</span> <span class="n">smt_set_para</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="n">pa</span><span class="p">,</span><span class="n">index</span><span class="p">,</span><span class="n">local</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
					<span class="cm">/*</span>
<span class="cm">					 * return para even if error</span>
<span class="cm">					 */</span>
					<span class="n">smt_add_para</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="o">&amp;</span><span class="n">pcon</span><span class="p">,</span><span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_type</span><span class="p">,</span>
						<span class="n">index</span><span class="p">,</span><span class="n">local</span><span class="p">)</span> <span class="p">;</span>
					<span class="n">pcon</span><span class="p">.</span><span class="n">pc_err</span> <span class="o">=</span> <span class="n">st</span> <span class="p">;</span>
				<span class="p">}</span>
				<span class="k">else</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">pt</span> <span class="o">&amp;&amp;</span> <span class="n">pt</span><span class="o">-&gt;</span><span class="n">p_access</span> <span class="o">==</span> <span class="n">AC_S</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">pcon</span><span class="p">.</span><span class="n">pc_err</span> <span class="o">=</span>
							<span class="n">SMT_RDF_ILLEGAL</span> <span class="p">;</span>
					<span class="p">}</span>
					<span class="n">smt_add_para</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="o">&amp;</span><span class="n">pcon</span><span class="p">,</span><span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_type</span><span class="p">,</span>
						<span class="n">index</span><span class="p">,</span><span class="n">local</span><span class="p">)</span> <span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">pcon</span><span class="p">.</span><span class="n">pc_err</span><span class="p">)</span>
				<span class="k">break</span> <span class="p">;</span>
			<span class="n">index</span><span class="o">++</span> <span class="p">;</span>
		<span class="p">}</span>
		<span class="n">len</span> <span class="o">-=</span> <span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_len</span> <span class="o">+</span> <span class="n">PARA_LEN</span> <span class="p">;</span>
		<span class="n">pa</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">smt_para</span> <span class="o">*</span><span class="p">)</span> <span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">pa</span> <span class="o">+</span> <span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_len</span> <span class="o">+</span> <span class="n">PARA_LEN</span><span class="p">)</span> <span class="p">;</span>
	<span class="p">}</span>
	<span class="n">smt</span><span class="o">-&gt;</span><span class="n">smt_len</span> <span class="o">=</span> <span class="n">SMT_MAX_INFO_LEN</span> <span class="o">-</span> <span class="n">pcon</span><span class="p">.</span><span class="n">pc_len</span> <span class="p">;</span>
	<span class="n">mb</span><span class="o">-&gt;</span><span class="n">sm_len</span> <span class="o">=</span> <span class="n">smt</span><span class="o">-&gt;</span><span class="n">smt_len</span> <span class="o">+</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">smt_header</span><span class="p">)</span> <span class="p">;</span>

	<span class="cm">/* update reason code */</span>
	<span class="n">res</span><span class="o">-&gt;</span><span class="n">rdf_reason</span> <span class="o">=</span> <span class="n">pcon</span><span class="p">.</span><span class="n">pc_badset</span> <span class="o">?</span> <span class="n">pcon</span><span class="p">.</span><span class="n">pc_badset</span> <span class="o">:</span>
			<span class="n">pcon</span><span class="p">.</span><span class="n">pc_err</span> <span class="o">?</span> <span class="n">pcon</span><span class="p">.</span><span class="n">pc_err</span> <span class="o">:</span> <span class="n">SMT_RDF_SUCCESS</span> <span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">set</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">rdf_reason</span> <span class="o">==</span> <span class="n">SMT_RDF_SUCCESS</span><span class="p">))</span> <span class="p">{</span>
		<span class="cm">/*</span>
<span class="cm">		 * increment set count</span>
<span class="cm">		 * set time stamp</span>
<span class="cm">		 * store station id of last set</span>
<span class="cm">		 */</span>
		<span class="n">smc</span><span class="o">-&gt;</span><span class="n">mib</span><span class="p">.</span><span class="n">fddiSMTSetCount</span><span class="p">.</span><span class="n">count</span><span class="o">++</span> <span class="p">;</span>
		<span class="n">smt_set_timestamp</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="n">smc</span><span class="o">-&gt;</span><span class="n">mib</span><span class="p">.</span><span class="n">fddiSMTSetCount</span><span class="p">.</span><span class="n">timestamp</span><span class="p">)</span> <span class="p">;</span>
		<span class="n">smc</span><span class="o">-&gt;</span><span class="n">mib</span><span class="p">.</span><span class="n">fddiSMTLastSetStationId</span> <span class="o">=</span> <span class="n">req</span><span class="o">-&gt;</span><span class="n">smt_sid</span> <span class="p">;</span>
		<span class="n">smt_add_para</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="o">&amp;</span><span class="n">set_pcon</span><span class="p">,(</span><span class="n">u_short</span><span class="p">)</span> <span class="n">SMT_P1035</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">;</span>
		<span class="n">smt_add_para</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="o">&amp;</span><span class="n">set_pcon</span><span class="p">,(</span><span class="n">u_short</span><span class="p">)</span> <span class="n">SMT_P1036</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">mb</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">smt_authorize</span><span class="p">(</span><span class="k">struct</span> <span class="n">s_smc</span> <span class="o">*</span><span class="n">smc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">smt_header</span> <span class="o">*</span><span class="n">sm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">smt_para</span>	<span class="o">*</span><span class="n">pa</span> <span class="p">;</span>
	<span class="kt">int</span>		<span class="n">i</span> <span class="p">;</span>
	<span class="kt">char</span>		<span class="o">*</span><span class="n">p</span> <span class="p">;</span>

	<span class="cm">/*</span>
<span class="cm">	 * check source station id if not zero</span>
<span class="cm">	 */</span>
	<span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">smc</span><span class="o">-&gt;</span><span class="n">mib</span><span class="p">.</span><span class="n">fddiPRPMFStation</span> <span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
		<span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="mi">8</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">memcmp</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">sm</span><span class="o">-&gt;</span><span class="n">smt_sid</span><span class="p">,</span>
			<span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">smc</span><span class="o">-&gt;</span><span class="n">mib</span><span class="p">.</span><span class="n">fddiPRPMFStation</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="cm">/*</span>
<span class="cm">	 * check authoriziation parameter if passwd not zero</span>
<span class="cm">	 */</span>
	<span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">smc</span><span class="o">-&gt;</span><span class="n">mib</span><span class="p">.</span><span class="n">fddiPRPMFPasswd</span> <span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
		<span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="mi">8</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">pa</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">smt_para</span> <span class="o">*</span><span class="p">)</span> <span class="n">sm_to_para</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="n">sm</span><span class="p">,</span><span class="n">SMT_P_AUTHOR</span><span class="p">)</span> <span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">pa</span><span class="p">)</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_len</span> <span class="o">!=</span> <span class="mi">8</span><span class="p">)</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">memcmp</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)(</span><span class="n">pa</span><span class="o">+</span><span class="mi">1</span><span class="p">),(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">smc</span><span class="o">-&gt;</span><span class="n">mib</span><span class="p">.</span><span class="n">fddiPRPMFPasswd</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">smt_check_set_count</span><span class="p">(</span><span class="k">struct</span> <span class="n">s_smc</span> <span class="o">*</span><span class="n">smc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">smt_header</span> <span class="o">*</span><span class="n">sm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">smt_para</span>	<span class="o">*</span><span class="n">pa</span> <span class="p">;</span>
	<span class="k">struct</span> <span class="n">smt_p_setcount</span>	<span class="o">*</span><span class="n">sc</span> <span class="p">;</span>

	<span class="n">pa</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">smt_para</span> <span class="o">*</span><span class="p">)</span> <span class="n">sm_to_para</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="n">sm</span><span class="p">,</span><span class="n">SMT_P1035</span><span class="p">)</span> <span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">pa</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">sc</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">smt_p_setcount</span> <span class="o">*</span><span class="p">)</span> <span class="n">pa</span> <span class="p">;</span>
		<span class="k">if</span> <span class="p">((</span><span class="n">smc</span><span class="o">-&gt;</span><span class="n">mib</span><span class="p">.</span><span class="n">fddiSMTSetCount</span><span class="p">.</span><span class="n">count</span> <span class="o">!=</span> <span class="n">sc</span><span class="o">-&gt;</span><span class="n">count</span><span class="p">)</span> <span class="o">||</span>
			<span class="n">memcmp</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">smc</span><span class="o">-&gt;</span><span class="n">mib</span><span class="p">.</span><span class="n">fddiSMTSetCount</span><span class="p">.</span><span class="n">timestamp</span><span class="p">,</span>
			<span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">sc</span><span class="o">-&gt;</span><span class="n">timestamp</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">smt_add_para</span><span class="p">(</span><span class="k">struct</span> <span class="n">s_smc</span> <span class="o">*</span><span class="n">smc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">s_pcon</span> <span class="o">*</span><span class="n">pcon</span><span class="p">,</span> <span class="n">u_short</span> <span class="n">para</span><span class="p">,</span>
		  <span class="kt">int</span> <span class="n">index</span><span class="p">,</span> <span class="kt">int</span> <span class="n">local</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">smt_para</span>	<span class="o">*</span><span class="n">pa</span> <span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">s_p_tab</span>	<span class="o">*</span><span class="n">pt</span> <span class="p">;</span>
	<span class="k">struct</span> <span class="n">fddi_mib_m</span> <span class="o">*</span><span class="n">mib_m</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">fddi_mib_p</span> <span class="o">*</span><span class="n">mib_p</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="kt">int</span>		<span class="n">len</span> <span class="p">;</span>
	<span class="kt">int</span>		<span class="n">plen</span> <span class="p">;</span>
	<span class="kt">char</span>		<span class="o">*</span><span class="n">from</span> <span class="p">;</span>
	<span class="kt">char</span>		<span class="o">*</span><span class="n">to</span> <span class="p">;</span>
	<span class="k">const</span> <span class="kt">char</span>	<span class="o">*</span><span class="n">swap</span> <span class="p">;</span>
	<span class="kt">char</span>		<span class="n">c</span> <span class="p">;</span>
	<span class="kt">int</span>		<span class="n">range</span> <span class="p">;</span>
	<span class="kt">char</span>		<span class="o">*</span><span class="n">mib_addr</span> <span class="p">;</span>
	<span class="kt">int</span>		<span class="n">mac</span> <span class="p">;</span>
	<span class="kt">int</span>		<span class="n">path</span> <span class="p">;</span>
	<span class="kt">int</span>		<span class="n">port</span> <span class="p">;</span>
	<span class="kt">int</span>		<span class="n">sp_len</span> <span class="p">;</span>

	<span class="cm">/*</span>
<span class="cm">	 * skip if error</span>
<span class="cm">	 */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">pcon</span><span class="o">-&gt;</span><span class="n">pc_err</span><span class="p">)</span>
		<span class="k">return</span> <span class="p">;</span>

	<span class="cm">/*</span>
<span class="cm">	 * actions don&#39;t have a value</span>
<span class="cm">	 */</span>
	<span class="n">pt</span> <span class="o">=</span> <span class="n">smt_get_ptab</span><span class="p">(</span><span class="n">para</span><span class="p">)</span> <span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">pt</span> <span class="o">&amp;&amp;</span> <span class="n">pt</span><span class="o">-&gt;</span><span class="n">p_access</span> <span class="o">==</span> <span class="n">AC_S</span><span class="p">)</span>
		<span class="k">return</span> <span class="p">;</span>

	<span class="n">to</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="p">(</span><span class="n">pcon</span><span class="o">-&gt;</span><span class="n">pc_p</span><span class="p">)</span> <span class="p">;</span>	<span class="cm">/* destination pointer */</span>
	<span class="n">len</span> <span class="o">=</span> <span class="n">pcon</span><span class="o">-&gt;</span><span class="n">pc_len</span> <span class="p">;</span>		<span class="cm">/* free space */</span>
	<span class="n">plen</span> <span class="o">=</span> <span class="n">len</span> <span class="p">;</span>			<span class="cm">/* remember start length */</span>
	<span class="n">pa</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">smt_para</span> <span class="o">*</span><span class="p">)</span> <span class="n">to</span> <span class="p">;</span>	<span class="cm">/* type/length pointer */</span>
	<span class="n">to</span> <span class="o">+=</span> <span class="n">PARA_LEN</span> <span class="p">;</span>		<span class="cm">/* skip smt_para */</span>
	<span class="n">len</span> <span class="o">-=</span> <span class="n">PARA_LEN</span> <span class="p">;</span>
	<span class="cm">/*</span>
<span class="cm">	 * set index if required</span>
<span class="cm">	 */</span>
	<span class="k">if</span> <span class="p">(((</span><span class="n">range</span> <span class="o">=</span> <span class="p">(</span><span class="n">para</span> <span class="o">&amp;</span> <span class="mh">0xf000</span><span class="p">))</span> <span class="o">==</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="o">||</span>
		<span class="n">range</span> <span class="o">==</span> <span class="mh">0x3000</span> <span class="o">||</span> <span class="n">range</span> <span class="o">==</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">wrong_error</span> <span class="p">;</span>
		<span class="n">to</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>
		<span class="n">to</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>
		<span class="n">to</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>
		<span class="n">to</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">index</span> <span class="p">;</span>
		<span class="n">len</span> <span class="o">-=</span> <span class="mi">4</span> <span class="p">;</span>
		<span class="n">to</span> <span class="o">+=</span> <span class="mi">4</span> <span class="p">;</span>
	<span class="p">}</span>
	<span class="n">mac</span> <span class="o">=</span> <span class="n">index</span> <span class="o">-</span> <span class="n">INDEX_MAC</span> <span class="p">;</span>
	<span class="n">path</span> <span class="o">=</span> <span class="n">index</span> <span class="o">-</span> <span class="n">INDEX_PATH</span> <span class="p">;</span>
	<span class="n">port</span> <span class="o">=</span> <span class="n">index</span> <span class="o">-</span> <span class="n">INDEX_PORT</span> <span class="p">;</span>
	<span class="cm">/*</span>
<span class="cm">	 * get pointer to mib</span>
<span class="cm">	 */</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">range</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="mh">0x1000</span> :
	<span class="k">default</span> <span class="o">:</span>
		<span class="n">mib_addr</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">smc</span><span class="o">-&gt;</span><span class="n">mib</span><span class="p">)</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="mh">0x2000</span> :
		<span class="k">if</span> <span class="p">(</span><span class="n">mac</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">mac</span> <span class="o">&gt;=</span> <span class="n">NUMMACS</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">pcon</span><span class="o">-&gt;</span><span class="n">pc_err</span> <span class="o">=</span> <span class="n">SMT_RDF_NOPARAM</span> <span class="p">;</span>
			<span class="k">return</span> <span class="p">;</span>
		<span class="p">}</span>
		<span class="n">mib_addr</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">smc</span><span class="o">-&gt;</span><span class="n">mib</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="n">mac</span><span class="p">])</span> <span class="p">;</span>
		<span class="n">mib_m</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">fddi_mib_m</span> <span class="o">*</span><span class="p">)</span> <span class="n">mib_addr</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="mh">0x3000</span> :
		<span class="k">if</span> <span class="p">(</span><span class="n">path</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">path</span> <span class="o">&gt;=</span> <span class="n">NUMPATHS</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">pcon</span><span class="o">-&gt;</span><span class="n">pc_err</span> <span class="o">=</span> <span class="n">SMT_RDF_NOPARAM</span> <span class="p">;</span>
			<span class="k">return</span> <span class="p">;</span>
		<span class="p">}</span>
		<span class="n">mib_addr</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">smc</span><span class="o">-&gt;</span><span class="n">mib</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">path</span><span class="p">])</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="mh">0x4000</span> :
		<span class="k">if</span> <span class="p">(</span><span class="n">port</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">port</span> <span class="o">&gt;=</span> <span class="n">smt_mib_phys</span><span class="p">(</span><span class="n">smc</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">pcon</span><span class="o">-&gt;</span><span class="n">pc_err</span> <span class="o">=</span> <span class="n">SMT_RDF_NOPARAM</span> <span class="p">;</span>
			<span class="k">return</span> <span class="p">;</span>
		<span class="p">}</span>
		<span class="n">mib_addr</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">smc</span><span class="o">-&gt;</span><span class="n">mib</span><span class="p">.</span><span class="n">p</span><span class="p">[</span><span class="n">port_to_mib</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="n">port</span><span class="p">)])</span> <span class="p">;</span>
		<span class="n">mib_p</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">fddi_mib_p</span> <span class="o">*</span><span class="p">)</span> <span class="n">mib_addr</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="p">}</span>
	<span class="cm">/*</span>
<span class="cm">	 * check special paras</span>
<span class="cm">	 */</span>
	<span class="n">swap</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">para</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">SMT_P10F0</span> :
	<span class="k">case</span> <span class="n">SMT_P10F1</span> :
<span class="cp">#ifdef	ESS</span>
	<span class="k">case</span> <span class="n">SMT_P10F2</span> :
	<span class="k">case</span> <span class="n">SMT_P10F3</span> :
	<span class="k">case</span> <span class="n">SMT_P10F4</span> :
	<span class="k">case</span> <span class="n">SMT_P10F5</span> :
	<span class="k">case</span> <span class="n">SMT_P10F6</span> :
	<span class="k">case</span> <span class="n">SMT_P10F7</span> :
<span class="cp">#endif</span>
<span class="cp">#ifdef	SBA</span>
	<span class="k">case</span> <span class="n">SMT_P10F8</span> :
	<span class="k">case</span> <span class="n">SMT_P10F9</span> :
<span class="cp">#endif</span>
	<span class="k">case</span> <span class="n">SMT_P20F1</span> :
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">local</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">pcon</span><span class="o">-&gt;</span><span class="n">pc_err</span> <span class="o">=</span> <span class="n">SMT_RDF_NOPARAM</span> <span class="p">;</span>
			<span class="k">return</span> <span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P2034</span> :
	<span class="k">case</span> <span class="n">SMT_P2046</span> :
	<span class="k">case</span> <span class="n">SMT_P2047</span> :
	<span class="k">case</span> <span class="n">SMT_P204A</span> :
	<span class="k">case</span> <span class="n">SMT_P2051</span> :
	<span class="k">case</span> <span class="n">SMT_P2052</span> :
		<span class="n">mac_update_counter</span><span class="p">(</span><span class="n">smc</span><span class="p">)</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P4022</span>:
		<span class="n">mib_p</span><span class="o">-&gt;</span><span class="n">fddiPORTPC_LS</span> <span class="o">=</span> <span class="n">LS2MIB</span><span class="p">(</span>
			<span class="n">sm_pm_get_ls</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="n">port_to_mib</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="n">port</span><span class="p">)))</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P_REASON</span> :
		<span class="o">*</span> <span class="p">(</span><span class="n">u_long</span> <span class="o">*</span><span class="p">)</span> <span class="n">to</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>
		<span class="n">sp_len</span> <span class="o">=</span> <span class="mi">4</span> <span class="p">;</span>
		<span class="k">goto</span> <span class="n">sp_done</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P1033</span> :			<span class="cm">/* time stamp */</span>
		<span class="n">smt_set_timestamp</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="n">smc</span><span class="o">-&gt;</span><span class="n">mib</span><span class="p">.</span><span class="n">fddiSMTTimeStamp</span><span class="p">)</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>

	<span class="k">case</span> <span class="n">SMT_P1020</span>:				<span class="cm">/* port indexes */</span>
<span class="cp">#if	NUMPHYS == 12</span>
		<span class="n">swap</span> <span class="o">=</span> <span class="s">&quot;IIIIIIIIIIII&quot;</span> <span class="p">;</span>
<span class="cp">#else</span>
<span class="cp">#if	NUMPHYS == 2</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">smc</span><span class="o">-&gt;</span><span class="n">s</span><span class="p">.</span><span class="n">sas</span> <span class="o">==</span> <span class="n">SMT_SAS</span><span class="p">)</span>
			<span class="n">swap</span> <span class="o">=</span> <span class="s">&quot;I&quot;</span> <span class="p">;</span>
		<span class="k">else</span>
			<span class="n">swap</span> <span class="o">=</span> <span class="s">&quot;II&quot;</span> <span class="p">;</span>
<span class="cp">#else</span>
<span class="cp">#if	NUMPHYS == 24</span>
		<span class="n">swap</span> <span class="o">=</span> <span class="s">&quot;IIIIIIIIIIIIIIIIIIIIIIII&quot;</span> <span class="p">;</span>
<span class="cp">#else</span>
	<span class="o">????</span>
<span class="cp">#endif</span>
<span class="cp">#endif</span>
<span class="cp">#endif</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P3212</span> :
		<span class="p">{</span>
			<span class="n">sp_len</span> <span class="o">=</span> <span class="n">cem_build_path</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="n">to</span><span class="p">,</span><span class="n">path</span><span class="p">)</span> <span class="p">;</span>
			<span class="k">goto</span> <span class="n">sp_done</span> <span class="p">;</span>
		<span class="p">}</span>
	<span class="k">case</span> <span class="n">SMT_P1048</span> :		<span class="cm">/* peer wrap condition */</span>
		<span class="p">{</span>
			<span class="k">struct</span> <span class="n">smt_p_1048</span>	<span class="o">*</span><span class="n">sp</span> <span class="p">;</span>
			<span class="n">sp</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">smt_p_1048</span> <span class="o">*</span><span class="p">)</span> <span class="n">to</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p1048_flag</span> <span class="o">=</span> <span class="n">smc</span><span class="o">-&gt;</span><span class="n">mib</span><span class="p">.</span><span class="n">fddiSMTPeerWrapFlag</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p1048_cf_state</span> <span class="o">=</span> <span class="n">smc</span><span class="o">-&gt;</span><span class="n">mib</span><span class="p">.</span><span class="n">fddiSMTCF_State</span> <span class="p">;</span>
			<span class="n">sp_len</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">smt_p_1048</span><span class="p">)</span> <span class="p">;</span>
			<span class="k">goto</span> <span class="n">sp_done</span> <span class="p">;</span>
		<span class="p">}</span>
	<span class="k">case</span> <span class="n">SMT_P208C</span> :
		<span class="p">{</span>
			<span class="k">struct</span> <span class="n">smt_p_208c</span>	<span class="o">*</span><span class="n">sp</span> <span class="p">;</span>
			<span class="n">sp</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">smt_p_208c</span> <span class="o">*</span><span class="p">)</span> <span class="n">to</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p208c_flag</span> <span class="o">=</span>
				<span class="n">smc</span><span class="o">-&gt;</span><span class="n">mib</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="n">MAC0</span><span class="p">].</span><span class="n">fddiMACDuplicateAddressCond</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p208c_dupcondition</span> <span class="o">=</span>
				<span class="p">(</span><span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACDA_Flag</span> <span class="o">?</span> <span class="n">SMT_ST_MY_DUPA</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span>
				<span class="p">(</span><span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACUNDA_Flag</span> <span class="o">?</span> <span class="n">SMT_ST_UNA_DUPA</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p208c_fddilong</span> <span class="o">=</span>
				<span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACSMTAddress</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p208c_fddiunalong</span> <span class="o">=</span>
				<span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACUpstreamNbr</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p208c_pad</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>
			<span class="n">sp_len</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">smt_p_208c</span><span class="p">)</span> <span class="p">;</span>
			<span class="k">goto</span> <span class="n">sp_done</span> <span class="p">;</span>
		<span class="p">}</span>
	<span class="k">case</span> <span class="n">SMT_P208D</span> :		<span class="cm">/* frame error condition */</span>
		<span class="p">{</span>
			<span class="k">struct</span> <span class="n">smt_p_208d</span>	<span class="o">*</span><span class="n">sp</span> <span class="p">;</span>
			<span class="n">sp</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">smt_p_208d</span> <span class="o">*</span><span class="p">)</span> <span class="n">to</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p208d_flag</span> <span class="o">=</span>
				<span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACFrameErrorFlag</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p208d_frame_ct</span> <span class="o">=</span>
				<span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACFrame_Ct</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p208d_error_ct</span> <span class="o">=</span>
				<span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACError_Ct</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p208d_lost_ct</span> <span class="o">=</span>
				<span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACLost_Ct</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p208d_ratio</span> <span class="o">=</span>
				<span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACFrameErrorRatio</span> <span class="p">;</span>
			<span class="n">sp_len</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">smt_p_208d</span><span class="p">)</span> <span class="p">;</span>
			<span class="k">goto</span> <span class="n">sp_done</span> <span class="p">;</span>
		<span class="p">}</span>
	<span class="k">case</span> <span class="n">SMT_P208E</span> :		<span class="cm">/* not copied condition */</span>
		<span class="p">{</span>
			<span class="k">struct</span> <span class="n">smt_p_208e</span>	<span class="o">*</span><span class="n">sp</span> <span class="p">;</span>
			<span class="n">sp</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">smt_p_208e</span> <span class="o">*</span><span class="p">)</span> <span class="n">to</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p208e_flag</span> <span class="o">=</span>
				<span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACNotCopiedFlag</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p208e_not_copied</span> <span class="o">=</span>
				<span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACNotCopied_Ct</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p208e_copied</span> <span class="o">=</span>
				<span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACCopied_Ct</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p208e_not_copied_ratio</span> <span class="o">=</span>
				<span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACNotCopiedRatio</span> <span class="p">;</span>
			<span class="n">sp_len</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">smt_p_208e</span><span class="p">)</span> <span class="p">;</span>
			<span class="k">goto</span> <span class="n">sp_done</span> <span class="p">;</span>
		<span class="p">}</span>
	<span class="k">case</span> <span class="n">SMT_P208F</span> :	<span class="cm">/* neighbor change event */</span>
		<span class="p">{</span>
			<span class="k">struct</span> <span class="n">smt_p_208f</span>	<span class="o">*</span><span class="n">sp</span> <span class="p">;</span>
			<span class="n">sp</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">smt_p_208f</span> <span class="o">*</span><span class="p">)</span> <span class="n">to</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p208f_multiple</span> <span class="o">=</span>
				<span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACMultiple_N</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p208f_nacondition</span> <span class="o">=</span>
				<span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACDuplicateAddressCond</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p208f_old_una</span> <span class="o">=</span>
				<span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACOldUpstreamNbr</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p208f_new_una</span> <span class="o">=</span>
				<span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACUpstreamNbr</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p208f_old_dna</span> <span class="o">=</span>
				<span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACOldDownstreamNbr</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p208f_new_dna</span> <span class="o">=</span>
				<span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACDownstreamNbr</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p208f_curren_path</span> <span class="o">=</span>
				<span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACCurrentPath</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p208f_smt_address</span> <span class="o">=</span>
				<span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACSMTAddress</span> <span class="p">;</span>
			<span class="n">sp_len</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">smt_p_208f</span><span class="p">)</span> <span class="p">;</span>
			<span class="k">goto</span> <span class="n">sp_done</span> <span class="p">;</span>
		<span class="p">}</span>
	<span class="k">case</span> <span class="n">SMT_P2090</span> :
		<span class="p">{</span>
			<span class="k">struct</span> <span class="n">smt_p_2090</span>	<span class="o">*</span><span class="n">sp</span> <span class="p">;</span>
			<span class="n">sp</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">smt_p_2090</span> <span class="o">*</span><span class="p">)</span> <span class="n">to</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p2090_multiple</span> <span class="o">=</span>
				<span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACMultiple_P</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p2090_availablepaths</span> <span class="o">=</span>
				<span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACAvailablePaths</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p2090_currentpath</span> <span class="o">=</span>
				<span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACCurrentPath</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p2090_requestedpaths</span> <span class="o">=</span>
				<span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACRequestedPaths</span> <span class="p">;</span>
			<span class="n">sp_len</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">smt_p_2090</span><span class="p">)</span> <span class="p">;</span>
			<span class="k">goto</span> <span class="n">sp_done</span> <span class="p">;</span>
		<span class="p">}</span>
	<span class="k">case</span> <span class="n">SMT_P4050</span> :
		<span class="p">{</span>
			<span class="k">struct</span> <span class="n">smt_p_4050</span>	<span class="o">*</span><span class="n">sp</span> <span class="p">;</span>
			<span class="n">sp</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">smt_p_4050</span> <span class="o">*</span><span class="p">)</span> <span class="n">to</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p4050_flag</span> <span class="o">=</span>
				<span class="n">mib_p</span><span class="o">-&gt;</span><span class="n">fddiPORTLerFlag</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p4050_pad</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p4050_cutoff</span> <span class="o">=</span>
				<span class="n">mib_p</span><span class="o">-&gt;</span><span class="n">fddiPORTLer_Cutoff</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p4050_alarm</span> <span class="o">=</span>
				<span class="n">mib_p</span><span class="o">-&gt;</span><span class="n">fddiPORTLer_Alarm</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p4050_estimate</span> <span class="o">=</span>
				<span class="n">mib_p</span><span class="o">-&gt;</span><span class="n">fddiPORTLer_Estimate</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p4050_reject_ct</span> <span class="o">=</span>
				<span class="n">mib_p</span><span class="o">-&gt;</span><span class="n">fddiPORTLem_Reject_Ct</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p4050_ct</span> <span class="o">=</span>
				<span class="n">mib_p</span><span class="o">-&gt;</span><span class="n">fddiPORTLem_Ct</span> <span class="p">;</span>
			<span class="n">sp_len</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">smt_p_4050</span><span class="p">)</span> <span class="p">;</span>
			<span class="k">goto</span> <span class="n">sp_done</span> <span class="p">;</span>
		<span class="p">}</span>

	<span class="k">case</span> <span class="n">SMT_P4051</span> :
		<span class="p">{</span>
			<span class="k">struct</span> <span class="n">smt_p_4051</span>	<span class="o">*</span><span class="n">sp</span> <span class="p">;</span>
			<span class="n">sp</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">smt_p_4051</span> <span class="o">*</span><span class="p">)</span> <span class="n">to</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p4051_multiple</span> <span class="o">=</span>
				<span class="n">mib_p</span><span class="o">-&gt;</span><span class="n">fddiPORTMultiple_U</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p4051_porttype</span> <span class="o">=</span>
				<span class="n">mib_p</span><span class="o">-&gt;</span><span class="n">fddiPORTMy_Type</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p4051_connectstate</span> <span class="o">=</span>
				<span class="n">mib_p</span><span class="o">-&gt;</span><span class="n">fddiPORTConnectState</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p4051_pc_neighbor</span> <span class="o">=</span>
				<span class="n">mib_p</span><span class="o">-&gt;</span><span class="n">fddiPORTNeighborType</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p4051_pc_withhold</span> <span class="o">=</span>
				<span class="n">mib_p</span><span class="o">-&gt;</span><span class="n">fddiPORTPC_Withhold</span> <span class="p">;</span>
			<span class="n">sp_len</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">smt_p_4051</span><span class="p">)</span> <span class="p">;</span>
			<span class="k">goto</span> <span class="n">sp_done</span> <span class="p">;</span>
		<span class="p">}</span>
	<span class="k">case</span> <span class="n">SMT_P4052</span> :
		<span class="p">{</span>
			<span class="k">struct</span> <span class="n">smt_p_4052</span>	<span class="o">*</span><span class="n">sp</span> <span class="p">;</span>
			<span class="n">sp</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">smt_p_4052</span> <span class="o">*</span><span class="p">)</span> <span class="n">to</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p4052_flag</span> <span class="o">=</span>
				<span class="n">mib_p</span><span class="o">-&gt;</span><span class="n">fddiPORTEB_Condition</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p4052_eberrorcount</span> <span class="o">=</span>
				<span class="n">mib_p</span><span class="o">-&gt;</span><span class="n">fddiPORTEBError_Ct</span> <span class="p">;</span>
			<span class="n">sp_len</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">smt_p_4052</span><span class="p">)</span> <span class="p">;</span>
			<span class="k">goto</span> <span class="n">sp_done</span> <span class="p">;</span>
		<span class="p">}</span>
	<span class="k">case</span> <span class="n">SMT_P4053</span> :
		<span class="p">{</span>
			<span class="k">struct</span> <span class="n">smt_p_4053</span>	<span class="o">*</span><span class="n">sp</span> <span class="p">;</span>
			<span class="n">sp</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">smt_p_4053</span> <span class="o">*</span><span class="p">)</span> <span class="n">to</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p4053_multiple</span> <span class="o">=</span>
				<span class="n">mib_p</span><span class="o">-&gt;</span><span class="n">fddiPORTMultiple_P</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p4053_availablepaths</span> <span class="o">=</span>
				<span class="n">mib_p</span><span class="o">-&gt;</span><span class="n">fddiPORTAvailablePaths</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p4053_currentpath</span> <span class="o">=</span>
				<span class="n">mib_p</span><span class="o">-&gt;</span><span class="n">fddiPORTCurrentPath</span> <span class="p">;</span>
			<span class="n">memcpy</span><span class="p">(</span>	<span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">sp</span><span class="o">-&gt;</span><span class="n">p4053_requestedpaths</span><span class="p">,</span>
				<span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">mib_p</span><span class="o">-&gt;</span><span class="n">fddiPORTRequestedPaths</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p4053_mytype</span> <span class="o">=</span>
				<span class="n">mib_p</span><span class="o">-&gt;</span><span class="n">fddiPORTMy_Type</span> <span class="p">;</span>
			<span class="n">sp</span><span class="o">-&gt;</span><span class="n">p4053_neighbortype</span> <span class="o">=</span>
				<span class="n">mib_p</span><span class="o">-&gt;</span><span class="n">fddiPORTNeighborType</span> <span class="p">;</span>
			<span class="n">sp_len</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">smt_p_4053</span><span class="p">)</span> <span class="p">;</span>
			<span class="k">goto</span> <span class="n">sp_done</span> <span class="p">;</span>
		<span class="p">}</span>
	<span class="k">default</span> <span class="o">:</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="p">}</span>
	<span class="cm">/*</span>
<span class="cm">	 * in table ?</span>
<span class="cm">	 */</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">pt</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">pcon</span><span class="o">-&gt;</span><span class="n">pc_err</span> <span class="o">=</span> <span class="p">(</span><span class="n">para</span> <span class="o">&amp;</span> <span class="mh">0xff00</span><span class="p">)</span> <span class="o">?</span> <span class="n">SMT_RDF_NOPARAM</span> <span class="o">:</span>
						<span class="n">SMT_RDF_ILLEGAL</span> <span class="p">;</span>
		<span class="k">return</span> <span class="p">;</span>
	<span class="p">}</span>
	<span class="cm">/*</span>
<span class="cm">	 * check access rights</span>
<span class="cm">	 */</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">pt</span><span class="o">-&gt;</span><span class="n">p_access</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">AC_G</span> :
	<span class="k">case</span> <span class="n">AC_GR</span> :
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">default</span> <span class="o">:</span>
		<span class="n">pcon</span><span class="o">-&gt;</span><span class="n">pc_err</span> <span class="o">=</span> <span class="n">SMT_RDF_ILLEGAL</span> <span class="p">;</span>
		<span class="k">return</span> <span class="p">;</span>
	<span class="p">}</span>
	<span class="n">from</span> <span class="o">=</span> <span class="n">mib_addr</span> <span class="o">+</span> <span class="n">pt</span><span class="o">-&gt;</span><span class="n">p_offset</span> <span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">swap</span><span class="p">)</span>
		<span class="n">swap</span> <span class="o">=</span> <span class="n">pt</span><span class="o">-&gt;</span><span class="n">p_swap</span> <span class="p">;</span>		<span class="cm">/* pointer to swap string */</span>

	<span class="cm">/*</span>
<span class="cm">	 * copy values</span>
<span class="cm">	 */</span>
	<span class="k">while</span> <span class="p">((</span><span class="n">c</span> <span class="o">=</span> <span class="o">*</span><span class="n">swap</span><span class="o">++</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">switch</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="sc">&#39;b&#39;</span> :
		<span class="k">case</span> <span class="sc">&#39;w&#39;</span> :
		<span class="k">case</span> <span class="sc">&#39;l&#39;</span> :
			<span class="k">break</span> <span class="p">;</span>
		<span class="k">case</span> <span class="sc">&#39;S&#39;</span> :
		<span class="k">case</span> <span class="sc">&#39;E&#39;</span> :
		<span class="k">case</span> <span class="sc">&#39;R&#39;</span> :
		<span class="k">case</span> <span class="sc">&#39;r&#39;</span> :
			<span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">)</span>
				<span class="k">goto</span> <span class="n">len_error</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>
<span class="cp">#ifdef	LITTLE_ENDIAN</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;r&#39;</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">to</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
				<span class="n">to</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="p">}</span>
			<span class="k">else</span> <span class="p">{</span>
				<span class="n">to</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
				<span class="n">to</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="p">}</span>
<span class="cp">#else</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
<span class="cp">#endif</span>
			<span class="n">to</span> <span class="o">+=</span> <span class="mi">4</span> <span class="p">;</span>
			<span class="n">len</span> <span class="o">-=</span> <span class="mi">4</span> <span class="p">;</span>
			<span class="k">break</span> <span class="p">;</span>
		<span class="k">case</span> <span class="sc">&#39;I&#39;</span> :		<span class="cm">/* for SET of port indexes */</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span>
				<span class="k">goto</span> <span class="n">len_error</span> <span class="p">;</span>
<span class="cp">#ifdef	LITTLE_ENDIAN</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
<span class="cp">#else</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
<span class="cp">#endif</span>
			<span class="n">to</span> <span class="o">+=</span> <span class="mi">2</span> <span class="p">;</span>
			<span class="n">len</span> <span class="o">-=</span> <span class="mi">2</span> <span class="p">;</span>
			<span class="k">break</span> <span class="p">;</span>
		<span class="k">case</span> <span class="sc">&#39;F&#39;</span> :
		<span class="k">case</span> <span class="sc">&#39;B&#39;</span> :
			<span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">)</span>
				<span class="k">goto</span> <span class="n">len_error</span> <span class="p">;</span>
			<span class="n">len</span> <span class="o">-=</span> <span class="mi">4</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span> <span class="o">+=</span> <span class="mi">4</span> <span class="p">;</span>
			<span class="k">break</span> <span class="p">;</span>
		<span class="k">case</span> <span class="sc">&#39;C&#39;</span> :
		<span class="k">case</span> <span class="sc">&#39;T&#39;</span> :
		<span class="k">case</span> <span class="sc">&#39;L&#39;</span> :
			<span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">)</span>
				<span class="k">goto</span> <span class="n">len_error</span> <span class="p">;</span>
<span class="cp">#ifdef	LITTLE_ENDIAN</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
<span class="cp">#else</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
<span class="cp">#endif</span>
			<span class="n">len</span> <span class="o">-=</span> <span class="mi">4</span> <span class="p">;</span>
			<span class="n">to</span> <span class="o">+=</span> <span class="mi">4</span> <span class="p">;</span>
			<span class="k">break</span> <span class="p">;</span>
		<span class="k">case</span> <span class="sc">&#39;2&#39;</span> :		<span class="cm">/* PortMacIndicated */</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">)</span>
				<span class="k">goto</span> <span class="n">len_error</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">len</span> <span class="o">-=</span> <span class="mi">4</span> <span class="p">;</span>
			<span class="n">to</span> <span class="o">+=</span> <span class="mi">4</span> <span class="p">;</span>
			<span class="k">break</span> <span class="p">;</span>
		<span class="k">case</span> <span class="sc">&#39;4&#39;</span> :
			<span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">)</span>
				<span class="k">goto</span> <span class="n">len_error</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">len</span> <span class="o">-=</span> <span class="mi">4</span> <span class="p">;</span>
			<span class="n">to</span> <span class="o">+=</span> <span class="mi">4</span> <span class="p">;</span>
			<span class="k">break</span> <span class="p">;</span>
		<span class="k">case</span> <span class="sc">&#39;A&#39;</span> :
			<span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">)</span>
				<span class="k">goto</span> <span class="n">len_error</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>
			<span class="n">memcpy</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">to</span><span class="o">+</span><span class="mi">2</span><span class="p">,(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">from</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="p">;</span>
			<span class="n">to</span> <span class="o">+=</span> <span class="mi">8</span> <span class="p">;</span>
			<span class="n">from</span> <span class="o">+=</span> <span class="mi">8</span> <span class="p">;</span>
			<span class="n">len</span> <span class="o">-=</span> <span class="mi">8</span> <span class="p">;</span>
			<span class="k">break</span> <span class="p">;</span>
		<span class="k">case</span> <span class="sc">&#39;8&#39;</span> :
			<span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">)</span>
				<span class="k">goto</span> <span class="n">len_error</span> <span class="p">;</span>
			<span class="n">memcpy</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">to</span><span class="p">,(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">from</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span> <span class="p">;</span>
			<span class="n">to</span> <span class="o">+=</span> <span class="mi">8</span> <span class="p">;</span>
			<span class="n">from</span> <span class="o">+=</span> <span class="mi">8</span> <span class="p">;</span>
			<span class="n">len</span> <span class="o">-=</span> <span class="mi">8</span> <span class="p">;</span>
			<span class="k">break</span> <span class="p">;</span>
		<span class="k">case</span> <span class="sc">&#39;D&#39;</span> :
			<span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">)</span>
				<span class="k">goto</span> <span class="n">len_error</span> <span class="p">;</span>
			<span class="n">memcpy</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">to</span><span class="p">,(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">from</span><span class="p">,</span><span class="mi">32</span><span class="p">)</span> <span class="p">;</span>
			<span class="n">to</span> <span class="o">+=</span> <span class="mi">32</span> <span class="p">;</span>
			<span class="n">from</span> <span class="o">+=</span> <span class="mi">32</span> <span class="p">;</span>
			<span class="n">len</span> <span class="o">-=</span> <span class="mi">32</span> <span class="p">;</span>
			<span class="k">break</span> <span class="p">;</span>
		<span class="k">case</span> <span class="sc">&#39;P&#39;</span> :		<span class="cm">/* timestamp is NOT swapped */</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">)</span>
				<span class="k">goto</span> <span class="n">len_error</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span> <span class="o">+=</span> <span class="mi">8</span> <span class="p">;</span>
			<span class="n">len</span> <span class="o">-=</span> <span class="mi">8</span> <span class="p">;</span>
			<span class="k">break</span> <span class="p">;</span>
		<span class="k">default</span> <span class="o">:</span>
			<span class="n">SMT_PANIC</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="n">SMT_E0119</span><span class="p">,</span> <span class="n">SMT_E0119_MSG</span><span class="p">)</span> <span class="p">;</span>
			<span class="k">break</span> <span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>

<span class="nl">done:</span>
	<span class="cm">/*</span>
<span class="cm">	 * make it even (in case of &#39;I&#39; encoding)</span>
<span class="cm">	 * note: len is DECREMENTED</span>
<span class="cm">	 */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">&amp;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">to</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>
		<span class="n">to</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>
		<span class="n">to</span> <span class="o">+=</span> <span class="mi">4</span> <span class="o">-</span> <span class="p">(</span><span class="n">len</span> <span class="o">&amp;</span> <span class="mi">3</span> <span class="p">)</span> <span class="p">;</span>
		<span class="n">len</span> <span class="o">=</span> <span class="n">len</span> <span class="o">&amp;</span> <span class="o">~</span> <span class="mi">3</span> <span class="p">;</span>
	<span class="p">}</span>

	<span class="cm">/* set type and length */</span>
	<span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_type</span> <span class="o">=</span> <span class="n">para</span> <span class="p">;</span>
	<span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_len</span> <span class="o">=</span> <span class="n">plen</span> <span class="o">-</span> <span class="n">len</span> <span class="o">-</span> <span class="n">PARA_LEN</span> <span class="p">;</span>
	<span class="cm">/* return values */</span>
	<span class="n">pcon</span><span class="o">-&gt;</span><span class="n">pc_p</span> <span class="o">=</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span> <span class="n">to</span> <span class="p">;</span>
	<span class="n">pcon</span><span class="o">-&gt;</span><span class="n">pc_len</span> <span class="o">=</span> <span class="n">len</span> <span class="p">;</span>
	<span class="k">return</span> <span class="p">;</span>

<span class="nl">sp_done:</span>
	<span class="n">len</span> <span class="o">-=</span> <span class="n">sp_len</span> <span class="p">;</span>
	<span class="n">to</span> <span class="o">+=</span> <span class="n">sp_len</span> <span class="p">;</span>
	<span class="k">goto</span> <span class="n">done</span> <span class="p">;</span>

<span class="nl">len_error:</span>
	<span class="cm">/* parameter does not fit in frame */</span>
	<span class="n">pcon</span><span class="o">-&gt;</span><span class="n">pc_err</span> <span class="o">=</span> <span class="n">SMT_RDF_TOOLONG</span> <span class="p">;</span>
	<span class="k">return</span> <span class="p">;</span>

<span class="nl">wrong_error:</span>
	<span class="n">pcon</span><span class="o">-&gt;</span><span class="n">pc_err</span> <span class="o">=</span> <span class="n">SMT_RDF_LENGTH</span> <span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * set parameter</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">smt_set_para</span><span class="p">(</span><span class="k">struct</span> <span class="n">s_smc</span> <span class="o">*</span><span class="n">smc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">smt_para</span> <span class="o">*</span><span class="n">pa</span><span class="p">,</span> <span class="kt">int</span> <span class="n">index</span><span class="p">,</span>
			<span class="kt">int</span> <span class="n">local</span><span class="p">,</span> <span class="kt">int</span> <span class="n">set</span><span class="p">)</span>
<span class="p">{</span>
<span class="cp">#define IFSET(x)	if (set) (x)</span>

	<span class="k">const</span> <span class="k">struct</span> <span class="n">s_p_tab</span>	<span class="o">*</span><span class="n">pt</span> <span class="p">;</span>
	<span class="kt">int</span>		<span class="n">len</span> <span class="p">;</span>
	<span class="kt">char</span>		<span class="o">*</span><span class="n">from</span> <span class="p">;</span>
	<span class="kt">char</span>		<span class="o">*</span><span class="n">to</span> <span class="p">;</span>
	<span class="k">const</span> <span class="kt">char</span>	<span class="o">*</span><span class="n">swap</span> <span class="p">;</span>
	<span class="kt">char</span>		<span class="n">c</span> <span class="p">;</span>
	<span class="kt">char</span>		<span class="o">*</span><span class="n">mib_addr</span> <span class="p">;</span>
	<span class="k">struct</span> <span class="n">fddi_mib</span>	<span class="o">*</span><span class="n">mib</span> <span class="p">;</span>
	<span class="k">struct</span> <span class="n">fddi_mib_m</span>	<span class="o">*</span><span class="n">mib_m</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">fddi_mib_a</span>	<span class="o">*</span><span class="n">mib_a</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">fddi_mib_p</span>	<span class="o">*</span><span class="n">mib_p</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="kt">int</span>		<span class="n">mac</span> <span class="p">;</span>
	<span class="kt">int</span>		<span class="n">path</span> <span class="p">;</span>
	<span class="kt">int</span>		<span class="n">port</span> <span class="p">;</span>
	<span class="n">SK_LOC_DECL</span><span class="p">(</span><span class="n">u_char</span><span class="p">,</span><span class="n">byte_val</span><span class="p">)</span> <span class="p">;</span>
	<span class="n">SK_LOC_DECL</span><span class="p">(</span><span class="n">u_short</span><span class="p">,</span><span class="n">word_val</span><span class="p">)</span> <span class="p">;</span>
	<span class="n">SK_LOC_DECL</span><span class="p">(</span><span class="n">u_long</span><span class="p">,</span><span class="n">long_val</span><span class="p">)</span> <span class="p">;</span>

	<span class="n">mac</span> <span class="o">=</span> <span class="n">index</span> <span class="o">-</span> <span class="n">INDEX_MAC</span> <span class="p">;</span>
	<span class="n">path</span> <span class="o">=</span> <span class="n">index</span> <span class="o">-</span> <span class="n">INDEX_PATH</span> <span class="p">;</span>
	<span class="n">port</span> <span class="o">=</span> <span class="n">index</span> <span class="o">-</span> <span class="n">INDEX_PORT</span> <span class="p">;</span>
	<span class="n">len</span> <span class="o">=</span> <span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_len</span> <span class="p">;</span>
	<span class="n">from</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="p">(</span><span class="n">pa</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">;</span>

	<span class="n">mib</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">smc</span><span class="o">-&gt;</span><span class="n">mib</span> <span class="p">;</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_type</span> <span class="o">&amp;</span> <span class="mh">0xf000</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="mh">0x1000</span> :
	<span class="k">default</span> <span class="o">:</span>
		<span class="n">mib_addr</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">mib</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="mh">0x2000</span> :
		<span class="k">if</span> <span class="p">(</span><span class="n">mac</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">mac</span> <span class="o">&gt;=</span> <span class="n">NUMMACS</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">return</span> <span class="n">SMT_RDF_NOPARAM</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">mib_m</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">smc</span><span class="o">-&gt;</span><span class="n">mib</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="n">mac</span><span class="p">]</span> <span class="p">;</span>
		<span class="n">mib_addr</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">mib_m</span> <span class="p">;</span>
		<span class="n">from</span> <span class="o">+=</span> <span class="mi">4</span> <span class="p">;</span>		<span class="cm">/* skip index */</span>
		<span class="n">len</span> <span class="o">-=</span> <span class="mi">4</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="mh">0x3000</span> :
		<span class="k">if</span> <span class="p">(</span><span class="n">path</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">path</span> <span class="o">&gt;=</span> <span class="n">NUMPATHS</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">return</span> <span class="n">SMT_RDF_NOPARAM</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">mib_a</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">smc</span><span class="o">-&gt;</span><span class="n">mib</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">path</span><span class="p">]</span> <span class="p">;</span>
		<span class="n">mib_addr</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">mib_a</span> <span class="p">;</span>
		<span class="n">from</span> <span class="o">+=</span> <span class="mi">4</span> <span class="p">;</span>		<span class="cm">/* skip index */</span>
		<span class="n">len</span> <span class="o">-=</span> <span class="mi">4</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="mh">0x4000</span> :
		<span class="k">if</span> <span class="p">(</span><span class="n">port</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">port</span> <span class="o">&gt;=</span> <span class="n">smt_mib_phys</span><span class="p">(</span><span class="n">smc</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">return</span> <span class="n">SMT_RDF_NOPARAM</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">mib_p</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">smc</span><span class="o">-&gt;</span><span class="n">mib</span><span class="p">.</span><span class="n">p</span><span class="p">[</span><span class="n">port_to_mib</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="n">port</span><span class="p">)]</span> <span class="p">;</span>
		<span class="n">mib_addr</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">mib_p</span> <span class="p">;</span>
		<span class="n">from</span> <span class="o">+=</span> <span class="mi">4</span> <span class="p">;</span>		<span class="cm">/* skip index */</span>
		<span class="n">len</span> <span class="o">-=</span> <span class="mi">4</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="p">}</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_type</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">SMT_P10F0</span> :
	<span class="k">case</span> <span class="n">SMT_P10F1</span> :
<span class="cp">#ifdef	ESS</span>
	<span class="k">case</span> <span class="n">SMT_P10F2</span> :
	<span class="k">case</span> <span class="n">SMT_P10F3</span> :
	<span class="k">case</span> <span class="n">SMT_P10F4</span> :
	<span class="k">case</span> <span class="n">SMT_P10F5</span> :
	<span class="k">case</span> <span class="n">SMT_P10F6</span> :
	<span class="k">case</span> <span class="n">SMT_P10F7</span> :
<span class="cp">#endif</span>
<span class="cp">#ifdef	SBA</span>
	<span class="k">case</span> <span class="n">SMT_P10F8</span> :
	<span class="k">case</span> <span class="n">SMT_P10F9</span> :
<span class="cp">#endif</span>
	<span class="k">case</span> <span class="n">SMT_P20F1</span> :
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">local</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">SMT_RDF_NOPARAM</span><span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="p">}</span>
	<span class="n">pt</span> <span class="o">=</span> <span class="n">smt_get_ptab</span><span class="p">(</span><span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_type</span><span class="p">)</span> <span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">pt</span><span class="p">)</span>
		<span class="k">return</span> <span class="p">(</span><span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_type</span> <span class="o">&amp;</span> <span class="mh">0xff00</span><span class="p">)</span> <span class="o">?</span> <span class="n">SMT_RDF_NOPARAM</span> <span class="o">:</span>
					       <span class="n">SMT_RDF_ILLEGAL</span><span class="p">;</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">pt</span><span class="o">-&gt;</span><span class="n">p_access</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">AC_GR</span> :
	<span class="k">case</span> <span class="n">AC_S</span> :
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">default</span> <span class="o">:</span>
		<span class="k">return</span> <span class="n">SMT_RDF_ILLEGAL</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">to</span> <span class="o">=</span> <span class="n">mib_addr</span> <span class="o">+</span> <span class="n">pt</span><span class="o">-&gt;</span><span class="n">p_offset</span> <span class="p">;</span>
	<span class="n">swap</span> <span class="o">=</span> <span class="n">pt</span><span class="o">-&gt;</span><span class="n">p_swap</span> <span class="p">;</span>		<span class="cm">/* pointer to swap string */</span>

	<span class="k">while</span> <span class="p">(</span><span class="n">swap</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="o">*</span><span class="n">swap</span><span class="o">++</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">switch</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="sc">&#39;b&#39;</span> :
			<span class="n">to</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">byte_val</span> <span class="p">;</span>
			<span class="k">break</span> <span class="p">;</span>
		<span class="k">case</span> <span class="sc">&#39;w&#39;</span> :
			<span class="n">to</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">word_val</span> <span class="p">;</span>
			<span class="k">break</span> <span class="p">;</span>
		<span class="k">case</span> <span class="sc">&#39;l&#39;</span> :
			<span class="n">to</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">long_val</span> <span class="p">;</span>
			<span class="k">break</span> <span class="p">;</span>
		<span class="k">case</span> <span class="sc">&#39;S&#39;</span> :
		<span class="k">case</span> <span class="sc">&#39;E&#39;</span> :
		<span class="k">case</span> <span class="sc">&#39;R&#39;</span> :
		<span class="k">case</span> <span class="sc">&#39;r&#39;</span> :
			<span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">goto</span> <span class="n">len_error</span> <span class="p">;</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">from</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">|</span> <span class="n">from</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
				<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>
<span class="cp">#ifdef	LITTLE_ENDIAN</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;r&#39;</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">to</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">from</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">;</span>
				<span class="n">to</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">from</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">;</span>
			<span class="p">}</span>
			<span class="k">else</span> <span class="p">{</span>
				<span class="n">to</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">from</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">;</span>
				<span class="n">to</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">from</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">;</span>
			<span class="p">}</span>
<span class="cp">#else</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">from</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">from</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">;</span>
<span class="cp">#endif</span>
			<span class="n">from</span> <span class="o">+=</span> <span class="mi">4</span> <span class="p">;</span>
			<span class="n">to</span> <span class="o">+=</span> <span class="mi">2</span> <span class="p">;</span>
			<span class="n">len</span> <span class="o">-=</span> <span class="mi">4</span> <span class="p">;</span>
			<span class="k">break</span> <span class="p">;</span>
		<span class="k">case</span> <span class="sc">&#39;F&#39;</span> :
		<span class="k">case</span> <span class="sc">&#39;B&#39;</span> :
			<span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">goto</span> <span class="n">len_error</span> <span class="p">;</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">from</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">|</span> <span class="n">from</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">|</span> <span class="n">from</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
				<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">from</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">;</span>
			<span class="n">len</span> <span class="o">-=</span> <span class="mi">4</span> <span class="p">;</span>
			<span class="n">from</span> <span class="o">+=</span> <span class="mi">4</span> <span class="p">;</span>
			<span class="n">to</span> <span class="o">+=</span> <span class="mi">4</span> <span class="p">;</span>
			<span class="k">break</span> <span class="p">;</span>
		<span class="k">case</span> <span class="sc">&#39;C&#39;</span> :
		<span class="k">case</span> <span class="sc">&#39;T&#39;</span> :
		<span class="k">case</span> <span class="sc">&#39;L&#39;</span> :
			<span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">goto</span> <span class="n">len_error</span> <span class="p">;</span>
			<span class="p">}</span>
<span class="cp">#ifdef	LITTLE_ENDIAN</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
<span class="cp">#else</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="n">to</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
<span class="cp">#endif</span>
			<span class="n">len</span> <span class="o">-=</span> <span class="mi">4</span> <span class="p">;</span>
			<span class="n">to</span> <span class="o">+=</span> <span class="mi">4</span> <span class="p">;</span>
			<span class="k">break</span> <span class="p">;</span>
		<span class="k">case</span> <span class="sc">&#39;A&#39;</span> :
			<span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">)</span>
				<span class="k">goto</span> <span class="n">len_error</span> <span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">set</span><span class="p">)</span>
				<span class="n">memcpy</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">to</span><span class="p">,(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">from</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="p">;</span>
			<span class="n">to</span> <span class="o">+=</span> <span class="mi">8</span> <span class="p">;</span>
			<span class="n">from</span> <span class="o">+=</span> <span class="mi">8</span> <span class="p">;</span>
			<span class="n">len</span> <span class="o">-=</span> <span class="mi">8</span> <span class="p">;</span>
			<span class="k">break</span> <span class="p">;</span>
		<span class="k">case</span> <span class="sc">&#39;4&#39;</span> :
			<span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">)</span>
				<span class="k">goto</span> <span class="n">len_error</span> <span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">set</span><span class="p">)</span>
				<span class="n">memcpy</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">to</span><span class="p">,(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">from</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="p">;</span>
			<span class="n">to</span> <span class="o">+=</span> <span class="mi">4</span> <span class="p">;</span>
			<span class="n">from</span> <span class="o">+=</span> <span class="mi">4</span> <span class="p">;</span>
			<span class="n">len</span> <span class="o">-=</span> <span class="mi">4</span> <span class="p">;</span>
			<span class="k">break</span> <span class="p">;</span>
		<span class="k">case</span> <span class="sc">&#39;8&#39;</span> :
			<span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">)</span>
				<span class="k">goto</span> <span class="n">len_error</span> <span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">set</span><span class="p">)</span>
				<span class="n">memcpy</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">to</span><span class="p">,(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">from</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span> <span class="p">;</span>
			<span class="n">to</span> <span class="o">+=</span> <span class="mi">8</span> <span class="p">;</span>
			<span class="n">from</span> <span class="o">+=</span> <span class="mi">8</span> <span class="p">;</span>
			<span class="n">len</span> <span class="o">-=</span> <span class="mi">8</span> <span class="p">;</span>
			<span class="k">break</span> <span class="p">;</span>
		<span class="k">case</span> <span class="sc">&#39;D&#39;</span> :
			<span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">)</span>
				<span class="k">goto</span> <span class="n">len_error</span> <span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">set</span><span class="p">)</span>
				<span class="n">memcpy</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">to</span><span class="p">,(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">from</span><span class="p">,</span><span class="mi">32</span><span class="p">)</span> <span class="p">;</span>
			<span class="n">to</span> <span class="o">+=</span> <span class="mi">32</span> <span class="p">;</span>
			<span class="n">from</span> <span class="o">+=</span> <span class="mi">32</span> <span class="p">;</span>
			<span class="n">len</span> <span class="o">-=</span> <span class="mi">32</span> <span class="p">;</span>
			<span class="k">break</span> <span class="p">;</span>
		<span class="k">case</span> <span class="sc">&#39;P&#39;</span> :		<span class="cm">/* timestamp is NOT swapped */</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">set</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">to</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
				<span class="n">to</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
				<span class="n">to</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
				<span class="n">to</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
				<span class="n">to</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
				<span class="n">to</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
				<span class="n">to</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
				<span class="n">to</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="o">++</span> <span class="p">;</span>
			<span class="p">}</span>
			<span class="n">to</span> <span class="o">+=</span> <span class="mi">8</span> <span class="p">;</span>
			<span class="n">len</span> <span class="o">-=</span> <span class="mi">8</span> <span class="p">;</span>
			<span class="k">break</span> <span class="p">;</span>
		<span class="k">default</span> <span class="o">:</span>
			<span class="n">SMT_PANIC</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="n">SMT_E0120</span><span class="p">,</span> <span class="n">SMT_E0120_MSG</span><span class="p">)</span> <span class="p">;</span>
			<span class="k">return</span> <span class="n">SMT_RDF_ILLEGAL</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="cm">/*</span>
<span class="cm">	 * actions and internal updates</span>
<span class="cm">	 */</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_type</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">SMT_P101A</span>:			<span class="cm">/* fddiSMTConfigPolicy */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">word_val</span> <span class="o">&amp;</span> <span class="o">~</span><span class="mi">1</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>
		<span class="n">IFSET</span><span class="p">(</span><span class="n">mib</span><span class="o">-&gt;</span><span class="n">fddiSMTConfigPolicy</span> <span class="o">=</span> <span class="n">word_val</span><span class="p">)</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P101B</span> :		<span class="cm">/* fddiSMTConnectionPolicy */</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">word_val</span> <span class="o">&amp;</span> <span class="n">POLICY_MM</span><span class="p">))</span>
			<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>
		<span class="n">IFSET</span><span class="p">(</span><span class="n">mib</span><span class="o">-&gt;</span><span class="n">fddiSMTConnectionPolicy</span> <span class="o">=</span> <span class="n">word_val</span><span class="p">)</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P101D</span> : 		<span class="cm">/* fddiSMTTT_Notify */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">word_val</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">||</span> <span class="n">word_val</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>
		<span class="n">IFSET</span><span class="p">(</span><span class="n">mib</span><span class="o">-&gt;</span><span class="n">fddiSMTTT_Notify</span> <span class="o">=</span> <span class="n">word_val</span><span class="p">)</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P101E</span> :		<span class="cm">/* fddiSMTStatRptPolicy */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">byte_val</span> <span class="o">&amp;</span> <span class="o">~</span><span class="mi">1</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>
		<span class="n">IFSET</span><span class="p">(</span><span class="n">mib</span><span class="o">-&gt;</span><span class="n">fddiSMTStatRptPolicy</span> <span class="o">=</span> <span class="n">byte_val</span><span class="p">)</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P101F</span> :		<span class="cm">/* fddiSMTTrace_MaxExpiration */</span>
		<span class="cm">/*</span>
<span class="cm">		 * note: lower limit trace_max = 6.001773... s</span>
<span class="cm">		 * NO upper limit</span>
<span class="cm">		 */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">long_val</span> <span class="o">&lt;</span> <span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="mh">0x478bf51L</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>
		<span class="n">IFSET</span><span class="p">(</span><span class="n">mib</span><span class="o">-&gt;</span><span class="n">fddiSMTTrace_MaxExpiration</span> <span class="o">=</span> <span class="n">long_val</span><span class="p">)</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
<span class="cp">#ifdef	ESS</span>
	<span class="k">case</span> <span class="n">SMT_P10F2</span> :		<span class="cm">/* fddiESSPayload */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">long_val</span> <span class="o">&gt;</span> <span class="mi">1562</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">set</span> <span class="o">&amp;&amp;</span> <span class="n">smc</span><span class="o">-&gt;</span><span class="n">mib</span><span class="p">.</span><span class="n">fddiESSPayload</span> <span class="o">!=</span> <span class="n">long_val</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">smc</span><span class="o">-&gt;</span><span class="n">ess</span><span class="p">.</span><span class="n">raf_act_timer_poll</span> <span class="o">=</span> <span class="n">TRUE</span> <span class="p">;</span>
			<span class="n">smc</span><span class="o">-&gt;</span><span class="n">mib</span><span class="p">.</span><span class="n">fddiESSPayload</span> <span class="o">=</span> <span class="n">long_val</span> <span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P10F3</span> :		<span class="cm">/* fddiESSOverhead */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">long_val</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="o">||</span> <span class="n">long_val</span> <span class="o">&gt;</span> <span class="mi">5000</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">set</span> <span class="o">&amp;&amp;</span> <span class="n">smc</span><span class="o">-&gt;</span><span class="n">mib</span><span class="p">.</span><span class="n">fddiESSPayload</span> <span class="o">&amp;&amp;</span>
			<span class="n">smc</span><span class="o">-&gt;</span><span class="n">mib</span><span class="p">.</span><span class="n">fddiESSOverhead</span> <span class="o">!=</span> <span class="n">long_val</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">smc</span><span class="o">-&gt;</span><span class="n">ess</span><span class="p">.</span><span class="n">raf_act_timer_poll</span> <span class="o">=</span> <span class="n">TRUE</span> <span class="p">;</span>
			<span class="n">smc</span><span class="o">-&gt;</span><span class="n">mib</span><span class="p">.</span><span class="n">fddiESSOverhead</span> <span class="o">=</span> <span class="n">long_val</span> <span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P10F4</span> :		<span class="cm">/* fddiESSMaxTNeg */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">long_val</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">MS2BCLK</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">||</span> <span class="n">long_val</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">MS2BCLK</span><span class="p">(</span><span class="mi">165</span><span class="p">))</span>
			<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>
		<span class="n">IFSET</span><span class="p">(</span><span class="n">mib</span><span class="o">-&gt;</span><span class="n">fddiESSMaxTNeg</span> <span class="o">=</span> <span class="n">long_val</span><span class="p">)</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P10F5</span> :		<span class="cm">/* fddiESSMinSegmentSize */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">long_val</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="o">||</span> <span class="n">long_val</span> <span class="o">&gt;</span> <span class="mi">4478</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>
		<span class="n">IFSET</span><span class="p">(</span><span class="n">mib</span><span class="o">-&gt;</span><span class="n">fddiESSMinSegmentSize</span> <span class="o">=</span> <span class="n">long_val</span><span class="p">)</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P10F6</span> :		<span class="cm">/* fddiESSCategory */</span>
		<span class="k">if</span> <span class="p">((</span><span class="n">long_val</span> <span class="o">&amp;</span> <span class="mh">0xffff</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>
		<span class="n">IFSET</span><span class="p">(</span><span class="n">mib</span><span class="o">-&gt;</span><span class="n">fddiESSCategory</span> <span class="o">=</span> <span class="n">long_val</span><span class="p">)</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P10F7</span> :		<span class="cm">/* fddiESSSyncTxMode */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">word_val</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>
		<span class="n">IFSET</span><span class="p">(</span><span class="n">mib</span><span class="o">-&gt;</span><span class="n">fddiESSSynchTxMode</span> <span class="o">=</span> <span class="n">word_val</span><span class="p">)</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef	SBA</span>
	<span class="k">case</span> <span class="n">SMT_P10F8</span> :		<span class="cm">/* fddiSBACommand */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">byte_val</span> <span class="o">!=</span> <span class="n">SB_STOP</span> <span class="o">&amp;&amp;</span> <span class="n">byte_val</span> <span class="o">!=</span> <span class="n">SB_START</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>
		<span class="n">IFSET</span><span class="p">(</span><span class="n">mib</span><span class="o">-&gt;</span><span class="n">fddiSBACommand</span> <span class="o">=</span> <span class="n">byte_val</span><span class="p">)</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P10F9</span> :		<span class="cm">/* fddiSBAAvailable */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">byte_val</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>
		<span class="n">IFSET</span><span class="p">(</span><span class="n">mib</span><span class="o">-&gt;</span><span class="n">fddiSBAAvailable</span> <span class="o">=</span> <span class="n">byte_val</span><span class="p">)</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
<span class="cp">#endif</span>
	<span class="k">case</span> <span class="n">SMT_P2020</span> :		<span class="cm">/* fddiMACRequestedPaths */</span>
		<span class="k">if</span> <span class="p">((</span><span class="n">word_val</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">MIB_P_PATH_PRIM_PREFER</span> <span class="o">|</span>
			<span class="n">MIB_P_PATH_PRIM_ALTER</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span>
			<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>
		<span class="n">IFSET</span><span class="p">(</span><span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACRequestedPaths</span> <span class="o">=</span> <span class="n">word_val</span><span class="p">)</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P205F</span> :		<span class="cm">/* fddiMACFrameErrorThreshold */</span>
		<span class="cm">/* 0 .. ffff acceptable */</span>
		<span class="n">IFSET</span><span class="p">(</span><span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACFrameErrorThreshold</span> <span class="o">=</span> <span class="n">word_val</span><span class="p">)</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P2067</span> :		<span class="cm">/* fddiMACNotCopiedThreshold */</span>
		<span class="cm">/* 0 .. ffff acceptable */</span>
		<span class="n">IFSET</span><span class="p">(</span><span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACNotCopiedThreshold</span> <span class="o">=</span> <span class="n">word_val</span><span class="p">)</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P2076</span>:			<span class="cm">/* fddiMACMA_UnitdataEnable */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">byte_val</span> <span class="o">&amp;</span> <span class="o">~</span><span class="mi">1</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">set</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACMA_UnitdataEnable</span> <span class="o">=</span> <span class="n">byte_val</span> <span class="p">;</span>
			<span class="n">queue_event</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="n">EVENT_RMT</span><span class="p">,</span><span class="n">RM_ENABLE_FLAG</span><span class="p">)</span> <span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P20F1</span> :		<span class="cm">/* fddiMACT_Min */</span>
		<span class="n">IFSET</span><span class="p">(</span><span class="n">mib_m</span><span class="o">-&gt;</span><span class="n">fddiMACT_Min</span> <span class="o">=</span> <span class="n">long_val</span><span class="p">)</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P320F</span> :
		<span class="k">if</span> <span class="p">(</span><span class="n">long_val</span> <span class="o">&gt;</span> <span class="mi">1562</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>
		<span class="n">IFSET</span><span class="p">(</span><span class="n">mib_a</span><span class="o">-&gt;</span><span class="n">fddiPATHSbaPayload</span> <span class="o">=</span> <span class="n">long_val</span><span class="p">)</span> <span class="p">;</span>
<span class="cp">#ifdef	ESS</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">set</span><span class="p">)</span>
			<span class="n">ess_para_change</span><span class="p">(</span><span class="n">smc</span><span class="p">)</span> <span class="p">;</span>
<span class="cp">#endif</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P3210</span> :
		<span class="k">if</span> <span class="p">(</span><span class="n">long_val</span> <span class="o">&gt;</span> <span class="mi">5000</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>
		
		<span class="k">if</span> <span class="p">(</span><span class="n">long_val</span> <span class="o">!=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">mib_a</span><span class="o">-&gt;</span><span class="n">fddiPATHSbaPayload</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>

		<span class="n">IFSET</span><span class="p">(</span><span class="n">mib_a</span><span class="o">-&gt;</span><span class="n">fddiPATHSbaOverhead</span> <span class="o">=</span> <span class="n">long_val</span><span class="p">)</span> <span class="p">;</span>
<span class="cp">#ifdef	ESS</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">set</span><span class="p">)</span>
			<span class="n">ess_para_change</span><span class="p">(</span><span class="n">smc</span><span class="p">)</span> <span class="p">;</span>
<span class="cp">#endif</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P3213</span>:			<span class="cm">/* fddiPATHT_Rmode */</span>
		<span class="cm">/* no limit :</span>
<span class="cm">		 * 0 .. 343.597 =&gt; 0 .. 2e32 * 80nS</span>
<span class="cm">		 */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">set</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">mib_a</span><span class="o">-&gt;</span><span class="n">fddiPATHT_Rmode</span> <span class="o">=</span> <span class="n">long_val</span> <span class="p">;</span>
			<span class="n">rtm_set_timer</span><span class="p">(</span><span class="n">smc</span><span class="p">)</span> <span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P3214</span> :		<span class="cm">/* fddiPATHSbaAvailable */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">long_val</span> <span class="o">&gt;</span> <span class="mh">0x00BEBC20L</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>
<span class="cp">#ifdef SBA </span>
		<span class="k">if</span> <span class="p">(</span><span class="n">set</span> <span class="o">&amp;&amp;</span> <span class="n">mib</span><span class="o">-&gt;</span><span class="n">fddiSBACommand</span> <span class="o">==</span> <span class="n">SB_STOP</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>
<span class="cp">#endif</span>
		<span class="n">IFSET</span><span class="p">(</span><span class="n">mib_a</span><span class="o">-&gt;</span><span class="n">fddiPATHSbaAvailable</span> <span class="o">=</span> <span class="n">long_val</span><span class="p">)</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P3215</span> :		<span class="cm">/* fddiPATHTVXLowerBound */</span>
		<span class="n">IFSET</span><span class="p">(</span><span class="n">mib_a</span><span class="o">-&gt;</span><span class="n">fddiPATHTVXLowerBound</span> <span class="o">=</span> <span class="n">long_val</span><span class="p">)</span> <span class="p">;</span>
		<span class="k">goto</span> <span class="n">change_mac_para</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P3216</span> :		<span class="cm">/* fddiPATHT_MaxLowerBound */</span>
		<span class="n">IFSET</span><span class="p">(</span><span class="n">mib_a</span><span class="o">-&gt;</span><span class="n">fddiPATHT_MaxLowerBound</span> <span class="o">=</span> <span class="n">long_val</span><span class="p">)</span> <span class="p">;</span>
		<span class="k">goto</span> <span class="n">change_mac_para</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P3217</span> :		<span class="cm">/* fddiPATHMaxT_Req */</span>
		<span class="n">IFSET</span><span class="p">(</span><span class="n">mib_a</span><span class="o">-&gt;</span><span class="n">fddiPATHMaxT_Req</span> <span class="o">=</span> <span class="n">long_val</span><span class="p">)</span> <span class="p">;</span>

<span class="nl">change_mac_para:</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">set</span> <span class="o">&amp;&amp;</span> <span class="n">smt_set_mac_opvalues</span><span class="p">(</span><span class="n">smc</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">RS_SET</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="n">RS_EVENT</span><span class="p">)</span> <span class="p">;</span>
			<span class="n">smc</span><span class="o">-&gt;</span><span class="n">sm</span><span class="p">.</span><span class="n">please_reconnect</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">;</span>
			<span class="n">queue_event</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="n">EVENT_ECM</span><span class="p">,</span><span class="n">EC_DISCONNECT</span><span class="p">)</span> <span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P400E</span> :		<span class="cm">/* fddiPORTConnectionPolicies */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">byte_val</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>
		<span class="n">IFSET</span><span class="p">(</span><span class="n">mib_p</span><span class="o">-&gt;</span><span class="n">fddiPORTConnectionPolicies</span> <span class="o">=</span> <span class="n">byte_val</span><span class="p">)</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P4011</span> :		<span class="cm">/* fddiPORTRequestedPaths */</span>
		<span class="cm">/* all 3*8 bits allowed */</span>
		<span class="n">IFSET</span><span class="p">(</span><span class="n">memcpy</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">mib_p</span><span class="o">-&gt;</span><span class="n">fddiPORTRequestedPaths</span><span class="p">,</span>
			<span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">long_val</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P401F</span>:			<span class="cm">/* fddiPORTMaint_LS */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">word_val</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>
		<span class="n">IFSET</span><span class="p">(</span><span class="n">mib_p</span><span class="o">-&gt;</span><span class="n">fddiPORTMaint_LS</span> <span class="o">=</span> <span class="n">word_val</span><span class="p">)</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P403A</span> :		<span class="cm">/* fddiPORTLer_Cutoff */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">byte_val</span> <span class="o">&lt;</span> <span class="mi">4</span> <span class="o">||</span> <span class="n">byte_val</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>
		<span class="n">IFSET</span><span class="p">(</span><span class="n">mib_p</span><span class="o">-&gt;</span><span class="n">fddiPORTLer_Cutoff</span> <span class="o">=</span> <span class="n">byte_val</span><span class="p">)</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P403B</span> :		<span class="cm">/* fddiPORTLer_Alarm */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">byte_val</span> <span class="o">&lt;</span> <span class="mi">4</span> <span class="o">||</span> <span class="n">byte_val</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>
		<span class="n">IFSET</span><span class="p">(</span><span class="n">mib_p</span><span class="o">-&gt;</span><span class="n">fddiPORTLer_Alarm</span> <span class="o">=</span> <span class="n">byte_val</span><span class="p">)</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>

	<span class="cm">/*</span>
<span class="cm">	 * Actions</span>
<span class="cm">	 */</span>
	<span class="k">case</span> <span class="n">SMT_P103C</span> :		<span class="cm">/* fddiSMTStationAction */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">smt_action</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="n">SMT_STATION_ACTION</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">word_val</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
			<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">case</span> <span class="n">SMT_P4046</span>:			<span class="cm">/* fddiPORTAction */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">smt_action</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="n">SMT_PORT_ACTION</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">word_val</span><span class="p">,</span>
			<span class="n">port_to_mib</span><span class="p">(</span><span class="n">smc</span><span class="p">,</span><span class="n">port</span><span class="p">)))</span>
			<span class="k">goto</span> <span class="n">val_error</span> <span class="p">;</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="k">default</span> <span class="o">:</span>
		<span class="k">break</span> <span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

<span class="nl">val_error:</span>
	<span class="cm">/* parameter value in frame is out of range */</span>
	<span class="k">return</span> <span class="n">SMT_RDF_RANGE</span><span class="p">;</span>

<span class="nl">len_error:</span>
	<span class="cm">/* parameter value in frame is too short */</span>
	<span class="k">return</span> <span class="n">SMT_RDF_LENGTH</span><span class="p">;</span>

<span class="cp">#if	0</span><span class="c"></span>
<span class="c">no_author_error:</span>
<span class="c">	/* parameter not setable, because the SBA is not active</span>
<span class="c">	 * Please note: we give the return code &#39;not authorizeed</span>
<span class="c">	 *  because SBA denied is not a valid return code in the</span>
<span class="c">	 * PMF protocol.</span>
<span class="c">	 */</span>
<span class="c">	return SMT_RDF_AUTHOR;</span>
<span class="cp">#endif</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">s_p_tab</span> <span class="o">*</span><span class="nf">smt_get_ptab</span><span class="p">(</span><span class="n">u_short</span> <span class="n">para</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">s_p_tab</span>	<span class="o">*</span><span class="n">pt</span> <span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">pt</span> <span class="o">=</span> <span class="n">p_tab</span> <span class="p">;</span> <span class="n">pt</span><span class="o">-&gt;</span><span class="n">p_num</span> <span class="o">&amp;&amp;</span> <span class="n">pt</span><span class="o">-&gt;</span><span class="n">p_num</span> <span class="o">!=</span> <span class="n">para</span> <span class="p">;</span> <span class="n">pt</span><span class="o">++</span><span class="p">)</span>
		<span class="p">;</span>
	<span class="k">return</span> <span class="n">pt</span><span class="o">-&gt;</span><span class="n">p_num</span> <span class="o">?</span> <span class="n">pt</span> <span class="o">:</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">smt_mib_phys</span><span class="p">(</span><span class="k">struct</span> <span class="n">s_smc</span> <span class="o">*</span><span class="n">smc</span><span class="p">)</span>
<span class="p">{</span>
<span class="cp">#ifdef	CONCENTRATOR</span>
	<span class="n">SK_UNUSED</span><span class="p">(</span><span class="n">smc</span><span class="p">)</span> <span class="p">;</span>

	<span class="k">return</span> <span class="n">NUMPHYS</span><span class="p">;</span>
<span class="cp">#else</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">smc</span><span class="o">-&gt;</span><span class="n">s</span><span class="p">.</span><span class="n">sas</span> <span class="o">==</span> <span class="n">SMT_SAS</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">NUMPHYS</span><span class="p">;</span>
<span class="cp">#endif</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">port_to_mib</span><span class="p">(</span><span class="k">struct</span> <span class="n">s_smc</span> <span class="o">*</span><span class="n">smc</span><span class="p">,</span> <span class="kt">int</span> <span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="cp">#ifdef	CONCENTRATOR</span>
	<span class="n">SK_UNUSED</span><span class="p">(</span><span class="n">smc</span><span class="p">)</span> <span class="p">;</span>

	<span class="k">return</span> <span class="n">p</span><span class="p">;</span>
<span class="cp">#else</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">smc</span><span class="o">-&gt;</span><span class="n">s</span><span class="p">.</span><span class="n">sas</span> <span class="o">==</span> <span class="n">SMT_SAS</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">PS</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">p</span><span class="p">;</span>
<span class="cp">#endif</span>
<span class="p">}</span>


<span class="cp">#ifdef	DEBUG</span>
<span class="cp">#ifndef	BOOT</span>
<span class="kt">void</span> <span class="nf">dump_smt</span><span class="p">(</span><span class="k">struct</span> <span class="n">s_smc</span> <span class="o">*</span><span class="n">smc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">smt_header</span> <span class="o">*</span><span class="n">sm</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">text</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span>	<span class="n">len</span> <span class="p">;</span>
	<span class="k">struct</span> <span class="n">smt_para</span>	<span class="o">*</span><span class="n">pa</span> <span class="p">;</span>
	<span class="kt">char</span>	<span class="o">*</span><span class="n">c</span> <span class="p">;</span>
	<span class="kt">int</span>	<span class="n">n</span> <span class="p">;</span>
	<span class="kt">int</span>	<span class="n">nn</span> <span class="p">;</span>
<span class="cp">#ifdef	LITTLE_ENDIAN</span>
	<span class="kt">int</span>	<span class="n">smtlen</span> <span class="p">;</span>
<span class="cp">#endif</span>

	<span class="n">SK_UNUSED</span><span class="p">(</span><span class="n">smc</span><span class="p">)</span> <span class="p">;</span>

<span class="cp">#ifdef	DEBUG_BRD</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">smc</span><span class="o">-&gt;</span><span class="n">debug</span><span class="p">.</span><span class="n">d_smtf</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span>
<span class="cp">#else</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">debug</span><span class="p">.</span><span class="n">d_smtf</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span>
<span class="cp">#endif</span>
		<span class="k">return</span> <span class="p">;</span>
<span class="cp">#ifdef	LITTLE_ENDIAN</span>
	<span class="n">smtlen</span> <span class="o">=</span> <span class="n">sm</span><span class="o">-&gt;</span><span class="n">smt_len</span> <span class="o">+</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">smt_header</span><span class="p">)</span> <span class="p">;</span>
<span class="cp">#endif</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;SMT Frame [%s]:</span><span class="se">\n</span><span class="s">DA  &quot;</span><span class="p">,</span><span class="n">text</span><span class="p">)</span> <span class="p">;</span>
	<span class="n">dump_hex</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">sm</span><span class="o">-&gt;</span><span class="n">smt_dest</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="p">;</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">SA &quot;</span><span class="p">)</span> <span class="p">;</span>
	<span class="n">dump_hex</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">sm</span><span class="o">-&gt;</span><span class="n">smt_source</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="p">;</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot; Class %x Type %x Version %x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
		<span class="n">sm</span><span class="o">-&gt;</span><span class="n">smt_class</span><span class="p">,</span><span class="n">sm</span><span class="o">-&gt;</span><span class="n">smt_type</span><span class="p">,</span><span class="n">sm</span><span class="o">-&gt;</span><span class="n">smt_version</span><span class="p">)</span>  <span class="p">;</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;TID %lx</span><span class="se">\t\t</span><span class="s">SID &quot;</span><span class="p">,</span><span class="n">sm</span><span class="o">-&gt;</span><span class="n">smt_tid</span><span class="p">)</span> <span class="p">;</span>
	<span class="n">dump_hex</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">sm</span><span class="o">-&gt;</span><span class="n">smt_sid</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span> <span class="p">;</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot; LEN %x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">sm</span><span class="o">-&gt;</span><span class="n">smt_len</span><span class="p">)</span> <span class="p">;</span>

	<span class="n">len</span> <span class="o">=</span> <span class="n">sm</span><span class="o">-&gt;</span><span class="n">smt_len</span> <span class="p">;</span>
	<span class="n">pa</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">smt_para</span> <span class="o">*</span><span class="p">)</span> <span class="p">(</span><span class="n">sm</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">;</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">len</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span>
		<span class="kt">int</span>	<span class="n">plen</span> <span class="p">;</span>
<span class="cp">#ifdef UNIX</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;TYPE %x LEN %x VALUE</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">,</span><span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_type</span><span class="p">,</span><span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_len</span><span class="p">)</span> <span class="p">;</span>
<span class="cp">#else</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;TYPE %04x LEN %2x VALUE</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">,</span><span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_type</span><span class="p">,</span><span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_len</span><span class="p">)</span> <span class="p">;</span>
<span class="cp">#endif</span>
		<span class="n">n</span> <span class="o">=</span> <span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_len</span> <span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="n">len</span> <span class="o">-</span> <span class="n">PARA_LEN</span><span class="p">)))</span> <span class="p">{</span>
			<span class="n">n</span> <span class="o">=</span> <span class="n">len</span> <span class="o">-</span> <span class="n">PARA_LEN</span> <span class="p">;</span>
			<span class="n">printf</span><span class="p">(</span><span class="s">&quot; BAD LENGTH</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span> <span class="p">;</span>
			<span class="k">break</span> <span class="p">;</span>
		<span class="p">}</span>
<span class="cp">#ifdef	LITTLE_ENDIAN</span>
		<span class="n">smt_swap_para</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span><span class="n">smtlen</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">;</span>
<span class="cp">#endif</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">dump_hex</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)(</span><span class="n">pa</span><span class="o">+</span><span class="mi">1</span><span class="p">),(</span><span class="kt">int</span><span class="p">)</span> <span class="n">n</span><span class="p">)</span> <span class="p">;</span>
			<span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span> <span class="p">;</span>
		<span class="p">}</span>
		<span class="k">else</span> <span class="p">{</span>
			<span class="kt">int</span>	<span class="n">first</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>
			<span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)(</span><span class="n">pa</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span>
			<span class="n">dump_hex</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span> <span class="p">;</span>
			<span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span> <span class="p">;</span>
			<span class="n">n</span> <span class="o">-=</span> <span class="mi">16</span> <span class="p">;</span>
			<span class="n">c</span> <span class="o">+=</span> <span class="mi">16</span> <span class="p">;</span>
			<span class="k">while</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">nn</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">?</span> <span class="mi">16</span> <span class="o">:</span> <span class="n">n</span> <span class="p">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">64</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">first</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
						<span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t\t\t</span><span class="s">...</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span> <span class="p">;</span>
					<span class="n">first</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">;</span>
				<span class="p">}</span>
				<span class="k">else</span> <span class="p">{</span>
					<span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t\t\t</span><span class="s">&quot;</span><span class="p">)</span> <span class="p">;</span>
					<span class="n">dump_hex</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">nn</span><span class="p">)</span> <span class="p">;</span>
					<span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span> <span class="p">;</span>
				<span class="p">}</span>
				<span class="n">n</span> <span class="o">-=</span> <span class="n">nn</span> <span class="p">;</span>
				<span class="n">c</span> <span class="o">+=</span> <span class="mi">16</span> <span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
<span class="cp">#ifdef	LITTLE_ENDIAN</span>
		<span class="n">smt_swap_para</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span><span class="n">smtlen</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span>
<span class="cp">#endif</span>
		<span class="n">plen</span> <span class="o">=</span> <span class="p">(</span><span class="n">pa</span><span class="o">-&gt;</span><span class="n">p_len</span> <span class="o">+</span> <span class="n">PARA_LEN</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="mi">3</span> <span class="p">;</span>
		<span class="n">len</span> <span class="o">-=</span> <span class="n">plen</span> <span class="p">;</span>
		<span class="n">pa</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">smt_para</span> <span class="o">*</span><span class="p">)((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">pa</span> <span class="o">+</span> <span class="n">plen</span><span class="p">)</span> <span class="p">;</span>
	<span class="p">}</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;-------------------------------------------------</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">)</span> <span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">dump_hex</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">p</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span>	<span class="n">n</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">len</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">n</span><span class="o">++</span> <span class="p">;</span>
<span class="cp">#ifdef UNIX</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%x%s&quot;</span><span class="p">,</span><span class="o">*</span><span class="n">p</span><span class="o">++</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">,</span><span class="n">len</span> <span class="o">?</span> <span class="p">(</span> <span class="p">(</span><span class="n">n</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot; &quot;</span> <span class="o">:</span> <span class="s">&quot;-&quot;</span><span class="p">)</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">;</span>
<span class="cp">#else</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%02x%s&quot;</span><span class="p">,</span><span class="o">*</span><span class="n">p</span><span class="o">++</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">,</span><span class="n">len</span> <span class="o">?</span> <span class="p">(</span> <span class="p">(</span><span class="n">n</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot; &quot;</span> <span class="o">:</span> <span class="s">&quot;-&quot;</span><span class="p">)</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">;</span>
<span class="cp">#endif</span>
	<span class="p">}</span>
<span class="p">}</span>
<span class="cp">#endif	</span><span class="cm">/* no BOOT */</span><span class="cp"></span>
<span class="cp">#endif	</span><span class="cm">/* DEBUG */</span><span class="cp"></span>


<span class="cp">#endif	</span><span class="cm">/* no SLIM_SMT */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
