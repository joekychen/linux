<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › net › usb › cdc_subset.c

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>cdc_subset.c</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Simple &quot;CDC Subset&quot; USB Networking Links</span>
<span class="cm"> * Copyright (C) 2000-2005 by David Brownell</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> * it under the terms of the GNU General Public License as published by</span>
<span class="cm"> * the Free Software Foundation; either version 2 of the License, or</span>
<span class="cm"> * (at your option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful,</span>
<span class="cm"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm"> * GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License</span>
<span class="cm"> * along with this program; if not, write to the Free Software</span>
<span class="cm"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
<span class="cm"> */</span>

<span class="cp">#include &lt;linux/module.h&gt;</span>
<span class="cp">#include &lt;linux/kmod.h&gt;</span>
<span class="cp">#include &lt;linux/init.h&gt;</span>
<span class="cp">#include &lt;linux/netdevice.h&gt;</span>
<span class="cp">#include &lt;linux/etherdevice.h&gt;</span>
<span class="cp">#include &lt;linux/ethtool.h&gt;</span>
<span class="cp">#include &lt;linux/workqueue.h&gt;</span>
<span class="cp">#include &lt;linux/mii.h&gt;</span>
<span class="cp">#include &lt;linux/usb.h&gt;</span>
<span class="cp">#include &lt;linux/usb/usbnet.h&gt;</span>


<span class="cm">/*</span>
<span class="cm"> * This supports simple USB network links that don&#39;t require any special</span>
<span class="cm"> * framing or hardware control operations.  The protocol used here is a</span>
<span class="cm"> * strict subset of CDC Ethernet, with three basic differences reflecting</span>
<span class="cm"> * the goal that almost any hardware should run it:</span>
<span class="cm"> *</span>
<span class="cm"> *  - Minimal runtime control:  one interface, no altsettings, and</span>
<span class="cm"> *    no vendor or class specific control requests.  If a device is</span>
<span class="cm"> *    configured, it is allowed to exchange packets with the host.</span>
<span class="cm"> *    Fancier models would mean not working on some hardware.</span>
<span class="cm"> *</span>
<span class="cm"> *  - Minimal manufacturing control:  no IEEE &quot;Organizationally</span>
<span class="cm"> *    Unique ID&quot; required, or an EEPROMs to store one.  Each host uses</span>
<span class="cm"> *    one random &quot;locally assigned&quot; Ethernet address instead, which can</span>
<span class="cm"> *    of course be overridden using standard tools like &quot;ifconfig&quot;.</span>
<span class="cm"> *    (With 2^46 such addresses, same-net collisions are quite rare.)</span>
<span class="cm"> *</span>
<span class="cm"> *  - There is no additional framing data for USB.  Packets are written</span>
<span class="cm"> *    exactly as in CDC Ethernet, starting with an Ethernet header and</span>
<span class="cm"> *    terminated by a short packet.  However, the host will never send a</span>
<span class="cm"> *    zero length packet; some systems can&#39;t handle those robustly.</span>
<span class="cm"> *</span>
<span class="cm"> * Anything that can transmit and receive USB bulk packets can implement</span>
<span class="cm"> * this protocol.  That includes both smart peripherals and quite a lot</span>
<span class="cm"> * of &quot;host-to-host&quot; USB cables (which embed two devices back-to-back).</span>
<span class="cm"> *</span>
<span class="cm"> * Note that although Linux may use many of those host-to-host links</span>
<span class="cm"> * with this &quot;cdc_subset&quot; framing, that doesn&#39;t mean there may not be a</span>
<span class="cm"> * better approach.  Handling the &quot;other end unplugs/replugs&quot; scenario</span>
<span class="cm"> * well tends to require chip-specific vendor requests.  Also, Windows</span>
<span class="cm"> * peers at the other end of host-to-host cables may expect their own</span>
<span class="cm"> * framing to be used rather than this &quot;cdc_subset&quot; model.</span>
<span class="cm"> */</span>

<span class="cp">#if defined(CONFIG_USB_EPSON2888) || defined(CONFIG_USB_ARMLINUX)</span>
<span class="cm">/* PDA style devices are always connected if present */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">always_connected</span> <span class="p">(</span><span class="k">struct</span> <span class="n">usbnet</span> <span class="o">*</span><span class="n">dev</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef	CONFIG_USB_ALI_M5632</span>
<span class="cp">#define	HAVE_HARDWARE</span>

<span class="cm">/*-------------------------------------------------------------------------</span>
<span class="cm"> *</span>
<span class="cm"> * ALi M5632 driver ... does high speed</span>
<span class="cm"> *</span>
<span class="cm"> * NOTE that the MS-Windows drivers for this chip use some funky and</span>
<span class="cm"> * (naturally) undocumented 7-byte prefix to each packet, so this is a</span>
<span class="cm"> * case where we don&#39;t currently interoperate.  Also, once you unplug</span>
<span class="cm"> * one end of the cable, you need to replug the other end too ... since</span>
<span class="cm"> * chip docs are unavailable, there&#39;s no way to reset the relevant state</span>
<span class="cm"> * short of a power cycle.</span>
<span class="cm"> *</span>
<span class="cm"> *-------------------------------------------------------------------------*/</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">driver_info</span>	<span class="n">ali_m5632_info</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">description</span> <span class="o">=</span>	<span class="s">&quot;ALi M5632&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">flags</span>       <span class="o">=</span> <span class="n">FLAG_POINTTOPOINT</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#endif</span>


<span class="cp">#ifdef	CONFIG_USB_AN2720</span>
<span class="cp">#define	HAVE_HARDWARE</span>

<span class="cm">/*-------------------------------------------------------------------------</span>
<span class="cm"> *</span>
<span class="cm"> * AnchorChips 2720 driver ... http://www.cypress.com</span>
<span class="cm"> *</span>
<span class="cm"> * This doesn&#39;t seem to have a way to detect whether the peer is</span>
<span class="cm"> * connected, or need any reset handshaking.  It&#39;s got pretty big</span>
<span class="cm"> * internal buffers (handles most of a frame&#39;s worth of data).</span>
<span class="cm"> * Chip data sheets don&#39;t describe any vendor control messages.</span>
<span class="cm"> *</span>
<span class="cm"> *-------------------------------------------------------------------------*/</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">driver_info</span>	<span class="n">an2720_info</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">description</span> <span class="o">=</span>	<span class="s">&quot;AnchorChips/Cypress 2720&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">flags</span>       <span class="o">=</span> <span class="n">FLAG_POINTTOPOINT</span><span class="p">,</span></pre></div></td></tr>


<tr id="section-2"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-2">&#182;</a></div><p>no reset available!
no check_connect available!</p></td><td class="code"><div class="highlight"><pre>	<span class="p">.</span><span class="n">in</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="p">.</span><span class="n">out</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>		<span class="c1">// direction distinguishes these</span>
<span class="p">};</span>

<span class="cp">#endif	</span><span class="cm">/* CONFIG_USB_AN2720 */</span><span class="cp"></span>


<span class="cp">#ifdef	CONFIG_USB_BELKIN</span>
<span class="cp">#define	HAVE_HARDWARE</span>

<span class="cm">/*-------------------------------------------------------------------------</span>
<span class="cm"> *</span>
<span class="cm"> * Belkin F5U104 ... two NetChip 2280 devices + Atmel AVR microcontroller</span>
<span class="cm"> *</span>
<span class="cm"> * ... also two eTEK designs, including one sold as &quot;Advance USBNET&quot;</span>
<span class="cm"> *</span>
<span class="cm"> *-------------------------------------------------------------------------*/</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">driver_info</span>	<span class="n">belkin_info</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">description</span> <span class="o">=</span>	<span class="s">&quot;Belkin, eTEK, or compatible&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">flags</span>       <span class="o">=</span> <span class="n">FLAG_POINTTOPOINT</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#endif	</span><span class="cm">/* CONFIG_USB_BELKIN */</span><span class="cp"></span>



<span class="cp">#ifdef	CONFIG_USB_EPSON2888</span>
<span class="cp">#define	HAVE_HARDWARE</span>

<span class="cm">/*-------------------------------------------------------------------------</span>
<span class="cm"> *</span>
<span class="cm"> * EPSON USB clients</span>
<span class="cm"> *</span>
<span class="cm"> * This is the same idea as Linux PDAs (below) except the firmware in the</span>
<span class="cm"> * device might not be Tux-powered.  Epson provides reference firmware that</span>
<span class="cm"> * implements this interface.  Product developers can reuse or modify that</span>
<span class="cm"> * code, such as by using their own product and vendor codes.</span>
<span class="cm"> *</span>
<span class="cm"> * Support was from Juro Bystricky &lt;bystricky.juro@erd.epson.com&gt;</span>
<span class="cm"> *</span>
<span class="cm"> *-------------------------------------------------------------------------*/</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">driver_info</span>	<span class="n">epson2888_info</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">description</span> <span class="o">=</span>	<span class="s">&quot;Epson USB Device&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">check_connect</span> <span class="o">=</span> <span class="n">always_connected</span><span class="p">,</span>
	<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">FLAG_POINTTOPOINT</span><span class="p">,</span>

	<span class="p">.</span><span class="n">in</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="p">.</span><span class="n">out</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#endif	</span><span class="cm">/* CONFIG_USB_EPSON2888 */</span><span class="cp"></span>


<span class="cm">/*-------------------------------------------------------------------------</span>
<span class="cm"> *</span>
<span class="cm"> * info from Jonathan McDowell &lt;noodles@earth.li&gt;</span>
<span class="cm"> *</span>
<span class="cm"> *-------------------------------------------------------------------------*/</span>
<span class="cp">#ifdef CONFIG_USB_KC2190</span>
<span class="cp">#define HAVE_HARDWARE</span>
<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">driver_info</span> <span class="n">kc2190_info</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">description</span> <span class="o">=</span>  <span class="s">&quot;KC Technology KC-190&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">FLAG_POINTTOPOINT</span><span class="p">,</span>
<span class="p">};</span>
<span class="cp">#endif </span><span class="cm">/* CONFIG_USB_KC2190 */</span><span class="cp"></span>


<span class="cp">#ifdef	CONFIG_USB_ARMLINUX</span>
<span class="cp">#define	HAVE_HARDWARE</span>

<span class="cm">/*-------------------------------------------------------------------------</span>
<span class="cm"> *</span>
<span class="cm"> * Intel&#39;s SA-1100 chip integrates basic USB support, and is used</span>
<span class="cm"> * in PDAs like some iPaqs, the Yopy, some Zaurus models, and more.</span>
<span class="cm"> * When they run Linux, arch/arm/mach-sa1100/usb-eth.c may be used to</span>
<span class="cm"> * network using minimal USB framing data.</span>
<span class="cm"> *</span>
<span class="cm"> * This describes the driver currently in standard ARM Linux kernels.</span>
<span class="cm"> * The Zaurus uses a different driver (see later).</span>
<span class="cm"> *</span>
<span class="cm"> * PXA25x and PXA210 use XScale cores (ARM v5TE) with better USB support</span>
<span class="cm"> * and different USB endpoint numbering than the SA1100 devices.  The</span>
<span class="cm"> * mach-pxa/usb-eth.c driver re-uses the device ids from mach-sa1100</span>
<span class="cm"> * so we rely on the endpoint descriptors.</span>
<span class="cm"> *</span>
<span class="cm"> *-------------------------------------------------------------------------*/</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">driver_info</span>	<span class="n">linuxdev_info</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">description</span> <span class="o">=</span>	<span class="s">&quot;Linux Device&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">check_connect</span> <span class="o">=</span> <span class="n">always_connected</span><span class="p">,</span>
	<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">FLAG_POINTTOPOINT</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">driver_info</span>	<span class="n">yopy_info</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">description</span> <span class="o">=</span>	<span class="s">&quot;Yopy&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">check_connect</span> <span class="o">=</span> <span class="n">always_connected</span><span class="p">,</span>
	<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">FLAG_POINTTOPOINT</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">driver_info</span>	<span class="n">blob_info</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">description</span> <span class="o">=</span>	<span class="s">&quot;Boot Loader OBject&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">check_connect</span> <span class="o">=</span> <span class="n">always_connected</span><span class="p">,</span>
	<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">FLAG_POINTTOPOINT</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#endif	</span><span class="cm">/* CONFIG_USB_ARMLINUX */</span><span class="cp"></span>


<span class="cm">/*-------------------------------------------------------------------------*/</span>

<span class="cp">#ifndef	HAVE_HARDWARE</span>
<span class="cp">#warning You need to configure some hardware for this driver</span>
<span class="cp">#endif</span>

<span class="cm">/*</span>
<span class="cm"> * chip vendor names won&#39;t normally be on the cables, and</span>
<span class="cm"> * may not be on the device.</span>
<span class="cm"> */</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">usb_device_id</span>	<span class="n">products</span> <span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>

<span class="cp">#ifdef	CONFIG_USB_ALI_M5632</span>
<span class="p">{</span>
	<span class="n">USB_DEVICE</span> <span class="p">(</span><span class="mh">0x0402</span><span class="p">,</span> <span class="mh">0x5632</span><span class="p">),</span>	<span class="c1">// ALi defaults</span>
	<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span>	<span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">ali_m5632_info</span><span class="p">,</span>
<span class="p">},</span>
<span class="p">{</span>
	<span class="n">USB_DEVICE</span> <span class="p">(</span><span class="mh">0x182d</span><span class="p">,</span><span class="mh">0x207c</span><span class="p">),</span>	<span class="c1">// SiteCom CN-124</span>
	<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span>	<span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">ali_m5632_info</span><span class="p">,</span>
<span class="p">},</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef	CONFIG_USB_AN2720</span>
<span class="p">{</span>
	<span class="n">USB_DEVICE</span> <span class="p">(</span><span class="mh">0x0547</span><span class="p">,</span> <span class="mh">0x2720</span><span class="p">),</span>	<span class="c1">// AnchorChips defaults</span>
	<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span>	<span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">an2720_info</span><span class="p">,</span>
<span class="p">},</span> <span class="p">{</span>
	<span class="n">USB_DEVICE</span> <span class="p">(</span><span class="mh">0x0547</span><span class="p">,</span> <span class="mh">0x2727</span><span class="p">),</span>	<span class="c1">// Xircom PGUNET</span>
	<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span>	<span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">an2720_info</span><span class="p">,</span>
<span class="p">},</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef	CONFIG_USB_BELKIN</span>
<span class="p">{</span>
	<span class="n">USB_DEVICE</span> <span class="p">(</span><span class="mh">0x050d</span><span class="p">,</span> <span class="mh">0x0004</span><span class="p">),</span>	<span class="c1">// Belkin</span>
	<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span>	<span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">belkin_info</span><span class="p">,</span>
<span class="p">},</span> <span class="p">{</span>
	<span class="n">USB_DEVICE</span> <span class="p">(</span><span class="mh">0x056c</span><span class="p">,</span> <span class="mh">0x8100</span><span class="p">),</span>	<span class="c1">// eTEK</span>
	<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span>	<span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">belkin_info</span><span class="p">,</span>
<span class="p">},</span> <span class="p">{</span>
	<span class="n">USB_DEVICE</span> <span class="p">(</span><span class="mh">0x0525</span><span class="p">,</span> <span class="mh">0x9901</span><span class="p">),</span>	<span class="c1">// Advance USBNET (eTEK)</span>
	<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span>	<span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">belkin_info</span><span class="p">,</span>
<span class="p">},</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef	CONFIG_USB_EPSON2888</span>
<span class="p">{</span>
	<span class="n">USB_DEVICE</span> <span class="p">(</span><span class="mh">0x0525</span><span class="p">,</span> <span class="mh">0x2888</span><span class="p">),</span>	<span class="c1">// EPSON USB client</span>
	<span class="p">.</span><span class="n">driver_info</span>	<span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">epson2888_info</span><span class="p">,</span>
<span class="p">},</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef CONFIG_USB_KC2190</span>
<span class="p">{</span>
	<span class="n">USB_DEVICE</span> <span class="p">(</span><span class="mh">0x050f</span><span class="p">,</span> <span class="mh">0x0190</span><span class="p">),</span>	<span class="c1">// KC-190</span>
	<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span>	<span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">kc2190_info</span><span class="p">,</span>
<span class="p">},</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef	CONFIG_USB_ARMLINUX</span>
<span class="cm">/*</span>
<span class="cm"> * SA-1100 using standard ARM Linux kernels, or compatible.</span>
<span class="cm"> * Often used when talking to Linux PDAs (iPaq, Yopy, etc).</span>
<span class="cm"> * The sa-1100 &quot;usb-eth&quot; driver handles the basic framing.</span>
<span class="cm"> *</span>
<span class="cm"> * PXA25x or PXA210 ...  these use a &quot;usb-eth&quot; driver much like</span>
<span class="cm"> * the sa1100 one, but hardware uses different endpoint numbers.</span>
<span class="cm"> *</span>
<span class="cm"> * Or the Linux &quot;Ethernet&quot; gadget on hardware that can&#39;t talk</span>
<span class="cm"> * CDC Ethernet (e.g., no altsettings), in either of two modes:</span>
<span class="cm"> *  - acting just like the old &quot;usb-eth&quot; firmware, though</span>
<span class="cm"> *    the implementation is different</span>
<span class="cm"> *  - supporting RNDIS as the first/default configuration for</span>
<span class="cm"> *    MS-Windows interop; Linux needs to use the other config</span>
<span class="cm"> */</span>
<span class="p">{</span></pre></div></td></tr>


<tr id="section-3"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-3">&#182;</a></div><p>1183 = 0x049F, both used as hex values?
Compaq "Itsy" vendor/product id</p></td><td class="code"><div class="highlight"><pre>	<span class="n">USB_DEVICE</span> <span class="p">(</span><span class="mh">0x049F</span><span class="p">,</span> <span class="mh">0x505A</span><span class="p">),</span>	<span class="c1">// usb-eth, or compatible</span>
	<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span>	<span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">linuxdev_info</span><span class="p">,</span>
<span class="p">},</span> <span class="p">{</span>
	<span class="n">USB_DEVICE</span> <span class="p">(</span><span class="mh">0x0E7E</span><span class="p">,</span> <span class="mh">0x1001</span><span class="p">),</span>	<span class="c1">// G.Mate &quot;Yopy&quot;</span>
	<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span>	<span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">yopy_info</span><span class="p">,</span>
<span class="p">},</span> <span class="p">{</span>
	<span class="n">USB_DEVICE</span> <span class="p">(</span><span class="mh">0x8086</span><span class="p">,</span> <span class="mh">0x07d3</span><span class="p">),</span>	<span class="c1">// &quot;blob&quot; bootloader</span>
	<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span>	<span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">blob_info</span><span class="p">,</span>
<span class="p">},</span> <span class="p">{</span>
	<span class="n">USB_DEVICE</span> <span class="p">(</span><span class="mh">0x1286</span><span class="p">,</span> <span class="mh">0x8001</span><span class="p">),</span>    <span class="c1">// &quot;blob&quot; bootloader</span>
	<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span>  <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">blob_info</span><span class="p">,</span>
<span class="p">},</span> <span class="p">{</span></pre></div></td></tr>


<tr id="section-4"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-4">&#182;</a></div><p>Linux Ethernet/RNDIS gadget, mostly on PXA, second config
e.g. Gumstix, current OpenZaurus, ... or anything else
that just enables this gadget option.</p></td><td class="code"><div class="highlight"><pre>	<span class="n">USB_DEVICE</span> <span class="p">(</span><span class="mh">0x0525</span><span class="p">,</span> <span class="mh">0xa4a2</span><span class="p">),</span>
	<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span>	<span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">linuxdev_info</span><span class="p">,</span>
<span class="p">},</span>
<span class="cp">#endif</span>

	<span class="p">{</span> <span class="p">},</span>		<span class="c1">// END</span>
<span class="p">};</span>
<span class="n">MODULE_DEVICE_TABLE</span><span class="p">(</span><span class="n">usb</span><span class="p">,</span> <span class="n">products</span><span class="p">);</span>

<span class="cm">/*-------------------------------------------------------------------------*/</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">usb_driver</span> <span class="n">cdc_subset_driver</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span>		<span class="s">&quot;cdc_subset&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">probe</span> <span class="o">=</span>	<span class="n">usbnet_probe</span><span class="p">,</span>
	<span class="p">.</span><span class="n">suspend</span> <span class="o">=</span>	<span class="n">usbnet_suspend</span><span class="p">,</span>
	<span class="p">.</span><span class="n">resume</span> <span class="o">=</span>	<span class="n">usbnet_resume</span><span class="p">,</span>
	<span class="p">.</span><span class="n">disconnect</span> <span class="o">=</span>	<span class="n">usbnet_disconnect</span><span class="p">,</span>
	<span class="p">.</span><span class="n">id_table</span> <span class="o">=</span>	<span class="n">products</span><span class="p">,</span>
	<span class="p">.</span><span class="n">disable_hub_initiated_lpm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">};</span>

<span class="n">module_usb_driver</span><span class="p">(</span><span class="n">cdc_subset_driver</span><span class="p">);</span>

<span class="n">MODULE_AUTHOR</span><span class="p">(</span><span class="s">&quot;David Brownell&quot;</span><span class="p">);</span>
<span class="n">MODULE_DESCRIPTION</span><span class="p">(</span><span class="s">&quot;Simple &#39;CDC Subset&#39; USB networking links&quot;</span><span class="p">);</span>
<span class="n">MODULE_LICENSE</span><span class="p">(</span><span class="s">&quot;GPL&quot;</span><span class="p">);</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
