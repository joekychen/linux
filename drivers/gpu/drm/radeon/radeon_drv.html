<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › gpu › drm › radeon › radeon_drv.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>radeon_drv.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/* radeon_drv.h -- Private header for radeon driver -*- linux-c -*-</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright 1999 Precision Insight, Inc., Cedar Park, Texas.</span>
<span class="cm"> * Copyright 2000 VA Linux Systems, Inc., Fremont, California.</span>
<span class="cm"> * All rights reserved.</span>
<span class="cm"> *</span>
<span class="cm"> * Permission is hereby granted, free of charge, to any person obtaining a</span>
<span class="cm"> * copy of this software and associated documentation files (the &quot;Software&quot;),</span>
<span class="cm"> * to deal in the Software without restriction, including without limitation</span>
<span class="cm"> * the rights to use, copy, modify, merge, publish, distribute, sublicense,</span>
<span class="cm"> * and/or sell copies of the Software, and to permit persons to whom the</span>
<span class="cm"> * Software is furnished to do so, subject to the following conditions:</span>
<span class="cm"> *</span>
<span class="cm"> * The above copyright notice and this permission notice (including the next</span>
<span class="cm"> * paragraph) shall be included in all copies or substantial portions of the</span>
<span class="cm"> * Software.</span>
<span class="cm"> *</span>
<span class="cm"> * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="cm"> * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="cm"> * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL</span>
<span class="cm"> * PRECISION INSIGHT AND/OR ITS SUPPLIERS BE LIABLE FOR ANY CLAIM, DAMAGES OR</span>
<span class="cm"> * OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,</span>
<span class="cm"> * ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER</span>
<span class="cm"> * DEALINGS IN THE SOFTWARE.</span>
<span class="cm"> *</span>
<span class="cm"> * Authors:</span>
<span class="cm"> *    Kevin E. Martin &lt;martin@valinux.com&gt;</span>
<span class="cm"> *    Gareth Hughes &lt;gareth@valinux.com&gt;</span>
<span class="cm"> */</span>

<span class="cp">#ifndef __RADEON_DRV_H__</span>
<span class="cp">#define __RADEON_DRV_H__</span>

<span class="cp">#include &lt;linux/firmware.h&gt;</span>
<span class="cp">#include &lt;linux/platform_device.h&gt;</span>

<span class="cp">#include &quot;radeon_family.h&quot;</span>

<span class="cm">/* General customization:</span>
<span class="cm"> */</span>

<span class="cp">#define DRIVER_AUTHOR		&quot;Gareth Hughes, Keith Whitwell, others.&quot;</span>

<span class="cp">#define DRIVER_NAME		&quot;radeon&quot;</span>
<span class="cp">#define DRIVER_DESC		&quot;ATI Radeon&quot;</span>
<span class="cp">#define DRIVER_DATE		&quot;20080528&quot;</span>

<span class="cm">/* Interface history:</span>
<span class="cm"> *</span>
<span class="cm"> * 1.1 - ??</span>
<span class="cm"> * 1.2 - Add vertex2 ioctl (keith)</span>
<span class="cm"> *     - Add stencil capability to clear ioctl (gareth, keith)</span>
<span class="cm"> *     - Increase MAX_TEXTURE_LEVELS (brian)</span>
<span class="cm"> * 1.3 - Add cmdbuf ioctl (keith)</span>
<span class="cm"> *     - Add support for new radeon packets (keith)</span>
<span class="cm"> *     - Add getparam ioctl (keith)</span>
<span class="cm"> *     - Add flip-buffers ioctl, deprecate fullscreen foo (keith).</span>
<span class="cm"> * 1.4 - Add scratch registers to get_param ioctl.</span>
<span class="cm"> * 1.5 - Add r200 packets to cmdbuf ioctl</span>
<span class="cm"> *     - Add r200 function to init ioctl</span>
<span class="cm"> *     - Add &#39;scalar2&#39; instruction to cmdbuf</span>
<span class="cm"> * 1.6 - Add static GART memory manager</span>
<span class="cm"> *       Add irq handler (won&#39;t be turned on unless X server knows to)</span>
<span class="cm"> *       Add irq ioctls and irq_active getparam.</span>
<span class="cm"> *       Add wait command for cmdbuf ioctl</span>
<span class="cm"> *       Add GART offset query for getparam</span>
<span class="cm"> * 1.7 - Add support for cube map registers: R200_PP_CUBIC_FACES_[0..5]</span>
<span class="cm"> *       and R200_PP_CUBIC_OFFSET_F1_[0..5].</span>
<span class="cm"> *       Added packets R200_EMIT_PP_CUBIC_FACES_[0..5] and</span>
<span class="cm"> *       R200_EMIT_PP_CUBIC_OFFSETS_[0..5].  (brian)</span>
<span class="cm"> * 1.8 - Remove need to call cleanup ioctls on last client exit (keith)</span>
<span class="cm"> *       Add &#39;GET&#39; queries for starting additional clients on different VT&#39;s.</span>
<span class="cm"> * 1.9 - Add DRM_IOCTL_RADEON_CP_RESUME ioctl.</span>
<span class="cm"> *       Add texture rectangle support for r100.</span>
<span class="cm"> * 1.10- Add SETPARAM ioctl; first parameter to set is FB_LOCATION, which</span>
<span class="cm"> *       clients use to tell the DRM where they think the framebuffer is</span>
<span class="cm"> *       located in the card&#39;s address space</span>
<span class="cm"> * 1.11- Add packet R200_EMIT_RB3D_BLENDCOLOR to support GL_EXT_blend_color</span>
<span class="cm"> *       and GL_EXT_blend_[func|equation]_separate on r200</span>
<span class="cm"> * 1.12- Add R300 CP microcode support - this just loads the CP on r300</span>
<span class="cm"> *       (No 3D support yet - just microcode loading).</span>
<span class="cm"> * 1.13- Add packet R200_EMIT_TCL_POINT_SPRITE_CNTL for ARB_point_parameters</span>
<span class="cm"> *     - Add hyperz support, add hyperz flags to clear ioctl.</span>
<span class="cm"> * 1.14- Add support for color tiling</span>
<span class="cm"> *     - Add R100/R200 surface allocation/free support</span>
<span class="cm"> * 1.15- Add support for texture micro tiling</span>
<span class="cm"> *     - Add support for r100 cube maps</span>
<span class="cm"> * 1.16- Add R200_EMIT_PP_TRI_PERF_CNTL packet to support brilinear</span>
<span class="cm"> *       texture filtering on r200</span>
<span class="cm"> * 1.17- Add initial support for R300 (3D).</span>
<span class="cm"> * 1.18- Add support for GL_ATI_fragment_shader, new packets</span>
<span class="cm"> *       R200_EMIT_PP_AFS_0/1, R200_EMIT_PP_TXCTLALL_0-5 (replaces</span>
<span class="cm"> *       R200_EMIT_PP_TXFILTER_0-5, 2 more regs) and R200_EMIT_ATF_TFACTOR</span>
<span class="cm"> *       (replaces R200_EMIT_TFACTOR_0 (8 consts instead of 6)</span>
<span class="cm"> * 1.19- Add support for gart table in FB memory and PCIE r300</span>
<span class="cm"> * 1.20- Add support for r300 texrect</span>
<span class="cm"> * 1.21- Add support for card type getparam</span>
<span class="cm"> * 1.22- Add support for texture cache flushes (R300_TX_CNTL)</span>
<span class="cm"> * 1.23- Add new radeon memory map work from benh</span>
<span class="cm"> * 1.24- Add general-purpose packet for manipulating scratch registers (r300)</span>
<span class="cm"> * 1.25- Add support for r200 vertex programs (R200_EMIT_VAP_PVS_CNTL,</span>
<span class="cm"> *       new packet type)</span>
<span class="cm"> * 1.26- Add support for variable size PCI(E) gart aperture</span>
<span class="cm"> * 1.27- Add support for IGP GART</span>
<span class="cm"> * 1.28- Add support for VBL on CRTC2</span>
<span class="cm"> * 1.29- R500 3D cmd buffer support</span>
<span class="cm"> * 1.30- Add support for occlusion queries</span>
<span class="cm"> * 1.31- Add support for num Z pipes from GET_PARAM</span>
<span class="cm"> * 1.32- fixes for rv740 setup</span>
<span class="cm"> * 1.33- Add r6xx/r7xx const buffer support</span>
<span class="cm"> */</span>
<span class="cp">#define DRIVER_MAJOR		1</span>
<span class="cp">#define DRIVER_MINOR		33</span>
<span class="cp">#define DRIVER_PATCHLEVEL	0</span>

<span class="k">enum</span> <span class="n">radeon_cp_microcode_version</span> <span class="p">{</span>
	<span class="n">UCODE_R100</span><span class="p">,</span>
	<span class="n">UCODE_R200</span><span class="p">,</span>
	<span class="n">UCODE_R300</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">drm_radeon_freelist</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">age</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">drm_buf</span> <span class="o">*</span><span class="n">buf</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">drm_radeon_freelist</span> <span class="o">*</span><span class="n">next</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">drm_radeon_freelist</span> <span class="o">*</span><span class="n">prev</span><span class="p">;</span>
<span class="p">}</span> <span class="n">drm_radeon_freelist_t</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">drm_radeon_ring_buffer</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="o">*</span><span class="n">start</span><span class="p">;</span>
	<span class="n">u32</span> <span class="o">*</span><span class="n">end</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">size</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">size_l2qw</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">rptr_update</span><span class="p">;</span> <span class="cm">/* Double Words */</span>
	<span class="kt">int</span> <span class="n">rptr_update_l2qw</span><span class="p">;</span> <span class="cm">/* log2 Quad Words */</span>

	<span class="kt">int</span> <span class="n">fetch_size</span><span class="p">;</span> <span class="cm">/* Double Words */</span>
	<span class="kt">int</span> <span class="n">fetch_size_l2ow</span><span class="p">;</span> <span class="cm">/* log2 Oct Words */</span>

	<span class="n">u32</span> <span class="n">tail</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tail_mask</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">space</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">high_mark</span><span class="p">;</span>
<span class="p">}</span> <span class="n">drm_radeon_ring_buffer_t</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">drm_radeon_depth_clear_t</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">rb3d_cntl</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rb3d_zstencilcntl</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">se_cntl</span><span class="p">;</span>
<span class="p">}</span> <span class="n">drm_radeon_depth_clear_t</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">drm_radeon_driver_file_fields</span> <span class="p">{</span>
	<span class="kt">int64_t</span> <span class="n">radeon_fb_delta</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">mem_block</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">mem_block</span> <span class="o">*</span><span class="n">next</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">mem_block</span> <span class="o">*</span><span class="n">prev</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">start</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">size</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">drm_file</span> <span class="o">*</span><span class="n">file_priv</span><span class="p">;</span> <span class="cm">/* NULL: free, -1: heap, other: real files */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">radeon_surface</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">refcount</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">lower</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">upper</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">flags</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">radeon_virt_surface</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">surface_index</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">lower</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">upper</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">flags</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">drm_file</span> <span class="o">*</span><span class="n">file_priv</span><span class="p">;</span>
<span class="cp">#define PCIGART_FILE_PRIV	((void *) -1L)</span>
<span class="p">};</span>

<span class="cp">#define RADEON_FLUSH_EMITED	(1 &lt;&lt; 0)</span>
<span class="cp">#define RADEON_PURGE_EMITED	(1 &lt;&lt; 1)</span>

<span class="k">struct</span> <span class="n">drm_radeon_master_private</span> <span class="p">{</span>
	<span class="n">drm_local_map_t</span> <span class="o">*</span><span class="n">sarea</span><span class="p">;</span>
	<span class="n">drm_radeon_sarea_t</span> <span class="o">*</span><span class="n">sarea_priv</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">drm_radeon_private</span> <span class="p">{</span>
	<span class="n">drm_radeon_ring_buffer_t</span> <span class="n">ring</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">fb_location</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">fb_size</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">new_memmap</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">gart_size</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">gart_vm_start</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">gart_buffers_offset</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">cp_mode</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">cp_running</span><span class="p">;</span>

	<span class="n">drm_radeon_freelist_t</span> <span class="o">*</span><span class="n">head</span><span class="p">;</span>
	<span class="n">drm_radeon_freelist_t</span> <span class="o">*</span><span class="n">tail</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">last_buf</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">writeback_works</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">usec_timeout</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">microcode_version</span><span class="p">;</span>

	<span class="k">struct</span> <span class="p">{</span>
		<span class="n">u32</span> <span class="n">boxes</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">freelist_timeouts</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">freelist_loops</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">requested_bufs</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">last_frame_reads</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">last_clear_reads</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">clears</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">texture_uploads</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">stats</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">do_boxes</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">page_flipping</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">color_fmt</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">front_offset</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">front_pitch</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">back_offset</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">back_pitch</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">depth_fmt</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">depth_offset</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">depth_pitch</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">front_pitch_offset</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">back_pitch_offset</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">depth_pitch_offset</span><span class="p">;</span>

	<span class="n">drm_radeon_depth_clear_t</span> <span class="n">depth_clear</span><span class="p">;</span>

	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">ring_offset</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">ring_rptr_offset</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">buffers_offset</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">gart_textures_offset</span><span class="p">;</span>

	<span class="n">drm_local_map_t</span> <span class="o">*</span><span class="n">sarea</span><span class="p">;</span>
	<span class="n">drm_local_map_t</span> <span class="o">*</span><span class="n">cp_ring</span><span class="p">;</span>
	<span class="n">drm_local_map_t</span> <span class="o">*</span><span class="n">ring_rptr</span><span class="p">;</span>
	<span class="n">drm_local_map_t</span> <span class="o">*</span><span class="n">gart_textures</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">mem_block</span> <span class="o">*</span><span class="n">gart_heap</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">mem_block</span> <span class="o">*</span><span class="n">fb_heap</span><span class="p">;</span>

	<span class="cm">/* SW interrupt */</span>
	<span class="n">wait_queue_head_t</span> <span class="n">swi_queue</span><span class="p">;</span>
	<span class="n">atomic_t</span> <span class="n">swi_emitted</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">vblank_crtc</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">irq_enable_reg</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">r500_disp_irq_reg</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">radeon_surface</span> <span class="n">surfaces</span><span class="p">[</span><span class="n">RADEON_MAX_SURFACES</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">radeon_virt_surface</span> <span class="n">virt_surfaces</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">RADEON_MAX_SURFACES</span><span class="p">];</span>

	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">pcigart_offset</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">pcigart_offset_set</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">drm_ati_pcigart_info</span> <span class="n">gart_info</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">scratch_ages</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>

	<span class="kt">int</span> <span class="n">have_z_offset</span><span class="p">;</span>

	<span class="cm">/* starting from here on, data is preserved across an open */</span>
	<span class="kt">uint32_t</span> <span class="n">flags</span><span class="p">;</span>		<span class="cm">/* see radeon_chip_flags */</span>
	<span class="n">resource_size_t</span> <span class="n">fb_aper_offset</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">num_gb_pipes</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">num_z_pipes</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">track_flush</span><span class="p">;</span>
	<span class="n">drm_local_map_t</span> <span class="o">*</span><span class="n">mmio</span><span class="p">;</span>

	<span class="cm">/* r6xx/r7xx pipe/shader config */</span>
	<span class="kt">int</span> <span class="n">r600_max_pipes</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">r600_max_tile_pipes</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">r600_max_simds</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">r600_max_backends</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">r600_max_gprs</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">r600_max_threads</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">r600_max_stack_entries</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">r600_max_hw_contexts</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">r600_max_gs_threads</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">r600_sx_max_export_size</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">r600_sx_max_export_pos_size</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">r600_sx_max_export_smx_size</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">r600_sq_num_cf_insts</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">r700_sx_num_of_sets</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">r700_sc_prim_fifo_size</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">r700_sc_hiz_tile_fifo_size</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">r700_sc_earlyz_tile_fifo_fize</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">r600_group_size</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">r600_npipes</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">r600_nbanks</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">mutex</span> <span class="n">cs_mutex</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">cs_id_scnt</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">cs_id_wcnt</span><span class="p">;</span>
	<span class="cm">/* r6xx/r7xx drm blit vertex buffer */</span>
	<span class="k">struct</span> <span class="n">drm_buf</span> <span class="o">*</span><span class="n">blit_vb</span><span class="p">;</span>

	<span class="cm">/* firmware */</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">firmware</span> <span class="o">*</span><span class="n">me_fw</span><span class="p">,</span> <span class="o">*</span><span class="n">pfp_fw</span><span class="p">;</span>
<span class="p">}</span> <span class="n">drm_radeon_private_t</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">drm_radeon_buf_priv</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">age</span><span class="p">;</span>
<span class="p">}</span> <span class="n">drm_radeon_buf_priv_t</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">drm_buffer</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">drm_radeon_kcmd_buffer</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">bufsz</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">drm_buffer</span> <span class="o">*</span><span class="n">buffer</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">nbox</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">drm_clip_rect</span> <span class="n">__user</span> <span class="o">*</span><span class="n">boxes</span><span class="p">;</span>
<span class="p">}</span> <span class="n">drm_radeon_kcmd_buffer_t</span><span class="p">;</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_no_wb</span><span class="p">;</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">drm_ioctl_desc</span> <span class="n">radeon_ioctls</span><span class="p">[];</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_max_ioctl</span><span class="p">;</span>

<span class="k">extern</span> <span class="n">u32</span> <span class="n">radeon_get_ring_head</span><span class="p">(</span><span class="n">drm_radeon_private_t</span> <span class="o">*</span><span class="n">dev_priv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">radeon_set_ring_head</span><span class="p">(</span><span class="n">drm_radeon_private_t</span> <span class="o">*</span><span class="n">dev_priv</span><span class="p">,</span> <span class="n">u32</span> <span class="n">val</span><span class="p">);</span>

<span class="cp">#define GET_RING_HEAD(dev_priv)	radeon_get_ring_head(dev_priv)</span>
<span class="cp">#define SET_RING_HEAD(dev_priv, val) radeon_set_ring_head(dev_priv, val)</span>

<span class="cm">/* Check whether the given hardware address is inside the framebuffer or the</span>
<span class="cm"> * GART area.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="n">__inline__</span> <span class="kt">int</span> <span class="nf">radeon_check_offset</span><span class="p">(</span><span class="n">drm_radeon_private_t</span> <span class="o">*</span><span class="n">dev_priv</span><span class="p">,</span>
					  <span class="n">u64</span> <span class="n">off</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">fb_start</span> <span class="o">=</span> <span class="n">dev_priv</span><span class="o">-&gt;</span><span class="n">fb_location</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">fb_end</span> <span class="o">=</span> <span class="n">fb_start</span> <span class="o">+</span> <span class="n">dev_priv</span><span class="o">-&gt;</span><span class="n">fb_size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">gart_start</span> <span class="o">=</span> <span class="n">dev_priv</span><span class="o">-&gt;</span><span class="n">gart_vm_start</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">gart_end</span> <span class="o">=</span> <span class="n">gart_start</span> <span class="o">+</span> <span class="n">dev_priv</span><span class="o">-&gt;</span><span class="n">gart_size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>

	<span class="k">return</span> <span class="p">((</span><span class="n">off</span> <span class="o">&gt;=</span> <span class="n">fb_start</span> <span class="o">&amp;&amp;</span> <span class="n">off</span> <span class="o">&lt;=</span> <span class="n">fb_end</span><span class="p">)</span> <span class="o">||</span>
		<span class="p">(</span><span class="n">off</span> <span class="o">&gt;=</span> <span class="n">gart_start</span> <span class="o">&amp;&amp;</span> <span class="n">off</span> <span class="o">&lt;=</span> <span class="n">gart_end</span><span class="p">));</span>
<span class="p">}</span>

<span class="cm">/* radeon_state.c */</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">radeon_cp_discard_buffer</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="k">struct</span> <span class="n">drm_master</span> <span class="o">*</span><span class="n">master</span><span class="p">,</span> <span class="k">struct</span> <span class="n">drm_buf</span> <span class="o">*</span><span class="n">buf</span><span class="p">);</span>

				<span class="cm">/* radeon_cp.c */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_cp_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="k">struct</span> <span class="n">drm_file</span> <span class="o">*</span><span class="n">file_priv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_cp_start</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="k">struct</span> <span class="n">drm_file</span> <span class="o">*</span><span class="n">file_priv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_cp_stop</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="k">struct</span> <span class="n">drm_file</span> <span class="o">*</span><span class="n">file_priv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_cp_reset</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="k">struct</span> <span class="n">drm_file</span> <span class="o">*</span><span class="n">file_priv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_cp_idle</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="k">struct</span> <span class="n">drm_file</span> <span class="o">*</span><span class="n">file_priv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_cp_resume</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="k">struct</span> <span class="n">drm_file</span> <span class="o">*</span><span class="n">file_priv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_engine_reset</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="k">struct</span> <span class="n">drm_file</span> <span class="o">*</span><span class="n">file_priv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_fullscreen</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="k">struct</span> <span class="n">drm_file</span> <span class="o">*</span><span class="n">file_priv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_cp_buffers</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="k">struct</span> <span class="n">drm_file</span> <span class="o">*</span><span class="n">file_priv</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u32</span> <span class="n">radeon_read_fb_location</span><span class="p">(</span><span class="n">drm_radeon_private_t</span> <span class="o">*</span><span class="n">dev_priv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">radeon_write_agp_location</span><span class="p">(</span><span class="n">drm_radeon_private_t</span> <span class="o">*</span><span class="n">dev_priv</span><span class="p">,</span> <span class="n">u32</span> <span class="n">agp_loc</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">radeon_write_agp_base</span><span class="p">(</span><span class="n">drm_radeon_private_t</span> <span class="o">*</span><span class="n">dev_priv</span><span class="p">,</span> <span class="n">u64</span> <span class="n">agp_base</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u32</span> <span class="n">RADEON_READ_MM</span><span class="p">(</span><span class="n">drm_radeon_private_t</span> <span class="o">*</span><span class="n">dev_priv</span><span class="p">,</span> <span class="kt">int</span> <span class="n">addr</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">radeon_freelist_reset</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span> <span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">drm_buf</span> <span class="o">*</span><span class="n">radeon_freelist_get</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span> <span class="n">dev</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_wait_ring</span><span class="p">(</span><span class="n">drm_radeon_private_t</span> <span class="o">*</span> <span class="n">dev_priv</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_do_cp_idle</span><span class="p">(</span><span class="n">drm_radeon_private_t</span> <span class="o">*</span> <span class="n">dev_priv</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_driver_preinit</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">flags</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_presetup</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_driver_postcleanup</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_mem_alloc</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="k">struct</span> <span class="n">drm_file</span> <span class="o">*</span><span class="n">file_priv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_mem_free</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="k">struct</span> <span class="n">drm_file</span> <span class="o">*</span><span class="n">file_priv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_mem_init_heap</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="k">struct</span> <span class="n">drm_file</span> <span class="o">*</span><span class="n">file_priv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">radeon_mem_takedown</span><span class="p">(</span><span class="k">struct</span> <span class="n">mem_block</span> <span class="o">**</span><span class="n">heap</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">radeon_mem_release</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_file</span> <span class="o">*</span><span class="n">file_priv</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">mem_block</span> <span class="o">*</span><span class="n">heap</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">radeon_enable_bm</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_radeon_private</span> <span class="o">*</span><span class="n">dev_priv</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u32</span> <span class="n">radeon_read_ring_rptr</span><span class="p">(</span><span class="n">drm_radeon_private_t</span> <span class="o">*</span><span class="n">dev_priv</span><span class="p">,</span> <span class="n">u32</span> <span class="n">off</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">radeon_write_ring_rptr</span><span class="p">(</span><span class="n">drm_radeon_private_t</span> <span class="o">*</span><span class="n">dev_priv</span><span class="p">,</span> <span class="n">u32</span> <span class="n">off</span><span class="p">,</span> <span class="n">u32</span> <span class="n">val</span><span class="p">);</span>

				<span class="cm">/* radeon_irq.c */</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">radeon_irq_set_state</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="n">u32</span> <span class="n">mask</span><span class="p">,</span> <span class="kt">int</span> <span class="n">state</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_irq_emit</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="k">struct</span> <span class="n">drm_file</span> <span class="o">*</span><span class="n">file_priv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_irq_wait</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="k">struct</span> <span class="n">drm_file</span> <span class="o">*</span><span class="n">file_priv</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">radeon_do_release</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span> <span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u32</span> <span class="n">radeon_get_vblank_counter</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">crtc</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_enable_vblank</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">crtc</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">radeon_disable_vblank</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">crtc</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">irqreturn_t</span> <span class="n">radeon_driver_irq_handler</span><span class="p">(</span><span class="n">DRM_IRQ_ARGS</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">radeon_driver_irq_preinstall</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span> <span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_driver_irq_postinstall</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">radeon_driver_irq_uninstall</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span> <span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">radeon_enable_interrupt</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_vblank_crtc_get</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_vblank_crtc_set</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int64_t</span> <span class="n">value</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_driver_load</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">flags</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_driver_unload</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_driver_firstopen</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">radeon_driver_preclose</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
				   <span class="k">struct</span> <span class="n">drm_file</span> <span class="o">*</span><span class="n">file_priv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">radeon_driver_postclose</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
				    <span class="k">struct</span> <span class="n">drm_file</span> <span class="o">*</span><span class="n">file_priv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">radeon_driver_lastclose</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span> <span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_driver_open</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
			      <span class="k">struct</span> <span class="n">drm_file</span> <span class="o">*</span><span class="n">file_priv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">long</span> <span class="n">radeon_compat_ioctl</span><span class="p">(</span><span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="n">filp</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cmd</span><span class="p">,</span>
				<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">arg</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">long</span> <span class="n">radeon_kms_compat_ioctl</span><span class="p">(</span><span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="n">filp</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cmd</span><span class="p">,</span>
				    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">arg</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">radeon_master_create</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="k">struct</span> <span class="n">drm_master</span> <span class="o">*</span><span class="n">master</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">radeon_master_destroy</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="k">struct</span> <span class="n">drm_master</span> <span class="o">*</span><span class="n">master</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">radeon_cp_dispatch_flip</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="k">struct</span> <span class="n">drm_master</span> <span class="o">*</span><span class="n">master</span><span class="p">);</span>
<span class="cm">/* r300_cmdbuf.c */</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">r300_init_reg_flags</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">r300_do_cp_cmdbuf</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
			     <span class="k">struct</span> <span class="n">drm_file</span> <span class="o">*</span><span class="n">file_priv</span><span class="p">,</span>
			     <span class="n">drm_radeon_kcmd_buffer_t</span> <span class="o">*</span><span class="n">cmdbuf</span><span class="p">);</span>

<span class="cm">/* r600_cp.c */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">r600_do_engine_reset</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">r600_do_cleanup_cp</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">r600_do_init_cp</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="n">drm_radeon_init_t</span> <span class="o">*</span><span class="n">init</span><span class="p">,</span>
			   <span class="k">struct</span> <span class="n">drm_file</span> <span class="o">*</span><span class="n">file_priv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">r600_do_resume_cp</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="k">struct</span> <span class="n">drm_file</span> <span class="o">*</span><span class="n">file_priv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">r600_do_cp_idle</span><span class="p">(</span><span class="n">drm_radeon_private_t</span> <span class="o">*</span><span class="n">dev_priv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">r600_do_cp_start</span><span class="p">(</span><span class="n">drm_radeon_private_t</span> <span class="o">*</span><span class="n">dev_priv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">r600_do_cp_reset</span><span class="p">(</span><span class="n">drm_radeon_private_t</span> <span class="o">*</span><span class="n">dev_priv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">r600_do_cp_stop</span><span class="p">(</span><span class="n">drm_radeon_private_t</span> <span class="o">*</span><span class="n">dev_priv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">r600_cp_dispatch_indirect</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
				     <span class="k">struct</span> <span class="n">drm_buf</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="kt">int</span> <span class="n">start</span><span class="p">,</span> <span class="kt">int</span> <span class="n">end</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">r600_page_table_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">r600_page_table_cleanup</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="k">struct</span> <span class="n">drm_ati_pcigart_info</span> <span class="o">*</span><span class="n">gart_info</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">r600_cs_legacy_ioctl</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="k">struct</span> <span class="n">drm_file</span> <span class="o">*</span><span class="n">fpriv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">r600_cp_dispatch_swap</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="k">struct</span> <span class="n">drm_file</span> <span class="o">*</span><span class="n">file_priv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">r600_cp_dispatch_texture</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
				    <span class="k">struct</span> <span class="n">drm_file</span> <span class="o">*</span><span class="n">file_priv</span><span class="p">,</span>
				    <span class="n">drm_radeon_texture_t</span> <span class="o">*</span><span class="n">tex</span><span class="p">,</span>
				    <span class="n">drm_radeon_tex_image_t</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
<span class="cm">/* r600_blit.c */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">r600_prepare_blit_copy</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="k">struct</span> <span class="n">drm_file</span> <span class="o">*</span><span class="n">file_priv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">r600_done_blit_copy</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">r600_blit_copy</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
			   <span class="kt">uint64_t</span> <span class="n">src_gpu_addr</span><span class="p">,</span> <span class="kt">uint64_t</span> <span class="n">dst_gpu_addr</span><span class="p">,</span>
			   <span class="kt">int</span> <span class="n">size_bytes</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">r600_blit_swap</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
			   <span class="kt">uint64_t</span> <span class="n">src_gpu_addr</span><span class="p">,</span> <span class="kt">uint64_t</span> <span class="n">dst_gpu_addr</span><span class="p">,</span>
			   <span class="kt">int</span> <span class="n">sx</span><span class="p">,</span> <span class="kt">int</span> <span class="n">sy</span><span class="p">,</span> <span class="kt">int</span> <span class="n">dx</span><span class="p">,</span> <span class="kt">int</span> <span class="n">dy</span><span class="p">,</span>
			   <span class="kt">int</span> <span class="n">w</span><span class="p">,</span> <span class="kt">int</span> <span class="n">h</span><span class="p">,</span> <span class="kt">int</span> <span class="n">src_pitch</span><span class="p">,</span> <span class="kt">int</span> <span class="n">dst_pitch</span><span class="p">,</span> <span class="kt">int</span> <span class="n">cpp</span><span class="p">);</span>

<span class="cm">/* atpx handler */</span>
<span class="cp">#if defined(CONFIG_VGA_SWITCHEROO)</span>
<span class="kt">void</span> <span class="n">radeon_register_atpx_handler</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">radeon_unregister_atpx_handler</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">radeon_register_atpx_handler</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">radeon_unregister_atpx_handler</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{}</span>
<span class="cp">#endif</span>

<span class="cm">/* Flags for stats.boxes</span>
<span class="cm"> */</span>
<span class="cp">#define RADEON_BOX_DMA_IDLE      0x1</span>
<span class="cp">#define RADEON_BOX_RING_FULL     0x2</span>
<span class="cp">#define RADEON_BOX_FLIP          0x4</span>
<span class="cp">#define RADEON_BOX_WAIT_IDLE     0x8</span>
<span class="cp">#define RADEON_BOX_TEXTURE_LOAD  0x10</span>

<span class="cm">/* Register definitions, register access macros and drmAddMap constants</span>
<span class="cm"> * for Radeon kernel driver.</span>
<span class="cm"> */</span>
<span class="cp">#define RADEON_MM_INDEX		        0x0000</span>
<span class="cp">#define RADEON_MM_DATA		        0x0004</span>

<span class="cp">#define RADEON_AGP_COMMAND		0x0f60</span>
<span class="cp">#define RADEON_AGP_COMMAND_PCI_CONFIG   0x0060	</span><span class="cm">/* offset in PCI config */</span><span class="cp"></span>
<span class="cp">#	define RADEON_AGP_ENABLE	(1&lt;&lt;8)</span>
<span class="cp">#define RADEON_AUX_SCISSOR_CNTL		0x26f0</span>
<span class="cp">#	define RADEON_EXCLUSIVE_SCISSOR_0	(1 &lt;&lt; 24)</span>
<span class="cp">#	define RADEON_EXCLUSIVE_SCISSOR_1	(1 &lt;&lt; 25)</span>
<span class="cp">#	define RADEON_EXCLUSIVE_SCISSOR_2	(1 &lt;&lt; 26)</span>
<span class="cp">#	define RADEON_SCISSOR_0_ENABLE		(1 &lt;&lt; 28)</span>
<span class="cp">#	define RADEON_SCISSOR_1_ENABLE		(1 &lt;&lt; 29)</span>
<span class="cp">#	define RADEON_SCISSOR_2_ENABLE		(1 &lt;&lt; 30)</span>

<span class="cm">/*</span>
<span class="cm"> * PCIE radeons (rv370/rv380, rv410, r423/r430/r480, r5xx)</span>
<span class="cm"> * don&#39;t have an explicit bus mastering disable bit.  It&#39;s handled</span>
<span class="cm"> * by the PCI D-states.  PMI_BM_DIS disables D-state bus master</span>
<span class="cm"> * handling, not bus mastering itself.</span>
<span class="cm"> */</span>
<span class="cp">#define RADEON_BUS_CNTL			0x0030</span>
<span class="cm">/* r1xx, r2xx, r300, r(v)350, r420/r481, rs400/rs480 */</span>
<span class="cp">#	define RADEON_BUS_MASTER_DIS		(1 &lt;&lt; 6)</span>
<span class="cm">/* rs600/rs690/rs740 */</span>
<span class="cp">#	define RS600_BUS_MASTER_DIS		(1 &lt;&lt; 14)</span>
<span class="cp">#	define RS600_MSI_REARM		        (1 &lt;&lt; 20)</span>
<span class="cm">/* see RS400_MSI_REARM in AIC_CNTL for rs480 */</span>

<span class="cp">#define RADEON_BUS_CNTL1		0x0034</span>
<span class="cp">#	define RADEON_PMI_BM_DIS		(1 &lt;&lt; 2)</span>
<span class="cp">#	define RADEON_PMI_INT_DIS		(1 &lt;&lt; 3)</span>

<span class="cp">#define RV370_BUS_CNTL			0x004c</span>
<span class="cp">#	define RV370_PMI_BM_DIS		        (1 &lt;&lt; 5)</span>
<span class="cp">#	define RV370_PMI_INT_DIS		(1 &lt;&lt; 6)</span>

<span class="cp">#define RADEON_MSI_REARM_EN		0x0160</span>
<span class="cm">/* rv370/rv380, rv410, r423/r430/r480, r5xx */</span>
<span class="cp">#	define RV370_MSI_REARM_EN		(1 &lt;&lt; 0)</span>

<span class="cp">#define RADEON_CLOCK_CNTL_DATA		0x000c</span>
<span class="cp">#	define RADEON_PLL_WR_EN			(1 &lt;&lt; 7)</span>
<span class="cp">#define RADEON_CLOCK_CNTL_INDEX		0x0008</span>
<span class="cp">#define RADEON_CONFIG_APER_SIZE		0x0108</span>
<span class="cp">#define RADEON_CONFIG_MEMSIZE		0x00f8</span>
<span class="cp">#define RADEON_CRTC_OFFSET		0x0224</span>
<span class="cp">#define RADEON_CRTC_OFFSET_CNTL		0x0228</span>
<span class="cp">#	define RADEON_CRTC_TILE_EN		(1 &lt;&lt; 15)</span>
<span class="cp">#	define RADEON_CRTC_OFFSET_FLIP_CNTL	(1 &lt;&lt; 16)</span>
<span class="cp">#define RADEON_CRTC2_OFFSET		0x0324</span>
<span class="cp">#define RADEON_CRTC2_OFFSET_CNTL	0x0328</span>

<span class="cp">#define RADEON_PCIE_INDEX               0x0030</span>
<span class="cp">#define RADEON_PCIE_DATA                0x0034</span>
<span class="cp">#define RADEON_PCIE_TX_GART_CNTL	0x10</span>
<span class="cp">#	define RADEON_PCIE_TX_GART_EN		(1 &lt;&lt; 0)</span>
<span class="cp">#	define RADEON_PCIE_TX_GART_UNMAPPED_ACCESS_PASS_THRU (0 &lt;&lt; 1)</span>
<span class="cp">#	define RADEON_PCIE_TX_GART_UNMAPPED_ACCESS_CLAMP_LO  (1 &lt;&lt; 1)</span>
<span class="cp">#	define RADEON_PCIE_TX_GART_UNMAPPED_ACCESS_DISCARD   (3 &lt;&lt; 1)</span>
<span class="cp">#	define RADEON_PCIE_TX_GART_MODE_32_128_CACHE	(0 &lt;&lt; 3)</span>
<span class="cp">#	define RADEON_PCIE_TX_GART_MODE_8_4_128_CACHE	(1 &lt;&lt; 3)</span>
<span class="cp">#	define RADEON_PCIE_TX_GART_CHK_RW_VALID_EN      (1 &lt;&lt; 5)</span>
<span class="cp">#	define RADEON_PCIE_TX_GART_INVALIDATE_TLB	(1 &lt;&lt; 8)</span>
<span class="cp">#define RADEON_PCIE_TX_DISCARD_RD_ADDR_LO 0x11</span>
<span class="cp">#define RADEON_PCIE_TX_DISCARD_RD_ADDR_HI 0x12</span>
<span class="cp">#define RADEON_PCIE_TX_GART_BASE	0x13</span>
<span class="cp">#define RADEON_PCIE_TX_GART_START_LO	0x14</span>
<span class="cp">#define RADEON_PCIE_TX_GART_START_HI	0x15</span>
<span class="cp">#define RADEON_PCIE_TX_GART_END_LO	0x16</span>
<span class="cp">#define RADEON_PCIE_TX_GART_END_HI	0x17</span>

<span class="cp">#define RS480_NB_MC_INDEX               0x168</span>
<span class="cp">#	define RS480_NB_MC_IND_WR_EN	(1 &lt;&lt; 8)</span>
<span class="cp">#define RS480_NB_MC_DATA                0x16c</span>

<span class="cp">#define RS690_MC_INDEX                  0x78</span>
<span class="cp">#   define RS690_MC_INDEX_MASK          0x1ff</span>
<span class="cp">#   define RS690_MC_INDEX_WR_EN         (1 &lt;&lt; 9)</span>
<span class="cp">#   define RS690_MC_INDEX_WR_ACK        0x7f</span>
<span class="cp">#define RS690_MC_DATA                   0x7c</span>

<span class="cm">/* MC indirect registers */</span>
<span class="cp">#define RS480_MC_MISC_CNTL              0x18</span>
<span class="cp">#	define RS480_DISABLE_GTW	(1 &lt;&lt; 1)</span>
<span class="cm">/* switch between MCIND GART and MM GART registers. 0 = mmgart, 1 = mcind gart */</span>
<span class="cp">#	define RS480_GART_INDEX_REG_EN	(1 &lt;&lt; 12)</span>
<span class="cp">#	define RS690_BLOCK_GFX_D3_EN	(1 &lt;&lt; 14)</span>
<span class="cp">#define RS480_K8_FB_LOCATION            0x1e</span>
<span class="cp">#define RS480_GART_FEATURE_ID           0x2b</span>
<span class="cp">#	define RS480_HANG_EN	        (1 &lt;&lt; 11)</span>
<span class="cp">#	define RS480_TLB_ENABLE	        (1 &lt;&lt; 18)</span>
<span class="cp">#	define RS480_P2P_ENABLE	        (1 &lt;&lt; 19)</span>
<span class="cp">#	define RS480_GTW_LAC_EN	        (1 &lt;&lt; 25)</span>
<span class="cp">#	define RS480_2LEVEL_GART	(0 &lt;&lt; 30)</span>
<span class="cp">#	define RS480_1LEVEL_GART	(1 &lt;&lt; 30)</span>
<span class="cp">#	define RS480_PDC_EN	        (1 &lt;&lt; 31)</span>
<span class="cp">#define RS480_GART_BASE                 0x2c</span>
<span class="cp">#define RS480_GART_CACHE_CNTRL          0x2e</span>
<span class="cp">#	define RS480_GART_CACHE_INVALIDATE (1 &lt;&lt; 0) </span><span class="cm">/* wait for it to clear */</span><span class="cp"></span>
<span class="cp">#define RS480_AGP_ADDRESS_SPACE_SIZE    0x38</span>
<span class="cp">#	define RS480_GART_EN	        (1 &lt;&lt; 0)</span>
<span class="cp">#	define RS480_VA_SIZE_32MB	(0 &lt;&lt; 1)</span>
<span class="cp">#	define RS480_VA_SIZE_64MB	(1 &lt;&lt; 1)</span>
<span class="cp">#	define RS480_VA_SIZE_128MB	(2 &lt;&lt; 1)</span>
<span class="cp">#	define RS480_VA_SIZE_256MB	(3 &lt;&lt; 1)</span>
<span class="cp">#	define RS480_VA_SIZE_512MB	(4 &lt;&lt; 1)</span>
<span class="cp">#	define RS480_VA_SIZE_1GB	(5 &lt;&lt; 1)</span>
<span class="cp">#	define RS480_VA_SIZE_2GB	(6 &lt;&lt; 1)</span>
<span class="cp">#define RS480_AGP_MODE_CNTL             0x39</span>
<span class="cp">#	define RS480_POST_GART_Q_SIZE	(1 &lt;&lt; 18)</span>
<span class="cp">#	define RS480_NONGART_SNOOP	(1 &lt;&lt; 19)</span>
<span class="cp">#	define RS480_AGP_RD_BUF_SIZE	(1 &lt;&lt; 20)</span>
<span class="cp">#	define RS480_REQ_TYPE_SNOOP_SHIFT 22</span>
<span class="cp">#	define RS480_REQ_TYPE_SNOOP_MASK  0x3</span>
<span class="cp">#	define RS480_REQ_TYPE_SNOOP_DIS	(1 &lt;&lt; 24)</span>
<span class="cp">#define RS480_MC_MISC_UMA_CNTL          0x5f</span>
<span class="cp">#define RS480_MC_MCLK_CNTL              0x7a</span>
<span class="cp">#define RS480_MC_UMA_DUALCH_CNTL        0x86</span>

<span class="cp">#define RS690_MC_FB_LOCATION            0x100</span>
<span class="cp">#define RS690_MC_AGP_LOCATION           0x101</span>
<span class="cp">#define RS690_MC_AGP_BASE               0x102</span>
<span class="cp">#define RS690_MC_AGP_BASE_2             0x103</span>

<span class="cp">#define RS600_MC_INDEX                          0x70</span>
<span class="cp">#       define RS600_MC_ADDR_MASK               0xffff</span>
<span class="cp">#       define RS600_MC_IND_SEQ_RBS_0           (1 &lt;&lt; 16)</span>
<span class="cp">#       define RS600_MC_IND_SEQ_RBS_1           (1 &lt;&lt; 17)</span>
<span class="cp">#       define RS600_MC_IND_SEQ_RBS_2           (1 &lt;&lt; 18)</span>
<span class="cp">#       define RS600_MC_IND_SEQ_RBS_3           (1 &lt;&lt; 19)</span>
<span class="cp">#       define RS600_MC_IND_AIC_RBS             (1 &lt;&lt; 20)</span>
<span class="cp">#       define RS600_MC_IND_CITF_ARB0           (1 &lt;&lt; 21)</span>
<span class="cp">#       define RS600_MC_IND_CITF_ARB1           (1 &lt;&lt; 22)</span>
<span class="cp">#       define RS600_MC_IND_WR_EN               (1 &lt;&lt; 23)</span>
<span class="cp">#define RS600_MC_DATA                           0x74</span>

<span class="cp">#define RS600_MC_STATUS                         0x0</span>
<span class="cp">#       define RS600_MC_IDLE                    (1 &lt;&lt; 1)</span>
<span class="cp">#define RS600_MC_FB_LOCATION                    0x4</span>
<span class="cp">#define RS600_MC_AGP_LOCATION                   0x5</span>
<span class="cp">#define RS600_AGP_BASE                          0x6</span>
<span class="cp">#define RS600_AGP_BASE_2                        0x7</span>
<span class="cp">#define RS600_MC_CNTL1                          0x9</span>
<span class="cp">#       define RS600_ENABLE_PAGE_TABLES         (1 &lt;&lt; 26)</span>
<span class="cp">#define RS600_MC_PT0_CNTL                       0x100</span>
<span class="cp">#       define RS600_ENABLE_PT                  (1 &lt;&lt; 0)</span>
<span class="cp">#       define RS600_EFFECTIVE_L2_CACHE_SIZE(x) ((x) &lt;&lt; 15)</span>
<span class="cp">#       define RS600_EFFECTIVE_L2_QUEUE_SIZE(x) ((x) &lt;&lt; 21)</span>
<span class="cp">#       define RS600_INVALIDATE_ALL_L1_TLBS     (1 &lt;&lt; 28)</span>
<span class="cp">#       define RS600_INVALIDATE_L2_CACHE        (1 &lt;&lt; 29)</span>
<span class="cp">#define RS600_MC_PT0_CONTEXT0_CNTL              0x102</span>
<span class="cp">#       define RS600_ENABLE_PAGE_TABLE          (1 &lt;&lt; 0)</span>
<span class="cp">#       define RS600_PAGE_TABLE_TYPE_FLAT       (0 &lt;&lt; 1)</span>
<span class="cp">#define RS600_MC_PT0_SYSTEM_APERTURE_LOW_ADDR   0x112</span>
<span class="cp">#define RS600_MC_PT0_SYSTEM_APERTURE_HIGH_ADDR  0x114</span>
<span class="cp">#define RS600_MC_PT0_CONTEXT0_DEFAULT_READ_ADDR 0x11c</span>
<span class="cp">#define RS600_MC_PT0_CONTEXT0_FLAT_BASE_ADDR    0x12c</span>
<span class="cp">#define RS600_MC_PT0_CONTEXT0_FLAT_START_ADDR   0x13c</span>
<span class="cp">#define RS600_MC_PT0_CONTEXT0_FLAT_END_ADDR     0x14c</span>
<span class="cp">#define RS600_MC_PT0_CLIENT0_CNTL               0x16c</span>
<span class="cp">#       define RS600_ENABLE_TRANSLATION_MODE_OVERRIDE       (1 &lt;&lt; 0)</span>
<span class="cp">#       define RS600_TRANSLATION_MODE_OVERRIDE              (1 &lt;&lt; 1)</span>
<span class="cp">#       define RS600_SYSTEM_ACCESS_MODE_MASK                (3 &lt;&lt; 8)</span>
<span class="cp">#       define RS600_SYSTEM_ACCESS_MODE_PA_ONLY             (0 &lt;&lt; 8)</span>
<span class="cp">#       define RS600_SYSTEM_ACCESS_MODE_USE_SYS_MAP         (1 &lt;&lt; 8)</span>
<span class="cp">#       define RS600_SYSTEM_ACCESS_MODE_IN_SYS              (2 &lt;&lt; 8)</span>
<span class="cp">#       define RS600_SYSTEM_ACCESS_MODE_NOT_IN_SYS          (3 &lt;&lt; 8)</span>
<span class="cp">#       define RS600_SYSTEM_APERTURE_UNMAPPED_ACCESS_PASSTHROUGH        (0 &lt;&lt; 10)</span>
<span class="cp">#       define RS600_SYSTEM_APERTURE_UNMAPPED_ACCESS_DEFAULT_PAGE       (1 &lt;&lt; 10)</span>
<span class="cp">#       define RS600_EFFECTIVE_L1_CACHE_SIZE(x) ((x) &lt;&lt; 11)</span>
<span class="cp">#       define RS600_ENABLE_FRAGMENT_PROCESSING (1 &lt;&lt; 14)</span>
<span class="cp">#       define RS600_EFFECTIVE_L1_QUEUE_SIZE(x) ((x) &lt;&lt; 15)</span>
<span class="cp">#       define RS600_INVALIDATE_L1_TLB          (1 &lt;&lt; 20)</span>

<span class="cp">#define R520_MC_IND_INDEX 0x70</span>
<span class="cp">#define R520_MC_IND_WR_EN (1 &lt;&lt; 24)</span>
<span class="cp">#define R520_MC_IND_DATA  0x74</span>

<span class="cp">#define RV515_MC_FB_LOCATION 0x01</span>
<span class="cp">#define RV515_MC_AGP_LOCATION 0x02</span>
<span class="cp">#define RV515_MC_AGP_BASE     0x03</span>
<span class="cp">#define RV515_MC_AGP_BASE_2   0x04</span>

<span class="cp">#define R520_MC_FB_LOCATION 0x04</span>
<span class="cp">#define R520_MC_AGP_LOCATION 0x05</span>
<span class="cp">#define R520_MC_AGP_BASE     0x06</span>
<span class="cp">#define R520_MC_AGP_BASE_2   0x07</span>

<span class="cp">#define RADEON_MPP_TB_CONFIG		0x01c0</span>
<span class="cp">#define RADEON_MEM_CNTL			0x0140</span>
<span class="cp">#define RADEON_MEM_SDRAM_MODE_REG	0x0158</span>
<span class="cp">#define RADEON_AGP_BASE_2		0x015c </span><span class="cm">/* r200+ only */</span><span class="cp"></span>
<span class="cp">#define RS480_AGP_BASE_2		0x0164</span>
<span class="cp">#define RADEON_AGP_BASE			0x0170</span>

<span class="cm">/* pipe config regs */</span>
<span class="cp">#define R400_GB_PIPE_SELECT             0x402c</span>
<span class="cp">#define RV530_GB_PIPE_SELECT2           0x4124</span>
<span class="cp">#define R500_DYN_SCLK_PWMEM_PIPE        0x000d </span><span class="cm">/* PLL */</span><span class="cp"></span>
<span class="cp">#define R300_GB_TILE_CONFIG             0x4018</span>
<span class="cp">#       define R300_ENABLE_TILING       (1 &lt;&lt; 0)</span>
<span class="cp">#       define R300_PIPE_COUNT_RV350    (0 &lt;&lt; 1)</span>
<span class="cp">#       define R300_PIPE_COUNT_R300     (3 &lt;&lt; 1)</span>
<span class="cp">#       define R300_PIPE_COUNT_R420_3P  (6 &lt;&lt; 1)</span>
<span class="cp">#       define R300_PIPE_COUNT_R420     (7 &lt;&lt; 1)</span>
<span class="cp">#       define R300_TILE_SIZE_8         (0 &lt;&lt; 4)</span>
<span class="cp">#       define R300_TILE_SIZE_16        (1 &lt;&lt; 4)</span>
<span class="cp">#       define R300_TILE_SIZE_32        (2 &lt;&lt; 4)</span>
<span class="cp">#       define R300_SUBPIXEL_1_12       (0 &lt;&lt; 16)</span>
<span class="cp">#       define R300_SUBPIXEL_1_16       (1 &lt;&lt; 16)</span>
<span class="cp">#define R300_DST_PIPE_CONFIG            0x170c</span>
<span class="cp">#       define R300_PIPE_AUTO_CONFIG    (1 &lt;&lt; 31)</span>
<span class="cp">#define R300_RB2D_DSTCACHE_MODE         0x3428</span>
<span class="cp">#       define R300_DC_AUTOFLUSH_ENABLE (1 &lt;&lt; 8)</span>
<span class="cp">#       define R300_DC_DC_DISABLE_IGNORE_PE (1 &lt;&lt; 17)</span>

<span class="cp">#define RADEON_RB3D_COLOROFFSET		0x1c40</span>
<span class="cp">#define RADEON_RB3D_COLORPITCH		0x1c48</span>

<span class="cp">#define	RADEON_SRC_X_Y			0x1590</span>

<span class="cp">#define RADEON_DP_GUI_MASTER_CNTL	0x146c</span>
<span class="cp">#	define RADEON_GMC_SRC_PITCH_OFFSET_CNTL	(1 &lt;&lt; 0)</span>
<span class="cp">#	define RADEON_GMC_DST_PITCH_OFFSET_CNTL	(1 &lt;&lt; 1)</span>
<span class="cp">#	define RADEON_GMC_BRUSH_SOLID_COLOR	(13 &lt;&lt; 4)</span>
<span class="cp">#	define RADEON_GMC_BRUSH_NONE		(15 &lt;&lt; 4)</span>
<span class="cp">#	define RADEON_GMC_DST_16BPP		(4 &lt;&lt; 8)</span>
<span class="cp">#	define RADEON_GMC_DST_24BPP		(5 &lt;&lt; 8)</span>
<span class="cp">#	define RADEON_GMC_DST_32BPP		(6 &lt;&lt; 8)</span>
<span class="cp">#	define RADEON_GMC_DST_DATATYPE_SHIFT	8</span>
<span class="cp">#	define RADEON_GMC_SRC_DATATYPE_COLOR	(3 &lt;&lt; 12)</span>
<span class="cp">#	define RADEON_DP_SRC_SOURCE_MEMORY	(2 &lt;&lt; 24)</span>
<span class="cp">#	define RADEON_DP_SRC_SOURCE_HOST_DATA	(3 &lt;&lt; 24)</span>
<span class="cp">#	define RADEON_GMC_CLR_CMP_CNTL_DIS	(1 &lt;&lt; 28)</span>
<span class="cp">#	define RADEON_GMC_WR_MSK_DIS		(1 &lt;&lt; 30)</span>
<span class="cp">#	define RADEON_ROP3_S			0x00cc0000</span>
<span class="cp">#	define RADEON_ROP3_P			0x00f00000</span>
<span class="cp">#define RADEON_DP_WRITE_MASK		0x16cc</span>
<span class="cp">#define RADEON_SRC_PITCH_OFFSET		0x1428</span>
<span class="cp">#define RADEON_DST_PITCH_OFFSET		0x142c</span>
<span class="cp">#define RADEON_DST_PITCH_OFFSET_C	0x1c80</span>
<span class="cp">#	define RADEON_DST_TILE_LINEAR		(0 &lt;&lt; 30)</span>
<span class="cp">#	define RADEON_DST_TILE_MACRO		(1 &lt;&lt; 30)</span>
<span class="cp">#	define RADEON_DST_TILE_MICRO		(2 &lt;&lt; 30)</span>
<span class="cp">#	define RADEON_DST_TILE_BOTH		(3 &lt;&lt; 30)</span>

<span class="cp">#define RADEON_SCRATCH_REG0		0x15e0</span>
<span class="cp">#define RADEON_SCRATCH_REG1		0x15e4</span>
<span class="cp">#define RADEON_SCRATCH_REG2		0x15e8</span>
<span class="cp">#define RADEON_SCRATCH_REG3		0x15ec</span>
<span class="cp">#define RADEON_SCRATCH_REG4		0x15f0</span>
<span class="cp">#define RADEON_SCRATCH_REG5		0x15f4</span>
<span class="cp">#define RADEON_SCRATCH_UMSK		0x0770</span>
<span class="cp">#define RADEON_SCRATCH_ADDR		0x0774</span>

<span class="cp">#define RADEON_SCRATCHOFF( x )		(RADEON_SCRATCH_REG_OFFSET + 4*(x))</span>

<span class="k">extern</span> <span class="n">u32</span> <span class="n">radeon_get_scratch</span><span class="p">(</span><span class="n">drm_radeon_private_t</span> <span class="o">*</span><span class="n">dev_priv</span><span class="p">,</span> <span class="kt">int</span> <span class="n">index</span><span class="p">);</span>

<span class="cp">#define GET_SCRATCH(dev_priv, x) radeon_get_scratch(dev_priv, x)</span>

<span class="cp">#define R600_SCRATCH_REG0		0x8500</span>
<span class="cp">#define R600_SCRATCH_REG1		0x8504</span>
<span class="cp">#define R600_SCRATCH_REG2		0x8508</span>
<span class="cp">#define R600_SCRATCH_REG3		0x850c</span>
<span class="cp">#define R600_SCRATCH_REG4		0x8510</span>
<span class="cp">#define R600_SCRATCH_REG5		0x8514</span>
<span class="cp">#define R600_SCRATCH_REG6		0x8518</span>
<span class="cp">#define R600_SCRATCH_REG7		0x851c</span>
<span class="cp">#define R600_SCRATCH_UMSK		0x8540</span>
<span class="cp">#define R600_SCRATCH_ADDR		0x8544</span>

<span class="cp">#define R600_SCRATCHOFF(x)		(R600_SCRATCH_REG_OFFSET + 4*(x))</span>

<span class="cp">#define RADEON_GEN_INT_CNTL		0x0040</span>
<span class="cp">#	define RADEON_CRTC_VBLANK_MASK		(1 &lt;&lt; 0)</span>
<span class="cp">#	define RADEON_CRTC2_VBLANK_MASK		(1 &lt;&lt; 9)</span>
<span class="cp">#	define RADEON_GUI_IDLE_INT_ENABLE	(1 &lt;&lt; 19)</span>
<span class="cp">#	define RADEON_SW_INT_ENABLE		(1 &lt;&lt; 25)</span>

<span class="cp">#define RADEON_GEN_INT_STATUS		0x0044</span>
<span class="cp">#	define RADEON_CRTC_VBLANK_STAT		(1 &lt;&lt; 0)</span>
<span class="cp">#	define RADEON_CRTC_VBLANK_STAT_ACK	(1 &lt;&lt; 0)</span>
<span class="cp">#	define RADEON_CRTC2_VBLANK_STAT		(1 &lt;&lt; 9)</span>
<span class="cp">#	define RADEON_CRTC2_VBLANK_STAT_ACK	(1 &lt;&lt; 9)</span>
<span class="cp">#	define RADEON_GUI_IDLE_INT_TEST_ACK     (1 &lt;&lt; 19)</span>
<span class="cp">#	define RADEON_SW_INT_TEST		(1 &lt;&lt; 25)</span>
<span class="cp">#	define RADEON_SW_INT_TEST_ACK		(1 &lt;&lt; 25)</span>
<span class="cp">#	define RADEON_SW_INT_FIRE		(1 &lt;&lt; 26)</span>
<span class="cp">#       define R500_DISPLAY_INT_STATUS          (1 &lt;&lt; 0)</span>

<span class="cp">#define RADEON_HOST_PATH_CNTL		0x0130</span>
<span class="cp">#	define RADEON_HDP_SOFT_RESET		(1 &lt;&lt; 26)</span>
<span class="cp">#	define RADEON_HDP_WC_TIMEOUT_MASK	(7 &lt;&lt; 28)</span>
<span class="cp">#	define RADEON_HDP_WC_TIMEOUT_28BCLK	(7 &lt;&lt; 28)</span>

<span class="cp">#define RADEON_ISYNC_CNTL		0x1724</span>
<span class="cp">#	define RADEON_ISYNC_ANY2D_IDLE3D	(1 &lt;&lt; 0)</span>
<span class="cp">#	define RADEON_ISYNC_ANY3D_IDLE2D	(1 &lt;&lt; 1)</span>
<span class="cp">#	define RADEON_ISYNC_TRIG2D_IDLE3D	(1 &lt;&lt; 2)</span>
<span class="cp">#	define RADEON_ISYNC_TRIG3D_IDLE2D	(1 &lt;&lt; 3)</span>
<span class="cp">#	define RADEON_ISYNC_WAIT_IDLEGUI	(1 &lt;&lt; 4)</span>
<span class="cp">#	define RADEON_ISYNC_CPSCRATCH_IDLEGUI	(1 &lt;&lt; 5)</span>

<span class="cp">#define RADEON_RBBM_GUICNTL		0x172c</span>
<span class="cp">#	define RADEON_HOST_DATA_SWAP_NONE	(0 &lt;&lt; 0)</span>
<span class="cp">#	define RADEON_HOST_DATA_SWAP_16BIT	(1 &lt;&lt; 0)</span>
<span class="cp">#	define RADEON_HOST_DATA_SWAP_32BIT	(2 &lt;&lt; 0)</span>
<span class="cp">#	define RADEON_HOST_DATA_SWAP_HDW	(3 &lt;&lt; 0)</span>

<span class="cp">#define RADEON_MC_AGP_LOCATION		0x014c</span>
<span class="cp">#define RADEON_MC_FB_LOCATION		0x0148</span>
<span class="cp">#define RADEON_MCLK_CNTL		0x0012</span>
<span class="cp">#	define RADEON_FORCEON_MCLKA		(1 &lt;&lt; 16)</span>
<span class="cp">#	define RADEON_FORCEON_MCLKB		(1 &lt;&lt; 17)</span>
<span class="cp">#	define RADEON_FORCEON_YCLKA		(1 &lt;&lt; 18)</span>
<span class="cp">#	define RADEON_FORCEON_YCLKB		(1 &lt;&lt; 19)</span>
<span class="cp">#	define RADEON_FORCEON_MC		(1 &lt;&lt; 20)</span>
<span class="cp">#	define RADEON_FORCEON_AIC		(1 &lt;&lt; 21)</span>

<span class="cp">#define RADEON_PP_BORDER_COLOR_0	0x1d40</span>
<span class="cp">#define RADEON_PP_BORDER_COLOR_1	0x1d44</span>
<span class="cp">#define RADEON_PP_BORDER_COLOR_2	0x1d48</span>
<span class="cp">#define RADEON_PP_CNTL			0x1c38</span>
<span class="cp">#	define RADEON_SCISSOR_ENABLE		(1 &lt;&lt;  1)</span>
<span class="cp">#define RADEON_PP_LUM_MATRIX		0x1d00</span>
<span class="cp">#define RADEON_PP_MISC			0x1c14</span>
<span class="cp">#define RADEON_PP_ROT_MATRIX_0		0x1d58</span>
<span class="cp">#define RADEON_PP_TXFILTER_0		0x1c54</span>
<span class="cp">#define RADEON_PP_TXOFFSET_0		0x1c5c</span>
<span class="cp">#define RADEON_PP_TXFILTER_1		0x1c6c</span>
<span class="cp">#define RADEON_PP_TXFILTER_2		0x1c84</span>

<span class="cp">#define R300_RB2D_DSTCACHE_CTLSTAT	0x342c </span><span class="cm">/* use R300_DSTCACHE_CTLSTAT */</span><span class="cp"></span>
<span class="cp">#define R300_DSTCACHE_CTLSTAT		0x1714</span>
<span class="cp">#	define R300_RB2D_DC_FLUSH		(3 &lt;&lt; 0)</span>
<span class="cp">#	define R300_RB2D_DC_FREE		(3 &lt;&lt; 2)</span>
<span class="cp">#	define R300_RB2D_DC_FLUSH_ALL		0xf</span>
<span class="cp">#	define R300_RB2D_DC_BUSY		(1 &lt;&lt; 31)</span>
<span class="cp">#define RADEON_RB3D_CNTL		0x1c3c</span>
<span class="cp">#	define RADEON_ALPHA_BLEND_ENABLE	(1 &lt;&lt; 0)</span>
<span class="cp">#	define RADEON_PLANE_MASK_ENABLE		(1 &lt;&lt; 1)</span>
<span class="cp">#	define RADEON_DITHER_ENABLE		(1 &lt;&lt; 2)</span>
<span class="cp">#	define RADEON_ROUND_ENABLE		(1 &lt;&lt; 3)</span>
<span class="cp">#	define RADEON_SCALE_DITHER_ENABLE	(1 &lt;&lt; 4)</span>
<span class="cp">#	define RADEON_DITHER_INIT		(1 &lt;&lt; 5)</span>
<span class="cp">#	define RADEON_ROP_ENABLE		(1 &lt;&lt; 6)</span>
<span class="cp">#	define RADEON_STENCIL_ENABLE		(1 &lt;&lt; 7)</span>
<span class="cp">#	define RADEON_Z_ENABLE			(1 &lt;&lt; 8)</span>
<span class="cp">#	define RADEON_ZBLOCK16			(1 &lt;&lt; 15)</span>
<span class="cp">#define RADEON_RB3D_DEPTHOFFSET		0x1c24</span>
<span class="cp">#define RADEON_RB3D_DEPTHCLEARVALUE	0x3230</span>
<span class="cp">#define RADEON_RB3D_DEPTHPITCH		0x1c28</span>
<span class="cp">#define RADEON_RB3D_PLANEMASK		0x1d84</span>
<span class="cp">#define RADEON_RB3D_STENCILREFMASK	0x1d7c</span>
<span class="cp">#define RADEON_RB3D_ZCACHE_MODE		0x3250</span>
<span class="cp">#define RADEON_RB3D_ZCACHE_CTLSTAT	0x3254</span>
<span class="cp">#	define RADEON_RB3D_ZC_FLUSH		(1 &lt;&lt; 0)</span>
<span class="cp">#	define RADEON_RB3D_ZC_FREE		(1 &lt;&lt; 2)</span>
<span class="cp">#	define RADEON_RB3D_ZC_FLUSH_ALL		0x5</span>
<span class="cp">#	define RADEON_RB3D_ZC_BUSY		(1 &lt;&lt; 31)</span>
<span class="cp">#define R300_ZB_ZCACHE_CTLSTAT                  0x4f18</span>
<span class="cp">#	define R300_ZC_FLUSH		        (1 &lt;&lt; 0)</span>
<span class="cp">#	define R300_ZC_FREE		        (1 &lt;&lt; 1)</span>
<span class="cp">#	define R300_ZC_BUSY		        (1 &lt;&lt; 31)</span>
<span class="cp">#define RADEON_RB3D_DSTCACHE_CTLSTAT	0x325c</span>
<span class="cp">#	define RADEON_RB3D_DC_FLUSH		(3 &lt;&lt; 0)</span>
<span class="cp">#	define RADEON_RB3D_DC_FREE		(3 &lt;&lt; 2)</span>
<span class="cp">#	define RADEON_RB3D_DC_FLUSH_ALL		0xf</span>
<span class="cp">#	define RADEON_RB3D_DC_BUSY		(1 &lt;&lt; 31)</span>
<span class="cp">#define R300_RB3D_DSTCACHE_CTLSTAT              0x4e4c</span>
<span class="cp">#	define R300_RB3D_DC_FLUSH		(2 &lt;&lt; 0)</span>
<span class="cp">#	define R300_RB3D_DC_FREE		(2 &lt;&lt; 2)</span>
<span class="cp">#	define R300_RB3D_DC_FINISH		(1 &lt;&lt; 4)</span>
<span class="cp">#define RADEON_RB3D_ZSTENCILCNTL	0x1c2c</span>
<span class="cp">#	define RADEON_Z_TEST_MASK		(7 &lt;&lt; 4)</span>
<span class="cp">#	define RADEON_Z_TEST_ALWAYS		(7 &lt;&lt; 4)</span>
<span class="cp">#	define RADEON_Z_HIERARCHY_ENABLE	(1 &lt;&lt; 8)</span>
<span class="cp">#	define RADEON_STENCIL_TEST_ALWAYS	(7 &lt;&lt; 12)</span>
<span class="cp">#	define RADEON_STENCIL_S_FAIL_REPLACE	(2 &lt;&lt; 16)</span>
<span class="cp">#	define RADEON_STENCIL_ZPASS_REPLACE	(2 &lt;&lt; 20)</span>
<span class="cp">#	define RADEON_STENCIL_ZFAIL_REPLACE	(2 &lt;&lt; 24)</span>
<span class="cp">#	define RADEON_Z_COMPRESSION_ENABLE	(1 &lt;&lt; 28)</span>
<span class="cp">#	define RADEON_FORCE_Z_DIRTY		(1 &lt;&lt; 29)</span>
<span class="cp">#	define RADEON_Z_WRITE_ENABLE		(1 &lt;&lt; 30)</span>
<span class="cp">#	define RADEON_Z_DECOMPRESSION_ENABLE	(1 &lt;&lt; 31)</span>
<span class="cp">#define RADEON_RBBM_SOFT_RESET		0x00f0</span>
<span class="cp">#	define RADEON_SOFT_RESET_CP		(1 &lt;&lt;  0)</span>
<span class="cp">#	define RADEON_SOFT_RESET_HI		(1 &lt;&lt;  1)</span>
<span class="cp">#	define RADEON_SOFT_RESET_SE		(1 &lt;&lt;  2)</span>
<span class="cp">#	define RADEON_SOFT_RESET_RE		(1 &lt;&lt;  3)</span>
<span class="cp">#	define RADEON_SOFT_RESET_PP		(1 &lt;&lt;  4)</span>
<span class="cp">#	define RADEON_SOFT_RESET_E2		(1 &lt;&lt;  5)</span>
<span class="cp">#	define RADEON_SOFT_RESET_RB		(1 &lt;&lt;  6)</span>
<span class="cp">#	define RADEON_SOFT_RESET_HDP		(1 &lt;&lt;  7)</span>
<span class="cm">/*</span>
<span class="cm"> *   6:0  Available slots in the FIFO</span>
<span class="cm"> *   8    Host Interface active</span>
<span class="cm"> *   9    CP request active</span>
<span class="cm"> *   10   FIFO request active</span>
<span class="cm"> *   11   Host Interface retry active</span>
<span class="cm"> *   12   CP retry active</span>
<span class="cm"> *   13   FIFO retry active</span>
<span class="cm"> *   14   FIFO pipeline busy</span>
<span class="cm"> *   15   Event engine busy</span>
<span class="cm"> *   16   CP command stream busy</span>
<span class="cm"> *   17   2D engine busy</span>
<span class="cm"> *   18   2D portion of render backend busy</span>
<span class="cm"> *   20   3D setup engine busy</span>
<span class="cm"> *   26   GA engine busy</span>
<span class="cm"> *   27   CBA 2D engine busy</span>
<span class="cm"> *   31   2D engine busy or 3D engine busy or FIFO not empty or CP busy or</span>
<span class="cm"> *           command stream queue not empty or Ring Buffer not empty</span>
<span class="cm"> */</span>
<span class="cp">#define RADEON_RBBM_STATUS		0x0e40</span>
<span class="cm">/* Same as the previous RADEON_RBBM_STATUS; this is a mirror of that register.  */</span>
<span class="cm">/* #define RADEON_RBBM_STATUS		0x1740 */</span>
<span class="cm">/* bits 6:0 are dword slots available in the cmd fifo */</span>
<span class="cp">#	define RADEON_RBBM_FIFOCNT_MASK		0x007f</span>
<span class="cp">#	define RADEON_HIRQ_ON_RBB	(1 &lt;&lt;  8)</span>
<span class="cp">#	define RADEON_CPRQ_ON_RBB	(1 &lt;&lt;  9)</span>
<span class="cp">#	define RADEON_CFRQ_ON_RBB	(1 &lt;&lt; 10)</span>
<span class="cp">#	define RADEON_HIRQ_IN_RTBUF	(1 &lt;&lt; 11)</span>
<span class="cp">#	define RADEON_CPRQ_IN_RTBUF	(1 &lt;&lt; 12)</span>
<span class="cp">#	define RADEON_CFRQ_IN_RTBUF	(1 &lt;&lt; 13)</span>
<span class="cp">#	define RADEON_PIPE_BUSY		(1 &lt;&lt; 14)</span>
<span class="cp">#	define RADEON_ENG_EV_BUSY	(1 &lt;&lt; 15)</span>
<span class="cp">#	define RADEON_CP_CMDSTRM_BUSY	(1 &lt;&lt; 16)</span>
<span class="cp">#	define RADEON_E2_BUSY		(1 &lt;&lt; 17)</span>
<span class="cp">#	define RADEON_RB2D_BUSY		(1 &lt;&lt; 18)</span>
<span class="cp">#	define RADEON_RB3D_BUSY		(1 &lt;&lt; 19) </span><span class="cm">/* not used on r300 */</span><span class="cp"></span>
<span class="cp">#	define RADEON_VAP_BUSY		(1 &lt;&lt; 20)</span>
<span class="cp">#	define RADEON_RE_BUSY		(1 &lt;&lt; 21) </span><span class="cm">/* not used on r300 */</span><span class="cp"></span>
<span class="cp">#	define RADEON_TAM_BUSY		(1 &lt;&lt; 22) </span><span class="cm">/* not used on r300 */</span><span class="cp"></span>
<span class="cp">#	define RADEON_TDM_BUSY		(1 &lt;&lt; 23) </span><span class="cm">/* not used on r300 */</span><span class="cp"></span>
<span class="cp">#	define RADEON_PB_BUSY		(1 &lt;&lt; 24) </span><span class="cm">/* not used on r300 */</span><span class="cp"></span>
<span class="cp">#	define RADEON_TIM_BUSY		(1 &lt;&lt; 25) </span><span class="cm">/* not used on r300 */</span><span class="cp"></span>
<span class="cp">#	define RADEON_GA_BUSY		(1 &lt;&lt; 26)</span>
<span class="cp">#	define RADEON_CBA2D_BUSY	(1 &lt;&lt; 27)</span>
<span class="cp">#	define RADEON_RBBM_ACTIVE	(1 &lt;&lt; 31)</span>
<span class="cp">#define RADEON_RE_LINE_PATTERN		0x1cd0</span>
<span class="cp">#define RADEON_RE_MISC			0x26c4</span>
<span class="cp">#define RADEON_RE_TOP_LEFT		0x26c0</span>
<span class="cp">#define RADEON_RE_WIDTH_HEIGHT		0x1c44</span>
<span class="cp">#define RADEON_RE_STIPPLE_ADDR		0x1cc8</span>
<span class="cp">#define RADEON_RE_STIPPLE_DATA		0x1ccc</span>

<span class="cp">#define RADEON_SCISSOR_TL_0		0x1cd8</span>
<span class="cp">#define RADEON_SCISSOR_BR_0		0x1cdc</span>
<span class="cp">#define RADEON_SCISSOR_TL_1		0x1ce0</span>
<span class="cp">#define RADEON_SCISSOR_BR_1		0x1ce4</span>
<span class="cp">#define RADEON_SCISSOR_TL_2		0x1ce8</span>
<span class="cp">#define RADEON_SCISSOR_BR_2		0x1cec</span>
<span class="cp">#define RADEON_SE_COORD_FMT		0x1c50</span>
<span class="cp">#define RADEON_SE_CNTL			0x1c4c</span>
<span class="cp">#	define RADEON_FFACE_CULL_CW		(0 &lt;&lt; 0)</span>
<span class="cp">#	define RADEON_BFACE_SOLID		(3 &lt;&lt; 1)</span>
<span class="cp">#	define RADEON_FFACE_SOLID		(3 &lt;&lt; 3)</span>
<span class="cp">#	define RADEON_FLAT_SHADE_VTX_LAST	(3 &lt;&lt; 6)</span>
<span class="cp">#	define RADEON_DIFFUSE_SHADE_FLAT	(1 &lt;&lt; 8)</span>
<span class="cp">#	define RADEON_DIFFUSE_SHADE_GOURAUD	(2 &lt;&lt; 8)</span>
<span class="cp">#	define RADEON_ALPHA_SHADE_FLAT		(1 &lt;&lt; 10)</span>
<span class="cp">#	define RADEON_ALPHA_SHADE_GOURAUD	(2 &lt;&lt; 10)</span>
<span class="cp">#	define RADEON_SPECULAR_SHADE_FLAT	(1 &lt;&lt; 12)</span>
<span class="cp">#	define RADEON_SPECULAR_SHADE_GOURAUD	(2 &lt;&lt; 12)</span>
<span class="cp">#	define RADEON_FOG_SHADE_FLAT		(1 &lt;&lt; 14)</span>
<span class="cp">#	define RADEON_FOG_SHADE_GOURAUD		(2 &lt;&lt; 14)</span>
<span class="cp">#	define RADEON_VPORT_XY_XFORM_ENABLE	(1 &lt;&lt; 24)</span>
<span class="cp">#	define RADEON_VPORT_Z_XFORM_ENABLE	(1 &lt;&lt; 25)</span>
<span class="cp">#	define RADEON_VTX_PIX_CENTER_OGL	(1 &lt;&lt; 27)</span>
<span class="cp">#	define RADEON_ROUND_MODE_TRUNC		(0 &lt;&lt; 28)</span>
<span class="cp">#	define RADEON_ROUND_PREC_8TH_PIX	(1 &lt;&lt; 30)</span>
<span class="cp">#define RADEON_SE_CNTL_STATUS		0x2140</span>
<span class="cp">#define RADEON_SE_LINE_WIDTH		0x1db8</span>
<span class="cp">#define RADEON_SE_VPORT_XSCALE		0x1d98</span>
<span class="cp">#define RADEON_SE_ZBIAS_FACTOR		0x1db0</span>
<span class="cp">#define RADEON_SE_TCL_MATERIAL_EMMISSIVE_RED 0x2210</span>
<span class="cp">#define RADEON_SE_TCL_OUTPUT_VTX_FMT         0x2254</span>
<span class="cp">#define RADEON_SE_TCL_VECTOR_INDX_REG        0x2200</span>
<span class="cp">#       define RADEON_VEC_INDX_OCTWORD_STRIDE_SHIFT  16</span>
<span class="cp">#       define RADEON_VEC_INDX_DWORD_COUNT_SHIFT     28</span>
<span class="cp">#define RADEON_SE_TCL_VECTOR_DATA_REG       0x2204</span>
<span class="cp">#define RADEON_SE_TCL_SCALAR_INDX_REG       0x2208</span>
<span class="cp">#       define RADEON_SCAL_INDX_DWORD_STRIDE_SHIFT  16</span>
<span class="cp">#define RADEON_SE_TCL_SCALAR_DATA_REG       0x220C</span>
<span class="cp">#define RADEON_SURFACE_ACCESS_FLAGS	0x0bf8</span>
<span class="cp">#define RADEON_SURFACE_ACCESS_CLR	0x0bfc</span>
<span class="cp">#define RADEON_SURFACE_CNTL		0x0b00</span>
<span class="cp">#	define RADEON_SURF_TRANSLATION_DIS	(1 &lt;&lt; 8)</span>
<span class="cp">#	define RADEON_NONSURF_AP0_SWP_MASK	(3 &lt;&lt; 20)</span>
<span class="cp">#	define RADEON_NONSURF_AP0_SWP_LITTLE	(0 &lt;&lt; 20)</span>
<span class="cp">#	define RADEON_NONSURF_AP0_SWP_BIG16	(1 &lt;&lt; 20)</span>
<span class="cp">#	define RADEON_NONSURF_AP0_SWP_BIG32	(2 &lt;&lt; 20)</span>
<span class="cp">#	define RADEON_NONSURF_AP1_SWP_MASK	(3 &lt;&lt; 22)</span>
<span class="cp">#	define RADEON_NONSURF_AP1_SWP_LITTLE	(0 &lt;&lt; 22)</span>
<span class="cp">#	define RADEON_NONSURF_AP1_SWP_BIG16	(1 &lt;&lt; 22)</span>
<span class="cp">#	define RADEON_NONSURF_AP1_SWP_BIG32	(2 &lt;&lt; 22)</span>
<span class="cp">#define RADEON_SURFACE0_INFO		0x0b0c</span>
<span class="cp">#	define RADEON_SURF_PITCHSEL_MASK	(0x1ff &lt;&lt; 0)</span>
<span class="cp">#	define RADEON_SURF_TILE_MODE_MASK	(3 &lt;&lt; 16)</span>
<span class="cp">#	define RADEON_SURF_TILE_MODE_MACRO	(0 &lt;&lt; 16)</span>
<span class="cp">#	define RADEON_SURF_TILE_MODE_MICRO	(1 &lt;&lt; 16)</span>
<span class="cp">#	define RADEON_SURF_TILE_MODE_32BIT_Z	(2 &lt;&lt; 16)</span>
<span class="cp">#	define RADEON_SURF_TILE_MODE_16BIT_Z	(3 &lt;&lt; 16)</span>
<span class="cp">#define RADEON_SURFACE0_LOWER_BOUND	0x0b04</span>
<span class="cp">#define RADEON_SURFACE0_UPPER_BOUND	0x0b08</span>
<span class="cp">#	define RADEON_SURF_ADDRESS_FIXED_MASK	(0x3ff &lt;&lt; 0)</span>
<span class="cp">#define RADEON_SURFACE1_INFO		0x0b1c</span>
<span class="cp">#define RADEON_SURFACE1_LOWER_BOUND	0x0b14</span>
<span class="cp">#define RADEON_SURFACE1_UPPER_BOUND	0x0b18</span>
<span class="cp">#define RADEON_SURFACE2_INFO		0x0b2c</span>
<span class="cp">#define RADEON_SURFACE2_LOWER_BOUND	0x0b24</span>
<span class="cp">#define RADEON_SURFACE2_UPPER_BOUND	0x0b28</span>
<span class="cp">#define RADEON_SURFACE3_INFO		0x0b3c</span>
<span class="cp">#define RADEON_SURFACE3_LOWER_BOUND	0x0b34</span>
<span class="cp">#define RADEON_SURFACE3_UPPER_BOUND	0x0b38</span>
<span class="cp">#define RADEON_SURFACE4_INFO		0x0b4c</span>
<span class="cp">#define RADEON_SURFACE4_LOWER_BOUND	0x0b44</span>
<span class="cp">#define RADEON_SURFACE4_UPPER_BOUND	0x0b48</span>
<span class="cp">#define RADEON_SURFACE5_INFO		0x0b5c</span>
<span class="cp">#define RADEON_SURFACE5_LOWER_BOUND	0x0b54</span>
<span class="cp">#define RADEON_SURFACE5_UPPER_BOUND	0x0b58</span>
<span class="cp">#define RADEON_SURFACE6_INFO		0x0b6c</span>
<span class="cp">#define RADEON_SURFACE6_LOWER_BOUND	0x0b64</span>
<span class="cp">#define RADEON_SURFACE6_UPPER_BOUND	0x0b68</span>
<span class="cp">#define RADEON_SURFACE7_INFO		0x0b7c</span>
<span class="cp">#define RADEON_SURFACE7_LOWER_BOUND	0x0b74</span>
<span class="cp">#define RADEON_SURFACE7_UPPER_BOUND	0x0b78</span>
<span class="cp">#define RADEON_SW_SEMAPHORE		0x013c</span>

<span class="cp">#define RADEON_WAIT_UNTIL		0x1720</span>
<span class="cp">#	define RADEON_WAIT_CRTC_PFLIP		(1 &lt;&lt; 0)</span>
<span class="cp">#	define RADEON_WAIT_2D_IDLE		(1 &lt;&lt; 14)</span>
<span class="cp">#	define RADEON_WAIT_3D_IDLE		(1 &lt;&lt; 15)</span>
<span class="cp">#	define RADEON_WAIT_2D_IDLECLEAN		(1 &lt;&lt; 16)</span>
<span class="cp">#	define RADEON_WAIT_3D_IDLECLEAN		(1 &lt;&lt; 17)</span>
<span class="cp">#	define RADEON_WAIT_HOST_IDLECLEAN	(1 &lt;&lt; 18)</span>

<span class="cp">#define RADEON_RB3D_ZMASKOFFSET		0x3234</span>
<span class="cp">#define RADEON_RB3D_ZSTENCILCNTL	0x1c2c</span>
<span class="cp">#	define RADEON_DEPTH_FORMAT_16BIT_INT_Z	(0 &lt;&lt; 0)</span>
<span class="cp">#	define RADEON_DEPTH_FORMAT_24BIT_INT_Z	(2 &lt;&lt; 0)</span>

<span class="cm">/* CP registers */</span>
<span class="cp">#define RADEON_CP_ME_RAM_ADDR		0x07d4</span>
<span class="cp">#define RADEON_CP_ME_RAM_RADDR		0x07d8</span>
<span class="cp">#define RADEON_CP_ME_RAM_DATAH		0x07dc</span>
<span class="cp">#define RADEON_CP_ME_RAM_DATAL		0x07e0</span>

<span class="cp">#define RADEON_CP_RB_BASE		0x0700</span>
<span class="cp">#define RADEON_CP_RB_CNTL		0x0704</span>
<span class="cp">#	define RADEON_BUF_SWAP_32BIT		(2 &lt;&lt; 16)</span>
<span class="cp">#	define RADEON_RB_NO_UPDATE		(1 &lt;&lt; 27)</span>
<span class="cp">#	define RADEON_RB_RPTR_WR_ENA		(1 &lt;&lt; 31)</span>
<span class="cp">#define RADEON_CP_RB_RPTR_ADDR		0x070c</span>
<span class="cp">#define RADEON_CP_RB_RPTR		0x0710</span>
<span class="cp">#define RADEON_CP_RB_WPTR		0x0714</span>

<span class="cp">#define RADEON_CP_RB_WPTR_DELAY		0x0718</span>
<span class="cp">#	define RADEON_PRE_WRITE_TIMER_SHIFT	0</span>
<span class="cp">#	define RADEON_PRE_WRITE_LIMIT_SHIFT	23</span>

<span class="cp">#define RADEON_CP_IB_BASE		0x0738</span>

<span class="cp">#define RADEON_CP_CSQ_CNTL		0x0740</span>
<span class="cp">#	define RADEON_CSQ_CNT_PRIMARY_MASK	(0xff &lt;&lt; 0)</span>
<span class="cp">#	define RADEON_CSQ_PRIDIS_INDDIS		(0 &lt;&lt; 28)</span>
<span class="cp">#	define RADEON_CSQ_PRIPIO_INDDIS		(1 &lt;&lt; 28)</span>
<span class="cp">#	define RADEON_CSQ_PRIBM_INDDIS		(2 &lt;&lt; 28)</span>
<span class="cp">#	define RADEON_CSQ_PRIPIO_INDBM		(3 &lt;&lt; 28)</span>
<span class="cp">#	define RADEON_CSQ_PRIBM_INDBM		(4 &lt;&lt; 28)</span>
<span class="cp">#	define RADEON_CSQ_PRIPIO_INDPIO		(15 &lt;&lt; 28)</span>

<span class="cp">#define R300_CP_RESYNC_ADDR		0x0778</span>
<span class="cp">#define R300_CP_RESYNC_DATA		0x077c</span>

<span class="cp">#define RADEON_AIC_CNTL			0x01d0</span>
<span class="cp">#	define RADEON_PCIGART_TRANSLATE_EN	(1 &lt;&lt; 0)</span>
<span class="cp">#	define RS400_MSI_REARM	                (1 &lt;&lt; 3)</span>
<span class="cp">#define RADEON_AIC_STAT			0x01d4</span>
<span class="cp">#define RADEON_AIC_PT_BASE		0x01d8</span>
<span class="cp">#define RADEON_AIC_LO_ADDR		0x01dc</span>
<span class="cp">#define RADEON_AIC_HI_ADDR		0x01e0</span>
<span class="cp">#define RADEON_AIC_TLB_ADDR		0x01e4</span>
<span class="cp">#define RADEON_AIC_TLB_DATA		0x01e8</span>

<span class="cm">/* CP command packets */</span>
<span class="cp">#define RADEON_CP_PACKET0		0x00000000</span>
<span class="cp">#	define RADEON_ONE_REG_WR		(1 &lt;&lt; 15)</span>
<span class="cp">#define RADEON_CP_PACKET1		0x40000000</span>
<span class="cp">#define RADEON_CP_PACKET2		0x80000000</span>
<span class="cp">#define RADEON_CP_PACKET3		0xC0000000</span>
<span class="cp">#       define RADEON_CP_NOP                    0x00001000</span>
<span class="cp">#       define RADEON_CP_NEXT_CHAR              0x00001900</span>
<span class="cp">#       define RADEON_CP_PLY_NEXTSCAN           0x00001D00</span>
<span class="cp">#       define RADEON_CP_SET_SCISSORS           0x00001E00</span>
	     <span class="cm">/* GEN_INDX_PRIM is unsupported starting with R300 */</span>
<span class="cp">#	define RADEON_3D_RNDR_GEN_INDX_PRIM	0x00002300</span>
<span class="cp">#	define RADEON_WAIT_FOR_IDLE		0x00002600</span>
<span class="cp">#	define RADEON_3D_DRAW_VBUF		0x00002800</span>
<span class="cp">#	define RADEON_3D_DRAW_IMMD		0x00002900</span>
<span class="cp">#	define RADEON_3D_DRAW_INDX		0x00002A00</span>
<span class="cp">#       define RADEON_CP_LOAD_PALETTE           0x00002C00</span>
<span class="cp">#	define RADEON_3D_LOAD_VBPNTR		0x00002F00</span>
<span class="cp">#	define RADEON_MPEG_IDCT_MACROBLOCK	0x00003000</span>
<span class="cp">#	define RADEON_MPEG_IDCT_MACROBLOCK_REV	0x00003100</span>
<span class="cp">#	define RADEON_3D_CLEAR_ZMASK		0x00003200</span>
<span class="cp">#	define RADEON_CP_INDX_BUFFER		0x00003300</span>
<span class="cp">#       define RADEON_CP_3D_DRAW_VBUF_2         0x00003400</span>
<span class="cp">#       define RADEON_CP_3D_DRAW_IMMD_2         0x00003500</span>
<span class="cp">#       define RADEON_CP_3D_DRAW_INDX_2         0x00003600</span>
<span class="cp">#	define RADEON_3D_CLEAR_HIZ		0x00003700</span>
<span class="cp">#       define RADEON_CP_3D_CLEAR_CMASK         0x00003802</span>
<span class="cp">#	define RADEON_CNTL_HOSTDATA_BLT		0x00009400</span>
<span class="cp">#	define RADEON_CNTL_PAINT_MULTI		0x00009A00</span>
<span class="cp">#	define RADEON_CNTL_BITBLT_MULTI		0x00009B00</span>
<span class="cp">#	define RADEON_CNTL_SET_SCISSORS		0xC0001E00</span>

<span class="cp">#       define R600_IT_INDIRECT_BUFFER_END      0x00001700</span>
<span class="cp">#       define R600_IT_SET_PREDICATION          0x00002000</span>
<span class="cp">#       define R600_IT_REG_RMW                  0x00002100</span>
<span class="cp">#       define R600_IT_COND_EXEC                0x00002200</span>
<span class="cp">#       define R600_IT_PRED_EXEC                0x00002300</span>
<span class="cp">#       define R600_IT_START_3D_CMDBUF          0x00002400</span>
<span class="cp">#       define R600_IT_DRAW_INDEX_2             0x00002700</span>
<span class="cp">#       define R600_IT_CONTEXT_CONTROL          0x00002800</span>
<span class="cp">#       define R600_IT_DRAW_INDEX_IMMD_BE       0x00002900</span>
<span class="cp">#       define R600_IT_INDEX_TYPE               0x00002A00</span>
<span class="cp">#       define R600_IT_DRAW_INDEX               0x00002B00</span>
<span class="cp">#       define R600_IT_DRAW_INDEX_AUTO          0x00002D00</span>
<span class="cp">#       define R600_IT_DRAW_INDEX_IMMD          0x00002E00</span>
<span class="cp">#       define R600_IT_NUM_INSTANCES            0x00002F00</span>
<span class="cp">#       define R600_IT_STRMOUT_BUFFER_UPDATE    0x00003400</span>
<span class="cp">#       define R600_IT_INDIRECT_BUFFER_MP       0x00003800</span>
<span class="cp">#       define R600_IT_MEM_SEMAPHORE            0x00003900</span>
<span class="cp">#       define R600_IT_MPEG_INDEX               0x00003A00</span>
<span class="cp">#       define R600_IT_WAIT_REG_MEM             0x00003C00</span>
<span class="cp">#       define R600_IT_MEM_WRITE                0x00003D00</span>
<span class="cp">#       define R600_IT_INDIRECT_BUFFER          0x00003200</span>
<span class="cp">#       define R600_IT_SURFACE_SYNC             0x00004300</span>
<span class="cp">#              define R600_CB0_DEST_BASE_ENA    (1 &lt;&lt; 6)</span>
<span class="cp">#              define R600_TC_ACTION_ENA        (1 &lt;&lt; 23)</span>
<span class="cp">#              define R600_VC_ACTION_ENA        (1 &lt;&lt; 24)</span>
<span class="cp">#              define R600_CB_ACTION_ENA        (1 &lt;&lt; 25)</span>
<span class="cp">#              define R600_DB_ACTION_ENA        (1 &lt;&lt; 26)</span>
<span class="cp">#              define R600_SH_ACTION_ENA        (1 &lt;&lt; 27)</span>
<span class="cp">#              define R600_SMX_ACTION_ENA       (1 &lt;&lt; 28)</span>
<span class="cp">#       define R600_IT_ME_INITIALIZE            0x00004400</span>
<span class="cp">#	       define R600_ME_INITIALIZE_DEVICE_ID(x) ((x) &lt;&lt; 16)</span>
<span class="cp">#       define R600_IT_COND_WRITE               0x00004500</span>
<span class="cp">#       define R600_IT_EVENT_WRITE              0x00004600</span>
<span class="cp">#       define R600_IT_EVENT_WRITE_EOP          0x00004700</span>
<span class="cp">#       define R600_IT_ONE_REG_WRITE            0x00005700</span>
<span class="cp">#       define R600_IT_SET_CONFIG_REG           0x00006800</span>
<span class="cp">#              define R600_SET_CONFIG_REG_OFFSET 0x00008000</span>
<span class="cp">#              define R600_SET_CONFIG_REG_END   0x0000ac00</span>
<span class="cp">#       define R600_IT_SET_CONTEXT_REG          0x00006900</span>
<span class="cp">#              define R600_SET_CONTEXT_REG_OFFSET 0x00028000</span>
<span class="cp">#              define R600_SET_CONTEXT_REG_END  0x00029000</span>
<span class="cp">#       define R600_IT_SET_ALU_CONST            0x00006A00</span>
<span class="cp">#              define R600_SET_ALU_CONST_OFFSET 0x00030000</span>
<span class="cp">#              define R600_SET_ALU_CONST_END    0x00032000</span>
<span class="cp">#       define R600_IT_SET_BOOL_CONST           0x00006B00</span>
<span class="cp">#              define R600_SET_BOOL_CONST_OFFSET 0x0003e380</span>
<span class="cp">#              define R600_SET_BOOL_CONST_END   0x00040000</span>
<span class="cp">#       define R600_IT_SET_LOOP_CONST           0x00006C00</span>
<span class="cp">#              define R600_SET_LOOP_CONST_OFFSET 0x0003e200</span>
<span class="cp">#              define R600_SET_LOOP_CONST_END   0x0003e380</span>
<span class="cp">#       define R600_IT_SET_RESOURCE             0x00006D00</span>
<span class="cp">#              define R600_SET_RESOURCE_OFFSET  0x00038000</span>
<span class="cp">#              define R600_SET_RESOURCE_END     0x0003c000</span>
<span class="cp">#              define R600_SQ_TEX_VTX_INVALID_TEXTURE  0x0</span>
<span class="cp">#              define R600_SQ_TEX_VTX_INVALID_BUFFER   0x1</span>
<span class="cp">#              define R600_SQ_TEX_VTX_VALID_TEXTURE    0x2</span>
<span class="cp">#              define R600_SQ_TEX_VTX_VALID_BUFFER     0x3</span>
<span class="cp">#       define R600_IT_SET_SAMPLER              0x00006E00</span>
<span class="cp">#              define R600_SET_SAMPLER_OFFSET   0x0003c000</span>
<span class="cp">#              define R600_SET_SAMPLER_END      0x0003cff0</span>
<span class="cp">#       define R600_IT_SET_CTL_CONST            0x00006F00</span>
<span class="cp">#              define R600_SET_CTL_CONST_OFFSET 0x0003cff0</span>
<span class="cp">#              define R600_SET_CTL_CONST_END    0x0003e200</span>
<span class="cp">#       define R600_IT_SURFACE_BASE_UPDATE      0x00007300</span>

<span class="cp">#define RADEON_CP_PACKET_MASK		0xC0000000</span>
<span class="cp">#define RADEON_CP_PACKET_COUNT_MASK	0x3fff0000</span>
<span class="cp">#define RADEON_CP_PACKET0_REG_MASK	0x000007ff</span>
<span class="cp">#define RADEON_CP_PACKET1_REG0_MASK	0x000007ff</span>
<span class="cp">#define RADEON_CP_PACKET1_REG1_MASK	0x003ff800</span>

<span class="cp">#define RADEON_VTX_Z_PRESENT			(1 &lt;&lt; 31)</span>
<span class="cp">#define RADEON_VTX_PKCOLOR_PRESENT		(1 &lt;&lt; 3)</span>

<span class="cp">#define RADEON_PRIM_TYPE_NONE			(0 &lt;&lt; 0)</span>
<span class="cp">#define RADEON_PRIM_TYPE_POINT			(1 &lt;&lt; 0)</span>
<span class="cp">#define RADEON_PRIM_TYPE_LINE			(2 &lt;&lt; 0)</span>
<span class="cp">#define RADEON_PRIM_TYPE_LINE_STRIP		(3 &lt;&lt; 0)</span>
<span class="cp">#define RADEON_PRIM_TYPE_TRI_LIST		(4 &lt;&lt; 0)</span>
<span class="cp">#define RADEON_PRIM_TYPE_TRI_FAN		(5 &lt;&lt; 0)</span>
<span class="cp">#define RADEON_PRIM_TYPE_TRI_STRIP		(6 &lt;&lt; 0)</span>
<span class="cp">#define RADEON_PRIM_TYPE_TRI_TYPE2		(7 &lt;&lt; 0)</span>
<span class="cp">#define RADEON_PRIM_TYPE_RECT_LIST		(8 &lt;&lt; 0)</span>
<span class="cp">#define RADEON_PRIM_TYPE_3VRT_POINT_LIST	(9 &lt;&lt; 0)</span>
<span class="cp">#define RADEON_PRIM_TYPE_3VRT_LINE_LIST		(10 &lt;&lt; 0)</span>
<span class="cp">#define RADEON_PRIM_TYPE_MASK                   0xf</span>
<span class="cp">#define RADEON_PRIM_WALK_IND			(1 &lt;&lt; 4)</span>
<span class="cp">#define RADEON_PRIM_WALK_LIST			(2 &lt;&lt; 4)</span>
<span class="cp">#define RADEON_PRIM_WALK_RING			(3 &lt;&lt; 4)</span>
<span class="cp">#define RADEON_COLOR_ORDER_BGRA			(0 &lt;&lt; 6)</span>
<span class="cp">#define RADEON_COLOR_ORDER_RGBA			(1 &lt;&lt; 6)</span>
<span class="cp">#define RADEON_MAOS_ENABLE			(1 &lt;&lt; 7)</span>
<span class="cp">#define RADEON_VTX_FMT_R128_MODE		(0 &lt;&lt; 8)</span>
<span class="cp">#define RADEON_VTX_FMT_RADEON_MODE		(1 &lt;&lt; 8)</span>
<span class="cp">#define RADEON_NUM_VERTICES_SHIFT		16</span>

<span class="cp">#define RADEON_COLOR_FORMAT_CI8		2</span>
<span class="cp">#define RADEON_COLOR_FORMAT_ARGB1555	3</span>
<span class="cp">#define RADEON_COLOR_FORMAT_RGB565	4</span>
<span class="cp">#define RADEON_COLOR_FORMAT_ARGB8888	6</span>
<span class="cp">#define RADEON_COLOR_FORMAT_RGB332	7</span>
<span class="cp">#define RADEON_COLOR_FORMAT_RGB8	9</span>
<span class="cp">#define RADEON_COLOR_FORMAT_ARGB4444	15</span>

<span class="cp">#define RADEON_TXFORMAT_I8		0</span>
<span class="cp">#define RADEON_TXFORMAT_AI88		1</span>
<span class="cp">#define RADEON_TXFORMAT_RGB332		2</span>
<span class="cp">#define RADEON_TXFORMAT_ARGB1555	3</span>
<span class="cp">#define RADEON_TXFORMAT_RGB565		4</span>
<span class="cp">#define RADEON_TXFORMAT_ARGB4444	5</span>
<span class="cp">#define RADEON_TXFORMAT_ARGB8888	6</span>
<span class="cp">#define RADEON_TXFORMAT_RGBA8888	7</span>
<span class="cp">#define RADEON_TXFORMAT_Y8		8</span>
<span class="cp">#define RADEON_TXFORMAT_VYUY422         10</span>
<span class="cp">#define RADEON_TXFORMAT_YVYU422         11</span>
<span class="cp">#define RADEON_TXFORMAT_DXT1            12</span>
<span class="cp">#define RADEON_TXFORMAT_DXT23           14</span>
<span class="cp">#define RADEON_TXFORMAT_DXT45           15</span>

<span class="cp">#define R200_PP_TXCBLEND_0                0x2f00</span>
<span class="cp">#define R200_PP_TXCBLEND_1                0x2f10</span>
<span class="cp">#define R200_PP_TXCBLEND_2                0x2f20</span>
<span class="cp">#define R200_PP_TXCBLEND_3                0x2f30</span>
<span class="cp">#define R200_PP_TXCBLEND_4                0x2f40</span>
<span class="cp">#define R200_PP_TXCBLEND_5                0x2f50</span>
<span class="cp">#define R200_PP_TXCBLEND_6                0x2f60</span>
<span class="cp">#define R200_PP_TXCBLEND_7                0x2f70</span>
<span class="cp">#define R200_SE_TCL_LIGHT_MODEL_CTL_0     0x2268</span>
<span class="cp">#define R200_PP_TFACTOR_0                 0x2ee0</span>
<span class="cp">#define R200_SE_VTX_FMT_0                 0x2088</span>
<span class="cp">#define R200_SE_VAP_CNTL                  0x2080</span>
<span class="cp">#define R200_SE_TCL_MATRIX_SEL_0          0x2230</span>
<span class="cp">#define R200_SE_TCL_TEX_PROC_CTL_2        0x22a8</span>
<span class="cp">#define R200_SE_TCL_UCP_VERT_BLEND_CTL    0x22c0</span>
<span class="cp">#define R200_PP_TXFILTER_5                0x2ca0</span>
<span class="cp">#define R200_PP_TXFILTER_4                0x2c80</span>
<span class="cp">#define R200_PP_TXFILTER_3                0x2c60</span>
<span class="cp">#define R200_PP_TXFILTER_2                0x2c40</span>
<span class="cp">#define R200_PP_TXFILTER_1                0x2c20</span>
<span class="cp">#define R200_PP_TXFILTER_0                0x2c00</span>
<span class="cp">#define R200_PP_TXOFFSET_5                0x2d78</span>
<span class="cp">#define R200_PP_TXOFFSET_4                0x2d60</span>
<span class="cp">#define R200_PP_TXOFFSET_3                0x2d48</span>
<span class="cp">#define R200_PP_TXOFFSET_2                0x2d30</span>
<span class="cp">#define R200_PP_TXOFFSET_1                0x2d18</span>
<span class="cp">#define R200_PP_TXOFFSET_0                0x2d00</span>

<span class="cp">#define R200_PP_CUBIC_FACES_0             0x2c18</span>
<span class="cp">#define R200_PP_CUBIC_FACES_1             0x2c38</span>
<span class="cp">#define R200_PP_CUBIC_FACES_2             0x2c58</span>
<span class="cp">#define R200_PP_CUBIC_FACES_3             0x2c78</span>
<span class="cp">#define R200_PP_CUBIC_FACES_4             0x2c98</span>
<span class="cp">#define R200_PP_CUBIC_FACES_5             0x2cb8</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F1_0         0x2d04</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F2_0         0x2d08</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F3_0         0x2d0c</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F4_0         0x2d10</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F5_0         0x2d14</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F1_1         0x2d1c</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F2_1         0x2d20</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F3_1         0x2d24</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F4_1         0x2d28</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F5_1         0x2d2c</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F1_2         0x2d34</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F2_2         0x2d38</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F3_2         0x2d3c</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F4_2         0x2d40</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F5_2         0x2d44</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F1_3         0x2d4c</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F2_3         0x2d50</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F3_3         0x2d54</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F4_3         0x2d58</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F5_3         0x2d5c</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F1_4         0x2d64</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F2_4         0x2d68</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F3_4         0x2d6c</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F4_4         0x2d70</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F5_4         0x2d74</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F1_5         0x2d7c</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F2_5         0x2d80</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F3_5         0x2d84</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F4_5         0x2d88</span>
<span class="cp">#define R200_PP_CUBIC_OFFSET_F5_5         0x2d8c</span>

<span class="cp">#define R200_RE_AUX_SCISSOR_CNTL          0x26f0</span>
<span class="cp">#define R200_SE_VTE_CNTL                  0x20b0</span>
<span class="cp">#define R200_SE_TCL_OUTPUT_VTX_COMP_SEL   0x2250</span>
<span class="cp">#define R200_PP_TAM_DEBUG3                0x2d9c</span>
<span class="cp">#define R200_PP_CNTL_X                    0x2cc4</span>
<span class="cp">#define R200_SE_VAP_CNTL_STATUS           0x2140</span>
<span class="cp">#define R200_RE_SCISSOR_TL_0              0x1cd8</span>
<span class="cp">#define R200_RE_SCISSOR_TL_1              0x1ce0</span>
<span class="cp">#define R200_RE_SCISSOR_TL_2              0x1ce8</span>
<span class="cp">#define R200_RB3D_DEPTHXY_OFFSET          0x1d60</span>
<span class="cp">#define R200_RE_AUX_SCISSOR_CNTL          0x26f0</span>
<span class="cp">#define R200_SE_VTX_STATE_CNTL            0x2180</span>
<span class="cp">#define R200_RE_POINTSIZE                 0x2648</span>
<span class="cp">#define R200_SE_TCL_INPUT_VTX_VECTOR_ADDR_0 0x2254</span>

<span class="cp">#define RADEON_PP_TEX_SIZE_0                0x1d04	</span><span class="cm">/* NPOT */</span><span class="cp"></span>
<span class="cp">#define RADEON_PP_TEX_SIZE_1                0x1d0c</span>
<span class="cp">#define RADEON_PP_TEX_SIZE_2                0x1d14</span>

<span class="cp">#define RADEON_PP_CUBIC_FACES_0             0x1d24</span>
<span class="cp">#define RADEON_PP_CUBIC_FACES_1             0x1d28</span>
<span class="cp">#define RADEON_PP_CUBIC_FACES_2             0x1d2c</span>
<span class="cp">#define RADEON_PP_CUBIC_OFFSET_T0_0         0x1dd0	</span><span class="cm">/* bits [31:5] */</span><span class="cp"></span>
<span class="cp">#define RADEON_PP_CUBIC_OFFSET_T1_0         0x1e00</span>
<span class="cp">#define RADEON_PP_CUBIC_OFFSET_T2_0         0x1e14</span>

<span class="cp">#define RADEON_SE_TCL_STATE_FLUSH           0x2284</span>

<span class="cp">#define SE_VAP_CNTL__TCL_ENA_MASK                          0x00000001</span>
<span class="cp">#define SE_VAP_CNTL__FORCE_W_TO_ONE_MASK                   0x00010000</span>
<span class="cp">#define SE_VAP_CNTL__VF_MAX_VTX_NUM__SHIFT                 0x00000012</span>
<span class="cp">#define SE_VTE_CNTL__VTX_XY_FMT_MASK                       0x00000100</span>
<span class="cp">#define SE_VTE_CNTL__VTX_Z_FMT_MASK                        0x00000200</span>
<span class="cp">#define SE_VTX_FMT_0__VTX_Z0_PRESENT_MASK                  0x00000001</span>
<span class="cp">#define SE_VTX_FMT_0__VTX_W0_PRESENT_MASK                  0x00000002</span>
<span class="cp">#define SE_VTX_FMT_0__VTX_COLOR_0_FMT__SHIFT               0x0000000b</span>
<span class="cp">#define R200_3D_DRAW_IMMD_2      0xC0003500</span>
<span class="cp">#define R200_SE_VTX_FMT_1                 0x208c</span>
<span class="cp">#define R200_RE_CNTL                      0x1c50</span>

<span class="cp">#define R200_RB3D_BLENDCOLOR              0x3218</span>

<span class="cp">#define R200_SE_TCL_POINT_SPRITE_CNTL     0x22c4</span>

<span class="cp">#define R200_PP_TRI_PERF 0x2cf8</span>

<span class="cp">#define R200_PP_AFS_0                     0x2f80</span>
<span class="cp">#define R200_PP_AFS_1                     0x2f00	</span><span class="cm">/* same as txcblend_0 */</span><span class="cp"></span>

<span class="cp">#define R200_VAP_PVS_CNTL_1               0x22D0</span>

<span class="cp">#define RADEON_CRTC_CRNT_FRAME 0x0214</span>
<span class="cp">#define RADEON_CRTC2_CRNT_FRAME 0x0314</span>

<span class="cp">#define R500_D1CRTC_STATUS 0x609c</span>
<span class="cp">#define R500_D2CRTC_STATUS 0x689c</span>
<span class="cp">#define R500_CRTC_V_BLANK (1&lt;&lt;0)</span>

<span class="cp">#define R500_D1CRTC_FRAME_COUNT 0x60a4</span>
<span class="cp">#define R500_D2CRTC_FRAME_COUNT 0x68a4</span>

<span class="cp">#define R500_D1MODE_V_COUNTER 0x6530</span>
<span class="cp">#define R500_D2MODE_V_COUNTER 0x6d30</span>

<span class="cp">#define R500_D1MODE_VBLANK_STATUS 0x6534</span>
<span class="cp">#define R500_D2MODE_VBLANK_STATUS 0x6d34</span>
<span class="cp">#define R500_VBLANK_OCCURED (1&lt;&lt;0)</span>
<span class="cp">#define R500_VBLANK_ACK     (1&lt;&lt;4)</span>
<span class="cp">#define R500_VBLANK_STAT    (1&lt;&lt;12)</span>
<span class="cp">#define R500_VBLANK_INT     (1&lt;&lt;16)</span>

<span class="cp">#define R500_DxMODE_INT_MASK 0x6540</span>
<span class="cp">#define R500_D1MODE_INT_MASK (1&lt;&lt;0)</span>
<span class="cp">#define R500_D2MODE_INT_MASK (1&lt;&lt;8)</span>

<span class="cp">#define R500_DISP_INTERRUPT_STATUS 0x7edc</span>
<span class="cp">#define R500_D1_VBLANK_INTERRUPT (1 &lt;&lt; 4)</span>
<span class="cp">#define R500_D2_VBLANK_INTERRUPT (1 &lt;&lt; 5)</span>

<span class="cm">/* R6xx/R7xx registers */</span>
<span class="cp">#define R600_MC_VM_FB_LOCATION                                 0x2180</span>
<span class="cp">#define R600_MC_VM_AGP_TOP                                     0x2184</span>
<span class="cp">#define R600_MC_VM_AGP_BOT                                     0x2188</span>
<span class="cp">#define R600_MC_VM_AGP_BASE                                    0x218c</span>
<span class="cp">#define R600_MC_VM_SYSTEM_APERTURE_LOW_ADDR                    0x2190</span>
<span class="cp">#define R600_MC_VM_SYSTEM_APERTURE_HIGH_ADDR                   0x2194</span>
<span class="cp">#define R600_MC_VM_SYSTEM_APERTURE_DEFAULT_ADDR                0x2198</span>

<span class="cp">#define R700_MC_VM_FB_LOCATION                                 0x2024</span>
<span class="cp">#define R700_MC_VM_AGP_TOP                                     0x2028</span>
<span class="cp">#define R700_MC_VM_AGP_BOT                                     0x202c</span>
<span class="cp">#define R700_MC_VM_AGP_BASE                                    0x2030</span>
<span class="cp">#define R700_MC_VM_SYSTEM_APERTURE_LOW_ADDR                    0x2034</span>
<span class="cp">#define R700_MC_VM_SYSTEM_APERTURE_HIGH_ADDR                   0x2038</span>
<span class="cp">#define R700_MC_VM_SYSTEM_APERTURE_DEFAULT_ADDR                0x203c</span>

<span class="cp">#define R600_MCD_RD_A_CNTL                                     0x219c</span>
<span class="cp">#define R600_MCD_RD_B_CNTL                                     0x21a0</span>

<span class="cp">#define R600_MCD_WR_A_CNTL                                     0x21a4</span>
<span class="cp">#define R600_MCD_WR_B_CNTL                                     0x21a8</span>

<span class="cp">#define R600_MCD_RD_SYS_CNTL                                   0x2200</span>
<span class="cp">#define R600_MCD_WR_SYS_CNTL                                   0x2214</span>

<span class="cp">#define R600_MCD_RD_GFX_CNTL                                   0x21fc</span>
<span class="cp">#define R600_MCD_RD_HDP_CNTL                                   0x2204</span>
<span class="cp">#define R600_MCD_RD_PDMA_CNTL                                  0x2208</span>
<span class="cp">#define R600_MCD_RD_SEM_CNTL                                   0x220c</span>
<span class="cp">#define R600_MCD_WR_GFX_CNTL                                   0x2210</span>
<span class="cp">#define R600_MCD_WR_HDP_CNTL                                   0x2218</span>
<span class="cp">#define R600_MCD_WR_PDMA_CNTL                                  0x221c</span>
<span class="cp">#define R600_MCD_WR_SEM_CNTL                                   0x2220</span>

<span class="cp">#       define R600_MCD_L1_TLB                                 (1 &lt;&lt; 0)</span>
<span class="cp">#       define R600_MCD_L1_FRAG_PROC                           (1 &lt;&lt; 1)</span>
<span class="cp">#       define R600_MCD_L1_STRICT_ORDERING                     (1 &lt;&lt; 2)</span>

<span class="cp">#       define R600_MCD_SYSTEM_ACCESS_MODE_MASK                (3 &lt;&lt; 6)</span>
<span class="cp">#       define R600_MCD_SYSTEM_ACCESS_MODE_PA_ONLY             (0 &lt;&lt; 6)</span>
<span class="cp">#       define R600_MCD_SYSTEM_ACCESS_MODE_USE_SYS_MAP         (1 &lt;&lt; 6)</span>
<span class="cp">#       define R600_MCD_SYSTEM_ACCESS_MODE_IN_SYS              (2 &lt;&lt; 6)</span>
<span class="cp">#       define R600_MCD_SYSTEM_ACCESS_MODE_NOT_IN_SYS          (3 &lt;&lt; 6)</span>

<span class="cp">#       define R600_MCD_SYSTEM_APERTURE_UNMAPPED_ACCESS_PASS_THRU    (0 &lt;&lt; 8)</span>
<span class="cp">#       define R600_MCD_SYSTEM_APERTURE_UNMAPPED_ACCESS_DEFAULT_PAGE (1 &lt;&lt; 8)</span>

<span class="cp">#       define R600_MCD_SEMAPHORE_MODE                         (1 &lt;&lt; 10)</span>
<span class="cp">#       define R600_MCD_WAIT_L2_QUERY                          (1 &lt;&lt; 11)</span>
<span class="cp">#       define R600_MCD_EFFECTIVE_L1_TLB_SIZE(x)               ((x) &lt;&lt; 12)</span>
<span class="cp">#       define R600_MCD_EFFECTIVE_L1_QUEUE_SIZE(x)             ((x) &lt;&lt; 15)</span>

<span class="cp">#define R700_MC_VM_MD_L1_TLB0_CNTL                             0x2654</span>
<span class="cp">#define R700_MC_VM_MD_L1_TLB1_CNTL                             0x2658</span>
<span class="cp">#define R700_MC_VM_MD_L1_TLB2_CNTL                             0x265c</span>

<span class="cp">#define R700_MC_VM_MB_L1_TLB0_CNTL                             0x2234</span>
<span class="cp">#define R700_MC_VM_MB_L1_TLB1_CNTL                             0x2238</span>
<span class="cp">#define R700_MC_VM_MB_L1_TLB2_CNTL                             0x223c</span>
<span class="cp">#define R700_MC_VM_MB_L1_TLB3_CNTL                             0x2240</span>

<span class="cp">#       define R700_ENABLE_L1_TLB                              (1 &lt;&lt; 0)</span>
<span class="cp">#       define R700_ENABLE_L1_FRAGMENT_PROCESSING              (1 &lt;&lt; 1)</span>
<span class="cp">#       define R700_SYSTEM_ACCESS_MODE_IN_SYS                  (2 &lt;&lt; 3)</span>
<span class="cp">#       define R700_SYSTEM_APERTURE_UNMAPPED_ACCESS_PASS_THRU  (0 &lt;&lt; 5)</span>
<span class="cp">#       define R700_EFFECTIVE_L1_TLB_SIZE(x)                   ((x) &lt;&lt; 15)</span>
<span class="cp">#       define R700_EFFECTIVE_L1_QUEUE_SIZE(x)                 ((x) &lt;&lt; 18)</span>

<span class="cp">#define R700_MC_ARB_RAMCFG                                     0x2760</span>
<span class="cp">#       define R700_NOOFBANK_SHIFT                             0</span>
<span class="cp">#       define R700_NOOFBANK_MASK                              0x3</span>
<span class="cp">#       define R700_NOOFRANK_SHIFT                             2</span>
<span class="cp">#       define R700_NOOFRANK_MASK                              0x1</span>
<span class="cp">#       define R700_NOOFROWS_SHIFT                             3</span>
<span class="cp">#       define R700_NOOFROWS_MASK                              0x7</span>
<span class="cp">#       define R700_NOOFCOLS_SHIFT                             6</span>
<span class="cp">#       define R700_NOOFCOLS_MASK                              0x3</span>
<span class="cp">#       define R700_CHANSIZE_SHIFT                             8</span>
<span class="cp">#       define R700_CHANSIZE_MASK                              0x1</span>
<span class="cp">#       define R700_BURSTLENGTH_SHIFT                          9</span>
<span class="cp">#       define R700_BURSTLENGTH_MASK                           0x1</span>
<span class="cp">#define R600_RAMCFG                                            0x2408</span>
<span class="cp">#       define R600_NOOFBANK_SHIFT                             0</span>
<span class="cp">#       define R600_NOOFBANK_MASK                              0x1</span>
<span class="cp">#       define R600_NOOFRANK_SHIFT                             1</span>
<span class="cp">#       define R600_NOOFRANK_MASK                              0x1</span>
<span class="cp">#       define R600_NOOFROWS_SHIFT                             2</span>
<span class="cp">#       define R600_NOOFROWS_MASK                              0x7</span>
<span class="cp">#       define R600_NOOFCOLS_SHIFT                             5</span>
<span class="cp">#       define R600_NOOFCOLS_MASK                              0x3</span>
<span class="cp">#       define R600_CHANSIZE_SHIFT                             7</span>
<span class="cp">#       define R600_CHANSIZE_MASK                              0x1</span>
<span class="cp">#       define R600_BURSTLENGTH_SHIFT                          8</span>
<span class="cp">#       define R600_BURSTLENGTH_MASK                           0x1</span>

<span class="cp">#define R600_VM_L2_CNTL                                        0x1400</span>
<span class="cp">#       define R600_VM_L2_CACHE_EN                             (1 &lt;&lt; 0)</span>
<span class="cp">#       define R600_VM_L2_FRAG_PROC                            (1 &lt;&lt; 1)</span>
<span class="cp">#       define R600_VM_ENABLE_PTE_CACHE_LRU_W                  (1 &lt;&lt; 9)</span>
<span class="cp">#       define R600_VM_L2_CNTL_QUEUE_SIZE(x)                   ((x) &lt;&lt; 13)</span>
<span class="cp">#       define R700_VM_L2_CNTL_QUEUE_SIZE(x)                   ((x) &lt;&lt; 14)</span>

<span class="cp">#define R600_VM_L2_CNTL2                                       0x1404</span>
<span class="cp">#       define R600_VM_L2_CNTL2_INVALIDATE_ALL_L1_TLBS         (1 &lt;&lt; 0)</span>
<span class="cp">#       define R600_VM_L2_CNTL2_INVALIDATE_L2_CACHE            (1 &lt;&lt; 1)</span>
<span class="cp">#define R600_VM_L2_CNTL3                                       0x1408</span>
<span class="cp">#       define R600_VM_L2_CNTL3_BANK_SELECT_0(x)               ((x) &lt;&lt; 0)</span>
<span class="cp">#       define R600_VM_L2_CNTL3_BANK_SELECT_1(x)               ((x) &lt;&lt; 5)</span>
<span class="cp">#       define R600_VM_L2_CNTL3_CACHE_UPDATE_MODE(x)           ((x) &lt;&lt; 10)</span>
<span class="cp">#       define R700_VM_L2_CNTL3_BANK_SELECT(x)                 ((x) &lt;&lt; 0)</span>
<span class="cp">#       define R700_VM_L2_CNTL3_CACHE_UPDATE_MODE(x)           ((x) &lt;&lt; 6)</span>

<span class="cp">#define R600_VM_L2_STATUS                                      0x140c</span>

<span class="cp">#define R600_VM_CONTEXT0_CNTL                                  0x1410</span>
<span class="cp">#       define R600_VM_ENABLE_CONTEXT                          (1 &lt;&lt; 0)</span>
<span class="cp">#       define R600_VM_PAGE_TABLE_DEPTH_FLAT                   (0 &lt;&lt; 1)</span>

<span class="cp">#define R600_VM_CONTEXT0_CNTL2                                 0x1430</span>
<span class="cp">#define R600_VM_CONTEXT0_REQUEST_RESPONSE                      0x1470</span>
<span class="cp">#define R600_VM_CONTEXT0_INVALIDATION_LOW_ADDR                 0x1490</span>
<span class="cp">#define R600_VM_CONTEXT0_INVALIDATION_HIGH_ADDR                0x14b0</span>
<span class="cp">#define R600_VM_CONTEXT0_PAGE_TABLE_BASE_ADDR                  0x1574</span>
<span class="cp">#define R600_VM_CONTEXT0_PAGE_TABLE_START_ADDR                 0x1594</span>
<span class="cp">#define R600_VM_CONTEXT0_PAGE_TABLE_END_ADDR                   0x15b4</span>

<span class="cp">#define R700_VM_CONTEXT0_PAGE_TABLE_BASE_ADDR                  0x153c</span>
<span class="cp">#define R700_VM_CONTEXT0_PAGE_TABLE_START_ADDR                 0x155c</span>
<span class="cp">#define R700_VM_CONTEXT0_PAGE_TABLE_END_ADDR                   0x157c</span>

<span class="cp">#define R600_HDP_HOST_PATH_CNTL                                0x2c00</span>

<span class="cp">#define R600_GRBM_CNTL                                         0x8000</span>
<span class="cp">#       define R600_GRBM_READ_TIMEOUT(x)                       ((x) &lt;&lt; 0)</span>

<span class="cp">#define R600_GRBM_STATUS                                       0x8010</span>
<span class="cp">#       define R600_CMDFIFO_AVAIL_MASK                         0x1f</span>
<span class="cp">#       define R700_CMDFIFO_AVAIL_MASK                         0xf</span>
<span class="cp">#       define R600_GUI_ACTIVE                                 (1 &lt;&lt; 31)</span>
<span class="cp">#define R600_GRBM_STATUS2                                      0x8014</span>
<span class="cp">#define R600_GRBM_SOFT_RESET                                   0x8020</span>
<span class="cp">#       define R600_SOFT_RESET_CP                              (1 &lt;&lt; 0)</span>
<span class="cp">#define R600_WAIT_UNTIL		                               0x8040</span>

<span class="cp">#define R600_CP_SEM_WAIT_TIMER                                 0x85bc</span>
<span class="cp">#define R600_CP_ME_CNTL                                        0x86d8</span>
<span class="cp">#       define R600_CP_ME_HALT                                 (1 &lt;&lt; 28)</span>
<span class="cp">#define R600_CP_QUEUE_THRESHOLDS                               0x8760</span>
<span class="cp">#       define R600_ROQ_IB1_START(x)                           ((x) &lt;&lt; 0)</span>
<span class="cp">#       define R600_ROQ_IB2_START(x)                           ((x) &lt;&lt; 8)</span>
<span class="cp">#define R600_CP_MEQ_THRESHOLDS                                 0x8764</span>
<span class="cp">#       define R700_STQ_SPLIT(x)                               ((x) &lt;&lt; 0)</span>
<span class="cp">#       define R600_MEQ_END(x)                                 ((x) &lt;&lt; 16)</span>
<span class="cp">#       define R600_ROQ_END(x)                                 ((x) &lt;&lt; 24)</span>
<span class="cp">#define R600_CP_PERFMON_CNTL                                   0x87fc</span>
<span class="cp">#define R600_CP_RB_BASE                                        0xc100</span>
<span class="cp">#define R600_CP_RB_CNTL                                        0xc104</span>
<span class="cp">#       define R600_RB_BUFSZ(x)                                ((x) &lt;&lt; 0)</span>
<span class="cp">#       define R600_RB_BLKSZ(x)                                ((x) &lt;&lt; 8)</span>
<span class="cp">#	define R600_BUF_SWAP_32BIT		               (2 &lt;&lt; 16)</span>
<span class="cp">#       define R600_RB_NO_UPDATE                               (1 &lt;&lt; 27)</span>
<span class="cp">#       define R600_RB_RPTR_WR_ENA                             (1 &lt;&lt; 31)</span>
<span class="cp">#define R600_CP_RB_RPTR_WR                                     0xc108</span>
<span class="cp">#define R600_CP_RB_RPTR_ADDR                                   0xc10c</span>
<span class="cp">#define R600_CP_RB_RPTR_ADDR_HI                                0xc110</span>
<span class="cp">#define R600_CP_RB_WPTR                                        0xc114</span>
<span class="cp">#define R600_CP_RB_WPTR_ADDR                                   0xc118</span>
<span class="cp">#define R600_CP_RB_WPTR_ADDR_HI                                0xc11c</span>
<span class="cp">#define R600_CP_RB_RPTR                                        0x8700</span>
<span class="cp">#define R600_CP_RB_WPTR_DELAY                                  0x8704</span>
<span class="cp">#define R600_CP_PFP_UCODE_ADDR                                 0xc150</span>
<span class="cp">#define R600_CP_PFP_UCODE_DATA                                 0xc154</span>
<span class="cp">#define R600_CP_ME_RAM_RADDR                                   0xc158</span>
<span class="cp">#define R600_CP_ME_RAM_WADDR                                   0xc15c</span>
<span class="cp">#define R600_CP_ME_RAM_DATA                                    0xc160</span>
<span class="cp">#define R600_CP_DEBUG                                          0xc1fc</span>

<span class="cp">#define R600_PA_CL_ENHANCE                                     0x8a14</span>
<span class="cp">#       define R600_CLIP_VTX_REORDER_ENA                       (1 &lt;&lt; 0)</span>
<span class="cp">#       define R600_NUM_CLIP_SEQ(x)                            ((x) &lt;&lt; 1)</span>
<span class="cp">#define R600_PA_SC_LINE_STIPPLE_STATE                          0x8b10</span>
<span class="cp">#define R600_PA_SC_MULTI_CHIP_CNTL                             0x8b20</span>
<span class="cp">#define R700_PA_SC_FORCE_EOV_MAX_CNTS                          0x8b24</span>
<span class="cp">#       define R700_FORCE_EOV_MAX_CLK_CNT(x)                   ((x) &lt;&lt; 0)</span>
<span class="cp">#       define R700_FORCE_EOV_MAX_REZ_CNT(x)                   ((x) &lt;&lt; 16)</span>
<span class="cp">#define R600_PA_SC_AA_SAMPLE_LOCS_2S                           0x8b40</span>
<span class="cp">#define R600_PA_SC_AA_SAMPLE_LOCS_4S                           0x8b44</span>
<span class="cp">#define R600_PA_SC_AA_SAMPLE_LOCS_8S_WD0                       0x8b48</span>
<span class="cp">#define R600_PA_SC_AA_SAMPLE_LOCS_8S_WD1                       0x8b4c</span>
<span class="cp">#       define R600_S0_X(x)                                    ((x) &lt;&lt; 0)</span>
<span class="cp">#       define R600_S0_Y(x)                                    ((x) &lt;&lt; 4)</span>
<span class="cp">#       define R600_S1_X(x)                                    ((x) &lt;&lt; 8)</span>
<span class="cp">#       define R600_S1_Y(x)                                    ((x) &lt;&lt; 12)</span>
<span class="cp">#       define R600_S2_X(x)                                    ((x) &lt;&lt; 16)</span>
<span class="cp">#       define R600_S2_Y(x)                                    ((x) &lt;&lt; 20)</span>
<span class="cp">#       define R600_S3_X(x)                                    ((x) &lt;&lt; 24)</span>
<span class="cp">#       define R600_S3_Y(x)                                    ((x) &lt;&lt; 28)</span>
<span class="cp">#       define R600_S4_X(x)                                    ((x) &lt;&lt; 0)</span>
<span class="cp">#       define R600_S4_Y(x)                                    ((x) &lt;&lt; 4)</span>
<span class="cp">#       define R600_S5_X(x)                                    ((x) &lt;&lt; 8)</span>
<span class="cp">#       define R600_S5_Y(x)                                    ((x) &lt;&lt; 12)</span>
<span class="cp">#       define R600_S6_X(x)                                    ((x) &lt;&lt; 16)</span>
<span class="cp">#       define R600_S6_Y(x)                                    ((x) &lt;&lt; 20)</span>
<span class="cp">#       define R600_S7_X(x)                                    ((x) &lt;&lt; 24)</span>
<span class="cp">#       define R600_S7_Y(x)                                    ((x) &lt;&lt; 28)</span>
<span class="cp">#define R600_PA_SC_FIFO_SIZE                                   0x8bd0</span>
<span class="cp">#       define R600_SC_PRIM_FIFO_SIZE(x)                       ((x) &lt;&lt; 0)</span>
<span class="cp">#       define R600_SC_HIZ_TILE_FIFO_SIZE(x)                   ((x) &lt;&lt; 8)</span>
<span class="cp">#       define R600_SC_EARLYZ_TILE_FIFO_SIZE(x)                ((x) &lt;&lt; 16)</span>
<span class="cp">#define R700_PA_SC_FIFO_SIZE_R7XX                              0x8bcc</span>
<span class="cp">#       define R700_SC_PRIM_FIFO_SIZE(x)                       ((x) &lt;&lt; 0)</span>
<span class="cp">#       define R700_SC_HIZ_TILE_FIFO_SIZE(x)                   ((x) &lt;&lt; 12)</span>
<span class="cp">#       define R700_SC_EARLYZ_TILE_FIFO_SIZE(x)                ((x) &lt;&lt; 20)</span>
<span class="cp">#define R600_PA_SC_ENHANCE                                     0x8bf0</span>
<span class="cp">#       define R600_FORCE_EOV_MAX_CLK_CNT(x)                   ((x) &lt;&lt; 0)</span>
<span class="cp">#       define R600_FORCE_EOV_MAX_TILE_CNT(x)                  ((x) &lt;&lt; 12)</span>
<span class="cp">#define R600_PA_SC_CLIPRECT_RULE                               0x2820c</span>
<span class="cp">#define R700_PA_SC_EDGERULE                                    0x28230</span>
<span class="cp">#define R600_PA_SC_LINE_STIPPLE                                0x28a0c</span>
<span class="cp">#define R600_PA_SC_MODE_CNTL                                   0x28a4c</span>
<span class="cp">#define R600_PA_SC_AA_CONFIG                                   0x28c04</span>

<span class="cp">#define R600_SX_EXPORT_BUFFER_SIZES                            0x900c</span>
<span class="cp">#       define R600_COLOR_BUFFER_SIZE(x)                       ((x) &lt;&lt; 0)</span>
<span class="cp">#       define R600_POSITION_BUFFER_SIZE(x)                    ((x) &lt;&lt; 8)</span>
<span class="cp">#       define R600_SMX_BUFFER_SIZE(x)                         ((x) &lt;&lt; 16)</span>
<span class="cp">#define R600_SX_DEBUG_1                                        0x9054</span>
<span class="cp">#       define R600_SMX_EVENT_RELEASE                          (1 &lt;&lt; 0)</span>
<span class="cp">#       define R600_ENABLE_NEW_SMX_ADDRESS                     (1 &lt;&lt; 16)</span>
<span class="cp">#define R700_SX_DEBUG_1                                        0x9058</span>
<span class="cp">#       define R700_ENABLE_NEW_SMX_ADDRESS                     (1 &lt;&lt; 16)</span>
<span class="cp">#define R600_SX_MISC                                           0x28350</span>

<span class="cp">#define R600_DB_DEBUG                                          0x9830</span>
<span class="cp">#       define R600_PREZ_MUST_WAIT_FOR_POSTZ_DONE              (1 &lt;&lt; 31)</span>
<span class="cp">#define R600_DB_WATERMARKS                                     0x9838</span>
<span class="cp">#       define R600_DEPTH_FREE(x)                              ((x) &lt;&lt; 0)</span>
<span class="cp">#       define R600_DEPTH_FLUSH(x)                             ((x) &lt;&lt; 5)</span>
<span class="cp">#       define R600_DEPTH_PENDING_FREE(x)                      ((x) &lt;&lt; 15)</span>
<span class="cp">#       define R600_DEPTH_CACHELINE_FREE(x)                    ((x) &lt;&lt; 20)</span>
<span class="cp">#define R700_DB_DEBUG3                                         0x98b0</span>
<span class="cp">#       define R700_DB_CLK_OFF_DELAY(x)                        ((x) &lt;&lt; 11)</span>
<span class="cp">#define RV700_DB_DEBUG4                                        0x9b8c</span>
<span class="cp">#       define RV700_DISABLE_TILE_COVERED_FOR_PS_ITER          (1 &lt;&lt; 6)</span>

<span class="cp">#define R600_VGT_CACHE_INVALIDATION                            0x88c4</span>
<span class="cp">#       define R600_CACHE_INVALIDATION(x)                      ((x) &lt;&lt; 0)</span>
<span class="cp">#       define R600_VC_ONLY                                    0</span>
<span class="cp">#       define R600_TC_ONLY                                    1</span>
<span class="cp">#       define R600_VC_AND_TC                                  2</span>
<span class="cp">#       define R700_AUTO_INVLD_EN(x)                           ((x) &lt;&lt; 6)</span>
<span class="cp">#       define R700_NO_AUTO                                    0</span>
<span class="cp">#       define R700_ES_AUTO                                    1</span>
<span class="cp">#       define R700_GS_AUTO                                    2</span>
<span class="cp">#       define R700_ES_AND_GS_AUTO                             3</span>
<span class="cp">#define R600_VGT_GS_PER_ES                                     0x88c8</span>
<span class="cp">#define R600_VGT_ES_PER_GS                                     0x88cc</span>
<span class="cp">#define R600_VGT_GS_PER_VS                                     0x88e8</span>
<span class="cp">#define R600_VGT_GS_VERTEX_REUSE                               0x88d4</span>
<span class="cp">#define R600_VGT_NUM_INSTANCES                                 0x8974</span>
<span class="cp">#define R600_VGT_STRMOUT_EN                                    0x28ab0</span>
<span class="cp">#define R600_VGT_EVENT_INITIATOR                               0x28a90</span>
<span class="cp">#       define R600_CACHE_FLUSH_AND_INV_EVENT                  (0x16 &lt;&lt; 0)</span>
<span class="cp">#define R600_VGT_VERTEX_REUSE_BLOCK_CNTL                       0x28c58</span>
<span class="cp">#       define R600_VTX_REUSE_DEPTH_MASK                       0xff</span>
<span class="cp">#define R600_VGT_OUT_DEALLOC_CNTL                              0x28c5c</span>
<span class="cp">#       define R600_DEALLOC_DIST_MASK                          0x7f</span>

<span class="cp">#define R600_CB_COLOR0_BASE                                    0x28040</span>
<span class="cp">#define R600_CB_COLOR1_BASE                                    0x28044</span>
<span class="cp">#define R600_CB_COLOR2_BASE                                    0x28048</span>
<span class="cp">#define R600_CB_COLOR3_BASE                                    0x2804c</span>
<span class="cp">#define R600_CB_COLOR4_BASE                                    0x28050</span>
<span class="cp">#define R600_CB_COLOR5_BASE                                    0x28054</span>
<span class="cp">#define R600_CB_COLOR6_BASE                                    0x28058</span>
<span class="cp">#define R600_CB_COLOR7_BASE                                    0x2805c</span>
<span class="cp">#define R600_CB_COLOR7_FRAG                                    0x280fc</span>

<span class="cp">#define R600_CB_COLOR0_SIZE                                    0x28060</span>
<span class="cp">#define R600_CB_COLOR0_VIEW                                    0x28080</span>
<span class="cp">#define R600_CB_COLOR0_INFO                                    0x280a0</span>
<span class="cp">#define R600_CB_COLOR0_TILE                                    0x280c0</span>
<span class="cp">#define R600_CB_COLOR0_FRAG                                    0x280e0</span>
<span class="cp">#define R600_CB_COLOR0_MASK                                    0x28100</span>

<span class="cp">#define AVIVO_D1MODE_VLINE_START_END                           0x6538</span>
<span class="cp">#define AVIVO_D2MODE_VLINE_START_END                           0x6d38</span>
<span class="cp">#define R600_CP_COHER_BASE                                     0x85f8</span>
<span class="cp">#define R600_DB_DEPTH_BASE                                     0x2800c</span>
<span class="cp">#define R600_SQ_PGM_START_FS                                   0x28894</span>
<span class="cp">#define R600_SQ_PGM_START_ES                                   0x28880</span>
<span class="cp">#define R600_SQ_PGM_START_VS                                   0x28858</span>
<span class="cp">#define R600_SQ_PGM_RESOURCES_VS                               0x28868</span>
<span class="cp">#define R600_SQ_PGM_CF_OFFSET_VS                               0x288d0</span>
<span class="cp">#define R600_SQ_PGM_START_GS                                   0x2886c</span>
<span class="cp">#define R600_SQ_PGM_START_PS                                   0x28840</span>
<span class="cp">#define R600_SQ_PGM_RESOURCES_PS                               0x28850</span>
<span class="cp">#define R600_SQ_PGM_EXPORTS_PS                                 0x28854</span>
<span class="cp">#define R600_SQ_PGM_CF_OFFSET_PS                               0x288cc</span>
<span class="cp">#define R600_VGT_DMA_BASE                                      0x287e8</span>
<span class="cp">#define R600_VGT_DMA_BASE_HI                                   0x287e4</span>
<span class="cp">#define R600_VGT_STRMOUT_BASE_OFFSET_0                         0x28b10</span>
<span class="cp">#define R600_VGT_STRMOUT_BASE_OFFSET_1                         0x28b14</span>
<span class="cp">#define R600_VGT_STRMOUT_BASE_OFFSET_2                         0x28b18</span>
<span class="cp">#define R600_VGT_STRMOUT_BASE_OFFSET_3                         0x28b1c</span>
<span class="cp">#define R600_VGT_STRMOUT_BASE_OFFSET_HI_0                      0x28b44</span>
<span class="cp">#define R600_VGT_STRMOUT_BASE_OFFSET_HI_1                      0x28b48</span>
<span class="cp">#define R600_VGT_STRMOUT_BASE_OFFSET_HI_2                      0x28b4c</span>
<span class="cp">#define R600_VGT_STRMOUT_BASE_OFFSET_HI_3                      0x28b50</span>
<span class="cp">#define R600_VGT_STRMOUT_BUFFER_BASE_0                         0x28ad8</span>
<span class="cp">#define R600_VGT_STRMOUT_BUFFER_BASE_1                         0x28ae8</span>
<span class="cp">#define R600_VGT_STRMOUT_BUFFER_BASE_2                         0x28af8</span>
<span class="cp">#define R600_VGT_STRMOUT_BUFFER_BASE_3                         0x28b08</span>
<span class="cp">#define R600_VGT_STRMOUT_BUFFER_OFFSET_0                       0x28adc</span>
<span class="cp">#define R600_VGT_STRMOUT_BUFFER_OFFSET_1                       0x28aec</span>
<span class="cp">#define R600_VGT_STRMOUT_BUFFER_OFFSET_2                       0x28afc</span>
<span class="cp">#define R600_VGT_STRMOUT_BUFFER_OFFSET_3                       0x28b0c</span>

<span class="cp">#define R600_VGT_PRIMITIVE_TYPE                                0x8958</span>

<span class="cp">#define R600_PA_SC_SCREEN_SCISSOR_TL                           0x28030</span>
<span class="cp">#define R600_PA_SC_GENERIC_SCISSOR_TL                          0x28240</span>
<span class="cp">#define R600_PA_SC_WINDOW_SCISSOR_TL                           0x28204</span>

<span class="cp">#define R600_TC_CNTL                                           0x9608</span>
<span class="cp">#       define R600_TC_L2_SIZE(x)                              ((x) &lt;&lt; 5)</span>
<span class="cp">#       define R600_L2_DISABLE_LATE_HIT                        (1 &lt;&lt; 9)</span>

<span class="cp">#define R600_ARB_POP                                           0x2418</span>
<span class="cp">#       define R600_ENABLE_TC128                               (1 &lt;&lt; 30)</span>
<span class="cp">#define R600_ARB_GDEC_RD_CNTL                                  0x246c</span>

<span class="cp">#define R600_TA_CNTL_AUX                                       0x9508</span>
<span class="cp">#       define R600_DISABLE_CUBE_WRAP                          (1 &lt;&lt; 0)</span>
<span class="cp">#       define R600_DISABLE_CUBE_ANISO                         (1 &lt;&lt; 1)</span>
<span class="cp">#       define R700_GETLOD_SELECT(x)                           ((x) &lt;&lt; 2)</span>
<span class="cp">#       define R600_SYNC_GRADIENT                              (1 &lt;&lt; 24)</span>
<span class="cp">#       define R600_SYNC_WALKER                                (1 &lt;&lt; 25)</span>
<span class="cp">#       define R600_SYNC_ALIGNER                               (1 &lt;&lt; 26)</span>
<span class="cp">#       define R600_BILINEAR_PRECISION_6_BIT                   (0 &lt;&lt; 31)</span>
<span class="cp">#       define R600_BILINEAR_PRECISION_8_BIT                   (1 &lt;&lt; 31)</span>

<span class="cp">#define R700_TCP_CNTL                                          0x9610</span>

<span class="cp">#define R600_SMX_DC_CTL0                                       0xa020</span>
<span class="cp">#       define R700_USE_HASH_FUNCTION                          (1 &lt;&lt; 0)</span>
<span class="cp">#       define R700_CACHE_DEPTH(x)                             ((x) &lt;&lt; 1)</span>
<span class="cp">#       define R700_FLUSH_ALL_ON_EVENT                         (1 &lt;&lt; 10)</span>
<span class="cp">#       define R700_STALL_ON_EVENT                             (1 &lt;&lt; 11)</span>
<span class="cp">#define R700_SMX_EVENT_CTL                                     0xa02c</span>
<span class="cp">#       define R700_ES_FLUSH_CTL(x)                            ((x) &lt;&lt; 0)</span>
<span class="cp">#       define R700_GS_FLUSH_CTL(x)                            ((x) &lt;&lt; 3)</span>
<span class="cp">#       define R700_ACK_FLUSH_CTL(x)                           ((x) &lt;&lt; 6)</span>
<span class="cp">#       define R700_SYNC_FLUSH_CTL                             (1 &lt;&lt; 8)</span>

<span class="cp">#define R600_SQ_CONFIG                                         0x8c00</span>
<span class="cp">#       define R600_VC_ENABLE                                  (1 &lt;&lt; 0)</span>
<span class="cp">#       define R600_EXPORT_SRC_C                               (1 &lt;&lt; 1)</span>
<span class="cp">#       define R600_DX9_CONSTS                                 (1 &lt;&lt; 2)</span>
<span class="cp">#       define R600_ALU_INST_PREFER_VECTOR                     (1 &lt;&lt; 3)</span>
<span class="cp">#       define R600_DX10_CLAMP                                 (1 &lt;&lt; 4)</span>
<span class="cp">#       define R600_CLAUSE_SEQ_PRIO(x)                         ((x) &lt;&lt; 8)</span>
<span class="cp">#       define R600_PS_PRIO(x)                                 ((x) &lt;&lt; 24)</span>
<span class="cp">#       define R600_VS_PRIO(x)                                 ((x) &lt;&lt; 26)</span>
<span class="cp">#       define R600_GS_PRIO(x)                                 ((x) &lt;&lt; 28)</span>
<span class="cp">#       define R600_ES_PRIO(x)                                 ((x) &lt;&lt; 30)</span>
<span class="cp">#define R600_SQ_GPR_RESOURCE_MGMT_1                            0x8c04</span>
<span class="cp">#       define R600_NUM_PS_GPRS(x)                             ((x) &lt;&lt; 0)</span>
<span class="cp">#       define R600_NUM_VS_GPRS(x)                             ((x) &lt;&lt; 16)</span>
<span class="cp">#       define R700_DYN_GPR_ENABLE                             (1 &lt;&lt; 27)</span>
<span class="cp">#       define R600_NUM_CLAUSE_TEMP_GPRS(x)                    ((x) &lt;&lt; 28)</span>
<span class="cp">#define R600_SQ_GPR_RESOURCE_MGMT_2                            0x8c08</span>
<span class="cp">#       define R600_NUM_GS_GPRS(x)                             ((x) &lt;&lt; 0)</span>
<span class="cp">#       define R600_NUM_ES_GPRS(x)                             ((x) &lt;&lt; 16)</span>
<span class="cp">#define R600_SQ_THREAD_RESOURCE_MGMT                           0x8c0c</span>
<span class="cp">#       define R600_NUM_PS_THREADS(x)                          ((x) &lt;&lt; 0)</span>
<span class="cp">#       define R600_NUM_VS_THREADS(x)                          ((x) &lt;&lt; 8)</span>
<span class="cp">#       define R600_NUM_GS_THREADS(x)                          ((x) &lt;&lt; 16)</span>
<span class="cp">#       define R600_NUM_ES_THREADS(x)                          ((x) &lt;&lt; 24)</span>
<span class="cp">#define R600_SQ_STACK_RESOURCE_MGMT_1                          0x8c10</span>
<span class="cp">#       define R600_NUM_PS_STACK_ENTRIES(x)                    ((x) &lt;&lt; 0)</span>
<span class="cp">#       define R600_NUM_VS_STACK_ENTRIES(x)                    ((x) &lt;&lt; 16)</span>
<span class="cp">#define R600_SQ_STACK_RESOURCE_MGMT_2                          0x8c14</span>
<span class="cp">#       define R600_NUM_GS_STACK_ENTRIES(x)                    ((x) &lt;&lt; 0)</span>
<span class="cp">#       define R600_NUM_ES_STACK_ENTRIES(x)                    ((x) &lt;&lt; 16)</span>
<span class="cp">#define R600_SQ_MS_FIFO_SIZES                                  0x8cf0</span>
<span class="cp">#       define R600_CACHE_FIFO_SIZE(x)                         ((x) &lt;&lt; 0)</span>
<span class="cp">#       define R600_FETCH_FIFO_HIWATER(x)                      ((x) &lt;&lt; 8)</span>
<span class="cp">#       define R600_DONE_FIFO_HIWATER(x)                       ((x) &lt;&lt; 16)</span>
<span class="cp">#       define R600_ALU_UPDATE_FIFO_HIWATER(x)                 ((x) &lt;&lt; 24)</span>
<span class="cp">#define R700_SQ_DYN_GPR_SIZE_SIMD_AB_0                         0x8db0</span>
<span class="cp">#       define R700_SIMDA_RING0(x)                             ((x) &lt;&lt; 0)</span>
<span class="cp">#       define R700_SIMDA_RING1(x)                             ((x) &lt;&lt; 8)</span>
<span class="cp">#       define R700_SIMDB_RING0(x)                             ((x) &lt;&lt; 16)</span>
<span class="cp">#       define R700_SIMDB_RING1(x)                             ((x) &lt;&lt; 24)</span>
<span class="cp">#define R700_SQ_DYN_GPR_SIZE_SIMD_AB_1                         0x8db4</span>
<span class="cp">#define R700_SQ_DYN_GPR_SIZE_SIMD_AB_2                         0x8db8</span>
<span class="cp">#define R700_SQ_DYN_GPR_SIZE_SIMD_AB_3                         0x8dbc</span>
<span class="cp">#define R700_SQ_DYN_GPR_SIZE_SIMD_AB_4                         0x8dc0</span>
<span class="cp">#define R700_SQ_DYN_GPR_SIZE_SIMD_AB_5                         0x8dc4</span>
<span class="cp">#define R700_SQ_DYN_GPR_SIZE_SIMD_AB_6                         0x8dc8</span>
<span class="cp">#define R700_SQ_DYN_GPR_SIZE_SIMD_AB_7                         0x8dcc</span>

<span class="cp">#define R600_SPI_PS_IN_CONTROL_0                               0x286cc</span>
<span class="cp">#       define R600_NUM_INTERP(x)                              ((x) &lt;&lt; 0)</span>
<span class="cp">#       define R600_POSITION_ENA                               (1 &lt;&lt; 8)</span>
<span class="cp">#       define R600_POSITION_CENTROID                          (1 &lt;&lt; 9)</span>
<span class="cp">#       define R600_POSITION_ADDR(x)                           ((x) &lt;&lt; 10)</span>
<span class="cp">#       define R600_PARAM_GEN(x)                               ((x) &lt;&lt; 15)</span>
<span class="cp">#       define R600_PARAM_GEN_ADDR(x)                          ((x) &lt;&lt; 19)</span>
<span class="cp">#       define R600_BARYC_SAMPLE_CNTL(x)                       ((x) &lt;&lt; 26)</span>
<span class="cp">#       define R600_PERSP_GRADIENT_ENA                         (1 &lt;&lt; 28)</span>
<span class="cp">#       define R600_LINEAR_GRADIENT_ENA                        (1 &lt;&lt; 29)</span>
<span class="cp">#       define R600_POSITION_SAMPLE                            (1 &lt;&lt; 30)</span>
<span class="cp">#       define R600_BARYC_AT_SAMPLE_ENA                        (1 &lt;&lt; 31)</span>
<span class="cp">#define R600_SPI_PS_IN_CONTROL_1                               0x286d0</span>
<span class="cp">#       define R600_GEN_INDEX_PIX                              (1 &lt;&lt; 0)</span>
<span class="cp">#       define R600_GEN_INDEX_PIX_ADDR(x)                      ((x) &lt;&lt; 1)</span>
<span class="cp">#       define R600_FRONT_FACE_ENA                             (1 &lt;&lt; 8)</span>
<span class="cp">#       define R600_FRONT_FACE_CHAN(x)                         ((x) &lt;&lt; 9)</span>
<span class="cp">#       define R600_FRONT_FACE_ALL_BITS                        (1 &lt;&lt; 11)</span>
<span class="cp">#       define R600_FRONT_FACE_ADDR(x)                         ((x) &lt;&lt; 12)</span>
<span class="cp">#       define R600_FOG_ADDR(x)                                ((x) &lt;&lt; 17)</span>
<span class="cp">#       define R600_FIXED_PT_POSITION_ENA                      (1 &lt;&lt; 24)</span>
<span class="cp">#       define R600_FIXED_PT_POSITION_ADDR(x)                  ((x) &lt;&lt; 25)</span>
<span class="cp">#       define R700_POSITION_ULC                               (1 &lt;&lt; 30)</span>
<span class="cp">#define R600_SPI_INPUT_Z                                       0x286d8</span>

<span class="cp">#define R600_SPI_CONFIG_CNTL                                   0x9100</span>
<span class="cp">#       define R600_GPR_WRITE_PRIORITY(x)                      ((x) &lt;&lt; 0)</span>
<span class="cp">#       define R600_DISABLE_INTERP_1                           (1 &lt;&lt; 5)</span>
<span class="cp">#define R600_SPI_CONFIG_CNTL_1                                 0x913c</span>
<span class="cp">#       define R600_VTX_DONE_DELAY(x)                          ((x) &lt;&lt; 0)</span>
<span class="cp">#       define R600_INTERP_ONE_PRIM_PER_ROW                    (1 &lt;&lt; 4)</span>

<span class="cp">#define R600_GB_TILING_CONFIG                                  0x98f0</span>
<span class="cp">#       define R600_PIPE_TILING(x)                             ((x) &lt;&lt; 1)</span>
<span class="cp">#       define R600_BANK_TILING(x)                             ((x) &lt;&lt; 4)</span>
<span class="cp">#       define R600_GROUP_SIZE(x)                              ((x) &lt;&lt; 6)</span>
<span class="cp">#       define R600_ROW_TILING(x)                              ((x) &lt;&lt; 8)</span>
<span class="cp">#       define R600_BANK_SWAPS(x)                              ((x) &lt;&lt; 11)</span>
<span class="cp">#       define R600_SAMPLE_SPLIT(x)                            ((x) &lt;&lt; 14)</span>
<span class="cp">#       define R600_BACKEND_MAP(x)                             ((x) &lt;&lt; 16)</span>
<span class="cp">#define R600_DCP_TILING_CONFIG                                 0x6ca0</span>
<span class="cp">#define R600_HDP_TILING_CONFIG                                 0x2f3c</span>

<span class="cp">#define R600_CC_RB_BACKEND_DISABLE                             0x98f4</span>
<span class="cp">#define R700_CC_SYS_RB_BACKEND_DISABLE                         0x3f88</span>
<span class="cp">#       define R600_BACKEND_DISABLE(x)                         ((x) &lt;&lt; 16)</span>

<span class="cp">#define R600_CC_GC_SHADER_PIPE_CONFIG                          0x8950</span>
<span class="cp">#define R600_GC_USER_SHADER_PIPE_CONFIG                        0x8954</span>
<span class="cp">#       define R600_INACTIVE_QD_PIPES(x)                       ((x) &lt;&lt; 8)</span>
<span class="cp">#       define R600_INACTIVE_QD_PIPES_MASK                     (0xff &lt;&lt; 8)</span>
<span class="cp">#       define R600_INACTIVE_SIMDS(x)                          ((x) &lt;&lt; 16)</span>
<span class="cp">#       define R600_INACTIVE_SIMDS_MASK                        (0xff &lt;&lt; 16)</span>

<span class="cp">#define R700_CGTS_SYS_TCC_DISABLE                              0x3f90</span>
<span class="cp">#define R700_CGTS_USER_SYS_TCC_DISABLE                         0x3f94</span>
<span class="cp">#define R700_CGTS_TCC_DISABLE                                  0x9148</span>
<span class="cp">#define R700_CGTS_USER_TCC_DISABLE                             0x914c</span>

<span class="cm">/* Constants */</span>
<span class="cp">#define RADEON_MAX_USEC_TIMEOUT		100000	</span><span class="cm">/* 100 ms */</span><span class="cp"></span>

<span class="cp">#define RADEON_LAST_FRAME_REG		RADEON_SCRATCH_REG0</span>
<span class="cp">#define RADEON_LAST_DISPATCH_REG	RADEON_SCRATCH_REG1</span>
<span class="cp">#define RADEON_LAST_CLEAR_REG		RADEON_SCRATCH_REG2</span>
<span class="cp">#define RADEON_LAST_SWI_REG		RADEON_SCRATCH_REG3</span>
<span class="cp">#define RADEON_LAST_DISPATCH		1</span>

<span class="cp">#define R600_LAST_FRAME_REG		R600_SCRATCH_REG0</span>
<span class="cp">#define R600_LAST_DISPATCH_REG	        R600_SCRATCH_REG1</span>
<span class="cp">#define R600_LAST_CLEAR_REG		R600_SCRATCH_REG2</span>
<span class="cp">#define R600_LAST_SWI_REG		R600_SCRATCH_REG3</span>

<span class="cp">#define RADEON_MAX_VB_AGE		0x7fffffff</span>
<span class="cp">#define RADEON_MAX_VB_VERTS		(0xffff)</span>

<span class="cp">#define RADEON_RING_HIGH_MARK		128</span>

<span class="cp">#define RADEON_PCIGART_TABLE_SIZE      (32*1024)</span>

<span class="cp">#define RADEON_READ(reg)	DRM_READ32(  dev_priv-&gt;mmio, (reg) )</span>
<span class="cp">#define RADEON_WRITE(reg, val)                                          \</span>
<span class="cp">do {									\</span>
<span class="cp">	if (reg &lt; 0x10000) {				                \</span>
<span class="cp">		DRM_WRITE32(dev_priv-&gt;mmio, (reg), (val));		\</span>
<span class="cp">	} else {                                                        \</span>
<span class="cp">		DRM_WRITE32(dev_priv-&gt;mmio, RADEON_MM_INDEX, (reg));	\</span>
<span class="cp">		DRM_WRITE32(dev_priv-&gt;mmio, RADEON_MM_DATA, (val));	\</span>
<span class="cp">	}                                                               \</span>
<span class="cp">} while (0)</span>
<span class="cp">#define RADEON_READ8(reg)	DRM_READ8(  dev_priv-&gt;mmio, (reg) )</span>
<span class="cp">#define RADEON_WRITE8(reg,val)	DRM_WRITE8( dev_priv-&gt;mmio, (reg), (val) )</span>

<span class="cp">#define RADEON_WRITE_PLL(addr, val)					\</span>
<span class="cp">do {									\</span>
<span class="cp">	RADEON_WRITE8(RADEON_CLOCK_CNTL_INDEX,				\</span>
<span class="cp">		       ((addr) &amp; 0x1f) | RADEON_PLL_WR_EN );		\</span>
<span class="cp">	RADEON_WRITE(RADEON_CLOCK_CNTL_DATA, (val));			\</span>
<span class="cp">} while (0)</span>

<span class="cp">#define RADEON_WRITE_PCIE(addr, val)					\</span>
<span class="cp">do {									\</span>
<span class="cp">	RADEON_WRITE8(RADEON_PCIE_INDEX,				\</span>
<span class="cp">			((addr) &amp; 0xff));				\</span>
<span class="cp">	RADEON_WRITE(RADEON_PCIE_DATA, (val));			\</span>
<span class="cp">} while (0)</span>

<span class="cp">#define R500_WRITE_MCIND(addr, val)					\</span>
<span class="cp">do {								\</span>
<span class="cp">	RADEON_WRITE(R520_MC_IND_INDEX, 0xff0000 | ((addr) &amp; 0xff));	\</span>
<span class="cp">	RADEON_WRITE(R520_MC_IND_DATA, (val));			\</span>
<span class="cp">	RADEON_WRITE(R520_MC_IND_INDEX, 0);	\</span>
<span class="cp">} while (0)</span>

<span class="cp">#define RS480_WRITE_MCIND(addr, val)				\</span>
<span class="cp">do {									\</span>
<span class="cp">	RADEON_WRITE(RS480_NB_MC_INDEX,				\</span>
<span class="cp">			((addr) &amp; 0xff) | RS480_NB_MC_IND_WR_EN);	\</span>
<span class="cp">	RADEON_WRITE(RS480_NB_MC_DATA, (val));			\</span>
<span class="cp">	RADEON_WRITE(RS480_NB_MC_INDEX, 0xff);			\</span>
<span class="cp">} while (0)</span>

<span class="cp">#define RS690_WRITE_MCIND(addr, val)					\</span>
<span class="cp">do {								\</span>
<span class="cp">	RADEON_WRITE(RS690_MC_INDEX, RS690_MC_INDEX_WR_EN | ((addr) &amp; RS690_MC_INDEX_MASK));	\</span>
<span class="cp">	RADEON_WRITE(RS690_MC_DATA, val);			\</span>
<span class="cp">	RADEON_WRITE(RS690_MC_INDEX, RS690_MC_INDEX_WR_ACK);	\</span>
<span class="cp">} while (0)</span>

<span class="cp">#define RS600_WRITE_MCIND(addr, val)				\</span>
<span class="cp">do {							        \</span>
<span class="cp">	RADEON_WRITE(RS600_MC_INDEX, RS600_MC_IND_WR_EN | RS600_MC_IND_CITF_ARB0 | ((addr) &amp; RS600_MC_ADDR_MASK)); \</span>
<span class="cp">	RADEON_WRITE(RS600_MC_DATA, val);                       \</span>
<span class="cp">} while (0)</span>

<span class="cp">#define IGP_WRITE_MCIND(addr, val)				\</span>
<span class="cp">do {									\</span>
<span class="cp">	if (((dev_priv-&gt;flags &amp; RADEON_FAMILY_MASK) == CHIP_RS690) ||   \</span>
<span class="cp">	    ((dev_priv-&gt;flags &amp; RADEON_FAMILY_MASK) == CHIP_RS740))      \</span>
<span class="cp">		RS690_WRITE_MCIND(addr, val);				\</span>
<span class="cp">	else if ((dev_priv-&gt;flags &amp; RADEON_FAMILY_MASK) == CHIP_RS600)  \</span>
<span class="cp">		RS600_WRITE_MCIND(addr, val);				\</span>
<span class="cp">	else								\</span>
<span class="cp">		RS480_WRITE_MCIND(addr, val);				\</span>
<span class="cp">} while (0)</span>

<span class="cp">#define CP_PACKET0( reg, n )						\</span>
<span class="cp">	(RADEON_CP_PACKET0 | ((n) &lt;&lt; 16) | ((reg) &gt;&gt; 2))</span>
<span class="cp">#define CP_PACKET0_TABLE( reg, n )					\</span>
<span class="cp">	(RADEON_CP_PACKET0 | RADEON_ONE_REG_WR | ((n) &lt;&lt; 16) | ((reg) &gt;&gt; 2))</span>
<span class="cp">#define CP_PACKET1( reg0, reg1 )					\</span>
<span class="cp">	(RADEON_CP_PACKET1 | (((reg1) &gt;&gt; 2) &lt;&lt; 15) | ((reg0) &gt;&gt; 2))</span>
<span class="cp">#define CP_PACKET2()							\</span>
<span class="cp">	(RADEON_CP_PACKET2)</span>
<span class="cp">#define CP_PACKET3( pkt, n )						\</span>
<span class="cp">	(RADEON_CP_PACKET3 | (pkt) | ((n) &lt;&lt; 16))</span>

<span class="cm">/* ================================================================</span>
<span class="cm"> * Engine control helper macros</span>
<span class="cm"> */</span>

<span class="cp">#define RADEON_WAIT_UNTIL_2D_IDLE() do {				\</span>
<span class="cp">	OUT_RING( CP_PACKET0( RADEON_WAIT_UNTIL, 0 ) );			\</span>
<span class="cp">	OUT_RING( (RADEON_WAIT_2D_IDLECLEAN |				\</span>
<span class="cp">		   RADEON_WAIT_HOST_IDLECLEAN) );			\</span>
<span class="cp">} while (0)</span>

<span class="cp">#define RADEON_WAIT_UNTIL_3D_IDLE() do {				\</span>
<span class="cp">	OUT_RING( CP_PACKET0( RADEON_WAIT_UNTIL, 0 ) );			\</span>
<span class="cp">	OUT_RING( (RADEON_WAIT_3D_IDLECLEAN |				\</span>
<span class="cp">		   RADEON_WAIT_HOST_IDLECLEAN) );			\</span>
<span class="cp">} while (0)</span>

<span class="cp">#define RADEON_WAIT_UNTIL_IDLE() do {					\</span>
<span class="cp">	OUT_RING( CP_PACKET0( RADEON_WAIT_UNTIL, 0 ) );			\</span>
<span class="cp">	OUT_RING( (RADEON_WAIT_2D_IDLECLEAN |				\</span>
<span class="cp">		   RADEON_WAIT_3D_IDLECLEAN |				\</span>
<span class="cp">		   RADEON_WAIT_HOST_IDLECLEAN) );			\</span>
<span class="cp">} while (0)</span>

<span class="cp">#define RADEON_WAIT_UNTIL_PAGE_FLIPPED() do {				\</span>
<span class="cp">	OUT_RING( CP_PACKET0( RADEON_WAIT_UNTIL, 0 ) );			\</span>
<span class="cp">	OUT_RING( RADEON_WAIT_CRTC_PFLIP );				\</span>
<span class="cp">} while (0)</span>

<span class="cp">#define RADEON_FLUSH_CACHE() do {					\</span>
<span class="cp">	if ((dev_priv-&gt;flags &amp; RADEON_FAMILY_MASK) &lt;= CHIP_RV280) {	\</span>
<span class="cp">		OUT_RING(CP_PACKET0(RADEON_RB3D_DSTCACHE_CTLSTAT, 0));	\</span>
<span class="cp">		OUT_RING(RADEON_RB3D_DC_FLUSH);				\</span>
<span class="cp">	} else {                                                        \</span>
<span class="cp">		OUT_RING(CP_PACKET0(R300_RB3D_DSTCACHE_CTLSTAT, 0));	\</span>
<span class="cp">		OUT_RING(R300_RB3D_DC_FLUSH);				\</span>
<span class="cp">	}                                                               \</span>
<span class="cp">} while (0)</span>

<span class="cp">#define RADEON_PURGE_CACHE() do {					\</span>
<span class="cp">	if ((dev_priv-&gt;flags &amp; RADEON_FAMILY_MASK) &lt;= CHIP_RV280) {	\</span>
<span class="cp">		OUT_RING(CP_PACKET0(RADEON_RB3D_DSTCACHE_CTLSTAT, 0));	\</span>
<span class="cp">		OUT_RING(RADEON_RB3D_DC_FLUSH | RADEON_RB3D_DC_FREE);	\</span>
<span class="cp">	} else {                                                        \</span>
<span class="cp">		OUT_RING(CP_PACKET0(R300_RB3D_DSTCACHE_CTLSTAT, 0));	\</span>
<span class="cp">		OUT_RING(R300_RB3D_DC_FLUSH | R300_RB3D_DC_FREE);	\</span>
<span class="cp">	}                                                               \</span>
<span class="cp">} while (0)</span>

<span class="cp">#define RADEON_FLUSH_ZCACHE() do {					\</span>
<span class="cp">	if ((dev_priv-&gt;flags &amp; RADEON_FAMILY_MASK) &lt;= CHIP_RV280) {	\</span>
<span class="cp">		OUT_RING(CP_PACKET0(RADEON_RB3D_ZCACHE_CTLSTAT, 0));	\</span>
<span class="cp">		OUT_RING(RADEON_RB3D_ZC_FLUSH);				\</span>
<span class="cp">	} else {                                                        \</span>
<span class="cp">		OUT_RING(CP_PACKET0(R300_ZB_ZCACHE_CTLSTAT, 0));	\</span>
<span class="cp">		OUT_RING(R300_ZC_FLUSH);				\</span>
<span class="cp">	}                                                               \</span>
<span class="cp">} while (0)</span>

<span class="cp">#define RADEON_PURGE_ZCACHE() do {					\</span>
<span class="cp">	if ((dev_priv-&gt;flags &amp; RADEON_FAMILY_MASK) &lt;= CHIP_RV280) {	\</span>
<span class="cp">		OUT_RING(CP_PACKET0(RADEON_RB3D_ZCACHE_CTLSTAT, 0));	\</span>
<span class="cp">		OUT_RING(RADEON_RB3D_ZC_FLUSH | RADEON_RB3D_ZC_FREE);			\</span>
<span class="cp">	} else {                                                        \</span>
<span class="cp">		OUT_RING(CP_PACKET0(R300_ZB_ZCACHE_CTLSTAT, 0));	\</span>
<span class="cp">		OUT_RING(R300_ZC_FLUSH | R300_ZC_FREE);				\</span>
<span class="cp">	}                                                               \</span>
<span class="cp">} while (0)</span>

<span class="cm">/* ================================================================</span>
<span class="cm"> * Misc helper macros</span>
<span class="cm"> */</span>

<span class="cm">/* Perfbox functionality only.</span>
<span class="cm"> */</span>
<span class="cp">#define RING_SPACE_TEST_WITH_RETURN( dev_priv )				\</span>
<span class="cp">do {									\</span>
<span class="cp">	if (!(dev_priv-&gt;stats.boxes &amp; RADEON_BOX_DMA_IDLE)) {		\</span>
<span class="cp">		u32 head = GET_RING_HEAD( dev_priv );			\</span>
<span class="cp">		if (head == dev_priv-&gt;ring.tail)			\</span>
<span class="cp">			dev_priv-&gt;stats.boxes |= RADEON_BOX_DMA_IDLE;	\</span>
<span class="cp">	}								\</span>
<span class="cp">} while (0)</span>

<span class="cp">#define VB_AGE_TEST_WITH_RETURN( dev_priv )				\</span>
<span class="cp">do {								\</span>
<span class="cp">	struct drm_radeon_master_private *master_priv = file_priv-&gt;master-&gt;driver_priv;	\</span>
<span class="cp">	drm_radeon_sarea_t *sarea_priv = master_priv-&gt;sarea_priv;	\</span>
<span class="cp">	if ( sarea_priv-&gt;last_dispatch &gt;= RADEON_MAX_VB_AGE ) {		\</span>
<span class="cp">		int __ret;						\</span>
<span class="cp">		if ((dev_priv-&gt;flags &amp; RADEON_FAMILY_MASK) &gt;= CHIP_R600) \</span>
<span class="cp">			__ret = r600_do_cp_idle(dev_priv);		\</span>
<span class="cp">		else							\</span>
<span class="cp">			__ret = radeon_do_cp_idle(dev_priv);		\</span>
<span class="cp">		if ( __ret ) return __ret;				\</span>
<span class="cp">		sarea_priv-&gt;last_dispatch = 0;				\</span>
<span class="cp">		radeon_freelist_reset( dev );				\</span>
<span class="cp">	}								\</span>
<span class="cp">} while (0)</span>

<span class="cp">#define RADEON_DISPATCH_AGE( age ) do {					\</span>
<span class="cp">	OUT_RING( CP_PACKET0( RADEON_LAST_DISPATCH_REG, 0 ) );		\</span>
<span class="cp">	OUT_RING( age );						\</span>
<span class="cp">} while (0)</span>

<span class="cp">#define RADEON_FRAME_AGE( age ) do {					\</span>
<span class="cp">	OUT_RING( CP_PACKET0( RADEON_LAST_FRAME_REG, 0 ) );		\</span>
<span class="cp">	OUT_RING( age );						\</span>
<span class="cp">} while (0)</span>

<span class="cp">#define RADEON_CLEAR_AGE( age ) do {					\</span>
<span class="cp">	OUT_RING( CP_PACKET0( RADEON_LAST_CLEAR_REG, 0 ) );		\</span>
<span class="cp">	OUT_RING( age );						\</span>
<span class="cp">} while (0)</span>

<span class="cp">#define R600_DISPATCH_AGE(age) do {					\</span>
<span class="cp">	OUT_RING(CP_PACKET3(R600_IT_SET_CONFIG_REG, 1));		\</span>
<span class="cp">	OUT_RING((R600_LAST_DISPATCH_REG - R600_SET_CONFIG_REG_OFFSET) &gt;&gt; 2);  \</span>
<span class="cp">	OUT_RING(age);							\</span>
<span class="cp">} while (0)</span>

<span class="cp">#define R600_FRAME_AGE(age) do {					\</span>
<span class="cp">	OUT_RING(CP_PACKET3(R600_IT_SET_CONFIG_REG, 1));		\</span>
<span class="cp">	OUT_RING((R600_LAST_FRAME_REG - R600_SET_CONFIG_REG_OFFSET) &gt;&gt; 2);  \</span>
<span class="cp">	OUT_RING(age);							\</span>
<span class="cp">} while (0)</span>

<span class="cp">#define R600_CLEAR_AGE(age) do {					\</span>
<span class="cp">	OUT_RING(CP_PACKET3(R600_IT_SET_CONFIG_REG, 1));		\</span>
<span class="cp">	OUT_RING((R600_LAST_CLEAR_REG - R600_SET_CONFIG_REG_OFFSET) &gt;&gt; 2);  \</span>
<span class="cp">	OUT_RING(age);							\</span>
<span class="cp">} while (0)</span>

<span class="cm">/* ================================================================</span>
<span class="cm"> * Ring control</span>
<span class="cm"> */</span>

<span class="cp">#define RADEON_VERBOSE	0</span>

<span class="cp">#define RING_LOCALS	int write, _nr, _align_nr; unsigned int mask; u32 *ring;</span>

<span class="cp">#define RADEON_RING_ALIGN 16</span>

<span class="cp">#define BEGIN_RING( n ) do {						\</span>
<span class="cp">	if ( RADEON_VERBOSE ) {						\</span>
<span class="cp">		DRM_INFO( &quot;BEGIN_RING( %d )\n&quot;, (n));			\</span>
<span class="cp">	}								\</span>
<span class="cp">	_align_nr = RADEON_RING_ALIGN - ((dev_priv-&gt;ring.tail + n) &amp; (RADEON_RING_ALIGN-1));	\</span>
<span class="cp">	_align_nr += n;							\</span>
<span class="cp">	if (dev_priv-&gt;ring.space &lt;= (_align_nr * sizeof(u32))) {	\</span>
<span class="cp">                COMMIT_RING();						\</span>
<span class="cp">		radeon_wait_ring( dev_priv, _align_nr * sizeof(u32));	\</span>
<span class="cp">	}								\</span>
<span class="cp">	_nr = n; dev_priv-&gt;ring.space -= (n) * sizeof(u32);		\</span>
<span class="cp">	ring = dev_priv-&gt;ring.start;					\</span>
<span class="cp">	write = dev_priv-&gt;ring.tail;					\</span>
<span class="cp">	mask = dev_priv-&gt;ring.tail_mask;				\</span>
<span class="cp">} while (0)</span>

<span class="cp">#define ADVANCE_RING() do {						\</span>
<span class="cp">	if ( RADEON_VERBOSE ) {						\</span>
<span class="cp">		DRM_INFO( &quot;ADVANCE_RING() wr=0x%06x tail=0x%06x\n&quot;,	\</span>
<span class="cp">			  write, dev_priv-&gt;ring.tail );			\</span>
<span class="cp">	}								\</span>
<span class="cp">	if (((dev_priv-&gt;ring.tail + _nr) &amp; mask) != write) {		\</span>
<span class="cp">		DRM_ERROR(						\</span>
<span class="cp">			&quot;ADVANCE_RING(): mismatch: nr: %x write: %x line: %d\n&quot;,	\</span>
<span class="cp">			((dev_priv-&gt;ring.tail + _nr) &amp; mask),		\</span>
<span class="cp">			write, __LINE__);				\</span>
<span class="cp">	} else								\</span>
<span class="cp">		dev_priv-&gt;ring.tail = write;				\</span>
<span class="cp">} while (0)</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">radeon_commit_ring</span><span class="p">(</span><span class="n">drm_radeon_private_t</span> <span class="o">*</span><span class="n">dev_priv</span><span class="p">);</span>

<span class="cp">#define COMMIT_RING() do {						\</span>
<span class="cp">		radeon_commit_ring(dev_priv);				\</span>
<span class="cp">	} while(0)</span>

<span class="cp">#define OUT_RING( x ) do {						\</span>
<span class="cp">	if ( RADEON_VERBOSE ) {						\</span>
<span class="cp">		DRM_INFO( &quot;   OUT_RING( 0x%08x ) at 0x%x\n&quot;,		\</span>
<span class="cp">			   (unsigned int)(x), write );			\</span>
<span class="cp">	}								\</span>
<span class="cp">	ring[write++] = (x);						\</span>
<span class="cp">	write &amp;= mask;							\</span>
<span class="cp">} while (0)</span>

<span class="cp">#define OUT_RING_REG( reg, val ) do {					\</span>
<span class="cp">	OUT_RING( CP_PACKET0( reg, 0 ) );				\</span>
<span class="cp">	OUT_RING( val );						\</span>
<span class="cp">} while (0)</span>

<span class="cp">#define OUT_RING_TABLE( tab, sz ) do {					\</span>
<span class="cp">	int _size = (sz);					\</span>
<span class="cp">	int *_tab = (int *)(tab);				\</span>
<span class="cp">								\</span>
<span class="cp">	if (write + _size &gt; mask) {				\</span>
<span class="cp">		int _i = (mask+1) - write;			\</span>
<span class="cp">		_size -= _i;					\</span>
<span class="cp">		while (_i &gt; 0 ) {				\</span>
<span class="cp">			*(int *)(ring + write) = *_tab++;	\</span>
<span class="cp">			write++;				\</span>
<span class="cp">			_i--;					\</span>
<span class="cp">		}						\</span>
<span class="cp">		write = 0;					\</span>
<span class="cp">		_tab += _i;					\</span>
<span class="cp">	}							\</span>
<span class="cp">	while (_size &gt; 0) {					\</span>
<span class="cp">		*(ring + write) = *_tab++;			\</span>
<span class="cp">		write++;					\</span>
<span class="cp">		_size--;					\</span>
<span class="cp">	}							\</span>
<span class="cp">	write &amp;= mask;						\</span>
<span class="cp">} while (0)</span>

<span class="cm">/**</span>
<span class="cm"> * Copy given number of dwords from drm buffer to the ring buffer.</span>
<span class="cm"> */</span>
<span class="cp">#define OUT_RING_DRM_BUFFER(buf, sz) do {				\</span>
<span class="cp">	int _size = (sz) * 4;						\</span>
<span class="cp">	struct drm_buffer *_buf = (buf);				\</span>
<span class="cp">	int _part_size;							\</span>
<span class="cp">	while (_size &gt; 0) {						\</span>
<span class="cp">		_part_size = _size;					\</span>
<span class="cp">									\</span>
<span class="cp">		if (write + _part_size/4 &gt; mask)			\</span>
<span class="cp">			_part_size = ((mask + 1) - write)*4;		\</span>
<span class="cp">									\</span>
<span class="cp">		if (drm_buffer_index(_buf) + _part_size &gt; PAGE_SIZE)	\</span>
<span class="cp">			_part_size = PAGE_SIZE - drm_buffer_index(_buf);\</span>
<span class="cp">									\</span>
<span class="cp">									\</span>
<span class="cp">									\</span>
<span class="cp">		memcpy(ring + write, &amp;_buf-&gt;data[drm_buffer_page(_buf)]	\</span>
<span class="cp">			[drm_buffer_index(_buf)], _part_size);		\</span>
<span class="cp">									\</span>
<span class="cp">		_size -= _part_size;					\</span>
<span class="cp">		write = (write + _part_size/4) &amp; mask;			\</span>
<span class="cp">		drm_buffer_advance(_buf, _part_size);			\</span>
<span class="cp">	}								\</span>
<span class="cp">} while (0)</span>


<span class="cp">#endif				</span><span class="cm">/* __RADEON_DRV_H__ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
