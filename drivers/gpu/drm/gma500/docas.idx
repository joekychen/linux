f | opregion.h | s | 1.7K | 43 | Alan Cox | alan@linux.intel.com | 1336754146 |  | gma500: Fix build without ACPI  Reported-by: Randy Dunlap <rdunlap@xenotime.net> Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | gem.c | s | 8.3K | 268 | Alan Cox | alan@linux.intel.com | 1335515076 |  | gma500: Set the mapping mask  Some boards such as the Intel D2700MUD allow you to have over 4GB of RAM. The GTT on the PVR based devices is 32bit however. Hugh Dickins points out that we should therefore be setting the mapping gfp mask.  This is not the whole fix for the problem. Some further shmem patches will be needed to deal with the corner cases.  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | psb_intel_sdvo_regs.h | s | 23K | 647 | Patrik Jakobsson | patrik.r.jakobsson@gmail.com | 1324376594 |  | gma500: Replace SDVO code with slightly modified version from i915  Our current SDVO implementation is not working properly, so replace it with a modified version of the i915. Further testing and debugging is needed to make sure we can handle the different SDVO setups and wiring.  Signed-off-by: Patrik Jakobsson <patrik.r.jakobsson@gmail.com> Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | power.h | s | 2.5K | 59 | Alan Cox | alan@linux.intel.com | 1321442708 |  | gma500: Add device framework  The devices have various internal differences so we have some abstractions to hide the ugly differences and we then wrap them up in standard interfaces. Add these bits  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | Makefile | g | 1.0K |  | Alan Cox | alan@linux.intel.com | 1336754146 |  | gma500: Fix build without ACPI  Reported-by: Randy Dunlap <rdunlap@xenotime.net> Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | cdv_intel_lvds.c | s | 21K | 691 | Kirill A. Shutemov | kirill.shutemov@linux.intel.com | 1336384736 |  | gma500: cdv_intel_lvds: mark cdv_intel_lvds_enc_funcs as static  Signed-off-by: Kirill A. Shutemov <kirill.shutemov@linux.intel.com> Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | accel_2d.c | s | 9.5K | 326 | Ville Syrjälä | ville.syrjala@linux.intel.com | 1324375587 |  | drm: Replace pitch with pitches[] in drm_framebuffer  Otherwise each driver would need to keep the information inside their own framebuffer object structure. Also add offsets[]. BOs on the other hand are driver specific, so those can be kept in driver specific structures.  Signed-off-by: Ville Syrjälä <ville.syrjala@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | psb_drv.c | s | 18K | 572 | Laurent Pinchart | laurent.pinchart@ideasonboard.com | 1337679293 |  | drm: Constify gem_vm_ops pointer  The GEM vm operations structure is passed to the VM core that stores it in a const field. There vm operations structures can thus be const in DRM as well.  Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com> Cc: Inki Dae <inki.dae@samsung.com> Cc: Alan Cox <alan@linux.intel.com> Cc: Daniel Vetter <daniel.vetter@ffwll.ch> Cc: Rob Clark <rob.clark@linaro.org> Reviewed-by: Alex Deucher <alexdeucher@gmail.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | intel_bios.h | s | 15K | 521 | Alan Cox | alan@linux.intel.com | 1335515027 |  | gma500: intel_bios updates  Pull in various i915 bits that we will need to begin tackling the LVDS detect and ACPI events. We try and drift towards the i915 version of the code with the long term goal that at least some of it can one day be unified.  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | intel_bios.c | s | 13K | 435 | Alan Cox | alan@linux.intel.com | 1337249130 |  | gma500: unload fixes  Debugging the lid problem tested various error paths which were found wanting so start fixing them up.  There is a ton of improvement work could be done here so that every bit of functionality agrees if its _fini, _uninit, etc, and they agree who is responsible for deciding if the clean up is needed.  That can come later.  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | psb_reg.h | s | 18K | 512 | Alan Cox | alan@linux.intel.com | 1321442795 |  | gma500: Add the core DRM files and headers  Not really a nice way to split this up further for submission. This provides all the DRM interfacing logic, the headers and relevant glue.  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | mdfld_tmd_vid.c | s | 7.1K | 177 | Kirill A. Shutemov | kirill.shutemov@linux.intel.com | 1331384748 |  | gma500: initial medfield merge  We need to merge this ahead of some of the cleanup because a lot of needed cleanup spans both new and old chips. If we try and clean up and the merge we end up fighting ourselves.  Signed-off-by: Kirill A. Shutemov <kirill.shutemov@linux.intel.com> [With a load of the cleanup stuff folded in, register stuff reworked sanely] Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | psb_drv.h | s | 24K | 819 | Patrik Jakobsson | patrik.r.jakobsson@gmail.com | 1337678134 |  | gma500: handle poulsbo cursor restriction  Poulsbo needs a physical address in the cursor base register. We allocate a stolen memory buffer and copy the cursor image provided by userspace into it. When/If we get our own userspace driver we can map this stolen memory directly. The patch also adds a mark in chip ops so we can identify devices that has this requirement.  Signed-off-by: Patrik Jakobsson <patrik.r.jakobsson@gmail.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | cdv_intel_display.c | s | 41K | 1364 | Alan Cox | alan@linux.intel.com | 1336754151 |  | gma500: use the register map to clean up  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | cdv_device.h | s | 1.4K | 32 | Kirill A. Shutemov | kirill.shutemov@linux.intel.com | 1331384775 |  | gma500: fix cdv_intel_wait_for_vblank() prototype  Signed-off-by: Kirill A. Shutemov <kirill.shutemov@linux.intel.com> Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | tc35876x-dsi-lvds.h | s | 1.7K | 34 | Kirill A. Shutemov | kirill.shutemov@linux.intel.com | 1331384748 |  | gma500: initial medfield merge  We need to merge this ahead of some of the cleanup because a lot of needed cleanup spans both new and old chips. If we try and clean up and the merge we end up fighting ourselves.  Signed-off-by: Kirill A. Shutemov <kirill.shutemov@linux.intel.com> [With a load of the cleanup stuff folded in, register stuff reworked sanely] Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | gtt.c | s | 14K | 477 | Alan Cox | alan@linux.intel.com | 1336754152 |  | gma500: Clean up some of the noise  We have a lot of debug type stuff we don't actually need any more.  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | cdv_intel_crt.c | s | 8.7K | 273 | Alan Cox | alan@linux.intel.com | 1335515056 |  | cdv: continue synching up with updated reference code  In particular clean up the errata handling and correct the crtc masks. We do this a bit differently using our device abstraction for neatness.  This doesn't address the ACPI opregion and hotplug plumbing, nor the IRQ related changes that will need. It touches on backlight init but the full backlight support is not in this change set.  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | psb_lid.c | s | 2.9K | 80 | Alan Cox | alan@linux.intel.com | 1337678129 |  | gma500: Prevent endless loop in panel power up sequence  Some devices don't have a panel connected to LVDS and thus will never power up. This patch checks the power sequence progress bits in PP_STATUS to prevent an endless loop on such devices.  Signed-off-by: Patrik Jakobsson <patrik.r.jakobsson@gmail.com> Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | psb_intel_modes.c | s | 1.7K | 69 | Patrik Jakobsson | patrik.r.jakobsson@gmail.com | 1324376586 |  | gma500: Remove psb_intel_output from ddc_probe and ddc_get_modes  Signed-off-by: Patrik Jakobsson <patrik.r.jakobsson@gmail.com> Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | psb_intel_sdvo.c | s | 81K | 2203 | Alan Cox | alan@linux.intel.com | 1336754161 |  | gma500: clean up some more checks  We don't need to check these - they are always going to be the same for any PVR based device.  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | mdfld_output.c | s | 2.3K | 66 | Kirill A. Shutemov | kirill.shutemov@linux.intel.com | 1331384751 |  | gma500: mdfld_dsi_output_init() drop unused parameter  Nobody uses 'config' parameter.  Signed-off-by: Kirill A. Shutemov <kirill.shutemov@linux.intel.com> Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | mdfld_dsi_pkg_sender.c | s | 15K | 581 | Alan Cox | alan@linux.intel.com | 1336754151 |  | gma500: use the register map to clean up  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | tc35876x-dsi-lvds.c | s | 21K | 688 | Kirill A. Shutemov | kirill.shutemov@linux.intel.com | 1331384748 |  | gma500: initial medfield merge  We need to merge this ahead of some of the cleanup because a lot of needed cleanup spans both new and old chips. If we try and clean up and the merge we end up fighting ourselves.  Signed-off-by: Kirill A. Shutemov <kirill.shutemov@linux.intel.com> [With a load of the cleanup stuff folded in, register stuff reworked sanely] Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | power.c | s | 8.6K | 282 | Alan Cox | alan@linux.intel.com | 1331804782 |  | gma500: suspend/resume support for Cedartrail  Update our tree to match the current driver head.  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | oaktrail_hdmi.c | s | 14K | 446 | Alan Cox | alan@linux.intel.com | 1336754147 |  | gma500: introduce a structure describing each pipe  This starts the move away from lots of confused unions of per driver stuff inherited when we merged the drivers together.  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | gem_glue.h | s | 132B | 2 | Alan Cox | alan@linux.intel.com | 1321442556 |  | gma500: GEM and GEM glue  The driver uses GEM along with a couple of small bits of wrapping of its own. The only real oddity here is the support for using the 'stolen' memory rather than wasting several MB.  We use a simple resource manager as we don't need to manage our space intensively at all as we only do 2D work. We also have a GTT which is entirely GPU facing so in the Cedarview case are not even allocating from host address space.  Signed-off-by: Alan Cox <alan@linux.intel.com> Reviewed-by: Daniel Vetter <daniel.vetter@ffwll.ch> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | backlight.c | s | 1.4K | 46 | Alan Cox | alan@linux.intel.com | 1321442708 |  | gma500: Add device framework  The devices have various internal differences so we have some abstractions to hide the ugly differences and we then wrap them up in standard interfaces. Add these bits  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | oaktrail_hdmi_i2c.c | s | 8.2K | 271 | Kirill A. Shutemov | kirill.shutemov@linux.intel.com | 1336384735 |  | gma500: oaktrail_hdmi_i2c_handler(): base should be __iomem  Signed-off-by: Kirill A. Shutemov <kirill.shutemov@linux.intel.com> Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | psb_irq.c | s | 16K | 522 | Kirill A. Shutemov | kirill.shutemov@linux.intel.com | 1336384733 |  | gma500: psb_irq_turn_off_dpst() fix bit operation  Signed-off-by: Kirill A. Shutemov <kirill.shutemov@linux.intel.com> Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | psb_intel_reg.h | s | 43K | 1255 | Alan Cox | alan@linux.intel.com | 1336384700 |  | gma500: opregion and ACPI  Add the opregion support and bring us in line with the opregion functionality in the reference driver code. We can't share this with i915 currently because there are hardcoded assumptions about dev_priv etc in both versions.  [airlied: include opregion.h fix]  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | mid_bios.c | s | 8.5K | 283 | Kirill A. Shutemov | kirill.shutemov@linux.intel.com | 1336384738 |  | gma500: mid-bios: rewrite VBT/GCT handling in a cleaner way  Signed-off-by: Kirill A. Shutemov <kirill.shutemov@linux.intel.com> Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | oaktrail_crtc.c | s | 15K | 491 | Alan Cox | alan@linux.intel.com | 1336754151 |  | gma500: use the register map to clean up  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | framebuffer.h | s | 1.3K | 38 | Alan Cox | alan@linux.intel.com | 1323165329 |  | gma500: kill virtual mapping support  This isn't actually usable - we simply don't have the vmap space on a 32bit system to do this stunt. Instead we will rely on the low level drivers limiting the console resolution as before.  The real fix is for someone to write a page table aware version of the framebuffer console blit functions. Good university student project perhaps..  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | gtt.h | s | 2.3K | 57 | Alan Cox | alan@linux.intel.com | 1323165339 |  | gma500: gtt based hardware scrolling console  Add support for GTT based scrolling. Instead of pushing bits around we simply use the GTT to change the mappings. This provides us with a very fast way to scroll the display providing we have enough memory to allocate on 4K line boundaries. In practice this seems to be the case except for very big displays such as HDMI, and the usual configurations are netbooks/tablets.  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | mdfld_dsi_pkg_sender.h | s | 2.9K | 81 | Kirill A. Shutemov | kirill.shutemov@linux.intel.com | 1331384748 |  | gma500: initial medfield merge  We need to merge this ahead of some of the cleanup because a lot of needed cleanup spans both new and old chips. If we try and clean up and the merge we end up fighting ourselves.  Signed-off-by: Kirill A. Shutemov <kirill.shutemov@linux.intel.com> [With a load of the cleanup stuff folded in, register stuff reworked sanely] Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | mmu.c | s | 18K | 700 | Linus Torvalds | torvalds@linux-foundation.org | 1332446902 |  | Merge branch 'drm-next' of git://people.freedesktop.org/~airlied/linux  Pull drm main changes from Dave Airlie:  "This is the main drm pull request, I'm probably going to send two more   smaller ones, will explain below.    This contains a patch that is also in the fbdev tree, but it should be   the same patch, it added an API for hot unplugging framebuffer   devices, and I need that API for a new driver.    It also contains some changes to the i2c tree which Jean has acked,   and one change to moorestown platform stuff in x86.    Highlights:    - new drivers: UDL driver for USB displaylink devices, kms only,      should support correct hotplug operations.    - core: i2c speedups + better hotplug support, EDID overriding via      firmware interface - allows user to load a firmware for a broken      monitor/kvm from userspace, it even has documentation for it.    - exynos: new HDMI audio + hdmi 1.4 + virtual output driver    - gma500: code cleanup    - radeon: cleanups, CS optimisations, streamout support and pageflip      fix    - nouveau: NVD9 displayport support + more reclocking work    - i915: re-enabling GMBUS, finish gpu patch (might help hibernation      who knows), missed irq fixes, stencil tiling fixes, interlaced      support, aliasesd PPGTT support for SNB/IVB, swizzling for SNB/IVB,      semaphore fixes    As well as the usual bunch of cleanups and fixes all over the place.    I've got two things I'd like to merge a bit later:     a) AMD support for all their new radeonhd 7000 series GPU and APUs.       AMD dropped this a bit late due to insane internal review       processes, (please AMD just follow Intel and let open source guys       ship stuff early) however I don't want to penalise people who own       this hardware (since its been on sale for 3-4 months and GPU hw       doesn't exactly have a lifetime in years) and consign them to       using closed drivers for longer than necessary.  The changes are       well contained and just plug into the driver new gpu functionality       so they should be fairly regression proof.  I just want to give       them a bit of a run on the hw AMD kindly sent me.     b) drm prime/dma-buf interface code.  This is just infrastructure       code to expose the dma-buf stuff to drm drivers and to userspace.       I'm not planning on pushing any driver support in this cycle       (except maybe exynos), but I'd like to get the infrastructure code       in so for the next cycle I can start getting the driver support       into the individual drivers.  We have started driver support for       i915, nouveau and udl along with I think exynos and omap in       staging.  However this code relies on the dma-buf tree being       pulled into your tree first since it needs the latest interfaces       from that tree.  I'll push to get that tree sent asap.    (oh and any warnings you see in i915 are gcc's fault from what anyone   can see)."  Fix up trivial conflicts in arch/x86/platform/mrst/mrst.c due to the new msic_thermal_platform_data() thermal function being added next to the tc35876x_platform_data() i2c device function..  * 'drm-next' of git://people.freedesktop.org/~airlied/linux: (326 commits)   drm/i915: use DDC_ADDR instead of hard-coding it   drm/radeon: use DDC_ADDR instead of hard-coding it   drm: remove unneeded redefinition of DDC_ADDR   drm/exynos: added virtual display driver.   drm: allow loading an EDID as firmware to override broken monitor   drm/exynos: enable hdmi audio feature   drm/exynos: add default pixel format for plane   drm/exynos: cleanup exynos_hdmi.h   drm/exynos: add is_local member in exynos_drm_subdrv struct   drm/exynos: add subdrv open/close functions   drm/exynos: remove module of exynos drm subdrv   drm/exynos: release pending pageflip events when closed   drm/exynos: added new funtion to get/put dma address.   drm/exynos: update gem and buffer framework.   drm/exynos: added mode_fixup feature and code clean.   drm/exynos: add HDMI version 1.4 support   drm/exynos: remove exynos_mixer.h   gma500: Fix mmap frambuffer   drm/radeon: Drop radeon_gem_object_(un)pin.   drm/radeon: Restrict offset for legacy display engine.   ...
f | psb_device.c | s | 10K | 344 | Alan Cox | alan@linux.intel.com | 1337678145 |  | gma500: Fix Poulsbo suspend/resume crash on devices with SDVO ports  Reported-by: Guillaume Clément <guillaume@baobob.org> Signed-off-by: Alan Cox <alan@linux.intel.com> Cc: stable@vger.kernel.org Signed-off-by: Dave Airlie <airlied@redhat.com>
f | cdv_device.c | s | 15K | 490 | Patrik Jakobsson | patrik.r.jakobsson@gmail.com | 1337678134 |  | gma500: handle poulsbo cursor restriction  Poulsbo needs a physical address in the cursor base register. We allocate a stolen memory buffer and copy the cursor image provided by userspace into it. When/If we get our own userspace driver we can map this stolen memory directly. The patch also adds a mark in chip ops so we can identify devices that has this requirement.  Signed-off-by: Patrik Jakobsson <patrik.r.jakobsson@gmail.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | cdv_intel_hdmi.c | s | 10K | 327 | Alan Cox | alan@linux.intel.com | 1335515049 |  | gma500: support 1080p  The problem in console mode is lack of linear memory. We can solve that by dropping to 16bpp. The mode setting X server will allocate its own GEM framebuffer in 32bpp and all will be well.  We could just do 16bpp anyway but that would be a regression on the lower modes as many distributions don't yet ship the generic mode setting KMS drivers.  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | mdfld_device.c | s | 13K | 469 | Patrik Jakobsson | patrik.r.jakobsson@gmail.com | 1337678134 |  | gma500: handle poulsbo cursor restriction  Poulsbo needs a physical address in the cursor base register. We allocate a stolen memory buffer and copy the cursor image provided by userspace into it. When/If we get our own userspace driver we can map this stolen memory directly. The patch also adds a mark in chip ops so we can identify devices that has this requirement.  Signed-off-by: Patrik Jakobsson <patrik.r.jakobsson@gmail.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | psb_intel_drv.h | s | 9.1K | 250 | Patrik Jakobsson | patrik.r.jakobsson@gmail.com | 1337678134 |  | gma500: handle poulsbo cursor restriction  Poulsbo needs a physical address in the cursor base register. We allocate a stolen memory buffer and copy the cursor image provided by userspace into it. When/If we get our own userspace driver we can map this stolen memory directly. The patch also adds a mark in chip ops so we can identify devices that has this requirement.  Signed-off-by: Patrik Jakobsson <patrik.r.jakobsson@gmail.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | psb_irq.h | s | 1.8K | 41 | Kirill A. Shutemov | kirill.shutemov@linux.intel.com | 1331384748 |  | gma500: initial medfield merge  We need to merge this ahead of some of the cleanup because a lot of needed cleanup spans both new and old chips. If we try and clean up and the merge we end up fighting ourselves.  Signed-off-by: Kirill A. Shutemov <kirill.shutemov@linux.intel.com> [With a load of the cleanup stuff folded in, register stuff reworked sanely] Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | mdfld_tpo_vid.c | s | 4.0K | 110 | Kirill A. Shutemov | kirill.shutemov@linux.intel.com | 1331384748 |  | gma500: initial medfield merge  We need to merge this ahead of some of the cleanup because a lot of needed cleanup spans both new and old chips. If we try and clean up and the merge we end up fighting ourselves.  Signed-off-by: Kirill A. Shutemov <kirill.shutemov@linux.intel.com> [With a load of the cleanup stuff folded in, register stuff reworked sanely] Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | framebuffer.c | s | 21K | 696 | Laurent Pinchart | laurent.pinchart@ideasonboard.com | 1337679307 |  | drm: Constify drm_mode_config_funcs pointer  The DRM mode config functions structure declared by drivers and pointed to by the drm_mode_config funcs field is never modified. Make it a const pointer.  Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com> Cc: Inki Dae <inki.dae@samsung.com> Cc: Alan Cox <alan@linux.intel.com> Cc: Daniel Vetter <daniel.vetter@ffwll.ch> Cc: Ben Skeggs <bskeggs@redhat.com> Cc: Thomas Hellstrom <thellstrom@vmware.com> Cc: Rob Clark <rob.clark@linaro.org> Reviwed-by: Alex Deucher <alexdeucher@gmail.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | oaktrail.h | s | 7.8K | 236 | Kirill A. Shutemov | kirill.shutemov@linux.intel.com | 1336384738 |  | gma500: mid-bios: rewrite VBT/GCT handling in a cleaner way  Signed-off-by: Kirill A. Shutemov <kirill.shutemov@linux.intel.com> Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | Kconfig | g | 986B |  | Kirill A. Shutemov | kirill.shutemov@linux.intel.com | 1331384748 |  | gma500: initial medfield merge  We need to merge this ahead of some of the cleanup because a lot of needed cleanup spans both new and old chips. If we try and clean up and the merge we end up fighting ourselves.  Signed-off-by: Kirill A. Shutemov <kirill.shutemov@linux.intel.com> [With a load of the cleanup stuff folded in, register stuff reworked sanely] Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | mdfld_intel_display.c | s | 29K | 907 | Alan Cox | alan@linux.intel.com | 1336754151 |  | gma500: use the register map to clean up  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | oaktrail_lvds.c | s | 13K | 391 | Kirill A. Shutemov | kirill.shutemov@linux.intel.com | 1336384738 |  | gma500: mid-bios: rewrite VBT/GCT handling in a cleaner way  Signed-off-by: Kirill A. Shutemov <kirill.shutemov@linux.intel.com> Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | intel_gmbus.c | s | 12K | 413 | Axel Lin | axel.lin@gmail.com | 1329134856 |  | drm: Fix kcalloc parameters swapped  The first parameter should be "number of elements" and the second parameter should be "element size".  Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | psb_intel_lvds.c | s | 24K | 740 | Jesper Juhl | jj@chaosbits.net | 1331384737 |  | intel, gma500, lvds: Fix use after free and mem leak in psb_intel_lvds_init()  In psb_intel_lvds_init(), if we fail to allocate memory for 'psb_intel_connector' we free the memory we previously allocated for 'psb_intel_encoder', but we then proceed to use that free'd pointer when we do 'psb_intel_encoder->dev_priv = lvds_priv;'.  We may also leak the memory we allocated for 'psb_intel_encoder' if we 'goto failed_connector;' and the variable goes out of scope.  While I was there anyway, I also removed the pointless 'if (psb_intel_connector)' before freeing it at the 'failed_connector:' label - kfree() deals gracefully with NULL pointers, so it is not needed.  Signed-off-by: Jesper Juhl <jj@chaosbits.net> Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | mdfld_output.h | s | 2.5K | 64 | Kirill A. Shutemov | kirill.shutemov@linux.intel.com | 1331384748 |  | gma500: initial medfield merge  We need to merge this ahead of some of the cleanup because a lot of needed cleanup spans both new and old chips. If we try and clean up and the merge we end up fighting ourselves.  Signed-off-by: Kirill A. Shutemov <kirill.shutemov@linux.intel.com> [With a load of the cleanup stuff folded in, register stuff reworked sanely] Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | oaktrail_device.c | s | 15K | 486 | Patrik Jakobsson | patrik.r.jakobsson@gmail.com | 1337678134 |  | gma500: handle poulsbo cursor restriction  Poulsbo needs a physical address in the cursor base register. We allocate a stolen memory buffer and copy the cursor image provided by userspace into it. When/If we get our own userspace driver we can map this stolen memory directly. The patch also adds a mark in chip ops so we can identify devices that has this requirement.  Signed-off-by: Patrik Jakobsson <patrik.r.jakobsson@gmail.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | mdfld_dsi_output.c | s | 16K | 517 | Kirill A. Shutemov | kirill.shutemov@linux.intel.com | 1332750804 |  | gma500: medfield: fix build without CONFIG_BACKLIGHT_CLASS_DEVICE  drivers/built-in.o: In function `mdfld_dsi_connector_set_property': mdfld_dsi_output.c:(.text+0x6e909): undefined reference to `mdfld_set_brightness' make: *** [.tmp_vmlinux1] Error 1  Signed-off-by: Kirill A. Shutemov <kirill.shutemov@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | gem_glue.c | s | 2.6K | 84 | Kirill A. Shutemov | kirill.shutemov@linux.intel.com | 1331384756 |  | gma500: gem_glue: add missing include  It fixes W=1 warnings:  drivers/gpu/drm/gma500/gem_glue.c:23:6: warning: no previous prototype for ‘drm_gem_object_release_wrap’ [-Wmissing-prototypes] drivers/gpu/drm/gma500/gem_glue.c:44:5: warning: no previous prototype for ‘gem_create_mmap_offset’ [-Wmissing-prototypes]  Signed-off-by: Kirill A. Shutemov <kirill.shutemov@linux.intel.com> Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | mdfld_dsi_dpi.h | s | 2.8K | 70 | Kirill A. Shutemov | kirill.shutemov@linux.intel.com | 1331384748 |  | gma500: initial medfield merge  We need to merge this ahead of some of the cleanup because a lot of needed cleanup spans both new and old chips. If we try and clean up and the merge we end up fighting ourselves.  Signed-off-by: Kirill A. Shutemov <kirill.shutemov@linux.intel.com> [With a load of the cleanup stuff folded in, register stuff reworked sanely] Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | psb_intel_display.c | s | 39K | 1238 | Patrik Jakobsson | patrik.r.jakobsson@gmail.com | 1337678134 |  | gma500: handle poulsbo cursor restriction  Poulsbo needs a physical address in the cursor base register. We allocate a stolen memory buffer and copy the cursor image provided by userspace into it. When/If we get our own userspace driver we can map this stolen memory directly. The patch also adds a mark in chip ops so we can identify devices that has this requirement.  Signed-off-by: Patrik Jakobsson <patrik.r.jakobsson@gmail.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | mdfld_dsi_output.h | s | 11K | 303 | Marcos Paulo de Souza | marcos.souza.org@gmail.com | 1334842682 |  | drivers: gpu: drm: gma500: mdfld_dsi_output.h: Remove not unneeded include of version.h  The output of "make versioncheck" points a incorrect include of version.h in the drivers/gpu/drm/gma500/mdfld_dsi_output.h:  drivers/gpu/drm/gma500/mdfld_dsi_output.h: 32 linux/version.h not needed.  If we take a look in the file, we can agree to remove it.  Cc: David Airlie <airlied@linux.ie> Cc: <dri-devel@lists.freedesktop.org> Signed-off-by: Marcos Paulo de Souza <marcos.souza.org@gmail.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | psb_intel_display.h | s | 1.0K | 25 | Alan Cox | alan@linux.intel.com | 1321442815 |  | gma500: Add Poulsbo support  This provides the specific code for Poulsbo, some of which is also used for the later chipsets. We support the GTT, the 2D engine (for console), and the display setup/management. We do not support 3D or the video overlays.  In theory enough public info is available to do the video overlay work but that represents a large task.  Framebuffer X will run nicely with this but do *NOT* use the VESA X server at the same time as KMS. With a Dell mini 10 things like Xfce4 are nice and usable even when compositing as the CPU has a good path to the memory.  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | mid_bios.h | s | 939B | 19 | Alan Cox | alan@linux.intel.com | 1321442728 |  | gma500: Add the glue to the various BIOS and firmware interfaces  Some of this should one day become a library shared by i915 and gma500 I suspct. Best however to deal with that later once it is all nice and stably merged.  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | mdfld_dsi_dpi.c | s | 31K | 858 | Kirill A. Shutemov | kirill.shutemov@linux.intel.com | 1336058809 |  | gma500: mdfld_dsi_dpi_mode_set() do not corrupt DSPSTRIDE  The proper stride value set in mdfld__intel_pipe_set_base().  TODO: move tc35876x support to separate driver and get rid of all if (mdfld_get_panel_type(dev, pipe) == TC35876X) { ... }  Signed-off-by: Kirill A. Shutemov <kirill.shutemov@linux.intel.com> Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | opregion.c | s | 9.7K | 283 | Dan Carpenter | dan.carpenter@oracle.com | 1337249723 |  | gma500: silence an unused variable warning  If CONFIG_BACKLIGHT_CLASS_DEVICE is disabled then GCC warns that: 	drivers/gpu/drm/gma500/opregion.c:154:6: warning: 		unused variable ‘max’ [-Wunused-variable]  Which give me a chance to use the new config_enabled() macro.  :)  Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com> Acked-by: Paul Menzel <paulepanter@users.sourceforge.net> Acked-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | intel_i2c.c | s | 4.3K | 145 | Dave Airlie | airlied@redhat.com | 1321445644 |  | gma500: fixup build versus latest header changes.  Signed-off-by: Dave Airlie <airlied@redhat.com>
