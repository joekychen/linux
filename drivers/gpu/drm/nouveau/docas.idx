f | nv04_software.c | s | 3.7K | 123 | Ben Skeggs | bskeggs@redhat.com | 1337842553 |  | drm/nouveau/fence: convert to exec engine, and improve channel sync  Now have a somewhat simpler semaphore sync implementation for nv17:nv84, and a switched to using semaphores as fences on nv84+ and making use of the hardware's >= acquire operation.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_bios.c | s | 175K | 5531 | Ben Skeggs | bskeggs@redhat.com | 1337842556 |  | drm/nouveau/bios: fix some shadowing issues, particularly acpi  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_gpio.c | s | 9.6K | 346 | Marcin Kościelnicki | koriakin@0x04.net | 1337842597 |  | drm/nouveau/nvd9: Fix GPIO initialisation sequence.  Signed-off-by: Marcin Kościelnicki <koriakin@0x04.net> Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv04_display.c | s | 7.1K | 226 | Ben Skeggs | bskeggs@redhat.com | 1337841121 |  | drm/nv04/disp: disable vblank interrupts when disabling display  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | Makefile | g | 2.3K |  | Ben Skeggs | bskeggs@redhat.com | 1337842571 |  | drm/nouveau/fifo: turn all fifo modules into engine modules  Been tested on each major revision that's relevant here, but I'm sure there are still bugs waiting to be ironed out.  This is a *very* invasive change.  There's a couple of pieces left that I don't like much (eg. other engines using fifo_priv for the channel count), but that's an artefact of there being a master channel list still.  This is changing, slowly.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv50_evo.c | s | 10K | 350 | Dave Airlie | airlied@redhat.com | 1337766415 |  | nouveau: add PRIME support  This adds prime->fd and fd->prime support to nouveau, it passes the SG object to TTM, and then populates the GART entries using it.  v2: add stubbed kmap + use new function to fill out pages array for faulting + add reimport test.  Reviewed-by: Alex Deucher <alexander.deucher@amd.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | nouveau_backlight.c | s | 6.6K | 217 | Ben Skeggs | bskeggs@redhat.com | 1316499006 |  | drm/nva3/backlight: add suppport for newer style backlight regs  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nve0_graph.h | s | 2.5K | 75 | Ben Skeggs | bskeggs@redhat.com | 1337841101 |  | drm/nve0/gr: initial implementation  This may, perhaps, get re-merged with nvc0_graph.c at some point.  It's still unclear as to how great an idea that'd be.  Stay tuned...  Completely dependent on firmware blobs from NVIDIA binary driver currently.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv04_crtc.c | s | 34K | 908 | Dave Airlie | airlied@redhat.com | 1337766415 |  | nouveau: add PRIME support  This adds prime->fd and fd->prime support to nouveau, it passes the SG object to TTM, and then populates the GART entries using it.  v2: add stubbed kmap + use new function to fill out pages array for faulting + add reimport test.  Reviewed-by: Alex Deucher <alexander.deucher@amd.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | nva3_copy.fuc | s | 20K | 808 | Ben Skeggs | bskeggs@redhat.com | 1324458090 |  | drm/nva3/copy: fix typo in fuc which caused host to not recieve exceptions  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nva3_copy.fuc.h | s | 6.8K | 533 | Ben Skeggs | bskeggs@redhat.com | 1324458090 |  | drm/nva3/copy: fix typo in fuc which caused host to not recieve exceptions  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv50_mc.c | s | 1.4K | 37 | Ben Skeggs | bskeggs@redhat.com | 1260530974 |  | drm/nouveau: Add DRM driver for NVIDIA GPUs  This adds a drm/kms staging non-API stable driver for GPUs from NVIDIA.  This driver is a KMS-based driver and requires a compatible nouveau userspace libdrm and nouveau X.org driver.  This driver requires firmware files not available in this kernel tree, interested parties can find them via the nouveau project git archive.  This driver is reverse engineered, and is in no way supported by nVidia.  Support for nearly the complete range of nvidia hw from nv04->g80 (nv50) is available, and the kms driver should support driving nearly all output types (displayport is under development still) along with supporting suspend/resume.  This work is all from the upstream nouveau project found at nouveau.freedesktop.org.  The original authors list from nouveau git tree is: Anssi Hannula <anssi.hannula@iki.fi> Ben Skeggs <bskeggs@redhat.com> Francisco Jerez <currojerez@riseup.net> Maarten Maathuis <madman2003@gmail.com> Marcin Kościelnicki <koriakin@0x04.net> Matthew Garrett <mjg@redhat.com> Matt Parnell <mparnell@gmail.com> Patrice Mandin <patmandin@gmail.com> Pekka Paalanen <pq@iki.fi> Xavier Chantry <shiningxc@gmail.com> along with project founder Stephane Marchesin <marchesin@icps.u-strasbg.fr>  Signed-off-by: Ben Skeggs <bskeggs@redhat.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | nv50_dac.c | s | 8.8K | 257 | Ben Skeggs | bskeggs@redhat.com | 1337841109 |  | drm/nouveau: use the same packet header macros as userspace  Cosmetic cleanup only.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv50_instmem.c | s | 10K | 352 | Marcin Slusarz | marcin.slusarz@gmail.com | 1337841112 |  | drm/nv50: fix ramin heap size for kernel channel too  Port change from "drm/nouveau: Keep RAMIN heap within the channel" to kernel channel, which has its own ramin heap initialisation.  Signed-off-by: Marcin Slusarz <marcin.slusarz@gmail.com> Cc: Younes Manton <younes.m@gmail.com> Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv04_fbcon.c | s | 7.3K | 239 | Ben Skeggs | bskeggs@redhat.com | 1337841109 |  | drm/nouveau: use the same packet header macros as userspace  Cosmetic cleanup only.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nvc0_vm.c | s | 3.8K | 118 | Ben Skeggs | bskeggs@redhat.com | 1331622846 |  | drm/nv50-nvc0/vm: support unsnooped system memory  v2 (Emil Velikov <emil.l.velikov@gmail.com>): - Fixed a regression on certain nv50 IGP due to not passing the correct   target type to nv50_vm_addr()  Signed-off-by: Ben Skeggs <bskeggs@redhat.com> Signed-off-by: Emil Velikov <emil.l.velikov@gmail.com> Tested-by: Johannes Obermayr <johannesobermayr@gmx.de>
f | nouveau_software.h | s | 1.5K | 59 | Ben Skeggs | bskeggs@redhat.com | 1337842543 |  | drm/nouveau: move flip-related channel setup to software engine  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_acpi.c | s | 11K | 356 | Andreas Heider | andreas@meetr.de | 1337842594 |  | drm/nouveau: Check dsm on switcheroo unregister  Currently vga_switcheroo_unregister_handler is called unconditionally when nouveau is unloaded, even when nouveau never registered a handler. This interferes with other switcheroo handlers, as vga_switcheroo doesn't check who called unregister_handler, but simply unregisters the current handler. This patch adds a check so unregister is only called if a handler was registered by nouveau before.  Signed-off-by: Andreas Heider <andreas@meetr.de> Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv50_vram.c | s | 6.5K | 201 | Ben Skeggs | bskeggs@redhat.com | 1331622531 |  | drm/nv50: fix detection of second vram rank  Goes a long way to correcting NVS295 memory reclocking issues.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com> Signed-off-by: Martin Peres <martin.peres@labri.fr>
f | nouveau_hdmi.c | s | 7.7K | 225 | Ben Skeggs | bskeggs@redhat.com | 1335765339 |  | drm/nouveau/hdmi: use correct hdmi regs for nvaa/nvac  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nvc0_software.c | s | 4.2K | 130 | Ben Skeggs | bskeggs@redhat.com | 1337842543 |  | drm/nouveau: move flip-related channel setup to software engine  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_connector.c | s | 31K | 950 | Ben Skeggs | bskeggs@redhat.com | 1337842586 |  | drm/nouveau/disp: fix dithering not being enabled on some eDP macbooks  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_temp.c | s | 7.9K | 275 | Ben Skeggs | bskeggs@redhat.com | 1324458100 |  | drm/nouveau/i2c: do parsing of i2c-related vbios info in nouveau_i2c.c  Not much point parsing the vbios data into a struct which is only used once to parse the data into another struct, go directly from vbios to nouveau_i2c_chan.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_hw.h | s | 14K | 403 | Francisco Jerez | currojerez@riseup.net | 1290055118 |  | drm/nv04: Fix scanout over the 16MB mark.  Signed-off-by: Francisco Jerez <currojerez@riseup.net> Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nvc0_vram.c | s | 4.9K | 140 | Ben Skeggs | bskeggs@redhat.com | 1331622900 |  | drm/nvc0/vram: get part count from PUNITS  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv04_fb.c | s | 1.2K | 48 | Ben Skeggs | bskeggs@redhat.com | 1331622323 |  | drm/nouveau: memory type detection for the really old chipsets  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv50_cursor.c | s | 4.1K | 121 | Ben Skeggs | bskeggs@redhat.com | 1337841109 |  | drm/nouveau: use the same packet header macros as userspace  Cosmetic cleanup only.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_calc.c | s | 13K | 408 | Ben Skeggs | bskeggs@redhat.com | 1285309609 |  | drm/nouveau: make the behaviour of get_pll_limits() consistent  This replaces all the pll_types definitions for ones that match the types used in the tables in recent VBIOS versions.  get_pll_limits() will now accept either type or register value as input across all limits table versions, and will store the actual register ID that a PLL type refers to in the returned structure.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv04_fence.c | s | 3.7K | 124 | Ben Skeggs | bskeggs@redhat.com | 1337842558 |  | drm/nouveau/fence: fix a race where fence->channel can disappear  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv04_fifo.c | s | 14K | 428 | Ben Skeggs | bskeggs@redhat.com | 1337842571 |  | drm/nouveau/fifo: turn all fifo modules into engine modules  Been tested on each major revision that's relevant here, but I'm sure there are still bugs waiting to be ironed out.  This is a *very* invasive change.  There's a couple of pieces left that I don't like much (eg. other engines using fifo_priv for the channel count), but that's an artefact of there being a master channel list still.  This is changing, slowly.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_reg.h | s | 56K | 815 | Ben Skeggs | bskeggs@redhat.com | 1316499006 |  | drm/nva3/backlight: add suppport for newer style backlight regs  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_util.h | s | 1.6K | 43 | Ben Skeggs | bskeggs@redhat.com | 1300084310 |  | drm/nouveau: add nouveau_enum_find() util function  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_fence.c | s | 5.2K | 183 | Ben Skeggs | bskeggs@redhat.com | 1337842558 |  | drm/nouveau/fence: fix a race where fence->channel can disappear  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv04_timer.c | s | 1.6K | 70 | Ben Skeggs | bskeggs@redhat.com | 1324458085 |  | drm/nouveau/pm: remove the older interfaces completely  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_ramht.c | s | 8.1K | 263 | Ben Skeggs | bskeggs@redhat.com | 1298580288 |  | drm/nv50-nvc0: fix ramht entries for multiple evo channels  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv98_ppp.c | s | 2.1K | 66 | Ben Skeggs | bskeggs@redhat.com | 1324458070 |  | drm/nouveau/vdec: implement stub modules for the known engines  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_prime.c | s | 5.9K | 195 | Dave Airlie | airlied@redhat.com | 1340785655 |  | drm/nouveau: add license header to prime.  Just forgot this when I posted it, and yes I'm the only person to have changed the file since.  Signed-off-by: Dave Airlie <airlied@redhat.com>
f | nv04_instmem.c | s | 4.4K | 159 | Ben Skeggs | bskeggs@redhat.com | 1337842571 |  | drm/nouveau/fifo: turn all fifo modules into engine modules  Been tested on each major revision that's relevant here, but I'm sure there are still bugs waiting to be ironed out.  This is a *very* invasive change.  There's a couple of pieces left that I don't like much (eg. other engines using fifo_priv for the channel count), but that's an artefact of there being a master channel list still.  This is changing, slowly.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nvc0_graph.fuc | s | 8.6K | 372 | Ben Skeggs | bskeggs@redhat.com | 1324458086 |  | drm/nvc0/gr: update fuc source to assemble with latest envyas  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nvc0_fbcon.c | s | 7.3K | 244 | Ben Skeggs | bskeggs@redhat.com | 1337841109 |  | drm/nouveau: use the same packet header macros as userspace  Cosmetic cleanup only.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv40_pm.c | s | 9.7K | 344 | Ben Skeggs | bskeggs@redhat.com | 1337842571 |  | drm/nouveau/fifo: turn all fifo modules into engine modules  Been tested on each major revision that's relevant here, but I'm sure there are still bugs waiting to be ironed out.  This is a *very* invasive change.  There's a couple of pieces left that I don't like much (eg. other engines using fifo_priv for the channel count), but that's an artefact of there being a master channel list still.  This is changing, slowly.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nvreg.h | s | 21K | 463 | Francisco Jerez | currojerez@riseup.net | 1307402549 |  | drm/nv17-nv40: Fix modesetting failure when pitch == 4096px (fdo bug 35901).  Reported-by: Mario Bachmann <grafgrimm77@gmx.de> Tested-by: Greg Turner <gmturner007@ameritech.net> Signed-off-by: Francisco Jerez <currojerez@riseup.net> Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv40_mc.c | s | 553B | 24 | Ben Skeggs | bskeggs@redhat.com | 1295227723 |  | drm/nv40: initialise 0x17xx on all chipsets that have it  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_util.c | s | 2.0K | 67 | Ben Skeggs | bskeggs@redhat.com | 1300084310 |  | drm/nouveau: add nouveau_enum_find() util function  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nvc0_pm.c | s | 14K | 513 | Ben Skeggs | bskeggs@redhat.com | 1337841094 |  | drm/nvc0/pm: very initial mclk freq change  Loads of magic missing, this will probably blow up if you try it.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_debugfs.c | s | 6.0K | 167 | Ben Skeggs | bskeggs@redhat.com | 1337842553 |  | drm/nouveau/fence: convert to exec engine, and improve channel sync  Now have a somewhat simpler semaphore sync implementation for nv17:nv84, and a switched to using semaphores as fences on nv84+ and making use of the hardware's >= acquire operation.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv17_tv.h | s | 4.1K | 136 | Chris Wilson | chris@chris-wilson.co.uk | 1298423591 |  | drm: Mark constant arrays of drm_display_mode const  ... and fixup some methods to accept the constant argument.  Now that constant module arrays are loaded into read-only memory, using const appropriately has some benefits beyond warning the programmer about likely mistakes.  Signed-off-by: Chris Wilson <chris@chris-wilson.co.uk> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | nv40_grctx.c | s | 19K | 646 | Ben Skeggs | bskeggs@redhat.com | 1337841118 |  | drm/nv40-50/gr: restructure grctx/prog generation  The conditional definition of the generation helper functions apparently confuses some IDEs....  Reported-by: Marcin Slusarz <marcin.slusarz@gmail.com> Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv50_sor.c | s | 13K | 434 | Ben Skeggs | bskeggs@redhat.com | 1337841109 |  | drm/nouveau: use the same packet header macros as userspace  Cosmetic cleanup only.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nvc0_grctx.c | s | 107K | 2815 | Ben Skeggs | bskeggs@redhat.com | 1324458087 |  | drm/nvc0/gr: add initial support for nvd9, not quite there yet..  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv04_pm.c | s | 3.2K | 112 | Ben Skeggs | bskeggs@redhat.com | 1324458084 |  | drm/nv04-nv30/pm: port to newer interfaces  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv84_fifo.c | s | 7.1K | 204 | Ben Skeggs | bskeggs@redhat.com | 1337842571 |  | drm/nouveau/fifo: turn all fifo modules into engine modules  Been tested on each major revision that's relevant here, but I'm sure there are still bugs waiting to be ironed out.  This is a *very* invasive change.  There's a couple of pieces left that I don't like much (eg. other engines using fifo_priv for the channel count), but that's an artefact of there being a master channel list still.  This is changing, slowly.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nva3_pm.c | s | 15K | 525 | Ben Skeggs | bskeggs@redhat.com | 1337841096 |  | drm/nouveau/pm: some more delays for ddr3 reclocking  These numbers from the binary driver's daemon scripts, and fix the transition to perflvl 3 on my T510.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv50_fbcon.c | s | 7.0K | 239 | Ben Skeggs | bskeggs@redhat.com | 1337842576 |  | drm/nouveau/ttm: untangle code to support accelerated buffer moves  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv04_dac.c | s | 17K | 444 | Ben Skeggs | bskeggs@redhat.com | 1324458105 |  | drm/nouveau/gpio: reimplement as nouveau_gpio.c, fixing a number of issues  - moves out of nouveau_bios.c and demagics the logical state definitions - simplifies chipset-specific driver interface - makes most of gpio irq handling common, will use for nv4x hpd later - api extended to allow both direct gpio access, and access using the   logical function states - api extended to allow for future use of gpio extender chips - pre-nv50 was handled very badly, the main issue being that all GPIOs   were being treated as output-only. - fixes nvd0 so gpio changes actually stick, magic reg needs bashing  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv50_calc.c | s | 2.6K | 84 | Ben Skeggs | bskeggs@redhat.com | 1305507059 |  | drm/nva3/clk: better pll calculation when no fractional fb div available  The core/mem/shader clocks don't support the fractional feedback divider, causing our calculated clocks to be off by quite a lot in some cases.  To solve this we will switch to a search-based algorithm when fN is NULL.  For my NVA8 at PL3, this actually generates identical cooefficients to the binary driver.  Hopefully that's a good sign, and that does not break VPLL calculation for someone..  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_grctx.h | s | 2.9K | 104 | Ben Skeggs | bskeggs@redhat.com | 1337841118 |  | drm/nv40-50/gr: restructure grctx/prog generation  The conditional definition of the generation helper functions apparently confuses some IDEs....  Reported-by: Marcin Slusarz <marcin.slusarz@gmail.com> Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv17_tv.c | s | 23K | 673 | Ben Skeggs | bskeggs@redhat.com | 1324458105 |  | drm/nouveau/gpio: reimplement as nouveau_gpio.c, fixing a number of issues  - moves out of nouveau_bios.c and demagics the logical state definitions - simplifies chipset-specific driver interface - makes most of gpio irq handling common, will use for nv4x hpd later - api extended to allow both direct gpio access, and access using the   logical function states - api extended to allow for future use of gpio extender chips - pre-nv50 was handled very badly, the main issue being that all GPIOs   were being treated as output-only. - fixes nvd0 so gpio changes actually stick, magic reg needs bashing  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv30_fb.c | s | 3.2K | 97 | Francisco Jerez | currojerez@riseup.net | 1291353080 |  | drm/nouveau: Rework tile region handling.  The point is to share more code between the PFB/PGRAPH tile region hooks, and give the hardware specific functions a chance to allocate per-region resources.  Signed-off-by: Francisco Jerez <currojerez@riseup.net> Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_gpio.h | s | 2.6K | 64 | Ben Skeggs | bskeggs@redhat.com | 1324458105 |  | drm/nouveau/gpio: reimplement as nouveau_gpio.c, fixing a number of issues  - moves out of nouveau_bios.c and demagics the logical state definitions - simplifies chipset-specific driver interface - makes most of gpio irq handling common, will use for nv4x hpd later - api extended to allow both direct gpio access, and access using the   logical function states - api extended to allow for future use of gpio extender chips - pre-nv50 was handled very badly, the main issue being that all GPIOs   were being treated as output-only. - fixes nvd0 so gpio changes actually stick, magic reg needs bashing  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nve0_graph.c | s | 22K | 705 | Ben Skeggs | bskeggs@redhat.com | 1337842576 |  | drm/nouveau/ttm: untangle code to support accelerated buffer moves  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv50_display.c | s | 27K | 880 | Ben Skeggs | bskeggs@redhat.com | 1337842543 |  | drm/nouveau: move flip-related channel setup to software engine  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_perf.c | s | 10K | 364 | Ben Skeggs | bskeggs@redhat.com | 1337841076 |  | drm/nva3/pm: initial attempt at more magic PFB regs  The reg calculation may get moved elsewhere at some point, but lets figure out what exactly we need to do first.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_irq.c | s | 3.9K | 127 | Ben Skeggs | bskeggs@redhat.com | 1311550929 |  | drm/nouveau: detect disabled device in irq handler and return IRQ_NONE  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv50_crtc.c | s | 21K | 678 | Ben Skeggs | bskeggs@redhat.com | 1337841116 |  | drm/nv50/disp: fixup error paths in crtc object creation  Reported-by: Marcin Slusarz <marcin.slusarz@gmail.com> Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nvc0_graph.c | s | 24K | 771 | Ben Skeggs | bskeggs@redhat.com | 1337842571 |  | drm/nouveau/fifo: turn all fifo modules into engine modules  Been tested on each major revision that's relevant here, but I'm sure there are still bugs waiting to be ironed out.  This is a *very* invasive change.  There's a couple of pieces left that I don't like much (eg. other engines using fifo_priv for the channel count), but that's an artefact of there being a master channel list still.  This is changing, slowly.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_mm.h | s | 2.3K | 57 | Ben Skeggs | bskeggs@redhat.com | 1316498640 |  | drm/nouveau: allow a nouveau_mm to be created with holes  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv04_mc.c | s | 435B | 19 | Francisco Jerez | currojerez@riseup.net | 1278980038 |  | drm/nouveau: Disable PROM access on init.  On older cards (<nv17) scanout gets blocked when the ROM is being accessed. PROM access usually comes out enabled from suspend, switch it off.  Signed-off-by: Francisco Jerez <currojerez@riseup.net> Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_state.c | s | 38K | 1250 | Andreas Heider | andreas@meetr.de | 1337842596 |  | drm/nouveau: Unregister switcheroo client on exit  Currently nouveau only registers as a vga_switcheroo client, but never unregisters. This patch adds the necessary unregister calls.  Signed-off-by: Andreas Heider <andreas@meetr.de> Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_dma.h | s | 5.9K | 167 | Ben Skeggs | bskeggs@redhat.com | 1337842576 |  | drm/nouveau/ttm: untangle code to support accelerated buffer moves  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv50_display.h | s | 3.0K | 82 | Ben Skeggs | bskeggs@redhat.com | 1337842541 |  | drm/nouveau: create real execution engine for software object class  Just a cleanup more or less, and to remove the need for special handling of software objects.  This removes a heap of documentation on dma/graph object formats.  The info is very out of date with our current understanding, and is far better documented in rnndb in envytools git.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv17_fifo.c | s | 5.6K | 153 | Ben Skeggs | bskeggs@redhat.com | 1337842571 |  | drm/nouveau/fifo: turn all fifo modules into engine modules  Been tested on each major revision that's relevant here, but I'm sure there are still bugs waiting to be ironed out.  This is a *very* invasive change.  There's a couple of pieces left that I don't like much (eg. other engines using fifo_priv for the channel count), but that's an artefact of there being a master channel list still.  This is changing, slowly.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_sgdma.c | s | 11K | 379 | Ben Skeggs | bskeggs@redhat.com | 1337841098 |  | drm/nouveau: give a slightly larger pci(e)gart aperture on all chipsets  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_volt.c | s | 6.1K | 212 | Ben Skeggs | bskeggs@redhat.com | 1324458105 |  | drm/nouveau/gpio: reimplement as nouveau_gpio.c, fixing a number of issues  - moves out of nouveau_bios.c and demagics the logical state definitions - simplifies chipset-specific driver interface - makes most of gpio irq handling common, will use for nv4x hpd later - api extended to allow both direct gpio access, and access using the   logical function states - api extended to allow for future use of gpio extender chips - pre-nv50 was handled very badly, the main issue being that all GPIOs   were being treated as output-only. - fixes nvd0 so gpio changes actually stick, magic reg needs bashing  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv40_fb.c | s | 4.5K | 143 | Ben Skeggs | bskeggs@redhat.com | 1331622335 |  | drm/nv20-nv40: add memory type detection  NV20/NV30 is partially educated guesswork at this point, based on any information around about available memory types and a horribly unspeakable amount of vbios image scouring.  I'm not entirely certain the GDDR3 define is correct, I have not spotted a single vbios with that value yet (though it is mentioned in some 1218-using nv4x vbios), but there are reports that some nv3x did use it..  NV40(100914) confirmed by switching an NV49 to DDR1/DDR2 values and making sure that the binary driver behaviour showed it had detected DDR1/DDR2 instead of GDDR3 before dying horribly.  NV40(100474) confirmed by doing much the same task as above on an NV44, except this was *much* easier as changing the values didn't seem to have any noticable effect on the memory controller aside from changing the binary driver's behaviour.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv17_tv_modes.c | s | 21K | 530 | Chris Wilson | chris@chris-wilson.co.uk | 1298423591 |  | drm: Mark constant arrays of drm_display_mode const  ... and fixup some methods to accept the constant argument.  Now that constant module arrays are loaded into read-only memory, using const appropriately has some benefits beyond warning the programmer about likely mistakes.  Signed-off-by: Chris Wilson <chris@chris-wilson.co.uk> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | nv84_fence.c | s | 4.9K | 155 | Ben Skeggs | bskeggs@redhat.com | 1337842571 |  | drm/nouveau/fifo: turn all fifo modules into engine modules  Been tested on each major revision that's relevant here, but I'm sure there are still bugs waiting to be ironed out.  This is a *very* invasive change.  There's a couple of pieces left that I don't like much (eg. other engines using fifo_priv for the channel count), but that's an artefact of there being a master channel list still.  This is changing, slowly.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_display.c | s | 16K | 530 | Ben Skeggs | bskeggs@redhat.com | 1337842553 |  | drm/nouveau/fence: convert to exec engine, and improve channel sync  Now have a somewhat simpler semaphore sync implementation for nv17:nv84, and a switched to using semaphores as fences on nv84+ and making use of the hardware's >= acquire operation.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_dma.c | s | 7.6K | 243 | Ben Skeggs | bskeggs@redhat.com | 1332400666 |  | drm/nouveau: remove m2mf creation on userspace channels  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_hwsq.h | s | 2.6K | 102 | Ben Skeggs | bskeggs@redhat.com | 1324458104 |  | drm/nouveau/hwsq: remove some magic, give proper opcode names  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv50_graph.c | s | 24K | 767 | Marcin Slusarz | marcin.slusarz@gmail.com | 1337842587 |  | drm/nv50: decode PGRAPH DATA_ERROR = 0x24  Signed-off-by: Marcin Slusarz <marcin.slusarz@gmail.com> Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nvc0_fence.c | s | 5.1K | 158 | Ben Skeggs | bskeggs@redhat.com | 1337842571 |  | drm/nouveau/fifo: turn all fifo modules into engine modules  Been tested on each major revision that's relevant here, but I'm sure there are still bugs waiting to be ironed out.  This is a *very* invasive change.  There's a couple of pieces left that I don't like much (eg. other engines using fifo_priv for the channel count), but that's an artefact of there being a master channel list still.  This is changing, slowly.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv04_dfp.c | s | 23K | 613 | Ben Skeggs | bskeggs@redhat.com | 1324458103 |  | drm/nv04/disp: handle dual-link spwg panels without needing quirks  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nvc0_grhub.fuc | g | 19K |  | Ben Skeggs | bskeggs@redhat.com | 1324458087 |  | drm/nvc0/gr: add initial support for nvd9, not quite there yet..  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_i2c.c | s | 9.5K | 350 | Ben Skeggs | bskeggs@redhat.com | 1336384958 |  | drm/nouveau/i2c: resume use of i2c-algo-bit, rather than custom stack  Previous issues with i2c-algo-bit have now been resolved.  This is a revert of f553b79c03f0dbd52f6f03abe8233a2bef8cbd0d mostly, due to fixes in the i2c core repairing the original issue, this code isn't required and was causing regressions.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com> Reported-by: Nick Bowler <nbowler@elliptictech.com> Tested-by: Nick Bowler <nbowler@elliptictech.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | nv50_vm.c | s | 4.6K | 155 | Ben Skeggs | bskeggs@redhat.com | 1337842571 |  | drm/nouveau/fifo: turn all fifo modules into engine modules  Been tested on each major revision that's relevant here, but I'm sure there are still bugs waiting to be ironed out.  This is a *very* invasive change.  There's a couple of pieces left that I don't like much (eg. other engines using fifo_priv for the channel count), but that's an artefact of there being a master channel list still.  This is changing, slowly.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_connector.h | s | 2.5K | 76 | Ben Skeggs | bskeggs@redhat.com | 1324458101 |  | drm/nouveau/disp: parse connector info directly in nouveau_connector.c  Another case where we parsed vbios data to some structs, then again use that info once to construct another set of data.  Skip the intermediate step.  This is also slightly improved in that we can now use DCB 3.x connector table info, which will allow NV4x to gain hotplug support, and to make quirks for SPWG LVDS panels unnecessary.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_ttm.c | s | 3.3K | 87 | Dave Airlie | airlied@redhat.com | 1280879166 |  | drm: move ttm global code to core drm  I wrote this for the prime sharing work, but I also noticed other external non-upstream drivers from a large company carrying a similiar patch, so I may as well ship it in master.  Signed-off-by: Dave Airlie <airlied@redhat.com>
f | nouveau_fbcon.c | s | 13K | 448 | Ben Skeggs | bskeggs@redhat.com | 1340709403 |  | drm/nouveau/fbcon: using nv_two_heads is not a good idea  nv_two_heads() was never meant to be used outside of pre-nv50 code.  The code checks for >= NV_10 for 2 CRTCs, then downgrades a few specific chipsets to 1 CRTC based on (pci_device & 0x0ff0).  The breakage example seen is on GTX 560Ti, with a pciid of 0x1200, which gets detected as an NV20 (0x020x) with 1 CRTC by nv_two_heads(), causing memory corruption because there's actually 2 CRTCs..  This switches fbcon to use the CRTC count directly from the mode_config structure, which will also fix the same issue on Kepler boards which have 4 CRTCs.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com> Cc: stable@vger.kernel.org Signed-off-by: Dave Airlie <airlied@redhat.com>
f | nv10_fence.c | s | 5.3K | 184 | Ben Skeggs | bskeggs@redhat.com | 1337842558 |  | drm/nouveau/fence: fix a race where fence->channel can disappear  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv10_gpio.c | s | 3.1K | 110 | Ben Skeggs | bskeggs@redhat.com | 1335765354 |  | drm/nv10/gpio: fix thinko in mask for gpio lines 2-9  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_fbcon.h | s | 2.8K | 58 | Ben Skeggs | bskeggs@redhat.com | 1292915919 |  | drm/nvc0: implement fbcon acceleration  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_gem.c | s | 21K | 737 | Ben Skeggs | bskeggs@redhat.com | 1337842553 |  | drm/nouveau/fence: convert to exec engine, and improve channel sync  Now have a somewhat simpler semaphore sync implementation for nv17:nv84, and a switched to using semaphores as fences on nv84+ and making use of the hardware's >= acquire operation.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv50_fifo.c | s | 8.3K | 247 | Ben Skeggs | bskeggs@redhat.com | 1337842571 |  | drm/nouveau/fifo: turn all fifo modules into engine modules  Been tested on each major revision that's relevant here, but I'm sure there are still bugs waiting to be ironed out.  This is a *very* invasive change.  There's a couple of pieces left that I don't like much (eg. other engines using fifo_priv for the channel count), but that's an artefact of there being a master channel list still.  This is changing, slowly.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_mem.c | s | 30K | 1058 | Ben Skeggs | bskeggs@redhat.com | 1337842571 |  | drm/nouveau/fifo: turn all fifo modules into engine modules  Been tested on each major revision that's relevant here, but I'm sure there are still bugs waiting to be ironed out.  This is a *very* invasive change.  There's a couple of pieces left that I don't like much (eg. other engines using fifo_priv for the channel count), but that's an artefact of there being a master channel list still.  This is changing, slowly.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv50_pm.c | s | 21K | 785 | Martin Peres | martin.peres@labri.fr | 1331622903 |  | drm/nv50/hwsq: some nv92 fixes  The shift from hwsq_data = 0x1400 to 0x080000 actually happened in nv94, not nv92 This fixes some reclocking issues on my newly acquired nv92  Signed-off-by: Martin Peres <martin.peres@labri.fr> Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_pm.h | s | 4.5K | 95 | Ben Skeggs | bskeggs@redhat.com | 1337841076 |  | drm/nva3/pm: initial attempt at more magic PFB regs  The reg calculation may get moved elsewhere at some point, but lets figure out what exactly we need to do first.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv10_fifo.c | s | 4.3K | 123 | Ben Skeggs | bskeggs@redhat.com | 1337842571 |  | drm/nouveau/fifo: turn all fifo modules into engine modules  Been tested on each major revision that's relevant here, but I'm sure there are still bugs waiting to be ironed out.  This is a *very* invasive change.  There's a couple of pieces left that I don't like much (eg. other engines using fifo_priv for the channel count), but that's an artefact of there being a master channel list still.  This is changing, slowly.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_hw.c | s | 33K | 892 | Ben Skeggs | bskeggs@redhat.com | 1337841121 |  | drm/nv04/disp: disable vblank interrupts when disabling display  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv98_crypt.fuc | s | 12K | 604 | Ben Skeggs | bskeggs@redhat.com | 1337842573 |  | drm/nv98/crypt: non-stub implementation of the engine hooks  fuc is from pscnv driver.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_drv.c | s | 13K | 404 | Ben Skeggs | bskeggs@redhat.com | 1337842571 |  | drm/nouveau/fifo: turn all fifo modules into engine modules  Been tested on each major revision that's relevant here, but I'm sure there are still bugs waiting to be ironed out.  This is a *very* invasive change.  There's a couple of pieces left that I don't like much (eg. other engines using fifo_priv for the channel count), but that's an artefact of there being a master channel list still.  This is changing, slowly.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_vm.h | s | 4.2K | 104 | Dave Airlie | airlied@redhat.com | 1337766415 |  | nouveau: add PRIME support  This adds prime->fd and fd->prime support to nouveau, it passes the SG object to TTM, and then populates the GART entries using it.  v2: add stubbed kmap + use new function to fill out pages array for faulting + add reimport test.  Reviewed-by: Alex Deucher <alexander.deucher@amd.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | nv31_mpeg.c | s | 9.4K | 290 | Ben Skeggs | bskeggs@redhat.com | 1337842571 |  | drm/nouveau/fifo: turn all fifo modules into engine modules  Been tested on each major revision that's relevant here, but I'm sure there are still bugs waiting to be ironed out.  This is a *very* invasive change.  There's a couple of pieces left that I don't like much (eg. other engines using fifo_priv for the channel count), but that's an artefact of there being a master channel list still.  This is changing, slowly.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv50_evo.h | s | 7.9K | 114 | Christoph Bumiller | e0425955@student.tuwien.ac.at | 1331622896 |  | drm/nv50/display: expose color vibrance control  Signed-off-by: Christoph Bumiller <e0425955@student.tuwien.ac.at> Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nve0_fifo.c | s | 11K | 355 | Ben Skeggs | bskeggs@redhat.com | 1337842571 |  | drm/nouveau/fifo: turn all fifo modules into engine modules  Been tested on each major revision that's relevant here, but I'm sure there are still bugs waiting to be ironed out.  This is a *very* invasive change.  There's a couple of pieces left that I don't like much (eg. other engines using fifo_priv for the channel count), but that's an artefact of there being a master channel list still.  This is changing, slowly.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv04_graph.c | s | 36K | 1196 | Ben Skeggs | bskeggs@redhat.com | 1337842571 |  | drm/nouveau/fifo: turn all fifo modules into engine modules  Been tested on each major revision that's relevant here, but I'm sure there are still bugs waiting to be ironed out.  This is a *very* invasive change.  There's a couple of pieces left that I don't like much (eg. other engines using fifo_priv for the channel count), but that's an artefact of there being a master channel list still.  This is changing, slowly.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nvc0_fifo.c | s | 12K | 407 | Ben Skeggs | bskeggs@redhat.com | 1337842571 |  | drm/nouveau/fifo: turn all fifo modules into engine modules  Been tested on each major revision that's relevant here, but I'm sure there are still bugs waiting to be ironed out.  This is a *very* invasive change.  There's a couple of pieces left that I don't like much (eg. other engines using fifo_priv for the channel count), but that's an artefact of there being a master channel list still.  This is changing, slowly.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nvc0_copy.fuc.h | s | 6.7K | 526 | Ben Skeggs | bskeggs@redhat.com | 1324458090 |  | drm/nva3/copy: fix typo in fuc which caused host to not recieve exceptions  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv50_grctx.c | s | 125K | 3225 | Ben Skeggs | bskeggs@redhat.com | 1337842563 |  | drm/nv50/gr: make sure NEXT_TO_CURRENT is executed even if nothing done  PFIFO channel kickoff will hang sometimes otherwise.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nvc0_copy.c | s | 7.0K | 208 | Ben Skeggs | bskeggs@redhat.com | 1311551002 |  | drm/nouveau: pass flag to engine fini() method on suspend  It may not be necessary to fail in certain cases (such as failing to idle) on module unload, whereas on suspend it's important to ensure a consistent state can be restored on resume.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nvc0_instmem.c | s | 5.8K | 184 | Ben Skeggs | bskeggs@redhat.com | 1308808901 |  | drm/nvc0: enable per-client address spaces  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv84_crypt.c | s | 5.1K | 160 | Ben Skeggs | bskeggs@redhat.com | 1311551002 |  | drm/nouveau: pass flag to engine fini() method on suspend  It may not be necessary to fail in certain cases (such as failing to idle) on module unload, whereas on suspend it's important to ensure a consistent state can be restored on resume.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_object.c | s | 20K | 724 | Ben Skeggs | bskeggs@redhat.com | 1337842589 |  | drm/nouveau: turn a BUG into a WARN  This is very annoying sometimes..  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_dp.c | s | 15K | 512 | Adam Jackson | ajax@redhat.com | 1337678942 |  | drm/nouveau/dp: Probe branch/sink OUIs (v2)  (airlied: v2: fix missing struct - fixes compile)  Signed-off-by: Adam Jackson <ajax@redhat.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | nv50_gpio.c | s | 3.6K | 115 | Ben Skeggs | bskeggs@redhat.com | 1324458105 |  | drm/nouveau/gpio: reimplement as nouveau_gpio.c, fixing a number of issues  - moves out of nouveau_bios.c and demagics the logical state definitions - simplifies chipset-specific driver interface - makes most of gpio irq handling common, will use for nv4x hpd later - api extended to allow both direct gpio access, and access using the   logical function states - api extended to allow for future use of gpio extender chips - pre-nv50 was handled very badly, the main issue being that all GPIOs   were being treated as output-only. - fixes nvd0 so gpio changes actually stick, magic reg needs bashing  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | Kconfig | g | 1.5K |  | Dave Airlie | airlied@redhat.com | 1333359949 |  | drm/nouveau: select POWER_SUPPLY  Ben H. reported that building nouveau into the kernel and power supply as a module was broken.  Just have nouveau select it, like radeon does.  Reported-by: Benjamin Herrenschmidt <benh@kernel.crashing.org> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | nouveau_bios.h | s | 7.0K | 270 | Ben Skeggs | bskeggs@redhat.com | 1332400696 |  | drm/nouveau: add bios connector type for dms59  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv20_fb.c | s | 3.8K | 125 | Ben Skeggs | bskeggs@redhat.com | 1331622335 |  | drm/nv20-nv40: add memory type detection  NV20/NV30 is partially educated guesswork at this point, based on any information around about available memory types and a horribly unspeakable amount of vbios image scouring.  I'm not entirely certain the GDDR3 define is correct, I have not spotted a single vbios with that value yet (though it is mentioned in some 1218-using nv4x vbios), but there are reports that some nv3x did use it..  NV40(100914) confirmed by switching an NV49 to DDR1/DDR2 values and making sure that the binary driver behaviour showed it had detected DDR1/DDR2 instead of GDDR3 before dying horribly.  NV40(100474) confirmed by doing much the same task as above on an NV44, except this was *much* easier as changing the values didn't seem to have any noticable effect on the memory controller aside from changing the binary driver's behaviour.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nvc0_grgpc.fuc | g | 12K |  | Ben Skeggs | bskeggs@redhat.com | 1324458087 |  | drm/nvc0/gr: add initial support for nvd9, not quite there yet..  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv04_cursor.c | s | 2.1K | 62 | Maarten Maathuis | madman2003@gmail.com | 1275026777 |  | drm/nouveau: allow cursor image and position to survive suspend  - This isn't triggered yet on a normal kernel, because it still does a VT switch, but it seemed like a good idea to fix this now.  Tested-by: Maxim Levitsky <maximlevitsky@gmail.com> Signed-off-by: Maarten Maathuis <madman2003@gmail.com> Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv50_mpeg.c | s | 6.1K | 201 | Ben Skeggs | bskeggs@redhat.com | 1337842568 |  | drm/nv50: remove manual context unload on context destruction  PFIFO context destruction triggers this automagically now.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv20_graph.c | s | 24K | 750 | Ben Skeggs | bskeggs@redhat.com | 1337842571 |  | drm/nouveau/fifo: turn all fifo modules into engine modules  Been tested on each major revision that's relevant here, but I'm sure there are still bugs waiting to be ironed out.  This is a *very* invasive change.  There's a couple of pieces left that I don't like much (eg. other engines using fifo_priv for the channel count), but that's an artefact of there being a master channel list still.  This is changing, slowly.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_pm.c | s | 24K | 784 | Jim Meyering | jim@meyering.net | 1334842734 |  | drm/nouveau/pm: don't read/write beyond end of stack buffer  NUL-terminate after strncpy.  If the parameter "profile" has length 16 or more, then strncpy leaves "string" with no NUL terminator, so the following search for '\n' may read beyond the end of that 16-byte buffer. If it finds a newline there, then it will also write beyond the end of that stack buffer.  Signed-off-by: Jim Meyering <meyering@redhat.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | nv50_fb.c | s | 7.2K | 258 | Ben Skeggs | bskeggs@redhat.com | 1337842571 |  | drm/nouveau/fifo: turn all fifo modules into engine modules  Been tested on each major revision that's relevant here, but I'm sure there are still bugs waiting to be ironed out.  This is a *very* invasive change.  There's a couple of pieces left that I don't like much (eg. other engines using fifo_priv for the channel count), but that's an artefact of there being a master channel list still.  This is changing, slowly.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_mxm.c | s | 17K | 629 | Ben Skeggs | bskeggs@redhat.com | 1331622897 |  | drm/nouveau/mxm: call mxmi to determine revision before calling mxms  There's a HP laptop out there where the MXM version in the VBIOS doesn't match what the ACPI implementation is expecting.  These tables will accept 0x00 to MXMS to return latest version, but *only* if MXMI has been called first..  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nvc0_graph.h | s | 2.7K | 83 | Ben Skeggs | bskeggs@redhat.com | 1324458087 |  | drm/nvc0/gr: add initial support for nvd9, not quite there yet..  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nve0_grctx.c | s | 102K | 2729 | Ben Skeggs | bskeggs@redhat.com | 1337841101 |  | drm/nve0/gr: initial implementation  This may, perhaps, get re-merged with nvc0_graph.c at some point.  It's still unclear as to how great an idea that'd be.  Stay tuned...  Completely dependent on firmware blobs from NVIDIA binary driver currently.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv98_crypt.fuc.h | s | 8.5K | 583 | Ben Skeggs | bskeggs@redhat.com | 1337842573 |  | drm/nv98/crypt: non-stub implementation of the engine hooks  fuc is from pscnv driver.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nvc0_grhub.fuc.h | s | 10K | 837 | Ben Skeggs | bskeggs@redhat.com | 1324458087 |  | drm/nvc0/gr: add initial support for nvd9, not quite there yet..  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nvc0_grgpc.fuc.h | s | 6.8K | 537 | Ben Skeggs | bskeggs@redhat.com | 1324458087 |  | drm/nvc0/gr: add initial support for nvd9, not quite there yet..  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_mm.c | s | 4.4K | 148 | Ben Skeggs | bskeggs@redhat.com | 1316498640 |  | drm/nouveau: allow a nouveau_mm to be created with holes  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv84_vp.c | s | 2.3K | 70 | Ben Skeggs | bskeggs@redhat.com | 1324458070 |  | drm/nouveau/vdec: implement stub modules for the known engines  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_drv.h | s | 51K | 1429 | Dave Airlie | airlied@redhat.com | 1338470040 |  | nouveau: add vmap support to nouveau prime support  Tested sharing to udl.  Signed-off-by: Dave Airlie <airlied@redhat.com>
f | nouveau_fb.h | s | 1.7K | 43 | Ben Skeggs | bskeggs@redhat.com | 1324458076 |  | drm/nouveau: move master modesetting init to nouveau_display  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_i2c.h | s | 2.0K | 52 | Ben Skeggs | bskeggs@redhat.com | 1336384958 |  | drm/nouveau/i2c: resume use of i2c-algo-bit, rather than custom stack  Previous issues with i2c-algo-bit have now been resolved.  This is a revert of f553b79c03f0dbd52f6f03abe8233a2bef8cbd0d mostly, due to fixes in the i2c core repairing the original issue, this code isn't required and was causing regressions.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com> Reported-by: Nick Bowler <nbowler@elliptictech.com> Tested-by: Nick Bowler <nbowler@elliptictech.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | nvc0_fb.c | s | 3.5K | 115 | Christoph Bumiller | e0425955@student.tuwien.ac.at | 1335765346 |  | nvc0/fb: shut up PMFB interrupt after the first occurrence  Signed-off-by: Christoph Bumiller <e0425955@student.tuwien.ac.at> Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nvd0_display.c | s | 56K | 1797 | Ben Skeggs | bskeggs@redhat.com | 1337842543 |  | drm/nouveau: move flip-related channel setup to software engine  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_encoder.h | s | 3.2K | 85 | Ben Skeggs | bskeggs@redhat.com | 1331622904 |  | drm/nouveau/dp: make dp dpms function common, call from sor code instead  GF119 will use this too.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_ioc32.c | s | 2.2K | 63 | Arnd Bergmann | arnd@arndb.de | 1261099351 |  | drm: convert drm_ioctl to unlocked_ioctl  drm_ioctl is called with the Big Kernel Lock held, which shows up very high in statistics on vfs_ioctl.  Moving the lock into the drm_ioctl function itself makes sure we blame the right subsystem and it gets us one step closer to eliminating the locked version of fops->ioctl.  Since drm_ioctl does not require the lock itself, we only need to hold it while calling the specific handler. The 32 bit conversion handlers do not interact with any other code, so they don't need the BKL here either and can just call drm_ioctl.  As a bonus, this cleans up all the other users of drm_ioctl which now no longer have to find the inode or call lock_kernel.  [airlied: squashed the non-driver bits of the second patch in here, this provides the flag for drivers to use to select unlocked ioctls - but doesn't modify any drivers].  Signed-off-by: Arnd Bergmann <arnd@arndb.de> Cc: David Airlie <airlied@linux.ie> Cc: dri-devel@lists.sourceforge.net Cc: Frederic Weisbecker <fweisbec@gmail.com> Cc: Thomas Gleixner <tglx@linutronix.de> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | nv84_bsp.c | s | 2.3K | 70 | Ben Skeggs | bskeggs@redhat.com | 1324458070 |  | drm/nouveau/vdec: implement stub modules for the known engines  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_fence.h | s | 1.5K | 41 | Ben Skeggs | bskeggs@redhat.com | 1337842558 |  | drm/nouveau/fence: fix a race where fence->channel can disappear  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv50_software.c | s | 5.6K | 178 | Ben Skeggs | bskeggs@redhat.com | 1337842543 |  | drm/nouveau: move flip-related channel setup to software engine  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nva3_copy.c | s | 5.6K | 172 | Ben Skeggs | bskeggs@redhat.com | 1337842568 |  | drm/nv50: remove manual context unload on context destruction  PFIFO context destruction triggers this automagically now.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv10_fb.c | s | 2.4K | 85 | Ben Skeggs | bskeggs@redhat.com | 1331622329 |  | drm/nv20: split PFB code out of nv10_fb.c  Most functions were quite different between NV10/NV20 already, and they're about to get even more so.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_bo.c | s | 37K | 1280 | Ben Skeggs | bskeggs@redhat.com | 1337842583 |  | drm/nvc0/ttm: use copy engines for async buffer moves  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv04_tv.c | s | 7.3K | 207 | Francisco Jerez | currojerez@riseup.net | 1286236723 |  | drm/nv0x-nv4x: Leave the 0x40 bit untouched when changing CRE_LCD.  It's an unrelated PLL filtering control bit, leave it alone when changing the CRTC-encoder binding.  Signed-off-by: Francisco Jerez <currojerez@riseup.net> Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_ramht.h | s | 2.0K | 49 | Ben Skeggs | bskeggs@redhat.com | 1291352727 |  | drm/nouveau: return error from nouveau_ramht_remove() if not found  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_fifo.h | s | 987B | 26 | Ben Skeggs | bskeggs@redhat.com | 1337842571 |  | drm/nouveau/fifo: turn all fifo modules into engine modules  Been tested on each major revision that's relevant here, but I'm sure there are still bugs waiting to be ironed out.  This is a *very* invasive change.  There's a couple of pieces left that I don't like much (eg. other engines using fifo_priv for the channel count), but that's an artefact of there being a master channel list still.  This is changing, slowly.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv10_graph.c | s | 31K | 1060 | Ben Skeggs | bskeggs@redhat.com | 1337842571 |  | drm/nouveau/fifo: turn all fifo modules into engine modules  Been tested on each major revision that's relevant here, but I'm sure there are still bugs waiting to be ironed out.  This is a *very* invasive change.  There's a couple of pieces left that I don't like much (eg. other engines using fifo_priv for the channel count), but that's an artefact of there being a master channel list still.  This is changing, slowly.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv40_graph.c | s | 12K | 417 | Ben Skeggs | bskeggs@redhat.com | 1337842571 |  | drm/nouveau/fifo: turn all fifo modules into engine modules  Been tested on each major revision that's relevant here, but I'm sure there are still bugs waiting to be ironed out.  This is a *very* invasive change.  There's a couple of pieces left that I don't like much (eg. other engines using fifo_priv for the channel count), but that's an artefact of there being a master channel list still.  This is changing, slowly.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_channel.c | s | 13K | 420 | Ben Skeggs | bskeggs@redhat.com | 1337842576 |  | drm/nouveau/ttm: untangle code to support accelerated buffer moves  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_vm.c | s | 10K | 414 | Dave Airlie | airlied@redhat.com | 1337766415 |  | nouveau: add PRIME support  This adds prime->fd and fd->prime support to nouveau, it passes the SG object to TTM, and then populates the GART entries using it.  v2: add stubbed kmap + use new function to fill out pages array for faulting + add reimport test.  Reviewed-by: Alex Deucher <alexander.deucher@amd.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | nv40_fifo.c | s | 6.3K | 184 | Ben Skeggs | bskeggs@redhat.com | 1337842571 |  | drm/nouveau/fifo: turn all fifo modules into engine modules  Been tested on each major revision that's relevant here, but I'm sure there are still bugs waiting to be ironed out.  This is a *very* invasive change.  There's a couple of pieces left that I don't like much (eg. other engines using fifo_priv for the channel count), but that's an artefact of there being a master channel list still.  This is changing, slowly.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nv98_crypt.c | s | 5.8K | 179 | Ben Skeggs | bskeggs@redhat.com | 1337842573 |  | drm/nv98/crypt: non-stub implementation of the engine hooks  fuc is from pscnv driver.  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_crtc.h | s | 2.8K | 82 | Christoph Bumiller | e0425955@student.tuwien.ac.at | 1331622896 |  | drm/nv50/display: expose color vibrance control  Signed-off-by: Christoph Bumiller <e0425955@student.tuwien.ac.at> Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | nouveau_notifier.c | s | 5.2K | 174 | Francisco Jerez | currojerez@riseup.net | 1324458107 |  | drm/nouveau: Fix notifier blocks over the 4GB mark.  Signed-off-by: Francisco Jerez <currojerez@riseup.net> Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
