<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › gpu › drm › exynos › exynos_hdmi.c

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>exynos_hdmi.c</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright (C) 2011 Samsung Electronics Co.Ltd</span>
<span class="cm"> * Authors:</span>
<span class="cm"> * Seung-Woo Kim &lt;sw0312.kim@samsung.com&gt;</span>
<span class="cm"> *	Inki Dae &lt;inki.dae@samsung.com&gt;</span>
<span class="cm"> *	Joonyoung Shim &lt;jy0922.shim@samsung.com&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * Based on drivers/media/video/s5p-tv/hdmi_drv.c</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute  it and/or modify it</span>
<span class="cm"> * under  the terms of  the GNU General  Public License as published by the</span>
<span class="cm"> * Free Software Foundation;  either version 2 of the  License, or (at your</span>
<span class="cm"> * option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cp">#include &quot;drmP.h&quot;</span>
<span class="cp">#include &quot;drm_edid.h&quot;</span>
<span class="cp">#include &quot;drm_crtc_helper.h&quot;</span>

<span class="cp">#include &quot;regs-hdmi.h&quot;</span>

<span class="cp">#include &lt;linux/kernel.h&gt;</span>
<span class="cp">#include &lt;linux/spinlock.h&gt;</span>
<span class="cp">#include &lt;linux/wait.h&gt;</span>
<span class="cp">#include &lt;linux/i2c.h&gt;</span>
<span class="cp">#include &lt;linux/module.h&gt;</span>
<span class="cp">#include &lt;linux/platform_device.h&gt;</span>
<span class="cp">#include &lt;linux/interrupt.h&gt;</span>
<span class="cp">#include &lt;linux/irq.h&gt;</span>
<span class="cp">#include &lt;linux/delay.h&gt;</span>
<span class="cp">#include &lt;linux/pm_runtime.h&gt;</span>
<span class="cp">#include &lt;linux/clk.h&gt;</span>
<span class="cp">#include &lt;linux/regulator/consumer.h&gt;</span>

<span class="cp">#include &lt;drm/exynos_drm.h&gt;</span>

<span class="cp">#include &quot;exynos_drm_drv.h&quot;</span>
<span class="cp">#include &quot;exynos_drm_hdmi.h&quot;</span>

<span class="cp">#include &quot;exynos_hdmi.h&quot;</span>

<span class="cp">#define MAX_WIDTH		1920</span>
<span class="cp">#define MAX_HEIGHT		1080</span>
<span class="cp">#define get_hdmi_context(dev)	platform_get_drvdata(to_platform_device(dev))</span>

<span class="k">struct</span> <span class="n">hdmi_resources</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">clk</span>			<span class="o">*</span><span class="n">hdmi</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">clk</span>			<span class="o">*</span><span class="n">sclk_hdmi</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">clk</span>			<span class="o">*</span><span class="n">sclk_pixel</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">clk</span>			<span class="o">*</span><span class="n">sclk_hdmiphy</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">clk</span>			<span class="o">*</span><span class="n">hdmiphy</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_bulk_data</span>	<span class="o">*</span><span class="n">regul_bulk</span><span class="p">;</span>
	<span class="kt">int</span>				<span class="n">regul_count</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">hdmi_context</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">device</span>			<span class="o">*</span><span class="n">dev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">drm_device</span>		<span class="o">*</span><span class="n">drm_dev</span><span class="p">;</span>
	<span class="n">bool</span>				<span class="n">hpd</span><span class="p">;</span>
	<span class="n">bool</span>				<span class="n">powered</span><span class="p">;</span>
	<span class="n">bool</span>				<span class="n">is_v13</span><span class="p">;</span>
	<span class="n">bool</span>				<span class="n">dvi_mode</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">mutex</span>			<span class="n">hdmi_mutex</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">resource</span>			<span class="o">*</span><span class="n">regs_res</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span>			<span class="o">*</span><span class="n">regs</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>			<span class="n">external_irq</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>			<span class="n">internal_irq</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">i2c_client</span>		<span class="o">*</span><span class="n">ddc_port</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">i2c_client</span>		<span class="o">*</span><span class="n">hdmiphy_port</span><span class="p">;</span>

	<span class="cm">/* current hdmiphy conf index */</span>
	<span class="kt">int</span> <span class="n">cur_conf</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">hdmi_resources</span>		<span class="n">res</span><span class="p">;</span>
	<span class="kt">void</span>				<span class="o">*</span><span class="n">parent_ctx</span><span class="p">;</span>

	<span class="kt">void</span>				<span class="p">(</span><span class="o">*</span><span class="n">cfg_hpd</span><span class="p">)(</span><span class="n">bool</span> <span class="n">external</span><span class="p">);</span>
	<span class="kt">int</span>				<span class="p">(</span><span class="o">*</span><span class="n">get_hpd</span><span class="p">)(</span><span class="kt">void</span><span class="p">);</span>
<span class="p">};</span>

<span class="cm">/* HDMI Version 1.3 */</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">u8</span> <span class="n">hdmiphy_v13_conf27</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xD8</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x1C</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span>
	<span class="mh">0x6B</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0xDF</span><span class="p">,</span> <span class="mh">0xF2</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span>
	<span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0xE0</span><span class="p">,</span>
	<span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0xE3</span><span class="p">,</span> <span class="mh">0x26</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">u8</span> <span class="n">hdmiphy_v13_conf27_027</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xD4</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x9C</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span>
	<span class="mh">0x6B</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0xDF</span><span class="p">,</span> <span class="mh">0xF2</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span>
	<span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0xE0</span><span class="p">,</span>
	<span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0xE3</span><span class="p">,</span> <span class="mh">0x26</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">u8</span> <span class="n">hdmiphy_v13_conf74_175</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xD8</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x9C</span><span class="p">,</span> <span class="mh">0xef</span><span class="p">,</span> <span class="mh">0x5B</span><span class="p">,</span>
	<span class="mh">0x6D</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0xef</span><span class="p">,</span> <span class="mh">0xF3</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0xb9</span><span class="p">,</span>
	<span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0xE0</span><span class="p">,</span>
	<span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0xa5</span><span class="p">,</span> <span class="mh">0x26</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">u8</span> <span class="n">hdmiphy_v13_conf74_25</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xd8</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x9c</span><span class="p">,</span> <span class="mh">0xf8</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span>
	<span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xf1</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0xba</span><span class="p">,</span>
	<span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0xe0</span><span class="p">,</span>
	<span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0xa4</span><span class="p">,</span> <span class="mh">0x26</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">u8</span> <span class="n">hdmiphy_v13_conf148_5</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xD8</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x9C</span><span class="p">,</span> <span class="mh">0xf8</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span>
	<span class="mh">0x6A</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xF1</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0xba</span><span class="p">,</span>
	<span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0xE0</span><span class="p">,</span>
	<span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0xa4</span><span class="p">,</span> <span class="mh">0x26</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">hdmi_v13_tg_regs</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">cmd</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">h_fsz_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">h_fsz_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">hact_st_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">hact_st_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">hact_sz_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">hact_sz_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">v_fsz_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">v_fsz_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vsync_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vsync_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vsync2_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vsync2_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vact_st_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vact_st_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vact_sz_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vact_sz_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">field_chg_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">field_chg_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vact_st2_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vact_st2_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vsync_top_hdmi_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vsync_top_hdmi_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vsync_bot_hdmi_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vsync_bot_hdmi_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">field_top_hdmi_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">field_top_hdmi_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">field_bot_hdmi_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">field_bot_hdmi_h</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">hdmi_v13_core_regs</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">h_blank</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">v_blank</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">h_v_line</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">vsync_pol</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">int_pro_mode</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">v_blank_f</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">h_sync_gen</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">v_sync_gen1</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">v_sync_gen2</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">v_sync_gen3</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">hdmi_v13_preset_conf</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">hdmi_v13_core_regs</span> <span class="n">core</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hdmi_v13_tg_regs</span> <span class="n">tg</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">hdmi_v13_conf</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">width</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">height</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">vrefresh</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">interlace</span><span class="p">;</span>
	<span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">hdmiphy_data</span><span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">hdmi_v13_preset_conf</span> <span class="o">*</span><span class="n">conf</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hdmi_v13_preset_conf</span> <span class="n">hdmi_v13_conf_480p</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">core</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">h_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x8a</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_v_line</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0xa2</span><span class="p">,</span> <span class="mh">0x35</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vsync_pol</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x01</span><span class="p">},</span>
		<span class="p">.</span><span class="n">int_pro_mode</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_sync_gen</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x0e</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_gen1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="cm">/* other don&#39;t care */</span>
	<span class="p">},</span>
	<span class="p">.</span><span class="n">tg</span> <span class="o">=</span> <span class="p">{</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* cmd */</span>
		<span class="mh">0x5a</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="cm">/* h_fsz */</span>
		<span class="mh">0x8a</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xd0</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* hact */</span>
		<span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* v_fsz */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vsync */</span>
		<span class="mh">0x2d</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xe0</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="cm">/* vact */</span>
		<span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field_chg */</span>
		<span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vact_st2 */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vsync top/bot */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field top/bot */</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hdmi_v13_preset_conf</span> <span class="n">hdmi_v13_conf_720p60</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">core</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">h_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xee</span><span class="p">,</span> <span class="mh">0xf2</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_v_line</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xee</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vsync_pol</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">int_pro_mode</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span> <span class="cm">/* don&#39;t care */</span>
		<span class="p">.</span><span class="n">h_sync_gen</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_gen1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_gen2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_gen3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="cm">/* other don&#39;t care */</span>
	<span class="p">},</span>
	<span class="p">.</span><span class="n">tg</span> <span class="o">=</span> <span class="p">{</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* cmd */</span>
		<span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="cm">/* h_fsz */</span>
		<span class="mh">0x71</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="cm">/* hact */</span>
		<span class="mh">0xee</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* v_fsz */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vsync */</span>
		<span class="mh">0x1e</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xd0</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vact */</span>
		<span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field_chg */</span>
		<span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vact_st2 */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* vsync top/bot */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field top/bot */</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hdmi_v13_preset_conf</span> <span class="n">hdmi_v13_conf_1080i50</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">core</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">h_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xd0</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x32</span><span class="p">,</span> <span class="mh">0xB2</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_v_line</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0xa5</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vsync_pol</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">int_pro_mode</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x01</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x2A</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_sync_gen</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x0E</span><span class="p">,</span> <span class="mh">0xEA</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_gen1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_gen2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_gen3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">},</span>
		<span class="cm">/* other don&#39;t care */</span>
	<span class="p">},</span>
	<span class="p">.</span><span class="n">tg</span> <span class="o">=</span> <span class="p">{</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* cmd */</span>
		<span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x0A</span><span class="p">,</span> <span class="cm">/* h_fsz */</span>
		<span class="mh">0xCF</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="cm">/* hact */</span>
		<span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="cm">/* v_fsz */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vsync */</span>
		<span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x1c</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vact */</span>
		<span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field_chg */</span>
		<span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vact_st2 */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vsync top/bot */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field top/bot */</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hdmi_v13_preset_conf</span> <span class="n">hdmi_v13_conf_1080p50</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">core</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">h_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xd0</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_v_line</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0xa5</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vsync_pol</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">int_pro_mode</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span> <span class="cm">/* don&#39;t care */</span>
		<span class="p">.</span><span class="n">h_sync_gen</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x0e</span><span class="p">,</span> <span class="mh">0xea</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_gen1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_gen2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_gen3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="cm">/* other don&#39;t care */</span>
	<span class="p">},</span>
	<span class="p">.</span><span class="n">tg</span> <span class="o">=</span> <span class="p">{</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* cmd */</span>
		<span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x0A</span><span class="p">,</span> <span class="cm">/* h_fsz */</span>
		<span class="mh">0xCF</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="cm">/* hact */</span>
		<span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="cm">/* v_fsz */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vsync */</span>
		<span class="mh">0x2d</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="cm">/* vact */</span>
		<span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field_chg */</span>
		<span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vact_st2 */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* vsync top/bot */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field top/bot */</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hdmi_v13_preset_conf</span> <span class="n">hdmi_v13_conf_1080i60</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">core</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">h_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x32</span><span class="p">,</span> <span class="mh">0xB2</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_v_line</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vsync_pol</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">int_pro_mode</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x01</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x2A</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_sync_gen</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_gen1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_gen2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_gen3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xa4</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x4a</span><span class="p">},</span>
		<span class="cm">/* other don&#39;t care */</span>
	<span class="p">},</span>
	<span class="p">.</span><span class="n">tg</span> <span class="o">=</span> <span class="p">{</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* cmd */</span>
		<span class="mh">0x98</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="cm">/* h_fsz */</span>
		<span class="mh">0x17</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="cm">/* hact */</span>
		<span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="cm">/* v_fsz */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vsync */</span>
		<span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x1c</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vact */</span>
		<span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field_chg */</span>
		<span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vact_st2 */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vsync top/bot */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field top/bot */</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hdmi_v13_preset_conf</span> <span class="n">hdmi_v13_conf_1080p60</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">core</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">h_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_v_line</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vsync_pol</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">int_pro_mode</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span> <span class="cm">/* don&#39;t care */</span>
		<span class="p">.</span><span class="n">h_sync_gen</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_gen1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_gen2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_gen3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="cm">/* other don&#39;t care */</span>
	<span class="p">},</span>
	<span class="p">.</span><span class="n">tg</span> <span class="o">=</span> <span class="p">{</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* cmd */</span>
		<span class="mh">0x98</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="cm">/* h_fsz */</span>
		<span class="mh">0x17</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="cm">/* hact */</span>
		<span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="cm">/* v_fsz */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vsync */</span>
		<span class="mh">0x2d</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="cm">/* vact */</span>
		<span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field_chg */</span>
		<span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vact_st2 */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* vsync top/bot */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field top/bot */</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hdmi_v13_conf</span> <span class="n">hdmi_v13_confs</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="mi">1280</span><span class="p">,</span> <span class="mi">720</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="n">hdmiphy_v13_conf74_25</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">hdmi_v13_conf_720p60</span> <span class="p">},</span>
	<span class="p">{</span> <span class="mi">1280</span><span class="p">,</span> <span class="mi">720</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="n">hdmiphy_v13_conf74_25</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">hdmi_v13_conf_720p60</span> <span class="p">},</span>
	<span class="p">{</span> <span class="mi">720</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="n">hdmiphy_v13_conf27_027</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">hdmi_v13_conf_480p</span> <span class="p">},</span>
	<span class="p">{</span> <span class="mi">1920</span><span class="p">,</span> <span class="mi">1080</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="nb">true</span><span class="p">,</span> <span class="n">hdmiphy_v13_conf74_25</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">hdmi_v13_conf_1080i50</span> <span class="p">},</span>
	<span class="p">{</span> <span class="mi">1920</span><span class="p">,</span> <span class="mi">1080</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="n">hdmiphy_v13_conf148_5</span><span class="p">,</span>
				 <span class="o">&amp;</span><span class="n">hdmi_v13_conf_1080p50</span> <span class="p">},</span>
	<span class="p">{</span> <span class="mi">1920</span><span class="p">,</span> <span class="mi">1080</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="nb">true</span><span class="p">,</span> <span class="n">hdmiphy_v13_conf74_25</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">hdmi_v13_conf_1080i60</span> <span class="p">},</span>
	<span class="p">{</span> <span class="mi">1920</span><span class="p">,</span> <span class="mi">1080</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="n">hdmiphy_v13_conf148_5</span><span class="p">,</span>
				 <span class="o">&amp;</span><span class="n">hdmi_v13_conf_1080p60</span> <span class="p">},</span>
<span class="p">};</span>

<span class="cm">/* HDMI Version 1.4 */</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">u8</span> <span class="n">hdmiphy_conf27_027</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0xd1</span><span class="p">,</span> <span class="mh">0x2d</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span>
	<span class="mh">0x43</span><span class="p">,</span> <span class="mh">0xa0</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span> <span class="mh">0xd9</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0xa0</span><span class="p">,</span> <span class="mh">0xac</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span>
	<span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span>
	<span class="mh">0x54</span><span class="p">,</span> <span class="mh">0xe3</span><span class="p">,</span> <span class="mh">0x24</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">u8</span> <span class="n">hdmiphy_conf74_176</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0xd1</span><span class="p">,</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x5b</span><span class="p">,</span> <span class="mh">0xef</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span>
	<span class="mh">0x81</span><span class="p">,</span> <span class="mh">0xa0</span><span class="p">,</span> <span class="mh">0xb9</span><span class="p">,</span> <span class="mh">0xd8</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0xa0</span><span class="p">,</span> <span class="mh">0xac</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span>
	<span class="mh">0x5a</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span>
	<span class="mh">0x54</span><span class="p">,</span> <span class="mh">0xa6</span><span class="p">,</span> <span class="mh">0x24</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">u8</span> <span class="n">hdmiphy_conf74_25</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0xd1</span><span class="p">,</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0xf8</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span>
	<span class="mh">0x81</span><span class="p">,</span> <span class="mh">0xa0</span><span class="p">,</span> <span class="mh">0xba</span><span class="p">,</span> <span class="mh">0xd8</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0xa0</span><span class="p">,</span> <span class="mh">0xac</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span>
	<span class="mh">0x3c</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span>
	<span class="mh">0x54</span><span class="p">,</span> <span class="mh">0xa5</span><span class="p">,</span> <span class="mh">0x24</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">u8</span> <span class="n">hdmiphy_conf148_5</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0xd1</span><span class="p">,</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0xf8</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span>
	<span class="mh">0x81</span><span class="p">,</span> <span class="mh">0xa0</span><span class="p">,</span> <span class="mh">0xba</span><span class="p">,</span> <span class="mh">0xd8</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0xa0</span><span class="p">,</span> <span class="mh">0xac</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span>
	<span class="mh">0x3c</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span>
	<span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x4b</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">hdmi_tg_regs</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">cmd</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">h_fsz_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">h_fsz_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">hact_st_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">hact_st_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">hact_sz_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">hact_sz_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">v_fsz_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">v_fsz_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vsync_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vsync_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vsync2_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vsync2_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vact_st_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vact_st_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vact_sz_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vact_sz_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">field_chg_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">field_chg_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vact_st2_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vact_st2_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vact_st3_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vact_st3_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vact_st4_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vact_st4_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vsync_top_hdmi_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vsync_top_hdmi_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vsync_bot_hdmi_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vsync_bot_hdmi_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">field_top_hdmi_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">field_top_hdmi_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">field_bot_hdmi_l</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">field_bot_hdmi_h</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">tg_3d</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">hdmi_core_regs</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">h_blank</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">v2_blank</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">v1_blank</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">v_line</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">h_line</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">hsync_pol</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">vsync_pol</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">int_pro_mode</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">v_blank_f0</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">v_blank_f1</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">h_sync_start</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">h_sync_end</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">v_sync_line_bef_2</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">v_sync_line_bef_1</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">v_sync_line_aft_2</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">v_sync_line_aft_1</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">v_sync_line_aft_pxl_2</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">v_sync_line_aft_pxl_1</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">v_blank_f2</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="cm">/* for 3D mode */</span>
	<span class="n">u8</span> <span class="n">v_blank_f3</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="cm">/* for 3D mode */</span>
	<span class="n">u8</span> <span class="n">v_blank_f4</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="cm">/* for 3D mode */</span>
	<span class="n">u8</span> <span class="n">v_blank_f5</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="cm">/* for 3D mode */</span>
	<span class="n">u8</span> <span class="n">v_sync_line_aft_3</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">v_sync_line_aft_4</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">v_sync_line_aft_5</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">v_sync_line_aft_6</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">v_sync_line_aft_pxl_3</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">v_sync_line_aft_pxl_4</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">v_sync_line_aft_pxl_5</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">v_sync_line_aft_pxl_6</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">vact_space_1</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">vact_space_2</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">vact_space_3</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">vact_space_4</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">vact_space_5</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">vact_space_6</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">hdmi_preset_conf</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">hdmi_core_regs</span> <span class="n">core</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hdmi_tg_regs</span> <span class="n">tg</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">hdmi_conf</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">width</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">height</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">vrefresh</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">interlace</span><span class="p">;</span>
	<span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">hdmiphy_data</span><span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">hdmi_preset_conf</span> <span class="o">*</span><span class="n">conf</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hdmi_preset_conf</span> <span class="n">hdmi_conf_480p60</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">core</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">h_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x8a</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v2_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v1_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x2d</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_line</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_line</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x5a</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">},</span>
		<span class="p">.</span><span class="n">hsync_pol</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x01</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vsync_pol</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x01</span><span class="p">},</span>
		<span class="p">.</span><span class="n">int_pro_mode</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f0</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_sync_start</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x0e</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_sync_end</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x4c</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_bef_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_bef_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_6</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_6</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_6</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="cm">/* other don&#39;t care */</span>
	<span class="p">},</span>
	<span class="p">.</span><span class="n">tg</span> <span class="o">=</span> <span class="p">{</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* cmd */</span>
		<span class="mh">0x5a</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="cm">/* h_fsz */</span>
		<span class="mh">0x8a</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xd0</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* hact */</span>
		<span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* v_fsz */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vsync */</span>
		<span class="mh">0x2d</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xe0</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="cm">/* vact */</span>
		<span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field_chg */</span>
		<span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vact_st2 */</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* vact_st3 */</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* vact_st4 */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* vsync top/bot */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field top/bot */</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 3d FP */</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hdmi_preset_conf</span> <span class="n">hdmi_conf_720p50</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">core</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">h_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xbc</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v2_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xee</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v1_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x1e</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_line</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xee</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_line</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xbc</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">},</span>
		<span class="p">.</span><span class="n">hsync_pol</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vsync_pol</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">int_pro_mode</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f0</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_sync_start</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xb6</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_sync_end</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xde</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_bef_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_bef_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_6</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_6</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_6</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="cm">/* other don&#39;t care */</span>
	<span class="p">},</span>
	<span class="p">.</span><span class="n">tg</span> <span class="o">=</span> <span class="p">{</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* cmd */</span>
		<span class="mh">0xbc</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="cm">/* h_fsz */</span>
		<span class="mh">0xbc</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="cm">/* hact */</span>
		<span class="mh">0xee</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* v_fsz */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vsync */</span>
		<span class="mh">0x1e</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xd0</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vact */</span>
		<span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field_chg */</span>
		<span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vact_st2 */</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* vact_st3 */</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* vact_st4 */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* vsync top/bot */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field top/bot */</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 3d FP */</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hdmi_preset_conf</span> <span class="n">hdmi_conf_720p60</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">core</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">h_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v2_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xee</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v1_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x1e</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_line</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xee</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_line</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">},</span>
		<span class="p">.</span><span class="n">hsync_pol</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vsync_pol</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">int_pro_mode</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f0</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_sync_start</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_sync_end</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x94</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_bef_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_bef_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_6</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_6</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_6</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="cm">/* other don&#39;t care */</span>
	<span class="p">},</span>
	<span class="p">.</span><span class="n">tg</span> <span class="o">=</span> <span class="p">{</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* cmd */</span>
		<span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="cm">/* h_fsz */</span>
		<span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="cm">/* hact */</span>
		<span class="mh">0xee</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* v_fsz */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vsync */</span>
		<span class="mh">0x1e</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xd0</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vact */</span>
		<span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field_chg */</span>
		<span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vact_st2 */</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* vact_st3 */</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* vact_st4 */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* vsync top/bot */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field top/bot */</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 3d FP */</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hdmi_preset_conf</span> <span class="n">hdmi_conf_1080i50</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">core</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">h_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xd0</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v2_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x32</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v1_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_line</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_line</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x0a</span><span class="p">},</span>
		<span class="p">.</span><span class="n">hsync_pol</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vsync_pol</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">int_pro_mode</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x01</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f0</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_sync_start</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x0e</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_sync_end</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x3a</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_bef_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_bef_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x34</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_6</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_6</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_6</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="cm">/* other don&#39;t care */</span>
	<span class="p">},</span>
	<span class="p">.</span><span class="n">tg</span> <span class="o">=</span> <span class="p">{</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* cmd */</span>
		<span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x0a</span><span class="p">,</span> <span class="cm">/* h_fsz */</span>
		<span class="mh">0xd0</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="cm">/* hact */</span>
		<span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="cm">/* v_fsz */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vsync */</span>
		<span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x1c</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vact */</span>
		<span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field_chg */</span>
		<span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vact_st2 */</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* vact_st3 */</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* vact_st4 */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vsync top/bot */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field top/bot */</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 3d FP */</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hdmi_preset_conf</span> <span class="n">hdmi_conf_1080i60</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">core</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">h_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v2_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x32</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v1_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_line</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_line</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x98</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">},</span>
		<span class="p">.</span><span class="n">hsync_pol</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vsync_pol</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">int_pro_mode</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x01</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f0</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_sync_start</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_sync_end</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x82</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_bef_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_bef_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x34</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xa4</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xa4</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_6</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_6</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_6</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="cm">/* other don&#39;t care */</span>
	<span class="p">},</span>
	<span class="p">.</span><span class="n">tg</span> <span class="o">=</span> <span class="p">{</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* cmd */</span>
		<span class="mh">0x98</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="cm">/* h_fsz */</span>
		<span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="cm">/* hact */</span>
		<span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="cm">/* v_fsz */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vsync */</span>
		<span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x1c</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vact */</span>
		<span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field_chg */</span>
		<span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vact_st2 */</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* vact_st3 */</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* vact_st4 */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vsync top/bot */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field top/bot */</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 3d FP */</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hdmi_preset_conf</span> <span class="n">hdmi_conf_1080p30</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">core</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">h_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v2_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v1_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x2d</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_line</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_line</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x98</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">},</span>
		<span class="p">.</span><span class="n">hsync_pol</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vsync_pol</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">int_pro_mode</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f0</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_sync_start</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_sync_end</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x82</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_bef_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_bef_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_6</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_6</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_6</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="cm">/* other don&#39;t care */</span>
	<span class="p">},</span>
	<span class="p">.</span><span class="n">tg</span> <span class="o">=</span> <span class="p">{</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* cmd */</span>
		<span class="mh">0x98</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="cm">/* h_fsz */</span>
		<span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="cm">/* hact */</span>
		<span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="cm">/* v_fsz */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vsync */</span>
		<span class="mh">0x2d</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="cm">/* vact */</span>
		<span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field_chg */</span>
		<span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vact_st2 */</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* vact_st3 */</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* vact_st4 */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* vsync top/bot */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field top/bot */</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 3d FP */</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hdmi_preset_conf</span> <span class="n">hdmi_conf_1080p50</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">core</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">h_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xd0</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v2_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v1_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x2d</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_line</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_line</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x0a</span><span class="p">},</span>
		<span class="p">.</span><span class="n">hsync_pol</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vsync_pol</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">int_pro_mode</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f0</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_sync_start</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x0e</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_sync_end</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x3a</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_bef_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_bef_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_6</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_6</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vact_space_6</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="cm">/* other don&#39;t care */</span>
	<span class="p">},</span>
	<span class="p">.</span><span class="n">tg</span> <span class="o">=</span> <span class="p">{</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* cmd */</span>
		<span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x0a</span><span class="p">,</span> <span class="cm">/* h_fsz */</span>
		<span class="mh">0xd0</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="cm">/* hact */</span>
		<span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="cm">/* v_fsz */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vsync */</span>
		<span class="mh">0x2d</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="cm">/* vact */</span>
		<span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field_chg */</span>
		<span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vact_st2 */</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* vact_st3 */</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* vact_st4 */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* vsync top/bot */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field top/bot */</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 3d FP */</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hdmi_preset_conf</span> <span class="n">hdmi_conf_1080p60</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">core</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">h_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v2_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v1_blank</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x2d</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_line</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_line</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x98</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">},</span>
		<span class="p">.</span><span class="n">hsync_pol</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">vsync_pol</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">int_pro_mode</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f0</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_sync_start</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">h_sync_end</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x82</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_bef_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_bef_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_1</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f2</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_blank_f5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_6</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_3</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_4</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_5</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="p">.</span><span class="n">v_sync_line_aft_pxl_6</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
		<span class="cm">/* other don&#39;t care */</span>
	<span class="p">},</span>
	<span class="p">.</span><span class="n">tg</span> <span class="o">=</span> <span class="p">{</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* cmd */</span>
		<span class="mh">0x98</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="cm">/* h_fsz */</span>
		<span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="cm">/* hact */</span>
		<span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="cm">/* v_fsz */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vsync */</span>
		<span class="mh">0x2d</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="cm">/* vact */</span>
		<span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field_chg */</span>
		<span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* vact_st2 */</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* vact_st3 */</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* vact_st4 */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* vsync top/bot */</span>
		<span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* field top/bot */</span>
		<span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 3d FP */</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hdmi_conf</span> <span class="n">hdmi_confs</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="mi">720</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="n">hdmiphy_conf27_027</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">hdmi_conf_480p60</span> <span class="p">},</span>
	<span class="p">{</span> <span class="mi">1280</span><span class="p">,</span> <span class="mi">720</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="n">hdmiphy_conf74_25</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">hdmi_conf_720p50</span> <span class="p">},</span>
	<span class="p">{</span> <span class="mi">1280</span><span class="p">,</span> <span class="mi">720</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="n">hdmiphy_conf74_25</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">hdmi_conf_720p60</span> <span class="p">},</span>
	<span class="p">{</span> <span class="mi">1920</span><span class="p">,</span> <span class="mi">1080</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="nb">true</span><span class="p">,</span> <span class="n">hdmiphy_conf74_25</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">hdmi_conf_1080i50</span> <span class="p">},</span>
	<span class="p">{</span> <span class="mi">1920</span><span class="p">,</span> <span class="mi">1080</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="nb">true</span><span class="p">,</span> <span class="n">hdmiphy_conf74_25</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">hdmi_conf_1080i60</span> <span class="p">},</span>
	<span class="p">{</span> <span class="mi">1920</span><span class="p">,</span> <span class="mi">1080</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="n">hdmiphy_conf74_176</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">hdmi_conf_1080p30</span> <span class="p">},</span>
	<span class="p">{</span> <span class="mi">1920</span><span class="p">,</span> <span class="mi">1080</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="n">hdmiphy_conf148_5</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">hdmi_conf_1080p50</span> <span class="p">},</span>
	<span class="p">{</span> <span class="mi">1920</span><span class="p">,</span> <span class="mi">1080</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="n">hdmiphy_conf148_5</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">hdmi_conf_1080p60</span> <span class="p">},</span>
<span class="p">};</span>


<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="nf">hdmi_reg_read</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span><span class="p">,</span> <span class="n">u32</span> <span class="n">reg_id</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">readl</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">regs</span> <span class="o">+</span> <span class="n">reg_id</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">hdmi_reg_writeb</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span><span class="p">,</span>
				 <span class="n">u32</span> <span class="n">reg_id</span><span class="p">,</span> <span class="n">u8</span> <span class="n">value</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">writeb</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">hdata</span><span class="o">-&gt;</span><span class="n">regs</span> <span class="o">+</span> <span class="n">reg_id</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">hdmi_reg_writemask</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span><span class="p">,</span>
				 <span class="n">u32</span> <span class="n">reg_id</span><span class="p">,</span> <span class="n">u32</span> <span class="n">value</span><span class="p">,</span> <span class="n">u32</span> <span class="n">mask</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">old</span> <span class="o">=</span> <span class="n">readl</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">regs</span> <span class="o">+</span> <span class="n">reg_id</span><span class="p">);</span>
	<span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="n">value</span> <span class="o">&amp;</span> <span class="n">mask</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">old</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">mask</span><span class="p">);</span>
	<span class="n">writel</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">hdata</span><span class="o">-&gt;</span><span class="n">regs</span> <span class="o">+</span> <span class="n">reg_id</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">hdmi_v13_regs_dump</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">prefix</span><span class="p">)</span>
<span class="p">{</span>
<span class="cp">#define DUMPREG(reg_id) \</span>
<span class="cp">	DRM_DEBUG_KMS(&quot;%s:&quot; #reg_id &quot; = %08x\n&quot;, prefix, \</span>
<span class="cp">	readl(hdata-&gt;regs + reg_id))</span>
	<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;%s: ---- CONTROL REGISTERS ----</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">prefix</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_INTC_FLAG</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_INTC_CON</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_HPD_STATUS</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_PHY_RSTOUT</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_PHY_VPLL</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_PHY_CMU</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_CORE_RSTOUT</span><span class="p">);</span>

	<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;%s: ---- CORE REGISTERS ----</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">prefix</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_CON_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_CON_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_CON_2</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_SYS_STATUS</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_PHY_STATUS</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_STATUS_EN</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_HPD</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_MODE_SEL</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_HPD_GEN</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_DC_CONTROL</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_VIDEO_PATTERN_GEN</span><span class="p">);</span>

	<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;%s: ---- CORE SYNC REGISTERS ----</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">prefix</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_H_BLANK_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_H_BLANK_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_V_BLANK_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_V_BLANK_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_V_BLANK_2</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_H_V_LINE_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_H_V_LINE_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_H_V_LINE_2</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_VSYNC_POL</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_INT_PRO_MODE</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_V_BLANK_F_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_V_BLANK_F_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_V_BLANK_F_2</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_H_SYNC_GEN_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_H_SYNC_GEN_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_H_SYNC_GEN_2</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_V_SYNC_GEN_1_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_V_SYNC_GEN_1_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_V_SYNC_GEN_1_2</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_V_SYNC_GEN_2_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_V_SYNC_GEN_2_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_V_SYNC_GEN_2_2</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_V_SYNC_GEN_3_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_V_SYNC_GEN_3_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V13_V_SYNC_GEN_3_2</span><span class="p">);</span>

	<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;%s: ---- TG REGISTERS ----</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">prefix</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_CMD</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_H_FSZ_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_H_FSZ_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_HACT_ST_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_HACT_ST_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_HACT_SZ_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_HACT_SZ_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_V_FSZ_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_V_FSZ_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VSYNC_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VSYNC_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VSYNC2_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VSYNC2_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VACT_ST_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VACT_ST_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VACT_SZ_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VACT_SZ_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_FIELD_CHG_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_FIELD_CHG_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VACT_ST2_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VACT_ST2_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VSYNC_TOP_HDMI_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VSYNC_TOP_HDMI_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VSYNC_BOT_HDMI_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VSYNC_BOT_HDMI_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_FIELD_TOP_HDMI_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_FIELD_TOP_HDMI_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_FIELD_BOT_HDMI_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_FIELD_BOT_HDMI_H</span><span class="p">);</span>
<span class="cp">#undef DUMPREG</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">hdmi_v14_regs_dump</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">prefix</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

<span class="cp">#define DUMPREG(reg_id) \</span>
<span class="cp">	DRM_DEBUG_KMS(&quot;%s:&quot; #reg_id &quot; = %08x\n&quot;, prefix, \</span>
<span class="cp">	readl(hdata-&gt;regs + reg_id))</span>

	<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;%s: ---- CONTROL REGISTERS ----</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">prefix</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_INTC_CON</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_INTC_FLAG</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_HPD_STATUS</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_INTC_CON_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_INTC_FLAG_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_PHY_STATUS_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_PHY_STATUS_PLL</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_PHY_CON_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_PHY_RSTOUT</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_PHY_VPLL</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_PHY_CMU</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_CORE_RSTOUT</span><span class="p">);</span>

	<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;%s: ---- CORE REGISTERS ----</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">prefix</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_CON_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_CON_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_CON_2</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_SYS_STATUS</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_PHY_STATUS_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_STATUS_EN</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_HPD</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_MODE_SEL</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_ENC_EN</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_DC_CONTROL</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_VIDEO_PATTERN_GEN</span><span class="p">);</span>

	<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;%s: ---- CORE SYNC REGISTERS ----</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">prefix</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_H_BLANK_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_H_BLANK_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V2_BLANK_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V2_BLANK_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V1_BLANK_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V1_BLANK_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_LINE_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_LINE_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_H_LINE_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_H_LINE_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_HSYNC_POL</span><span class="p">);</span>

	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_VSYNC_POL</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_INT_PRO_MODE</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_BLANK_F0_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_BLANK_F0_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_BLANK_F1_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_BLANK_F1_1</span><span class="p">);</span>

	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_H_SYNC_START_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_H_SYNC_START_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_H_SYNC_END_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_H_SYNC_END_1</span><span class="p">);</span>

	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_BEF_2_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_BEF_2_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_BEF_1_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_BEF_1_1</span><span class="p">);</span>

	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_AFT_2_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_AFT_2_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_AFT_1_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_AFT_1_1</span><span class="p">);</span>

	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_AFT_PXL_2_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_AFT_PXL_2_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_AFT_PXL_1_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_AFT_PXL_1_1</span><span class="p">);</span>

	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_BLANK_F2_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_BLANK_F2_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_BLANK_F3_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_BLANK_F3_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_BLANK_F4_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_BLANK_F4_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_BLANK_F5_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_BLANK_F5_1</span><span class="p">);</span>

	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_AFT_3_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_AFT_3_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_AFT_4_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_AFT_4_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_AFT_5_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_AFT_5_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_AFT_6_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_AFT_6_1</span><span class="p">);</span>

	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_AFT_PXL_3_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_AFT_PXL_3_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_AFT_PXL_4_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_AFT_PXL_4_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_AFT_PXL_5_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_AFT_PXL_5_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_AFT_PXL_6_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_V_SYNC_LINE_AFT_PXL_6_1</span><span class="p">);</span>

	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_VACT_SPACE_1_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_VACT_SPACE_1_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_VACT_SPACE_2_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_VACT_SPACE_2_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_VACT_SPACE_3_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_VACT_SPACE_3_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_VACT_SPACE_4_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_VACT_SPACE_4_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_VACT_SPACE_5_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_VACT_SPACE_5_1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_VACT_SPACE_6_0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_VACT_SPACE_6_1</span><span class="p">);</span>

	<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;%s: ---- TG REGISTERS ----</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">prefix</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_CMD</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_H_FSZ_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_H_FSZ_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_HACT_ST_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_HACT_ST_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_HACT_SZ_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_HACT_SZ_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_V_FSZ_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_V_FSZ_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VSYNC_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VSYNC_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VSYNC2_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VSYNC2_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VACT_ST_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VACT_ST_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VACT_SZ_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VACT_SZ_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_FIELD_CHG_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_FIELD_CHG_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VACT_ST2_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VACT_ST2_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VACT_ST3_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VACT_ST3_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VACT_ST4_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VACT_ST4_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VSYNC_TOP_HDMI_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VSYNC_TOP_HDMI_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VSYNC_BOT_HDMI_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_VSYNC_BOT_HDMI_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_FIELD_TOP_HDMI_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_FIELD_TOP_HDMI_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_FIELD_BOT_HDMI_L</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_FIELD_BOT_HDMI_H</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_TG_3D</span><span class="p">);</span>

	<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;%s: ---- PACKET REGISTERS ----</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">prefix</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_AVI_CON</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_AVI_HEADER0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_AVI_HEADER1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_AVI_HEADER2</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_AVI_CHECK_SUM</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_VSI_CON</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_VSI_HEADER0</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_VSI_HEADER1</span><span class="p">);</span>
	<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_VSI_HEADER2</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="n">DUMPREG</span><span class="p">(</span><span class="n">HDMI_VSI_DATA</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>

<span class="cp">#undef DUMPREG</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">hdmi_regs_dump</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">prefix</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">is_v13</span><span class="p">)</span>
		<span class="n">hdmi_v13_regs_dump</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">prefix</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="n">hdmi_v14_regs_dump</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">prefix</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">hdmi_v13_conf_index</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_display_mode</span> <span class="o">*</span><span class="n">mode</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">hdmi_v13_confs</span><span class="p">);</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">hdmi_v13_confs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">width</span> <span class="o">==</span> <span class="n">mode</span><span class="o">-&gt;</span><span class="n">hdisplay</span> <span class="o">&amp;&amp;</span>
				<span class="n">hdmi_v13_confs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">height</span> <span class="o">==</span> <span class="n">mode</span><span class="o">-&gt;</span><span class="n">vdisplay</span> <span class="o">&amp;&amp;</span>
				<span class="n">hdmi_v13_confs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">vrefresh</span> <span class="o">==</span> <span class="n">mode</span><span class="o">-&gt;</span><span class="n">vrefresh</span> <span class="o">&amp;&amp;</span>
				<span class="n">hdmi_v13_confs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">interlace</span> <span class="o">==</span>
				<span class="p">((</span><span class="n">mode</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">DRM_MODE_FLAG_INTERLACE</span><span class="p">)</span> <span class="o">?</span>
				 <span class="nb">true</span> <span class="o">:</span> <span class="nb">false</span><span class="p">))</span>
			<span class="k">return</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">hdmi_v14_conf_index</span><span class="p">(</span><span class="k">struct</span> <span class="n">drm_display_mode</span> <span class="o">*</span><span class="n">mode</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">hdmi_confs</span><span class="p">);</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">hdmi_confs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">width</span> <span class="o">==</span> <span class="n">mode</span><span class="o">-&gt;</span><span class="n">hdisplay</span> <span class="o">&amp;&amp;</span>
				<span class="n">hdmi_confs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">height</span> <span class="o">==</span> <span class="n">mode</span><span class="o">-&gt;</span><span class="n">vdisplay</span> <span class="o">&amp;&amp;</span>
				<span class="n">hdmi_confs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">vrefresh</span> <span class="o">==</span> <span class="n">mode</span><span class="o">-&gt;</span><span class="n">vrefresh</span> <span class="o">&amp;&amp;</span>
				<span class="n">hdmi_confs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">interlace</span> <span class="o">==</span>
				<span class="p">((</span><span class="n">mode</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">DRM_MODE_FLAG_INTERLACE</span><span class="p">)</span> <span class="o">?</span>
				 <span class="nb">true</span> <span class="o">:</span> <span class="nb">false</span><span class="p">))</span>
			<span class="k">return</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">hdmi_conf_index</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span><span class="p">,</span>
			   <span class="k">struct</span> <span class="n">drm_display_mode</span> <span class="o">*</span><span class="n">mode</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">is_v13</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">hdmi_v13_conf_index</span><span class="p">(</span><span class="n">mode</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">hdmi_v14_conf_index</span><span class="p">(</span><span class="n">mode</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">bool</span> <span class="nf">hdmi_is_connected</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">ctx</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span> <span class="o">=</span> <span class="n">ctx</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">hdata</span><span class="o">-&gt;</span><span class="n">hpd</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">hdmi_get_edid</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">ctx</span><span class="p">,</span> <span class="k">struct</span> <span class="n">drm_connector</span> <span class="o">*</span><span class="n">connector</span><span class="p">,</span>
				<span class="n">u8</span> <span class="o">*</span><span class="n">edid</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">edid</span> <span class="o">*</span><span class="n">raw_edid</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span> <span class="o">=</span> <span class="n">ctx</span><span class="p">;</span>

	<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;[%d] %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">__LINE__</span><span class="p">,</span> <span class="n">__func__</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">ddc_port</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENODEV</span><span class="p">;</span>

	<span class="n">raw_edid</span> <span class="o">=</span> <span class="n">drm_get_edid</span><span class="p">(</span><span class="n">connector</span><span class="p">,</span> <span class="n">hdata</span><span class="o">-&gt;</span><span class="n">ddc_port</span><span class="o">-&gt;</span><span class="n">adapter</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">raw_edid</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">hdata</span><span class="o">-&gt;</span><span class="n">dvi_mode</span> <span class="o">=</span> <span class="o">!</span><span class="n">drm_detect_hdmi_monitor</span><span class="p">(</span><span class="n">raw_edid</span><span class="p">);</span>
		<span class="n">memcpy</span><span class="p">(</span><span class="n">edid</span><span class="p">,</span> <span class="n">raw_edid</span><span class="p">,</span> <span class="n">min</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">raw_edid</span><span class="o">-&gt;</span><span class="n">extensions</span><span class="p">)</span>
					<span class="o">*</span> <span class="n">EDID_LENGTH</span><span class="p">,</span> <span class="n">len</span><span class="p">));</span>
		<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;%s : width[%d] x height[%d]</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
			<span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">dvi_mode</span> <span class="o">?</span> <span class="s">&quot;dvi monitor&quot;</span> <span class="o">:</span> <span class="s">&quot;hdmi monitor&quot;</span><span class="p">),</span>
			<span class="n">raw_edid</span><span class="o">-&gt;</span><span class="n">width_cm</span><span class="p">,</span> <span class="n">raw_edid</span><span class="o">-&gt;</span><span class="n">height_cm</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENODEV</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">hdmi_v13_check_timing</span><span class="p">(</span><span class="k">struct</span> <span class="n">fb_videomode</span> <span class="o">*</span><span class="n">check_timing</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;valid mode : xres=%d, yres=%d, refresh=%d, intl=%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
			<span class="n">check_timing</span><span class="o">-&gt;</span><span class="n">xres</span><span class="p">,</span> <span class="n">check_timing</span><span class="o">-&gt;</span><span class="n">yres</span><span class="p">,</span>
			<span class="n">check_timing</span><span class="o">-&gt;</span><span class="n">refresh</span><span class="p">,</span> <span class="p">(</span><span class="n">check_timing</span><span class="o">-&gt;</span><span class="n">vmode</span> <span class="o">&amp;</span>
			<span class="n">FB_VMODE_INTERLACED</span><span class="p">)</span> <span class="o">?</span> <span class="nb">true</span> <span class="o">:</span> <span class="nb">false</span><span class="p">);</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">hdmi_v13_confs</span><span class="p">);</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">hdmi_v13_confs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">width</span> <span class="o">==</span> <span class="n">check_timing</span><span class="o">-&gt;</span><span class="n">xres</span> <span class="o">&amp;&amp;</span>
			<span class="n">hdmi_v13_confs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">height</span> <span class="o">==</span> <span class="n">check_timing</span><span class="o">-&gt;</span><span class="n">yres</span> <span class="o">&amp;&amp;</span>
			<span class="n">hdmi_v13_confs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">vrefresh</span> <span class="o">==</span> <span class="n">check_timing</span><span class="o">-&gt;</span><span class="n">refresh</span> <span class="o">&amp;&amp;</span>
			<span class="n">hdmi_v13_confs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">interlace</span> <span class="o">==</span>
			<span class="p">((</span><span class="n">check_timing</span><span class="o">-&gt;</span><span class="n">vmode</span> <span class="o">&amp;</span> <span class="n">FB_VMODE_INTERLACED</span><span class="p">)</span> <span class="o">?</span>
			 <span class="nb">true</span> <span class="o">:</span> <span class="nb">false</span><span class="p">))</span>
				<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="cm">/* TODO */</span>

	<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">hdmi_v14_check_timing</span><span class="p">(</span><span class="k">struct</span> <span class="n">fb_videomode</span> <span class="o">*</span><span class="n">check_timing</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;valid mode : xres=%d, yres=%d, refresh=%d, intl=%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
			<span class="n">check_timing</span><span class="o">-&gt;</span><span class="n">xres</span><span class="p">,</span> <span class="n">check_timing</span><span class="o">-&gt;</span><span class="n">yres</span><span class="p">,</span>
			<span class="n">check_timing</span><span class="o">-&gt;</span><span class="n">refresh</span><span class="p">,</span> <span class="p">(</span><span class="n">check_timing</span><span class="o">-&gt;</span><span class="n">vmode</span> <span class="o">&amp;</span>
			<span class="n">FB_VMODE_INTERLACED</span><span class="p">)</span> <span class="o">?</span> <span class="nb">true</span> <span class="o">:</span> <span class="nb">false</span><span class="p">);</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">hdmi_confs</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">hdmi_confs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">width</span> <span class="o">==</span> <span class="n">check_timing</span><span class="o">-&gt;</span><span class="n">xres</span> <span class="o">&amp;&amp;</span>
			<span class="n">hdmi_confs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">height</span> <span class="o">==</span> <span class="n">check_timing</span><span class="o">-&gt;</span><span class="n">yres</span> <span class="o">&amp;&amp;</span>
			<span class="n">hdmi_confs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">vrefresh</span> <span class="o">==</span> <span class="n">check_timing</span><span class="o">-&gt;</span><span class="n">refresh</span> <span class="o">&amp;&amp;</span>
			<span class="n">hdmi_confs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">interlace</span> <span class="o">==</span>
			<span class="p">((</span><span class="n">check_timing</span><span class="o">-&gt;</span><span class="n">vmode</span> <span class="o">&amp;</span> <span class="n">FB_VMODE_INTERLACED</span><span class="p">)</span> <span class="o">?</span>
			 <span class="nb">true</span> <span class="o">:</span> <span class="nb">false</span><span class="p">))</span>
				<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="cm">/* TODO */</span>

	<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">hdmi_check_timing</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">ctx</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">timing</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span> <span class="o">=</span> <span class="n">ctx</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">fb_videomode</span> <span class="o">*</span><span class="n">check_timing</span> <span class="o">=</span> <span class="n">timing</span><span class="p">;</span>

	<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;[%d] %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">__LINE__</span><span class="p">,</span> <span class="n">__func__</span><span class="p">);</span>

	<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;[%d]x[%d] [%d]Hz [%x]</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">check_timing</span><span class="o">-&gt;</span><span class="n">xres</span><span class="p">,</span>
			<span class="n">check_timing</span><span class="o">-&gt;</span><span class="n">yres</span><span class="p">,</span> <span class="n">check_timing</span><span class="o">-&gt;</span><span class="n">refresh</span><span class="p">,</span>
			<span class="n">check_timing</span><span class="o">-&gt;</span><span class="n">vmode</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">is_v13</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">hdmi_v13_check_timing</span><span class="p">(</span><span class="n">check_timing</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="k">return</span> <span class="n">hdmi_v14_check_timing</span><span class="p">(</span><span class="n">check_timing</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">hdmi_set_acr</span><span class="p">(</span><span class="n">u32</span> <span class="n">freq</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">acr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">n</span><span class="p">,</span> <span class="n">cts</span><span class="p">;</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">freq</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="mi">32000</span>:
		<span class="n">n</span> <span class="o">=</span> <span class="mi">4096</span><span class="p">;</span>
		<span class="n">cts</span> <span class="o">=</span> <span class="mi">27000</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">44100</span>:
		<span class="n">n</span> <span class="o">=</span> <span class="mi">6272</span><span class="p">;</span>
		<span class="n">cts</span> <span class="o">=</span> <span class="mi">30000</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">88200</span>:
		<span class="n">n</span> <span class="o">=</span> <span class="mi">12544</span><span class="p">;</span>
		<span class="n">cts</span> <span class="o">=</span> <span class="mi">30000</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">176400</span>:
		<span class="n">n</span> <span class="o">=</span> <span class="mi">25088</span><span class="p">;</span>
		<span class="n">cts</span> <span class="o">=</span> <span class="mi">30000</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">48000</span>:
		<span class="n">n</span> <span class="o">=</span> <span class="mi">6144</span><span class="p">;</span>
		<span class="n">cts</span> <span class="o">=</span> <span class="mi">27000</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">96000</span>:
		<span class="n">n</span> <span class="o">=</span> <span class="mi">12288</span><span class="p">;</span>
		<span class="n">cts</span> <span class="o">=</span> <span class="mi">27000</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">192000</span>:
		<span class="n">n</span> <span class="o">=</span> <span class="mi">24576</span><span class="p">;</span>
		<span class="n">cts</span> <span class="o">=</span> <span class="mi">27000</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">cts</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">acr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">cts</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">;</span>
	<span class="n">acr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">cts</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">;</span>
	<span class="n">acr</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">cts</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">;</span>

	<span class="n">acr</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">;</span>
	<span class="n">acr</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">;</span>
	<span class="n">acr</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">hdmi_reg_acr</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">acr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_ACR_N0</span><span class="p">,</span> <span class="n">acr</span><span class="p">[</span><span class="mi">6</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_ACR_N1</span><span class="p">,</span> <span class="n">acr</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_ACR_N2</span><span class="p">,</span> <span class="n">acr</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_ACR_MCTS0</span><span class="p">,</span> <span class="n">acr</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_ACR_MCTS1</span><span class="p">,</span> <span class="n">acr</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_ACR_MCTS2</span><span class="p">,</span> <span class="n">acr</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_ACR_CTS0</span><span class="p">,</span> <span class="n">acr</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_ACR_CTS1</span><span class="p">,</span> <span class="n">acr</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_ACR_CTS2</span><span class="p">,</span> <span class="n">acr</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">is_v13</span><span class="p">)</span>
		<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_ACR_CON</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_ACR_CON</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">hdmi_audio_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">sample_rate</span><span class="p">,</span> <span class="n">bits_per_sample</span><span class="p">,</span> <span class="n">frame_size_code</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">data_num</span><span class="p">,</span> <span class="n">bit_ch</span><span class="p">,</span> <span class="n">sample_frq</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">val</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">acr</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>

	<span class="n">sample_rate</span> <span class="o">=</span> <span class="mi">44100</span><span class="p">;</span>
	<span class="n">bits_per_sample</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>
	<span class="n">frame_size_code</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">bits_per_sample</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="mi">20</span>:
		<span class="n">data_num</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
		<span class="n">bit_ch</span>  <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">24</span>:
		<span class="n">data_num</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
		<span class="n">bit_ch</span>  <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="n">data_num</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">bit_ch</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">hdmi_set_acr</span><span class="p">(</span><span class="n">sample_rate</span><span class="p">,</span> <span class="n">acr</span><span class="p">);</span>
	<span class="n">hdmi_reg_acr</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">acr</span><span class="p">);</span>

	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_I2S_MUX_CON</span><span class="p">,</span> <span class="n">HDMI_I2S_IN_DISABLE</span>
				<span class="o">|</span> <span class="n">HDMI_I2S_AUD_I2S</span> <span class="o">|</span> <span class="n">HDMI_I2S_CUV_I2S_ENABLE</span>
				<span class="o">|</span> <span class="n">HDMI_I2S_MUX_ENABLE</span><span class="p">);</span>

	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_I2S_MUX_CH</span><span class="p">,</span> <span class="n">HDMI_I2S_CH0_EN</span>
			<span class="o">|</span> <span class="n">HDMI_I2S_CH1_EN</span> <span class="o">|</span> <span class="n">HDMI_I2S_CH2_EN</span><span class="p">);</span>

	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_I2S_MUX_CUV</span><span class="p">,</span> <span class="n">HDMI_I2S_CUV_RL_EN</span><span class="p">);</span>

	<span class="n">sample_frq</span> <span class="o">=</span> <span class="p">(</span><span class="n">sample_rate</span> <span class="o">==</span> <span class="mi">44100</span><span class="p">)</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span>
			<span class="p">(</span><span class="n">sample_rate</span> <span class="o">==</span> <span class="mi">48000</span><span class="p">)</span> <span class="o">?</span> <span class="mi">2</span> <span class="o">:</span>
			<span class="p">(</span><span class="n">sample_rate</span> <span class="o">==</span> <span class="mi">32000</span><span class="p">)</span> <span class="o">?</span> <span class="mi">3</span> <span class="o">:</span>
			<span class="p">(</span><span class="n">sample_rate</span> <span class="o">==</span> <span class="mi">96000</span><span class="p">)</span> <span class="o">?</span> <span class="mh">0xa</span> <span class="o">:</span> <span class="mh">0x0</span><span class="p">;</span>

	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_I2S_CLK_CON</span><span class="p">,</span> <span class="n">HDMI_I2S_CLK_DIS</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_I2S_CLK_CON</span><span class="p">,</span> <span class="n">HDMI_I2S_CLK_EN</span><span class="p">);</span>

	<span class="n">val</span> <span class="o">=</span> <span class="n">hdmi_reg_read</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_I2S_DSD_CON</span><span class="p">)</span> <span class="o">|</span> <span class="mh">0x01</span><span class="p">;</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_I2S_DSD_CON</span><span class="p">,</span> <span class="n">val</span><span class="p">);</span>

	<span class="cm">/* Configuration I2S input ports. Configure I2S_PIN_SEL_0~4 */</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_I2S_PIN_SEL_0</span><span class="p">,</span> <span class="n">HDMI_I2S_SEL_SCLK</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
			<span class="o">|</span> <span class="n">HDMI_I2S_SEL_LRCK</span><span class="p">(</span><span class="mi">6</span><span class="p">));</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_I2S_PIN_SEL_1</span><span class="p">,</span> <span class="n">HDMI_I2S_SEL_SDATA1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
			<span class="o">|</span> <span class="n">HDMI_I2S_SEL_SDATA2</span><span class="p">(</span><span class="mi">4</span><span class="p">));</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_I2S_PIN_SEL_2</span><span class="p">,</span> <span class="n">HDMI_I2S_SEL_SDATA3</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
			<span class="o">|</span> <span class="n">HDMI_I2S_SEL_SDATA2</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_I2S_PIN_SEL_3</span><span class="p">,</span> <span class="n">HDMI_I2S_SEL_DSD</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>

	<span class="cm">/* I2S_CON_1 &amp; 2 */</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_I2S_CON_1</span><span class="p">,</span> <span class="n">HDMI_I2S_SCLK_FALLING_EDGE</span>
			<span class="o">|</span> <span class="n">HDMI_I2S_L_CH_LOW_POL</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_I2S_CON_2</span><span class="p">,</span> <span class="n">HDMI_I2S_MSB_FIRST_MODE</span>
			<span class="o">|</span> <span class="n">HDMI_I2S_SET_BIT_CH</span><span class="p">(</span><span class="n">bit_ch</span><span class="p">)</span>
			<span class="o">|</span> <span class="n">HDMI_I2S_SET_SDATA_BIT</span><span class="p">(</span><span class="n">data_num</span><span class="p">)</span>
			<span class="o">|</span> <span class="n">HDMI_I2S_BASIC_FORMAT</span><span class="p">);</span>

	<span class="cm">/* Configure register related to CUV information */</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_I2S_CH_ST_0</span><span class="p">,</span> <span class="n">HDMI_I2S_CH_STATUS_MODE_0</span>
			<span class="o">|</span> <span class="n">HDMI_I2S_2AUD_CH_WITHOUT_PREEMPH</span>
			<span class="o">|</span> <span class="n">HDMI_I2S_COPYRIGHT</span>
			<span class="o">|</span> <span class="n">HDMI_I2S_LINEAR_PCM</span>
			<span class="o">|</span> <span class="n">HDMI_I2S_CONSUMER_FORMAT</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_I2S_CH_ST_1</span><span class="p">,</span> <span class="n">HDMI_I2S_CD_PLAYER</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_I2S_CH_ST_2</span><span class="p">,</span> <span class="n">HDMI_I2S_SET_SOURCE_NUM</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_I2S_CH_ST_3</span><span class="p">,</span> <span class="n">HDMI_I2S_CLK_ACCUR_LEVEL_2</span>
			<span class="o">|</span> <span class="n">HDMI_I2S_SET_SMP_FREQ</span><span class="p">(</span><span class="n">sample_frq</span><span class="p">));</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_I2S_CH_ST_4</span><span class="p">,</span>
			<span class="n">HDMI_I2S_ORG_SMP_FREQ_44_1</span>
			<span class="o">|</span> <span class="n">HDMI_I2S_WORD_LEN_MAX24_24BITS</span>
			<span class="o">|</span> <span class="n">HDMI_I2S_WORD_LEN_MAX_24BITS</span><span class="p">);</span>

	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_I2S_CH_ST_CON</span><span class="p">,</span> <span class="n">HDMI_I2S_CH_STATUS_RELOAD</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">hdmi_audio_control</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span><span class="p">,</span> <span class="n">bool</span> <span class="n">onoff</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">dvi_mode</span><span class="p">)</span>
		<span class="k">return</span><span class="p">;</span>

	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_AUI_CON</span><span class="p">,</span> <span class="n">onoff</span> <span class="o">?</span> <span class="mi">2</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">hdmi_reg_writemask</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_CON_0</span><span class="p">,</span> <span class="n">onoff</span> <span class="o">?</span>
			<span class="n">HDMI_ASP_EN</span> <span class="o">:</span> <span class="n">HDMI_ASP_DIS</span><span class="p">,</span> <span class="n">HDMI_ASP_MASK</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">hdmi_conf_reset</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">reg</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">is_v13</span><span class="p">)</span>
		<span class="n">reg</span> <span class="o">=</span> <span class="n">HDMI_V13_CORE_RSTOUT</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="n">reg</span> <span class="o">=</span> <span class="n">HDMI_CORE_RSTOUT</span><span class="p">;</span>

	<span class="cm">/* resetting HDMI core */</span>
	<span class="n">hdmi_reg_writemask</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="n">HDMI_CORE_SW_RSTOUT</span><span class="p">);</span>
	<span class="n">mdelay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
	<span class="n">hdmi_reg_writemask</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="o">~</span><span class="mi">0</span><span class="p">,</span> <span class="n">HDMI_CORE_SW_RSTOUT</span><span class="p">);</span>
	<span class="n">mdelay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">hdmi_conf_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span><span class="p">)</span>
<span class="p">{</span>
	<span class="cm">/* enable HPD interrupts */</span>
	<span class="n">hdmi_reg_writemask</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_INTC_CON</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDMI_INTC_EN_GLOBAL</span> <span class="o">|</span>
		<span class="n">HDMI_INTC_EN_HPD_PLUG</span> <span class="o">|</span> <span class="n">HDMI_INTC_EN_HPD_UNPLUG</span><span class="p">);</span>
	<span class="n">mdelay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
	<span class="n">hdmi_reg_writemask</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_INTC_CON</span><span class="p">,</span> <span class="o">~</span><span class="mi">0</span><span class="p">,</span> <span class="n">HDMI_INTC_EN_GLOBAL</span> <span class="o">|</span>
		<span class="n">HDMI_INTC_EN_HPD_PLUG</span> <span class="o">|</span> <span class="n">HDMI_INTC_EN_HPD_UNPLUG</span><span class="p">);</span>

	<span class="cm">/* choose HDMI mode */</span>
	<span class="n">hdmi_reg_writemask</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_MODE_SEL</span><span class="p">,</span>
		<span class="n">HDMI_MODE_HDMI_EN</span><span class="p">,</span> <span class="n">HDMI_MODE_MASK</span><span class="p">);</span>
	<span class="cm">/* disable bluescreen */</span>
	<span class="n">hdmi_reg_writemask</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_CON_0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDMI_BLUE_SCR_EN</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">dvi_mode</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* choose DVI mode */</span>
		<span class="n">hdmi_reg_writemask</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_MODE_SEL</span><span class="p">,</span>
				<span class="n">HDMI_MODE_DVI_EN</span><span class="p">,</span> <span class="n">HDMI_MODE_MASK</span><span class="p">);</span>
		<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_CON_2</span><span class="p">,</span>
				<span class="n">HDMI_VID_PREAMBLE_DIS</span> <span class="o">|</span> <span class="n">HDMI_GUARD_BAND_DIS</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">is_v13</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* choose bluescreen (fecal) color */</span>
		<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_BLUE_SCREEN_0</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">);</span>
		<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_BLUE_SCREEN_1</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">);</span>
		<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_BLUE_SCREEN_2</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">);</span>

		<span class="cm">/* enable AVI packet every vsync, fixes purple line problem */</span>
		<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_AVI_CON</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">);</span>
		<span class="cm">/* force RGB, look to CEA-861-D, table 7 for more detail */</span>
		<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_AVI_BYTE</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">0</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">);</span>
		<span class="n">hdmi_reg_writemask</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_CON_1</span><span class="p">,</span> <span class="mh">0x10</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">,</span> <span class="mh">0x11</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">);</span>

		<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_SPD_CON</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">);</span>
		<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_AUI_CON</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">);</span>
		<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_ACR_CON</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="cm">/* enable AVI packet every vsync, fixes purple line problem */</span>
		<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_AVI_CON</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">);</span>
		<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_AVI_BYTE</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">);</span>
		<span class="n">hdmi_reg_writemask</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_CON_1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">hdmi_v13_timing_apply</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">hdmi_v13_preset_conf</span> <span class="o">*</span><span class="n">conf</span> <span class="o">=</span>
		<span class="n">hdmi_v13_confs</span><span class="p">[</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">cur_conf</span><span class="p">].</span><span class="n">conf</span><span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">hdmi_v13_core_regs</span> <span class="o">*</span><span class="n">core</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">conf</span><span class="o">-&gt;</span><span class="n">core</span><span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">hdmi_v13_tg_regs</span> <span class="o">*</span><span class="n">tg</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">conf</span><span class="o">-&gt;</span><span class="n">tg</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">tries</span><span class="p">;</span>

	<span class="cm">/* setting core registers */</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_H_BLANK_0</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">h_blank</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_H_BLANK_1</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">h_blank</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_V_BLANK_0</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_blank</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_V_BLANK_1</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_blank</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_V_BLANK_2</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_blank</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_H_V_LINE_0</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">h_v_line</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_H_V_LINE_1</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">h_v_line</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_H_V_LINE_2</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">h_v_line</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_VSYNC_POL</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">vsync_pol</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_INT_PRO_MODE</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">int_pro_mode</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_V_BLANK_F_0</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_blank_f</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_V_BLANK_F_1</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_blank_f</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_V_BLANK_F_2</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_blank_f</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_H_SYNC_GEN_0</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">h_sync_gen</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_H_SYNC_GEN_1</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">h_sync_gen</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_H_SYNC_GEN_2</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">h_sync_gen</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_V_SYNC_GEN_1_0</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_gen1</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_V_SYNC_GEN_1_1</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_gen1</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_V_SYNC_GEN_1_2</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_gen1</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_V_SYNC_GEN_2_0</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_gen2</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_V_SYNC_GEN_2_1</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_gen2</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_V_SYNC_GEN_2_2</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_gen2</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_V_SYNC_GEN_3_0</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_gen3</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_V_SYNC_GEN_3_1</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_gen3</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_V_SYNC_GEN_3_2</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_gen3</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
	<span class="cm">/* Timing generator registers */</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_H_FSZ_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">h_fsz_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_H_FSZ_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">h_fsz_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_HACT_ST_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">hact_st_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_HACT_ST_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">hact_st_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_HACT_SZ_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">hact_sz_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_HACT_SZ_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">hact_sz_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_V_FSZ_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">v_fsz_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_V_FSZ_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">v_fsz_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VSYNC_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vsync_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VSYNC_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vsync_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VSYNC2_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vsync2_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VSYNC2_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vsync2_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VACT_ST_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vact_st_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VACT_ST_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vact_st_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VACT_SZ_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vact_sz_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VACT_SZ_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vact_sz_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_FIELD_CHG_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">field_chg_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_FIELD_CHG_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">field_chg_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VACT_ST2_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vact_st2_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VACT_ST2_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vact_st2_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VSYNC_TOP_HDMI_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vsync_top_hdmi_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VSYNC_TOP_HDMI_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vsync_top_hdmi_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VSYNC_BOT_HDMI_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vsync_bot_hdmi_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VSYNC_BOT_HDMI_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vsync_bot_hdmi_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_FIELD_TOP_HDMI_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">field_top_hdmi_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_FIELD_TOP_HDMI_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">field_top_hdmi_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_FIELD_BOT_HDMI_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">field_bot_hdmi_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_FIELD_BOT_HDMI_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">field_bot_hdmi_h</span><span class="p">);</span>

	<span class="cm">/* waiting for HDMIPHY&#39;s PLL to get to steady state */</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">tries</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="n">tries</span><span class="p">;</span> <span class="o">--</span><span class="n">tries</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">u32</span> <span class="n">val</span> <span class="o">=</span> <span class="n">hdmi_reg_read</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V13_PHY_STATUS</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">&amp;</span> <span class="n">HDMI_PHY_STATUS_READY</span><span class="p">)</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="n">mdelay</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="cm">/* steady state not achieved */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">tries</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DRM_ERROR</span><span class="p">(</span><span class="s">&quot;hdmiphy&#39;s pll could not reach steady state.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="n">hdmi_regs_dump</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="s">&quot;timing apply&quot;</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">clk_disable</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">res</span><span class="p">.</span><span class="n">sclk_hdmi</span><span class="p">);</span>
	<span class="n">clk_set_parent</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">res</span><span class="p">.</span><span class="n">sclk_hdmi</span><span class="p">,</span> <span class="n">hdata</span><span class="o">-&gt;</span><span class="n">res</span><span class="p">.</span><span class="n">sclk_hdmiphy</span><span class="p">);</span>
	<span class="n">clk_enable</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">res</span><span class="p">.</span><span class="n">sclk_hdmi</span><span class="p">);</span>

	<span class="cm">/* enable HDMI and timing generator */</span>
	<span class="n">hdmi_reg_writemask</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_CON_0</span><span class="p">,</span> <span class="o">~</span><span class="mi">0</span><span class="p">,</span> <span class="n">HDMI_EN</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">core</span><span class="o">-&gt;</span><span class="n">int_pro_mode</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
		<span class="n">hdmi_reg_writemask</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_CMD</span><span class="p">,</span> <span class="o">~</span><span class="mi">0</span><span class="p">,</span> <span class="n">HDMI_TG_EN</span> <span class="o">|</span>
				<span class="n">HDMI_FIELD_EN</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="n">hdmi_reg_writemask</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_CMD</span><span class="p">,</span> <span class="o">~</span><span class="mi">0</span><span class="p">,</span> <span class="n">HDMI_TG_EN</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">hdmi_v14_timing_apply</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">hdmi_preset_conf</span> <span class="o">*</span><span class="n">conf</span> <span class="o">=</span> <span class="n">hdmi_confs</span><span class="p">[</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">cur_conf</span><span class="p">].</span><span class="n">conf</span><span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">hdmi_core_regs</span> <span class="o">*</span><span class="n">core</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">conf</span><span class="o">-&gt;</span><span class="n">core</span><span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">hdmi_tg_regs</span> <span class="o">*</span><span class="n">tg</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">conf</span><span class="o">-&gt;</span><span class="n">tg</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">tries</span><span class="p">;</span>

	<span class="cm">/* setting core registers */</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_H_BLANK_0</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">h_blank</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_H_BLANK_1</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">h_blank</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V2_BLANK_0</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v2_blank</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V2_BLANK_1</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v2_blank</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V1_BLANK_0</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v1_blank</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V1_BLANK_1</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v1_blank</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_LINE_0</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_line</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_LINE_1</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_line</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_H_LINE_0</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">h_line</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_H_LINE_1</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">h_line</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_HSYNC_POL</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">hsync_pol</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_VSYNC_POL</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">vsync_pol</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_INT_PRO_MODE</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">int_pro_mode</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_BLANK_F0_0</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_blank_f0</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_BLANK_F0_1</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_blank_f0</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_BLANK_F1_0</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_blank_f1</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_BLANK_F1_1</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_blank_f1</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_H_SYNC_START_0</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">h_sync_start</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_H_SYNC_START_1</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">h_sync_start</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_H_SYNC_END_0</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">h_sync_end</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_H_SYNC_END_1</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">h_sync_end</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_BEF_2_0</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_bef_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_BEF_2_1</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_bef_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_BEF_1_0</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_bef_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_BEF_1_1</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_bef_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_AFT_2_0</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_aft_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_AFT_2_1</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_aft_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_AFT_1_0</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_aft_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_AFT_1_1</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_aft_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_AFT_PXL_2_0</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_aft_pxl_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_AFT_PXL_2_1</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_aft_pxl_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_AFT_PXL_1_0</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_aft_pxl_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_AFT_PXL_1_1</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_aft_pxl_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_BLANK_F2_0</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_blank_f2</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_BLANK_F2_1</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_blank_f2</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_BLANK_F3_0</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_blank_f3</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_BLANK_F3_1</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_blank_f3</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_BLANK_F4_0</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_blank_f4</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_BLANK_F4_1</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_blank_f4</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_BLANK_F5_0</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_blank_f5</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_BLANK_F5_1</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">v_blank_f5</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_AFT_3_0</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_aft_3</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_AFT_3_1</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_aft_3</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_AFT_4_0</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_aft_4</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_AFT_4_1</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_aft_4</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_AFT_5_0</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_aft_5</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_AFT_5_1</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_aft_5</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_AFT_6_0</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_aft_6</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_AFT_6_1</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_aft_6</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_AFT_PXL_3_0</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_aft_pxl_3</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_AFT_PXL_3_1</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_aft_pxl_3</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_AFT_PXL_4_0</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_aft_pxl_4</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_AFT_PXL_4_1</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_aft_pxl_4</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_AFT_PXL_5_0</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_aft_pxl_5</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_AFT_PXL_5_1</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_aft_pxl_5</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_AFT_PXL_6_0</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_aft_pxl_6</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_V_SYNC_LINE_AFT_PXL_6_1</span><span class="p">,</span>
			<span class="n">core</span><span class="o">-&gt;</span><span class="n">v_sync_line_aft_pxl_6</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_VACT_SPACE_1_0</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">vact_space_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_VACT_SPACE_1_1</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">vact_space_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_VACT_SPACE_2_0</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">vact_space_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_VACT_SPACE_2_1</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">vact_space_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_VACT_SPACE_3_0</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">vact_space_3</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_VACT_SPACE_3_1</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">vact_space_3</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_VACT_SPACE_4_0</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">vact_space_4</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_VACT_SPACE_4_1</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">vact_space_4</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_VACT_SPACE_5_0</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">vact_space_5</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_VACT_SPACE_5_1</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">vact_space_5</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_VACT_SPACE_6_0</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">vact_space_6</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_VACT_SPACE_6_1</span><span class="p">,</span> <span class="n">core</span><span class="o">-&gt;</span><span class="n">vact_space_6</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>

	<span class="cm">/* Timing generator registers */</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_H_FSZ_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">h_fsz_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_H_FSZ_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">h_fsz_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_HACT_ST_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">hact_st_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_HACT_ST_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">hact_st_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_HACT_SZ_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">hact_sz_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_HACT_SZ_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">hact_sz_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_V_FSZ_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">v_fsz_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_V_FSZ_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">v_fsz_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VSYNC_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vsync_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VSYNC_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vsync_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VSYNC2_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vsync2_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VSYNC2_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vsync2_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VACT_ST_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vact_st_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VACT_ST_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vact_st_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VACT_SZ_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vact_sz_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VACT_SZ_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vact_sz_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_FIELD_CHG_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">field_chg_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_FIELD_CHG_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">field_chg_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VACT_ST2_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vact_st2_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VACT_ST2_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vact_st2_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VACT_ST3_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vact_st3_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VACT_ST3_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vact_st3_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VACT_ST4_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vact_st4_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VACT_ST4_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vact_st4_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VSYNC_TOP_HDMI_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vsync_top_hdmi_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VSYNC_TOP_HDMI_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vsync_top_hdmi_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VSYNC_BOT_HDMI_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vsync_bot_hdmi_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_VSYNC_BOT_HDMI_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">vsync_bot_hdmi_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_FIELD_TOP_HDMI_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">field_top_hdmi_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_FIELD_TOP_HDMI_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">field_top_hdmi_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_FIELD_BOT_HDMI_L</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">field_bot_hdmi_l</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_FIELD_BOT_HDMI_H</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">field_bot_hdmi_h</span><span class="p">);</span>
	<span class="n">hdmi_reg_writeb</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_3D</span><span class="p">,</span> <span class="n">tg</span><span class="o">-&gt;</span><span class="n">tg_3d</span><span class="p">);</span>

	<span class="cm">/* waiting for HDMIPHY&#39;s PLL to get to steady state */</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">tries</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="n">tries</span><span class="p">;</span> <span class="o">--</span><span class="n">tries</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">u32</span> <span class="n">val</span> <span class="o">=</span> <span class="n">hdmi_reg_read</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_PHY_STATUS_0</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">&amp;</span> <span class="n">HDMI_PHY_STATUS_READY</span><span class="p">)</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="n">mdelay</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="cm">/* steady state not achieved */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">tries</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DRM_ERROR</span><span class="p">(</span><span class="s">&quot;hdmiphy&#39;s pll could not reach steady state.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="n">hdmi_regs_dump</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="s">&quot;timing apply&quot;</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">clk_disable</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">res</span><span class="p">.</span><span class="n">sclk_hdmi</span><span class="p">);</span>
	<span class="n">clk_set_parent</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">res</span><span class="p">.</span><span class="n">sclk_hdmi</span><span class="p">,</span> <span class="n">hdata</span><span class="o">-&gt;</span><span class="n">res</span><span class="p">.</span><span class="n">sclk_hdmiphy</span><span class="p">);</span>
	<span class="n">clk_enable</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">res</span><span class="p">.</span><span class="n">sclk_hdmi</span><span class="p">);</span>

	<span class="cm">/* enable HDMI and timing generator */</span>
	<span class="n">hdmi_reg_writemask</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_CON_0</span><span class="p">,</span> <span class="o">~</span><span class="mi">0</span><span class="p">,</span> <span class="n">HDMI_EN</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">core</span><span class="o">-&gt;</span><span class="n">int_pro_mode</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
		<span class="n">hdmi_reg_writemask</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_CMD</span><span class="p">,</span> <span class="o">~</span><span class="mi">0</span><span class="p">,</span> <span class="n">HDMI_TG_EN</span> <span class="o">|</span>
				<span class="n">HDMI_FIELD_EN</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="n">hdmi_reg_writemask</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_TG_CMD</span><span class="p">,</span> <span class="o">~</span><span class="mi">0</span><span class="p">,</span> <span class="n">HDMI_TG_EN</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">hdmi_timing_apply</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">is_v13</span><span class="p">)</span>
		<span class="n">hdmi_v13_timing_apply</span><span class="p">(</span><span class="n">hdata</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="n">hdmi_v14_timing_apply</span><span class="p">(</span><span class="n">hdata</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">hdmiphy_conf_reset</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u8</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">reg</span><span class="p">;</span>

	<span class="n">clk_disable</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">res</span><span class="p">.</span><span class="n">sclk_hdmi</span><span class="p">);</span>
	<span class="n">clk_set_parent</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">res</span><span class="p">.</span><span class="n">sclk_hdmi</span><span class="p">,</span> <span class="n">hdata</span><span class="o">-&gt;</span><span class="n">res</span><span class="p">.</span><span class="n">sclk_pixel</span><span class="p">);</span>
	<span class="n">clk_enable</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">res</span><span class="p">.</span><span class="n">sclk_hdmi</span><span class="p">);</span>

	<span class="cm">/* operation mode */</span>
	<span class="n">buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x1f</span><span class="p">;</span>
	<span class="n">buffer</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">hdmiphy_port</span><span class="p">)</span>
		<span class="n">i2c_master_send</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">hdmiphy_port</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">is_v13</span><span class="p">)</span>
		<span class="n">reg</span> <span class="o">=</span> <span class="n">HDMI_V13_PHY_RSTOUT</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="n">reg</span> <span class="o">=</span> <span class="n">HDMI_PHY_RSTOUT</span><span class="p">;</span>

	<span class="cm">/* reset hdmiphy */</span>
	<span class="n">hdmi_reg_writemask</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="o">~</span><span class="mi">0</span><span class="p">,</span> <span class="n">HDMI_PHY_SW_RSTOUT</span><span class="p">);</span>
	<span class="n">mdelay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
	<span class="n">hdmi_reg_writemask</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="n">HDMI_PHY_SW_RSTOUT</span><span class="p">);</span>
	<span class="n">mdelay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">hdmiphy_conf_apply</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">hdmiphy_data</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">operation</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">read_buffer</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="p">};</span>
	<span class="kt">int</span> <span class="n">ret</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">hdmiphy_port</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DRM_ERROR</span><span class="p">(</span><span class="s">&quot;hdmiphy is not attached</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="k">return</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="cm">/* pixel clock */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">is_v13</span><span class="p">)</span>
		<span class="n">hdmiphy_data</span> <span class="o">=</span> <span class="n">hdmi_v13_confs</span><span class="p">[</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">cur_conf</span><span class="p">].</span><span class="n">hdmiphy_data</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="n">hdmiphy_data</span> <span class="o">=</span> <span class="n">hdmi_confs</span><span class="p">[</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">cur_conf</span><span class="p">].</span><span class="n">hdmiphy_data</span><span class="p">;</span>

	<span class="n">memcpy</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">hdmiphy_data</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
	<span class="n">ret</span> <span class="o">=</span> <span class="n">i2c_master_send</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">hdmiphy_port</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">!=</span> <span class="mi">32</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DRM_ERROR</span><span class="p">(</span><span class="s">&quot;failed to configure HDMIPHY via I2C</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="k">return</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">mdelay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>

	<span class="cm">/* operation mode */</span>
	<span class="n">operation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x1f</span><span class="p">;</span>
	<span class="n">operation</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x80</span><span class="p">;</span>

	<span class="n">ret</span> <span class="o">=</span> <span class="n">i2c_master_send</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">hdmiphy_port</span><span class="p">,</span> <span class="n">operation</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DRM_ERROR</span><span class="p">(</span><span class="s">&quot;failed to enable hdmiphy</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="k">return</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">ret</span> <span class="o">=</span> <span class="n">i2c_master_recv</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">hdmiphy_port</span><span class="p">,</span> <span class="n">read_buffer</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DRM_ERROR</span><span class="p">(</span><span class="s">&quot;failed to read hdmiphy config</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="k">return</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ret</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
		<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;hdmiphy[0x%02x] write[0x%02x] - &quot;</span>
			<span class="s">&quot;recv [0x%02x]</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">buffer</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">read_buffer</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">hdmi_conf_apply</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;[%d] %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">__LINE__</span><span class="p">,</span> <span class="n">__func__</span><span class="p">);</span>

	<span class="n">hdmiphy_conf_reset</span><span class="p">(</span><span class="n">hdata</span><span class="p">);</span>
	<span class="n">hdmiphy_conf_apply</span><span class="p">(</span><span class="n">hdata</span><span class="p">);</span>

	<span class="n">mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">hdmi_mutex</span><span class="p">);</span>
	<span class="n">hdmi_conf_reset</span><span class="p">(</span><span class="n">hdata</span><span class="p">);</span>
	<span class="n">hdmi_conf_init</span><span class="p">(</span><span class="n">hdata</span><span class="p">);</span>
	<span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">hdmi_mutex</span><span class="p">);</span>

	<span class="n">hdmi_audio_init</span><span class="p">(</span><span class="n">hdata</span><span class="p">);</span>

	<span class="cm">/* setting core registers */</span>
	<span class="n">hdmi_timing_apply</span><span class="p">(</span><span class="n">hdata</span><span class="p">);</span>
	<span class="n">hdmi_audio_control</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>

	<span class="n">hdmi_regs_dump</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="s">&quot;start&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">hdmi_mode_fixup</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">ctx</span><span class="p">,</span> <span class="k">struct</span> <span class="n">drm_connector</span> <span class="o">*</span><span class="n">connector</span><span class="p">,</span>
				<span class="k">struct</span> <span class="n">drm_display_mode</span> <span class="o">*</span><span class="n">mode</span><span class="p">,</span>
				<span class="k">struct</span> <span class="n">drm_display_mode</span> <span class="o">*</span><span class="n">adjusted_mode</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">drm_display_mode</span> <span class="o">*</span><span class="n">m</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span> <span class="o">=</span> <span class="n">ctx</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">index</span><span class="p">;</span>

	<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;[%d] %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">__LINE__</span><span class="p">,</span> <span class="n">__func__</span><span class="p">);</span>

	<span class="n">drm_mode_set_crtcinfo</span><span class="p">(</span><span class="n">adjusted_mode</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">is_v13</span><span class="p">)</span>
		<span class="n">index</span> <span class="o">=</span> <span class="n">hdmi_v13_conf_index</span><span class="p">(</span><span class="n">adjusted_mode</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="n">index</span> <span class="o">=</span> <span class="n">hdmi_v14_conf_index</span><span class="p">(</span><span class="n">adjusted_mode</span><span class="p">);</span>

	<span class="cm">/* just return if user desired mode exists. */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span><span class="p">;</span>

	<span class="cm">/*</span>
<span class="cm">	 * otherwise, find the most suitable mode among modes and change it</span>
<span class="cm">	 * to adjusted_mode.</span>
<span class="cm">	 */</span>
	<span class="n">list_for_each_entry</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">connector</span><span class="o">-&gt;</span><span class="n">modes</span><span class="p">,</span> <span class="n">head</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">is_v13</span><span class="p">)</span>
			<span class="n">index</span> <span class="o">=</span> <span class="n">hdmi_v13_conf_index</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
		<span class="k">else</span>
			<span class="n">index</span> <span class="o">=</span> <span class="n">hdmi_v14_conf_index</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">DRM_INFO</span><span class="p">(</span><span class="s">&quot;desired mode doesn&#39;t exist so</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
			<span class="n">DRM_INFO</span><span class="p">(</span><span class="s">&quot;use the most suitable mode among modes.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
			<span class="n">memcpy</span><span class="p">(</span><span class="n">adjusted_mode</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">));</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">hdmi_mode_set</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">ctx</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">mode</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span> <span class="o">=</span> <span class="n">ctx</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">conf_idx</span><span class="p">;</span>

	<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;[%d] %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">__LINE__</span><span class="p">,</span> <span class="n">__func__</span><span class="p">);</span>

	<span class="n">conf_idx</span> <span class="o">=</span> <span class="n">hdmi_conf_index</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">mode</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">conf_idx</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">hdata</span><span class="o">-&gt;</span><span class="n">cur_conf</span> <span class="o">=</span> <span class="n">conf_idx</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;not supported mode</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">hdmi_get_max_resol</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">ctx</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">width</span><span class="p">,</span>
					<span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">height</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;[%d] %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">__LINE__</span><span class="p">,</span> <span class="n">__func__</span><span class="p">);</span>

	<span class="o">*</span><span class="n">width</span> <span class="o">=</span> <span class="n">MAX_WIDTH</span><span class="p">;</span>
	<span class="o">*</span><span class="n">height</span> <span class="o">=</span> <span class="n">MAX_HEIGHT</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">hdmi_commit</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">ctx</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span> <span class="o">=</span> <span class="n">ctx</span><span class="p">;</span>

	<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;[%d] %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">__LINE__</span><span class="p">,</span> <span class="n">__func__</span><span class="p">);</span>

	<span class="n">hdmi_conf_apply</span><span class="p">(</span><span class="n">hdata</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">hdmi_poweron</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hdmi_resources</span> <span class="o">*</span><span class="n">res</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">res</span><span class="p">;</span>

	<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;[%d] %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">__LINE__</span><span class="p">,</span> <span class="n">__func__</span><span class="p">);</span>

	<span class="n">mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">hdmi_mutex</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">powered</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">hdmi_mutex</span><span class="p">);</span>
		<span class="k">return</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">hdata</span><span class="o">-&gt;</span><span class="n">powered</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">cfg_hpd</span><span class="p">)</span>
		<span class="n">hdata</span><span class="o">-&gt;</span><span class="n">cfg_hpd</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
	<span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">hdmi_mutex</span><span class="p">);</span>

	<span class="n">pm_runtime_get_sync</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">);</span>

	<span class="n">regulator_bulk_enable</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">regul_count</span><span class="p">,</span> <span class="n">res</span><span class="o">-&gt;</span><span class="n">regul_bulk</span><span class="p">);</span>
	<span class="n">clk_enable</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">hdmiphy</span><span class="p">);</span>
	<span class="n">clk_enable</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">hdmi</span><span class="p">);</span>
	<span class="n">clk_enable</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">sclk_hdmi</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">hdmi_poweroff</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hdmi_resources</span> <span class="o">*</span><span class="n">res</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">res</span><span class="p">;</span>

	<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;[%d] %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">__LINE__</span><span class="p">,</span> <span class="n">__func__</span><span class="p">);</span>

	<span class="n">mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">hdmi_mutex</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">powered</span><span class="p">)</span>
		<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>
	<span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">hdmi_mutex</span><span class="p">);</span>

	<span class="cm">/*</span>
<span class="cm">	 * The TV power domain needs any condition of hdmiphy to turn off and</span>
<span class="cm">	 * its reset state seems to meet the condition.</span>
<span class="cm">	 */</span>
	<span class="n">hdmiphy_conf_reset</span><span class="p">(</span><span class="n">hdata</span><span class="p">);</span>

	<span class="n">clk_disable</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">sclk_hdmi</span><span class="p">);</span>
	<span class="n">clk_disable</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">hdmi</span><span class="p">);</span>
	<span class="n">clk_disable</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">hdmiphy</span><span class="p">);</span>
	<span class="n">regulator_bulk_disable</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">regul_count</span><span class="p">,</span> <span class="n">res</span><span class="o">-&gt;</span><span class="n">regul_bulk</span><span class="p">);</span>

	<span class="n">pm_runtime_put_sync</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">);</span>

	<span class="n">mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">hdmi_mutex</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">cfg_hpd</span><span class="p">)</span>
		<span class="n">hdata</span><span class="o">-&gt;</span><span class="n">cfg_hpd</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>

	<span class="n">hdata</span><span class="o">-&gt;</span><span class="n">powered</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>

<span class="nl">out:</span>
	<span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">hdmi_mutex</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">hdmi_dpms</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">ctx</span><span class="p">,</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span> <span class="o">=</span> <span class="n">ctx</span><span class="p">;</span>

	<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;[%d] %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">__LINE__</span><span class="p">,</span> <span class="n">__func__</span><span class="p">);</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">mode</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">DRM_MODE_DPMS_ON</span>:
		<span class="n">hdmi_poweron</span><span class="p">(</span><span class="n">hdata</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">DRM_MODE_DPMS_STANDBY</span>:
	<span class="k">case</span> <span class="n">DRM_MODE_DPMS_SUSPEND</span>:
	<span class="k">case</span> <span class="n">DRM_MODE_DPMS_OFF</span>:
		<span class="n">hdmi_poweroff</span><span class="p">(</span><span class="n">hdata</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;unknown dpms mode: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">exynos_hdmi_ops</span> <span class="n">hdmi_ops</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* display */</span>
	<span class="p">.</span><span class="n">is_connected</span>	<span class="o">=</span> <span class="n">hdmi_is_connected</span><span class="p">,</span>
	<span class="p">.</span><span class="n">get_edid</span>	<span class="o">=</span> <span class="n">hdmi_get_edid</span><span class="p">,</span>
	<span class="p">.</span><span class="n">check_timing</span>	<span class="o">=</span> <span class="n">hdmi_check_timing</span><span class="p">,</span>

	<span class="cm">/* manager */</span>
	<span class="p">.</span><span class="n">mode_fixup</span>	<span class="o">=</span> <span class="n">hdmi_mode_fixup</span><span class="p">,</span>
	<span class="p">.</span><span class="n">mode_set</span>	<span class="o">=</span> <span class="n">hdmi_mode_set</span><span class="p">,</span>
	<span class="p">.</span><span class="n">get_max_resol</span>	<span class="o">=</span> <span class="n">hdmi_get_max_resol</span><span class="p">,</span>
	<span class="p">.</span><span class="n">commit</span>		<span class="o">=</span> <span class="n">hdmi_commit</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dpms</span>		<span class="o">=</span> <span class="n">hdmi_dpms</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="n">irqreturn_t</span> <span class="nf">hdmi_external_irq_thread</span><span class="p">(</span><span class="kt">int</span> <span class="n">irq</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">arg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">exynos_drm_hdmi_context</span> <span class="o">*</span><span class="n">ctx</span> <span class="o">=</span> <span class="n">arg</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">ctx</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">get_hpd</span><span class="p">)</span>
		<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>

	<span class="n">mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">hdmi_mutex</span><span class="p">);</span>
	<span class="n">hdata</span><span class="o">-&gt;</span><span class="n">hpd</span> <span class="o">=</span> <span class="n">hdata</span><span class="o">-&gt;</span><span class="n">get_hpd</span><span class="p">();</span>
	<span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">hdmi_mutex</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">drm_dev</span><span class="p">)</span>
		<span class="n">drm_helper_hpd_irq_event</span><span class="p">(</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">drm_dev</span><span class="p">);</span>

<span class="nl">out:</span>
	<span class="k">return</span> <span class="n">IRQ_HANDLED</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">irqreturn_t</span> <span class="nf">hdmi_internal_irq_thread</span><span class="p">(</span><span class="kt">int</span> <span class="n">irq</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">arg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">exynos_drm_hdmi_context</span> <span class="o">*</span><span class="n">ctx</span> <span class="o">=</span> <span class="n">arg</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">ctx</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">intc_flag</span><span class="p">;</span>

	<span class="n">intc_flag</span> <span class="o">=</span> <span class="n">hdmi_reg_read</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_INTC_FLAG</span><span class="p">);</span>
	<span class="cm">/* clearing flags for HPD plug/unplug */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">intc_flag</span> <span class="o">&amp;</span> <span class="n">HDMI_INTC_FLAG_HPD_UNPLUG</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;unplugged</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="n">hdmi_reg_writemask</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_INTC_FLAG</span><span class="p">,</span> <span class="o">~</span><span class="mi">0</span><span class="p">,</span>
			<span class="n">HDMI_INTC_FLAG_HPD_UNPLUG</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">intc_flag</span> <span class="o">&amp;</span> <span class="n">HDMI_INTC_FLAG_HPD_PLUG</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;plugged</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="n">hdmi_reg_writemask</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_INTC_FLAG</span><span class="p">,</span> <span class="o">~</span><span class="mi">0</span><span class="p">,</span>
			<span class="n">HDMI_INTC_FLAG_HPD_PLUG</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">hdmi_mutex</span><span class="p">);</span>
	<span class="n">hdata</span><span class="o">-&gt;</span><span class="n">hpd</span> <span class="o">=</span> <span class="n">hdmi_reg_read</span><span class="p">(</span><span class="n">hdata</span><span class="p">,</span> <span class="n">HDMI_HPD_STATUS</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">powered</span> <span class="o">&amp;&amp;</span> <span class="n">hdata</span><span class="o">-&gt;</span><span class="n">hpd</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">hdmi_mutex</span><span class="p">);</span>
		<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">hdmi_mutex</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">drm_dev</span><span class="p">)</span>
		<span class="n">drm_helper_hpd_irq_event</span><span class="p">(</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">drm_dev</span><span class="p">);</span>

<span class="nl">out:</span>
	<span class="k">return</span> <span class="n">IRQ_HANDLED</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="n">__devinit</span> <span class="nf">hdmi_resources_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span> <span class="o">=</span> <span class="n">hdata</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hdmi_resources</span> <span class="o">*</span><span class="n">res</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">res</span><span class="p">;</span>
	<span class="k">static</span> <span class="kt">char</span> <span class="o">*</span><span class="n">supply</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
		<span class="s">&quot;hdmi-en&quot;</span><span class="p">,</span>
		<span class="s">&quot;vdd&quot;</span><span class="p">,</span>
		<span class="s">&quot;vdd_osc&quot;</span><span class="p">,</span>
		<span class="s">&quot;vdd_pll&quot;</span><span class="p">,</span>
	<span class="p">};</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">ret</span><span class="p">;</span>

	<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;HDMI resource init</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

	<span class="n">memset</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span> <span class="o">*</span><span class="n">res</span><span class="p">);</span>

	<span class="cm">/* get clocks, power */</span>
	<span class="n">res</span><span class="o">-&gt;</span><span class="n">hdmi</span> <span class="o">=</span> <span class="n">clk_get</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;hdmi&quot;</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">IS_ERR_OR_NULL</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">hdmi</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">DRM_ERROR</span><span class="p">(</span><span class="s">&quot;failed to get clock &#39;hdmi&#39;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="k">goto</span> <span class="n">fail</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">res</span><span class="o">-&gt;</span><span class="n">sclk_hdmi</span> <span class="o">=</span> <span class="n">clk_get</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;sclk_hdmi&quot;</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">IS_ERR_OR_NULL</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">sclk_hdmi</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">DRM_ERROR</span><span class="p">(</span><span class="s">&quot;failed to get clock &#39;sclk_hdmi&#39;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="k">goto</span> <span class="n">fail</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">res</span><span class="o">-&gt;</span><span class="n">sclk_pixel</span> <span class="o">=</span> <span class="n">clk_get</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;sclk_pixel&quot;</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">IS_ERR_OR_NULL</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">sclk_pixel</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">DRM_ERROR</span><span class="p">(</span><span class="s">&quot;failed to get clock &#39;sclk_pixel&#39;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="k">goto</span> <span class="n">fail</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">res</span><span class="o">-&gt;</span><span class="n">sclk_hdmiphy</span> <span class="o">=</span> <span class="n">clk_get</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;sclk_hdmiphy&quot;</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">IS_ERR_OR_NULL</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">sclk_hdmiphy</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">DRM_ERROR</span><span class="p">(</span><span class="s">&quot;failed to get clock &#39;sclk_hdmiphy&#39;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="k">goto</span> <span class="n">fail</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">res</span><span class="o">-&gt;</span><span class="n">hdmiphy</span> <span class="o">=</span> <span class="n">clk_get</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;hdmiphy&quot;</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">IS_ERR_OR_NULL</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">hdmiphy</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">DRM_ERROR</span><span class="p">(</span><span class="s">&quot;failed to get clock &#39;hdmiphy&#39;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="k">goto</span> <span class="n">fail</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">clk_set_parent</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">sclk_hdmi</span><span class="p">,</span> <span class="n">res</span><span class="o">-&gt;</span><span class="n">sclk_pixel</span><span class="p">);</span>

	<span class="n">res</span><span class="o">-&gt;</span><span class="n">regul_bulk</span> <span class="o">=</span> <span class="n">kzalloc</span><span class="p">(</span><span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">supply</span><span class="p">)</span> <span class="o">*</span>
		<span class="k">sizeof</span> <span class="n">res</span><span class="o">-&gt;</span><span class="n">regul_bulk</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">GFP_KERNEL</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">regul_bulk</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DRM_ERROR</span><span class="p">(</span><span class="s">&quot;failed to get memory for regulators</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="k">goto</span> <span class="n">fail</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">supply</span><span class="p">);</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">res</span><span class="o">-&gt;</span><span class="n">regul_bulk</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">supply</span> <span class="o">=</span> <span class="n">supply</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="n">res</span><span class="o">-&gt;</span><span class="n">regul_bulk</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">consumer</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">ret</span> <span class="o">=</span> <span class="n">regulator_bulk_get</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">supply</span><span class="p">),</span> <span class="n">res</span><span class="o">-&gt;</span><span class="n">regul_bulk</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DRM_ERROR</span><span class="p">(</span><span class="s">&quot;failed to get regulators</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="k">goto</span> <span class="n">fail</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">res</span><span class="o">-&gt;</span><span class="n">regul_count</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">supply</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="nl">fail:</span>
	<span class="n">DRM_ERROR</span><span class="p">(</span><span class="s">&quot;HDMI resource init - failed</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="k">return</span> <span class="o">-</span><span class="n">ENODEV</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">hdmi_resources_cleanup</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hdmi_resources</span> <span class="o">*</span><span class="n">res</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">res</span><span class="p">;</span>

	<span class="n">regulator_bulk_free</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">regul_count</span><span class="p">,</span> <span class="n">res</span><span class="o">-&gt;</span><span class="n">regul_bulk</span><span class="p">);</span>
	<span class="cm">/* kfree is NULL-safe */</span>
	<span class="n">kfree</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">regul_bulk</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">IS_ERR_OR_NULL</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">hdmiphy</span><span class="p">))</span>
		<span class="n">clk_put</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">hdmiphy</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">IS_ERR_OR_NULL</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">sclk_hdmiphy</span><span class="p">))</span>
		<span class="n">clk_put</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">sclk_hdmiphy</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">IS_ERR_OR_NULL</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">sclk_pixel</span><span class="p">))</span>
		<span class="n">clk_put</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">sclk_pixel</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">IS_ERR_OR_NULL</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">sclk_hdmi</span><span class="p">))</span>
		<span class="n">clk_put</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">sclk_hdmi</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">IS_ERR_OR_NULL</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">hdmi</span><span class="p">))</span>
		<span class="n">clk_put</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">hdmi</span><span class="p">);</span>
	<span class="n">memset</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span> <span class="o">*</span><span class="n">res</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">i2c_client</span> <span class="o">*</span><span class="n">hdmi_ddc</span><span class="p">,</span> <span class="o">*</span><span class="n">hdmi_hdmiphy</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">hdmi_attach_ddc_client</span><span class="p">(</span><span class="k">struct</span> <span class="n">i2c_client</span> <span class="o">*</span><span class="n">ddc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ddc</span><span class="p">)</span>
		<span class="n">hdmi_ddc</span> <span class="o">=</span> <span class="n">ddc</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">hdmi_attach_hdmiphy_client</span><span class="p">(</span><span class="k">struct</span> <span class="n">i2c_client</span> <span class="o">*</span><span class="n">hdmiphy</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">hdmiphy</span><span class="p">)</span>
		<span class="n">hdmi_hdmiphy</span> <span class="o">=</span> <span class="n">hdmiphy</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="n">__devinit</span> <span class="nf">hdmi_probe</span><span class="p">(</span><span class="k">struct</span> <span class="n">platform_device</span> <span class="o">*</span><span class="n">pdev</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">pdev</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">exynos_drm_hdmi_context</span> <span class="o">*</span><span class="n">drm_hdmi_ctx</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">exynos_drm_hdmi_pdata</span> <span class="o">*</span><span class="n">pdata</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">resource</span> <span class="o">*</span><span class="n">res</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">ret</span><span class="p">;</span>

	<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;[%d]</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">__LINE__</span><span class="p">);</span>

	<span class="n">pdata</span> <span class="o">=</span> <span class="n">pdev</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">.</span><span class="n">platform_data</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">pdata</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DRM_ERROR</span><span class="p">(</span><span class="s">&quot;no platform data specified</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">drm_hdmi_ctx</span> <span class="o">=</span> <span class="n">kzalloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">drm_hdmi_ctx</span><span class="p">),</span> <span class="n">GFP_KERNEL</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">drm_hdmi_ctx</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DRM_ERROR</span><span class="p">(</span><span class="s">&quot;failed to allocate common hdmi context.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">hdata</span> <span class="o">=</span> <span class="n">kzalloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_context</span><span class="p">),</span> <span class="n">GFP_KERNEL</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">hdata</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DRM_ERROR</span><span class="p">(</span><span class="s">&quot;out of memory</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="n">kfree</span><span class="p">(</span><span class="n">drm_hdmi_ctx</span><span class="p">);</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">mutex_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">hdmi_mutex</span><span class="p">);</span>

	<span class="n">drm_hdmi_ctx</span><span class="o">-&gt;</span><span class="n">ctx</span> <span class="o">=</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="n">hdata</span><span class="p">;</span>
	<span class="n">hdata</span><span class="o">-&gt;</span><span class="n">parent_ctx</span> <span class="o">=</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="n">drm_hdmi_ctx</span><span class="p">;</span>

	<span class="n">platform_set_drvdata</span><span class="p">(</span><span class="n">pdev</span><span class="p">,</span> <span class="n">drm_hdmi_ctx</span><span class="p">);</span>

	<span class="n">hdata</span><span class="o">-&gt;</span><span class="n">is_v13</span> <span class="o">=</span> <span class="n">pdata</span><span class="o">-&gt;</span><span class="n">is_v13</span><span class="p">;</span>
	<span class="n">hdata</span><span class="o">-&gt;</span><span class="n">cfg_hpd</span> <span class="o">=</span> <span class="n">pdata</span><span class="o">-&gt;</span><span class="n">cfg_hpd</span><span class="p">;</span>
	<span class="n">hdata</span><span class="o">-&gt;</span><span class="n">get_hpd</span> <span class="o">=</span> <span class="n">pdata</span><span class="o">-&gt;</span><span class="n">get_hpd</span><span class="p">;</span>
	<span class="n">hdata</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">dev</span><span class="p">;</span>

	<span class="n">ret</span> <span class="o">=</span> <span class="n">hdmi_resources_init</span><span class="p">(</span><span class="n">hdata</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ret</span> <span class="o">=</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
		<span class="k">goto</span> <span class="n">err_data</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">res</span> <span class="o">=</span> <span class="n">platform_get_resource</span><span class="p">(</span><span class="n">pdev</span><span class="p">,</span> <span class="n">IORESOURCE_MEM</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">res</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DRM_ERROR</span><span class="p">(</span><span class="s">&quot;failed to find registers</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="n">ret</span> <span class="o">=</span> <span class="o">-</span><span class="n">ENOENT</span><span class="p">;</span>
		<span class="k">goto</span> <span class="n">err_resource</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">hdata</span><span class="o">-&gt;</span><span class="n">regs_res</span> <span class="o">=</span> <span class="n">request_mem_region</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">,</span> <span class="n">resource_size</span><span class="p">(</span><span class="n">res</span><span class="p">),</span>
					   <span class="n">dev_name</span><span class="p">(</span><span class="n">dev</span><span class="p">));</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">regs_res</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DRM_ERROR</span><span class="p">(</span><span class="s">&quot;failed to claim register region</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="n">ret</span> <span class="o">=</span> <span class="o">-</span><span class="n">ENOENT</span><span class="p">;</span>
		<span class="k">goto</span> <span class="n">err_resource</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">hdata</span><span class="o">-&gt;</span><span class="n">regs</span> <span class="o">=</span> <span class="n">ioremap</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">,</span> <span class="n">resource_size</span><span class="p">(</span><span class="n">res</span><span class="p">));</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">regs</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DRM_ERROR</span><span class="p">(</span><span class="s">&quot;failed to map registers</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="n">ret</span> <span class="o">=</span> <span class="o">-</span><span class="n">ENXIO</span><span class="p">;</span>
		<span class="k">goto</span> <span class="n">err_req_region</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="cm">/* DDC i2c driver */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">i2c_add_driver</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ddc_driver</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">DRM_ERROR</span><span class="p">(</span><span class="s">&quot;failed to register ddc i2c driver</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="n">ret</span> <span class="o">=</span> <span class="o">-</span><span class="n">ENOENT</span><span class="p">;</span>
		<span class="k">goto</span> <span class="n">err_iomap</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">hdata</span><span class="o">-&gt;</span><span class="n">ddc_port</span> <span class="o">=</span> <span class="n">hdmi_ddc</span><span class="p">;</span>

	<span class="cm">/* hdmiphy i2c driver */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">i2c_add_driver</span><span class="p">(</span><span class="o">&amp;</span><span class="n">hdmiphy_driver</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">DRM_ERROR</span><span class="p">(</span><span class="s">&quot;failed to register hdmiphy i2c driver</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="n">ret</span> <span class="o">=</span> <span class="o">-</span><span class="n">ENOENT</span><span class="p">;</span>
		<span class="k">goto</span> <span class="n">err_ddc</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">hdata</span><span class="o">-&gt;</span><span class="n">hdmiphy_port</span> <span class="o">=</span> <span class="n">hdmi_hdmiphy</span><span class="p">;</span>

	<span class="n">hdata</span><span class="o">-&gt;</span><span class="n">external_irq</span> <span class="o">=</span> <span class="n">platform_get_irq_byname</span><span class="p">(</span><span class="n">pdev</span><span class="p">,</span> <span class="s">&quot;external_irq&quot;</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">external_irq</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DRM_ERROR</span><span class="p">(</span><span class="s">&quot;failed to get platform irq</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="n">ret</span> <span class="o">=</span> <span class="n">hdata</span><span class="o">-&gt;</span><span class="n">external_irq</span><span class="p">;</span>
		<span class="k">goto</span> <span class="n">err_hdmiphy</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">hdata</span><span class="o">-&gt;</span><span class="n">internal_irq</span> <span class="o">=</span> <span class="n">platform_get_irq_byname</span><span class="p">(</span><span class="n">pdev</span><span class="p">,</span> <span class="s">&quot;internal_irq&quot;</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">internal_irq</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DRM_ERROR</span><span class="p">(</span><span class="s">&quot;failed to get platform internal irq</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="n">ret</span> <span class="o">=</span> <span class="n">hdata</span><span class="o">-&gt;</span><span class="n">internal_irq</span><span class="p">;</span>
		<span class="k">goto</span> <span class="n">err_hdmiphy</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">ret</span> <span class="o">=</span> <span class="n">request_threaded_irq</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">external_irq</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span>
			<span class="n">hdmi_external_irq_thread</span><span class="p">,</span> <span class="n">IRQF_TRIGGER_RISING</span> <span class="o">|</span>
			<span class="n">IRQF_TRIGGER_FALLING</span> <span class="o">|</span> <span class="n">IRQF_ONESHOT</span><span class="p">,</span>
			<span class="s">&quot;hdmi_external&quot;</span><span class="p">,</span> <span class="n">drm_hdmi_ctx</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DRM_ERROR</span><span class="p">(</span><span class="s">&quot;failed to register hdmi internal interrupt</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="k">goto</span> <span class="n">err_hdmiphy</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">cfg_hpd</span><span class="p">)</span>
		<span class="n">hdata</span><span class="o">-&gt;</span><span class="n">cfg_hpd</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>

	<span class="n">ret</span> <span class="o">=</span> <span class="n">request_threaded_irq</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">internal_irq</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span>
			<span class="n">hdmi_internal_irq_thread</span><span class="p">,</span> <span class="n">IRQF_ONESHOT</span><span class="p">,</span>
			<span class="s">&quot;hdmi_internal&quot;</span><span class="p">,</span> <span class="n">drm_hdmi_ctx</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DRM_ERROR</span><span class="p">(</span><span class="s">&quot;failed to register hdmi internal interrupt</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="k">goto</span> <span class="n">err_free_irq</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="cm">/* register specific callbacks to common hdmi. */</span>
	<span class="n">exynos_hdmi_ops_register</span><span class="p">(</span><span class="o">&amp;</span><span class="n">hdmi_ops</span><span class="p">);</span>

	<span class="n">pm_runtime_enable</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

<span class="nl">err_free_irq:</span>
	<span class="n">free_irq</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">external_irq</span><span class="p">,</span> <span class="n">drm_hdmi_ctx</span><span class="p">);</span>
<span class="nl">err_hdmiphy:</span>
	<span class="n">i2c_del_driver</span><span class="p">(</span><span class="o">&amp;</span><span class="n">hdmiphy_driver</span><span class="p">);</span>
<span class="nl">err_ddc:</span>
	<span class="n">i2c_del_driver</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ddc_driver</span><span class="p">);</span>
<span class="nl">err_iomap:</span>
	<span class="n">iounmap</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">regs</span><span class="p">);</span>
<span class="nl">err_req_region:</span>
	<span class="n">release_mem_region</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">regs_res</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">,</span>
			<span class="n">resource_size</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">regs_res</span><span class="p">));</span>
<span class="nl">err_resource:</span>
	<span class="n">hdmi_resources_cleanup</span><span class="p">(</span><span class="n">hdata</span><span class="p">);</span>
<span class="nl">err_data:</span>
	<span class="n">kfree</span><span class="p">(</span><span class="n">hdata</span><span class="p">);</span>
	<span class="n">kfree</span><span class="p">(</span><span class="n">drm_hdmi_ctx</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="n">__devexit</span> <span class="nf">hdmi_remove</span><span class="p">(</span><span class="k">struct</span> <span class="n">platform_device</span> <span class="o">*</span><span class="n">pdev</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">pdev</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">exynos_drm_hdmi_context</span> <span class="o">*</span><span class="n">ctx</span> <span class="o">=</span> <span class="n">platform_get_drvdata</span><span class="p">(</span><span class="n">pdev</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">ctx</span><span class="p">;</span>

	<span class="n">DRM_DEBUG_KMS</span><span class="p">(</span><span class="s">&quot;[%d] %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">__LINE__</span><span class="p">,</span> <span class="n">__func__</span><span class="p">);</span>

	<span class="n">pm_runtime_disable</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>

	<span class="n">free_irq</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">internal_irq</span><span class="p">,</span> <span class="n">hdata</span><span class="p">);</span>

	<span class="n">hdmi_resources_cleanup</span><span class="p">(</span><span class="n">hdata</span><span class="p">);</span>

	<span class="n">iounmap</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">regs</span><span class="p">);</span>

	<span class="n">release_mem_region</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">regs_res</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">,</span>
			<span class="n">resource_size</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">regs_res</span><span class="p">));</span>

	<span class="cm">/* hdmiphy i2c driver */</span>
	<span class="n">i2c_del_driver</span><span class="p">(</span><span class="o">&amp;</span><span class="n">hdmiphy_driver</span><span class="p">);</span>
	<span class="cm">/* DDC i2c driver */</span>
	<span class="n">i2c_del_driver</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ddc_driver</span><span class="p">);</span>

	<span class="n">kfree</span><span class="p">(</span><span class="n">hdata</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#ifdef CONFIG_PM_SLEEP</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">hdmi_suspend</span><span class="p">(</span><span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">exynos_drm_hdmi_context</span> <span class="o">*</span><span class="n">ctx</span> <span class="o">=</span> <span class="n">get_hdmi_context</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">ctx</span><span class="p">;</span>

	<span class="n">disable_irq</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">internal_irq</span><span class="p">);</span>
	<span class="n">disable_irq</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">external_irq</span><span class="p">);</span>

	<span class="n">hdata</span><span class="o">-&gt;</span><span class="n">hpd</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">drm_dev</span><span class="p">)</span>
		<span class="n">drm_helper_hpd_irq_event</span><span class="p">(</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">drm_dev</span><span class="p">);</span>

	<span class="n">hdmi_poweroff</span><span class="p">(</span><span class="n">hdata</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">hdmi_resume</span><span class="p">(</span><span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">exynos_drm_hdmi_context</span> <span class="o">*</span><span class="n">ctx</span> <span class="o">=</span> <span class="n">get_hdmi_context</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">hdmi_context</span> <span class="o">*</span><span class="n">hdata</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">ctx</span><span class="p">;</span>

	<span class="n">enable_irq</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">external_irq</span><span class="p">);</span>
	<span class="n">enable_irq</span><span class="p">(</span><span class="n">hdata</span><span class="o">-&gt;</span><span class="n">internal_irq</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">#endif</span>

<span class="k">static</span> <span class="n">SIMPLE_DEV_PM_OPS</span><span class="p">(</span><span class="n">hdmi_pm_ops</span><span class="p">,</span> <span class="n">hdmi_suspend</span><span class="p">,</span> <span class="n">hdmi_resume</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">platform_driver</span> <span class="n">hdmi_driver</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">probe</span>		<span class="o">=</span> <span class="n">hdmi_probe</span><span class="p">,</span>
	<span class="p">.</span><span class="n">remove</span>		<span class="o">=</span> <span class="n">__devexit_p</span><span class="p">(</span><span class="n">hdmi_remove</span><span class="p">),</span>
	<span class="p">.</span><span class="n">driver</span>		<span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">name</span>	<span class="o">=</span> <span class="s">&quot;exynos4-hdmi&quot;</span><span class="p">,</span>
		<span class="p">.</span><span class="n">owner</span>	<span class="o">=</span> <span class="n">THIS_MODULE</span><span class="p">,</span>
		<span class="p">.</span><span class="n">pm</span>	<span class="o">=</span> <span class="o">&amp;</span><span class="n">hdmi_pm_ops</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
