<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › misc › ibmasm › remote.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>remote.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * IBM ASM Service Processor Device Driver</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> * it under the terms of the GNU General Public License as published by</span>
<span class="cm"> * the Free Software Foundation; either version 2 of the License, or</span>
<span class="cm"> * (at your option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful,</span>
<span class="cm"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm"> * GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License</span>
<span class="cm"> * along with this program; if not, write to the Free Software</span>
<span class="cm"> * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) IBM Corporation, 2004</span>
<span class="cm"> *</span>
<span class="cm"> * Author: Max Asböck &lt;amax@us.ibm.com&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * Originally written by Pete Reynolds</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _IBMASM_REMOTE_H_</span>
<span class="cp">#define _IBMASM_REMOTE_H_</span>

<span class="cp">#include &lt;asm/io.h&gt;</span>

<span class="cm">/* pci offsets */</span>
<span class="cp">#define CONDOR_MOUSE_DATA		0x000AC000</span>
<span class="cp">#define CONDOR_MOUSE_ISR_CONTROL	0x00</span>
<span class="cp">#define CONDOR_MOUSE_ISR_STATUS		0x04</span>
<span class="cp">#define CONDOR_MOUSE_Q_READER		0x08</span>
<span class="cp">#define CONDOR_MOUSE_Q_WRITER		0x0C</span>
<span class="cp">#define CONDOR_MOUSE_Q_BEGIN		0x10</span>
<span class="cp">#define CONDOR_MOUSE_MAX_X		0x14</span>
<span class="cp">#define CONDOR_MOUSE_MAX_Y		0x18</span>

<span class="cp">#define CONDOR_INPUT_DESKTOP_INFO	0x1F0</span>
<span class="cp">#define CONDOR_INPUT_DISPLAY_RESX	0x1F4</span>
<span class="cp">#define CONDOR_INPUT_DISPLAY_RESY	0x1F8</span>
<span class="cp">#define CONDOR_INPUT_DISPLAY_BITS	0x1FC</span>
<span class="cp">#define CONDOR_OUTPUT_VNC_STATUS	0x200</span>

<span class="cp">#define CONDOR_MOUSE_INTR_STATUS_MASK	0x00000001</span>

<span class="cp">#define INPUT_TYPE_MOUSE	0x1</span>
<span class="cp">#define INPUT_TYPE_KEYBOARD	0x2</span>


<span class="cm">/* mouse button states received from SP */</span>
<span class="cp">#define REMOTE_DOUBLE_CLICK	0xF0</span>
<span class="cp">#define REMOTE_BUTTON_LEFT	0x01</span>
<span class="cp">#define REMOTE_BUTTON_MIDDLE	0x02</span>
<span class="cp">#define REMOTE_BUTTON_RIGHT	0x04</span>

<span class="cm">/* size of keysym/keycode translation matricies */</span>
<span class="cp">#define XLATE_SIZE 256</span>

<span class="k">struct</span> <span class="n">mouse_input</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">short</span>	<span class="n">y</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span>	<span class="n">x</span><span class="p">;</span>
<span class="p">};</span>


<span class="k">struct</span> <span class="n">keyboard_input</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">short</span>	<span class="n">key_code</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">key_flag</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">key_down</span><span class="p">;</span>
<span class="p">};</span>



<span class="k">struct</span> <span class="n">remote_input</span> <span class="p">{</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="n">mouse_input</span>	<span class="n">mouse</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">keyboard_input</span>	<span class="n">keyboard</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">data</span><span class="p">;</span>

	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">type</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">pad1</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">mouse_buttons</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">pad3</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define mouse_addr(sp)		(sp-&gt;base_address + CONDOR_MOUSE_DATA)</span>
<span class="cp">#define display_width(sp)	(mouse_addr(sp) + CONDOR_INPUT_DISPLAY_RESX)</span>
<span class="cp">#define display_height(sp)	(mouse_addr(sp) + CONDOR_INPUT_DISPLAY_RESY)</span>
<span class="cp">#define display_depth(sp)	(mouse_addr(sp) + CONDOR_INPUT_DISPLAY_BITS)</span>
<span class="cp">#define desktop_info(sp)	(mouse_addr(sp) + CONDOR_INPUT_DESKTOP_INFO)</span>
<span class="cp">#define vnc_status(sp)		(mouse_addr(sp) + CONDOR_OUTPUT_VNC_STATUS)</span>
<span class="cp">#define isr_control(sp)		(mouse_addr(sp) + CONDOR_MOUSE_ISR_CONTROL)</span>

<span class="cp">#define mouse_interrupt_pending(sp)	readl(mouse_addr(sp) + CONDOR_MOUSE_ISR_STATUS)</span>
<span class="cp">#define clear_mouse_interrupt(sp)	writel(0, mouse_addr(sp) + CONDOR_MOUSE_ISR_STATUS)</span>
<span class="cp">#define enable_mouse_interrupts(sp)	writel(1, mouse_addr(sp) + CONDOR_MOUSE_ISR_CONTROL)</span>
<span class="cp">#define disable_mouse_interrupts(sp)	writel(0, mouse_addr(sp) + CONDOR_MOUSE_ISR_CONTROL)</span>

<span class="cm">/* remote input queue operations */</span>
<span class="cp">#define REMOTE_QUEUE_SIZE	60</span>

<span class="cp">#define get_queue_writer(sp)	readl(mouse_addr(sp) + CONDOR_MOUSE_Q_WRITER)</span>
<span class="cp">#define get_queue_reader(sp)	readl(mouse_addr(sp) + CONDOR_MOUSE_Q_READER)</span>
<span class="cp">#define set_queue_reader(sp, reader)	writel(reader, mouse_addr(sp) + CONDOR_MOUSE_Q_READER)</span>

<span class="cp">#define queue_begin	(mouse_addr(sp) + CONDOR_MOUSE_Q_BEGIN)</span>

<span class="cp">#define get_queue_entry(sp, read_index) \</span>
<span class="cp">	((void*)(queue_begin + read_index * sizeof(struct remote_input)))</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">advance_queue_reader</span><span class="p">(</span><span class="k">struct</span> <span class="n">service_processor</span> <span class="o">*</span><span class="n">sp</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">reader</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">reader</span><span class="o">++</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">reader</span> <span class="o">==</span> <span class="n">REMOTE_QUEUE_SIZE</span><span class="p">)</span>
		<span class="n">reader</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">set_queue_reader</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="n">reader</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">reader</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#define NO_KEYCODE 0</span>
<span class="cp">#define KEY_SYM_BK_SPC   0xFF08</span>
<span class="cp">#define KEY_SYM_TAB      0xFF09</span>
<span class="cp">#define KEY_SYM_ENTER    0xFF0D</span>
<span class="cp">#define KEY_SYM_SCR_LOCK 0xFF14</span>
<span class="cp">#define KEY_SYM_ESCAPE   0xFF1B</span>
<span class="cp">#define KEY_SYM_HOME     0xFF50</span>
<span class="cp">#define KEY_SYM_LARROW   0xFF51</span>
<span class="cp">#define KEY_SYM_UARROW   0xFF52</span>
<span class="cp">#define KEY_SYM_RARROW   0xFF53</span>
<span class="cp">#define KEY_SYM_DARROW   0xFF54</span>
<span class="cp">#define KEY_SYM_PAGEUP   0xFF55</span>
<span class="cp">#define KEY_SYM_PAGEDOWN 0xFF56</span>
<span class="cp">#define KEY_SYM_END      0xFF57</span>
<span class="cp">#define KEY_SYM_INSERT   0xFF63</span>
<span class="cp">#define KEY_SYM_NUM_LOCK 0xFF7F</span>
<span class="cp">#define KEY_SYM_KPSTAR   0xFFAA</span>
<span class="cp">#define KEY_SYM_KPPLUS   0xFFAB</span>
<span class="cp">#define KEY_SYM_KPMINUS  0xFFAD</span>
<span class="cp">#define KEY_SYM_KPDOT    0xFFAE</span>
<span class="cp">#define KEY_SYM_KPSLASH  0xFFAF</span>
<span class="cp">#define KEY_SYM_KPRIGHT  0xFF96</span>
<span class="cp">#define KEY_SYM_KPUP     0xFF97</span>
<span class="cp">#define KEY_SYM_KPLEFT   0xFF98</span>
<span class="cp">#define KEY_SYM_KPDOWN   0xFF99</span>
<span class="cp">#define KEY_SYM_KP0      0xFFB0</span>
<span class="cp">#define KEY_SYM_KP1      0xFFB1</span>
<span class="cp">#define KEY_SYM_KP2      0xFFB2</span>
<span class="cp">#define KEY_SYM_KP3      0xFFB3</span>
<span class="cp">#define KEY_SYM_KP4      0xFFB4</span>
<span class="cp">#define KEY_SYM_KP5      0xFFB5</span>
<span class="cp">#define KEY_SYM_KP6      0xFFB6</span>
<span class="cp">#define KEY_SYM_KP7      0xFFB7</span>
<span class="cp">#define KEY_SYM_KP8      0xFFB8</span>
<span class="cp">#define KEY_SYM_KP9      0xFFB9</span>
<span class="cp">#define KEY_SYM_F1       0xFFBE      </span><span class="c1">// 1B 5B 5B 41</span>
<span class="cp">#define KEY_SYM_F2       0xFFBF      </span><span class="c1">// 1B 5B 5B 42</span>
<span class="cp">#define KEY_SYM_F3       0xFFC0      </span><span class="c1">// 1B 5B 5B 43</span>
<span class="cp">#define KEY_SYM_F4       0xFFC1      </span><span class="c1">// 1B 5B 5B 44</span>
<span class="cp">#define KEY_SYM_F5       0xFFC2      </span><span class="c1">// 1B 5B 5B 45</span>
<span class="cp">#define KEY_SYM_F6       0xFFC3      </span><span class="c1">// 1B 5B 31 37 7E</span>
<span class="cp">#define KEY_SYM_F7       0xFFC4      </span><span class="c1">// 1B 5B 31 38 7E</span>
<span class="cp">#define KEY_SYM_F8       0xFFC5      </span><span class="c1">// 1B 5B 31 39 7E</span>
<span class="cp">#define KEY_SYM_F9       0xFFC6      </span><span class="c1">// 1B 5B 32 30 7E</span>
<span class="cp">#define KEY_SYM_F10      0xFFC7      </span><span class="c1">// 1B 5B 32 31 7E</span>
<span class="cp">#define KEY_SYM_F11      0xFFC8      </span><span class="c1">// 1B 5B 32 33 7E</span>
<span class="cp">#define KEY_SYM_F12      0xFFC9      </span><span class="c1">// 1B 5B 32 34 7E</span>
<span class="cp">#define KEY_SYM_SHIFT    0xFFE1</span>
<span class="cp">#define KEY_SYM_CTRL     0xFFE3</span>
<span class="cp">#define KEY_SYM_ALT      0xFFE9</span>
<span class="cp">#define KEY_SYM_CAP_LOCK 0xFFE5</span>
<span class="cp">#define KEY_SYM_DELETE   0xFFFF</span>
<span class="cp">#define KEY_SYM_TILDE    0x60</span>
<span class="cp">#define KEY_SYM_BKTIC    0x7E</span>
<span class="cp">#define KEY_SYM_ONE      0x31</span>
<span class="cp">#define KEY_SYM_BANG     0x21</span>
<span class="cp">#define KEY_SYM_TWO      0x32</span>
<span class="cp">#define KEY_SYM_AT       0x40</span>
<span class="cp">#define KEY_SYM_THREE    0x33</span>
<span class="cp">#define KEY_SYM_POUND    0x23</span>
<span class="cp">#define KEY_SYM_FOUR     0x34</span>
<span class="cp">#define KEY_SYM_DOLLAR   0x24</span>
<span class="cp">#define KEY_SYM_FIVE     0x35</span>
<span class="cp">#define KEY_SYM_PERCENT  0x25</span>
<span class="cp">#define KEY_SYM_SIX      0x36</span>
<span class="cp">#define KEY_SYM_CARAT    0x5E</span>
<span class="cp">#define KEY_SYM_SEVEN    0x37</span>
<span class="cp">#define KEY_SYM_AMPER    0x26</span>
<span class="cp">#define KEY_SYM_EIGHT    0x38</span>
<span class="cp">#define KEY_SYM_STAR     0x2A</span>
<span class="cp">#define KEY_SYM_NINE     0x39</span>
<span class="cp">#define KEY_SYM_LPAREN   0x28</span>
<span class="cp">#define KEY_SYM_ZERO     0x30</span>
<span class="cp">#define KEY_SYM_RPAREN   0x29</span>
<span class="cp">#define KEY_SYM_MINUS    0x2D</span>
<span class="cp">#define KEY_SYM_USCORE   0x5F</span>
<span class="cp">#define KEY_SYM_EQUAL    0x2B</span>
<span class="cp">#define KEY_SYM_PLUS     0x3D</span>
<span class="cp">#define KEY_SYM_LBRKT    0x5B</span>
<span class="cp">#define KEY_SYM_LCURLY   0x7B</span>
<span class="cp">#define KEY_SYM_RBRKT    0x5D</span>
<span class="cp">#define KEY_SYM_RCURLY   0x7D</span>
<span class="cp">#define KEY_SYM_SLASH    0x5C</span>
<span class="cp">#define KEY_SYM_PIPE     0x7C</span>
<span class="cp">#define KEY_SYM_TIC      0x27</span>
<span class="cp">#define KEY_SYM_QUOTE    0x22</span>
<span class="cp">#define KEY_SYM_SEMIC    0x3B</span>
<span class="cp">#define KEY_SYM_COLON    0x3A</span>
<span class="cp">#define KEY_SYM_COMMA    0x2C</span>
<span class="cp">#define KEY_SYM_LT       0x3C</span>
<span class="cp">#define KEY_SYM_PERIOD   0x2E</span>
<span class="cp">#define KEY_SYM_GT       0x3E</span>
<span class="cp">#define KEY_SYM_BSLASH   0x2F</span>
<span class="cp">#define KEY_SYM_QMARK    0x3F</span>
<span class="cp">#define KEY_SYM_A        0x41</span>
<span class="cp">#define KEY_SYM_B        0x42</span>
<span class="cp">#define KEY_SYM_C        0x43</span>
<span class="cp">#define KEY_SYM_D        0x44</span>
<span class="cp">#define KEY_SYM_E        0x45</span>
<span class="cp">#define KEY_SYM_F        0x46</span>
<span class="cp">#define KEY_SYM_G        0x47</span>
<span class="cp">#define KEY_SYM_H        0x48</span>
<span class="cp">#define KEY_SYM_I        0x49</span>
<span class="cp">#define KEY_SYM_J        0x4A</span>
<span class="cp">#define KEY_SYM_K        0x4B</span>
<span class="cp">#define KEY_SYM_L        0x4C</span>
<span class="cp">#define KEY_SYM_M        0x4D</span>
<span class="cp">#define KEY_SYM_N        0x4E</span>
<span class="cp">#define KEY_SYM_O        0x4F</span>
<span class="cp">#define KEY_SYM_P        0x50</span>
<span class="cp">#define KEY_SYM_Q        0x51</span>
<span class="cp">#define KEY_SYM_R        0x52</span>
<span class="cp">#define KEY_SYM_S        0x53</span>
<span class="cp">#define KEY_SYM_T        0x54</span>
<span class="cp">#define KEY_SYM_U        0x55</span>
<span class="cp">#define KEY_SYM_V        0x56</span>
<span class="cp">#define KEY_SYM_W        0x57</span>
<span class="cp">#define KEY_SYM_X        0x58</span>
<span class="cp">#define KEY_SYM_Y        0x59</span>
<span class="cp">#define KEY_SYM_Z        0x5A</span>
<span class="cp">#define KEY_SYM_a        0x61</span>
<span class="cp">#define KEY_SYM_b        0x62</span>
<span class="cp">#define KEY_SYM_c        0x63</span>
<span class="cp">#define KEY_SYM_d        0x64</span>
<span class="cp">#define KEY_SYM_e        0x65</span>
<span class="cp">#define KEY_SYM_f        0x66</span>
<span class="cp">#define KEY_SYM_g        0x67</span>
<span class="cp">#define KEY_SYM_h        0x68</span>
<span class="cp">#define KEY_SYM_i        0x69</span>
<span class="cp">#define KEY_SYM_j        0x6A</span>
<span class="cp">#define KEY_SYM_k        0x6B</span>
<span class="cp">#define KEY_SYM_l        0x6C</span>
<span class="cp">#define KEY_SYM_m        0x6D</span>
<span class="cp">#define KEY_SYM_n        0x6E</span>
<span class="cp">#define KEY_SYM_o        0x6F</span>
<span class="cp">#define KEY_SYM_p        0x70</span>
<span class="cp">#define KEY_SYM_q        0x71</span>
<span class="cp">#define KEY_SYM_r        0x72</span>
<span class="cp">#define KEY_SYM_s        0x73</span>
<span class="cp">#define KEY_SYM_t        0x74</span>
<span class="cp">#define KEY_SYM_u        0x75</span>
<span class="cp">#define KEY_SYM_v        0x76</span>
<span class="cp">#define KEY_SYM_w        0x77</span>
<span class="cp">#define KEY_SYM_x        0x78</span>
<span class="cp">#define KEY_SYM_y        0x79</span>
<span class="cp">#define KEY_SYM_z        0x7A</span>
<span class="cp">#define KEY_SYM_SPACE    0x20</span>
<span class="cp">#endif </span><span class="cm">/* _IBMASM_REMOTE_H_ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
