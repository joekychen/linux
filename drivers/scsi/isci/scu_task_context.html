<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › scsi › isci › scu_task_context.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>scu_task_context.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * This file is provided under a dual BSD/GPLv2 license.  When using or</span>
<span class="cm"> * redistributing this file, you may do so under either license.</span>
<span class="cm"> *</span>
<span class="cm"> * GPL LICENSE SUMMARY</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright(c) 2008 - 2011 Intel Corporation. All rights reserved.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> * it under the terms of version 2 of the GNU General Public License as</span>
<span class="cm"> * published by the Free Software Foundation.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful, but</span>
<span class="cm"> * WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<span class="cm"> * General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License</span>
<span class="cm"> * along with this program; if not, write to the Free Software</span>
<span class="cm"> * Foundation, Inc., 51 Franklin St - Fifth Floor, Boston, MA 02110-1301 USA.</span>
<span class="cm"> * The full GNU General Public License is included in this distribution</span>
<span class="cm"> * in the file called LICENSE.GPL.</span>
<span class="cm"> *</span>
<span class="cm"> * BSD LICENSE</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright(c) 2008 - 2011 Intel Corporation. All rights reserved.</span>
<span class="cm"> * All rights reserved.</span>
<span class="cm"> *</span>
<span class="cm"> * Redistribution and use in source and binary forms, with or without</span>
<span class="cm"> * modification, are permitted provided that the following conditions</span>
<span class="cm"> * are met:</span>
<span class="cm"> *</span>
<span class="cm"> *   * Redistributions of source code must retain the above copyright</span>
<span class="cm"> *     notice, this list of conditions and the following disclaimer.</span>
<span class="cm"> *   * Redistributions in binary form must reproduce the above copyright</span>
<span class="cm"> *     notice, this list of conditions and the following disclaimer in</span>
<span class="cm"> *     the documentation and/or other materials provided with the</span>
<span class="cm"> *     distribution.</span>
<span class="cm"> *   * Neither the name of Intel Corporation nor the names of its</span>
<span class="cm"> *     contributors may be used to endorse or promote products derived</span>
<span class="cm"> *     from this software without specific prior written permission.</span>
<span class="cm"> *</span>
<span class="cm"> * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
<span class="cm"> * &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
<span class="cm"> * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
<span class="cm"> * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span>
<span class="cm"> * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
<span class="cm"> * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span>
<span class="cm"> * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<span class="cm"> * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
<span class="cm"> * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<span class="cm"> * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="cm"> * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _SCU_TASK_CONTEXT_H_</span>
<span class="cp">#define _SCU_TASK_CONTEXT_H_</span>

<span class="cm">/**</span>
<span class="cm"> * This file contains the structures and constants for the SCU hardware task</span>
<span class="cm"> *    context.</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> */</span>


<span class="cm">/**</span>
<span class="cm"> * enum scu_ssp_task_type - This enumberation defines the various SSP task</span>
<span class="cm"> *    types the SCU hardware will accept. The definition for the various task</span>
<span class="cm"> *    types the SCU hardware will accept can be found in the DS specification.</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>
	<span class="n">SCU_TASK_TYPE_IOREAD</span><span class="p">,</span>           <span class="cm">/* /&lt; IO READ direction or no direction */</span>
	<span class="n">SCU_TASK_TYPE_IOWRITE</span><span class="p">,</span>          <span class="cm">/* /&lt; IO Write direction */</span>
	<span class="n">SCU_TASK_TYPE_SMP_REQUEST</span><span class="p">,</span>      <span class="cm">/* /&lt; SMP Request type */</span>
	<span class="n">SCU_TASK_TYPE_RESPONSE</span><span class="p">,</span>         <span class="cm">/* /&lt; Driver generated response frame (targt mode) */</span>
	<span class="n">SCU_TASK_TYPE_RAW_FRAME</span><span class="p">,</span>        <span class="cm">/* /&lt; Raw frame request type */</span>
	<span class="n">SCU_TASK_TYPE_PRIMITIVE</span>         <span class="cm">/* /&lt; Request for a primitive to be transmitted */</span>
<span class="p">}</span> <span class="n">scu_ssp_task_type</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * enum scu_sata_task_type - This enumeration defines the various SATA task</span>
<span class="cm"> *    types the SCU hardware will accept. The definition for the various task</span>
<span class="cm"> *    types the SCU hardware will accept can be found in the DS specification.</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>
	<span class="n">SCU_TASK_TYPE_DMA_IN</span><span class="p">,</span>           <span class="cm">/* /&lt; Read request */</span>
	<span class="n">SCU_TASK_TYPE_FPDMAQ_READ</span><span class="p">,</span>      <span class="cm">/* /&lt; NCQ read request */</span>
	<span class="n">SCU_TASK_TYPE_PACKET_DMA_IN</span><span class="p">,</span>    <span class="cm">/* /&lt; Packet read request */</span>
	<span class="n">SCU_TASK_TYPE_SATA_RAW_FRAME</span><span class="p">,</span>   <span class="cm">/* /&lt; Raw frame request */</span>
	<span class="n">RESERVED_4</span><span class="p">,</span>
	<span class="n">RESERVED_5</span><span class="p">,</span>
	<span class="n">RESERVED_6</span><span class="p">,</span>
	<span class="n">RESERVED_7</span><span class="p">,</span>
	<span class="n">SCU_TASK_TYPE_DMA_OUT</span><span class="p">,</span>          <span class="cm">/* /&lt; Write request */</span>
	<span class="n">SCU_TASK_TYPE_FPDMAQ_WRITE</span><span class="p">,</span>     <span class="cm">/* /&lt; NCQ write Request */</span>
	<span class="n">SCU_TASK_TYPE_PACKET_DMA_OUT</span>    <span class="cm">/* /&lt; Packet write request */</span>
<span class="p">}</span> <span class="n">scu_sata_task_type</span><span class="p">;</span>


<span class="cm">/**</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> * SCU_CONTEXT_TYPE</span>
<span class="cm"> */</span>
<span class="cp">#define SCU_TASK_CONTEXT_TYPE  0</span>
<span class="cp">#define SCU_RNC_CONTEXT_TYPE   1</span>

<span class="cm">/**</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> * SCU_TASK_CONTEXT_VALIDITY</span>
<span class="cm"> */</span>
<span class="cp">#define SCU_TASK_CONTEXT_INVALID          0</span>
<span class="cp">#define SCU_TASK_CONTEXT_VALID            1</span>

<span class="cm">/**</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> * SCU_COMMAND_CODE</span>
<span class="cm"> */</span>
<span class="cp">#define SCU_COMMAND_CODE_INITIATOR_NEW_TASK   0</span>
<span class="cp">#define SCU_COMMAND_CODE_ACTIVE_TASK          1</span>
<span class="cp">#define SCU_COMMAND_CODE_PRIMITIVE_SEQ_TASK   2</span>
<span class="cp">#define SCU_COMMAND_CODE_TARGET_RAW_FRAMES    3</span>

<span class="cm">/**</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> * SCU_TASK_PRIORITY</span>
<span class="cm"> */</span>
<span class="cm">/**</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> * This priority is used when there is no priority request for this request.</span>
<span class="cm"> */</span>
<span class="cp">#define SCU_TASK_PRIORITY_NORMAL          0</span>

<span class="cm">/**</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> * This priority indicates that the task should be scheduled to the head of the</span>
<span class="cm"> * queue.  The task will NOT be executed if the TX is suspended for the remote</span>
<span class="cm"> * node.</span>
<span class="cm"> */</span>
<span class="cp">#define SCU_TASK_PRIORITY_HEAD_OF_Q       1</span>

<span class="cm">/**</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> * This priority indicates that the task will be executed before all</span>
<span class="cm"> * SCU_TASK_PRIORITY_NORMAL and SCU_TASK_PRIORITY_HEAD_OF_Q tasks. The task</span>
<span class="cm"> * WILL be executed if the TX is suspended for the remote node.</span>
<span class="cm"> */</span>
<span class="cp">#define SCU_TASK_PRIORITY_HIGH            2</span>

<span class="cm">/**</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> * This task priority is reserved and should not be used.</span>
<span class="cm"> */</span>
<span class="cp">#define SCU_TASK_PRIORITY_RESERVED        3</span>

<span class="cp">#define SCU_TASK_INITIATOR_MODE           1</span>
<span class="cp">#define SCU_TASK_TARGET_MODE              0</span>

<span class="cp">#define SCU_TASK_REGULAR                  0</span>
<span class="cp">#define SCU_TASK_ABORTED                  1</span>

<span class="cm">/* direction bit defintion */</span>
<span class="cm">/**</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> * SATA_DIRECTION</span>
<span class="cm"> */</span>
<span class="cp">#define SCU_SATA_WRITE_DATA_DIRECTION     0</span>
<span class="cp">#define SCU_SATA_READ_DATA_DIRECTION      1</span>

<span class="cm">/**</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> * SCU_COMMAND_CONTEXT_MACROS These macros provide the mask and shift</span>
<span class="cm"> * operations to construct the various SCU commands</span>
<span class="cm"> */</span>
<span class="cp">#define SCU_CONTEXT_COMMAND_REQUEST_TYPE_SHIFT           21</span>
<span class="cp">#define SCU_CONTEXT_COMMAND_REQUEST_TYPE_MASK            0x00E00000</span>
<span class="cp">#define scu_get_command_request_type(x)	\</span>
<span class="cp">	((x) &amp; SCU_CONTEXT_COMMAND_REQUEST_TYPE_MASK)</span>

<span class="cp">#define SCU_CONTEXT_COMMAND_REQUEST_SUBTYPE_SHIFT        18</span>
<span class="cp">#define SCU_CONTEXT_COMMAND_REQUEST_SUBTYPE_MASK         0x001C0000</span>
<span class="cp">#define scu_get_command_request_subtype(x) \</span>
<span class="cp">	((x) &amp; SCU_CONTEXT_COMMAND_REQUEST_SUBTYPE_MASK)</span>

<span class="cp">#define SCU_CONTEXT_COMMAND_REQUEST_FULLTYPE_MASK	 \</span>
<span class="cp">	(\</span>
<span class="cp">		SCU_CONTEXT_COMMAND_REQUEST_TYPE_MASK		  \</span>
<span class="cp">		| SCU_CONTEXT_COMMAND_REQUEST_SUBTYPE_MASK	    \</span>
<span class="cp">	)</span>
<span class="cp">#define scu_get_command_request_full_type(x) \</span>
<span class="cp">	((x) &amp; SCU_CONTEXT_COMMAND_REQUEST_FULLTYPE_MASK)</span>

<span class="cp">#define SCU_CONTEXT_COMMAND_PROTOCOL_ENGINE_GROUP_SHIFT  16</span>
<span class="cp">#define SCU_CONTEXT_COMMAND_PROTOCOL_ENGINE_GROUP_MASK   0x00010000</span>
<span class="cp">#define scu_get_command_protocl_engine_group(x)	\</span>
<span class="cp">	((x) &amp; SCU_CONTEXT_COMMAND_PROTOCOL_ENGINE_GROUP_MASK)</span>

<span class="cp">#define SCU_CONTEXT_COMMAND_LOGICAL_PORT_SHIFT           12</span>
<span class="cp">#define SCU_CONTEXT_COMMAND_LOGICAL_PORT_MASK            0x00007000</span>
<span class="cp">#define scu_get_command_reqeust_logical_port(x)	\</span>
<span class="cp">	((x) &amp; SCU_CONTEXT_COMMAND_LOGICAL_PORT_MASK)</span>


<span class="cp">#define MAKE_SCU_CONTEXT_COMMAND_TYPE(type) \</span>
<span class="cp">	((u32)(type) &lt;&lt; SCU_CONTEXT_COMMAND_REQUEST_TYPE_SHIFT)</span>

<span class="cm">/**</span>
<span class="cm"> * MAKE_SCU_CONTEXT_COMMAND_TYPE() -</span>
<span class="cm"> *</span>
<span class="cm"> * SCU_COMMAND_TYPES These constants provide the grouping of the different SCU</span>
<span class="cm"> * command types.</span>
<span class="cm"> */</span>
<span class="cp">#define SCU_CONTEXT_COMMAND_REQUEST_TYPE_POST_TC    MAKE_SCU_CONTEXT_COMMAND_TYPE(0)</span>
<span class="cp">#define SCU_CONTEXT_COMMAND_REQUEST_TYPE_DUMP_TC    MAKE_SCU_CONTEXT_COMMAND_TYPE(1)</span>
<span class="cp">#define SCU_CONTEXT_COMMAND_REQUEST_TYPE_POST_RNC   MAKE_SCU_CONTEXT_COMMAND_TYPE(2)</span>
<span class="cp">#define SCU_CONTEXT_COMMAND_REQUEST_TYPE_DUMP_RNC   MAKE_SCU_CONTEXT_COMMAND_TYPE(3)</span>
<span class="cp">#define SCU_CONTEXT_COMMAND_REQUEST_TYPE_OTHER_RNC  MAKE_SCU_CONTEXT_COMMAND_TYPE(6)</span>

<span class="cp">#define MAKE_SCU_CONTEXT_COMMAND_REQUEST(type, command)	\</span>
<span class="cp">	((type) | ((command) &lt;&lt; SCU_CONTEXT_COMMAND_REQUEST_SUBTYPE_SHIFT))</span>

<span class="cm">/**</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> * SCU_REQUEST_TYPES These constants are the various request types that can be</span>
<span class="cm"> * posted to the SCU hardware.</span>
<span class="cm"> */</span>
<span class="cp">#define SCU_CONTEXT_COMMAND_REQUST_POST_TC \</span>
<span class="cp">	(MAKE_SCU_CONTEXT_COMMAND_REQUEST(SCU_CONTEXT_COMMAND_REQUEST_TYPE_POST_TC, 0))</span>

<span class="cp">#define SCU_CONTEXT_COMMAND_REQUEST_POST_TC_ABORT \</span>
<span class="cp">	(MAKE_SCU_CONTEXT_COMMAND_REQUEST(SCU_CONTEXT_COMMAND_REQUEST_TYPE_POST_TC, 1))</span>

<span class="cp">#define SCU_CONTEXT_COMMAND_REQUST_DUMP_TC \</span>
<span class="cp">	(MAKE_SCU_CONTEXT_COMMAND_REQUEST(SCU_CONTEXT_COMMAND_REQUEST_TYPE_DUMP_TC, 0))</span>

<span class="cp">#define SCU_CONTEXT_COMMAND_POST_RNC_32	\</span>
<span class="cp">	(MAKE_SCU_CONTEXT_COMMAND_REQUEST(SCU_CONTEXT_COMMAND_REQUEST_TYPE_POST_RNC, 0))</span>

<span class="cp">#define SCU_CONTEXT_COMMAND_POST_RNC_96	\</span>
<span class="cp">	(MAKE_SCU_CONTEXT_COMMAND_REQUEST(SCU_CONTEXT_COMMAND_REQUEST_TYPE_POST_RNC, 1))</span>

<span class="cp">#define SCU_CONTEXT_COMMAND_POST_RNC_INVALIDATE	\</span>
<span class="cp">	(MAKE_SCU_CONTEXT_COMMAND_REQUEST(SCU_CONTEXT_COMMAND_REQUEST_TYPE_POST_RNC, 2))</span>

<span class="cp">#define SCU_CONTEXT_COMMAND_DUMP_RNC_32	\</span>
<span class="cp">	(MAKE_SCU_CONTEXT_COMMAND_REQUEST(SCU_CONTEXT_COMMAND_REQUEST_TYPE_DUMP_RNC, 0))</span>

<span class="cp">#define SCU_CONTEXT_COMMAND_DUMP_RNC_96	\</span>
<span class="cp">	(MAKE_SCU_CONTEXT_COMMAND_REQUEST(SCU_CONTEXT_COMMAND_REQUEST_TYPE_DUMP_RNC, 1))</span>

<span class="cp">#define SCU_CONTEXT_COMMAND_POST_RNC_SUSPEND_TX	\</span>
<span class="cp">	(MAKE_SCU_CONTEXT_COMMAND_REQUEST(SCU_CONTEXT_COMMAND_REQUEST_TYPE_OTHER_RNC, 0))</span>

<span class="cp">#define SCU_CONTEXT_COMMAND_POST_RNC_SUSPEND_TX_RX \</span>
<span class="cp">	(MAKE_SCU_CONTEXT_COMMAND_REQUEST(SCU_CONTEXT_COMMAND_REQUEST_TYPE_OTHER_RNC, 1))</span>

<span class="cp">#define SCU_CONTEXT_COMMAND_POST_RNC_RESUME \</span>
<span class="cp">	(MAKE_SCU_CONTEXT_COMMAND_REQUEST(SCU_CONTEXT_COMMAND_REQUEST_TYPE_OTHER_RNC, 2))</span>

<span class="cp">#define SCU_CONTEXT_IT_NEXUS_LOSS_TIMER_ENABLE \</span>
<span class="cp">	(MAKE_SCU_CONTEXT_COMMAND_REQUEST(SCU_CONTEXT_COMMAND_REQUEST_TYPE_OTHER_RNC, 3))</span>

<span class="cp">#define SCU_CONTEXT_IT_NEXUS_LOSS_TIMER_DISABLE	\</span>
<span class="cp">	(MAKE_SCU_CONTEXT_COMMAND_REQUEST(SCU_CONTEXT_COMMAND_REQUEST_TYPE_OTHER_RNC, 4))</span>

<span class="cm">/**</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> * SCU_TASK_CONTEXT_PROTOCOL SCU Task context protocol types this is uesd to</span>
<span class="cm"> * program the SCU Task context protocol field in word 0x00.</span>
<span class="cm"> */</span>
<span class="cp">#define SCU_TASK_CONTEXT_PROTOCOL_SMP    0x00</span>
<span class="cp">#define SCU_TASK_CONTEXT_PROTOCOL_SSP    0x01</span>
<span class="cp">#define SCU_TASK_CONTEXT_PROTOCOL_STP    0x02</span>
<span class="cp">#define SCU_TASK_CONTEXT_PROTOCOL_NONE   0x07</span>

<span class="cm">/**</span>
<span class="cm"> * struct ssp_task_context - This is the SCU hardware definition for an SSP</span>
<span class="cm"> *    request.</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">ssp_task_context</span> <span class="p">{</span>
	<span class="cm">/* OFFSET 0x18 */</span>
	<span class="n">u32</span> <span class="n">reserved00</span><span class="o">:</span><span class="mi">24</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">frame_type</span><span class="o">:</span><span class="mi">8</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x1C */</span>
	<span class="n">u32</span> <span class="n">reserved01</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x20 */</span>
	<span class="n">u32</span> <span class="n">fill_bytes</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserved02</span><span class="o">:</span><span class="mi">6</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">changing_data_pointer</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">retransmit</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">retry_data_frame</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tlr_control</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserved03</span><span class="o">:</span><span class="mi">19</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x24 */</span>
	<span class="n">u32</span> <span class="n">uiRsvd4</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x28 */</span>
	<span class="n">u32</span> <span class="n">target_port_transfer_tag</span><span class="o">:</span><span class="mi">16</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tag</span><span class="o">:</span><span class="mi">16</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x2C */</span>
	<span class="n">u32</span> <span class="n">data_offset</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct stp_task_context - This is the SCU hardware definition for an STP</span>
<span class="cm"> *    request.</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">stp_task_context</span> <span class="p">{</span>
	<span class="cm">/* OFFSET 0x18 */</span>
	<span class="n">u32</span> <span class="n">fis_type</span><span class="o">:</span><span class="mi">8</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pm_port</span><span class="o">:</span><span class="mi">4</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserved0</span><span class="o">:</span><span class="mi">3</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">control</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">command</span><span class="o">:</span><span class="mi">8</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">features</span><span class="o">:</span><span class="mi">8</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x1C */</span>
	<span class="n">u32</span> <span class="n">reserved1</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x20 */</span>
	<span class="n">u32</span> <span class="n">reserved2</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x24 */</span>
	<span class="n">u32</span> <span class="n">reserved3</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x28 */</span>
	<span class="n">u32</span> <span class="n">ncq_tag</span><span class="o">:</span><span class="mi">5</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserved4</span><span class="o">:</span><span class="mi">27</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x2C */</span>
	<span class="n">u32</span> <span class="n">data_offset</span><span class="p">;</span> <span class="cm">/* TODO: What is this used for? */</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct smp_task_context - This is the SCU hardware definition for an SMP</span>
<span class="cm"> *    request.</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">smp_task_context</span> <span class="p">{</span>
	<span class="cm">/* OFFSET 0x18 */</span>
	<span class="n">u32</span> <span class="n">response_length</span><span class="o">:</span><span class="mi">8</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">function_result</span><span class="o">:</span><span class="mi">8</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">function</span><span class="o">:</span><span class="mi">8</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">frame_type</span><span class="o">:</span><span class="mi">8</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x1C */</span>
	<span class="n">u32</span> <span class="n">smp_response_ufi</span><span class="o">:</span><span class="mi">12</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserved1</span><span class="o">:</span><span class="mi">20</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x20 */</span>
	<span class="n">u32</span> <span class="n">reserved2</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x24 */</span>
	<span class="n">u32</span> <span class="n">reserved3</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x28 */</span>
	<span class="n">u32</span> <span class="n">reserved4</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x2C */</span>
	<span class="n">u32</span> <span class="n">reserved5</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct primitive_task_context - This is the SCU hardware definition used</span>
<span class="cm"> *    when the driver wants to send a primitive on the link.</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">primitive_task_context</span> <span class="p">{</span>
	<span class="cm">/* OFFSET 0x18 */</span>
	<span class="cm">/**</span>
<span class="cm">	 * This field is the control word and it must be 0.</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">control</span><span class="p">;</span> <span class="cm">/* /&lt; must be set to 0 */</span>

	<span class="cm">/* OFFSET 0x1C */</span>
	<span class="cm">/**</span>
<span class="cm">	 * This field specifies the primitive that is to be transmitted.</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">sequence</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x20 */</span>
	<span class="n">u32</span> <span class="n">reserved0</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x24 */</span>
	<span class="n">u32</span> <span class="n">reserved1</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x28 */</span>
	<span class="n">u32</span> <span class="n">reserved2</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x2C */</span>
	<span class="n">u32</span> <span class="n">reserved3</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * The union of the protocols that can be selected in the SCU task context</span>
<span class="cm"> *    field.</span>
<span class="cm"> *</span>
<span class="cm"> * protocol_context</span>
<span class="cm"> */</span>
<span class="k">union</span> <span class="n">protocol_context</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">ssp_task_context</span> <span class="n">ssp</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">stp_task_context</span> <span class="n">stp</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">smp_task_context</span> <span class="n">smp</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">primitive_task_context</span> <span class="n">primitive</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">words</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct scu_sgl_element - This structure represents a single SCU defined SGL</span>
<span class="cm"> *    element. SCU SGLs contain a 64 bit address with the maximum data transfer</span>
<span class="cm"> *    being 24 bits in size.  The SGL can not cross a 4GB boundary.</span>
<span class="cm"> *</span>
<span class="cm"> * struct scu_sgl_element</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">scu_sgl_element</span> <span class="p">{</span>
	<span class="cm">/**</span>
<span class="cm">	 * This field is the upper 32 bits of the 64 bit physical address.</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">address_upper</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field is the lower 32 bits of the 64 bit physical address.</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">address_lower</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field is the number of bytes to transfer.</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">length</span><span class="o">:</span><span class="mi">24</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field is the address modifier to be used when a virtual function is</span>
<span class="cm">	 * requesting a data transfer.</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">address_modifier</span><span class="o">:</span><span class="mi">8</span><span class="p">;</span>

<span class="p">};</span>

<span class="cp">#define SCU_SGL_ELEMENT_PAIR_A   0</span>
<span class="cp">#define SCU_SGL_ELEMENT_PAIR_B   1</span>

<span class="cm">/**</span>
<span class="cm"> * struct scu_sgl_element_pair - This structure is the SCU hardware definition</span>
<span class="cm"> *    of a pair of SGL elements. The SCU hardware always works on SGL pairs.</span>
<span class="cm"> *    They are refered to in the DS specification as SGL A and SGL B.  Each SGL</span>
<span class="cm"> *    pair is followed by the address of the next pair.</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">scu_sgl_element_pair</span> <span class="p">{</span>
	<span class="cm">/* OFFSET 0x60-0x68 */</span>
	<span class="cm">/**</span>
<span class="cm">	 * This field is the SGL element A of the SGL pair.</span>
<span class="cm">	 */</span>
	<span class="k">struct</span> <span class="n">scu_sgl_element</span> <span class="n">A</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x6C-0x74 */</span>
	<span class="cm">/**</span>
<span class="cm">	 * This field is the SGL element B of the SGL pair.</span>
<span class="cm">	 */</span>
	<span class="k">struct</span> <span class="n">scu_sgl_element</span> <span class="n">B</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x78-0x7C */</span>
	<span class="cm">/**</span>
<span class="cm">	 * This field is the upper 32 bits of the 64 bit address to the next SGL</span>
<span class="cm">	 * element pair.</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">next_pair_upper</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field is the lower 32 bits of the 64 bit address to the next SGL</span>
<span class="cm">	 * element pair.</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">next_pair_lower</span><span class="p">;</span>

<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct transport_snapshot - This structure is the SCU hardware scratch area</span>
<span class="cm"> *    for the task context. This is set to 0 by the driver but can be read by</span>
<span class="cm"> *    issuing a dump TC request to the SCU.</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">transport_snapshot</span> <span class="p">{</span>
	<span class="cm">/* OFFSET 0x48 */</span>
	<span class="n">u32</span> <span class="n">xfer_rdy_write_data_length</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x4C */</span>
	<span class="n">u32</span> <span class="n">data_offset</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x50 */</span>
	<span class="n">u32</span> <span class="n">data_transfer_size</span><span class="o">:</span><span class="mi">24</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserved_50_0</span><span class="o">:</span><span class="mi">8</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x54 */</span>
	<span class="n">u32</span> <span class="n">next_initiator_write_data_offset</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x58 */</span>
	<span class="n">u32</span> <span class="n">next_initiator_write_data_xfer_size</span><span class="o">:</span><span class="mi">24</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserved_58_0</span><span class="o">:</span><span class="mi">8</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct scu_task_context - This structure defines the contents of the SCU</span>
<span class="cm"> *    silicon task context. It lays out all of the fields according to the</span>
<span class="cm"> *    expected order and location for the Storage Controller unit.</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">scu_task_context</span> <span class="p">{</span>
	<span class="cm">/* OFFSET 0x00 ------ */</span>
	<span class="cm">/**</span>
<span class="cm">	 * This field must be encoded to one of the valid SCU task priority values</span>
<span class="cm">	 *    - SCU_TASK_PRIORITY_NORMAL</span>
<span class="cm">	 *    - SCU_TASK_PRIORITY_HEAD_OF_Q</span>
<span class="cm">	 *    - SCU_TASK_PRIORITY_HIGH</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">priority</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field must be set to true if this is an initiator generated request.</span>
<span class="cm">	 * Until target mode is supported all task requests are initiator requests.</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">initiator_request</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field must be set to one of the valid connection rates valid values</span>
<span class="cm">	 * are 0x8, 0x9, and 0xA.</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">connection_rate</span><span class="o">:</span><span class="mi">4</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field muse be programed when generating an SMP response since the SMP</span>
<span class="cm">	 * connection remains open until the SMP response is generated.</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">protocol_engine_index</span><span class="o">:</span><span class="mi">3</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field must contain the logical port for the task request.</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">logical_port_index</span><span class="o">:</span><span class="mi">3</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field must be set to one of the SCU_TASK_CONTEXT_PROTOCOL values</span>
<span class="cm">	 *    - SCU_TASK_CONTEXT_PROTOCOL_SMP</span>
<span class="cm">	 *    - SCU_TASK_CONTEXT_PROTOCOL_SSP</span>
<span class="cm">	 *    - SCU_TASK_CONTEXT_PROTOCOL_STP</span>
<span class="cm">	 *    - SCU_TASK_CONTEXT_PROTOCOL_NONE</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">protocol_type</span><span class="o">:</span><span class="mi">3</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This filed must be set to the TCi allocated for this task</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">task_index</span><span class="o">:</span><span class="mi">12</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field is reserved and must be set to 0x00</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">reserved_00_0</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * For a normal task request this must be set to 0.  If this is an abort of</span>
<span class="cm">	 * this task request it must be set to 1.</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">abort</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field must be set to true for the SCU hardware to process the task.</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">valid</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field must be set to SCU_TASK_CONTEXT_TYPE</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">context_type</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x04 */</span>
	<span class="cm">/**</span>
<span class="cm">	 * This field contains the RNi that is the target of this request.</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">remote_node_index</span><span class="o">:</span><span class="mi">12</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field is programmed if this is a mirrored request, which we are not</span>
<span class="cm">	 * using, in which case it is the RNi for the mirrored target.</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">mirrored_node_index</span><span class="o">:</span><span class="mi">12</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field is programmed with the direction of the SATA reqeust</span>
<span class="cm">	 *    - SCU_SATA_WRITE_DATA_DIRECTION</span>
<span class="cm">	 *    - SCU_SATA_READ_DATA_DIRECTION</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">sata_direction</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field is programmsed with one of the following SCU_COMMAND_CODE</span>
<span class="cm">	 *    - SCU_COMMAND_CODE_INITIATOR_NEW_TASK</span>
<span class="cm">	 *    - SCU_COMMAND_CODE_ACTIVE_TASK</span>
<span class="cm">	 *    - SCU_COMMAND_CODE_PRIMITIVE_SEQ_TASK</span>
<span class="cm">	 *    - SCU_COMMAND_CODE_TARGET_RAW_FRAMES</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">command_code</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field is set to true if the remote node should be suspended.</span>
<span class="cm">	 * This bit is only valid for SSP &amp; SMP target devices.</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">suspend_node</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field is programmed with one of the following command type codes</span>
<span class="cm">	 *</span>
<span class="cm">	 * For SAS requests use the scu_ssp_task_type</span>
<span class="cm">	 *    - SCU_TASK_TYPE_IOREAD</span>
<span class="cm">	 *    - SCU_TASK_TYPE_IOWRITE</span>
<span class="cm">	 *    - SCU_TASK_TYPE_SMP_REQUEST</span>
<span class="cm">	 *    - SCU_TASK_TYPE_RESPONSE</span>
<span class="cm">	 *    - SCU_TASK_TYPE_RAW_FRAME</span>
<span class="cm">	 *    - SCU_TASK_TYPE_PRIMITIVE</span>
<span class="cm">	 *</span>
<span class="cm">	 * For SATA requests use the scu_sata_task_type</span>
<span class="cm">	 *    - SCU_TASK_TYPE_DMA_IN</span>
<span class="cm">	 *    - SCU_TASK_TYPE_FPDMAQ_READ</span>
<span class="cm">	 *    - SCU_TASK_TYPE_PACKET_DMA_IN</span>
<span class="cm">	 *    - SCU_TASK_TYPE_SATA_RAW_FRAME</span>
<span class="cm">	 *    - SCU_TASK_TYPE_DMA_OUT</span>
<span class="cm">	 *    - SCU_TASK_TYPE_FPDMAQ_WRITE</span>
<span class="cm">	 *    - SCU_TASK_TYPE_PACKET_DMA_OUT</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">task_type</span><span class="o">:</span><span class="mi">4</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x08 */</span>
	<span class="cm">/**</span>
<span class="cm">	 * This field is reserved and the must be set to 0x00</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">link_layer_control</span><span class="o">:</span><span class="mi">8</span><span class="p">;</span> <span class="cm">/* presently all reserved */</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field is set to true when TLR is to be enabled</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">ssp_tlr_enable</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This is field specifies if the SCU DMAs a response frame to host</span>
<span class="cm">	 * memory for good response frames when operating in target mode.</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">dma_ssp_target_good_response</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field indicates if the SCU should DMA the response frame to</span>
<span class="cm">	 * host memory.</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">do_not_dma_ssp_good_response</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field is set to true when strict ordering is to be enabled</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">strict_ordering</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field indicates the type of endianess to be utilized for the</span>
<span class="cm">	 * frame.  command, task, and response frames utilized control_frame</span>
<span class="cm">	 * set to 1.</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">control_frame</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field is reserved and the driver should set to 0x00</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">tl_control_reserved</span><span class="o">:</span><span class="mi">3</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field is set to true when the SCU hardware task timeout control is to</span>
<span class="cm">	 * be enabled</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">timeout_enable</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field is reserved and the driver should set it to 0x00</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">pts_control_reserved</span><span class="o">:</span><span class="mi">7</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field should be set to true when block guard is to be enabled</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">block_guard_enable</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field is reserved and the driver should set to 0x00</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">sdma_control_reserved</span><span class="o">:</span><span class="mi">7</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x0C */</span>
	<span class="cm">/**</span>
<span class="cm">	 * This field is the address modifier for this io request it should be</span>
<span class="cm">	 * programmed with the virtual function that is making the request.</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">address_modifier</span><span class="o">:</span><span class="mi">16</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * @todo What we support mirrored SMP response frame?</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">mirrored_protocol_engine</span><span class="o">:</span><span class="mi">3</span><span class="p">;</span>  <span class="cm">/* mirrored protocol Engine Index */</span>

	<span class="cm">/**</span>
<span class="cm">	 * If this is a mirrored request the logical port index for the mirrored RNi</span>
<span class="cm">	 * must be programmed.</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">mirrored_logical_port</span><span class="o">:</span><span class="mi">4</span><span class="p">;</span>  <span class="cm">/* mirrored local port index */</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field is reserved and the driver must set it to 0x00</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">reserved_0C_0</span><span class="o">:</span><span class="mi">8</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field must be set to true if the mirrored request processing is to be</span>
<span class="cm">	 * enabled.</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">mirror_request_enable</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>  <span class="cm">/* Mirrored request Enable */</span>

	<span class="cm">/* OFFSET 0x10 */</span>
	<span class="cm">/**</span>
<span class="cm">	 * This field is the command iu length in dwords</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">ssp_command_iu_length</span><span class="o">:</span><span class="mi">8</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This is the target TLR enable bit it must be set to 0 when creatning the</span>
<span class="cm">	 * task context.</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">xfer_ready_tlr_enable</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field is reserved and the driver must set it to 0x00</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">reserved_10_0</span><span class="o">:</span><span class="mi">7</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This is the maximum burst size that the SCU hardware will send in one</span>
<span class="cm">	 * connection its value is (N x 512) and N must be a multiple of 2.  If the</span>
<span class="cm">	 * value is 0x00 then maximum burst size is disabled.</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">ssp_max_burst_size</span><span class="o">:</span><span class="mi">16</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x14 */</span>
	<span class="cm">/**</span>
<span class="cm">	 * This filed is set to the number of bytes to be transfered in the request.</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">transfer_length_bytes</span><span class="o">:</span><span class="mi">24</span><span class="p">;</span> <span class="cm">/* In terms of bytes */</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field is reserved and the driver should set it to 0x00</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">reserved_14_0</span><span class="o">:</span><span class="mi">8</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x18-0x2C */</span>
	<span class="cm">/**</span>
<span class="cm">	 * This union provides for the protocol specif part of the SCU Task Context.</span>
<span class="cm">	 */</span>
	<span class="k">union</span> <span class="n">protocol_context</span> <span class="n">type</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x30-0x34 */</span>
	<span class="cm">/**</span>
<span class="cm">	 * This field is the upper 32 bits of the 64 bit physical address of the</span>
<span class="cm">	 * command iu buffer</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">command_iu_upper</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field is the lower 32 bits of the 64 bit physical address of the</span>
<span class="cm">	 * command iu buffer</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">command_iu_lower</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x38-0x3C */</span>
	<span class="cm">/**</span>
<span class="cm">	 * This field is the upper 32 bits of the 64 bit physical address of the</span>
<span class="cm">	 * response iu buffer</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">response_iu_upper</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field is the lower 32 bits of the 64 bit physical address of the</span>
<span class="cm">	 * response iu buffer</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">response_iu_lower</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x40 */</span>
	<span class="cm">/**</span>
<span class="cm">	 * This field is set to the task phase of the SCU hardware. The driver must</span>
<span class="cm">	 * set this to 0x01</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">task_phase</span><span class="o">:</span><span class="mi">8</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field is set to the transport layer task status.  The driver must set</span>
<span class="cm">	 * this to 0x00</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">task_status</span><span class="o">:</span><span class="mi">8</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field is used during initiator write TLR</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">previous_extended_tag</span><span class="o">:</span><span class="mi">4</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field is set the maximum number of retries for a STP non-data FIS</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">stp_retry_count</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field is reserved and the driver must set it to 0x00</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">reserved_40_1</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field is used by the SCU TL to determine when to take a snapshot when</span>
<span class="cm">	 * tranmitting read data frames.</span>
<span class="cm">	 *    - 0x00 The entire IO</span>
<span class="cm">	 *    - 0x01 32k</span>
<span class="cm">	 *    - 0x02 64k</span>
<span class="cm">	 *    - 0x04 128k</span>
<span class="cm">	 *    - 0x08 256k</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">ssp_tlr_threshold</span><span class="o">:</span><span class="mi">4</span><span class="p">;</span>

	<span class="cm">/**</span>
<span class="cm">	 * This field is reserved and the driver must set it to 0x00</span>
<span class="cm">	 */</span>
	<span class="n">u32</span> <span class="n">reserved_40_2</span><span class="o">:</span><span class="mi">4</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0x44 */</span>
	<span class="n">u32</span> <span class="n">write_data_length</span><span class="p">;</span> <span class="cm">/* read only set to 0 */</span>

	<span class="cm">/* OFFSET 0x48-0x58 */</span>
	<span class="k">struct</span> <span class="n">transport_snapshot</span> <span class="n">snapshot</span><span class="p">;</span> <span class="cm">/* read only set to 0 */</span>

	<span class="cm">/* OFFSET 0x5C */</span>
	<span class="n">u32</span> <span class="n">blk_prot_en</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">blk_sz</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">blk_prot_func</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserved_5C_0</span><span class="o">:</span><span class="mi">9</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">active_sgl_element</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span>  <span class="cm">/* read only set to 0 */</span>
	<span class="n">u32</span> <span class="n">sgl_exhausted</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>  <span class="cm">/* read only set to 0 */</span>
	<span class="n">u32</span> <span class="n">payload_data_transfer_error</span><span class="o">:</span><span class="mi">4</span><span class="p">;</span>  <span class="cm">/* read only set to 0 */</span>
	<span class="n">u32</span> <span class="n">frame_buffer_offset</span><span class="o">:</span><span class="mi">11</span><span class="p">;</span> <span class="cm">/* read only set to 0 */</span>

	<span class="cm">/* OFFSET 0x60-0x7C */</span>
	<span class="cm">/**</span>
<span class="cm">	 * This field is the first SGL element pair found in the TC data structure.</span>
<span class="cm">	 */</span>
	<span class="k">struct</span> <span class="n">scu_sgl_element_pair</span> <span class="n">sgl_pair_ab</span><span class="p">;</span>
	<span class="cm">/* OFFSET 0x80-0x9C */</span>
	<span class="cm">/**</span>
<span class="cm">	 * This field is the second SGL element pair found in the TC data structure.</span>
<span class="cm">	 */</span>
	<span class="k">struct</span> <span class="n">scu_sgl_element_pair</span> <span class="n">sgl_pair_cd</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0xA0-BC */</span>
	<span class="k">struct</span> <span class="n">scu_sgl_element_pair</span> <span class="n">sgl_snapshot_ac</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0xC0 */</span>
	<span class="n">u32</span> <span class="n">active_sgl_element_pair</span><span class="p">;</span> <span class="cm">/* read only set to 0 */</span>

	<span class="cm">/* OFFSET 0xC4-0xCC */</span>
	<span class="n">u32</span> <span class="n">reserved_C4_CC</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>

	<span class="cm">/* OFFSET 0xD0 */</span>
	<span class="n">u32</span> <span class="n">interm_crc_val</span><span class="o">:</span><span class="mi">16</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">init_crc_seed</span><span class="o">:</span><span class="mi">16</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0xD4 */</span>
	<span class="n">u32</span> <span class="n">app_tag_verify</span><span class="o">:</span><span class="mi">16</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">app_tag_gen</span><span class="o">:</span><span class="mi">16</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0xD8 */</span>
	<span class="n">u32</span> <span class="n">ref_tag_seed_verify</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0xDC */</span>
	<span class="n">u32</span> <span class="n">UD_bytes_immed_val</span><span class="o">:</span><span class="mi">13</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserved_DC_0</span><span class="o">:</span><span class="mi">3</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">DIF_bytes_immed_val</span><span class="o">:</span><span class="mi">4</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserved_DC_1</span><span class="o">:</span><span class="mi">12</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0xE0 */</span>
	<span class="n">u32</span> <span class="n">bgc_blk_sz</span><span class="o">:</span><span class="mi">13</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserved_E0_0</span><span class="o">:</span><span class="mi">3</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">app_tag_gen_mask</span><span class="o">:</span><span class="mi">16</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0xE4 */</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="n">u16</span> <span class="n">bgctl</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">u16</span> <span class="n">crc_verify</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u16</span> <span class="n">app_tag_chk</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u16</span> <span class="n">ref_tag_chk</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u16</span> <span class="n">op</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span>
			<span class="n">u16</span> <span class="n">legacy</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u16</span> <span class="n">invert_crc_seed</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u16</span> <span class="n">ref_tag_gen</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u16</span> <span class="n">fixed_ref_tag</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u16</span> <span class="n">invert_crc</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u16</span> <span class="n">app_ref_f_detect</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u16</span> <span class="n">uninit_dif_check_err</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u16</span> <span class="n">uninit_dif_bypass</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u16</span> <span class="n">app_f_detect</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u16</span> <span class="n">reserved_0</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">bgctl_f</span><span class="p">;</span>
	<span class="p">};</span>

	<span class="n">u16</span> <span class="n">app_tag_verify_mask</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0xE8 */</span>
	<span class="n">u32</span> <span class="n">blk_guard_err</span><span class="o">:</span><span class="mi">8</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserved_E8_0</span><span class="o">:</span><span class="mi">24</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0xEC */</span>
	<span class="n">u32</span> <span class="n">ref_tag_seed_gen</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0xF0 */</span>
	<span class="n">u32</span> <span class="n">intermediate_crc_valid_snapshot</span><span class="o">:</span><span class="mi">16</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserved_F0_0</span><span class="o">:</span><span class="mi">16</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0xF4 */</span>
	<span class="n">u32</span> <span class="n">reference_tag_seed_for_verify_function_snapshot</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0xF8 */</span>
	<span class="n">u32</span> <span class="n">snapshot_of_reserved_dword_DC_of_tc</span><span class="p">;</span>

	<span class="cm">/* OFFSET 0xFC */</span>
	<span class="n">u32</span> <span class="n">reference_tag_seed_for_generate_function_snapshot</span><span class="p">;</span>

<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#endif </span><span class="cm">/* _SCU_TASK_CONTEXT_H_ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
