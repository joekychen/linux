<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › scsi › a100u2w.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>a100u2w.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Initio A100 device driver for Linux.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (c) 1994-1998 Initio Corporation</span>
<span class="cm"> * All rights reserved.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> * it under the terms of the GNU General Public License as published by</span>
<span class="cm"> * the Free Software Foundation; either version 2, or (at your option)</span>
<span class="cm"> * any later version.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful,</span>
<span class="cm"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm"> * GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License</span>
<span class="cm"> * along with this program; see the file COPYING.  If not, write to</span>
<span class="cm"> * the Free Software Foundation, 675 Mass Ave, Cambridge, MA 02139, USA.</span>
<span class="cm"> *</span>
<span class="cm"> * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS&#39;&#39; AND</span>
<span class="cm"> * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="cm"> * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span>
<span class="cm"> * ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE FOR</span>
<span class="cm"> * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<span class="cm"> * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS</span>
<span class="cm"> * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</span>
<span class="cm"> * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT</span>
<span class="cm"> * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY</span>
<span class="cm"> * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF</span>
<span class="cm"> * SUCH DAMAGE.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision History:</span>
<span class="cm"> * 06/18/98 HL, Initial production Version 1.02</span>
<span class="cm"> * 12/19/98 bv, Use spinlocks for 2.1.95 and up</span>
<span class="cm"> * 06/25/02 Doug Ledford &lt;dledford@redhat.com&gt;</span>
<span class="cm"> *	 - This and the i60uscsi.h file are almost identical,</span>
<span class="cm"> *	   merged them into a single header used by both .c files.</span>
<span class="cm"> * 14/06/07 Alan Cox &lt;alan@redhat.com&gt;</span>
<span class="cm"> *	 - Grand cleanup and Linuxisation</span>
<span class="cm"> */</span>

<span class="cp">#define inia100_REVID &quot;Initio INI-A100U2W SCSI device driver; Revision: 1.02d&quot;</span>

<span class="cp">#if 1</span>
<span class="cp">#define ORC_MAXQUEUE		245</span>
<span class="cp">#define ORC_MAXTAGS		64</span>
<span class="cp">#else</span>
<span class="cp">#define ORC_MAXQUEUE		25</span>
<span class="cp">#define ORC_MAXTAGS		8</span>
<span class="cp">#endif</span>

<span class="cp">#define TOTAL_SG_ENTRY		32</span>
<span class="cp">#define MAX_TARGETS		16</span>
<span class="cp">#define IMAX_CDB			15</span>
<span class="cp">#define SENSE_SIZE		14</span>

<span class="cm">/************************************************************************/</span>
<span class="cm">/*              Scatter-Gather Element Structure                        */</span>
<span class="cm">/************************************************************************/</span>
<span class="k">struct</span> <span class="n">orc_sgent</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">base</span><span class="p">;</span>		<span class="cm">/* Data Pointer */</span>
	<span class="n">u32</span> <span class="n">length</span><span class="p">;</span>		<span class="cm">/* Data Length */</span>
<span class="p">};</span>

<span class="cm">/* SCSI related definition                                              */</span>
<span class="cp">#define DISC_NOT_ALLOW          0x80	</span><span class="cm">/* Disconnect is not allowed    */</span><span class="cp"></span>
<span class="cp">#define DISC_ALLOW              0xC0	</span><span class="cm">/* Disconnect is allowed        */</span><span class="cp"></span>


<span class="cp">#define ORC_OFFSET_SCB			16</span>
<span class="cp">#define ORC_MAX_SCBS		    250</span>
<span class="cp">#define MAX_CHANNELS       2</span>
<span class="cp">#define MAX_ESCB_ELE				64</span>
<span class="cp">#define TCF_DRV_255_63     0x0400</span>

<span class="cm">/********************************************************/</span>
<span class="cm">/*      Orchid Host Command Set                         */</span>
<span class="cm">/********************************************************/</span>
<span class="cp">#define ORC_CMD_NOP		0x00	</span><span class="cm">/* Host command - NOP             */</span><span class="cp"></span>
<span class="cp">#define ORC_CMD_VERSION		0x01	</span><span class="cm">/* Host command - Get F/W version */</span><span class="cp"></span>
<span class="cp">#define ORC_CMD_ECHO		0x02	</span><span class="cm">/* Host command - ECHO            */</span><span class="cp"></span>
<span class="cp">#define ORC_CMD_SET_NVM		0x03	</span><span class="cm">/* Host command - Set NVRAM       */</span><span class="cp"></span>
<span class="cp">#define ORC_CMD_GET_NVM		0x04	</span><span class="cm">/* Host command - Get NVRAM       */</span><span class="cp"></span>
<span class="cp">#define ORC_CMD_GET_BUS_STATUS	0x05	</span><span class="cm">/* Host command - Get SCSI bus status */</span><span class="cp"></span>
<span class="cp">#define ORC_CMD_ABORT_SCB	0x06	</span><span class="cm">/* Host command - Abort SCB       */</span><span class="cp"></span>
<span class="cp">#define ORC_CMD_ISSUE_SCB	0x07	</span><span class="cm">/* Host command - Issue SCB       */</span><span class="cp"></span>

<span class="cm">/********************************************************/</span>
<span class="cm">/*              Orchid Register Set                     */</span>
<span class="cm">/********************************************************/</span>
<span class="cp">#define ORC_GINTS	0xA0	</span><span class="cm">/* Global Interrupt Status        */</span><span class="cp"></span>
<span class="cp">#define QINT		0x04	</span><span class="cm">/* Reply Queue Interrupt  */</span><span class="cp"></span>
<span class="cp">#define ORC_GIMSK	0xA1	</span><span class="cm">/* Global Interrupt MASK  */</span><span class="cp"></span>
<span class="cp">#define MQINT		0x04	</span><span class="cm">/* Mask Reply Queue Interrupt     */</span><span class="cp"></span>
<span class="cp">#define	ORC_GCFG	0xA2	</span><span class="cm">/* Global Configure               */</span><span class="cp"></span>
<span class="cp">#define EEPRG		0x01	</span><span class="cm">/* Enable EEPROM programming */</span><span class="cp"></span>
<span class="cp">#define	ORC_GSTAT	0xA3	</span><span class="cm">/* Global status          */</span><span class="cp"></span>
<span class="cp">#define WIDEBUS		0x10	</span><span class="cm">/* Wide SCSI Devices connected    */</span><span class="cp"></span>
<span class="cp">#define ORC_HDATA	0xA4	</span><span class="cm">/* Host Data                      */</span><span class="cp"></span>
<span class="cp">#define ORC_HCTRL	0xA5	</span><span class="cm">/* Host Control                   */</span><span class="cp"></span>
<span class="cp">#define SCSIRST		0x80	</span><span class="cm">/* SCSI bus reset         */</span><span class="cp"></span>
<span class="cp">#define HDO			0x40	</span><span class="cm">/* Host data out          */</span><span class="cp"></span>
<span class="cp">#define HOSTSTOP		0x02	</span><span class="cm">/* Host stop RISC engine  */</span><span class="cp"></span>
<span class="cp">#define DEVRST		0x01	</span><span class="cm">/* Device reset                   */</span><span class="cp"></span>
<span class="cp">#define ORC_HSTUS	0xA6	</span><span class="cm">/* Host Status                    */</span><span class="cp"></span>
<span class="cp">#define HDI			0x02	</span><span class="cm">/* Host data in                   */</span><span class="cp"></span>
<span class="cp">#define RREADY		0x01	</span><span class="cm">/* RISC engine is ready to receive */</span><span class="cp"></span>
<span class="cp">#define	ORC_NVRAM	0xA7	</span><span class="cm">/* Nvram port address             */</span><span class="cp"></span>
<span class="cp">#define SE2CS		0x008</span>
<span class="cp">#define SE2CLK		0x004</span>
<span class="cp">#define SE2DO		0x002</span>
<span class="cp">#define SE2DI		0x001</span>
<span class="cp">#define ORC_PQUEUE	0xA8	</span><span class="cm">/* Posting queue FIFO             */</span><span class="cp"></span>
<span class="cp">#define ORC_PQCNT	0xA9	</span><span class="cm">/* Posting queue FIFO Cnt */</span><span class="cp"></span>
<span class="cp">#define ORC_RQUEUE	0xAA	</span><span class="cm">/* Reply queue FIFO               */</span><span class="cp"></span>
<span class="cp">#define ORC_RQUEUECNT	0xAB	</span><span class="cm">/* Reply queue FIFO Cnt           */</span><span class="cp"></span>
<span class="cp">#define	ORC_FWBASEADR	0xAC	</span><span class="cm">/* Firmware base address  */</span><span class="cp"></span>

<span class="cp">#define	ORC_EBIOSADR0 0xB0	</span><span class="cm">/* External Bios address */</span><span class="cp"></span>
<span class="cp">#define	ORC_EBIOSADR1 0xB1	</span><span class="cm">/* External Bios address */</span><span class="cp"></span>
<span class="cp">#define	ORC_EBIOSADR2 0xB2	</span><span class="cm">/* External Bios address */</span><span class="cp"></span>
<span class="cp">#define	ORC_EBIOSDATA 0xB3	</span><span class="cm">/* External Bios address */</span><span class="cp"></span>

<span class="cp">#define	ORC_SCBSIZE	0xB7	</span><span class="cm">/* SCB size register              */</span><span class="cp"></span>
<span class="cp">#define	ORC_SCBBASE0	0xB8	</span><span class="cm">/* SCB base address 0             */</span><span class="cp"></span>
<span class="cp">#define	ORC_SCBBASE1	0xBC	</span><span class="cm">/* SCB base address 1             */</span><span class="cp"></span>

<span class="cp">#define	ORC_RISCCTL	0xE0	</span><span class="cm">/* RISC Control                   */</span><span class="cp"></span>
<span class="cp">#define PRGMRST		0x002</span>
<span class="cp">#define DOWNLOAD		0x001</span>
<span class="cp">#define	ORC_PRGMCTR0	0xE2	</span><span class="cm">/* RISC program counter           */</span><span class="cp"></span>
<span class="cp">#define	ORC_PRGMCTR1	0xE3	</span><span class="cm">/* RISC program counter           */</span><span class="cp"></span>
<span class="cp">#define	ORC_RISCRAM	0xEC	</span><span class="cm">/* RISC RAM data port 4 bytes     */</span><span class="cp"></span>

<span class="k">struct</span> <span class="n">orc_extended_scb</span> <span class="p">{</span>	<span class="cm">/* Extended SCB                 */</span>
	<span class="k">struct</span> <span class="n">orc_sgent</span> <span class="n">sglist</span><span class="p">[</span><span class="n">TOTAL_SG_ENTRY</span><span class="p">];</span>	<span class="cm">/*0 Start of SG list              */</span>
	<span class="k">struct</span> <span class="n">scsi_cmnd</span> <span class="o">*</span><span class="n">srb</span><span class="p">;</span>	<span class="cm">/*50 SRB Pointer */</span>
<span class="p">};</span>

<span class="cm">/***********************************************************************</span>
<span class="cm">		SCSI Control Block</span>

<span class="cm">		0x40 bytes long, the last 8 are user bytes</span>
<span class="cm">************************************************************************/</span>
<span class="k">struct</span> <span class="n">orc_scb</span> <span class="p">{</span>	<span class="cm">/* Scsi_Ctrl_Blk                */</span>
	<span class="n">u8</span> <span class="n">opcode</span><span class="p">;</span>	<span class="cm">/*00 SCB command code&amp;residual  */</span>
	<span class="n">u8</span> <span class="n">flags</span><span class="p">;</span>	<span class="cm">/*01 SCB Flags                  */</span>
	<span class="n">u8</span> <span class="n">target</span><span class="p">;</span>	<span class="cm">/*02 Target Id                  */</span>
	<span class="n">u8</span> <span class="n">lun</span><span class="p">;</span>		<span class="cm">/*03 Lun                        */</span>
	<span class="n">u32</span> <span class="n">reserved0</span><span class="p">;</span>	<span class="cm">/*04 Reserved for ORCHID must 0 */</span>
	<span class="n">u32</span> <span class="n">xferlen</span><span class="p">;</span>	<span class="cm">/*08 Data Transfer Length       */</span>
	<span class="n">u32</span> <span class="n">reserved1</span><span class="p">;</span>	<span class="cm">/*0C Reserved for ORCHID must 0 */</span>
	<span class="n">u32</span> <span class="n">sg_len</span><span class="p">;</span>		<span class="cm">/*10 SG list # * 8              */</span>
	<span class="n">u32</span> <span class="n">sg_addr</span><span class="p">;</span>	<span class="cm">/*14 SG List Buf physical Addr  */</span>
	<span class="n">u32</span> <span class="n">sg_addrhigh</span><span class="p">;</span>	<span class="cm">/*18 SG Buffer high physical Addr */</span>
	<span class="n">u8</span> <span class="n">hastat</span><span class="p">;</span>	<span class="cm">/*1C Host Status                */</span>
	<span class="n">u8</span> <span class="n">tastat</span><span class="p">;</span>	<span class="cm">/*1D Target Status              */</span>
	<span class="n">u8</span> <span class="n">status</span><span class="p">;</span>	<span class="cm">/*1E SCB status                 */</span>
	<span class="n">u8</span> <span class="n">link</span><span class="p">;</span>		<span class="cm">/*1F Link pointer, default 0xFF */</span>
	<span class="n">u8</span> <span class="n">sense_len</span><span class="p">;</span>	<span class="cm">/*20 Sense Allocation Length    */</span>
	<span class="n">u8</span> <span class="n">cdb_len</span><span class="p">;</span>	<span class="cm">/*21 CDB Length                 */</span>
	<span class="n">u8</span> <span class="n">ident</span><span class="p">;</span>	<span class="cm">/*22 Identify                   */</span>
	<span class="n">u8</span> <span class="n">tag_msg</span><span class="p">;</span>	<span class="cm">/*23 Tag Message                */</span>
	<span class="n">u8</span> <span class="n">cdb</span><span class="p">[</span><span class="n">IMAX_CDB</span><span class="p">];</span>	<span class="cm">/*24 SCSI CDBs                  */</span>
	<span class="n">u8</span> <span class="n">scbidx</span><span class="p">;</span>	<span class="cm">/*3C Index for this ORCSCB      */</span>
	<span class="n">u32</span> <span class="n">sense_addr</span><span class="p">;</span>	<span class="cm">/*34 Sense Buffer physical Addr */</span>

	<span class="k">struct</span> <span class="n">orc_extended_scb</span> <span class="o">*</span><span class="n">escb</span><span class="p">;</span> <span class="cm">/*38 Extended SCB Pointer       */</span>
        <span class="cm">/* 64bit pointer or 32bit pointer + reserved ? */</span>
<span class="cp">#ifndef CONFIG_64BIT</span>
	<span class="n">u8</span> <span class="n">reserved2</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>	<span class="cm">/*3E Reserved for Driver use    */</span>
<span class="cp">#endif</span>
<span class="p">};</span>

<span class="cm">/* Opcodes of ORCSCB_Opcode */</span>
<span class="cp">#define ORC_EXECSCSI	0x00	</span><span class="cm">/* SCSI initiator command with residual */</span><span class="cp"></span>
<span class="cp">#define ORC_BUSDEVRST	0x01	</span><span class="cm">/* SCSI Bus Device Reset  */</span><span class="cp"></span>

<span class="cm">/* Status of ORCSCB_Status */</span>
<span class="cp">#define ORCSCB_COMPLETE	0x00	</span><span class="cm">/* SCB request completed  */</span><span class="cp"></span>
<span class="cp">#define ORCSCB_POST	0x01	</span><span class="cm">/* SCB is posted by the HOST      */</span><span class="cp"></span>

<span class="cm">/* Bit Definition for ORCSCB_Flags */</span>
<span class="cp">#define SCF_DISINT	0x01	</span><span class="cm">/* Disable HOST interrupt */</span><span class="cp"></span>
<span class="cp">#define SCF_DIR		0x18	</span><span class="cm">/* Direction bits         */</span><span class="cp"></span>
<span class="cp">#define SCF_NO_DCHK	0x00	</span><span class="cm">/* Direction determined by SCSI   */</span><span class="cp"></span>
<span class="cp">#define SCF_DIN		0x08	</span><span class="cm">/* From Target to Initiator       */</span><span class="cp"></span>
<span class="cp">#define SCF_DOUT	0x10	</span><span class="cm">/* From Initiator to Target       */</span><span class="cp"></span>
<span class="cp">#define SCF_NO_XF	0x18	</span><span class="cm">/* No data transfer               */</span><span class="cp"></span>
<span class="cp">#define SCF_POLL   0x40</span>

<span class="cm">/* Error Codes for ORCSCB_HaStat */</span>
<span class="cp">#define HOST_SEL_TOUT	0x11</span>
<span class="cp">#define HOST_DO_DU	0x12</span>
<span class="cp">#define HOST_BUS_FREE	0x13</span>
<span class="cp">#define HOST_BAD_PHAS	0x14</span>
<span class="cp">#define HOST_INV_CMD	0x16</span>
<span class="cp">#define HOST_SCSI_RST	0x1B</span>
<span class="cp">#define HOST_DEV_RST	0x1C</span>


<span class="cm">/* Error Codes for ORCSCB_TaStat */</span>
<span class="cp">#define TARGET_CHK_COND	0x02</span>
<span class="cp">#define TARGET_BUSY	0x08</span>
<span class="cp">#define TARGET_TAG_FULL	0x28</span>


<span class="cm">/***********************************************************************</span>
<span class="cm">		Target Device Control Structure</span>
<span class="cm">**********************************************************************/</span>

<span class="k">struct</span> <span class="n">orc_target</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">TCS_DrvDASD</span><span class="p">;</span>	<span class="cm">/* 6 */</span>
	<span class="n">u8</span> <span class="n">TCS_DrvSCSI</span><span class="p">;</span>	<span class="cm">/* 7 */</span>
	<span class="n">u8</span> <span class="n">TCS_DrvHead</span><span class="p">;</span>	<span class="cm">/* 8 */</span>
	<span class="n">u16</span> <span class="n">TCS_DrvFlags</span><span class="p">;</span>	<span class="cm">/* 4 */</span>
	<span class="n">u8</span> <span class="n">TCS_DrvSector</span><span class="p">;</span>	<span class="cm">/* 7 */</span>
<span class="p">};</span>

<span class="cm">/* Bit Definition for TCF_DrvFlags */</span>
<span class="cp">#define	TCS_DF_NODASD_SUPT	0x20	</span><span class="cm">/* Suppress OS/2 DASD Mgr support */</span><span class="cp"></span>
<span class="cp">#define	TCS_DF_NOSCSI_SUPT	0x40	</span><span class="cm">/* Suppress OS/2 SCSI Mgr support */</span><span class="cp"></span>


<span class="cm">/***********************************************************************</span>
<span class="cm">              Host Adapter Control Structure</span>
<span class="cm">************************************************************************/</span>
<span class="k">struct</span> <span class="n">orc_host</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">base</span><span class="p">;</span>	<span class="cm">/* Base address */</span>
	<span class="n">u8</span> <span class="n">index</span><span class="p">;</span>		<span class="cm">/* Index (Channel)*/</span>
	<span class="n">u8</span> <span class="n">scsi_id</span><span class="p">;</span>		<span class="cm">/* H/A SCSI ID */</span>
	<span class="n">u8</span> <span class="n">BIOScfg</span><span class="p">;</span>		<span class="cm">/*BIOS configuration */</span>
	<span class="n">u8</span> <span class="n">flags</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">max_targets</span><span class="p">;</span>		<span class="cm">/* SCSI0MAXTags */</span>
	<span class="k">struct</span> <span class="n">orc_scb</span> <span class="o">*</span><span class="n">scb_virt</span><span class="p">;</span>	<span class="cm">/* Virtual Pointer to SCB array */</span>
	<span class="n">dma_addr_t</span> <span class="n">scb_phys</span><span class="p">;</span>	<span class="cm">/* Scb Physical address */</span>
	<span class="k">struct</span> <span class="n">orc_extended_scb</span> <span class="o">*</span><span class="n">escb_virt</span><span class="p">;</span> <span class="cm">/* Virtual pointer to ESCB Scatter list */</span>
	<span class="n">dma_addr_t</span> <span class="n">escb_phys</span><span class="p">;</span>	<span class="cm">/* scatter list Physical address */</span>
	<span class="n">u8</span> <span class="n">target_flag</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>	<span class="cm">/* target configuration, TCF_EN_TAG */</span>
	<span class="n">u8</span> <span class="n">max_tags</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>	<span class="cm">/* ORC_MAX_SCBS */</span>
	<span class="n">u32</span> <span class="n">allocation_map</span><span class="p">[</span><span class="n">MAX_CHANNELS</span><span class="p">][</span><span class="mi">8</span><span class="p">];</span>	<span class="cm">/* Max STB is 256, So 256/32 */</span>
	<span class="n">spinlock_t</span> <span class="n">allocation_lock</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">pci_dev</span> <span class="o">*</span><span class="n">pdev</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* Bit Definition for HCS_Flags */</span>

<span class="cp">#define HCF_SCSI_RESET	0x01	</span><span class="cm">/* SCSI BUS RESET         */</span><span class="cp"></span>
<span class="cp">#define HCF_PARITY    	0x02	</span><span class="cm">/* parity card                    */</span><span class="cp"></span>
<span class="cp">#define HCF_LVDS     	0x10	</span><span class="cm">/* parity card                    */</span><span class="cp"></span>

<span class="cm">/* Bit Definition for TargetFlag */</span>

<span class="cp">#define TCF_EN_255	    0x08</span>
<span class="cp">#define TCF_EN_TAG	    0x10</span>
<span class="cp">#define TCF_BUSY	      0x20</span>
<span class="cp">#define TCF_DISCONNECT	0x40</span>
<span class="cp">#define TCF_SPIN_UP	  0x80</span>

<span class="cm">/* Bit Definition for HCS_AFlags */</span>
<span class="cp">#define	HCS_AF_IGNORE		0x01	</span><span class="cm">/* Adapter ignore         */</span><span class="cp"></span>
<span class="cp">#define	HCS_AF_DISABLE_RESET	0x10	</span><span class="cm">/* Adapter disable reset  */</span><span class="cp"></span>
<span class="cp">#define	HCS_AF_DISABLE_ADPT	0x80	</span><span class="cm">/* Adapter disable                */</span><span class="cp"></span>

<span class="k">struct</span> <span class="n">orc_nvram</span> <span class="p">{</span>
<span class="cm">/*----------header ---------------*/</span>
        <span class="n">u8</span> <span class="n">SubVendorID0</span><span class="p">;</span>     <span class="cm">/* 00 - Sub Vendor ID           */</span>
        <span class="n">u8</span> <span class="n">SubVendorID1</span><span class="p">;</span>     <span class="cm">/* 00 - Sub Vendor ID           */</span>
        <span class="n">u8</span> <span class="n">SubSysID0</span><span class="p">;</span>        <span class="cm">/* 02 - Sub System ID           */</span>
        <span class="n">u8</span> <span class="n">SubSysID1</span><span class="p">;</span>        <span class="cm">/* 02 - Sub System ID           */</span>
        <span class="n">u8</span> <span class="n">SubClass</span><span class="p">;</span>         <span class="cm">/* 04 - Sub Class               */</span>
        <span class="n">u8</span> <span class="n">VendorID0</span><span class="p">;</span>        <span class="cm">/* 05 - Vendor ID               */</span>
        <span class="n">u8</span> <span class="n">VendorID1</span><span class="p">;</span>        <span class="cm">/* 05 - Vendor ID               */</span>
        <span class="n">u8</span> <span class="n">DeviceID0</span><span class="p">;</span>        <span class="cm">/* 07 - Device ID               */</span>
        <span class="n">u8</span> <span class="n">DeviceID1</span><span class="p">;</span>        <span class="cm">/* 07 - Device ID               */</span>
        <span class="n">u8</span> <span class="n">Reserved0</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>     <span class="cm">/* 09 - Reserved                */</span>
        <span class="n">u8</span> <span class="n">revision</span><span class="p">;</span>         <span class="cm">/* 0B - revision of data structure */</span>
        <span class="cm">/* ----Host Adapter Structure ---- */</span>
        <span class="n">u8</span> <span class="n">NumOfCh</span><span class="p">;</span>          <span class="cm">/* 0C - Number of SCSI channel  */</span>
        <span class="n">u8</span> <span class="n">BIOSConfig1</span><span class="p">;</span>      <span class="cm">/* 0D - BIOS configuration 1    */</span>
        <span class="n">u8</span> <span class="n">BIOSConfig2</span><span class="p">;</span>      <span class="cm">/* 0E - BIOS boot channel&amp;target ID */</span>
        <span class="n">u8</span> <span class="n">BIOSConfig3</span><span class="p">;</span>      <span class="cm">/* 0F - BIOS configuration 3    */</span>
        <span class="cm">/* ----SCSI channel Structure ---- */</span>
        <span class="cm">/* from &quot;CTRL-I SCSI Host Adapter SetUp menu &quot;  */</span>
        <span class="n">u8</span> <span class="n">scsi_id</span><span class="p">;</span>          <span class="cm">/* 10 - Channel 0 SCSI ID       */</span>
        <span class="n">u8</span> <span class="n">SCSI0Config</span><span class="p">;</span>      <span class="cm">/* 11 - Channel 0 SCSI configuration */</span>
        <span class="n">u8</span> <span class="n">SCSI0MaxTags</span><span class="p">;</span>     <span class="cm">/* 12 - Channel 0 Maximum tags  */</span>
        <span class="n">u8</span> <span class="n">SCSI0ResetTime</span><span class="p">;</span>   <span class="cm">/* 13 - Channel 0 Reset recovering time */</span>
        <span class="n">u8</span> <span class="n">ReservedforChannel0</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>   <span class="cm">/* 14 - Reserved                */</span>

        <span class="cm">/* ----SCSI target Structure ----  */</span>
        <span class="cm">/* from &quot;CTRL-I SCSI device SetUp menu &quot;                        */</span>
        <span class="n">u8</span> <span class="n">Target00Config</span><span class="p">;</span>   <span class="cm">/* 16 - Channel 0 Target 0 config */</span>
        <span class="n">u8</span> <span class="n">Target01Config</span><span class="p">;</span>   <span class="cm">/* 17 - Channel 0 Target 1 config */</span>
        <span class="n">u8</span> <span class="n">Target02Config</span><span class="p">;</span>   <span class="cm">/* 18 - Channel 0 Target 2 config */</span>
        <span class="n">u8</span> <span class="n">Target03Config</span><span class="p">;</span>   <span class="cm">/* 19 - Channel 0 Target 3 config */</span>
        <span class="n">u8</span> <span class="n">Target04Config</span><span class="p">;</span>   <span class="cm">/* 1A - Channel 0 Target 4 config */</span>
        <span class="n">u8</span> <span class="n">Target05Config</span><span class="p">;</span>   <span class="cm">/* 1B - Channel 0 Target 5 config */</span>
        <span class="n">u8</span> <span class="n">Target06Config</span><span class="p">;</span>   <span class="cm">/* 1C - Channel 0 Target 6 config */</span>
        <span class="n">u8</span> <span class="n">Target07Config</span><span class="p">;</span>   <span class="cm">/* 1D - Channel 0 Target 7 config */</span>
        <span class="n">u8</span> <span class="n">Target08Config</span><span class="p">;</span>   <span class="cm">/* 1E - Channel 0 Target 8 config */</span>
        <span class="n">u8</span> <span class="n">Target09Config</span><span class="p">;</span>   <span class="cm">/* 1F - Channel 0 Target 9 config */</span>
        <span class="n">u8</span> <span class="n">Target0AConfig</span><span class="p">;</span>   <span class="cm">/* 20 - Channel 0 Target A config */</span>
        <span class="n">u8</span> <span class="n">Target0BConfig</span><span class="p">;</span>   <span class="cm">/* 21 - Channel 0 Target B config */</span>
        <span class="n">u8</span> <span class="n">Target0CConfig</span><span class="p">;</span>   <span class="cm">/* 22 - Channel 0 Target C config */</span>
        <span class="n">u8</span> <span class="n">Target0DConfig</span><span class="p">;</span>   <span class="cm">/* 23 - Channel 0 Target D config */</span>
        <span class="n">u8</span> <span class="n">Target0EConfig</span><span class="p">;</span>   <span class="cm">/* 24 - Channel 0 Target E config */</span>
        <span class="n">u8</span> <span class="n">Target0FConfig</span><span class="p">;</span>   <span class="cm">/* 25 - Channel 0 Target F config */</span>

        <span class="n">u8</span> <span class="n">SCSI1Id</span><span class="p">;</span>          <span class="cm">/* 26 - Channel 1 SCSI ID       */</span>
        <span class="n">u8</span> <span class="n">SCSI1Config</span><span class="p">;</span>      <span class="cm">/* 27 - Channel 1 SCSI configuration */</span>
        <span class="n">u8</span> <span class="n">SCSI1MaxTags</span><span class="p">;</span>     <span class="cm">/* 28 - Channel 1 Maximum tags  */</span>
        <span class="n">u8</span> <span class="n">SCSI1ResetTime</span><span class="p">;</span>   <span class="cm">/* 29 - Channel 1 Reset recovering time */</span>
        <span class="n">u8</span> <span class="n">ReservedforChannel1</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>   <span class="cm">/* 2A - Reserved                */</span>

        <span class="cm">/* ----SCSI target Structure ----  */</span>
        <span class="cm">/* from &quot;CTRL-I SCSI device SetUp menu &quot;                                          */</span>
        <span class="n">u8</span> <span class="n">Target10Config</span><span class="p">;</span>   <span class="cm">/* 2C - Channel 1 Target 0 config */</span>
        <span class="n">u8</span> <span class="n">Target11Config</span><span class="p">;</span>   <span class="cm">/* 2D - Channel 1 Target 1 config */</span>
        <span class="n">u8</span> <span class="n">Target12Config</span><span class="p">;</span>   <span class="cm">/* 2E - Channel 1 Target 2 config */</span>
        <span class="n">u8</span> <span class="n">Target13Config</span><span class="p">;</span>   <span class="cm">/* 2F - Channel 1 Target 3 config */</span>
        <span class="n">u8</span> <span class="n">Target14Config</span><span class="p">;</span>   <span class="cm">/* 30 - Channel 1 Target 4 config */</span>
        <span class="n">u8</span> <span class="n">Target15Config</span><span class="p">;</span>   <span class="cm">/* 31 - Channel 1 Target 5 config */</span>
        <span class="n">u8</span> <span class="n">Target16Config</span><span class="p">;</span>   <span class="cm">/* 32 - Channel 1 Target 6 config */</span>
        <span class="n">u8</span> <span class="n">Target17Config</span><span class="p">;</span>   <span class="cm">/* 33 - Channel 1 Target 7 config */</span>
        <span class="n">u8</span> <span class="n">Target18Config</span><span class="p">;</span>   <span class="cm">/* 34 - Channel 1 Target 8 config */</span>
        <span class="n">u8</span> <span class="n">Target19Config</span><span class="p">;</span>   <span class="cm">/* 35 - Channel 1 Target 9 config */</span>
        <span class="n">u8</span> <span class="n">Target1AConfig</span><span class="p">;</span>   <span class="cm">/* 36 - Channel 1 Target A config */</span>
        <span class="n">u8</span> <span class="n">Target1BConfig</span><span class="p">;</span>   <span class="cm">/* 37 - Channel 1 Target B config */</span>
        <span class="n">u8</span> <span class="n">Target1CConfig</span><span class="p">;</span>   <span class="cm">/* 38 - Channel 1 Target C config */</span>
        <span class="n">u8</span> <span class="n">Target1DConfig</span><span class="p">;</span>   <span class="cm">/* 39 - Channel 1 Target D config */</span>
        <span class="n">u8</span> <span class="n">Target1EConfig</span><span class="p">;</span>   <span class="cm">/* 3A - Channel 1 Target E config */</span>
        <span class="n">u8</span> <span class="n">Target1FConfig</span><span class="p">;</span>   <span class="cm">/* 3B - Channel 1 Target F config */</span>
        <span class="n">u8</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>      <span class="cm">/* 3C - Reserved                */</span>
        <span class="cm">/* ---------- CheckSum ----------       */</span>
        <span class="n">u8</span> <span class="n">CheckSum</span><span class="p">;</span>         <span class="cm">/* 3F - Checksum of NVRam       */</span>
<span class="p">};</span>

<span class="cm">/* Bios Configuration for nvram-&gt;BIOSConfig1                            */</span>
<span class="cp">#define NBC_BIOSENABLE  0x01    </span><span class="cm">/* BIOS enable                    */</span><span class="cp"></span>
<span class="cp">#define NBC_CDROM       0x02    </span><span class="cm">/* Support bootable CDROM */</span><span class="cp"></span>
<span class="cp">#define NBC_REMOVABLE   0x04    </span><span class="cm">/* Support removable drive        */</span><span class="cp"></span>

<span class="cm">/* Bios Configuration for nvram-&gt;BIOSConfig2                            */</span>
<span class="cp">#define NBB_TARGET_MASK 0x0F    </span><span class="cm">/* Boot SCSI target ID number     */</span><span class="cp"></span>
<span class="cp">#define NBB_CHANL_MASK  0xF0    </span><span class="cm">/* Boot SCSI channel number       */</span><span class="cp"></span>

<span class="cm">/* Bit definition for nvram-&gt;SCSIConfig                                 */</span>
<span class="cp">#define NCC_BUSRESET    0x01    </span><span class="cm">/* Reset SCSI bus at power up     */</span><span class="cp"></span>
<span class="cp">#define NCC_PARITYCHK   0x02    </span><span class="cm">/* SCSI parity enable             */</span><span class="cp"></span>
<span class="cp">#define NCC_LVDS        0x10    </span><span class="cm">/* Enable LVDS                    */</span><span class="cp"></span>
<span class="cp">#define NCC_ACTTERM1    0x20    </span><span class="cm">/* Enable active terminator 1     */</span><span class="cp"></span>
<span class="cp">#define NCC_ACTTERM2    0x40    </span><span class="cm">/* Enable active terminator 2     */</span><span class="cp"></span>
<span class="cp">#define NCC_AUTOTERM    0x80    </span><span class="cm">/* Enable auto termination        */</span><span class="cp"></span>

<span class="cm">/* Bit definition for nvram-&gt;TargetxConfig                              */</span>
<span class="cp">#define NTC_PERIOD      0x07    </span><span class="cm">/* Maximum Sync. Speed            */</span><span class="cp"></span>
<span class="cp">#define NTC_1GIGA       0x08    </span><span class="cm">/* 255 head / 63 sectors (64/32) */</span><span class="cp"></span>
<span class="cp">#define NTC_NO_SYNC     0x10    </span><span class="cm">/* NO SYNC. NEGO          */</span><span class="cp"></span>
<span class="cp">#define NTC_NO_WIDESYNC 0x20    </span><span class="cm">/* NO WIDE SYNC. NEGO             */</span><span class="cp"></span>
<span class="cp">#define NTC_DISC_ENABLE 0x40    </span><span class="cm">/* Enable SCSI disconnect */</span><span class="cp"></span>
<span class="cp">#define NTC_SPINUP      0x80    </span><span class="cm">/* Start disk drive               */</span><span class="cp"></span>

<span class="cm">/* Default NVRam values                                                 */</span>
<span class="cp">#define NBC_DEFAULT     (NBC_ENABLE)</span>
<span class="cp">#define NCC_DEFAULT     (NCC_BUSRESET | NCC_AUTOTERM | NCC_PARITYCHK)</span>
<span class="cp">#define NCC_MAX_TAGS    0x20    </span><span class="cm">/* Maximum tags per target        */</span><span class="cp"></span>
<span class="cp">#define NCC_RESET_TIME  0x0A    </span><span class="cm">/* SCSI RESET recovering time     */</span><span class="cp"></span>
<span class="cp">#define NTC_DEFAULT     (NTC_1GIGA | NTC_NO_WIDESYNC | NTC_DISC_ENABLE)</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
