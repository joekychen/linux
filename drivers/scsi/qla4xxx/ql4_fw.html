<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › scsi › qla4xxx › ql4_fw.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>ql4_fw.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * QLogic iSCSI HBA Driver</span>
<span class="cm"> * Copyright (c)  2003-2010 QLogic Corporation</span>
<span class="cm"> *</span>
<span class="cm"> * See LICENSE.qla4xxx for copyright and licensing details.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _QLA4X_FW_H</span>
<span class="cp">#define _QLA4X_FW_H</span>


<span class="cp">#define MAX_PRST_DEV_DB_ENTRIES		64</span>
<span class="cp">#define MIN_DISC_DEV_DB_ENTRY		MAX_PRST_DEV_DB_ENTRIES</span>
<span class="cp">#define MAX_DEV_DB_ENTRIES		512</span>
<span class="cp">#define MAX_DEV_DB_ENTRIES_40XX		256</span>

<span class="cm">/*************************************************************************</span>
<span class="cm"> *</span>
<span class="cm"> *		ISP 4010 I/O Register Set Structure and Definitions</span>
<span class="cm"> *</span>
<span class="cm"> *************************************************************************/</span>

<span class="k">struct</span> <span class="n">port_ctrl_stat_regs</span> <span class="p">{</span>
	<span class="n">__le32</span> <span class="n">ext_hw_conf</span><span class="p">;</span>	<span class="cm">/* 0x50  R/W */</span>
	<span class="n">__le32</span> <span class="n">rsrvd0</span><span class="p">;</span>		<span class="cm">/* 0x54 */</span>
	<span class="n">__le32</span> <span class="n">port_ctrl</span><span class="p">;</span>	<span class="cm">/* 0x58 */</span>
	<span class="n">__le32</span> <span class="n">port_status</span><span class="p">;</span>	<span class="cm">/* 0x5c */</span>
	<span class="n">__le32</span> <span class="n">rsrvd1</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>	<span class="cm">/* 0x60-0xdf */</span>
	<span class="n">__le32</span> <span class="n">gp_out</span><span class="p">;</span>		<span class="cm">/* 0xe0 */</span>
	<span class="n">__le32</span> <span class="n">gp_in</span><span class="p">;</span>		<span class="cm">/* 0xe4 */</span>
	<span class="n">__le32</span> <span class="n">rsrvd2</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>	<span class="cm">/* 0xe8-0xfb */</span>
	<span class="n">__le32</span> <span class="n">port_err_status</span><span class="p">;</span> <span class="cm">/* 0xfc */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">host_mem_cfg_regs</span> <span class="p">{</span>
	<span class="n">__le32</span> <span class="n">rsrvd0</span><span class="p">[</span><span class="mi">12</span><span class="p">];</span>	<span class="cm">/* 0x50-0x79 */</span>
	<span class="n">__le32</span> <span class="n">req_q_out</span><span class="p">;</span>	<span class="cm">/* 0x80 */</span>
	<span class="n">__le32</span> <span class="n">rsrvd1</span><span class="p">[</span><span class="mi">31</span><span class="p">];</span>	<span class="cm">/* 0x84-0xFF */</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * ISP 82xx I/O Register Set structure definitions.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">device_reg_82xx</span> <span class="p">{</span>
	<span class="n">__le32</span> <span class="n">req_q_out</span><span class="p">;</span>	<span class="cm">/* 0x0000 (R): Request Queue out-Pointer. */</span>
	<span class="n">__le32</span> <span class="n">reserve1</span><span class="p">[</span><span class="mi">63</span><span class="p">];</span>	<span class="cm">/* Request Queue out-Pointer. (64 * 4) */</span>
	<span class="n">__le32</span> <span class="n">rsp_q_in</span><span class="p">;</span>	<span class="cm">/* 0x0100 (R/W): Response Queue In-Pointer. */</span>
	<span class="n">__le32</span> <span class="n">reserve2</span><span class="p">[</span><span class="mi">63</span><span class="p">];</span>	<span class="cm">/* Response Queue In-Pointer. */</span>
	<span class="n">__le32</span> <span class="n">rsp_q_out</span><span class="p">;</span>	<span class="cm">/* 0x0200 (R/W): Response Queue Out-Pointer. */</span>
	<span class="n">__le32</span> <span class="n">reserve3</span><span class="p">[</span><span class="mi">63</span><span class="p">];</span>	<span class="cm">/* Response Queue Out-Pointer. */</span>

	<span class="n">__le32</span> <span class="n">mailbox_in</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>	<span class="cm">/* 0x0300 (R/W): Mail box In registers */</span>
	<span class="n">__le32</span> <span class="n">reserve4</span><span class="p">[</span><span class="mi">24</span><span class="p">];</span>
	<span class="n">__le32</span> <span class="n">hint</span><span class="p">;</span>		<span class="cm">/* 0x0380 (R/W): Host interrupt register */</span>
<span class="cp">#define HINT_MBX_INT_PENDING	BIT_0</span>
	<span class="n">__le32</span> <span class="n">reserve5</span><span class="p">[</span><span class="mi">31</span><span class="p">];</span>
	<span class="n">__le32</span> <span class="n">mailbox_out</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>	<span class="cm">/* 0x0400 (R): Mail box Out registers */</span>
	<span class="n">__le32</span> <span class="n">reserve6</span><span class="p">[</span><span class="mi">56</span><span class="p">];</span>

	<span class="n">__le32</span> <span class="n">host_status</span><span class="p">;</span>	<span class="cm">/* Offset 0x500 (R): host status */</span>
<span class="cp">#define HSRX_RISC_MB_INT	BIT_0  </span><span class="cm">/* RISC to Host Mailbox interrupt */</span><span class="cp"></span>
<span class="cp">#define HSRX_RISC_IOCB_INT	BIT_1  </span><span class="cm">/* RISC to Host IOCB interrupt */</span><span class="cp"></span>

	<span class="n">__le32</span> <span class="n">host_int</span><span class="p">;</span>	<span class="cm">/* Offset 0x0504 (R/W): Interrupt status. */</span>
<span class="cp">#define ISRX_82XX_RISC_INT	BIT_0 </span><span class="cm">/* RISC interrupt. */</span><span class="cp"></span>
<span class="p">};</span>

<span class="cm">/*  remote register set (access via PCI memory read/write) */</span>
<span class="k">struct</span> <span class="n">isp_reg</span> <span class="p">{</span>
<span class="cp">#define MBOX_REG_COUNT 8</span>
	<span class="n">__le32</span> <span class="n">mailbox</span><span class="p">[</span><span class="n">MBOX_REG_COUNT</span><span class="p">];</span>

	<span class="n">__le32</span> <span class="n">flash_address</span><span class="p">;</span>	<span class="cm">/* 0x20 */</span>
	<span class="n">__le32</span> <span class="n">flash_data</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">ctrl_status</span><span class="p">;</span>

	<span class="k">union</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">__le32</span> <span class="n">nvram</span><span class="p">;</span>
			<span class="n">__le32</span> <span class="n">reserved1</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="cm">/* 0x30 */</span>
		<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">isp4010</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">__le32</span> <span class="n">intr_mask</span><span class="p">;</span>
			<span class="n">__le32</span> <span class="n">nvram</span><span class="p">;</span> <span class="cm">/* 0x30 */</span>
			<span class="n">__le32</span> <span class="n">semaphore</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">isp4022</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">u1</span><span class="p">;</span>

	<span class="n">__le32</span> <span class="n">req_q_in</span><span class="p">;</span>    <span class="cm">/* SCSI Request Queue Producer Index */</span>
	<span class="n">__le32</span> <span class="n">rsp_q_out</span><span class="p">;</span>   <span class="cm">/* SCSI Completion Queue Consumer Index */</span>

	<span class="n">__le32</span> <span class="n">reserved2</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>	<span class="cm">/* 0x40 */</span>

	<span class="k">union</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">__le32</span> <span class="n">ext_hw_conf</span><span class="p">;</span> <span class="cm">/* 0x50 */</span>
			<span class="n">__le32</span> <span class="n">flow_ctrl</span><span class="p">;</span>
			<span class="n">__le32</span> <span class="n">port_ctrl</span><span class="p">;</span>
			<span class="n">__le32</span> <span class="n">port_status</span><span class="p">;</span>

			<span class="n">__le32</span> <span class="n">reserved3</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span> <span class="cm">/* 0x60 */</span>

			<span class="n">__le32</span> <span class="n">req_q_out</span><span class="p">;</span> <span class="cm">/* 0x80 */</span>

			<span class="n">__le32</span> <span class="n">reserved4</span><span class="p">[</span><span class="mi">23</span><span class="p">];</span> <span class="cm">/* 0x84 */</span>

			<span class="n">__le32</span> <span class="n">gp_out</span><span class="p">;</span> <span class="cm">/* 0xe0 */</span>
			<span class="n">__le32</span> <span class="n">gp_in</span><span class="p">;</span>

			<span class="n">__le32</span> <span class="n">reserved5</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>

			<span class="n">__le32</span> <span class="n">port_err_status</span><span class="p">;</span> <span class="cm">/* 0xfc */</span>
		<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">isp4010</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="k">union</span> <span class="p">{</span>
				<span class="k">struct</span> <span class="n">port_ctrl_stat_regs</span> <span class="n">p0</span><span class="p">;</span>
				<span class="k">struct</span> <span class="n">host_mem_cfg_regs</span> <span class="n">p1</span><span class="p">;</span>
			<span class="p">};</span>
		<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">isp4022</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">u2</span><span class="p">;</span>
<span class="p">};</span>				<span class="cm">/* 256 x100 */</span>


<span class="cm">/* Semaphore Defines for 4010 */</span>
<span class="cp">#define QL4010_DRVR_SEM_BITS	0x00000030</span>
<span class="cp">#define QL4010_GPIO_SEM_BITS	0x000000c0</span>
<span class="cp">#define QL4010_SDRAM_SEM_BITS	0x00000300</span>
<span class="cp">#define QL4010_PHY_SEM_BITS	0x00000c00</span>
<span class="cp">#define QL4010_NVRAM_SEM_BITS	0x00003000</span>
<span class="cp">#define QL4010_FLASH_SEM_BITS	0x0000c000</span>

<span class="cp">#define QL4010_DRVR_SEM_MASK	0x00300000</span>
<span class="cp">#define QL4010_GPIO_SEM_MASK	0x00c00000</span>
<span class="cp">#define QL4010_SDRAM_SEM_MASK	0x03000000</span>
<span class="cp">#define QL4010_PHY_SEM_MASK	0x0c000000</span>
<span class="cp">#define QL4010_NVRAM_SEM_MASK	0x30000000</span>
<span class="cp">#define QL4010_FLASH_SEM_MASK	0xc0000000</span>

<span class="cm">/* Semaphore Defines for 4022 */</span>
<span class="cp">#define QL4022_RESOURCE_MASK_BASE_CODE 0x7</span>
<span class="cp">#define QL4022_RESOURCE_BITS_BASE_CODE 0x4</span>


<span class="cp">#define QL4022_DRVR_SEM_MASK	(QL4022_RESOURCE_MASK_BASE_CODE &lt;&lt; (1+16))</span>
<span class="cp">#define QL4022_DDR_RAM_SEM_MASK (QL4022_RESOURCE_MASK_BASE_CODE &lt;&lt; (4+16))</span>
<span class="cp">#define QL4022_PHY_GIO_SEM_MASK (QL4022_RESOURCE_MASK_BASE_CODE &lt;&lt; (7+16))</span>
<span class="cp">#define QL4022_NVRAM_SEM_MASK	(QL4022_RESOURCE_MASK_BASE_CODE &lt;&lt; (10+16))</span>
<span class="cp">#define QL4022_FLASH_SEM_MASK	(QL4022_RESOURCE_MASK_BASE_CODE &lt;&lt; (13+16))</span>

<span class="cm">/* nvram address for 4032 */</span>
<span class="cp">#define NVRAM_PORT0_BOOT_MODE		0x03b1</span>
<span class="cp">#define NVRAM_PORT0_BOOT_PRI_TGT	0x03b2</span>
<span class="cp">#define NVRAM_PORT0_BOOT_SEC_TGT	0x03bb</span>
<span class="cp">#define NVRAM_PORT1_BOOT_MODE		0x07b1</span>
<span class="cp">#define NVRAM_PORT1_BOOT_PRI_TGT	0x07b2</span>
<span class="cp">#define NVRAM_PORT1_BOOT_SEC_TGT	0x07bb</span>


<span class="cm">/* Page # defines for 4022 */</span>
<span class="cp">#define PORT_CTRL_STAT_PAGE			0	</span><span class="cm">/* 4022 */</span><span class="cp"></span>
<span class="cp">#define HOST_MEM_CFG_PAGE			1	</span><span class="cm">/* 4022 */</span><span class="cp"></span>
<span class="cp">#define LOCAL_RAM_CFG_PAGE			2	</span><span class="cm">/* 4022 */</span><span class="cp"></span>
<span class="cp">#define PROT_STAT_PAGE				3	</span><span class="cm">/* 4022 */</span><span class="cp"></span>

<span class="cm">/* Register Mask - sets corresponding mask bits in the upper word */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">uint32_t</span> <span class="nf">set_rmask</span><span class="p">(</span><span class="kt">uint32_t</span> <span class="n">val</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">val</span> <span class="o">&amp;</span> <span class="mh">0xffff</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">val</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">);</span>
<span class="p">}</span>


<span class="k">static</span> <span class="kr">inline</span> <span class="kt">uint32_t</span> <span class="nf">clr_rmask</span><span class="p">(</span><span class="kt">uint32_t</span> <span class="n">val</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mi">0</span> <span class="o">|</span> <span class="p">(</span><span class="n">val</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/*  ctrl_status definitions */</span>
<span class="cp">#define CSR_SCSI_PAGE_SELECT			0x00000003</span>
<span class="cp">#define CSR_SCSI_INTR_ENABLE			0x00000004	</span><span class="cm">/* 4010 */</span><span class="cp"></span>
<span class="cp">#define CSR_SCSI_RESET_INTR			0x00000008</span>
<span class="cp">#define CSR_SCSI_COMPLETION_INTR		0x00000010</span>
<span class="cp">#define CSR_SCSI_PROCESSOR_INTR			0x00000020</span>
<span class="cp">#define CSR_INTR_RISC				0x00000040</span>
<span class="cp">#define CSR_BOOT_ENABLE				0x00000080</span>
<span class="cp">#define CSR_NET_PAGE_SELECT			0x00000300	</span><span class="cm">/* 4010 */</span><span class="cp"></span>
<span class="cp">#define CSR_FUNC_NUM				0x00000700	</span><span class="cm">/* 4022 */</span><span class="cp"></span>
<span class="cp">#define CSR_NET_RESET_INTR			0x00000800	</span><span class="cm">/* 4010 */</span><span class="cp"></span>
<span class="cp">#define CSR_FORCE_SOFT_RESET			0x00002000	</span><span class="cm">/* 4022 */</span><span class="cp"></span>
<span class="cp">#define CSR_FATAL_ERROR				0x00004000</span>
<span class="cp">#define CSR_SOFT_RESET				0x00008000</span>
<span class="cp">#define ISP_CONTROL_FN_MASK			CSR_FUNC_NUM</span>
<span class="cp">#define ISP_CONTROL_FN0_SCSI			0x0500</span>
<span class="cp">#define ISP_CONTROL_FN1_SCSI			0x0700</span>

<span class="cp">#define INTR_PENDING				(CSR_SCSI_COMPLETION_INTR |\</span>
<span class="cp">						 CSR_SCSI_PROCESSOR_INTR |\</span>
<span class="cp">						 CSR_SCSI_RESET_INTR)</span>

<span class="cm">/* ISP InterruptMask definitions */</span>
<span class="cp">#define IMR_SCSI_INTR_ENABLE			0x00000004	</span><span class="cm">/* 4022 */</span><span class="cp"></span>

<span class="cm">/* ISP 4022 nvram definitions */</span>
<span class="cp">#define NVR_WRITE_ENABLE			0x00000010	</span><span class="cm">/* 4022 */</span><span class="cp"></span>

<span class="cp">#define QL4010_NVRAM_SIZE			0x200</span>
<span class="cp">#define QL40X2_NVRAM_SIZE			0x800</span>

<span class="cm">/*  ISP port_status definitions */</span>

<span class="cm">/*  ISP Semaphore definitions */</span>

<span class="cm">/*  ISP General Purpose Output definitions */</span>
<span class="cp">#define GPOR_TOPCAT_RESET			0x00000004</span>

<span class="cm">/*  shadow registers (DMA&#39;d from HA to system memory.  read only) */</span>
<span class="k">struct</span> <span class="n">shadow_regs</span> <span class="p">{</span>
	<span class="cm">/* SCSI Request Queue Consumer Index */</span>
	<span class="n">__le32</span> <span class="n">req_q_out</span><span class="p">;</span>	<span class="cm">/*  0 x0   R */</span>

	<span class="cm">/* SCSI Completion Queue Producer Index */</span>
	<span class="n">__le32</span> <span class="n">rsp_q_in</span><span class="p">;</span>	<span class="cm">/*  4 x4   R */</span>
<span class="p">};</span>		  <span class="cm">/*  8 x8 */</span>


<span class="cm">/*  External hardware configuration register */</span>
<span class="k">union</span> <span class="n">external_hw_config_reg</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="p">{</span>
		<span class="cm">/* FIXME: Do we even need this?	 All values are</span>
<span class="cm">		 * referred to by 16 bit quantities.  Platform and</span>
<span class="cm">		 * endianess issues. */</span>
		<span class="n">__le32</span> <span class="n">bReserved0</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">__le32</span> <span class="n">bSDRAMProtectionMethod</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span>
		<span class="n">__le32</span> <span class="n">bSDRAMBanks</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">__le32</span> <span class="n">bSDRAMChipWidth</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">__le32</span> <span class="n">bSDRAMChipSize</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span>
		<span class="n">__le32</span> <span class="n">bParityDisable</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">__le32</span> <span class="n">bExternalMemoryType</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">__le32</span> <span class="n">bFlashBIOSWriteEnable</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">__le32</span> <span class="n">bFlashUpperBankSelect</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">__le32</span> <span class="n">bWriteBurst</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span>
		<span class="n">__le32</span> <span class="n">bReserved1</span><span class="o">:</span><span class="mi">3</span><span class="p">;</span>
		<span class="n">__le32</span> <span class="n">bMask</span><span class="o">:</span><span class="mi">16</span><span class="p">;</span>
	<span class="p">};</span>
	<span class="kt">uint32_t</span> <span class="n">Asuint32_t</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* 82XX Support  start */</span>
<span class="cm">/* 82xx Default FLT Addresses */</span>
<span class="cp">#define FA_FLASH_LAYOUT_ADDR_82		0xFC400</span>
<span class="cp">#define FA_FLASH_DESCR_ADDR_82		0xFC000</span>
<span class="cp">#define FA_BOOT_LOAD_ADDR_82		0x04000</span>
<span class="cp">#define FA_BOOT_CODE_ADDR_82		0x20000</span>
<span class="cp">#define FA_RISC_CODE_ADDR_82		0x40000</span>
<span class="cp">#define FA_GOLD_RISC_CODE_ADDR_82	0x80000</span>
<span class="cp">#define FA_FLASH_ISCSI_CHAP		0x540000</span>
<span class="cp">#define FA_FLASH_CHAP_SIZE		0xC0000</span>

<span class="cm">/* Flash Description Table */</span>
<span class="k">struct</span> <span class="n">qla_fdt_layout</span> <span class="p">{</span>
	<span class="kt">uint8_t</span> <span class="n">sig</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="kt">uint16_t</span> <span class="n">version</span><span class="p">;</span>
	<span class="kt">uint16_t</span> <span class="n">len</span><span class="p">;</span>
	<span class="kt">uint16_t</span> <span class="n">checksum</span><span class="p">;</span>
	<span class="kt">uint8_t</span> <span class="n">unused1</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="kt">uint8_t</span> <span class="n">model</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
	<span class="kt">uint16_t</span> <span class="n">man_id</span><span class="p">;</span>
	<span class="kt">uint16_t</span> <span class="n">id</span><span class="p">;</span>
	<span class="kt">uint8_t</span> <span class="n">flags</span><span class="p">;</span>
	<span class="kt">uint8_t</span> <span class="n">erase_cmd</span><span class="p">;</span>
	<span class="kt">uint8_t</span> <span class="n">alt_erase_cmd</span><span class="p">;</span>
	<span class="kt">uint8_t</span> <span class="n">wrt_enable_cmd</span><span class="p">;</span>
	<span class="kt">uint8_t</span> <span class="n">wrt_enable_bits</span><span class="p">;</span>
	<span class="kt">uint8_t</span> <span class="n">wrt_sts_reg_cmd</span><span class="p">;</span>
	<span class="kt">uint8_t</span> <span class="n">unprotect_sec_cmd</span><span class="p">;</span>
	<span class="kt">uint8_t</span> <span class="n">read_man_id_cmd</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">block_size</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">alt_block_size</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">flash_size</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">wrt_enable_data</span><span class="p">;</span>
	<span class="kt">uint8_t</span> <span class="n">read_id_addr_len</span><span class="p">;</span>
	<span class="kt">uint8_t</span> <span class="n">wrt_disable_bits</span><span class="p">;</span>
	<span class="kt">uint8_t</span> <span class="n">read_dev_id_len</span><span class="p">;</span>
	<span class="kt">uint8_t</span> <span class="n">chip_erase_cmd</span><span class="p">;</span>
	<span class="kt">uint16_t</span> <span class="n">read_timeout</span><span class="p">;</span>
	<span class="kt">uint8_t</span> <span class="n">protect_sec_cmd</span><span class="p">;</span>
	<span class="kt">uint8_t</span> <span class="n">unused2</span><span class="p">[</span><span class="mi">65</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/* Flash Layout Table */</span>

<span class="k">struct</span> <span class="n">qla_flt_location</span> <span class="p">{</span>
	<span class="kt">uint8_t</span> <span class="n">sig</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="kt">uint16_t</span> <span class="n">start_lo</span><span class="p">;</span>
	<span class="kt">uint16_t</span> <span class="n">start_hi</span><span class="p">;</span>
	<span class="kt">uint8_t</span> <span class="n">version</span><span class="p">;</span>
	<span class="kt">uint8_t</span> <span class="n">unused</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
	<span class="kt">uint16_t</span> <span class="n">checksum</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">qla_flt_header</span> <span class="p">{</span>
	<span class="kt">uint16_t</span> <span class="n">version</span><span class="p">;</span>
	<span class="kt">uint16_t</span> <span class="n">length</span><span class="p">;</span>
	<span class="kt">uint16_t</span> <span class="n">checksum</span><span class="p">;</span>
	<span class="kt">uint16_t</span> <span class="n">unused</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* 82xx FLT Regions */</span>
<span class="cp">#define FLT_REG_FDT		0x1a</span>
<span class="cp">#define FLT_REG_FLT		0x1c</span>
<span class="cp">#define FLT_REG_BOOTLOAD_82	0x72</span>
<span class="cp">#define FLT_REG_FW_82		0x74</span>
<span class="cp">#define FLT_REG_FW_82_1		0x97</span>
<span class="cp">#define FLT_REG_GOLD_FW_82	0x75</span>
<span class="cp">#define FLT_REG_BOOT_CODE_82	0x78</span>
<span class="cp">#define FLT_REG_ISCSI_PARAM	0x65</span>
<span class="cp">#define FLT_REG_ISCSI_CHAP	0x63</span>

<span class="k">struct</span> <span class="n">qla_flt_region</span> <span class="p">{</span>
	<span class="kt">uint32_t</span> <span class="n">code</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">size</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">start</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">end</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*************************************************************************</span>
<span class="cm"> *</span>
<span class="cm"> *		Mailbox Commands Structures and Definitions</span>
<span class="cm"> *</span>
<span class="cm"> *************************************************************************/</span>

<span class="cm">/*  Mailbox command definitions */</span>
<span class="cp">#define MBOX_CMD_ABOUT_FW			0x0009</span>
<span class="cp">#define MBOX_CMD_PING				0x000B</span>
<span class="cp">#define PING_IPV6_PROTOCOL_ENABLE		0x1</span>
<span class="cp">#define PING_IPV6_LINKLOCAL_ADDR		0x4</span>
<span class="cp">#define PING_IPV6_ADDR0				0x8</span>
<span class="cp">#define PING_IPV6_ADDR1				0xC</span>
<span class="cp">#define MBOX_CMD_ENABLE_INTRS			0x0010</span>
<span class="cp">#define INTR_DISABLE				0</span>
<span class="cp">#define INTR_ENABLE				1</span>
<span class="cp">#define MBOX_CMD_STOP_FW			0x0014</span>
<span class="cp">#define MBOX_CMD_ABORT_TASK			0x0015</span>
<span class="cp">#define MBOX_CMD_LUN_RESET			0x0016</span>
<span class="cp">#define MBOX_CMD_TARGET_WARM_RESET		0x0017</span>
<span class="cp">#define MBOX_CMD_GET_MANAGEMENT_DATA		0x001E</span>
<span class="cp">#define MBOX_CMD_GET_FW_STATUS			0x001F</span>
<span class="cp">#define MBOX_CMD_SET_ISNS_SERVICE		0x0021</span>
<span class="cp">#define ISNS_DISABLE				0</span>
<span class="cp">#define ISNS_ENABLE				1</span>
<span class="cp">#define MBOX_CMD_COPY_FLASH			0x0024</span>
<span class="cp">#define MBOX_CMD_WRITE_FLASH			0x0025</span>
<span class="cp">#define MBOX_CMD_READ_FLASH			0x0026</span>
<span class="cp">#define MBOX_CMD_CLEAR_DATABASE_ENTRY		0x0031</span>
<span class="cp">#define MBOX_CMD_CONN_OPEN			0x0074</span>
<span class="cp">#define MBOX_CMD_CONN_CLOSE_SESS_LOGOUT		0x0056</span>
<span class="cp">#define LOGOUT_OPTION_CLOSE_SESSION		0x0002</span>
<span class="cp">#define LOGOUT_OPTION_RELOGIN			0x0004</span>
<span class="cp">#define LOGOUT_OPTION_FREE_DDB			0x0008</span>
<span class="cp">#define MBOX_CMD_EXECUTE_IOCB_A64		0x005A</span>
<span class="cp">#define MBOX_CMD_INITIALIZE_FIRMWARE		0x0060</span>
<span class="cp">#define MBOX_CMD_GET_INIT_FW_CTRL_BLOCK		0x0061</span>
<span class="cp">#define MBOX_CMD_REQUEST_DATABASE_ENTRY		0x0062</span>
<span class="cp">#define MBOX_CMD_SET_DATABASE_ENTRY		0x0063</span>
<span class="cp">#define MBOX_CMD_GET_DATABASE_ENTRY		0x0064</span>
<span class="cp">#define DDB_DS_UNASSIGNED			0x00</span>
<span class="cp">#define DDB_DS_NO_CONNECTION_ACTIVE		0x01</span>
<span class="cp">#define DDB_DS_DISCOVERY			0x02</span>
<span class="cp">#define DDB_DS_SESSION_ACTIVE			0x04</span>
<span class="cp">#define DDB_DS_SESSION_FAILED			0x06</span>
<span class="cp">#define DDB_DS_LOGIN_IN_PROCESS			0x07</span>
<span class="cp">#define MBOX_CMD_GET_FW_STATE			0x0069</span>
<span class="cp">#define MBOX_CMD_GET_INIT_FW_CTRL_BLOCK_DEFAULTS 0x006A</span>
<span class="cp">#define MBOX_CMD_GET_SYS_INFO			0x0078</span>
<span class="cp">#define MBOX_CMD_GET_NVRAM			0x0078	</span><span class="cm">/* For 40xx */</span><span class="cp"></span>
<span class="cp">#define MBOX_CMD_SET_NVRAM			0x0079	</span><span class="cm">/* For 40xx */</span><span class="cp"></span>
<span class="cp">#define MBOX_CMD_RESTORE_FACTORY_DEFAULTS	0x0087</span>
<span class="cp">#define MBOX_CMD_SET_ACB			0x0088</span>
<span class="cp">#define MBOX_CMD_GET_ACB			0x0089</span>
<span class="cp">#define MBOX_CMD_DISABLE_ACB			0x008A</span>
<span class="cp">#define MBOX_CMD_GET_IPV6_NEIGHBOR_CACHE	0x008B</span>
<span class="cp">#define MBOX_CMD_GET_IPV6_DEST_CACHE		0x008C</span>
<span class="cp">#define MBOX_CMD_GET_IPV6_DEF_ROUTER_LIST	0x008D</span>
<span class="cp">#define MBOX_CMD_GET_IPV6_LCL_PREFIX_LIST	0x008E</span>
<span class="cp">#define MBOX_CMD_SET_IPV6_NEIGHBOR_CACHE	0x0090</span>
<span class="cp">#define MBOX_CMD_GET_IP_ADDR_STATE		0x0091</span>
<span class="cp">#define MBOX_CMD_SEND_IPV6_ROUTER_SOL		0x0092</span>
<span class="cp">#define MBOX_CMD_GET_DB_ENTRY_CURRENT_IP_ADDR	0x0093</span>
<span class="cp">#define MBOX_CMD_MINIDUMP			0x0129</span>

<span class="cm">/* Minidump subcommand */</span>
<span class="cp">#define MINIDUMP_GET_SIZE_SUBCOMMAND		0x00</span>
<span class="cp">#define MINIDUMP_GET_TMPLT_SUBCOMMAND		0x01</span>

<span class="cm">/* Mailbox 1 */</span>
<span class="cp">#define FW_STATE_READY				0x0000</span>
<span class="cp">#define FW_STATE_CONFIG_WAIT			0x0001</span>
<span class="cp">#define FW_STATE_WAIT_AUTOCONNECT		0x0002</span>
<span class="cp">#define FW_STATE_ERROR				0x0004</span>
<span class="cp">#define FW_STATE_CONFIGURING_IP			0x0008</span>

<span class="cm">/* Mailbox 3 */</span>
<span class="cp">#define FW_ADDSTATE_OPTICAL_MEDIA		0x0001</span>
<span class="cp">#define FW_ADDSTATE_DHCPv4_ENABLED		0x0002</span>
<span class="cp">#define FW_ADDSTATE_DHCPv4_LEASE_ACQUIRED	0x0004</span>
<span class="cp">#define FW_ADDSTATE_DHCPv4_LEASE_EXPIRED	0x0008</span>
<span class="cp">#define FW_ADDSTATE_LINK_UP			0x0010</span>
<span class="cp">#define FW_ADDSTATE_ISNS_SVC_ENABLED		0x0020</span>
<span class="cp">#define FW_ADDSTATE_LINK_SPEED_10MBPS		0x0100</span>
<span class="cp">#define FW_ADDSTATE_LINK_SPEED_100MBPS		0x0200</span>
<span class="cp">#define FW_ADDSTATE_LINK_SPEED_1GBPS		0x0400</span>
<span class="cp">#define FW_ADDSTATE_LINK_SPEED_10GBPS		0x0800</span>

<span class="cp">#define MBOX_CMD_GET_DATABASE_ENTRY_DEFAULTS	0x006B</span>
<span class="cp">#define IPV6_DEFAULT_DDB_ENTRY			0x0001</span>

<span class="cp">#define MBOX_CMD_CONN_OPEN_SESS_LOGIN		0x0074</span>
<span class="cp">#define MBOX_CMD_GET_CRASH_RECORD		0x0076	</span><span class="cm">/* 4010 only */</span><span class="cp"></span>
<span class="cp">#define MBOX_CMD_GET_CONN_EVENT_LOG		0x0077</span>

<span class="cm">/*  Mailbox status definitions */</span>
<span class="cp">#define MBOX_COMPLETION_STATUS			4</span>
<span class="cp">#define MBOX_STS_BUSY				0x0007</span>
<span class="cp">#define MBOX_STS_INTERMEDIATE_COMPLETION	0x1000</span>
<span class="cp">#define MBOX_STS_COMMAND_COMPLETE		0x4000</span>
<span class="cp">#define MBOX_STS_COMMAND_ERROR			0x4005</span>

<span class="cp">#define MBOX_ASYNC_EVENT_STATUS			8</span>
<span class="cp">#define MBOX_ASTS_SYSTEM_ERROR			0x8002</span>
<span class="cp">#define MBOX_ASTS_REQUEST_TRANSFER_ERROR	0x8003</span>
<span class="cp">#define MBOX_ASTS_RESPONSE_TRANSFER_ERROR	0x8004</span>
<span class="cp">#define MBOX_ASTS_PROTOCOL_STATISTIC_ALARM	0x8005</span>
<span class="cp">#define MBOX_ASTS_SCSI_COMMAND_PDU_REJECTED	0x8006</span>
<span class="cp">#define MBOX_ASTS_LINK_UP			0x8010</span>
<span class="cp">#define MBOX_ASTS_LINK_DOWN			0x8011</span>
<span class="cp">#define MBOX_ASTS_DATABASE_CHANGED		0x8014</span>
<span class="cp">#define MBOX_ASTS_UNSOLICITED_PDU_RECEIVED	0x8015</span>
<span class="cp">#define MBOX_ASTS_SELF_TEST_FAILED		0x8016</span>
<span class="cp">#define MBOX_ASTS_LOGIN_FAILED			0x8017</span>
<span class="cp">#define MBOX_ASTS_DNS				0x8018</span>
<span class="cp">#define MBOX_ASTS_HEARTBEAT			0x8019</span>
<span class="cp">#define MBOX_ASTS_NVRAM_INVALID			0x801A</span>
<span class="cp">#define MBOX_ASTS_MAC_ADDRESS_CHANGED		0x801B</span>
<span class="cp">#define MBOX_ASTS_IP_ADDRESS_CHANGED		0x801C</span>
<span class="cp">#define MBOX_ASTS_DHCP_LEASE_EXPIRED		0x801D</span>
<span class="cp">#define MBOX_ASTS_DHCP_LEASE_ACQUIRED		0x801F</span>
<span class="cp">#define MBOX_ASTS_ISNS_UNSOLICITED_PDU_RECEIVED 0x8021</span>
<span class="cp">#define MBOX_ASTS_DUPLICATE_IP			0x8025</span>
<span class="cp">#define MBOX_ASTS_ARP_COMPLETE			0x8026</span>
<span class="cp">#define MBOX_ASTS_SUBNET_STATE_CHANGE		0x8027</span>
<span class="cp">#define MBOX_ASTS_RESPONSE_QUEUE_FULL		0x8028</span>
<span class="cp">#define MBOX_ASTS_IP_ADDR_STATE_CHANGED		0x8029</span>
<span class="cp">#define MBOX_ASTS_IPV6_PREFIX_EXPIRED		0x802B</span>
<span class="cp">#define MBOX_ASTS_IPV6_ND_PREFIX_IGNORED	0x802C</span>
<span class="cp">#define MBOX_ASTS_IPV6_LCL_PREFIX_IGNORED	0x802D</span>
<span class="cp">#define MBOX_ASTS_ICMPV6_ERROR_MSG_RCVD		0x802E</span>
<span class="cp">#define MBOX_ASTS_TXSCVR_INSERTED		0x8130</span>
<span class="cp">#define MBOX_ASTS_TXSCVR_REMOVED		0x8131</span>

<span class="cp">#define ISNS_EVENT_DATA_RECEIVED		0x0000</span>
<span class="cp">#define ISNS_EVENT_CONNECTION_OPENED		0x0001</span>
<span class="cp">#define ISNS_EVENT_CONNECTION_FAILED		0x0002</span>
<span class="cp">#define MBOX_ASTS_IPSEC_SYSTEM_FATAL_ERROR	0x8022</span>
<span class="cp">#define MBOX_ASTS_SUBNET_STATE_CHANGE		0x8027</span>

<span class="cm">/* ACB State Defines */</span>
<span class="cp">#define ACB_STATE_UNCONFIGURED	0x00</span>
<span class="cp">#define ACB_STATE_INVALID	0x01</span>
<span class="cp">#define ACB_STATE_ACQUIRING	0x02</span>
<span class="cp">#define ACB_STATE_TENTATIVE	0x03</span>
<span class="cp">#define ACB_STATE_DEPRICATED	0x04</span>
<span class="cp">#define ACB_STATE_VALID		0x05</span>
<span class="cp">#define ACB_STATE_DISABLING	0x06</span>

<span class="cm">/* FLASH offsets */</span>
<span class="cp">#define FLASH_SEGMENT_IFCB	0x04000000</span>

<span class="cp">#define FLASH_OPT_RMW_HOLD	0</span>
<span class="cp">#define FLASH_OPT_RMW_INIT	1</span>
<span class="cp">#define FLASH_OPT_COMMIT	2</span>
<span class="cp">#define FLASH_OPT_RMW_COMMIT	3</span>

<span class="cm">/*************************************************************************/</span>

<span class="cm">/* Host Adapter Initialization Control Block (from host) */</span>
<span class="k">struct</span> <span class="n">addr_ctrl_blk</span> <span class="p">{</span>
	<span class="kt">uint8_t</span> <span class="n">version</span><span class="p">;</span>	<span class="cm">/* 00 */</span>
<span class="cp">#define  IFCB_VER_MIN			0x01</span>
<span class="cp">#define  IFCB_VER_MAX			0x02</span>
	<span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span>	<span class="cm">/* 01 */</span>

	<span class="kt">uint16_t</span> <span class="n">fw_options</span><span class="p">;</span>	<span class="cm">/* 02-03 */</span>
<span class="cp">#define	 FWOPT_HEARTBEAT_ENABLE		  0x1000</span>
<span class="cp">#define	 FWOPT_SESSION_MODE		  0x0040</span>
<span class="cp">#define	 FWOPT_INITIATOR_MODE		  0x0020</span>
<span class="cp">#define	 FWOPT_TARGET_MODE		  0x0010</span>
<span class="cp">#define	 FWOPT_ENABLE_CRBDB		  0x8000</span>

	<span class="kt">uint16_t</span> <span class="n">exec_throttle</span><span class="p">;</span>	<span class="cm">/* 04-05 */</span>
	<span class="kt">uint8_t</span> <span class="n">zio_count</span><span class="p">;</span>	<span class="cm">/* 06 */</span>
	<span class="kt">uint8_t</span> <span class="n">res0</span><span class="p">;</span>	<span class="cm">/* 07 */</span>
	<span class="kt">uint16_t</span> <span class="n">eth_mtu_size</span><span class="p">;</span>	<span class="cm">/* 08-09 */</span>
	<span class="kt">uint16_t</span> <span class="n">add_fw_options</span><span class="p">;</span>	<span class="cm">/* 0A-0B */</span>
<span class="cp">#define ADFWOPT_SERIALIZE_TASK_MGMT	0x0400</span>
<span class="cp">#define ADFWOPT_AUTOCONN_DISABLE	0x0002</span>

	<span class="kt">uint8_t</span> <span class="n">hb_interval</span><span class="p">;</span>	<span class="cm">/* 0C */</span>
	<span class="kt">uint8_t</span> <span class="n">inst_num</span><span class="p">;</span> <span class="cm">/* 0D */</span>
	<span class="kt">uint16_t</span> <span class="n">res1</span><span class="p">;</span>		<span class="cm">/* 0E-0F */</span>
	<span class="kt">uint16_t</span> <span class="n">rqq_consumer_idx</span><span class="p">;</span>	<span class="cm">/* 10-11 */</span>
	<span class="kt">uint16_t</span> <span class="n">compq_producer_idx</span><span class="p">;</span>	<span class="cm">/* 12-13 */</span>
	<span class="kt">uint16_t</span> <span class="n">rqq_len</span><span class="p">;</span>	<span class="cm">/* 14-15 */</span>
	<span class="kt">uint16_t</span> <span class="n">compq_len</span><span class="p">;</span>	<span class="cm">/* 16-17 */</span>
	<span class="kt">uint32_t</span> <span class="n">rqq_addr_lo</span><span class="p">;</span>	<span class="cm">/* 18-1B */</span>
	<span class="kt">uint32_t</span> <span class="n">rqq_addr_hi</span><span class="p">;</span>	<span class="cm">/* 1C-1F */</span>
	<span class="kt">uint32_t</span> <span class="n">compq_addr_lo</span><span class="p">;</span>	<span class="cm">/* 20-23 */</span>
	<span class="kt">uint32_t</span> <span class="n">compq_addr_hi</span><span class="p">;</span>	<span class="cm">/* 24-27 */</span>
	<span class="kt">uint32_t</span> <span class="n">shdwreg_addr_lo</span><span class="p">;</span>	<span class="cm">/* 28-2B */</span>
	<span class="kt">uint32_t</span> <span class="n">shdwreg_addr_hi</span><span class="p">;</span>	<span class="cm">/* 2C-2F */</span>

	<span class="kt">uint16_t</span> <span class="n">iscsi_opts</span><span class="p">;</span>	<span class="cm">/* 30-31 */</span>
	<span class="kt">uint16_t</span> <span class="n">ipv4_tcp_opts</span><span class="p">;</span>	<span class="cm">/* 32-33 */</span>
<span class="cp">#define TCPOPT_DHCP_ENABLE		0x0200</span>
	<span class="kt">uint16_t</span> <span class="n">ipv4_ip_opts</span><span class="p">;</span>	<span class="cm">/* 34-35 */</span>
<span class="cp">#define IPOPT_IPV4_PROTOCOL_ENABLE	0x8000</span>
<span class="cp">#define IPOPT_VLAN_TAGGING_ENABLE	0x2000</span>

	<span class="kt">uint16_t</span> <span class="n">iscsi_max_pdu_size</span><span class="p">;</span>	<span class="cm">/* 36-37 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv4_tos</span><span class="p">;</span>	<span class="cm">/* 38 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv4_ttl</span><span class="p">;</span>	<span class="cm">/* 39 */</span>
	<span class="kt">uint8_t</span> <span class="n">acb_version</span><span class="p">;</span>	<span class="cm">/* 3A */</span>
<span class="cp">#define ACB_NOT_SUPPORTED		0x00</span>
<span class="cp">#define ACB_SUPPORTED			0x02 </span><span class="cm">/* Capable of ACB Version 2</span>
<span class="cm">						Features */</span><span class="cp"></span>

	<span class="kt">uint8_t</span> <span class="n">res2</span><span class="p">;</span>	<span class="cm">/* 3B */</span>
	<span class="kt">uint16_t</span> <span class="n">def_timeout</span><span class="p">;</span>	<span class="cm">/* 3C-3D */</span>
	<span class="kt">uint16_t</span> <span class="n">iscsi_fburst_len</span><span class="p">;</span>	<span class="cm">/* 3E-3F */</span>
	<span class="kt">uint16_t</span> <span class="n">iscsi_def_time2wait</span><span class="p">;</span>	<span class="cm">/* 40-41 */</span>
	<span class="kt">uint16_t</span> <span class="n">iscsi_def_time2retain</span><span class="p">;</span>	<span class="cm">/* 42-43 */</span>
	<span class="kt">uint16_t</span> <span class="n">iscsi_max_outstnd_r2t</span><span class="p">;</span>	<span class="cm">/* 44-45 */</span>
	<span class="kt">uint16_t</span> <span class="n">conn_ka_timeout</span><span class="p">;</span>	<span class="cm">/* 46-47 */</span>
	<span class="kt">uint16_t</span> <span class="n">ipv4_port</span><span class="p">;</span>	<span class="cm">/* 48-49 */</span>
	<span class="kt">uint16_t</span> <span class="n">iscsi_max_burst_len</span><span class="p">;</span>	<span class="cm">/* 4A-4B */</span>
	<span class="kt">uint32_t</span> <span class="n">res5</span><span class="p">;</span>		<span class="cm">/* 4C-4F */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv4_addr</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>	<span class="cm">/* 50-53 */</span>
	<span class="kt">uint16_t</span> <span class="n">ipv4_vlan_tag</span><span class="p">;</span>	<span class="cm">/* 54-55 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv4_addr_state</span><span class="p">;</span>	<span class="cm">/* 56 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv4_cacheid</span><span class="p">;</span>	<span class="cm">/* 57 */</span>
	<span class="kt">uint8_t</span> <span class="n">res6</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>	<span class="cm">/* 58-5F */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv4_subnet</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>	<span class="cm">/* 60-63 */</span>
	<span class="kt">uint8_t</span> <span class="n">res7</span><span class="p">[</span><span class="mi">12</span><span class="p">];</span>	<span class="cm">/* 64-6F */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv4_gw_addr</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>	<span class="cm">/* 70-73 */</span>
	<span class="kt">uint8_t</span> <span class="n">res8</span><span class="p">[</span><span class="mh">0xc</span><span class="p">];</span>	<span class="cm">/* 74-7F */</span>
	<span class="kt">uint8_t</span> <span class="n">pri_dns_srvr_ip</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span><span class="cm">/* 80-83 */</span>
	<span class="kt">uint8_t</span> <span class="n">sec_dns_srvr_ip</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span><span class="cm">/* 84-87 */</span>
	<span class="kt">uint16_t</span> <span class="n">min_eph_port</span><span class="p">;</span>	<span class="cm">/* 88-89 */</span>
	<span class="kt">uint16_t</span> <span class="n">max_eph_port</span><span class="p">;</span>	<span class="cm">/* 8A-8B */</span>
	<span class="kt">uint8_t</span> <span class="n">res9</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>	<span class="cm">/* 8C-8F */</span>
	<span class="kt">uint8_t</span> <span class="n">iscsi_alias</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span><span class="cm">/* 90-AF */</span>
	<span class="kt">uint8_t</span> <span class="n">res9_1</span><span class="p">[</span><span class="mh">0x16</span><span class="p">];</span>	<span class="cm">/* B0-C5 */</span>
	<span class="kt">uint16_t</span> <span class="n">tgt_portal_grp</span><span class="p">;</span><span class="cm">/* C6-C7 */</span>
	<span class="kt">uint8_t</span> <span class="n">abort_timer</span><span class="p">;</span>	<span class="cm">/* C8	 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv4_tcp_wsf</span><span class="p">;</span>	<span class="cm">/* C9	 */</span>
	<span class="kt">uint8_t</span> <span class="n">res10</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>	<span class="cm">/* CA-CF */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv4_sec_ip_addr</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>	<span class="cm">/* D0-D3 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv4_dhcp_vid_len</span><span class="p">;</span>	<span class="cm">/* D4 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv4_dhcp_vid</span><span class="p">[</span><span class="mi">11</span><span class="p">];</span>	<span class="cm">/* D5-DF */</span>
	<span class="kt">uint8_t</span> <span class="n">res11</span><span class="p">[</span><span class="mi">20</span><span class="p">];</span>	<span class="cm">/* E0-F3 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv4_dhcp_alt_cid_len</span><span class="p">;</span>	<span class="cm">/* F4 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv4_dhcp_alt_cid</span><span class="p">[</span><span class="mi">11</span><span class="p">];</span>	<span class="cm">/* F5-FF */</span>
	<span class="kt">uint8_t</span> <span class="n">iscsi_name</span><span class="p">[</span><span class="mi">224</span><span class="p">];</span>	<span class="cm">/* 100-1DF */</span>
	<span class="kt">uint8_t</span> <span class="n">res12</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>	<span class="cm">/* 1E0-1FF */</span>
	<span class="kt">uint32_t</span> <span class="n">cookie</span><span class="p">;</span>	<span class="cm">/* 200-203 */</span>
	<span class="kt">uint16_t</span> <span class="n">ipv6_port</span><span class="p">;</span>	<span class="cm">/* 204-205 */</span>
	<span class="kt">uint16_t</span> <span class="n">ipv6_opts</span><span class="p">;</span>	<span class="cm">/* 206-207 */</span>
<span class="cp">#define IPV6_OPT_IPV6_PROTOCOL_ENABLE	0x8000</span>
<span class="cp">#define IPV6_OPT_VLAN_TAGGING_ENABLE	0x2000</span>

	<span class="kt">uint16_t</span> <span class="n">ipv6_addtl_opts</span><span class="p">;</span>	<span class="cm">/* 208-209 */</span>
<span class="cp">#define IPV6_ADDOPT_NEIGHBOR_DISCOVERY_ADDR_ENABLE	0x0002 </span><span class="cm">/* Pri ACB</span>
<span class="cm">								  Only */</span><span class="cp"></span>
<span class="cp">#define IPV6_ADDOPT_AUTOCONFIG_LINK_LOCAL_ADDR		0x0001</span>

	<span class="kt">uint16_t</span> <span class="n">ipv6_tcp_opts</span><span class="p">;</span>	<span class="cm">/* 20A-20B */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv6_tcp_wsf</span><span class="p">;</span>	<span class="cm">/* 20C */</span>
	<span class="kt">uint16_t</span> <span class="n">ipv6_flow_lbl</span><span class="p">;</span>	<span class="cm">/* 20D-20F */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv6_dflt_rtr_addr</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span> <span class="cm">/* 210-21F */</span>
	<span class="kt">uint16_t</span> <span class="n">ipv6_vlan_tag</span><span class="p">;</span>	<span class="cm">/* 220-221 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv6_lnk_lcl_addr_state</span><span class="p">;</span><span class="cm">/* 222 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv6_addr0_state</span><span class="p">;</span>	<span class="cm">/* 223 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv6_addr1_state</span><span class="p">;</span>	<span class="cm">/* 224 */</span>
<span class="cp">#define IP_ADDRSTATE_UNCONFIGURED	0</span>
<span class="cp">#define IP_ADDRSTATE_INVALID		1</span>
<span class="cp">#define IP_ADDRSTATE_ACQUIRING		2</span>
<span class="cp">#define IP_ADDRSTATE_TENTATIVE		3</span>
<span class="cp">#define IP_ADDRSTATE_DEPRICATED		4</span>
<span class="cp">#define IP_ADDRSTATE_PREFERRED		5</span>
<span class="cp">#define IP_ADDRSTATE_DISABLING		6</span>

	<span class="kt">uint8_t</span> <span class="n">ipv6_dflt_rtr_state</span><span class="p">;</span>    <span class="cm">/* 225 */</span>
<span class="cp">#define IPV6_RTRSTATE_UNKNOWN                   0</span>
<span class="cp">#define IPV6_RTRSTATE_MANUAL                    1</span>
<span class="cp">#define IPV6_RTRSTATE_ADVERTISED                3</span>
<span class="cp">#define IPV6_RTRSTATE_STALE                     4</span>

	<span class="kt">uint8_t</span> <span class="n">ipv6_traffic_class</span><span class="p">;</span>	<span class="cm">/* 226 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv6_hop_limit</span><span class="p">;</span>	<span class="cm">/* 227 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv6_if_id</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>	<span class="cm">/* 228-22F */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv6_addr0</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>	<span class="cm">/* 230-23F */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv6_addr1</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>	<span class="cm">/* 240-24F */</span>
	<span class="kt">uint32_t</span> <span class="n">ipv6_nd_reach_time</span><span class="p">;</span>	<span class="cm">/* 250-253 */</span>
	<span class="kt">uint32_t</span> <span class="n">ipv6_nd_rexmit_timer</span><span class="p">;</span>	<span class="cm">/* 254-257 */</span>
	<span class="kt">uint32_t</span> <span class="n">ipv6_nd_stale_timeout</span><span class="p">;</span>	<span class="cm">/* 258-25B */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv6_dup_addr_detect_count</span><span class="p">;</span>	<span class="cm">/* 25C */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv6_cache_id</span><span class="p">;</span>	<span class="cm">/* 25D */</span>
	<span class="kt">uint8_t</span> <span class="n">res13</span><span class="p">[</span><span class="mi">18</span><span class="p">];</span>	<span class="cm">/* 25E-26F */</span>
	<span class="kt">uint32_t</span> <span class="n">ipv6_gw_advrt_mtu</span><span class="p">;</span>	<span class="cm">/* 270-273 */</span>
	<span class="kt">uint8_t</span> <span class="n">res14</span><span class="p">[</span><span class="mi">140</span><span class="p">];</span>	<span class="cm">/* 274-2FF */</span>
<span class="p">};</span>

<span class="cp">#define IP_ADDR_COUNT	4 </span><span class="cm">/* Total 4 IP address supported in one interface</span>
<span class="cm">			   * One IPv4, one IPv6 link local and 2 IPv6</span>
<span class="cm">			   */</span><span class="cp"></span>

<span class="cp">#define IP_STATE_MASK	0x0F000000</span>
<span class="cp">#define IP_STATE_SHIFT	24</span>

<span class="k">struct</span> <span class="n">init_fw_ctrl_blk</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">addr_ctrl_blk</span> <span class="n">pri</span><span class="p">;</span>
<span class="cm">/*	struct addr_ctrl_blk sec;*/</span>
<span class="p">};</span>

<span class="cp">#define PRIMARI_ACB		0</span>
<span class="cp">#define SECONDARY_ACB		1</span>

<span class="k">struct</span> <span class="n">addr_ctrl_blk_def</span> <span class="p">{</span>
	<span class="kt">uint8_t</span> <span class="n">reserved1</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>	<span class="cm">/* 00 */</span>
	<span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span>	<span class="cm">/* 01 */</span>
	<span class="kt">uint8_t</span> <span class="n">reserved2</span><span class="p">[</span><span class="mi">11</span><span class="p">];</span>	<span class="cm">/* 02-0C */</span>
	<span class="kt">uint8_t</span> <span class="n">inst_num</span><span class="p">;</span>	<span class="cm">/* 0D */</span>
	<span class="kt">uint8_t</span> <span class="n">reserved3</span><span class="p">[</span><span class="mi">34</span><span class="p">];</span>	<span class="cm">/* 0E-2F */</span>
	<span class="kt">uint16_t</span> <span class="n">iscsi_opts</span><span class="p">;</span>	<span class="cm">/* 30-31 */</span>
	<span class="kt">uint16_t</span> <span class="n">ipv4_tcp_opts</span><span class="p">;</span>	<span class="cm">/* 32-33 */</span>
	<span class="kt">uint16_t</span> <span class="n">ipv4_ip_opts</span><span class="p">;</span>	<span class="cm">/* 34-35 */</span>
	<span class="kt">uint16_t</span> <span class="n">iscsi_max_pdu_size</span><span class="p">;</span>	<span class="cm">/* 36-37 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv4_tos</span><span class="p">;</span>	<span class="cm">/* 38 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv4_ttl</span><span class="p">;</span>	<span class="cm">/* 39 */</span>
	<span class="kt">uint8_t</span> <span class="n">reserved4</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>	<span class="cm">/* 3A-3B */</span>
	<span class="kt">uint16_t</span> <span class="n">def_timeout</span><span class="p">;</span>	<span class="cm">/* 3C-3D */</span>
	<span class="kt">uint16_t</span> <span class="n">iscsi_fburst_len</span><span class="p">;</span>	<span class="cm">/* 3E-3F */</span>
	<span class="kt">uint8_t</span> <span class="n">reserved5</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>	<span class="cm">/* 40-43 */</span>
	<span class="kt">uint16_t</span> <span class="n">iscsi_max_outstnd_r2t</span><span class="p">;</span>	<span class="cm">/* 44-45 */</span>
	<span class="kt">uint8_t</span> <span class="n">reserved6</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>	<span class="cm">/* 46-47 */</span>
	<span class="kt">uint16_t</span> <span class="n">ipv4_port</span><span class="p">;</span>	<span class="cm">/* 48-49 */</span>
	<span class="kt">uint16_t</span> <span class="n">iscsi_max_burst_len</span><span class="p">;</span>	<span class="cm">/* 4A-4B */</span>
	<span class="kt">uint8_t</span> <span class="n">reserved7</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>	<span class="cm">/* 4C-4F */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv4_addr</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>	<span class="cm">/* 50-53 */</span>
	<span class="kt">uint16_t</span> <span class="n">ipv4_vlan_tag</span><span class="p">;</span>	<span class="cm">/* 54-55 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv4_addr_state</span><span class="p">;</span>	<span class="cm">/* 56 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv4_cacheid</span><span class="p">;</span>	<span class="cm">/* 57 */</span>
	<span class="kt">uint8_t</span> <span class="n">reserved8</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>	<span class="cm">/* 58-5F */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv4_subnet</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>	<span class="cm">/* 60-63 */</span>
	<span class="kt">uint8_t</span> <span class="n">reserved9</span><span class="p">[</span><span class="mi">12</span><span class="p">];</span>	<span class="cm">/* 64-6F */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv4_gw_addr</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>	<span class="cm">/* 70-73 */</span>
	<span class="kt">uint8_t</span> <span class="n">reserved10</span><span class="p">[</span><span class="mi">84</span><span class="p">];</span>	<span class="cm">/* 74-C7 */</span>
	<span class="kt">uint8_t</span> <span class="n">abort_timer</span><span class="p">;</span>	<span class="cm">/* C8    */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv4_tcp_wsf</span><span class="p">;</span>	<span class="cm">/* C9    */</span>
	<span class="kt">uint8_t</span> <span class="n">reserved11</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>	<span class="cm">/* CA-D3 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv4_dhcp_vid_len</span><span class="p">;</span>	<span class="cm">/* D4 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv4_dhcp_vid</span><span class="p">[</span><span class="mi">11</span><span class="p">];</span>	<span class="cm">/* D5-DF */</span>
	<span class="kt">uint8_t</span> <span class="n">reserved12</span><span class="p">[</span><span class="mi">20</span><span class="p">];</span>	<span class="cm">/* E0-F3 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv4_dhcp_alt_cid_len</span><span class="p">;</span>	<span class="cm">/* F4 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv4_dhcp_alt_cid</span><span class="p">[</span><span class="mi">11</span><span class="p">];</span>	<span class="cm">/* F5-FF */</span>
	<span class="kt">uint8_t</span> <span class="n">iscsi_name</span><span class="p">[</span><span class="mi">224</span><span class="p">];</span>	<span class="cm">/* 100-1DF */</span>
	<span class="kt">uint8_t</span> <span class="n">reserved13</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>	<span class="cm">/* 1E0-1FF */</span>
	<span class="kt">uint32_t</span> <span class="n">cookie</span><span class="p">;</span>	<span class="cm">/* 200-203 */</span>
	<span class="kt">uint16_t</span> <span class="n">ipv6_port</span><span class="p">;</span>	<span class="cm">/* 204-205 */</span>
	<span class="kt">uint16_t</span> <span class="n">ipv6_opts</span><span class="p">;</span>	<span class="cm">/* 206-207 */</span>
	<span class="kt">uint16_t</span> <span class="n">ipv6_addtl_opts</span><span class="p">;</span>	<span class="cm">/* 208-209 */</span>
	<span class="kt">uint16_t</span> <span class="n">ipv6_tcp_opts</span><span class="p">;</span>		<span class="cm">/* 20A-20B */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv6_tcp_wsf</span><span class="p">;</span>		<span class="cm">/* 20C */</span>
	<span class="kt">uint16_t</span> <span class="n">ipv6_flow_lbl</span><span class="p">;</span>		<span class="cm">/* 20D-20F */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv6_dflt_rtr_addr</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>	<span class="cm">/* 210-21F */</span>
	<span class="kt">uint16_t</span> <span class="n">ipv6_vlan_tag</span><span class="p">;</span>		<span class="cm">/* 220-221 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv6_lnk_lcl_addr_state</span><span class="p">;</span>	<span class="cm">/* 222 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv6_addr0_state</span><span class="p">;</span>	<span class="cm">/* 223 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv6_addr1_state</span><span class="p">;</span>	<span class="cm">/* 224 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv6_dflt_rtr_state</span><span class="p">;</span>	<span class="cm">/* 225 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv6_traffic_class</span><span class="p">;</span>	<span class="cm">/* 226 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv6_hop_limit</span><span class="p">;</span>		<span class="cm">/* 227 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv6_if_id</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>		<span class="cm">/* 228-22F */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv6_addr0</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>		<span class="cm">/* 230-23F */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv6_addr1</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>		<span class="cm">/* 240-24F */</span>
	<span class="kt">uint32_t</span> <span class="n">ipv6_nd_reach_time</span><span class="p">;</span>	<span class="cm">/* 250-253 */</span>
	<span class="kt">uint32_t</span> <span class="n">ipv6_nd_rexmit_timer</span><span class="p">;</span>	<span class="cm">/* 254-257 */</span>
	<span class="kt">uint32_t</span> <span class="n">ipv6_nd_stale_timeout</span><span class="p">;</span>	<span class="cm">/* 258-25B */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv6_dup_addr_detect_count</span><span class="p">;</span>	<span class="cm">/* 25C */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv6_cache_id</span><span class="p">;</span>		<span class="cm">/* 25D */</span>
	<span class="kt">uint8_t</span> <span class="n">reserved14</span><span class="p">[</span><span class="mi">18</span><span class="p">];</span>		<span class="cm">/* 25E-26F */</span>
	<span class="kt">uint32_t</span> <span class="n">ipv6_gw_advrt_mtu</span><span class="p">;</span>	<span class="cm">/* 270-273 */</span>
	<span class="kt">uint8_t</span> <span class="n">reserved15</span><span class="p">[</span><span class="mi">140</span><span class="p">];</span>	<span class="cm">/* 274-2FF */</span>
<span class="p">};</span>

<span class="cm">/*************************************************************************/</span>

<span class="cp">#define MAX_CHAP_ENTRIES_40XX	128</span>
<span class="cp">#define MAX_CHAP_ENTRIES_82XX	1024</span>
<span class="cp">#define MAX_RESRV_CHAP_IDX	3</span>
<span class="cp">#define FLASH_CHAP_OFFSET	0x06000000</span>

<span class="k">struct</span> <span class="n">ql4_chap_table</span> <span class="p">{</span>
	<span class="kt">uint16_t</span> <span class="n">link</span><span class="p">;</span>
	<span class="kt">uint8_t</span> <span class="n">flags</span><span class="p">;</span>
	<span class="kt">uint8_t</span> <span class="n">secret_len</span><span class="p">;</span>
<span class="cp">#define MIN_CHAP_SECRET_LEN	12</span>
<span class="cp">#define MAX_CHAP_SECRET_LEN	100</span>
	<span class="kt">uint8_t</span> <span class="n">secret</span><span class="p">[</span><span class="n">MAX_CHAP_SECRET_LEN</span><span class="p">];</span>
<span class="cp">#define MAX_CHAP_NAME_LEN	256</span>
	<span class="kt">uint8_t</span> <span class="n">name</span><span class="p">[</span><span class="n">MAX_CHAP_NAME_LEN</span><span class="p">];</span>
	<span class="kt">uint16_t</span> <span class="n">reserved</span><span class="p">;</span>
<span class="cp">#define CHAP_VALID_COOKIE	0x4092</span>
<span class="cp">#define CHAP_INVALID_COOKIE	0xFFEE</span>
	<span class="kt">uint16_t</span> <span class="n">cookie</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">dev_db_entry</span> <span class="p">{</span>
	<span class="kt">uint16_t</span> <span class="n">options</span><span class="p">;</span>	<span class="cm">/* 00-01 */</span>
<span class="cp">#define DDB_OPT_DISC_SESSION  0x10</span>
<span class="cp">#define DDB_OPT_TARGET	      0x02 </span><span class="cm">/* device is a target */</span><span class="cp"></span>
<span class="cp">#define DDB_OPT_IPV6_DEVICE	0x100</span>
<span class="cp">#define DDB_OPT_AUTO_SENDTGTS_DISABLE		0x40</span>
<span class="cp">#define DDB_OPT_IPV6_NULL_LINK_LOCAL		0x800 </span><span class="cm">/* post connection */</span><span class="cp"></span>
<span class="cp">#define DDB_OPT_IPV6_FW_DEFINED_LINK_LOCAL	0x800 </span><span class="cm">/* pre connection */</span><span class="cp"></span>

	<span class="kt">uint16_t</span> <span class="n">exec_throttle</span><span class="p">;</span>	<span class="cm">/* 02-03 */</span>
	<span class="kt">uint16_t</span> <span class="n">exec_count</span><span class="p">;</span>	<span class="cm">/* 04-05 */</span>
	<span class="kt">uint16_t</span> <span class="n">res0</span><span class="p">;</span>	<span class="cm">/* 06-07 */</span>
	<span class="kt">uint16_t</span> <span class="n">iscsi_options</span><span class="p">;</span>	<span class="cm">/* 08-09 */</span>
	<span class="kt">uint16_t</span> <span class="n">tcp_options</span><span class="p">;</span>	<span class="cm">/* 0A-0B */</span>
	<span class="kt">uint16_t</span> <span class="n">ip_options</span><span class="p">;</span>	<span class="cm">/* 0C-0D */</span>
	<span class="kt">uint16_t</span> <span class="n">iscsi_max_rcv_data_seg_len</span><span class="p">;</span>	<span class="cm">/* 0E-0F */</span>
<span class="cp">#define BYTE_UNITS	512</span>
	<span class="kt">uint32_t</span> <span class="n">res1</span><span class="p">;</span>	<span class="cm">/* 10-13 */</span>
	<span class="kt">uint16_t</span> <span class="n">iscsi_max_snd_data_seg_len</span><span class="p">;</span>	<span class="cm">/* 14-15 */</span>
	<span class="kt">uint16_t</span> <span class="n">iscsi_first_burst_len</span><span class="p">;</span>	<span class="cm">/* 16-17 */</span>
	<span class="kt">uint16_t</span> <span class="n">iscsi_def_time2wait</span><span class="p">;</span>	<span class="cm">/* 18-19 */</span>
	<span class="kt">uint16_t</span> <span class="n">iscsi_def_time2retain</span><span class="p">;</span>	<span class="cm">/* 1A-1B */</span>
	<span class="kt">uint16_t</span> <span class="n">iscsi_max_outsnd_r2t</span><span class="p">;</span>	<span class="cm">/* 1C-1D */</span>
	<span class="kt">uint16_t</span> <span class="n">ka_timeout</span><span class="p">;</span>	<span class="cm">/* 1E-1F */</span>
	<span class="kt">uint8_t</span> <span class="n">isid</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>	<span class="cm">/* 20-25 big-endian, must be converted</span>
<span class="cm">				 * to little-endian */</span>
	<span class="kt">uint16_t</span> <span class="n">tsid</span><span class="p">;</span>		<span class="cm">/* 26-27 */</span>
	<span class="kt">uint16_t</span> <span class="n">port</span><span class="p">;</span>	<span class="cm">/* 28-29 */</span>
	<span class="kt">uint16_t</span> <span class="n">iscsi_max_burst_len</span><span class="p">;</span>	<span class="cm">/* 2A-2B */</span>
	<span class="kt">uint16_t</span> <span class="n">def_timeout</span><span class="p">;</span>	<span class="cm">/* 2C-2D */</span>
	<span class="kt">uint16_t</span> <span class="n">res2</span><span class="p">;</span>	<span class="cm">/* 2E-2F */</span>
	<span class="kt">uint8_t</span> <span class="n">ip_addr</span><span class="p">[</span><span class="mh">0x10</span><span class="p">];</span>	<span class="cm">/* 30-3F */</span>
	<span class="kt">uint8_t</span> <span class="n">iscsi_alias</span><span class="p">[</span><span class="mh">0x20</span><span class="p">];</span>	<span class="cm">/* 40-5F */</span>
	<span class="kt">uint8_t</span> <span class="n">tgt_addr</span><span class="p">[</span><span class="mh">0x20</span><span class="p">];</span>	<span class="cm">/* 60-7F */</span>
	<span class="kt">uint16_t</span> <span class="n">mss</span><span class="p">;</span>	<span class="cm">/* 80-81 */</span>
	<span class="kt">uint16_t</span> <span class="n">res3</span><span class="p">;</span>	<span class="cm">/* 82-83 */</span>
	<span class="kt">uint16_t</span> <span class="n">lcl_port</span><span class="p">;</span>	<span class="cm">/* 84-85 */</span>
	<span class="kt">uint8_t</span> <span class="n">ipv4_tos</span><span class="p">;</span>	<span class="cm">/* 86 */</span>
	<span class="kt">uint16_t</span> <span class="n">ipv6_flow_lbl</span><span class="p">;</span>	<span class="cm">/* 87-89 */</span>
	<span class="kt">uint8_t</span> <span class="n">res4</span><span class="p">[</span><span class="mh">0x36</span><span class="p">];</span>	<span class="cm">/* 8A-BF */</span>
	<span class="kt">uint8_t</span> <span class="n">iscsi_name</span><span class="p">[</span><span class="mh">0xE0</span><span class="p">];</span>	<span class="cm">/* C0-19F : xxzzy Make this a</span>
<span class="cm">					 * pointer to a string so we</span>
<span class="cm">					 * don&#39;t have to reserve so</span>
<span class="cm">					 * much RAM */</span>
	<span class="kt">uint8_t</span> <span class="n">link_local_ipv6_addr</span><span class="p">[</span><span class="mh">0x10</span><span class="p">];</span> <span class="cm">/* 1A0-1AF */</span>
	<span class="kt">uint8_t</span> <span class="n">res5</span><span class="p">[</span><span class="mh">0x10</span><span class="p">];</span>	<span class="cm">/* 1B0-1BF */</span>
	<span class="kt">uint16_t</span> <span class="n">ddb_link</span><span class="p">;</span>	<span class="cm">/* 1C0-1C1 */</span>
	<span class="kt">uint16_t</span> <span class="n">chap_tbl_idx</span><span class="p">;</span>	<span class="cm">/* 1C2-1C3 */</span>
	<span class="kt">uint16_t</span> <span class="n">tgt_portal_grp</span><span class="p">;</span> <span class="cm">/* 1C4-1C5 */</span>
	<span class="kt">uint8_t</span> <span class="n">tcp_xmt_wsf</span><span class="p">;</span>	<span class="cm">/* 1C6 */</span>
	<span class="kt">uint8_t</span> <span class="n">tcp_rcv_wsf</span><span class="p">;</span>	<span class="cm">/* 1C7 */</span>
	<span class="kt">uint32_t</span> <span class="n">stat_sn</span><span class="p">;</span>	<span class="cm">/* 1C8-1CB */</span>
	<span class="kt">uint32_t</span> <span class="n">exp_stat_sn</span><span class="p">;</span>	<span class="cm">/* 1CC-1CF */</span>
	<span class="kt">uint8_t</span> <span class="n">res6</span><span class="p">[</span><span class="mh">0x2b</span><span class="p">];</span>	<span class="cm">/* 1D0-1FB */</span>
<span class="cp">#define DDB_VALID_COOKIE	0x9034</span>
	<span class="kt">uint16_t</span> <span class="n">cookie</span><span class="p">;</span>	<span class="cm">/* 1FC-1FD */</span>
	<span class="kt">uint16_t</span> <span class="n">len</span><span class="p">;</span>		<span class="cm">/* 1FE-1FF */</span>
<span class="p">};</span>

<span class="cm">/*************************************************************************/</span>

<span class="cm">/* Flash definitions */</span>

<span class="cp">#define FLASH_OFFSET_SYS_INFO	0x02000000</span>
<span class="cp">#define FLASH_DEFAULTBLOCKSIZE	0x20000</span>
<span class="cp">#define FLASH_EOF_OFFSET	(FLASH_DEFAULTBLOCKSIZE-8) </span><span class="cm">/* 4 bytes</span>
<span class="cm">							    * for EOF</span>
<span class="cm">							    * signature */</span><span class="cp"></span>
<span class="cp">#define FLASH_RAW_ACCESS_ADDR	0x8e000000</span>

<span class="cp">#define BOOT_PARAM_OFFSET_PORT0 0x3b0</span>
<span class="cp">#define BOOT_PARAM_OFFSET_PORT1 0x7b0</span>

<span class="cp">#define FLASH_OFFSET_DB_INFO	0x05000000</span>
<span class="cp">#define FLASH_OFFSET_DB_END	(FLASH_OFFSET_DB_INFO + 0x7fff)</span>


<span class="k">struct</span> <span class="n">sys_info_phys_addr</span> <span class="p">{</span>
	<span class="kt">uint8_t</span> <span class="n">address</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>	<span class="cm">/* 00-05 */</span>
	<span class="kt">uint8_t</span> <span class="n">filler</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>	<span class="cm">/* 06-07 */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">flash_sys_info</span> <span class="p">{</span>
	<span class="kt">uint32_t</span> <span class="n">cookie</span><span class="p">;</span>	<span class="cm">/* 00-03 */</span>
	<span class="kt">uint32_t</span> <span class="n">physAddrCount</span><span class="p">;</span> <span class="cm">/* 04-07 */</span>
	<span class="k">struct</span> <span class="n">sys_info_phys_addr</span> <span class="n">physAddr</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span> <span class="cm">/* 08-27 */</span>
	<span class="kt">uint8_t</span> <span class="n">vendorId</span><span class="p">[</span><span class="mi">128</span><span class="p">];</span>	<span class="cm">/* 28-A7 */</span>
	<span class="kt">uint8_t</span> <span class="n">productId</span><span class="p">[</span><span class="mi">128</span><span class="p">];</span> <span class="cm">/* A8-127 */</span>
	<span class="kt">uint32_t</span> <span class="n">serialNumber</span><span class="p">;</span>	<span class="cm">/* 128-12B */</span>

	<span class="cm">/*  PCI Configuration values */</span>
	<span class="kt">uint32_t</span> <span class="n">pciDeviceVendor</span><span class="p">;</span>	<span class="cm">/* 12C-12F */</span>
	<span class="kt">uint32_t</span> <span class="n">pciDeviceId</span><span class="p">;</span>	<span class="cm">/* 130-133 */</span>
	<span class="kt">uint32_t</span> <span class="n">pciSubsysVendor</span><span class="p">;</span>	<span class="cm">/* 134-137 */</span>
	<span class="kt">uint32_t</span> <span class="n">pciSubsysId</span><span class="p">;</span>	<span class="cm">/* 138-13B */</span>

	<span class="cm">/*  This validates version 1. */</span>
	<span class="kt">uint32_t</span> <span class="n">crumbs</span><span class="p">;</span>	<span class="cm">/* 13C-13F */</span>

	<span class="kt">uint32_t</span> <span class="n">enterpriseNumber</span><span class="p">;</span>	<span class="cm">/* 140-143 */</span>

	<span class="kt">uint32_t</span> <span class="n">mtu</span><span class="p">;</span>		<span class="cm">/* 144-147 */</span>
	<span class="kt">uint32_t</span> <span class="n">reserved0</span><span class="p">;</span>	<span class="cm">/* 148-14b */</span>
	<span class="kt">uint32_t</span> <span class="n">crumbs2</span><span class="p">;</span>	<span class="cm">/* 14c-14f */</span>
	<span class="kt">uint8_t</span> <span class="n">acSerialNumber</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>	<span class="cm">/* 150-15f */</span>
	<span class="kt">uint32_t</span> <span class="n">crumbs3</span><span class="p">;</span>	<span class="cm">/* 160-16f */</span>

	<span class="cm">/* Leave this last in the struct so it is declared invalid if</span>
<span class="cm">	 * any new items are added.</span>
<span class="cm">	 */</span>
	<span class="kt">uint32_t</span> <span class="n">reserved1</span><span class="p">[</span><span class="mi">39</span><span class="p">];</span> <span class="cm">/* 170-1ff */</span>
<span class="p">};</span>	<span class="cm">/* 200 */</span>

<span class="k">struct</span> <span class="n">mbx_sys_info</span> <span class="p">{</span>
	<span class="kt">uint8_t</span> <span class="n">board_id_str</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>   <span class="cm">/*  0-f  Keep board ID string first */</span>
				<span class="cm">/* in this structure for GUI. */</span>
	<span class="kt">uint16_t</span> <span class="n">board_id</span><span class="p">;</span>	<span class="cm">/* 10-11 board ID code */</span>
	<span class="kt">uint16_t</span> <span class="n">phys_port_cnt</span><span class="p">;</span>	<span class="cm">/* 12-13 number of physical network ports */</span>
	<span class="kt">uint16_t</span> <span class="n">port_num</span><span class="p">;</span>	<span class="cm">/* 14-15 network port for this PCI function */</span>
				<span class="cm">/* (port 0 is first port) */</span>
	<span class="kt">uint8_t</span> <span class="n">mac_addr</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>	<span class="cm">/* 16-1b MAC address for this PCI function */</span>
	<span class="kt">uint32_t</span> <span class="n">iscsi_pci_func_cnt</span><span class="p">;</span>  <span class="cm">/* 1c-1f number of iSCSI PCI functions */</span>
	<span class="kt">uint32_t</span> <span class="n">pci_func</span><span class="p">;</span>	      <span class="cm">/* 20-23 this PCI function */</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">serial_number</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>  <span class="cm">/* 24-33 serial number string */</span>
	<span class="kt">uint8_t</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">12</span><span class="p">];</span>		  <span class="cm">/* 34-3f */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">about_fw_info</span> <span class="p">{</span>
	<span class="kt">uint16_t</span> <span class="n">fw_major</span><span class="p">;</span>		<span class="cm">/* 00 - 01 */</span>
	<span class="kt">uint16_t</span> <span class="n">fw_minor</span><span class="p">;</span>		<span class="cm">/* 02 - 03 */</span>
	<span class="kt">uint16_t</span> <span class="n">fw_patch</span><span class="p">;</span>		<span class="cm">/* 04 - 05 */</span>
	<span class="kt">uint16_t</span> <span class="n">fw_build</span><span class="p">;</span>		<span class="cm">/* 06 - 07 */</span>
	<span class="kt">uint8_t</span> <span class="n">fw_build_date</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>	<span class="cm">/* 08 - 17 ASCII String */</span>
	<span class="kt">uint8_t</span> <span class="n">fw_build_time</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>	<span class="cm">/* 18 - 27 ASCII String */</span>
	<span class="kt">uint8_t</span> <span class="n">fw_build_user</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>	<span class="cm">/* 28 - 37 ASCII String */</span>
	<span class="kt">uint16_t</span> <span class="n">fw_load_source</span><span class="p">;</span>	<span class="cm">/* 38 - 39 */</span>
					<span class="cm">/* 1 = Flash Primary,</span>
<span class="cm">					   2 = Flash Secondary,</span>
<span class="cm">					   3 = Host Download</span>
<span class="cm">					*/</span>
	<span class="kt">uint8_t</span> <span class="n">reserved1</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>		<span class="cm">/* 3A - 3F */</span>
	<span class="kt">uint16_t</span> <span class="n">iscsi_major</span><span class="p">;</span>		<span class="cm">/* 40 - 41 */</span>
	<span class="kt">uint16_t</span> <span class="n">iscsi_minor</span><span class="p">;</span>		<span class="cm">/* 42 - 43 */</span>
	<span class="kt">uint16_t</span> <span class="n">bootload_major</span><span class="p">;</span>	<span class="cm">/* 44 - 45 */</span>
	<span class="kt">uint16_t</span> <span class="n">bootload_minor</span><span class="p">;</span>	<span class="cm">/* 46 - 47 */</span>
	<span class="kt">uint16_t</span> <span class="n">bootload_patch</span><span class="p">;</span>	<span class="cm">/* 48 - 49 */</span>
	<span class="kt">uint16_t</span> <span class="n">bootload_build</span><span class="p">;</span>	<span class="cm">/* 4A - 4B */</span>
	<span class="kt">uint8_t</span> <span class="n">reserved2</span><span class="p">[</span><span class="mi">180</span><span class="p">];</span>		<span class="cm">/* 4C - FF */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">crash_record</span> <span class="p">{</span>
	<span class="kt">uint16_t</span> <span class="n">fw_major_version</span><span class="p">;</span>	<span class="cm">/* 00 - 01 */</span>
	<span class="kt">uint16_t</span> <span class="n">fw_minor_version</span><span class="p">;</span>	<span class="cm">/* 02 - 03 */</span>
	<span class="kt">uint16_t</span> <span class="n">fw_patch_version</span><span class="p">;</span>	<span class="cm">/* 04 - 05 */</span>
	<span class="kt">uint16_t</span> <span class="n">fw_build_version</span><span class="p">;</span>	<span class="cm">/* 06 - 07 */</span>

	<span class="kt">uint8_t</span> <span class="n">build_date</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span> <span class="cm">/* 08 - 17 */</span>
	<span class="kt">uint8_t</span> <span class="n">build_time</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span> <span class="cm">/* 18 - 27 */</span>
	<span class="kt">uint8_t</span> <span class="n">build_user</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span> <span class="cm">/* 28 - 37 */</span>
	<span class="kt">uint8_t</span> <span class="n">card_serial_num</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>	<span class="cm">/* 38 - 47 */</span>

	<span class="kt">uint32_t</span> <span class="n">time_of_crash_in_secs</span><span class="p">;</span> <span class="cm">/* 48 - 4B */</span>
	<span class="kt">uint32_t</span> <span class="n">time_of_crash_in_ms</span><span class="p">;</span>	<span class="cm">/* 4C - 4F */</span>

	<span class="kt">uint16_t</span> <span class="n">out_RISC_sd_num_frames</span><span class="p">;</span>	<span class="cm">/* 50 - 51 */</span>
	<span class="kt">uint16_t</span> <span class="n">OAP_sd_num_words</span><span class="p">;</span>	<span class="cm">/* 52 - 53 */</span>
	<span class="kt">uint16_t</span> <span class="n">IAP_sd_num_frames</span><span class="p">;</span>	<span class="cm">/* 54 - 55 */</span>
	<span class="kt">uint16_t</span> <span class="n">in_RISC_sd_num_words</span><span class="p">;</span>	<span class="cm">/* 56 - 57 */</span>

	<span class="kt">uint8_t</span> <span class="n">reserved1</span><span class="p">[</span><span class="mi">28</span><span class="p">];</span>	<span class="cm">/* 58 - 7F */</span>

	<span class="kt">uint8_t</span> <span class="n">out_RISC_reg_dump</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span> <span class="cm">/* 80 -17F */</span>
	<span class="kt">uint8_t</span> <span class="n">in_RISC_reg_dump</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>	<span class="cm">/*180 -27F */</span>
	<span class="kt">uint8_t</span> <span class="n">in_out_RISC_stack_dump</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>	<span class="cm">/*280 - ??? */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">conn_event_log_entry</span> <span class="p">{</span>
<span class="cp">#define MAX_CONN_EVENT_LOG_ENTRIES	100</span>
	<span class="kt">uint32_t</span> <span class="n">timestamp_sec</span><span class="p">;</span> <span class="cm">/* 00 - 03 seconds since boot */</span>
	<span class="kt">uint32_t</span> <span class="n">timestamp_ms</span><span class="p">;</span>	<span class="cm">/* 04 - 07 milliseconds since boot */</span>
	<span class="kt">uint16_t</span> <span class="n">device_index</span><span class="p">;</span>	<span class="cm">/* 08 - 09  */</span>
	<span class="kt">uint16_t</span> <span class="n">fw_conn_state</span><span class="p">;</span> <span class="cm">/* 0A - 0B  */</span>
	<span class="kt">uint8_t</span> <span class="n">event_type</span><span class="p">;</span>	<span class="cm">/* 0C - 0C  */</span>
	<span class="kt">uint8_t</span> <span class="n">error_code</span><span class="p">;</span>	<span class="cm">/* 0D - 0D  */</span>
	<span class="kt">uint16_t</span> <span class="n">error_code_detail</span><span class="p">;</span>	<span class="cm">/* 0E - 0F  */</span>
	<span class="kt">uint8_t</span> <span class="n">num_consecutive_events</span><span class="p">;</span> <span class="cm">/* 10 - 10  */</span>
	<span class="kt">uint8_t</span> <span class="n">rsvd</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>	<span class="cm">/* 11 - 13  */</span>
<span class="p">};</span>

<span class="cm">/*************************************************************************</span>
<span class="cm"> *</span>
<span class="cm"> *				IOCB Commands Structures and Definitions</span>
<span class="cm"> *</span>
<span class="cm"> *************************************************************************/</span>
<span class="cp">#define IOCB_MAX_CDB_LEN	    16	</span><span class="cm">/* Bytes in a CBD */</span><span class="cp"></span>
<span class="cp">#define IOCB_MAX_SENSEDATA_LEN	    32	</span><span class="cm">/* Bytes of sense data */</span><span class="cp"></span>
<span class="cp">#define IOCB_MAX_EXT_SENSEDATA_LEN  60  </span><span class="cm">/* Bytes of extended sense data */</span><span class="cp"></span>

<span class="cm">/* IOCB header structure */</span>
<span class="k">struct</span> <span class="n">qla4_header</span> <span class="p">{</span>
	<span class="kt">uint8_t</span> <span class="n">entryType</span><span class="p">;</span>
<span class="cp">#define ET_STATUS		 0x03</span>
<span class="cp">#define ET_MARKER		 0x04</span>
<span class="cp">#define ET_CONT_T1		 0x0A</span>
<span class="cp">#define ET_STATUS_CONTINUATION	 0x10</span>
<span class="cp">#define ET_CMND_T3		 0x19</span>
<span class="cp">#define ET_PASSTHRU0		 0x3A</span>
<span class="cp">#define ET_PASSTHRU_STATUS	 0x3C</span>
<span class="cp">#define ET_MBOX_CMD		0x38</span>
<span class="cp">#define ET_MBOX_STATUS		0x39</span>

	<span class="kt">uint8_t</span> <span class="n">entryStatus</span><span class="p">;</span>
	<span class="kt">uint8_t</span> <span class="n">systemDefined</span><span class="p">;</span>
<span class="cp">#define SD_ISCSI_PDU	0x01</span>
	<span class="kt">uint8_t</span> <span class="n">entryCount</span><span class="p">;</span>

	<span class="cm">/* SyetemDefined definition */</span>
<span class="p">};</span>

<span class="cm">/* Generic queue entry structure*/</span>
<span class="k">struct</span> <span class="n">queue_entry</span> <span class="p">{</span>
	<span class="kt">uint8_t</span> <span class="n">data</span><span class="p">[</span><span class="mi">60</span><span class="p">];</span>
	<span class="kt">uint32_t</span> <span class="n">signature</span><span class="p">;</span>

<span class="p">};</span>

<span class="cm">/* 64 bit addressing segment counts*/</span>

<span class="cp">#define COMMAND_SEG_A64	  1</span>
<span class="cp">#define CONTINUE_SEG_A64  5</span>

<span class="cm">/* 64 bit addressing segment definition*/</span>

<span class="k">struct</span> <span class="n">data_seg_a64</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="p">{</span>
		<span class="kt">uint32_t</span> <span class="n">addrLow</span><span class="p">;</span>
		<span class="kt">uint32_t</span> <span class="n">addrHigh</span><span class="p">;</span>

	<span class="p">}</span> <span class="n">base</span><span class="p">;</span>

	<span class="kt">uint32_t</span> <span class="n">count</span><span class="p">;</span>

<span class="p">};</span>

<span class="cm">/* Command Type 3 entry structure*/</span>

<span class="k">struct</span> <span class="n">command_t3_entry</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">qla4_header</span> <span class="n">hdr</span><span class="p">;</span>	<span class="cm">/* 00-03 */</span>

	<span class="kt">uint32_t</span> <span class="n">handle</span><span class="p">;</span>	<span class="cm">/* 04-07 */</span>
	<span class="kt">uint16_t</span> <span class="n">target</span><span class="p">;</span>	<span class="cm">/* 08-09 */</span>
	<span class="kt">uint16_t</span> <span class="n">connection_id</span><span class="p">;</span> <span class="cm">/* 0A-0B */</span>

	<span class="kt">uint8_t</span> <span class="n">control_flags</span><span class="p">;</span>	<span class="cm">/* 0C */</span>

	<span class="cm">/* data direction  (bits 5-6) */</span>
<span class="cp">#define CF_WRITE		0x20</span>
<span class="cp">#define CF_READ			0x40</span>
<span class="cp">#define CF_NO_DATA		0x00</span>

	<span class="cm">/* task attributes (bits 2-0) */</span>
<span class="cp">#define CF_HEAD_TAG		0x03</span>
<span class="cp">#define CF_ORDERED_TAG		0x02</span>
<span class="cp">#define CF_SIMPLE_TAG		0x01</span>

	<span class="cm">/* STATE FLAGS FIELD IS A PLACE HOLDER. THE FW WILL SET BITS</span>
<span class="cm">	 * IN THIS FIELD AS THE COMMAND IS PROCESSED. WHEN THE IOCB IS</span>
<span class="cm">	 * CHANGED TO AN IOSB THIS FIELD WILL HAVE THE STATE FLAGS SET</span>
<span class="cm">	 * PROPERLY.</span>
<span class="cm">	 */</span>
	<span class="kt">uint8_t</span> <span class="n">state_flags</span><span class="p">;</span>	<span class="cm">/* 0D */</span>
	<span class="kt">uint8_t</span> <span class="n">cmdRefNum</span><span class="p">;</span>	<span class="cm">/* 0E */</span>
	<span class="kt">uint8_t</span> <span class="n">reserved1</span><span class="p">;</span>	<span class="cm">/* 0F */</span>
	<span class="kt">uint8_t</span> <span class="n">cdb</span><span class="p">[</span><span class="n">IOCB_MAX_CDB_LEN</span><span class="p">];</span>	<span class="cm">/* 10-1F */</span>
	<span class="k">struct</span> <span class="n">scsi_lun</span> <span class="n">lun</span><span class="p">;</span>	<span class="cm">/* FCP LUN (BE). */</span>
	<span class="kt">uint32_t</span> <span class="n">cmdSeqNum</span><span class="p">;</span>	<span class="cm">/* 28-2B */</span>
	<span class="kt">uint16_t</span> <span class="n">timeout</span><span class="p">;</span>	<span class="cm">/* 2C-2D */</span>
	<span class="kt">uint16_t</span> <span class="n">dataSegCnt</span><span class="p">;</span>	<span class="cm">/* 2E-2F */</span>
	<span class="kt">uint32_t</span> <span class="n">ttlByteCnt</span><span class="p">;</span>	<span class="cm">/* 30-33 */</span>
	<span class="k">struct</span> <span class="n">data_seg_a64</span> <span class="n">dataseg</span><span class="p">[</span><span class="n">COMMAND_SEG_A64</span><span class="p">];</span>	<span class="cm">/* 34-3F */</span>

<span class="p">};</span>


<span class="cm">/* Continuation Type 1 entry structure*/</span>
<span class="k">struct</span> <span class="n">continuation_t1_entry</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">qla4_header</span> <span class="n">hdr</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">data_seg_a64</span> <span class="n">dataseg</span><span class="p">[</span><span class="n">CONTINUE_SEG_A64</span><span class="p">];</span>

<span class="p">};</span>

<span class="cm">/* Parameterize for 64 or 32 bits */</span>
<span class="cp">#define COMMAND_SEG	COMMAND_SEG_A64</span>
<span class="cp">#define CONTINUE_SEG	CONTINUE_SEG_A64</span>

<span class="cp">#define ET_COMMAND	ET_CMND_T3</span>
<span class="cp">#define ET_CONTINUE	ET_CONT_T1</span>

<span class="cm">/* Marker entry structure*/</span>
<span class="k">struct</span> <span class="n">qla4_marker_entry</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">qla4_header</span> <span class="n">hdr</span><span class="p">;</span>	<span class="cm">/* 00-03 */</span>

	<span class="kt">uint32_t</span> <span class="n">system_defined</span><span class="p">;</span> <span class="cm">/* 04-07 */</span>
	<span class="kt">uint16_t</span> <span class="n">target</span><span class="p">;</span>	<span class="cm">/* 08-09 */</span>
	<span class="kt">uint16_t</span> <span class="n">modifier</span><span class="p">;</span>	<span class="cm">/* 0A-0B */</span>
<span class="cp">#define MM_LUN_RESET		0</span>
<span class="cp">#define MM_TGT_WARM_RESET	1</span>

	<span class="kt">uint16_t</span> <span class="n">flags</span><span class="p">;</span>		<span class="cm">/* 0C-0D */</span>
	<span class="kt">uint16_t</span> <span class="n">reserved1</span><span class="p">;</span>	<span class="cm">/* 0E-0F */</span>
	<span class="k">struct</span> <span class="n">scsi_lun</span> <span class="n">lun</span><span class="p">;</span>	<span class="cm">/* FCP LUN (BE). */</span>
	<span class="kt">uint64_t</span> <span class="n">reserved2</span><span class="p">;</span>	<span class="cm">/* 18-1F */</span>
	<span class="kt">uint64_t</span> <span class="n">reserved3</span><span class="p">;</span>	<span class="cm">/* 20-27 */</span>
	<span class="kt">uint64_t</span> <span class="n">reserved4</span><span class="p">;</span>	<span class="cm">/* 28-2F */</span>
	<span class="kt">uint64_t</span> <span class="n">reserved5</span><span class="p">;</span>	<span class="cm">/* 30-37 */</span>
	<span class="kt">uint64_t</span> <span class="n">reserved6</span><span class="p">;</span>	<span class="cm">/* 38-3F */</span>
<span class="p">};</span>

<span class="cm">/* Status entry structure*/</span>
<span class="k">struct</span> <span class="n">status_entry</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">qla4_header</span> <span class="n">hdr</span><span class="p">;</span>	<span class="cm">/* 00-03 */</span>

	<span class="kt">uint32_t</span> <span class="n">handle</span><span class="p">;</span>	<span class="cm">/* 04-07 */</span>

	<span class="kt">uint8_t</span> <span class="n">scsiStatus</span><span class="p">;</span>	<span class="cm">/* 08 */</span>
<span class="cp">#define SCSI_CHECK_CONDITION		  0x02</span>

	<span class="kt">uint8_t</span> <span class="n">iscsiFlags</span><span class="p">;</span>	<span class="cm">/* 09 */</span>
<span class="cp">#define ISCSI_FLAG_RESIDUAL_UNDER	  0x02</span>
<span class="cp">#define ISCSI_FLAG_RESIDUAL_OVER	  0x04</span>

	<span class="kt">uint8_t</span> <span class="n">iscsiResponse</span><span class="p">;</span>	<span class="cm">/* 0A */</span>

	<span class="kt">uint8_t</span> <span class="n">completionStatus</span><span class="p">;</span>	<span class="cm">/* 0B */</span>
<span class="cp">#define SCS_COMPLETE			  0x00</span>
<span class="cp">#define SCS_INCOMPLETE			  0x01</span>
<span class="cp">#define SCS_RESET_OCCURRED		  0x04</span>
<span class="cp">#define SCS_ABORTED			  0x05</span>
<span class="cp">#define SCS_TIMEOUT			  0x06</span>
<span class="cp">#define SCS_DATA_OVERRUN		  0x07</span>
<span class="cp">#define SCS_DATA_UNDERRUN		  0x15</span>
<span class="cp">#define SCS_QUEUE_FULL			  0x1C</span>
<span class="cp">#define SCS_DEVICE_UNAVAILABLE		  0x28</span>
<span class="cp">#define SCS_DEVICE_LOGGED_OUT		  0x29</span>

	<span class="kt">uint8_t</span> <span class="n">reserved1</span><span class="p">;</span>	<span class="cm">/* 0C */</span>

	<span class="cm">/* state_flags MUST be at the same location as state_flags in</span>
<span class="cm">	 * the Command_T3/4_Entry */</span>
	<span class="kt">uint8_t</span> <span class="n">state_flags</span><span class="p">;</span>	<span class="cm">/* 0D */</span>

	<span class="kt">uint16_t</span> <span class="n">senseDataByteCnt</span><span class="p">;</span>	<span class="cm">/* 0E-0F */</span>
	<span class="kt">uint32_t</span> <span class="n">residualByteCnt</span><span class="p">;</span>	<span class="cm">/* 10-13 */</span>
	<span class="kt">uint32_t</span> <span class="n">bidiResidualByteCnt</span><span class="p">;</span>	<span class="cm">/* 14-17 */</span>
	<span class="kt">uint32_t</span> <span class="n">expSeqNum</span><span class="p">;</span>	<span class="cm">/* 18-1B */</span>
	<span class="kt">uint32_t</span> <span class="n">maxCmdSeqNum</span><span class="p">;</span>	<span class="cm">/* 1C-1F */</span>
	<span class="kt">uint8_t</span> <span class="n">senseData</span><span class="p">[</span><span class="n">IOCB_MAX_SENSEDATA_LEN</span><span class="p">];</span>	<span class="cm">/* 20-3F */</span>

<span class="p">};</span>

<span class="cm">/* Status Continuation entry */</span>
<span class="k">struct</span> <span class="n">status_cont_entry</span> <span class="p">{</span>
       <span class="k">struct</span> <span class="n">qla4_header</span> <span class="n">hdr</span><span class="p">;</span> <span class="cm">/* 00-03 */</span>
       <span class="kt">uint8_t</span> <span class="n">ext_sense_data</span><span class="p">[</span><span class="n">IOCB_MAX_EXT_SENSEDATA_LEN</span><span class="p">];</span> <span class="cm">/* 04-63 */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">passthru0</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">qla4_header</span> <span class="n">hdr</span><span class="p">;</span>		       <span class="cm">/* 00-03 */</span>
	<span class="kt">uint32_t</span> <span class="n">handle</span><span class="p">;</span>	<span class="cm">/* 04-07 */</span>
	<span class="kt">uint16_t</span> <span class="n">target</span><span class="p">;</span>	<span class="cm">/* 08-09 */</span>
	<span class="kt">uint16_t</span> <span class="n">connection_id</span><span class="p">;</span>	<span class="cm">/* 0A-0B */</span>
<span class="cp">#define ISNS_DEFAULT_SERVER_CONN_ID	((uint16_t)0x8000)</span>

	<span class="kt">uint16_t</span> <span class="n">control_flags</span><span class="p">;</span>	<span class="cm">/* 0C-0D */</span>
<span class="cp">#define PT_FLAG_ETHERNET_FRAME		0x8000</span>
<span class="cp">#define PT_FLAG_ISNS_PDU		0x8000</span>
<span class="cp">#define PT_FLAG_SEND_BUFFER		0x0200</span>
<span class="cp">#define PT_FLAG_WAIT_4_RESPONSE		0x0100</span>
<span class="cp">#define PT_FLAG_ISCSI_PDU		0x1000</span>

	<span class="kt">uint16_t</span> <span class="n">timeout</span><span class="p">;</span>	<span class="cm">/* 0E-0F */</span>
<span class="cp">#define PT_DEFAULT_TIMEOUT		30 </span><span class="cm">/* seconds */</span><span class="cp"></span>

	<span class="k">struct</span> <span class="n">data_seg_a64</span> <span class="n">out_dsd</span><span class="p">;</span>    <span class="cm">/* 10-1B */</span>
	<span class="kt">uint32_t</span> <span class="n">res1</span><span class="p">;</span>		<span class="cm">/* 1C-1F */</span>
	<span class="k">struct</span> <span class="n">data_seg_a64</span> <span class="n">in_dsd</span><span class="p">;</span>     <span class="cm">/* 20-2B */</span>
	<span class="kt">uint8_t</span> <span class="n">res2</span><span class="p">[</span><span class="mi">20</span><span class="p">];</span>	<span class="cm">/* 2C-3F */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">passthru_status</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">qla4_header</span> <span class="n">hdr</span><span class="p">;</span>		       <span class="cm">/* 00-03 */</span>
	<span class="kt">uint32_t</span> <span class="n">handle</span><span class="p">;</span>	<span class="cm">/* 04-07 */</span>
	<span class="kt">uint16_t</span> <span class="n">target</span><span class="p">;</span>	<span class="cm">/* 08-09 */</span>
	<span class="kt">uint16_t</span> <span class="n">connectionID</span><span class="p">;</span>	<span class="cm">/* 0A-0B */</span>

	<span class="kt">uint8_t</span> <span class="n">completionStatus</span><span class="p">;</span>	<span class="cm">/* 0C */</span>
<span class="cp">#define PASSTHRU_STATUS_COMPLETE		0x01</span>

	<span class="kt">uint8_t</span> <span class="n">residualFlags</span><span class="p">;</span>	<span class="cm">/* 0D */</span>

	<span class="kt">uint16_t</span> <span class="n">timeout</span><span class="p">;</span>	<span class="cm">/* 0E-0F */</span>
	<span class="kt">uint16_t</span> <span class="n">portNumber</span><span class="p">;</span>	<span class="cm">/* 10-11 */</span>
	<span class="kt">uint8_t</span> <span class="n">res1</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>	<span class="cm">/* 12-1B */</span>
	<span class="kt">uint32_t</span> <span class="n">outResidual</span><span class="p">;</span>	<span class="cm">/* 1C-1F */</span>
	<span class="kt">uint8_t</span> <span class="n">res2</span><span class="p">[</span><span class="mi">12</span><span class="p">];</span>	<span class="cm">/* 20-2B */</span>
	<span class="kt">uint32_t</span> <span class="n">inResidual</span><span class="p">;</span>	<span class="cm">/* 2C-2F */</span>
	<span class="kt">uint8_t</span> <span class="n">res4</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>	<span class="cm">/* 30-3F */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">mbox_cmd_iocb</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">qla4_header</span> <span class="n">hdr</span><span class="p">;</span>	<span class="cm">/* 00-03 */</span>
	<span class="kt">uint32_t</span> <span class="n">handle</span><span class="p">;</span>	<span class="cm">/* 04-07 */</span>
	<span class="kt">uint32_t</span> <span class="n">in_mbox</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>	<span class="cm">/* 08-25 */</span>
	<span class="kt">uint32_t</span> <span class="n">res1</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>	<span class="cm">/* 26-3F */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">mbox_status_iocb</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">qla4_header</span> <span class="n">hdr</span><span class="p">;</span>	<span class="cm">/* 00-03 */</span>
	<span class="kt">uint32_t</span> <span class="n">handle</span><span class="p">;</span>	<span class="cm">/* 04-07 */</span>
	<span class="kt">uint32_t</span> <span class="n">out_mbox</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>	<span class="cm">/* 08-25 */</span>
	<span class="kt">uint32_t</span> <span class="n">res1</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>	<span class="cm">/* 26-3F */</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * ISP queue - response queue entry definition.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">response</span> <span class="p">{</span>
	<span class="kt">uint8_t</span> <span class="n">data</span><span class="p">[</span><span class="mi">60</span><span class="p">];</span>
	<span class="kt">uint32_t</span> <span class="n">signature</span><span class="p">;</span>
<span class="cp">#define RESPONSE_PROCESSED	0xDEADDEAD	</span><span class="cm">/* Signature */</span><span class="cp"></span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ql_iscsi_stats</span> <span class="p">{</span>
	<span class="kt">uint8_t</span> <span class="n">reserved1</span><span class="p">[</span><span class="mi">656</span><span class="p">];</span> <span class="cm">/* 0000-028F */</span>
	<span class="kt">uint32_t</span> <span class="n">tx_cmd_pdu</span><span class="p">;</span> <span class="cm">/* 0290-0293 */</span>
	<span class="kt">uint32_t</span> <span class="n">tx_resp_pdu</span><span class="p">;</span> <span class="cm">/* 0294-0297 */</span>
	<span class="kt">uint32_t</span> <span class="n">rx_cmd_pdu</span><span class="p">;</span> <span class="cm">/* 0298-029B */</span>
	<span class="kt">uint32_t</span> <span class="n">rx_resp_pdu</span><span class="p">;</span> <span class="cm">/* 029C-029F */</span>

	<span class="kt">uint64_t</span> <span class="n">tx_data_octets</span><span class="p">;</span> <span class="cm">/* 02A0-02A7 */</span>
	<span class="kt">uint64_t</span> <span class="n">rx_data_octets</span><span class="p">;</span> <span class="cm">/* 02A8-02AF */</span>

	<span class="kt">uint32_t</span> <span class="n">hdr_digest_err</span><span class="p">;</span> <span class="cm">/* 02B0–02B3 */</span>
	<span class="kt">uint32_t</span> <span class="n">data_digest_err</span><span class="p">;</span> <span class="cm">/* 02B4–02B7 */</span>
	<span class="kt">uint32_t</span> <span class="n">conn_timeout_err</span><span class="p">;</span> <span class="cm">/* 02B8–02BB */</span>
	<span class="kt">uint32_t</span> <span class="n">framing_err</span><span class="p">;</span> <span class="cm">/* 02BC–02BF */</span>

	<span class="kt">uint32_t</span> <span class="n">tx_nopout_pdus</span><span class="p">;</span> <span class="cm">/* 02C0–02C3 */</span>
	<span class="kt">uint32_t</span> <span class="n">tx_scsi_cmd_pdus</span><span class="p">;</span>  <span class="cm">/* 02C4–02C7 */</span>
	<span class="kt">uint32_t</span> <span class="n">tx_tmf_cmd_pdus</span><span class="p">;</span> <span class="cm">/* 02C8–02CB */</span>
	<span class="kt">uint32_t</span> <span class="n">tx_login_cmd_pdus</span><span class="p">;</span> <span class="cm">/* 02CC–02CF */</span>
	<span class="kt">uint32_t</span> <span class="n">tx_text_cmd_pdus</span><span class="p">;</span> <span class="cm">/* 02D0–02D3 */</span>
	<span class="kt">uint32_t</span> <span class="n">tx_scsi_write_pdus</span><span class="p">;</span> <span class="cm">/* 02D4–02D7 */</span>
	<span class="kt">uint32_t</span> <span class="n">tx_logout_cmd_pdus</span><span class="p">;</span> <span class="cm">/* 02D8–02DB */</span>
	<span class="kt">uint32_t</span> <span class="n">tx_snack_req_pdus</span><span class="p">;</span> <span class="cm">/* 02DC–02DF */</span>

	<span class="kt">uint32_t</span> <span class="n">rx_nopin_pdus</span><span class="p">;</span> <span class="cm">/* 02E0–02E3 */</span>
	<span class="kt">uint32_t</span> <span class="n">rx_scsi_resp_pdus</span><span class="p">;</span> <span class="cm">/* 02E4–02E7 */</span>
	<span class="kt">uint32_t</span> <span class="n">rx_tmf_resp_pdus</span><span class="p">;</span> <span class="cm">/* 02E8–02EB */</span>
	<span class="kt">uint32_t</span> <span class="n">rx_login_resp_pdus</span><span class="p">;</span> <span class="cm">/* 02EC–02EF */</span>
	<span class="kt">uint32_t</span> <span class="n">rx_text_resp_pdus</span><span class="p">;</span> <span class="cm">/* 02F0–02F3 */</span>
	<span class="kt">uint32_t</span> <span class="n">rx_scsi_read_pdus</span><span class="p">;</span> <span class="cm">/* 02F4–02F7 */</span>
	<span class="kt">uint32_t</span> <span class="n">rx_logout_resp_pdus</span><span class="p">;</span> <span class="cm">/* 02F8–02FB */</span>

	<span class="kt">uint32_t</span> <span class="n">rx_r2t_pdus</span><span class="p">;</span> <span class="cm">/* 02FC–02FF */</span>
	<span class="kt">uint32_t</span> <span class="n">rx_async_pdus</span><span class="p">;</span> <span class="cm">/* 0300–0303 */</span>
	<span class="kt">uint32_t</span> <span class="n">rx_reject_pdus</span><span class="p">;</span> <span class="cm">/* 0304–0307 */</span>

	<span class="kt">uint8_t</span> <span class="n">reserved2</span><span class="p">[</span><span class="mi">264</span><span class="p">];</span> <span class="cm">/* 0x0308 - 0x040F */</span>
<span class="p">};</span>

<span class="cp">#define QLA82XX_DBG_STATE_ARRAY_LEN		16</span>
<span class="cp">#define QLA82XX_DBG_CAP_SIZE_ARRAY_LEN		8</span>
<span class="cp">#define QLA82XX_DBG_RSVD_ARRAY_LEN		8</span>

<span class="k">struct</span> <span class="n">qla4_8xxx_minidump_template_hdr</span> <span class="p">{</span>
	<span class="kt">uint32_t</span> <span class="n">entry_type</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">first_entry_offset</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">size_of_template</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">capture_debug_level</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">num_of_entries</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">version</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">driver_timestamp</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">checksum</span><span class="p">;</span>

	<span class="kt">uint32_t</span> <span class="n">driver_capture_mask</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">driver_info_word2</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">driver_info_word3</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">driver_info_word4</span><span class="p">;</span>

	<span class="kt">uint32_t</span> <span class="n">saved_state_array</span><span class="p">[</span><span class="n">QLA82XX_DBG_STATE_ARRAY_LEN</span><span class="p">];</span>
	<span class="kt">uint32_t</span> <span class="n">capture_size_array</span><span class="p">[</span><span class="n">QLA82XX_DBG_CAP_SIZE_ARRAY_LEN</span><span class="p">];</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="cm">/*  _QLA4X_FW_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
