<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › scsi › aic94xx › aic94xx_sds.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>aic94xx_sds.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Aic94xx SAS/SATA driver hardware interface header file.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 2005 Adaptec, Inc.  All rights reserved.</span>
<span class="cm"> * Copyright (C) 2005 Gilbert Wu &lt;gilbert_wu@adaptec.com&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * This file is licensed under GPLv2.</span>
<span class="cm"> *</span>
<span class="cm"> * This file is part of the aic94xx driver.</span>
<span class="cm"> *</span>
<span class="cm"> * The aic94xx driver is free software; you can redistribute it and/or</span>
<span class="cm"> * modify it under the terms of the GNU General Public License as</span>
<span class="cm"> * published by the Free Software Foundation; version 2 of the</span>
<span class="cm"> * License.</span>
<span class="cm"> *</span>
<span class="cm"> * The aic94xx driver is distributed in the hope that it will be useful,</span>
<span class="cm"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<span class="cm"> * General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License</span>
<span class="cm"> * along with the aic94xx driver; if not, write to the Free Software</span>
<span class="cm"> * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="cp">#ifndef _AIC94XX_SDS_H_</span>
<span class="cp">#define _AIC94XX_SDS_H_</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">FLASH_METHOD_UNKNOWN</span><span class="p">,</span>
	<span class="n">FLASH_METHOD_A</span><span class="p">,</span>
	<span class="n">FLASH_METHOD_B</span>
<span class="p">};</span>

<span class="cp">#define FLASH_MANUF_ID_AMD              0x01</span>
<span class="cp">#define FLASH_MANUF_ID_ST               0x20</span>
<span class="cp">#define FLASH_MANUF_ID_FUJITSU          0x04</span>
<span class="cp">#define FLASH_MANUF_ID_MACRONIX         0xC2</span>
<span class="cp">#define FLASH_MANUF_ID_INTEL            0x89</span>
<span class="cp">#define FLASH_MANUF_ID_UNKNOWN          0xFF</span>

<span class="cp">#define FLASH_DEV_ID_AM29LV008BT        0x3E</span>
<span class="cp">#define FLASH_DEV_ID_AM29LV800DT        0xDA</span>
<span class="cp">#define FLASH_DEV_ID_STM29W800DT        0xD7</span>
<span class="cp">#define FLASH_DEV_ID_STM29LV640         0xDE</span>
<span class="cp">#define FLASH_DEV_ID_STM29008           0xEA</span>
<span class="cp">#define FLASH_DEV_ID_MBM29LV800TE       0xDA</span>
<span class="cp">#define FLASH_DEV_ID_MBM29DL800TA       0x4A</span>
<span class="cp">#define FLASH_DEV_ID_MBM29LV008TA       0x3E</span>
<span class="cp">#define FLASH_DEV_ID_AM29LV640MT        0x7E</span>
<span class="cp">#define FLASH_DEV_ID_AM29F800B          0xD6</span>
<span class="cp">#define FLASH_DEV_ID_MX29LV800BT        0xDA</span>
<span class="cp">#define FLASH_DEV_ID_MX29LV008CT        0xDA</span>
<span class="cp">#define FLASH_DEV_ID_I28LV00TAT         0x3E</span>
<span class="cp">#define FLASH_DEV_ID_UNKNOWN            0xFF</span>

<span class="cm">/* status bit mask values */</span>
<span class="cp">#define FLASH_STATUS_BIT_MASK_DQ6       0x40</span>
<span class="cp">#define FLASH_STATUS_BIT_MASK_DQ5       0x20</span>
<span class="cp">#define FLASH_STATUS_BIT_MASK_DQ2       0x04</span>

<span class="cm">/* minimum value in micro seconds needed for checking status */</span>
<span class="cp">#define FLASH_STATUS_ERASE_DELAY_COUNT  50</span>
<span class="cp">#define FLASH_STATUS_WRITE_DELAY_COUNT  25</span>

<span class="cp">#define FLASH_SECTOR_SIZE               0x010000</span>
<span class="cp">#define FLASH_SECTOR_SIZE_MASK          0xffff0000</span>

<span class="cp">#define FLASH_OK                        0x000000</span>
<span class="cp">#define FAIL_OPEN_BIOS_FILE             0x000100</span>
<span class="cp">#define FAIL_CHECK_PCI_ID               0x000200</span>
<span class="cp">#define FAIL_CHECK_SUM                  0x000300</span>
<span class="cp">#define FAIL_UNKNOWN                    0x000400</span>
<span class="cp">#define FAIL_VERIFY                     0x000500</span>
<span class="cp">#define FAIL_RESET_FLASH                0x000600</span>
<span class="cp">#define FAIL_FIND_FLASH_ID              0x000700</span>
<span class="cp">#define FAIL_ERASE_FLASH                0x000800</span>
<span class="cp">#define FAIL_WRITE_FLASH                0x000900</span>
<span class="cp">#define FAIL_FILE_SIZE                  0x000a00</span>
<span class="cp">#define FAIL_PARAMETERS                 0x000b00</span>
<span class="cp">#define FAIL_OUT_MEMORY                 0x000c00</span>
<span class="cp">#define FLASH_IN_PROGRESS               0x001000</span>

<span class="k">struct</span> <span class="n">controller_id</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">vendor</span><span class="p">;</span>     <span class="cm">/* PCI Vendor ID */</span>
	<span class="n">u32</span> <span class="n">device</span><span class="p">;</span>     <span class="cm">/* PCI Device ID */</span>
	<span class="n">u32</span> <span class="n">sub_vendor</span><span class="p">;</span> <span class="cm">/* PCI Subvendor ID */</span>
	<span class="n">u32</span> <span class="n">sub_device</span><span class="p">;</span> <span class="cm">/* PCI Subdevice ID */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">image_info</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">ImageId</span><span class="p">;</span>       <span class="cm">/* Identifies the image */</span>
	<span class="n">u32</span> <span class="n">ImageOffset</span><span class="p">;</span>   <span class="cm">/* Offset the beginning of the file */</span>
	<span class="n">u32</span> <span class="n">ImageLength</span><span class="p">;</span>   <span class="cm">/* length of the image */</span>
	<span class="n">u32</span> <span class="n">ImageChecksum</span><span class="p">;</span> <span class="cm">/* Image checksum */</span>
	<span class="n">u32</span> <span class="n">ImageVersion</span><span class="p">;</span>  <span class="cm">/* Version of the image, could be build number */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bios_file_header</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">signature</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span> <span class="cm">/* Signature/Cookie to identify the file */</span>
	<span class="n">u32</span> <span class="n">checksum</span><span class="p">;</span>	  <span class="cm">/*Entire file checksum with this field zero */</span>
	<span class="n">u32</span> <span class="n">antidote</span><span class="p">;</span>	  <span class="cm">/* Entire file checksum with this field 0xFFFFFFFF */</span>
	<span class="k">struct</span> <span class="n">controller_id</span> <span class="n">contrl_id</span><span class="p">;</span> <span class="cm">/*PCI id to identify the controller */</span>
	<span class="n">u32</span> <span class="n">filelen</span><span class="p">;</span>      <span class="cm">/*Length of the entire file*/</span>
	<span class="n">u32</span> <span class="n">chunk_num</span><span class="p">;</span>	  <span class="cm">/*The chunk/part number for multiple Image files */</span>
	<span class="n">u32</span> <span class="n">total_chunks</span><span class="p">;</span> <span class="cm">/*Total number of chunks/parts in the image file */</span>
	<span class="n">u32</span> <span class="n">num_images</span><span class="p">;</span>   <span class="cm">/* Number of images in the file */</span>
	<span class="n">u32</span> <span class="n">build_num</span><span class="p">;</span>    <span class="cm">/* Build number of this image */</span>
	<span class="k">struct</span> <span class="n">image_info</span> <span class="n">image_header</span><span class="p">;</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="n">asd_verify_flash_seg</span><span class="p">(</span><span class="k">struct</span> <span class="n">asd_ha_struct</span> <span class="o">*</span><span class="n">asd_ha</span><span class="p">,</span>
		<span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span> <span class="n">u32</span> <span class="n">dest_offset</span><span class="p">,</span> <span class="n">u32</span> <span class="n">bytes_to_verify</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">asd_write_flash_seg</span><span class="p">(</span><span class="k">struct</span> <span class="n">asd_ha_struct</span> <span class="o">*</span><span class="n">asd_ha</span><span class="p">,</span>
		<span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span> <span class="n">u32</span> <span class="n">dest_offset</span><span class="p">,</span> <span class="n">u32</span> <span class="n">bytes_to_write</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">asd_chk_write_status</span><span class="p">(</span><span class="k">struct</span> <span class="n">asd_ha_struct</span> <span class="o">*</span><span class="n">asd_ha</span><span class="p">,</span>
		<span class="n">u32</span> <span class="n">sector_addr</span><span class="p">,</span> <span class="n">u8</span> <span class="n">erase_flag</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">asd_check_flash_type</span><span class="p">(</span><span class="k">struct</span> <span class="n">asd_ha_struct</span> <span class="o">*</span><span class="n">asd_ha</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">asd_erase_nv_sector</span><span class="p">(</span><span class="k">struct</span> <span class="n">asd_ha_struct</span> <span class="o">*</span><span class="n">asd_ha</span><span class="p">,</span>
		<span class="n">u32</span> <span class="n">flash_addr</span><span class="p">,</span> <span class="n">u32</span> <span class="n">size</span><span class="p">);</span>
<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
