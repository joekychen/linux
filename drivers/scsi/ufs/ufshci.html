<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › scsi › ufs › ufshci.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>ufshci.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Universal Flash Storage Host controller driver</span>
<span class="cm"> *</span>
<span class="cm"> * This code is based on drivers/scsi/ufs/ufshci.h</span>
<span class="cm"> * Copyright (C) 2011-2012 Samsung India Software Operations</span>
<span class="cm"> *</span>
<span class="cm"> * Santosh Yaraganavi &lt;santosh.sy@samsung.com&gt;</span>
<span class="cm"> * Vinayak Holikatti &lt;h.vinayak@samsung.com&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or</span>
<span class="cm"> * modify it under the terms of the GNU General Public License</span>
<span class="cm"> * as published by the Free Software Foundation; either version 2</span>
<span class="cm"> * of the License, or (at your option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful,</span>
<span class="cm"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm"> * GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * NO WARRANTY</span>
<span class="cm"> * THE PROGRAM IS PROVIDED ON AN &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR</span>
<span class="cm"> * CONDITIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED INCLUDING, WITHOUT</span>
<span class="cm"> * LIMITATION, ANY WARRANTIES OR CONDITIONS OF TITLE, NON-INFRINGEMENT,</span>
<span class="cm"> * MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. Each Recipient is</span>
<span class="cm"> * solely responsible for determining the appropriateness of using and</span>
<span class="cm"> * distributing the Program and assumes all risks associated with its</span>
<span class="cm"> * exercise of rights under this Agreement, including but not limited to</span>
<span class="cm"> * the risks and costs of program errors, damage to or loss of data,</span>
<span class="cm"> * programs or equipment, and unavailability or interruption of operations.</span>

<span class="cm"> * DISCLAIMER OF LIABILITY</span>
<span class="cm"> * NEITHER RECIPIENT NOR ANY CONTRIBUTORS SHALL HAVE ANY LIABILITY FOR ANY</span>
<span class="cm"> * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<span class="cm"> * DAMAGES (INCLUDING WITHOUT LIMITATION LOST PROFITS), HOWEVER CAUSED AND</span>
<span class="cm"> * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR</span>
<span class="cm"> * TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE</span>
<span class="cm"> * USE OR DISTRIBUTION OF THE PROGRAM OR THE EXERCISE OF ANY RIGHTS GRANTED</span>
<span class="cm"> * HEREUNDER, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGES</span>

<span class="cm"> * You should have received a copy of the GNU General Public License</span>
<span class="cm"> * along with this program; if not, write to the Free Software</span>
<span class="cm"> * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301,</span>
<span class="cm"> * USA.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _UFSHCI_H</span>
<span class="cp">#define _UFSHCI_H</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">TASK_REQ_UPIU_SIZE_DWORDS</span>	<span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">TASK_RSP_UPIU_SIZE_DWORDS</span>	<span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">ALIGNED_UPIU_SIZE</span>		<span class="o">=</span> <span class="mi">128</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* UFSHCI Registers */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">REG_CONTROLLER_CAPABILITIES</span>		<span class="o">=</span> <span class="mh">0x00</span><span class="p">,</span>
	<span class="n">REG_UFS_VERSION</span>				<span class="o">=</span> <span class="mh">0x08</span><span class="p">,</span>
	<span class="n">REG_CONTROLLER_DEV_ID</span>			<span class="o">=</span> <span class="mh">0x10</span><span class="p">,</span>
	<span class="n">REG_CONTROLLER_PROD_ID</span>			<span class="o">=</span> <span class="mh">0x14</span><span class="p">,</span>
	<span class="n">REG_INTERRUPT_STATUS</span>			<span class="o">=</span> <span class="mh">0x20</span><span class="p">,</span>
	<span class="n">REG_INTERRUPT_ENABLE</span>			<span class="o">=</span> <span class="mh">0x24</span><span class="p">,</span>
	<span class="n">REG_CONTROLLER_STATUS</span>			<span class="o">=</span> <span class="mh">0x30</span><span class="p">,</span>
	<span class="n">REG_CONTROLLER_ENABLE</span>			<span class="o">=</span> <span class="mh">0x34</span><span class="p">,</span>
	<span class="n">REG_UIC_ERROR_CODE_PHY_ADAPTER_LAYER</span>	<span class="o">=</span> <span class="mh">0x38</span><span class="p">,</span>
	<span class="n">REG_UIC_ERROR_CODE_DATA_LINK_LAYER</span>	<span class="o">=</span> <span class="mh">0x3C</span><span class="p">,</span>
	<span class="n">REG_UIC_ERROR_CODE_NETWORK_LAYER</span>	<span class="o">=</span> <span class="mh">0x40</span><span class="p">,</span>
	<span class="n">REG_UIC_ERROR_CODE_TRANSPORT_LAYER</span>	<span class="o">=</span> <span class="mh">0x44</span><span class="p">,</span>
	<span class="n">REG_UIC_ERROR_CODE_DME</span>			<span class="o">=</span> <span class="mh">0x48</span><span class="p">,</span>
	<span class="n">REG_UTP_TRANSFER_REQ_INT_AGG_CONTROL</span>	<span class="o">=</span> <span class="mh">0x4C</span><span class="p">,</span>
	<span class="n">REG_UTP_TRANSFER_REQ_LIST_BASE_L</span>	<span class="o">=</span> <span class="mh">0x50</span><span class="p">,</span>
	<span class="n">REG_UTP_TRANSFER_REQ_LIST_BASE_H</span>	<span class="o">=</span> <span class="mh">0x54</span><span class="p">,</span>
	<span class="n">REG_UTP_TRANSFER_REQ_DOOR_BELL</span>		<span class="o">=</span> <span class="mh">0x58</span><span class="p">,</span>
	<span class="n">REG_UTP_TRANSFER_REQ_LIST_CLEAR</span>		<span class="o">=</span> <span class="mh">0x5C</span><span class="p">,</span>
	<span class="n">REG_UTP_TRANSFER_REQ_LIST_RUN_STOP</span>	<span class="o">=</span> <span class="mh">0x60</span><span class="p">,</span>
	<span class="n">REG_UTP_TASK_REQ_LIST_BASE_L</span>		<span class="o">=</span> <span class="mh">0x70</span><span class="p">,</span>
	<span class="n">REG_UTP_TASK_REQ_LIST_BASE_H</span>		<span class="o">=</span> <span class="mh">0x74</span><span class="p">,</span>
	<span class="n">REG_UTP_TASK_REQ_DOOR_BELL</span>		<span class="o">=</span> <span class="mh">0x78</span><span class="p">,</span>
	<span class="n">REG_UTP_TASK_REQ_LIST_CLEAR</span>		<span class="o">=</span> <span class="mh">0x7C</span><span class="p">,</span>
	<span class="n">REG_UTP_TASK_REQ_LIST_RUN_STOP</span>		<span class="o">=</span> <span class="mh">0x80</span><span class="p">,</span>
	<span class="n">REG_UIC_COMMAND</span>				<span class="o">=</span> <span class="mh">0x90</span><span class="p">,</span>
	<span class="n">REG_UIC_COMMAND_ARG_1</span>			<span class="o">=</span> <span class="mh">0x94</span><span class="p">,</span>
	<span class="n">REG_UIC_COMMAND_ARG_2</span>			<span class="o">=</span> <span class="mh">0x98</span><span class="p">,</span>
	<span class="n">REG_UIC_COMMAND_ARG_3</span>			<span class="o">=</span> <span class="mh">0x9C</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* Controller capability masks */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">MASK_TRANSFER_REQUESTS_SLOTS</span>		<span class="o">=</span> <span class="mh">0x0000001F</span><span class="p">,</span>
	<span class="n">MASK_TASK_MANAGEMENT_REQUEST_SLOTS</span>	<span class="o">=</span> <span class="mh">0x00070000</span><span class="p">,</span>
	<span class="n">MASK_64_ADDRESSING_SUPPORT</span>		<span class="o">=</span> <span class="mh">0x01000000</span><span class="p">,</span>
	<span class="n">MASK_OUT_OF_ORDER_DATA_DELIVERY_SUPPORT</span>	<span class="o">=</span> <span class="mh">0x02000000</span><span class="p">,</span>
	<span class="n">MASK_UIC_DME_TEST_MODE_SUPPORT</span>		<span class="o">=</span> <span class="mh">0x04000000</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* UFS Version 08h */</span>
<span class="cp">#define MINOR_VERSION_NUM_MASK		UFS_MASK(0xFFFF, 0)</span>
<span class="cp">#define MAJOR_VERSION_NUM_MASK		UFS_MASK(0xFFFF, 16)</span>

<span class="cm">/* Controller UFSHCI version */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">UFSHCI_VERSION_10</span> <span class="o">=</span> <span class="mh">0x00010000</span><span class="p">,</span>
	<span class="n">UFSHCI_VERSION_11</span> <span class="o">=</span> <span class="mh">0x00010100</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * HCDDID - Host Controller Identification Descriptor</span>
<span class="cm"> *	  - Device ID and Device Class 10h</span>
<span class="cm"> */</span>
<span class="cp">#define DEVICE_CLASS	UFS_MASK(0xFFFF, 0)</span>
<span class="cp">#define DEVICE_ID	UFS_MASK(0xFF, 24)</span>

<span class="cm">/*</span>
<span class="cm"> * HCPMID - Host Controller Identification Descriptor</span>
<span class="cm"> *	  - Product/Manufacturer ID  14h</span>
<span class="cm"> */</span>
<span class="cp">#define MANUFACTURE_ID_MASK	UFS_MASK(0xFFFF, 0)</span>
<span class="cp">#define PRODUCT_ID_MASK		UFS_MASK(0xFFFF, 16)</span>

<span class="cp">#define UFS_BIT(x)	(1L &lt;&lt; (x))</span>

<span class="cp">#define UTP_TRANSFER_REQ_COMPL			UFS_BIT(0)</span>
<span class="cp">#define UIC_DME_END_PT_RESET			UFS_BIT(1)</span>
<span class="cp">#define UIC_ERROR				UFS_BIT(2)</span>
<span class="cp">#define UIC_TEST_MODE				UFS_BIT(3)</span>
<span class="cp">#define UIC_POWER_MODE				UFS_BIT(4)</span>
<span class="cp">#define UIC_HIBERNATE_EXIT			UFS_BIT(5)</span>
<span class="cp">#define UIC_HIBERNATE_ENTER			UFS_BIT(6)</span>
<span class="cp">#define UIC_LINK_LOST				UFS_BIT(7)</span>
<span class="cp">#define UIC_LINK_STARTUP			UFS_BIT(8)</span>
<span class="cp">#define UTP_TASK_REQ_COMPL			UFS_BIT(9)</span>
<span class="cp">#define UIC_COMMAND_COMPL			UFS_BIT(10)</span>
<span class="cp">#define DEVICE_FATAL_ERROR			UFS_BIT(11)</span>
<span class="cp">#define CONTROLLER_FATAL_ERROR			UFS_BIT(16)</span>
<span class="cp">#define SYSTEM_BUS_FATAL_ERROR			UFS_BIT(17)</span>

<span class="cp">#define UFSHCD_ERROR_MASK	(UIC_ERROR |\</span>
<span class="cp">				DEVICE_FATAL_ERROR |\</span>
<span class="cp">				CONTROLLER_FATAL_ERROR |\</span>
<span class="cp">				SYSTEM_BUS_FATAL_ERROR)</span>

<span class="cp">#define INT_FATAL_ERRORS	(DEVICE_FATAL_ERROR |\</span>
<span class="cp">				CONTROLLER_FATAL_ERROR |\</span>
<span class="cp">				SYSTEM_BUS_FATAL_ERROR)</span>

<span class="cm">/* HCS - Host Controller Status 30h */</span>
<span class="cp">#define DEVICE_PRESENT				UFS_BIT(0)</span>
<span class="cp">#define UTP_TRANSFER_REQ_LIST_READY		UFS_BIT(1)</span>
<span class="cp">#define UTP_TASK_REQ_LIST_READY			UFS_BIT(2)</span>
<span class="cp">#define UIC_COMMAND_READY			UFS_BIT(3)</span>
<span class="cp">#define HOST_ERROR_INDICATOR			UFS_BIT(4)</span>
<span class="cp">#define DEVICE_ERROR_INDICATOR			UFS_BIT(5)</span>
<span class="cp">#define UIC_POWER_MODE_CHANGE_REQ_STATUS_MASK	UFS_MASK(0x7, 8)</span>

<span class="cm">/* HCE - Host Controller Enable 34h */</span>
<span class="cp">#define CONTROLLER_ENABLE	UFS_BIT(0)</span>
<span class="cp">#define CONTROLLER_DISABLE	0x0</span>

<span class="cm">/* UECPA - Host UIC Error Code PHY Adapter Layer 38h */</span>
<span class="cp">#define UIC_PHY_ADAPTER_LAYER_ERROR			UFS_BIT(31)</span>
<span class="cp">#define UIC_PHY_ADAPTER_LAYER_ERROR_CODE_MASK		0x1F</span>

<span class="cm">/* UECDL - Host UIC Error Code Data Link Layer 3Ch */</span>
<span class="cp">#define UIC_DATA_LINK_LAYER_ERROR		UFS_BIT(31)</span>
<span class="cp">#define UIC_DATA_LINK_LAYER_ERROR_CODE_MASK	0x7FFF</span>
<span class="cp">#define UIC_DATA_LINK_LAYER_ERROR_PA_INIT	0x2000</span>

<span class="cm">/* UECN - Host UIC Error Code Network Layer 40h */</span>
<span class="cp">#define UIC_NETWORK_LAYER_ERROR			UFS_BIT(31)</span>
<span class="cp">#define UIC_NETWORK_LAYER_ERROR_CODE_MASK	0x7</span>

<span class="cm">/* UECT - Host UIC Error Code Transport Layer 44h */</span>
<span class="cp">#define UIC_TRANSPORT_LAYER_ERROR		UFS_BIT(31)</span>
<span class="cp">#define UIC_TRANSPORT_LAYER_ERROR_CODE_MASK	0x7F</span>

<span class="cm">/* UECDME - Host UIC Error Code DME 48h */</span>
<span class="cp">#define UIC_DME_ERROR			UFS_BIT(31)</span>
<span class="cp">#define UIC_DME_ERROR_CODE_MASK		0x1</span>

<span class="cp">#define INT_AGGR_TIMEOUT_VAL_MASK		0xFF</span>
<span class="cp">#define INT_AGGR_COUNTER_THRESHOLD_MASK		UFS_MASK(0x1F, 8)</span>
<span class="cp">#define INT_AGGR_COUNTER_AND_TIMER_RESET	UFS_BIT(16)</span>
<span class="cp">#define INT_AGGR_STATUS_BIT			UFS_BIT(20)</span>
<span class="cp">#define INT_AGGR_PARAM_WRITE			UFS_BIT(24)</span>
<span class="cp">#define INT_AGGR_ENABLE				UFS_BIT(31)</span>

<span class="cm">/* UTRLRSR - UTP Transfer Request Run-Stop Register 60h */</span>
<span class="cp">#define UTP_TRANSFER_REQ_LIST_RUN_STOP_BIT	UFS_BIT(0)</span>

<span class="cm">/* UTMRLRSR - UTP Task Management Request Run-Stop Register 80h */</span>
<span class="cp">#define UTP_TASK_REQ_LIST_RUN_STOP_BIT		UFS_BIT(0)</span>

<span class="cm">/* UICCMD - UIC Command */</span>
<span class="cp">#define COMMAND_OPCODE_MASK		0xFF</span>
<span class="cp">#define GEN_SELECTOR_INDEX_MASK		0xFFFF</span>

<span class="cp">#define MIB_ATTRIBUTE_MASK		UFS_MASK(0xFFFF, 16)</span>
<span class="cp">#define RESET_LEVEL			0xFF</span>

<span class="cp">#define ATTR_SET_TYPE_MASK		UFS_MASK(0xFF, 16)</span>
<span class="cp">#define CONFIG_RESULT_CODE_MASK		0xFF</span>
<span class="cp">#define GENERIC_ERROR_CODE_MASK		0xFF</span>

<span class="cm">/* UIC Commands */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">UIC_CMD_DME_GET</span>			<span class="o">=</span> <span class="mh">0x01</span><span class="p">,</span>
	<span class="n">UIC_CMD_DME_SET</span>			<span class="o">=</span> <span class="mh">0x02</span><span class="p">,</span>
	<span class="n">UIC_CMD_DME_PEER_GET</span>		<span class="o">=</span> <span class="mh">0x03</span><span class="p">,</span>
	<span class="n">UIC_CMD_DME_PEER_SET</span>		<span class="o">=</span> <span class="mh">0x04</span><span class="p">,</span>
	<span class="n">UIC_CMD_DME_POWERON</span>		<span class="o">=</span> <span class="mh">0x10</span><span class="p">,</span>
	<span class="n">UIC_CMD_DME_POWEROFF</span>		<span class="o">=</span> <span class="mh">0x11</span><span class="p">,</span>
	<span class="n">UIC_CMD_DME_ENABLE</span>		<span class="o">=</span> <span class="mh">0x12</span><span class="p">,</span>
	<span class="n">UIC_CMD_DME_RESET</span>		<span class="o">=</span> <span class="mh">0x14</span><span class="p">,</span>
	<span class="n">UIC_CMD_DME_END_PT_RST</span>		<span class="o">=</span> <span class="mh">0x15</span><span class="p">,</span>
	<span class="n">UIC_CMD_DME_LINK_STARTUP</span>	<span class="o">=</span> <span class="mh">0x16</span><span class="p">,</span>
	<span class="n">UIC_CMD_DME_HIBER_ENTER</span>		<span class="o">=</span> <span class="mh">0x17</span><span class="p">,</span>
	<span class="n">UIC_CMD_DME_HIBER_EXIT</span>		<span class="o">=</span> <span class="mh">0x18</span><span class="p">,</span>
	<span class="n">UIC_CMD_DME_TEST_MODE</span>		<span class="o">=</span> <span class="mh">0x1A</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* UIC Config result code / Generic error code */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">UIC_CMD_RESULT_SUCCESS</span>			<span class="o">=</span> <span class="mh">0x00</span><span class="p">,</span>
	<span class="n">UIC_CMD_RESULT_INVALID_ATTR</span>		<span class="o">=</span> <span class="mh">0x01</span><span class="p">,</span>
	<span class="n">UIC_CMD_RESULT_FAILURE</span>			<span class="o">=</span> <span class="mh">0x01</span><span class="p">,</span>
	<span class="n">UIC_CMD_RESULT_INVALID_ATTR_VALUE</span>	<span class="o">=</span> <span class="mh">0x02</span><span class="p">,</span>
	<span class="n">UIC_CMD_RESULT_READ_ONLY_ATTR</span>		<span class="o">=</span> <span class="mh">0x03</span><span class="p">,</span>
	<span class="n">UIC_CMD_RESULT_WRITE_ONLY_ATTR</span>		<span class="o">=</span> <span class="mh">0x04</span><span class="p">,</span>
	<span class="n">UIC_CMD_RESULT_BAD_INDEX</span>		<span class="o">=</span> <span class="mh">0x05</span><span class="p">,</span>
	<span class="n">UIC_CMD_RESULT_LOCKED_ATTR</span>		<span class="o">=</span> <span class="mh">0x06</span><span class="p">,</span>
	<span class="n">UIC_CMD_RESULT_BAD_TEST_FEATURE_INDEX</span>	<span class="o">=</span> <span class="mh">0x07</span><span class="p">,</span>
	<span class="n">UIC_CMD_RESULT_PEER_COMM_FAILURE</span>	<span class="o">=</span> <span class="mh">0x08</span><span class="p">,</span>
	<span class="n">UIC_CMD_RESULT_BUSY</span>			<span class="o">=</span> <span class="mh">0x09</span><span class="p">,</span>
	<span class="n">UIC_CMD_RESULT_DME_FAILURE</span>		<span class="o">=</span> <span class="mh">0x0A</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define MASK_UIC_COMMAND_RESULT			0xFF</span>

<span class="cp">#define INT_AGGR_COUNTER_THRESHOLD_VALUE	(0x1F &lt;&lt; 8)</span>
<span class="cp">#define INT_AGGR_TIMEOUT_VALUE			(0x02)</span>

<span class="cm">/* Interrupt disable masks */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="cm">/* Interrupt disable mask for UFSHCI v1.0 */</span>
	<span class="n">INTERRUPT_DISABLE_MASK_10</span>	<span class="o">=</span> <span class="mh">0xFFFF</span><span class="p">,</span>

	<span class="cm">/* Interrupt disable mask for UFSHCI v1.1 */</span>
	<span class="n">INTERRUPT_DISABLE_MASK_11</span>	<span class="o">=</span> <span class="mh">0x0</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Request Descriptor Definitions</span>
<span class="cm"> */</span>

<span class="cm">/* Transfer request command type */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">UTP_CMD_TYPE_SCSI</span>		<span class="o">=</span> <span class="mh">0x0</span><span class="p">,</span>
	<span class="n">UTP_CMD_TYPE_UFS</span>		<span class="o">=</span> <span class="mh">0x1</span><span class="p">,</span>
	<span class="n">UTP_CMD_TYPE_DEV_MANAGE</span>		<span class="o">=</span> <span class="mh">0x2</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">UTP_SCSI_COMMAND</span>		<span class="o">=</span> <span class="mh">0x00000000</span><span class="p">,</span>
	<span class="n">UTP_NATIVE_UFS_COMMAND</span>		<span class="o">=</span> <span class="mh">0x10000000</span><span class="p">,</span>
	<span class="n">UTP_DEVICE_MANAGEMENT_FUNCTION</span>	<span class="o">=</span> <span class="mh">0x20000000</span><span class="p">,</span>
	<span class="n">UTP_REQ_DESC_INT_CMD</span>		<span class="o">=</span> <span class="mh">0x01000000</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* UTP Transfer Request Data Direction (DD) */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">UTP_NO_DATA_TRANSFER</span>	<span class="o">=</span> <span class="mh">0x00000000</span><span class="p">,</span>
	<span class="n">UTP_HOST_TO_DEVICE</span>	<span class="o">=</span> <span class="mh">0x02000000</span><span class="p">,</span>
	<span class="n">UTP_DEVICE_TO_HOST</span>	<span class="o">=</span> <span class="mh">0x04000000</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* Overall command status values */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">OCS_SUCCESS</span>			<span class="o">=</span> <span class="mh">0x0</span><span class="p">,</span>
	<span class="n">OCS_INVALID_CMD_TABLE_ATTR</span>	<span class="o">=</span> <span class="mh">0x1</span><span class="p">,</span>
	<span class="n">OCS_INVALID_PRDT_ATTR</span>		<span class="o">=</span> <span class="mh">0x2</span><span class="p">,</span>
	<span class="n">OCS_MISMATCH_DATA_BUF_SIZE</span>	<span class="o">=</span> <span class="mh">0x3</span><span class="p">,</span>
	<span class="n">OCS_MISMATCH_RESP_UPIU_SIZE</span>	<span class="o">=</span> <span class="mh">0x4</span><span class="p">,</span>
	<span class="n">OCS_PEER_COMM_FAILURE</span>		<span class="o">=</span> <span class="mh">0x5</span><span class="p">,</span>
	<span class="n">OCS_ABORTED</span>			<span class="o">=</span> <span class="mh">0x6</span><span class="p">,</span>
	<span class="n">OCS_FATAL_ERROR</span>			<span class="o">=</span> <span class="mh">0x7</span><span class="p">,</span>
	<span class="n">OCS_INVALID_COMMAND_STATUS</span>	<span class="o">=</span> <span class="mh">0x0F</span><span class="p">,</span>
	<span class="n">MASK_OCS</span>			<span class="o">=</span> <span class="mh">0x0F</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct ufshcd_sg_entry - UFSHCI PRD Entry</span>
<span class="cm"> * @base_addr: Lower 32bit physical address DW-0</span>
<span class="cm"> * @upper_addr: Upper 32bit physical address DW-1</span>
<span class="cm"> * @reserved: Reserved for future use DW-2</span>
<span class="cm"> * @size: size of physical segment DW-3</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">ufshcd_sg_entry</span> <span class="p">{</span>
	<span class="n">u32</span>    <span class="n">base_addr</span><span class="p">;</span>
	<span class="n">u32</span>    <span class="n">upper_addr</span><span class="p">;</span>
	<span class="n">u32</span>    <span class="n">reserved</span><span class="p">;</span>
	<span class="n">u32</span>    <span class="n">size</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct utp_transfer_cmd_desc - UFS Command Descriptor structure</span>
<span class="cm"> * @command_upiu: Command UPIU Frame address</span>
<span class="cm"> * @response_upiu: Response UPIU Frame address</span>
<span class="cm"> * @prd_table: Physical Region Descriptor</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">utp_transfer_cmd_desc</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">command_upiu</span><span class="p">[</span><span class="n">ALIGNED_UPIU_SIZE</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">response_upiu</span><span class="p">[</span><span class="n">ALIGNED_UPIU_SIZE</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">ufshcd_sg_entry</span>    <span class="n">prd_table</span><span class="p">[</span><span class="n">SG_ALL</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct request_desc_header - Descriptor Header common to both UTRD and UTMRD</span>
<span class="cm"> * @dword0: Descriptor Header DW0</span>
<span class="cm"> * @dword1: Descriptor Header DW1</span>
<span class="cm"> * @dword2: Descriptor Header DW2</span>
<span class="cm"> * @dword3: Descriptor Header DW3</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">request_desc_header</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">dword_0</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">dword_1</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">dword_2</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">dword_3</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct utp_transfer_req_desc - UTRD structure</span>
<span class="cm"> * @header: UTRD header DW-0 to DW-3</span>
<span class="cm"> * @command_desc_base_addr_lo: UCD base address low DW-4</span>
<span class="cm"> * @command_desc_base_addr_hi: UCD base address high DW-5</span>
<span class="cm"> * @response_upiu_length: response UPIU length DW-6</span>
<span class="cm"> * @response_upiu_offset: response UPIU offset DW-6</span>
<span class="cm"> * @prd_table_length: Physical region descriptor length DW-7</span>
<span class="cm"> * @prd_table_offset: Physical region descriptor offset DW-7</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">utp_transfer_req_desc</span> <span class="p">{</span>

	<span class="cm">/* DW 0-3 */</span>
	<span class="k">struct</span> <span class="n">request_desc_header</span> <span class="n">header</span><span class="p">;</span>

	<span class="cm">/* DW 4-5*/</span>
	<span class="n">u32</span>  <span class="n">command_desc_base_addr_lo</span><span class="p">;</span>
	<span class="n">u32</span>  <span class="n">command_desc_base_addr_hi</span><span class="p">;</span>

	<span class="cm">/* DW 6 */</span>
	<span class="n">u16</span>  <span class="n">response_upiu_length</span><span class="p">;</span>
	<span class="n">u16</span>  <span class="n">response_upiu_offset</span><span class="p">;</span>

	<span class="cm">/* DW 7 */</span>
	<span class="n">u16</span>  <span class="n">prd_table_length</span><span class="p">;</span>
	<span class="n">u16</span>  <span class="n">prd_table_offset</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct utp_task_req_desc - UTMRD structure</span>
<span class="cm"> * @header: UTMRD header DW-0 to DW-3</span>
<span class="cm"> * @task_req_upiu: Pointer to task request UPIU DW-4 to DW-11</span>
<span class="cm"> * @task_rsp_upiu: Pointer to task response UPIU DW12 to DW-19</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">utp_task_req_desc</span> <span class="p">{</span>

	<span class="cm">/* DW 0-3 */</span>
	<span class="k">struct</span> <span class="n">request_desc_header</span> <span class="n">header</span><span class="p">;</span>

	<span class="cm">/* DW 4-11 */</span>
	<span class="n">u32</span> <span class="n">task_req_upiu</span><span class="p">[</span><span class="n">TASK_REQ_UPIU_SIZE_DWORDS</span><span class="p">];</span>

	<span class="cm">/* DW 12-19 */</span>
	<span class="n">u32</span> <span class="n">task_rsp_upiu</span><span class="p">[</span><span class="n">TASK_RSP_UPIU_SIZE_DWORDS</span><span class="p">];</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="cm">/* End of Header */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
