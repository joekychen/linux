<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › scsi › libfc › fc_libfc.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>fc_libfc.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright(c) 2009 Intel Corporation. All rights reserved.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify it</span>
<span class="cm"> * under the terms and conditions of the GNU General Public License,</span>
<span class="cm"> * version 2, as published by the Free Software Foundation.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope it will be useful, but WITHOUT</span>
<span class="cm"> * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span>
<span class="cm"> * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for</span>
<span class="cm"> * more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License along with</span>
<span class="cm"> * this program; if not, write to the Free Software Foundation, Inc.,</span>
<span class="cm"> * 51 Franklin St - Fifth Floor, Boston, MA 02110-1301 USA.</span>
<span class="cm"> *</span>
<span class="cm"> * Maintained at www.Open-FCoE.org</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _FC_LIBFC_H_</span>
<span class="cp">#define _FC_LIBFC_H_</span>

<span class="cp">#define FC_LIBFC_LOGGING 0x01 </span><span class="cm">/* General logging, not categorized */</span><span class="cp"></span>
<span class="cp">#define FC_LPORT_LOGGING 0x02 </span><span class="cm">/* lport layer logging */</span><span class="cp"></span>
<span class="cp">#define FC_DISC_LOGGING	 0x04 </span><span class="cm">/* discovery layer logging */</span><span class="cp"></span>
<span class="cp">#define FC_RPORT_LOGGING 0x08 </span><span class="cm">/* rport layer logging */</span><span class="cp"></span>
<span class="cp">#define FC_FCP_LOGGING	 0x10 </span><span class="cm">/* I/O path logging */</span><span class="cp"></span>
<span class="cp">#define FC_EM_LOGGING	 0x20 </span><span class="cm">/* Exchange Manager logging */</span><span class="cp"></span>
<span class="cp">#define FC_EXCH_LOGGING	 0x40 </span><span class="cm">/* Exchange/Sequence logging */</span><span class="cp"></span>
<span class="cp">#define FC_SCSI_LOGGING	 0x80 </span><span class="cm">/* SCSI logging (mostly error handling) */</span><span class="cp"></span>

<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">fc_debug_logging</span><span class="p">;</span>

<span class="cp">#define FC_CHECK_LOGGING(LEVEL, CMD)			\</span>
<span class="cp">	do {						\</span>
<span class="cp">		if (unlikely(fc_debug_logging &amp; LEVEL))	\</span>
<span class="cp">			do {				\</span>
<span class="cp">				CMD;			\</span>
<span class="cp">			} while (0);			\</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define FC_LIBFC_DBG(fmt, args...)					\</span>
<span class="cp">	FC_CHECK_LOGGING(FC_LIBFC_LOGGING,				\</span>
<span class="cp">			 printk(KERN_INFO &quot;libfc: &quot; fmt, ##args))</span>

<span class="cp">#define FC_LPORT_DBG(lport, fmt, args...)				\</span>
<span class="cp">	FC_CHECK_LOGGING(FC_LPORT_LOGGING,				\</span>
<span class="cp">			 printk(KERN_INFO &quot;host%u: lport %6.6x: &quot; fmt,	\</span>
<span class="cp">				(lport)-&gt;host-&gt;host_no,			\</span>
<span class="cp">				(lport)-&gt;port_id, ##args))</span>

<span class="cp">#define FC_DISC_DBG(disc, fmt, args...)				\</span>
<span class="cp">	FC_CHECK_LOGGING(FC_DISC_LOGGING,			\</span>
<span class="cp">			 printk(KERN_INFO &quot;host%u: disc: &quot; fmt,	\</span>
<span class="cp">				fc_disc_lport(disc)-&gt;host-&gt;host_no,	\</span>
<span class="cp">				##args))</span>

<span class="cp">#define FC_RPORT_ID_DBG(lport, port_id, fmt, args...)			\</span>
<span class="cp">	FC_CHECK_LOGGING(FC_RPORT_LOGGING,				\</span>
<span class="cp">			 printk(KERN_INFO &quot;host%u: rport %6.6x: &quot; fmt,	\</span>
<span class="cp">				(lport)-&gt;host-&gt;host_no,			\</span>
<span class="cp">				(port_id), ##args))</span>

<span class="cp">#define FC_RPORT_DBG(rdata, fmt, args...)				\</span>
<span class="cp">	FC_RPORT_ID_DBG((rdata)-&gt;local_port, (rdata)-&gt;ids.port_id, fmt, ##args)</span>

<span class="cp">#define FC_FCP_DBG(pkt, fmt, args...)					\</span>
<span class="cp">	FC_CHECK_LOGGING(FC_FCP_LOGGING,				\</span>
<span class="cp">	{								\</span>
<span class="cp">		if ((pkt)-&gt;seq_ptr) {					\</span>
<span class="cp">			struct fc_exch *_ep = NULL;			\</span>
<span class="cp">			_ep = fc_seq_exch((pkt)-&gt;seq_ptr);		\</span>
<span class="cp">			printk(KERN_INFO &quot;host%u: fcp: %6.6x: &quot;		\</span>
<span class="cp">				&quot;xid %04x-%04x: &quot; fmt,			\</span>
<span class="cp">				(pkt)-&gt;lp-&gt;host-&gt;host_no,		\</span>
<span class="cp">				(pkt)-&gt;rport-&gt;port_id,			\</span>
<span class="cp">				(_ep)-&gt;oxid, (_ep)-&gt;rxid, ##args);	\</span>
<span class="cp">		} else {						\</span>
<span class="cp">			printk(KERN_INFO &quot;host%u: fcp: %6.6x: &quot; fmt,	\</span>
<span class="cp">				(pkt)-&gt;lp-&gt;host-&gt;host_no,		\</span>
<span class="cp">				(pkt)-&gt;rport-&gt;port_id, ##args);		\</span>
<span class="cp">		}							\</span>
<span class="cp">	})</span>

<span class="cp">#define FC_EXCH_DBG(exch, fmt, args...)					\</span>
<span class="cp">	FC_CHECK_LOGGING(FC_EXCH_LOGGING,				\</span>
<span class="cp">			 printk(KERN_INFO &quot;host%u: xid %4x: &quot; fmt,	\</span>
<span class="cp">				(exch)-&gt;lp-&gt;host-&gt;host_no,		\</span>
<span class="cp">				exch-&gt;xid, ##args))</span>

<span class="cp">#define FC_SCSI_DBG(lport, fmt, args...)				\</span>
<span class="cp">	FC_CHECK_LOGGING(FC_SCSI_LOGGING,				\</span>
<span class="cp">			 printk(KERN_INFO &quot;host%u: scsi: &quot; fmt,		\</span>
<span class="cp">				(lport)-&gt;host-&gt;host_no,	##args))</span>

<span class="cm">/*</span>
<span class="cm"> * FC-4 Providers.</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">fc4_prov</span> <span class="o">*</span><span class="n">fc_active_prov</span><span class="p">[];</span>	<span class="cm">/* providers without recv */</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">fc4_prov</span> <span class="o">*</span><span class="n">fc_passive_prov</span><span class="p">[];</span>	<span class="cm">/* providers with recv */</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">mutex</span> <span class="n">fc_prov_mutex</span><span class="p">;</span>		<span class="cm">/* lock over table changes */</span>

<span class="k">extern</span> <span class="k">struct</span> <span class="n">fc4_prov</span> <span class="n">fc_rport_t0_prov</span><span class="p">;</span>	<span class="cm">/* type 0 provider */</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">fc4_prov</span> <span class="n">fc_lport_els_prov</span><span class="p">;</span>	<span class="cm">/* ELS provider */</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">fc4_prov</span> <span class="n">fc_rport_fcp_init</span><span class="p">;</span>	<span class="cm">/* FCP initiator provider */</span>

<span class="cm">/*</span>
<span class="cm"> * Set up direct-data placement for this I/O request</span>
<span class="cm"> */</span>
<span class="kt">void</span> <span class="n">fc_fcp_ddp_setup</span><span class="p">(</span><span class="k">struct</span> <span class="n">fc_fcp_pkt</span> <span class="o">*</span><span class="n">fsp</span><span class="p">,</span> <span class="n">u16</span> <span class="n">xid</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">fc_fcp_ddp_done</span><span class="p">(</span><span class="k">struct</span> <span class="n">fc_fcp_pkt</span> <span class="o">*</span><span class="n">fsp</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Module setup functions</span>
<span class="cm"> */</span>
<span class="kt">int</span> <span class="n">fc_setup_exch_mgr</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">fc_destroy_exch_mgr</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">fc_setup_rport</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">fc_destroy_rport</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">fc_setup_fcp</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">fc_destroy_fcp</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Internal libfc functions</span>
<span class="cm"> */</span>
<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">fc_els_resp_type</span><span class="p">(</span><span class="k">struct</span> <span class="n">fc_frame</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">fc_fc4_add_lport</span><span class="p">(</span><span class="k">struct</span> <span class="n">fc_lport</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">fc_fc4_del_lport</span><span class="p">(</span><span class="k">struct</span> <span class="n">fc_lport</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">fc_fc4_conf_lport_params</span><span class="p">(</span><span class="k">struct</span> <span class="n">fc_lport</span> <span class="o">*</span><span class="p">,</span> <span class="k">enum</span> <span class="n">fc_fh_type</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Copies a buffer into an sg list</span>
<span class="cm"> */</span>
<span class="n">u32</span> <span class="n">fc_copy_buffer_to_sglist</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">len</span><span class="p">,</span>
			     <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">sg</span><span class="p">,</span>
			     <span class="n">u32</span> <span class="o">*</span><span class="n">nents</span><span class="p">,</span> <span class="kt">size_t</span> <span class="o">*</span><span class="n">offset</span><span class="p">,</span>
			     <span class="n">u32</span> <span class="o">*</span><span class="n">crc</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* _FC_LIBFC_H_ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
