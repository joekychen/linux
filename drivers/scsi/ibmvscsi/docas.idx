f | ibmvfc.c | s | 135K | 4409 | Benjamin Herrenschmidt | benh@kernel.crashing.org | 1332894804 |  | powerpc+sparc/vio: Modernize driver registration  This makes vio_register_driver() get the module owner & name at compile time like PCI drivers do, and adds a name pointer directly in struct vio_driver to avoid having to explicitly initialize the embedded struct device.  Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org> Acked-by: David S. Miller <davem@davemloft.net>
f | ibmvscsi.h | s | 4.0K | 121 | Stephen Rothwell | sfr@canb.auug.org.au | 1331249715 |  | powerpc: remove the legacy iSeries part of ibmvscsi  The PowerPC legacy iSeries platform is being removed and this code is no longer selectable.  There is more clean up that can be done, but this just gets the old code out of the way.  Cc: "James E.J. Bottomley" <JBottomley@parallels.com> Cc: Brian King <brking@linux.vnet.ibm.com> Cc: linux-scsi@vger.kernel.org Signed-off-by: Stephen Rothwell <sfr@canb.auug.org.au> Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
f | rpa_vscsi.c | s | 10K | 323 | Brian King | brking@linux.vnet.ibm.com | 1280250226 |  | [SCSI] ibmvscsi: Fix softlockup on resume  This fixes a softlockup seen on resume. During resume, the CRQ must be reenabled. However, the H_ENABLE_CRQ hcall used to do this may return H_BUSY or H_LONG_BUSY. When this happens, the caller is expected to retry later. This patch changes a simple loop, which was causing the softlockup, to a loop at task level which sleeps between retries rather than simply spinning.  Signed-off-by: Brian King <brking@linux.vnet.ibm.com> Signed-off-by: James Bottomley <James.Bottomley@suse.de>
f | Makefile | g | 202B |  | Stephen Rothwell | sfr@canb.auug.org.au | 1331249715 |  | powerpc: remove the legacy iSeries part of ibmvscsi  The PowerPC legacy iSeries platform is being removed and this code is no longer selectable.  There is more clean up that can be done, but this just gets the old code out of the way.  Cc: "James E.J. Bottomley" <JBottomley@parallels.com> Cc: Brian King <brking@linux.vnet.ibm.com> Cc: linux-scsi@vger.kernel.org Signed-off-by: Stephen Rothwell <sfr@canb.auug.org.au> Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
f | ibmvscsi.c | s | 60K | 1822 | Benjamin Herrenschmidt | benh@kernel.crashing.org | 1332894804 |  | powerpc+sparc/vio: Modernize driver registration  This makes vio_register_driver() get the module owner & name at compile time like PCI drivers do, and adds a name pointer directly in struct vio_driver to avoid having to explicitly initialize the embedded struct device.  Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org> Acked-by: David S. Miller <davem@davemloft.net>
f | ibmvfc.h | s | 18K | 699 | Robert Jennings | rcj@linux.vnet.ibm.com | 1292955889 |  | [SCSI] ibmvfc: Improve ibmvfc_async_desc memory layout  By changing field ordering we can avoid a couple of memory holes in the tables that use the ibmvfc_async_desc structure.  Signed-off-by: Robert Jennings <rcj@linux.vnet.ibm.com> Acked-by: Brian King <brking@linux.vnet.ibm.com> Signed-off-by: James Bottomley <James.Bottomley@suse.de>
f | ibmvstgt.c | s | 23K | 833 | Benjamin Herrenschmidt | benh@kernel.crashing.org | 1332894804 |  | powerpc+sparc/vio: Modernize driver registration  This makes vio_register_driver() get the module owner & name at compile time like PCI drivers do, and adds a name pointer directly in struct vio_driver to avoid having to explicitly initialize the embedded struct device.  Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org> Acked-by: David S. Miller <davem@davemloft.net>
f | viosrp.h | s | 6.2K | 191 | Brian King | brking@linux.vnet.ibm.com | 1244502321 |  | [SCSI] ibmvscsi: Add support for capabilities MAD  Add support to ibmvscsi for the capabilities MAD. This command gets sent to the Virtual I/O server prior to login in order to communicate client capabilities. Additionally it returns information regarding capabilities that the server supports. The two main capabilities communicated in this MAD are related to partition migration and client reserve. Client reserve allows for SCSI-2 reservations to be sent to virtual disks which are backed by physical LUNs and will result in the reservation being sent to the physical LUN.  Signed-off-by: Brian King <brking@linux.vnet.ibm.com> Signed-off-by: James Bottomley <James.Bottomley@HansenPartnership.com>
