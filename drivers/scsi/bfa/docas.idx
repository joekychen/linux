f | bfad_im.c | s | 33K | 1136 | Krishna Gudipati | kgudipat@brocade.com | 1337681189 |  | [SCSI] bfa: Fix to set vport FC host sysfs entries  Made changes to set the fc_host sysfs entries supported_speeds, supported_classes etc., during the vport creation from the FC transport template.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfa_ioc_cb.c | s | 8.9K | 277 | Krishna Gudipati | kgudipat@brocade.com | 1309384672 |  | [SCSI] bfa: IOC bug fixes.  - Add logic to handle the case where PCI mapping goes away when   IOCPF state machine is waiting for semaphore. - Added logic to unlock hw semaphore if the previos FW boot was   from flash based and the current FW initialization attempt is from OS. - Added fix to update hbfails and hb_count stats during hwerror event.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfa_fcpim.h | s | 13K | 375 | Krishna Gudipati | kgudipat@brocade.com | 1326236484 |  | [SCSI] bfa: Revert back the current LUN Masking Implementation.  This patch reverts the current LUN Masking Implementation.  We re-implemented this feature using the SCSI Slave Callout's as per the review comments.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | Makefile | g | 303B |  | Krishna Gudipati | kgudipat@brocade.com | 1309381193 |  | [SCSI] bfa: Add BSG interface to support ELS, CT and vendor commands.  - Added BSG interface support to BFA driver - Adds support to send ELS/CT FC passthru commands and   few vendor specific BSG requests.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfa_modules.h | s | 4.5K | 125 | Krishna Gudipati | kgudipat@brocade.com | 1311764043 |  | [SCSI] bfa: Add support to store driver configuration in flash.  - Added dconf (Driver Config) BFA sub-module. - The dconf sub-module provides interfaces and manages flash writes   to the flash DRV parition. - dconf sub-module also ensures that the whole 64K DRV partition is updated   on a flash write.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfi_ms.h | s | 21K | 761 | Krishna Gudipati | kgudipat@brocade.com | 1332924922 |  | [SCSI] bfa: Revised Fabric Assigned Address(FAA) feature implementation.  Made changes to the Fabric Assigned Address(FAA) feature implementation. Introduced the IOCFC state machine, which now handles the FAA logic, IOC and BFA sub-modules enablement. Removed un-wanted FAA enable/disable routines; FAA is enabled by default.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfa_fcs_rport.c | s | 76K | 2579 | Krishna Gudipati | kgudipat@brocade.com | 1332925078 |  | [SCSI] bfa: BSG and User interface fixes.  Made changes to set the rport maxfrsize param to use a value that is equal to or less than the Buffer-to-Buffer Receive Data_Field size specified in the Common Service Parameters. Increased the diag memtest timeout for the Brocade-1860 adapters. Made changes to enable valid port speed configuration check for all adapters. Made changes to increase the max hw segments in a request, in order to support larger data transfers from user space.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfa_fc.h | s | 38K | 1426 | Krishna Gudipati | kgudipat@brocade.com | 1326236484 |  | [SCSI] bfa: Revert back the current LUN Masking Implementation.  This patch reverts the current LUN Masking Implementation.  We re-implemented this feature using the SCSI Slave Callout's as per the review comments.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfad_im.h | s | 6.1K | 174 | Krishna Gudipati | kgudipat@brocade.com | 1337681189 |  | [SCSI] bfa: Fix to set vport FC host sysfs entries  Made changes to set the fc_host sysfs entries supported_speeds, supported_classes etc., during the vport creation from the FC transport template.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfad_drv.h | s | 9.1K | 322 | Krishna Gudipati | kgudipat@brocade.com | 1332925366 |  | [SCSI] bfa: Update the driver version to 3.0.23.0  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfa_port.c | s | 19K | 751 | Krishna Gudipati | kgudipat@brocade.com | 1309386440 |  | [SCSI] bfa: Added support to query PHY.  - Added PHY sub-module. - Implemented interface to obtain stats and to   read/update the fw from the PHY module.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfa_port.h | s | 4.0K | 110 | Krishna Gudipati | kgudipat@brocade.com | 1309386083 |  | [SCSI] bfa: Added support for CEE info and stats query.  - Added CEE sub-module. - Added support to collect stats/cee module info   using BSG interface.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfa_fcpim.c | s | 92K | 3255 | Krishna Gudipati | kgudipat@brocade.com | 1326236484 |  | [SCSI] bfa: Revert back the current LUN Masking Implementation.  This patch reverts the current LUN Masking Implementation.  We re-implemented this feature using the SCSI Slave Callout's as per the review comments.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfa_fcs.h | s | 28K | 715 | Krishna Gudipati | kgudipat@brocade.com | 1335344311 |  | [SCSI] bfa: Fix to defer vport delete handler invocation till firmware logo response.  Made changes to avoid queuing the vport delete work to IM driver work queue in the bfa_fcb_lport_delete() - since at this stage we are not completely done with using the vport structure as we are still waiting for the LOGO response from the fw in online state or just doing some cleanup. Since queuing up the vport delete work at this stage will result in the FC transport layer to clean up the vport before we get the response from firmware. Made changes to queue the port delete work to the IM driver work queue - from the bfa_fcs_vport_free() function since at this state we are done with using the vport data structure and the FCS state machine is completely cleaned up.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfa.h | s | 15K | 394 | Krishna Gudipati | kgudipat@brocade.com | 1332924922 |  | [SCSI] bfa: Revised Fabric Assigned Address(FAA) feature implementation.  Made changes to the Fabric Assigned Address(FAA) feature implementation. Introduced the IOCFC state machine, which now handles the FAA logic, IOC and BFA sub-modules enablement. Removed un-wanted FAA enable/disable routines; FAA is enabled by default.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfa_defs.h | s | 32K | 1040 | Jing Huang | huangj@brocade.com | 1323932101 |  | [SCSI] bfa: fix endian and bit field check bug  Fix some endian issue. __BIGENDIAN is not defined and it needs to be replaced with __BIG_ENDIAN. Also fixed a bug in bit field access. These two issues were reported by Dan Carpenter.  Signed-off-by: Jing Huang <huangj@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfa_core.c | s | 48K | 1651 | Krishna Gudipati | kgudipat@brocade.com | 1332924922 |  | [SCSI] bfa: Revised Fabric Assigned Address(FAA) feature implementation.  Made changes to the Fabric Assigned Address(FAA) feature implementation. Introduced the IOCFC state machine, which now handles the FAA logic, IOC and BFA sub-modules enablement. Removed un-wanted FAA enable/disable routines; FAA is enabled by default.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfa_hw_cb.c | s | 4.6K | 164 | Krishna Gudipati | kgudipat@brocade.com | 1311763488 |  | [SCSI] bfa: Update RME interrupt handling.  - Made changes to always acknowledge RME interrupt and update   consumer index (CI) when RME interrupt is generated. - Made changes to have ASIC specific hw_rspq_ack() handler.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfa_fcbuild.c | s | 37K | 1142 | Krishna Gudipati | kgudipat@brocade.com | 1309385531 |  | [SCSI] bfa: FCS bug fixes.  - Added logic to initiate a PLOGI to the target, while processing a LOGO   from the same target in Direct attach mode. - Added logic to generate a FCCT Reject indicating unsupported command,   upon receiving FCCT/FCGS requests. - Added logic to set the fcpim in offline state and avoid any PRLI retries   if a PRLI response is a reject with a reason Command Not Supported. - Updated the FDMI Supported/Current speeds. - Added logic to wait for the response  from the firmware before sending   ACC to PLOGI and transitioning to subsequent states - while processing an   Incoming PLOGI in online state. - Added a wait state in the fcs_vport state machine - For case where   FDISC is in progress and we get a vport delete request we wait for   fdisc response and will transition to the appropriate state based on   rsp status, else its causing both driver/fw resources to be not   freed. - Remove the fc_credit_recovery module param.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfa_cs.h | s | 8.2K | 308 | Jing Huang | huangj@brocade.com | 1293809933 |  | [SCSI] bfa: remove inactive functions  This patch removes some inactive functions and macros.  Signed-off-by: Jing Huang <huangj@brocade.com> Signed-off-by: James Bottomley <James.Bottomley@suse.de>
f | bfa_svc.c | s | 133K | 4800 | Krishna Gudipati | kgudipat@brocade.com | 1332925078 |  | [SCSI] bfa: BSG and User interface fixes.  Made changes to set the rport maxfrsize param to use a value that is equal to or less than the Buffer-to-Buffer Receive Data_Field size specified in the Common Service Parameters. Increased the diag memtest timeout for the Brocade-1860 adapters. Made changes to enable valid port speed configuration check for all adapters. Made changes to increase the max hw segments in a request, in order to support larger data transfers from user space.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfa_defs_fcs.h | s | 13K | 412 | Krishna Gudipati | kgudipat@brocade.com | 1309385814 |  | [SCSI] bfa: Extend BSG interface.  - Added support to collect driver/fw stats. - Added support to perform adapter/ioc enable, disable operations.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfa_fcs_fcpim.c | s | 21K | 691 | Krishna Gudipati | kgudipat@brocade.com | 1311763284 |  | [SCSI] bfa: Add FC-transport based Asynchronous Event Notification support.  - Added support to post vendor unique events on fc_host. - Supports adapter, port, ioc, flash and remote port based AEN events.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfa_fcs.c | s | 36K | 1305 | Krishna Gudipati | kgudipat@brocade.com | 1311763284 |  | [SCSI] bfa: Add FC-transport based Asynchronous Event Notification support.  - Added support to post vendor unique events on fc_host. - Supports adapter, port, ioc, flash and remote port based AEN events.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfa_fcs_lport.c | s | 150K | 5164 | Krishna Gudipati | kgudipat@brocade.com | 1335344523 |  | [SCSI] bfa: Fix bfa logging for Logical port state change notification  Made changes to have the same logging level for Logical port online and offline events, to display these events in pairs.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfa_ioc.c | s | 135K | 5049 | Krishna Gudipati | kgudipat@brocade.com | 1332925078 |  | [SCSI] bfa: BSG and User interface fixes.  Made changes to set the rport maxfrsize param to use a value that is equal to or less than the Buffer-to-Buffer Receive Data_Field size specified in the Common Service Parameters. Increased the diag memtest timeout for the Brocade-1860 adapters. Made changes to enable valid port speed configuration check for all adapters. Made changes to increase the max hw segments in a request, in order to support larger data transfers from user space.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfa_ioc.h | s | 29K | 879 | Krishna Gudipati | kgudipat@brocade.com | 1332924922 |  | [SCSI] bfa: Revised Fabric Assigned Address(FAA) feature implementation.  Made changes to the Fabric Assigned Address(FAA) feature implementation. Introduced the IOCFC state machine, which now handles the FAA logic, IOC and BFA sub-modules enablement. Removed un-wanted FAA enable/disable routines; FAA is enabled by default.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfa_fcbuild.h | s | 9.8K | 245 | Krishna Gudipati | kgudipat@brocade.com | 1309385531 |  | [SCSI] bfa: FCS bug fixes.  - Added logic to initiate a PLOGI to the target, while processing a LOGO   from the same target in Direct attach mode. - Added logic to generate a FCCT Reject indicating unsupported command,   upon receiving FCCT/FCGS requests. - Added logic to set the fcpim in offline state and avoid any PRLI retries   if a PRLI response is a reject with a reason Command Not Supported. - Updated the FDMI Supported/Current speeds. - Added logic to wait for the response  from the firmware before sending   ACC to PLOGI and transitioning to subsequent states - while processing an   Incoming PLOGI in online state. - Added a wait state in the fcs_vport state machine - For case where   FDISC is in progress and we get a vport delete request we wait for   fdisc response and will transition to the appropriate state based on   rsp status, else its causing both driver/fw resources to be not   freed. - Remove the fc_credit_recovery module param.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfad_attr.c | s | 28K | 846 | Krishna Gudipati | kgudipat@brocade.com | 1337681189 |  | [SCSI] bfa: Fix to set vport FC host sysfs entries  Made changes to set the fc_host sysfs entries supported_speeds, supported_classes etc., during the vport creation from the FC transport template.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfa_hw_ct.c | s | 4.0K | 151 | Krishna Gudipati | kgudipat@brocade.com | 1311763488 |  | [SCSI] bfa: Update RME interrupt handling.  - Made changes to always acknowledge RME interrupt and update   consumer index (CI) when RME interrupt is generated. - Made changes to have ASIC specific hw_rspq_ack() handler.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfad_debugfs.c | s | 13K | 480 | Linus Torvalds | torvalds@linux-foundation.org | 1326220568 |  | 
f | bfa_svc.h | s | 23K | 630 | Krishna Gudipati | kgudipat@brocade.com | 1332924922 |  | [SCSI] bfa: Revised Fabric Assigned Address(FAA) feature implementation.  Made changes to the Fabric Assigned Address(FAA) feature implementation. Introduced the IOCFC state machine, which now handles the FAA logic, IOC and BFA sub-modules enablement. Removed un-wanted FAA enable/disable routines; FAA is enabled by default.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfad_bsg.c | s | 86K | 2830 | Krishna Gudipati | kgudipat@brocade.com | 1332925078 |  | [SCSI] bfa: BSG and User interface fixes.  Made changes to set the rport maxfrsize param to use a value that is equal to or less than the Buffer-to-Buffer Receive Data_Field size specified in the Common Service Parameters. Increased the diag memtest timeout for the Brocade-1860 adapters. Made changes to enable valid port speed configuration check for all adapters. Made changes to increase the max hw segments in a request, in order to support larger data transfers from user space.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfad.c | s | 40K | 1375 | Krishna Gudipati | kgudipat@brocade.com | 1335344311 |  | [SCSI] bfa: Fix to defer vport delete handler invocation till firmware logo response.  Made changes to avoid queuing the vport delete work to IM driver work queue in the bfa_fcb_lport_delete() - since at this stage we are not completely done with using the vport structure as we are still waiting for the LOGO response from the fw in online state or just doing some cleanup. Since queuing up the vport delete work at this stage will result in the FC transport layer to clean up the vport before we get the response from firmware. Made changes to queue the port delete work to the IM driver work queue - from the bfa_fcs_vport_free() function since at this state we are done with using the vport data structure and the FCS state machine is completely cleaned up.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfi_reg.h | s | 18K | 432 | Krishna Gudipati | kgudipat@brocade.com | 1332924872 |  | [SCSI] bfa: Flash controller IOC pll init fixes.  Made changes to resume the flash controller if it is halted before going ahead with flash controller pause/resume logic. Made changes to avoid clearing off the interrupts during the initial pll initialization.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfa_plog.h | s | 4.4K | 141 | Maggie Zhang | xmzhang@brocade.com | 1292956363 |  | [SCSI] bfa: clean up one line functions  Cleaned up one line functions.  Signed-off-by: Maggie Zhang <xmzhang@brocade.com> Signed-off-by: Jing Huang <huangj@brocade.com> Signed-off-by: James Bottomley <James.Bottomley@suse.de>
f | bfa_defs_svc.h | s | 43K | 1205 | Krishna Gudipati | kgudipat@brocade.com | 1332924922 |  | [SCSI] bfa: Revised Fabric Assigned Address(FAA) feature implementation.  Made changes to the Fabric Assigned Address(FAA) feature implementation. Introduced the IOCFC state machine, which now handles the FAA logic, IOC and BFA sub-modules enablement. Removed un-wanted FAA enable/disable routines; FAA is enabled by default.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfi.h | s | 26K | 1011 | Krishna Gudipati | kgudipat@brocade.com | 1311763284 |  | [SCSI] bfa: Add FC-transport based Asynchronous Event Notification support.  - Added support to post vendor unique events on fc_host. - Supports adapter, port, ioc, flash and remote port based AEN events.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfad_bsg.h | s | 13K | 666 | Krishna Gudipati | kgudipat@brocade.com | 1332924922 |  | [SCSI] bfa: Revised Fabric Assigned Address(FAA) feature implementation.  Made changes to the Fabric Assigned Address(FAA) feature implementation. Introduced the IOCFC state machine, which now handles the FAA logic, IOC and BFA sub-modules enablement. Removed un-wanted FAA enable/disable routines; FAA is enabled by default.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | bfa_ioc_ct.c | s | 25K | 788 | Krishna Gudipati | kgudipat@brocade.com | 1332924872 |  | [SCSI] bfa: Flash controller IOC pll init fixes.  Made changes to resume the flash controller if it is halted before going ahead with flash controller pause/resume logic. Made changes to avoid clearing off the interrupts during the initial pll initialization.  Signed-off-by: Krishna Gudipati <kgudipat@brocade.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
