<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › scsi › bfa › bfi_ms.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>bfi_ms.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright (c) 2005-2010 Brocade Communications Systems, Inc.</span>
<span class="cm"> * All rights reserved</span>
<span class="cm"> * www.brocade.com</span>
<span class="cm"> *</span>
<span class="cm"> * Linux driver for Brocade Fibre Channel Host Bus Adapter.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify it</span>
<span class="cm"> * under the terms of the GNU General Public License (GPL) Version 2 as</span>
<span class="cm"> * published by the Free Software Foundation</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful, but</span>
<span class="cm"> * WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<span class="cm"> * General Public License for more details.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef __BFI_MS_H__</span>
<span class="cp">#define __BFI_MS_H__</span>

<span class="cp">#include &quot;bfi.h&quot;</span>
<span class="cp">#include &quot;bfa_fc.h&quot;</span>
<span class="cp">#include &quot;bfa_defs_svc.h&quot;</span>

<span class="cp">#pragma pack(1)</span>

<span class="k">enum</span> <span class="n">bfi_iocfc_h2i_msgs</span> <span class="p">{</span>
	<span class="n">BFI_IOCFC_H2I_CFG_REQ</span>		<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">BFI_IOCFC_H2I_SET_INTR_REQ</span>	<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">BFI_IOCFC_H2I_UPDATEQ_REQ</span>	<span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">BFI_IOCFC_H2I_FAA_QUERY_REQ</span>	<span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">BFI_IOCFC_H2I_ADDR_REQ</span>		<span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">bfi_iocfc_i2h_msgs</span> <span class="p">{</span>
	<span class="n">BFI_IOCFC_I2H_CFG_REPLY</span>		<span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
	<span class="n">BFI_IOCFC_I2H_UPDATEQ_RSP</span>	<span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
	<span class="n">BFI_IOCFC_I2H_FAA_QUERY_RSP</span>	<span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
	<span class="n">BFI_IOCFC_I2H_ADDR_MSG</span>		<span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfi_iocfc_cfg_s</span> <span class="p">{</span>
	<span class="n">u8</span>	<span class="n">num_cqs</span><span class="p">;</span>	<span class="cm">/*  Number of CQs to be used	*/</span>
	<span class="n">u8</span>	 <span class="n">sense_buf_len</span><span class="p">;</span>	<span class="cm">/*  SCSI sense length	    */</span>
	<span class="n">u16</span>	<span class="n">rsvd_1</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">endian_sig</span><span class="p">;</span>	<span class="cm">/*  endian signature of host     */</span>
	<span class="n">u8</span>	<span class="n">rsvd_2</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">single_msix_vec</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">rsvd</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">__be16</span>	<span class="n">num_ioim_reqs</span><span class="p">;</span>
	<span class="n">__be16</span>	<span class="n">num_fwtio_reqs</span><span class="p">;</span>


	<span class="cm">/*</span>
<span class="cm">	 * Request and response circular queue base addresses, size and</span>
<span class="cm">	 * shadow index pointers.</span>
<span class="cm">	 */</span>
	<span class="k">union</span> <span class="n">bfi_addr_u</span>  <span class="n">req_cq_ba</span><span class="p">[</span><span class="n">BFI_IOC_MAX_CQS</span><span class="p">];</span>
	<span class="k">union</span> <span class="n">bfi_addr_u</span>  <span class="n">req_shadow_ci</span><span class="p">[</span><span class="n">BFI_IOC_MAX_CQS</span><span class="p">];</span>
	<span class="n">__be16</span>    <span class="n">req_cq_elems</span><span class="p">[</span><span class="n">BFI_IOC_MAX_CQS</span><span class="p">];</span>
	<span class="k">union</span> <span class="n">bfi_addr_u</span>  <span class="n">rsp_cq_ba</span><span class="p">[</span><span class="n">BFI_IOC_MAX_CQS</span><span class="p">];</span>
	<span class="k">union</span> <span class="n">bfi_addr_u</span>  <span class="n">rsp_shadow_pi</span><span class="p">[</span><span class="n">BFI_IOC_MAX_CQS</span><span class="p">];</span>
	<span class="n">__be16</span>    <span class="n">rsp_cq_elems</span><span class="p">[</span><span class="n">BFI_IOC_MAX_CQS</span><span class="p">];</span>

	<span class="k">union</span> <span class="n">bfi_addr_u</span>  <span class="n">stats_addr</span><span class="p">;</span>	<span class="cm">/*  DMA-able address for stats	  */</span>
	<span class="k">union</span> <span class="n">bfi_addr_u</span>  <span class="n">cfgrsp_addr</span><span class="p">;</span>	<span class="cm">/*  config response dma address  */</span>
	<span class="k">union</span> <span class="n">bfi_addr_u</span>  <span class="n">ioim_snsbase</span><span class="p">[</span><span class="n">BFI_IOIM_SNSBUF_SEGS</span><span class="p">];</span>
					<span class="cm">/*  IO sense buf base addr segments */</span>
	<span class="k">struct</span> <span class="n">bfa_iocfc_intr_attr_s</span> <span class="n">intr_attr</span><span class="p">;</span> <span class="cm">/*  IOC interrupt attributes */</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Boot target wwn information for this port. This contains either the stored</span>
<span class="cm"> * or discovered boot target port wwns for the port.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_iocfc_bootwwns</span> <span class="p">{</span>
	<span class="n">wwn_t</span>		<span class="n">wwn</span><span class="p">[</span><span class="n">BFA_BOOT_BOOTLUN_MAX</span><span class="p">];</span>
	<span class="n">u8</span>		<span class="n">nwwns</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">rsvd</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Queue configuration response from firmware</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_iocfc_qreg_s</span> <span class="p">{</span>
	<span class="n">u32</span>	<span class="n">cpe_q_ci_off</span><span class="p">[</span><span class="n">BFI_IOC_MAX_CQS</span><span class="p">];</span>
	<span class="n">u32</span>	<span class="n">cpe_q_pi_off</span><span class="p">[</span><span class="n">BFI_IOC_MAX_CQS</span><span class="p">];</span>
	<span class="n">u32</span>	<span class="n">cpe_qctl_off</span><span class="p">[</span><span class="n">BFI_IOC_MAX_CQS</span><span class="p">];</span>
	<span class="n">u32</span>	<span class="n">rme_q_ci_off</span><span class="p">[</span><span class="n">BFI_IOC_MAX_CQS</span><span class="p">];</span>
	<span class="n">u32</span>	<span class="n">rme_q_pi_off</span><span class="p">[</span><span class="n">BFI_IOC_MAX_CQS</span><span class="p">];</span>
	<span class="n">u32</span>	<span class="n">rme_qctl_off</span><span class="p">[</span><span class="n">BFI_IOC_MAX_CQS</span><span class="p">];</span>
	<span class="n">u8</span>	<span class="n">hw_qid</span><span class="p">[</span><span class="n">BFI_IOC_MAX_CQS</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfi_iocfc_cfgrsp_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfa_iocfc_fwcfg_s</span>	<span class="n">fwcfg</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_iocfc_intr_attr_s</span>	<span class="n">intr_attr</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_iocfc_bootwwns</span>	<span class="n">bootwwns</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_pbc_s</span>		<span class="n">pbc_cfg</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_iocfc_qreg_s</span>		<span class="n">qreg</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * BFI_IOCFC_H2I_CFG_REQ message</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_iocfc_cfg_req_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>      <span class="n">mh</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">bfi_addr_u</span>      <span class="n">ioc_cfg_dma_addr</span><span class="p">;</span>
<span class="p">};</span>


<span class="cm">/*</span>
<span class="cm"> * BFI_IOCFC_I2H_CFG_REPLY message</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_iocfc_cfg_reply_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  Common msg header	  */</span>
	<span class="n">u8</span>	 <span class="n">cfg_success</span><span class="p">;</span>	<span class="cm">/*  cfg reply status	   */</span>
	<span class="n">u8</span>	 <span class="n">lpu_bm</span><span class="p">;</span>		<span class="cm">/*  LPUs assigned for this IOC */</span>
	<span class="n">u8</span>	 <span class="n">rsvd</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="p">};</span>


<span class="cm">/*</span>
<span class="cm"> * BFI_IOCFC_H2I_SET_INTR_REQ message</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_iocfc_set_intr_req_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span> <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  common msg header		*/</span>
	<span class="n">u8</span>		<span class="n">coalesce</span><span class="p">;</span>	<span class="cm">/*  enable intr coalescing	*/</span>
	<span class="n">u8</span>		<span class="n">rsvd</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">__be16</span>	<span class="n">delay</span><span class="p">;</span>		<span class="cm">/*  delay timer 0..1125us	*/</span>
	<span class="n">__be16</span>	<span class="n">latency</span><span class="p">;</span>	<span class="cm">/*  latency timer 0..225us	*/</span>
<span class="p">};</span>


<span class="cm">/*</span>
<span class="cm"> * BFI_IOCFC_H2I_UPDATEQ_REQ message</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_iocfc_updateq_req_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span> <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  common msg header		*/</span>
	<span class="n">u32</span> <span class="n">reqq_ba</span><span class="p">;</span>		<span class="cm">/*  reqq base addr		*/</span>
	<span class="n">u32</span> <span class="n">rspq_ba</span><span class="p">;</span>		<span class="cm">/*  rspq base addr		*/</span>
	<span class="n">u32</span> <span class="n">reqq_sci</span><span class="p">;</span>		<span class="cm">/*  reqq shadow ci		*/</span>
	<span class="n">u32</span> <span class="n">rspq_spi</span><span class="p">;</span>		<span class="cm">/*  rspq shadow pi		*/</span>
<span class="p">};</span>


<span class="cm">/*</span>
<span class="cm"> * BFI_IOCFC_I2H_UPDATEQ_RSP message</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_iocfc_updateq_rsp_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span> <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  common msg header	*/</span>
	<span class="n">u8</span>	<span class="n">status</span><span class="p">;</span>			<span class="cm">/*  updateq  status	*/</span>
	<span class="n">u8</span>	<span class="n">rsvd</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="p">};</span>


<span class="cm">/*</span>
<span class="cm"> * H2I Messages</span>
<span class="cm"> */</span>
<span class="k">union</span> <span class="n">bfi_iocfc_h2i_msg_u</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>		<span class="n">mh</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_iocfc_cfg_req_s</span>	<span class="n">cfg_req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_iocfc_updateq_req_s</span> <span class="n">updateq_req</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">mboxmsg</span><span class="p">[</span><span class="n">BFI_IOC_MSGSZ</span><span class="p">];</span>
<span class="p">};</span>


<span class="cm">/*</span>
<span class="cm"> * I2H Messages</span>
<span class="cm"> */</span>
<span class="k">union</span> <span class="n">bfi_iocfc_i2h_msg_u</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>		<span class="n">mh</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_iocfc_cfg_reply_s</span>	<span class="n">cfg_reply</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_iocfc_updateq_rsp_s</span> <span class="n">updateq_rsp</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">mboxmsg</span><span class="p">[</span><span class="n">BFI_IOC_MSGSZ</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * BFI_IOCFC_H2I_FAA_ENABLE_REQ BFI_IOCFC_H2I_FAA_DISABLE_REQ message</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_faa_en_dis_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span> <span class="n">mh</span><span class="p">;</span>	<span class="cm">/* common msg header    */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfi_faa_addr_msg_s</span> <span class="p">{</span>
	<span class="k">struct</span>  <span class="n">bfi_mhdr_s</span> <span class="n">mh</span><span class="p">;</span>	<span class="cm">/* common msg header	*/</span>
	<span class="n">u8</span>	<span class="n">rsvd</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">wwn_t</span>	<span class="n">pwwn</span><span class="p">;</span>		<span class="cm">/* Fabric acquired PWWN	*/</span>
	<span class="n">wwn_t</span>	<span class="n">nwwn</span><span class="p">;</span>		<span class="cm">/* Fabric acquired PWWN	*/</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * BFI_IOCFC_H2I_FAA_QUERY_REQ message</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_faa_query_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span> <span class="n">mh</span><span class="p">;</span>	<span class="cm">/* common msg header    */</span>
	<span class="n">u8</span>	<span class="n">faa_status</span><span class="p">;</span>	<span class="cm">/* FAA status           */</span>
	<span class="n">u8</span>	<span class="n">addr_source</span><span class="p">;</span>	<span class="cm">/* PWWN source          */</span>
	<span class="n">u8</span>	<span class="n">rsvd</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">wwn_t</span>	<span class="n">faa</span><span class="p">;</span>		<span class="cm">/* Fabric acquired PWWN	*/</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * BFI_IOCFC_I2H_FAA_ENABLE_RSP, BFI_IOCFC_I2H_FAA_DISABLE_RSP message</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_faa_en_dis_rsp_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span> <span class="n">mh</span><span class="p">;</span>	<span class="cm">/* common msg header    */</span>
	<span class="n">u8</span>	<span class="n">status</span><span class="p">;</span>		<span class="cm">/* updateq  status      */</span>
	<span class="n">u8</span>	<span class="n">rsvd</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * BFI_IOCFC_I2H_FAA_QUERY_RSP message</span>
<span class="cm"> */</span>
<span class="cp">#define bfi_faa_query_rsp_t struct bfi_faa_query_s</span>

<span class="k">enum</span> <span class="n">bfi_fcport_h2i</span> <span class="p">{</span>
	<span class="n">BFI_FCPORT_H2I_ENABLE_REQ</span>		<span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">),</span>
	<span class="n">BFI_FCPORT_H2I_DISABLE_REQ</span>		<span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">),</span>
	<span class="n">BFI_FCPORT_H2I_SET_SVC_PARAMS_REQ</span>	<span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">),</span>
	<span class="n">BFI_FCPORT_H2I_STATS_GET_REQ</span>		<span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">),</span>
	<span class="n">BFI_FCPORT_H2I_STATS_CLEAR_REQ</span>		<span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">),</span>
<span class="p">};</span>


<span class="k">enum</span> <span class="n">bfi_fcport_i2h</span> <span class="p">{</span>
	<span class="n">BFI_FCPORT_I2H_ENABLE_RSP</span>		<span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
	<span class="n">BFI_FCPORT_I2H_DISABLE_RSP</span>		<span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
	<span class="n">BFI_FCPORT_I2H_SET_SVC_PARAMS_RSP</span>	<span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
	<span class="n">BFI_FCPORT_I2H_STATS_GET_RSP</span>		<span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
	<span class="n">BFI_FCPORT_I2H_STATS_CLEAR_RSP</span>		<span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
	<span class="n">BFI_FCPORT_I2H_EVENT</span>			<span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span>
	<span class="n">BFI_FCPORT_I2H_TRUNK_SCN</span>		<span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span>
	<span class="n">BFI_FCPORT_I2H_ENABLE_AEN</span>		<span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span>
	<span class="n">BFI_FCPORT_I2H_DISABLE_AEN</span>		<span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span>
<span class="p">};</span>


<span class="cm">/*</span>
<span class="cm"> * Generic REQ type</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_fcport_req_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  msg header			    */</span>
	<span class="n">u32</span>	   <span class="n">msgtag</span><span class="p">;</span>	<span class="cm">/*  msgtag for reply		    */</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Generic RSP type</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_fcport_rsp_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  common msg header		    */</span>
	<span class="n">u8</span>		   <span class="n">status</span><span class="p">;</span>	<span class="cm">/*  port enable status		    */</span>
	<span class="n">u8</span>		   <span class="n">rsvd</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="k">struct</span>	<span class="n">bfa_port_cfg_s</span> <span class="n">port_cfg</span><span class="p">;</span><span class="cm">/* port configuration	*/</span>
	<span class="n">u32</span>	<span class="n">msgtag</span><span class="p">;</span>			<span class="cm">/* msgtag for reply	*/</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * BFI_FCPORT_H2I_ENABLE_REQ</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_fcport_enable_req_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  msg header			    */</span>
	<span class="n">u32</span>	   <span class="n">rsvd1</span><span class="p">;</span>
	<span class="n">wwn_t</span>		   <span class="n">nwwn</span><span class="p">;</span>	<span class="cm">/*  node wwn of physical port	    */</span>
	<span class="n">wwn_t</span>		   <span class="n">pwwn</span><span class="p">;</span>	<span class="cm">/*  port wwn of physical port	    */</span>
	<span class="k">struct</span> <span class="n">bfa_port_cfg_s</span> <span class="n">port_cfg</span><span class="p">;</span> <span class="cm">/*  port configuration	    */</span>
	<span class="k">union</span> <span class="n">bfi_addr_u</span>   <span class="n">stats_dma_addr</span><span class="p">;</span> <span class="cm">/*  DMA address for stats	    */</span>
	<span class="n">u32</span>	   <span class="n">msgtag</span><span class="p">;</span>	<span class="cm">/*  msgtag for reply		    */</span>
	<span class="n">u8</span>	<span class="n">use_flash_cfg</span><span class="p">;</span>	<span class="cm">/* get prot cfg from flash */</span>
	<span class="n">u8</span>	<span class="n">rsvd2</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * BFI_FCPORT_H2I_SET_SVC_PARAMS_REQ</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_fcport_set_svc_params_req_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  msg header */</span>
	<span class="n">__be16</span>	   <span class="n">tx_bbcredit</span><span class="p">;</span>	<span class="cm">/*  Tx credits */</span>
	<span class="n">u8</span>	<span class="n">bb_scn</span><span class="p">;</span>		<span class="cm">/* BB_SC FC credit recovery */</span>
	<span class="n">u8</span>	<span class="n">rsvd</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * BFI_FCPORT_I2H_EVENT</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_fcport_event_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>	<span class="n">mh</span><span class="p">;</span>	<span class="cm">/*  common msg header */</span>
	<span class="k">struct</span> <span class="n">bfa_port_link_s</span>	<span class="n">link_state</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * BFI_FCPORT_I2H_TRUNK_SCN</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_fcport_trunk_link_s</span> <span class="p">{</span>
	<span class="n">wwn_t</span>			<span class="n">trunk_wwn</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">fctl</span><span class="p">;</span>		<span class="cm">/* bfa_trunk_link_fctl_t */</span>
	<span class="n">u8</span>			<span class="n">state</span><span class="p">;</span>		<span class="cm">/* bfa_trunk_link_state_t */</span>
	<span class="n">u8</span>			<span class="n">speed</span><span class="p">;</span>		<span class="cm">/* bfa_port_speed_t */</span>
	<span class="n">u8</span>			<span class="n">rsvd</span><span class="p">;</span>
	<span class="n">__be32</span>		<span class="n">deskew</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define BFI_FCPORT_MAX_LINKS	2</span>
<span class="k">struct</span> <span class="n">bfi_fcport_trunk_scn_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>	<span class="n">mh</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">trunk_state</span><span class="p">;</span>	<span class="cm">/* bfa_trunk_state_t */</span>
	<span class="n">u8</span>			<span class="n">trunk_speed</span><span class="p">;</span>	<span class="cm">/* bfa_port_speed_t */</span>
	<span class="n">u8</span>			<span class="n">rsvd_a</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">bfi_fcport_trunk_link_s</span> <span class="n">tlink</span><span class="p">[</span><span class="n">BFI_FCPORT_MAX_LINKS</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * fcport H2I message</span>
<span class="cm"> */</span>
<span class="k">union</span> <span class="n">bfi_fcport_h2i_msg_u</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>			<span class="o">*</span><span class="n">mhdr</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_fcport_enable_req_s</span>		<span class="o">*</span><span class="n">penable</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_fcport_req_s</span>			<span class="o">*</span><span class="n">pdisable</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_fcport_set_svc_params_req_s</span>	<span class="o">*</span><span class="n">psetsvcparams</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_fcport_req_s</span>			<span class="o">*</span><span class="n">pstatsget</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_fcport_req_s</span>			<span class="o">*</span><span class="n">pstatsclear</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * fcport I2H message</span>
<span class="cm"> */</span>
<span class="k">union</span> <span class="n">bfi_fcport_i2h_msg_u</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_msg_s</span>			<span class="o">*</span><span class="n">msg</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_fcport_rsp_s</span>			<span class="o">*</span><span class="n">penable_rsp</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_fcport_rsp_s</span>			<span class="o">*</span><span class="n">pdisable_rsp</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_fcport_rsp_s</span>			<span class="o">*</span><span class="n">psetsvcparams_rsp</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_fcport_rsp_s</span>			<span class="o">*</span><span class="n">pstatsget_rsp</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_fcport_rsp_s</span>			<span class="o">*</span><span class="n">pstatsclear_rsp</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_fcport_event_s</span>		<span class="o">*</span><span class="n">event</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_fcport_trunk_scn_s</span>		<span class="o">*</span><span class="n">trunk_scn</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">bfi_fcxp_h2i</span> <span class="p">{</span>
	<span class="n">BFI_FCXP_H2I_SEND_REQ</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">bfi_fcxp_i2h</span> <span class="p">{</span>
	<span class="n">BFI_FCXP_I2H_SEND_RSP</span> <span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
<span class="p">};</span>

<span class="cp">#define BFA_FCXP_MAX_SGES	2</span>

<span class="cm">/*</span>
<span class="cm"> * FCXP send request structure</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_fcxp_send_req_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  Common msg header		    */</span>
	<span class="n">__be16</span>	<span class="n">fcxp_tag</span><span class="p">;</span>	<span class="cm">/*  driver request tag		    */</span>
	<span class="n">__be16</span>	<span class="n">max_frmsz</span><span class="p">;</span>	<span class="cm">/*  max send frame size	    */</span>
	<span class="n">__be16</span>	<span class="n">vf_id</span><span class="p">;</span>		<span class="cm">/*  vsan tag if applicable	    */</span>
	<span class="n">u16</span>	<span class="n">rport_fw_hndl</span><span class="p">;</span>	<span class="cm">/*  FW Handle for the remote port  */</span>
	<span class="n">u8</span>	 <span class="n">class</span><span class="p">;</span>		<span class="cm">/*  FC class used for req/rsp	    */</span>
	<span class="n">u8</span>	 <span class="n">rsp_timeout</span><span class="p">;</span>	<span class="cm">/*  timeout in secs, 0-no response */</span>
	<span class="n">u8</span>	 <span class="n">cts</span><span class="p">;</span>		<span class="cm">/*  continue sequence		    */</span>
	<span class="n">u8</span>	 <span class="n">lp_fwtag</span><span class="p">;</span>	<span class="cm">/*  lport tag			    */</span>
	<span class="k">struct</span> <span class="n">fchs_s</span>	<span class="n">fchs</span><span class="p">;</span>	<span class="cm">/*  request FC header structure    */</span>
	<span class="n">__be32</span>	<span class="n">req_len</span><span class="p">;</span>	<span class="cm">/*  request payload length	    */</span>
	<span class="n">__be32</span>	<span class="n">rsp_maxlen</span><span class="p">;</span>	<span class="cm">/*  max response length expected   */</span>
	<span class="k">struct</span> <span class="n">bfi_alen_s</span> <span class="n">req_alen</span><span class="p">;</span>	<span class="cm">/* request buffer	*/</span>
	<span class="k">struct</span> <span class="n">bfi_alen_s</span> <span class="n">rsp_alen</span><span class="p">;</span>	<span class="cm">/* response buffer	*/</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * FCXP send response structure</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_fcxp_send_rsp_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  Common msg header		    */</span>
	<span class="n">__be16</span>	<span class="n">fcxp_tag</span><span class="p">;</span>	<span class="cm">/*  send request tag		    */</span>
	<span class="n">u8</span>	 <span class="n">req_status</span><span class="p">;</span>	<span class="cm">/*  request status		    */</span>
	<span class="n">u8</span>	 <span class="n">rsvd</span><span class="p">;</span>
	<span class="n">__be32</span>	<span class="n">rsp_len</span><span class="p">;</span>	<span class="cm">/*  actual response length	    */</span>
	<span class="n">__be32</span>	<span class="n">residue_len</span><span class="p">;</span>	<span class="cm">/*  residual response length	    */</span>
	<span class="k">struct</span> <span class="n">fchs_s</span>	<span class="n">fchs</span><span class="p">;</span>	<span class="cm">/*  response FC header structure   */</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">bfi_uf_h2i</span> <span class="p">{</span>
	<span class="n">BFI_UF_H2I_BUF_POST</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">bfi_uf_i2h</span> <span class="p">{</span>
	<span class="n">BFI_UF_I2H_FRM_RCVD</span> <span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
<span class="p">};</span>

<span class="cp">#define BFA_UF_MAX_SGES	2</span>

<span class="k">struct</span> <span class="n">bfi_uf_buf_post_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  Common msg header		*/</span>
	<span class="n">u16</span>	<span class="n">buf_tag</span><span class="p">;</span>	<span class="cm">/*  buffer tag			*/</span>
	<span class="n">__be16</span>	<span class="n">buf_len</span><span class="p">;</span>	<span class="cm">/*  total buffer length	*/</span>
	<span class="k">struct</span> <span class="n">bfi_alen_s</span> <span class="n">alen</span><span class="p">;</span>	<span class="cm">/* buffer address/len pair	*/</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfi_uf_frm_rcvd_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  Common msg header		*/</span>
	<span class="n">u16</span>	<span class="n">buf_tag</span><span class="p">;</span>	<span class="cm">/*  buffer tag			*/</span>
	<span class="n">u16</span>	<span class="n">rsvd</span><span class="p">;</span>
	<span class="n">u16</span>	<span class="n">frm_len</span><span class="p">;</span>	<span class="cm">/*  received frame length	*/</span>
	<span class="n">u16</span>	<span class="n">xfr_len</span><span class="p">;</span>	<span class="cm">/*  tranferred length		*/</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">bfi_lps_h2i_msgs</span> <span class="p">{</span>
	<span class="n">BFI_LPS_H2I_LOGIN_REQ</span>	<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">BFI_LPS_H2I_LOGOUT_REQ</span>	<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">BFI_LPS_H2I_N2N_PID_REQ</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">bfi_lps_i2h_msgs</span> <span class="p">{</span>
	<span class="n">BFI_LPS_I2H_LOGIN_RSP</span>	<span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
	<span class="n">BFI_LPS_I2H_LOGOUT_RSP</span>	<span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
	<span class="n">BFI_LPS_I2H_CVL_EVENT</span>	<span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfi_lps_login_req_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  common msg header		*/</span>
	<span class="n">u8</span>		<span class="n">bfa_tag</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">alpa</span><span class="p">;</span>
	<span class="n">__be16</span>		<span class="n">pdu_size</span><span class="p">;</span>
	<span class="n">wwn_t</span>		<span class="n">pwwn</span><span class="p">;</span>
	<span class="n">wwn_t</span>		<span class="n">nwwn</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">fdisc</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">auth_en</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">lps_role</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">bb_scn</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfi_lps_login_rsp_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  common msg header		*/</span>
	<span class="n">u8</span>		<span class="n">fw_tag</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">status</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">lsrjt_rsn</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">lsrjt_expl</span><span class="p">;</span>
	<span class="n">wwn_t</span>		<span class="n">port_name</span><span class="p">;</span>
	<span class="n">wwn_t</span>		<span class="n">node_name</span><span class="p">;</span>
	<span class="n">__be16</span>		<span class="n">bb_credit</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">f_port</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">npiv_en</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">lp_pid</span><span class="o">:</span><span class="mi">24</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">auth_req</span><span class="o">:</span><span class="mi">8</span><span class="p">;</span>
	<span class="n">mac_t</span>		<span class="n">lp_mac</span><span class="p">;</span>
	<span class="n">mac_t</span>		<span class="n">fcf_mac</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">ext_status</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">brcd_switch</span><span class="p">;</span>	<span class="cm">/*  attached peer is brcd switch */</span>
	<span class="n">u8</span>		<span class="n">bb_scn</span><span class="p">;</span>		<span class="cm">/* atatched port&#39;s bb_scn */</span>
	<span class="n">u8</span>		<span class="n">bfa_tag</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfi_lps_logout_req_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  common msg header		*/</span>
	<span class="n">u8</span>		<span class="n">fw_tag</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">rsvd</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">wwn_t</span>		<span class="n">port_name</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfi_lps_logout_rsp_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  common msg header		*/</span>
	<span class="n">u8</span>		<span class="n">bfa_tag</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">status</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">rsvd</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfi_lps_cvl_event_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  common msg header		*/</span>
	<span class="n">u8</span>		<span class="n">bfa_tag</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">rsvd</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfi_lps_n2n_pid_req_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>	<span class="n">mh</span><span class="p">;</span>	<span class="cm">/*  common msg header		*/</span>
	<span class="n">u8</span>	<span class="n">fw_tag</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">lp_pid</span><span class="o">:</span><span class="mi">24</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">union</span> <span class="n">bfi_lps_h2i_msg_u</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>		<span class="o">*</span><span class="n">msg</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_lps_login_req_s</span>	<span class="o">*</span><span class="n">login_req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_lps_logout_req_s</span>	<span class="o">*</span><span class="n">logout_req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_lps_n2n_pid_req_s</span>	<span class="o">*</span><span class="n">n2n_pid_req</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">union</span> <span class="n">bfi_lps_i2h_msg_u</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_msg_s</span>		<span class="o">*</span><span class="n">msg</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_lps_login_rsp_s</span>	<span class="o">*</span><span class="n">login_rsp</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_lps_logout_rsp_s</span>	<span class="o">*</span><span class="n">logout_rsp</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_lps_cvl_event_s</span>	<span class="o">*</span><span class="n">cvl_event</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">bfi_rport_h2i_msgs</span> <span class="p">{</span>
	<span class="n">BFI_RPORT_H2I_CREATE_REQ</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">BFI_RPORT_H2I_DELETE_REQ</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">BFI_RPORT_H2I_SET_SPEED_REQ</span>  <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">bfi_rport_i2h_msgs</span> <span class="p">{</span>
	<span class="n">BFI_RPORT_I2H_CREATE_RSP</span> <span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
	<span class="n">BFI_RPORT_I2H_DELETE_RSP</span> <span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
	<span class="n">BFI_RPORT_I2H_QOS_SCN</span>    <span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfi_rport_create_req_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  common msg header		*/</span>
	<span class="n">u16</span>	<span class="n">bfa_handle</span><span class="p">;</span>	<span class="cm">/*  host rport handle		*/</span>
	<span class="n">__be16</span>	<span class="n">max_frmsz</span><span class="p">;</span>	<span class="cm">/*  max rcv pdu size		*/</span>
	<span class="n">u32</span>	<span class="n">pid</span><span class="o">:</span><span class="mi">24</span><span class="p">,</span>	<span class="cm">/*  remote port ID		*/</span>
		<span class="nl">lp_fwtag:</span><span class="mi">8</span><span class="p">;</span>	<span class="cm">/*  local port tag		*/</span>
	<span class="n">u32</span>	<span class="n">local_pid</span><span class="o">:</span><span class="mi">24</span><span class="p">,</span>	<span class="cm">/*  local port ID		*/</span>
		<span class="nl">cisc:</span><span class="mi">8</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">fc_class</span><span class="p">;</span>	<span class="cm">/*  supported FC classes	*/</span>
	<span class="n">u8</span>	<span class="n">vf_en</span><span class="p">;</span>		<span class="cm">/*  virtual fabric enable	*/</span>
	<span class="n">u16</span>	<span class="n">vf_id</span><span class="p">;</span>		<span class="cm">/*  virtual fabric ID		*/</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfi_rport_create_rsp_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  common msg header		*/</span>
	<span class="n">u8</span>		<span class="n">status</span><span class="p">;</span>		<span class="cm">/*  rport creation status	*/</span>
	<span class="n">u8</span>		<span class="n">rsvd</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u16</span>	<span class="n">bfa_handle</span><span class="p">;</span>	<span class="cm">/*  host rport handle		*/</span>
	<span class="n">u16</span>	<span class="n">fw_handle</span><span class="p">;</span>	<span class="cm">/*  firmware rport handle	*/</span>
	<span class="k">struct</span> <span class="n">bfa_rport_qos_attr_s</span> <span class="n">qos_attr</span><span class="p">;</span>  <span class="cm">/* QoS Attributes */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfa_rport_speed_req_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  common msg header		*/</span>
	<span class="n">u16</span>	<span class="n">fw_handle</span><span class="p">;</span>	<span class="cm">/*  firmware rport handle	*/</span>
	<span class="n">u8</span>		<span class="n">speed</span><span class="p">;</span>		<span class="cm">/*  rport&#39;s speed via RPSC	*/</span>
	<span class="n">u8</span>		<span class="n">rsvd</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfi_rport_delete_req_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  common msg header		*/</span>
	<span class="n">u16</span>	<span class="n">fw_handle</span><span class="p">;</span>	<span class="cm">/*  firmware rport handle	*/</span>
	<span class="n">u16</span>	<span class="n">rsvd</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfi_rport_delete_rsp_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  common msg header		*/</span>
	<span class="n">u16</span>	<span class="n">bfa_handle</span><span class="p">;</span>	<span class="cm">/*  host rport handle		*/</span>
	<span class="n">u8</span>		<span class="n">status</span><span class="p">;</span>		<span class="cm">/*  rport deletion status	*/</span>
	<span class="n">u8</span>		<span class="n">rsvd</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfi_rport_qos_scn_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  common msg header		*/</span>
	<span class="n">u16</span>	<span class="n">bfa_handle</span><span class="p">;</span>	<span class="cm">/*  host rport handle		*/</span>
	<span class="n">u16</span>	<span class="n">rsvd</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_rport_qos_attr_s</span> <span class="n">old_qos_attr</span><span class="p">;</span>  <span class="cm">/* Old QoS Attributes */</span>
	<span class="k">struct</span> <span class="n">bfa_rport_qos_attr_s</span> <span class="n">new_qos_attr</span><span class="p">;</span>  <span class="cm">/* New QoS Attributes */</span>
<span class="p">};</span>

<span class="k">union</span> <span class="n">bfi_rport_h2i_msg_u</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_msg_s</span>		<span class="o">*</span><span class="n">msg</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_rport_create_req_s</span>	<span class="o">*</span><span class="n">create_req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_rport_delete_req_s</span>	<span class="o">*</span><span class="n">delete_req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_rport_speed_req_s</span>	<span class="o">*</span><span class="n">speed_req</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">union</span> <span class="n">bfi_rport_i2h_msg_u</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_msg_s</span>		<span class="o">*</span><span class="n">msg</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_rport_create_rsp_s</span>	<span class="o">*</span><span class="n">create_rsp</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_rport_delete_rsp_s</span>	<span class="o">*</span><span class="n">delete_rsp</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_rport_qos_scn_s</span>	<span class="o">*</span><span class="n">qos_scn_evt</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Initiator mode I-T nexus interface defines.</span>
<span class="cm"> */</span>

<span class="k">enum</span> <span class="n">bfi_itn_h2i</span> <span class="p">{</span>
	<span class="n">BFI_ITN_H2I_CREATE_REQ</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>	<span class="cm">/*  i-t nexus creation */</span>
	<span class="n">BFI_ITN_H2I_DELETE_REQ</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>	<span class="cm">/*  i-t nexus deletion */</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">bfi_itn_i2h</span> <span class="p">{</span>
	<span class="n">BFI_ITN_I2H_CREATE_RSP</span> <span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
	<span class="n">BFI_ITN_I2H_DELETE_RSP</span> <span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
	<span class="n">BFI_ITN_I2H_SLER_EVENT</span> <span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfi_itn_create_req_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  common msg header		 */</span>
	<span class="n">u16</span>	<span class="n">fw_handle</span><span class="p">;</span>	<span class="cm">/*  f/w handle for itnim	 */</span>
	<span class="n">u8</span>	<span class="n">class</span><span class="p">;</span>		<span class="cm">/*  FC class for IO		 */</span>
	<span class="n">u8</span>	<span class="n">seq_rec</span><span class="p">;</span>	<span class="cm">/*  sequence recovery support	 */</span>
	<span class="n">u8</span>	<span class="n">msg_no</span><span class="p">;</span>		<span class="cm">/*  seq id of the msg		 */</span>
	<span class="n">u8</span>	<span class="n">role</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfi_itn_create_rsp_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  common msg header		 */</span>
	<span class="n">u16</span>	<span class="n">bfa_handle</span><span class="p">;</span>	<span class="cm">/*  bfa handle for itnim	 */</span>
	<span class="n">u8</span>	<span class="n">status</span><span class="p">;</span>		<span class="cm">/*  fcp request status		 */</span>
	<span class="n">u8</span>	<span class="n">seq_id</span><span class="p">;</span>		<span class="cm">/*  seq id of the msg		 */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfi_itn_delete_req_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  common msg header		 */</span>
	<span class="n">u16</span>	<span class="n">fw_handle</span><span class="p">;</span>	<span class="cm">/*  f/w itnim handle		 */</span>
	<span class="n">u8</span>	<span class="n">seq_id</span><span class="p">;</span>		<span class="cm">/*  seq id of the msg		 */</span>
	<span class="n">u8</span>	<span class="n">rsvd</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfi_itn_delete_rsp_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  common msg header		 */</span>
	<span class="n">u16</span>	<span class="n">bfa_handle</span><span class="p">;</span>	<span class="cm">/*  bfa handle for itnim	 */</span>
	<span class="n">u8</span>	<span class="n">status</span><span class="p">;</span>		<span class="cm">/*  fcp request status		 */</span>
	<span class="n">u8</span>	<span class="n">seq_id</span><span class="p">;</span>		<span class="cm">/*  seq id of the msg		 */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfi_itn_sler_event_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  common msg header		 */</span>
	<span class="n">u16</span>	<span class="n">bfa_handle</span><span class="p">;</span>	<span class="cm">/*  bfa handle for itnim	 */</span>
	<span class="n">u16</span>	<span class="n">rsvd</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">union</span> <span class="n">bfi_itn_h2i_msg_u</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_itn_create_req_s</span> <span class="o">*</span><span class="n">create_req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_itn_delete_req_s</span> <span class="o">*</span><span class="n">delete_req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_msg_s</span>	<span class="o">*</span><span class="n">msg</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">union</span> <span class="n">bfi_itn_i2h_msg_u</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_itn_create_rsp_s</span> <span class="o">*</span><span class="n">create_rsp</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_itn_delete_rsp_s</span> <span class="o">*</span><span class="n">delete_rsp</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_itn_sler_event_s</span> <span class="o">*</span><span class="n">sler_event</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_msg_s</span>	<span class="o">*</span><span class="n">msg</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Initiator mode IO interface defines.</span>
<span class="cm"> */</span>

<span class="k">enum</span> <span class="n">bfi_ioim_h2i</span> <span class="p">{</span>
	<span class="n">BFI_IOIM_H2I_IOABORT_REQ</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>	<span class="cm">/*  IO abort request	 */</span>
	<span class="n">BFI_IOIM_H2I_IOCLEANUP_REQ</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>	<span class="cm">/*  IO cleanup request	 */</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">bfi_ioim_i2h</span> <span class="p">{</span>
	<span class="n">BFI_IOIM_I2H_IO_RSP</span> <span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>	<span class="cm">/*  non-fp IO response	 */</span>
	<span class="n">BFI_IOIM_I2H_IOABORT_RSP</span> <span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>	<span class="cm">/*  ABORT rsp	 */</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * IO command DIF info</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_ioim_dif_s</span> <span class="p">{</span>
	<span class="n">u32</span>	<span class="n">dif_info</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * FCP IO messages overview</span>
<span class="cm"> *</span>
<span class="cm"> * @note</span>
<span class="cm"> * - Max CDB length supported is 64 bytes.</span>
<span class="cm"> * - SCSI Linked commands and SCSI bi-directional Commands not</span>
<span class="cm"> *	supported.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_ioim_req_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  Common msg header		 */</span>
	<span class="n">__be16</span>	<span class="n">io_tag</span><span class="p">;</span>		<span class="cm">/*  I/O tag			 */</span>
	<span class="n">u16</span>	<span class="n">rport_hdl</span><span class="p">;</span>	<span class="cm">/*  itnim/rport firmware handle */</span>
	<span class="k">struct</span> <span class="n">fcp_cmnd_s</span>	<span class="n">cmnd</span><span class="p">;</span>	<span class="cm">/*  IO request info	*/</span>

	<span class="cm">/*</span>
<span class="cm">	 * SG elements array within the IO request must be double word</span>
<span class="cm">	 * aligned. This aligment is required to optimize SGM setup for the IO.</span>
<span class="cm">	 */</span>
	<span class="k">struct</span> <span class="n">bfi_sge_s</span>	<span class="n">sges</span><span class="p">[</span><span class="n">BFI_SGE_INLINE_MAX</span><span class="p">];</span>
	<span class="n">u8</span>	<span class="n">io_timeout</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">dif_en</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">rsvd_a</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">bfi_ioim_dif_s</span>  <span class="n">dif</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> *	This table shows various IO status codes from firmware and their</span>
<span class="cm"> *	meaning. Host driver can use these status codes to further process</span>
<span class="cm"> *	IO completions.</span>
<span class="cm"> *</span>
<span class="cm"> *	BFI_IOIM_STS_OK		: IO completed with error free SCSI &amp;</span>
<span class="cm"> *					transport status.</span>
<span class="cm"> *					 io-tag can be reused.</span>
<span class="cm"> *</span>
<span class="cm"> *	BFA_IOIM_STS_SCSI_ERR		: IO completed with scsi error.</span>
<span class="cm"> *	- io-tag can be reused.</span>
<span class="cm"> *</span>
<span class="cm"> *	BFI_IOIM_STS_HOST_ABORTED	: IO was aborted successfully due to</span>
<span class="cm"> *						host request.</span>
<span class="cm"> *					- io-tag cannot be reused yet.</span>
<span class="cm"> *</span>
<span class="cm"> *	BFI_IOIM_STS_ABORTED		: IO was aborted successfully</span>
<span class="cm"> *						internally by f/w.</span>
<span class="cm"> *					- io-tag cannot be reused yet.</span>
<span class="cm"> *</span>
<span class="cm"> *	BFI_IOIM_STS_TIMEDOUT	: IO timedout and ABTS/RRQ is happening</span>
<span class="cm"> *					in the firmware and</span>
<span class="cm"> *					- io-tag cannot be reused yet.</span>
<span class="cm"> *</span>
<span class="cm"> *	BFI_IOIM_STS_SQER_NEEDED	: Firmware could not recover the IO</span>
<span class="cm"> *					  with sequence level error</span>
<span class="cm"> *	logic and hence host needs to retry</span>
<span class="cm"> *					  this IO with a different IO tag</span>
<span class="cm"> *					- io-tag cannot be used yet.</span>
<span class="cm"> *</span>
<span class="cm"> *	BFI_IOIM_STS_NEXUS_ABORT	: Second Level Error Recovery from host</span>
<span class="cm"> *					  is required because 2 consecutive ABTS</span>
<span class="cm"> *					  timedout and host needs logout and</span>
<span class="cm"> *					  re-login with the target</span>
<span class="cm"> *					- io-tag cannot be used yet.</span>
<span class="cm"> *</span>
<span class="cm"> *	BFI_IOIM_STS_UNDERRUN	: IO completed with SCSI status good,</span>
<span class="cm"> *					  but the data tranferred is less than</span>
<span class="cm"> *					  the fcp data length in the command.</span>
<span class="cm"> *					  ex. SCSI INQUIRY where transferred</span>
<span class="cm"> *					  data length and residue count in FCP</span>
<span class="cm"> *					  response accounts for total fcp-dl</span>
<span class="cm"> *					  - io-tag can be reused.</span>
<span class="cm"> *</span>
<span class="cm"> *	BFI_IOIM_STS_OVERRUN	: IO completed with SCSI status good,</span>
<span class="cm"> *					  but the data transerred is more than</span>
<span class="cm"> *					  fcp data length in the command. ex.</span>
<span class="cm"> *					  TAPE IOs where blocks can of unequal</span>
<span class="cm"> *					  lengths.</span>
<span class="cm"> *					- io-tag can be reused.</span>
<span class="cm"> *</span>
<span class="cm"> *	BFI_IOIM_STS_RES_FREE	: Firmware has completed using io-tag</span>
<span class="cm"> *					  during abort process</span>
<span class="cm"> *					- io-tag can be reused.</span>
<span class="cm"> *</span>
<span class="cm"> *	BFI_IOIM_STS_PROTO_ERR	: Firmware detected a protocol error.</span>
<span class="cm"> *					  ex target sent more data than</span>
<span class="cm"> *					  requested, or there was data frame</span>
<span class="cm"> *					  loss and other reasons</span>
<span class="cm"> *					- io-tag cannot be used yet.</span>
<span class="cm"> *</span>
<span class="cm"> *	BFI_IOIM_STS_DIF_ERR	: Firwmare detected DIF error. ex: DIF</span>
<span class="cm"> *					CRC err or Ref Tag err or App tag err.</span>
<span class="cm"> *					- io-tag can be reused.</span>
<span class="cm"> *</span>
<span class="cm"> *	BFA_IOIM_STS_TSK_MGT_ABORT	: IO was aborted because of Task</span>
<span class="cm"> *					  Management command from the host</span>
<span class="cm"> *					  - io-tag can be reused.</span>
<span class="cm"> *</span>
<span class="cm"> *	BFI_IOIM_STS_UTAG		: Firmware does not know about this</span>
<span class="cm"> *					  io_tag.</span>
<span class="cm"> *					- io-tag can be reused.</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">bfi_ioim_status</span> <span class="p">{</span>
	<span class="n">BFI_IOIM_STS_OK</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">BFI_IOIM_STS_HOST_ABORTED</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">BFI_IOIM_STS_ABORTED</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">BFI_IOIM_STS_TIMEDOUT</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">BFI_IOIM_STS_RES_FREE</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">BFI_IOIM_STS_SQER_NEEDED</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">BFI_IOIM_STS_PROTO_ERR</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">BFI_IOIM_STS_UTAG</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">BFI_IOIM_STS_PATHTOV</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * I/O response message</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_ioim_rsp_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>	<span class="n">mh</span><span class="p">;</span>	<span class="cm">/*  common msg header		*/</span>
	<span class="n">__be16</span>	<span class="n">io_tag</span><span class="p">;</span>		<span class="cm">/*  completed IO tag		 */</span>
	<span class="n">u16</span>	<span class="n">bfa_rport_hndl</span><span class="p">;</span>	<span class="cm">/*  releated rport handle	 */</span>
	<span class="n">u8</span>	<span class="n">io_status</span><span class="p">;</span>	<span class="cm">/*  IO completion status	 */</span>
	<span class="n">u8</span>	<span class="n">reuse_io_tag</span><span class="p">;</span>	<span class="cm">/*  IO tag can be reused	*/</span>
	<span class="n">u16</span>	<span class="n">abort_tag</span><span class="p">;</span>	<span class="cm">/*  host abort request tag	*/</span>
	<span class="n">u8</span>		<span class="n">scsi_status</span><span class="p">;</span>	<span class="cm">/*  scsi status from target	 */</span>
	<span class="n">u8</span>		<span class="n">sns_len</span><span class="p">;</span>	<span class="cm">/*  scsi sense length		 */</span>
	<span class="n">u8</span>		<span class="n">resid_flags</span><span class="p">;</span>	<span class="cm">/*  IO residue flags		 */</span>
	<span class="n">u8</span>		<span class="n">rsvd_a</span><span class="p">;</span>
	<span class="n">__be32</span>	<span class="n">residue</span><span class="p">;</span>	<span class="cm">/*  IO residual length in bytes */</span>
	<span class="n">u32</span>	<span class="n">rsvd_b</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfi_ioim_abort_req_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>	<span class="cm">/*  Common msg header  */</span>
	<span class="n">__be16</span>	<span class="n">io_tag</span><span class="p">;</span>	<span class="cm">/*  I/O tag	*/</span>
	<span class="n">u16</span>	<span class="n">abort_tag</span><span class="p">;</span>	<span class="cm">/*  unique request tag */</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Initiator mode task management command interface defines.</span>
<span class="cm"> */</span>

<span class="k">enum</span> <span class="n">bfi_tskim_h2i</span> <span class="p">{</span>
	<span class="n">BFI_TSKIM_H2I_TM_REQ</span>	<span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="cm">/*  task-mgmt command	*/</span>
	<span class="n">BFI_TSKIM_H2I_ABORT_REQ</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="cm">/*  task-mgmt command	*/</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">bfi_tskim_i2h</span> <span class="p">{</span>
	<span class="n">BFI_TSKIM_I2H_TM_RSP</span> <span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfi_tskim_req_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>	<span class="cm">/*  Common msg header	*/</span>
	<span class="n">__be16</span>	<span class="n">tsk_tag</span><span class="p">;</span>	<span class="cm">/*  task management tag	*/</span>
	<span class="n">u16</span>	<span class="n">itn_fhdl</span><span class="p">;</span>	<span class="cm">/*  itn firmware handle	*/</span>
	<span class="k">struct</span> 	<span class="n">scsi_lun</span> <span class="n">lun</span><span class="p">;</span>	<span class="cm">/*  LU number	*/</span>
	<span class="n">u8</span>	<span class="n">tm_flags</span><span class="p">;</span>	<span class="cm">/*  see enum fcp_tm_cmnd	*/</span>
	<span class="n">u8</span>	<span class="n">t_secs</span><span class="p">;</span>	<span class="cm">/*  Timeout value in seconds	*/</span>
	<span class="n">u8</span>	<span class="n">rsvd</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfi_tskim_abortreq_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>	<span class="cm">/*  Common msg header	*/</span>
	<span class="n">__be16</span>	<span class="n">tsk_tag</span><span class="p">;</span>	<span class="cm">/*  task management tag	*/</span>
	<span class="n">u16</span>	<span class="n">rsvd</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">bfi_tskim_status</span> <span class="p">{</span>
	<span class="cm">/*</span>
<span class="cm">	 * Following are FCP-4 spec defined status codes,</span>
<span class="cm">	 * **DO NOT CHANGE THEM **</span>
<span class="cm">	 */</span>
	<span class="n">BFI_TSKIM_STS_OK</span>	<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">BFI_TSKIM_STS_NOT_SUPP</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">BFI_TSKIM_STS_FAILED</span>	<span class="o">=</span> <span class="mi">5</span><span class="p">,</span>

	<span class="cm">/*</span>
<span class="cm">	 * Defined by BFA</span>
<span class="cm">	 */</span>
	<span class="n">BFI_TSKIM_STS_TIMEOUT</span>  <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>	<span class="cm">/*  TM request timedout	*/</span>
	<span class="n">BFI_TSKIM_STS_ABORTED</span>  <span class="o">=</span> <span class="mi">11</span><span class="p">,</span>	<span class="cm">/*  Aborted on host request */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfi_tskim_rsp_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr_s</span>  <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*  Common msg header		 */</span>
	<span class="n">__be16</span>	<span class="n">tsk_tag</span><span class="p">;</span>	<span class="cm">/*  task mgmt cmnd tag		 */</span>
	<span class="n">u8</span>	<span class="n">tsk_status</span><span class="p">;</span>	<span class="cm">/*  @ref bfi_tskim_status */</span>
	<span class="n">u8</span>	<span class="n">rsvd</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#pragma pack()</span>

<span class="cm">/*</span>
<span class="cm"> * Crossbow PCI MSI-X vector defines</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">BFI_MSIX_CPE_QMIN_CB</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">BFI_MSIX_CPE_QMAX_CB</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">BFI_MSIX_RME_QMIN_CB</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">BFI_MSIX_RME_QMAX_CB</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
	<span class="n">BFI_MSIX_CB_MAX</span> <span class="o">=</span> <span class="mi">22</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Catapult FC PCI MSI-X vector defines</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">BFI_MSIX_LPU_ERR_CT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">BFI_MSIX_CPE_QMIN_CT</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">BFI_MSIX_CPE_QMAX_CT</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">BFI_MSIX_RME_QMIN_CT</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">BFI_MSIX_RME_QMAX_CT</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">BFI_MSIX_CT_MAX</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="cm">/* __BFI_MS_H__ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
