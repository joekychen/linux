<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › scsi › bfa › bfa_ioc.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>bfa_ioc.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright (c) 2005-2010 Brocade Communications Systems, Inc.</span>
<span class="cm"> * All rights reserved</span>
<span class="cm"> * www.brocade.com</span>
<span class="cm"> *</span>
<span class="cm"> * Linux driver for Brocade Fibre Channel Host Bus Adapter.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify it</span>
<span class="cm"> * under the terms of the GNU General Public License (GPL) Version 2 as</span>
<span class="cm"> * published by the Free Software Foundation</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful, but</span>
<span class="cm"> * WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<span class="cm"> * General Public License for more details.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef __BFA_IOC_H__</span>
<span class="cp">#define __BFA_IOC_H__</span>

<span class="cp">#include &quot;bfad_drv.h&quot;</span>
<span class="cp">#include &quot;bfa_cs.h&quot;</span>
<span class="cp">#include &quot;bfi.h&quot;</span>

<span class="cp">#define BFA_DBG_FWTRC_ENTS	(BFI_IOC_TRC_ENTS)</span>
<span class="cp">#define BFA_DBG_FWTRC_LEN					\</span>
<span class="cp">	(BFA_DBG_FWTRC_ENTS * sizeof(struct bfa_trc_s) +	\</span>
<span class="cp">	(sizeof(struct bfa_trc_mod_s) -				\</span>
<span class="cp">	BFA_TRC_MAX * sizeof(struct bfa_trc_s)))</span>
<span class="cm">/*</span>
<span class="cm"> * BFA timer declarations</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">bfa_timer_cbfn_t</span><span class="p">)(</span><span class="kt">void</span> <span class="o">*</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * BFA timer data structure</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfa_timer_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">list_head</span>	<span class="n">qe</span><span class="p">;</span>
	<span class="n">bfa_timer_cbfn_t</span> <span class="n">timercb</span><span class="p">;</span>
	<span class="kt">void</span>		<span class="o">*</span><span class="n">arg</span><span class="p">;</span>
	<span class="kt">int</span>		<span class="n">timeout</span><span class="p">;</span>	<span class="cm">/* in millisecs */</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Timer module structure</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfa_timer_mod_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">timer_q</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define BFA_TIMER_FREQ 200 </span><span class="cm">/* specified in millisecs */</span><span class="cp"></span>

<span class="kt">void</span> <span class="n">bfa_timer_beat</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_timer_mod_s</span> <span class="o">*</span><span class="n">mod</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_timer_begin</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_timer_mod_s</span> <span class="o">*</span><span class="n">mod</span><span class="p">,</span> <span class="k">struct</span> <span class="n">bfa_timer_s</span> <span class="o">*</span><span class="n">timer</span><span class="p">,</span>
			<span class="n">bfa_timer_cbfn_t</span> <span class="n">timercb</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">arg</span><span class="p">,</span>
			<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">timeout</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_timer_stop</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_timer_s</span> <span class="o">*</span><span class="n">timer</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Generic Scatter Gather Element used by driver</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfa_sge_s</span> <span class="p">{</span>
	<span class="n">u32</span>	<span class="n">sg_len</span><span class="p">;</span>
	<span class="kt">void</span>		<span class="o">*</span><span class="n">sg_addr</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define bfa_sge_word_swap(__sge) do {					     \</span>
<span class="cp">	((u32 *)(__sge))[0] = swab32(((u32 *)(__sge))[0]);      \</span>
<span class="cp">	((u32 *)(__sge))[1] = swab32(((u32 *)(__sge))[1]);      \</span>
<span class="cp">	((u32 *)(__sge))[2] = swab32(((u32 *)(__sge))[2]);      \</span>
<span class="cp">} while (0)</span>

<span class="cp">#define bfa_swap_words(_x)  (	\</span>
<span class="cp">	((_x) &lt;&lt; 32) | ((_x) &gt;&gt; 32))</span>

<span class="cp">#ifdef __BIG_ENDIAN</span>
<span class="cp">#define bfa_sge_to_be(_x)</span>
<span class="cp">#define bfa_sge_to_le(_x)	bfa_sge_word_swap(_x)</span>
<span class="cp">#define bfa_sgaddr_le(_x)	bfa_swap_words(_x)</span>
<span class="cp">#else</span>
<span class="cp">#define	bfa_sge_to_be(_x)	bfa_sge_word_swap(_x)</span>
<span class="cp">#define bfa_sge_to_le(_x)</span>
<span class="cp">#define bfa_sgaddr_le(_x)	(_x)</span>
<span class="cp">#endif</span>

<span class="cm">/*</span>
<span class="cm"> * BFA memory resources</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfa_mem_dma_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">qe</span><span class="p">;</span>		<span class="cm">/* Queue of DMA elements */</span>
	<span class="n">u32</span>		<span class="n">mem_len</span><span class="p">;</span>	<span class="cm">/* Total Length in Bytes */</span>
	<span class="n">u8</span>		<span class="o">*</span><span class="n">kva</span><span class="p">;</span>		<span class="cm">/* kernel virtual address */</span>
	<span class="n">u64</span>		<span class="n">dma</span><span class="p">;</span>		<span class="cm">/* dma address if DMA memory */</span>
	<span class="n">u8</span>		<span class="o">*</span><span class="n">kva_curp</span><span class="p">;</span>	<span class="cm">/* kva allocation cursor */</span>
	<span class="n">u64</span>		<span class="n">dma_curp</span><span class="p">;</span>	<span class="cm">/* dma allocation cursor */</span>
<span class="p">};</span>
<span class="cp">#define bfa_mem_dma_t struct bfa_mem_dma_s</span>

<span class="k">struct</span> <span class="n">bfa_mem_kva_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">qe</span><span class="p">;</span>		<span class="cm">/* Queue of KVA elements */</span>
	<span class="n">u32</span>		<span class="n">mem_len</span><span class="p">;</span>	<span class="cm">/* Total Length in Bytes */</span>
	<span class="n">u8</span>		<span class="o">*</span><span class="n">kva</span><span class="p">;</span>		<span class="cm">/* kernel virtual address */</span>
	<span class="n">u8</span>		<span class="o">*</span><span class="n">kva_curp</span><span class="p">;</span>	<span class="cm">/* kva allocation cursor */</span>
<span class="p">};</span>
<span class="cp">#define bfa_mem_kva_t struct bfa_mem_kva_s</span>

<span class="k">struct</span> <span class="n">bfa_meminfo_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfa_mem_dma_s</span> <span class="n">dma_info</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_mem_kva_s</span> <span class="n">kva_info</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* BFA memory segment setup macros */</span>
<span class="cp">#define bfa_mem_dma_setup(_meminfo, _dm_ptr, _seg_sz) do {	\</span>
<span class="cp">	((bfa_mem_dma_t *)(_dm_ptr))-&gt;mem_len = (_seg_sz);	\</span>
<span class="cp">	if (_seg_sz)						\</span>
<span class="cp">		list_add_tail(&amp;((bfa_mem_dma_t *)_dm_ptr)-&gt;qe,	\</span>
<span class="cp">			      &amp;(_meminfo)-&gt;dma_info.qe);	\</span>
<span class="cp">} while (0)</span>

<span class="cp">#define bfa_mem_kva_setup(_meminfo, _kva_ptr, _seg_sz) do {	\</span>
<span class="cp">	((bfa_mem_kva_t *)(_kva_ptr))-&gt;mem_len = (_seg_sz);	\</span>
<span class="cp">	if (_seg_sz)						\</span>
<span class="cp">		list_add_tail(&amp;((bfa_mem_kva_t *)_kva_ptr)-&gt;qe,	\</span>
<span class="cp">			      &amp;(_meminfo)-&gt;kva_info.qe);	\</span>
<span class="cp">} while (0)</span>

<span class="cm">/* BFA dma memory segments iterator */</span>
<span class="cp">#define bfa_mem_dma_sptr(_mod, _i)	(&amp;(_mod)-&gt;dma_seg[(_i)])</span>
<span class="cp">#define bfa_mem_dma_seg_iter(_mod, _sptr, _nr, _i)			\</span>
<span class="cp">	for (_i = 0, _sptr = bfa_mem_dma_sptr(_mod, _i); _i &lt; (_nr);	\</span>
<span class="cp">	     _i++, _sptr = bfa_mem_dma_sptr(_mod, _i))</span>

<span class="cp">#define bfa_mem_kva_curp(_mod)	((_mod)-&gt;kva_seg.kva_curp)</span>
<span class="cp">#define bfa_mem_dma_virt(_sptr)	((_sptr)-&gt;kva_curp)</span>
<span class="cp">#define bfa_mem_dma_phys(_sptr)	((_sptr)-&gt;dma_curp)</span>
<span class="cp">#define bfa_mem_dma_len(_sptr)	((_sptr)-&gt;mem_len)</span>

<span class="cm">/* Get the corresponding dma buf kva for a req - from the tag */</span>
<span class="cp">#define bfa_mem_get_dmabuf_kva(_mod, _tag, _rqsz)			      \</span>
<span class="cp">	(((u8 *)(_mod)-&gt;dma_seg[BFI_MEM_SEG_FROM_TAG(_tag, _rqsz)].kva_curp) +\</span>
<span class="cp">	 BFI_MEM_SEG_REQ_OFFSET(_tag, _rqsz) * (_rqsz))</span>

<span class="cm">/* Get the corresponding dma buf pa for a req - from the tag */</span>
<span class="cp">#define bfa_mem_get_dmabuf_pa(_mod, _tag, _rqsz)			\</span>
<span class="cp">	((_mod)-&gt;dma_seg[BFI_MEM_SEG_FROM_TAG(_tag, _rqsz)].dma_curp +	\</span>
<span class="cp">	 BFI_MEM_SEG_REQ_OFFSET(_tag, _rqsz) * (_rqsz))</span>

<span class="cm">/*</span>
<span class="cm"> * PCI device information required by IOC</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfa_pcidev_s</span> <span class="p">{</span>
	<span class="kt">int</span>		<span class="n">pci_slot</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">pci_func</span><span class="p">;</span>
	<span class="n">u16</span>		<span class="n">device_id</span><span class="p">;</span>
	<span class="n">u16</span>		<span class="n">ssid</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span>	<span class="o">*</span><span class="n">pci_bar_kva</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Structure used to remember the DMA-able memory block&#39;s KVA and Physical</span>
<span class="cm"> * Address</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfa_dma_s</span> <span class="p">{</span>
	<span class="kt">void</span>		<span class="o">*</span><span class="n">kva</span><span class="p">;</span>	<span class="cm">/* ! Kernel virtual address	*/</span>
	<span class="n">u64</span>	<span class="n">pa</span><span class="p">;</span>	<span class="cm">/* ! Physical address		*/</span>
<span class="p">};</span>

<span class="cp">#define BFA_DMA_ALIGN_SZ	256</span>
<span class="cp">#define BFA_ROUNDUP(_l, _s)	(((_l) + ((_s) - 1)) &amp; ~((_s) - 1))</span>

<span class="cm">/*</span>
<span class="cm"> * smem size for Crossbow and Catapult</span>
<span class="cm"> */</span>
<span class="cp">#define BFI_SMEM_CB_SIZE	0x200000U	</span><span class="cm">/* ! 2MB for crossbow	*/</span><span class="cp"></span>
<span class="cp">#define BFI_SMEM_CT_SIZE	0x280000U	</span><span class="cm">/* ! 2.5MB for catapult	*/</span><span class="cp"></span>

<span class="cp">#define bfa_dma_be_addr_set(dma_addr, pa)	\</span>
<span class="cp">		__bfa_dma_be_addr_set(&amp;dma_addr, (u64)pa)</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span>
<span class="nf">__bfa_dma_be_addr_set</span><span class="p">(</span><span class="k">union</span> <span class="n">bfi_addr_u</span> <span class="o">*</span><span class="n">dma_addr</span><span class="p">,</span> <span class="n">u64</span> <span class="n">pa</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">dma_addr</span><span class="o">-&gt;</span><span class="n">a32</span><span class="p">.</span><span class="n">addr_lo</span> <span class="o">=</span> <span class="n">cpu_to_be32</span><span class="p">(</span><span class="n">pa</span><span class="p">);</span>
	<span class="n">dma_addr</span><span class="o">-&gt;</span><span class="n">a32</span><span class="p">.</span><span class="n">addr_hi</span> <span class="o">=</span> <span class="n">cpu_to_be32</span><span class="p">(</span><span class="n">pa</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">);</span>
<span class="p">}</span>

<span class="cp">#define bfa_alen_set(__alen, __len, __pa)	\</span>
<span class="cp">	__bfa_alen_set(__alen, __len, (u64)__pa)</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span>
<span class="nf">__bfa_alen_set</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfi_alen_s</span> <span class="o">*</span><span class="n">alen</span><span class="p">,</span> <span class="n">u32</span> <span class="n">len</span><span class="p">,</span> <span class="n">u64</span> <span class="n">pa</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">alen</span><span class="o">-&gt;</span><span class="n">al_len</span> <span class="o">=</span> <span class="n">cpu_to_be32</span><span class="p">(</span><span class="n">len</span><span class="p">);</span>
	<span class="n">bfa_dma_be_addr_set</span><span class="p">(</span><span class="n">alen</span><span class="o">-&gt;</span><span class="n">al_addr</span><span class="p">,</span> <span class="n">pa</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">struct</span> <span class="n">bfa_ioc_regs_s</span> <span class="p">{</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">hfn_mbox_cmd</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">hfn_mbox</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">lpu_mbox_cmd</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">lpu_mbox</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">lpu_read_stat</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">pss_ctl_reg</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">pss_err_status_reg</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">app_pll_fast_ctl_reg</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">app_pll_slow_ctl_reg</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">ioc_sem_reg</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">ioc_usage_sem_reg</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">ioc_init_sem_reg</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">ioc_usage_reg</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">host_page_num_fn</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">heartbeat</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">ioc_fwstate</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">alt_ioc_fwstate</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">ll_halt</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">alt_ll_halt</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">err_set</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">ioc_fail_sync</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">shirq_isr_next</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">shirq_msk_next</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">smem_page_start</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">smem_pg0</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define bfa_mem_read(_raddr, _off)	swab32(readl(((_raddr) + (_off))))</span>
<span class="cp">#define bfa_mem_write(_raddr, _off, _val)	\</span>
<span class="cp">			writel(swab32((_val)), ((_raddr) + (_off)))</span>
<span class="cm">/*</span>
<span class="cm"> * IOC Mailbox structures</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfa_mbox_cmd_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">list_head</span>	<span class="n">qe</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">msg</span><span class="p">[</span><span class="n">BFI_IOC_MSGSZ</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * IOC mailbox module</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">bfa_ioc_mbox_mcfunc_t</span><span class="p">)(</span><span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">,</span> <span class="k">struct</span> <span class="n">bfi_mbmsg_s</span> <span class="o">*</span><span class="n">m</span><span class="p">);</span>
<span class="k">struct</span> <span class="n">bfa_ioc_mbox_mod_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">list_head</span>		<span class="n">cmd_q</span><span class="p">;</span>	<span class="cm">/*  pending mbox queue	*/</span>
	<span class="kt">int</span>			<span class="n">nmclass</span><span class="p">;</span>	<span class="cm">/*  number of handlers */</span>
	<span class="k">struct</span> <span class="p">{</span>
		<span class="n">bfa_ioc_mbox_mcfunc_t</span>	<span class="n">cbfn</span><span class="p">;</span>	<span class="cm">/*  message handlers	*/</span>
		<span class="kt">void</span>			<span class="o">*</span><span class="n">cbarg</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">mbhdlr</span><span class="p">[</span><span class="n">BFI_MC_MAX</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * IOC callback function interfaces</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">bfa_ioc_enable_cbfn_t</span><span class="p">)(</span><span class="kt">void</span> <span class="o">*</span><span class="n">bfa</span><span class="p">,</span> <span class="k">enum</span> <span class="n">bfa_status</span> <span class="n">status</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">bfa_ioc_disable_cbfn_t</span><span class="p">)(</span><span class="kt">void</span> <span class="o">*</span><span class="n">bfa</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">bfa_ioc_hbfail_cbfn_t</span><span class="p">)(</span><span class="kt">void</span> <span class="o">*</span><span class="n">bfa</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">bfa_ioc_reset_cbfn_t</span><span class="p">)(</span><span class="kt">void</span> <span class="o">*</span><span class="n">bfa</span><span class="p">);</span>
<span class="k">struct</span> <span class="n">bfa_ioc_cbfn_s</span> <span class="p">{</span>
	<span class="n">bfa_ioc_enable_cbfn_t</span>	<span class="n">enable_cbfn</span><span class="p">;</span>
	<span class="n">bfa_ioc_disable_cbfn_t</span>	<span class="n">disable_cbfn</span><span class="p">;</span>
	<span class="n">bfa_ioc_hbfail_cbfn_t</span>	<span class="n">hbfail_cbfn</span><span class="p">;</span>
	<span class="n">bfa_ioc_reset_cbfn_t</span>	<span class="n">reset_cbfn</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * IOC event notification mechanism.</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">bfa_ioc_event_e</span> <span class="p">{</span>
	<span class="n">BFA_IOC_E_ENABLED</span>	<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">BFA_IOC_E_DISABLED</span>	<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">BFA_IOC_E_FAILED</span>	<span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">typedef</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">bfa_ioc_notify_cbfn_t</span><span class="p">)(</span><span class="kt">void</span> <span class="o">*</span><span class="p">,</span> <span class="k">enum</span> <span class="n">bfa_ioc_event_e</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">bfa_ioc_notify_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">list_head</span>		<span class="n">qe</span><span class="p">;</span>
	<span class="n">bfa_ioc_notify_cbfn_t</span>	<span class="n">cbfn</span><span class="p">;</span>
	<span class="kt">void</span>			<span class="o">*</span><span class="n">cbarg</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Initialize a IOC event notification structure</span>
<span class="cm"> */</span>
<span class="cp">#define bfa_ioc_notify_init(__notify, __cbfn, __cbarg) do {	\</span>
<span class="cp">	(__notify)-&gt;cbfn = (__cbfn);      \</span>
<span class="cp">	(__notify)-&gt;cbarg = (__cbarg);      \</span>
<span class="cp">} while (0)</span>

<span class="k">struct</span> <span class="n">bfa_iocpf_s</span> <span class="p">{</span>
	<span class="n">bfa_fsm_t</span>		<span class="n">fsm</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_ioc_s</span>	<span class="o">*</span><span class="n">ioc</span><span class="p">;</span>
	<span class="n">bfa_boolean_t</span>		<span class="n">fw_mismatch_notified</span><span class="p">;</span>
	<span class="n">bfa_boolean_t</span>		<span class="n">auto_recover</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">poll_time</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="p">{</span>
	<span class="n">bfa_fsm_t</span>		<span class="n">fsm</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_s</span>		<span class="o">*</span><span class="n">bfa</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_pcidev_s</span>	<span class="n">pcidev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_timer_mod_s</span>	<span class="o">*</span><span class="n">timer_mod</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_timer_s</span>	<span class="n">ioc_timer</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_timer_s</span>	<span class="n">sem_timer</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_timer_s</span>	<span class="n">hb_timer</span><span class="p">;</span>
	<span class="n">u32</span>		<span class="n">hb_count</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span>	<span class="n">notify_q</span><span class="p">;</span>
	<span class="kt">void</span>			<span class="o">*</span><span class="n">dbg_fwsave</span><span class="p">;</span>
	<span class="kt">int</span>			<span class="n">dbg_fwsave_len</span><span class="p">;</span>
	<span class="n">bfa_boolean_t</span>		<span class="n">dbg_fwsave_once</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">bfi_pcifn_class</span>	<span class="n">clscode</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_ioc_regs_s</span>	<span class="n">ioc_regs</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_trc_mod_s</span>	<span class="o">*</span><span class="n">trcmod</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_ioc_drv_stats_s</span>	<span class="n">stats</span><span class="p">;</span>
	<span class="n">bfa_boolean_t</span>		<span class="n">fcmode</span><span class="p">;</span>
	<span class="n">bfa_boolean_t</span>		<span class="n">pllinit</span><span class="p">;</span>
	<span class="n">bfa_boolean_t</span>		<span class="n">stats_busy</span><span class="p">;</span>	<span class="cm">/*  outstanding stats */</span>
	<span class="n">u8</span>			<span class="n">port_id</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_dma_s</span>	<span class="n">attr_dma</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_ioc_attr_s</span>	<span class="o">*</span><span class="n">attr</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_ioc_cbfn_s</span>	<span class="o">*</span><span class="n">cbfn</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_ioc_mbox_mod_s</span> <span class="n">mbox_mod</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_ioc_hwif_s</span>	<span class="o">*</span><span class="n">ioc_hwif</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_iocpf_s</span>	<span class="n">iocpf</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">bfi_asic_gen</span>	<span class="n">asic_gen</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">bfi_asic_mode</span>	<span class="n">asic_mode</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">bfi_port_mode</span>	<span class="n">port0_mode</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">bfi_port_mode</span>	<span class="n">port1_mode</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">bfa_mode_s</span>		<span class="n">port_mode</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">ad_cap_bm</span><span class="p">;</span>	<span class="cm">/* adapter cap bit mask */</span>
	<span class="n">u8</span>			<span class="n">port_mode_cfg</span><span class="p">;</span>	<span class="cm">/* config port mode */</span>
	<span class="kt">int</span>			<span class="n">ioc_aen_seq</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfa_ioc_hwif_s</span> <span class="p">{</span>
	<span class="n">bfa_status_t</span> <span class="p">(</span><span class="o">*</span><span class="n">ioc_pll_init</span><span class="p">)</span> <span class="p">(</span><span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">rb</span><span class="p">,</span> <span class="k">enum</span> <span class="n">bfi_asic_mode</span> <span class="n">m</span><span class="p">);</span>
	<span class="n">bfa_boolean_t</span>	<span class="p">(</span><span class="o">*</span><span class="n">ioc_firmware_lock</span><span class="p">)</span>	<span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
	<span class="kt">void</span>		<span class="p">(</span><span class="o">*</span><span class="n">ioc_firmware_unlock</span><span class="p">)</span>	<span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
	<span class="kt">void</span>		<span class="p">(</span><span class="o">*</span><span class="n">ioc_reg_init</span><span class="p">)</span>	<span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
	<span class="kt">void</span>		<span class="p">(</span><span class="o">*</span><span class="n">ioc_map_port</span><span class="p">)</span>	<span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
	<span class="kt">void</span>		<span class="p">(</span><span class="o">*</span><span class="n">ioc_isr_mode_set</span><span class="p">)</span>	<span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span>
					<span class="n">bfa_boolean_t</span> <span class="n">msix</span><span class="p">);</span>
	<span class="kt">void</span>		<span class="p">(</span><span class="o">*</span><span class="n">ioc_notify_fail</span><span class="p">)</span>	<span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
	<span class="kt">void</span>		<span class="p">(</span><span class="o">*</span><span class="n">ioc_ownership_reset</span><span class="p">)</span>	<span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
	<span class="n">bfa_boolean_t</span>   <span class="p">(</span><span class="o">*</span><span class="n">ioc_sync_start</span><span class="p">)</span>       <span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
	<span class="kt">void</span>		<span class="p">(</span><span class="o">*</span><span class="n">ioc_sync_join</span><span class="p">)</span>	<span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
	<span class="kt">void</span>		<span class="p">(</span><span class="o">*</span><span class="n">ioc_sync_leave</span><span class="p">)</span>	<span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
	<span class="kt">void</span>		<span class="p">(</span><span class="o">*</span><span class="n">ioc_sync_ack</span><span class="p">)</span>		<span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
	<span class="n">bfa_boolean_t</span>	<span class="p">(</span><span class="o">*</span><span class="n">ioc_sync_complete</span><span class="p">)</span>	<span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
	<span class="n">bfa_boolean_t</span>	<span class="p">(</span><span class="o">*</span><span class="n">ioc_lpu_read_stat</span><span class="p">)</span>	<span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Queue element to wait for room in request queue. FIFO order is</span>
<span class="cm"> * maintained when fullfilling requests.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfa_reqq_wait_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">list_head</span>	<span class="n">qe</span><span class="p">;</span>
	<span class="kt">void</span>	<span class="p">(</span><span class="o">*</span><span class="n">qresume</span><span class="p">)</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">);</span>
	<span class="kt">void</span>	<span class="o">*</span><span class="n">cbarg</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">typedef</span> <span class="kt">void</span>	<span class="p">(</span><span class="o">*</span><span class="n">bfa_cb_cbfn_t</span><span class="p">)</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">,</span> <span class="n">bfa_boolean_t</span> <span class="n">complete</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Generic BFA callback element.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfa_cb_qe_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">list_head</span>	<span class="n">qe</span><span class="p">;</span>
	<span class="n">bfa_cb_cbfn_t</span>	<span class="n">cbfn</span><span class="p">;</span>
	<span class="n">bfa_boolean_t</span>	<span class="n">once</span><span class="p">;</span>
	<span class="n">bfa_boolean_t</span>	<span class="n">pre_rmv</span><span class="p">;</span>	<span class="cm">/* set for stack based qe(s) */</span>
	<span class="n">bfa_status_t</span>	<span class="n">fw_status</span><span class="p">;</span>	<span class="cm">/* to access fw status in comp proc */</span>
	<span class="kt">void</span>		<span class="o">*</span><span class="n">cbarg</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * IOCFC state machine definitions/declarations</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">iocfc_event</span> <span class="p">{</span>
	<span class="n">IOCFC_E_INIT</span>		<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>	<span class="cm">/* IOCFC init request		*/</span>
	<span class="n">IOCFC_E_START</span>		<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>	<span class="cm">/* IOCFC mod start request	*/</span>
	<span class="n">IOCFC_E_STOP</span>		<span class="o">=</span> <span class="mi">3</span><span class="p">,</span>	<span class="cm">/* IOCFC stop request		*/</span>
	<span class="n">IOCFC_E_ENABLE</span>		<span class="o">=</span> <span class="mi">4</span><span class="p">,</span>	<span class="cm">/* IOCFC enable request		*/</span>
	<span class="n">IOCFC_E_DISABLE</span>		<span class="o">=</span> <span class="mi">5</span><span class="p">,</span>	<span class="cm">/* IOCFC disable request	*/</span>
	<span class="n">IOCFC_E_IOC_ENABLED</span>	<span class="o">=</span> <span class="mi">6</span><span class="p">,</span>	<span class="cm">/* IOC enabled message		*/</span>
	<span class="n">IOCFC_E_IOC_DISABLED</span>	<span class="o">=</span> <span class="mi">7</span><span class="p">,</span>	<span class="cm">/* IOC disabled message		*/</span>
	<span class="n">IOCFC_E_IOC_FAILED</span>	<span class="o">=</span> <span class="mi">8</span><span class="p">,</span>	<span class="cm">/* failure notice by IOC sm	*/</span>
	<span class="n">IOCFC_E_DCONF_DONE</span>	<span class="o">=</span> <span class="mi">9</span><span class="p">,</span>	<span class="cm">/* dconf read/write done	*/</span>
	<span class="n">IOCFC_E_CFG_DONE</span>	<span class="o">=</span> <span class="mi">10</span><span class="p">,</span>	<span class="cm">/* IOCFC config complete	*/</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * ASIC block configurtion related</span>
<span class="cm"> */</span>

<span class="k">typedef</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">bfa_ablk_cbfn_t</span><span class="p">)(</span><span class="kt">void</span> <span class="o">*</span><span class="p">,</span> <span class="k">enum</span> <span class="n">bfa_status</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">bfa_ablk_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfa_ioc_s</span>	<span class="o">*</span><span class="n">ioc</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_ablk_cfg_s</span>	<span class="o">*</span><span class="n">cfg</span><span class="p">;</span>
	<span class="n">u16</span>			<span class="o">*</span><span class="n">pcifn</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_dma_s</span>	<span class="n">dma_addr</span><span class="p">;</span>
	<span class="n">bfa_boolean_t</span>		<span class="n">busy</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_mbox_cmd_s</span>	<span class="n">mb</span><span class="p">;</span>
	<span class="n">bfa_ablk_cbfn_t</span>		<span class="n">cbfn</span><span class="p">;</span>
	<span class="kt">void</span>			<span class="o">*</span><span class="n">cbarg</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_ioc_notify_s</span>	<span class="n">ioc_notify</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_mem_dma_s</span>	<span class="n">ablk_dma</span><span class="p">;</span>
<span class="p">};</span>
<span class="cp">#define BFA_MEM_ABLK_DMA(__bfa)		(&amp;((__bfa)-&gt;modules.ablk.ablk_dma))</span>

<span class="cm">/*</span>
<span class="cm"> *	SFP module specific</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="kt">void</span>	<span class="p">(</span><span class="o">*</span><span class="n">bfa_cb_sfp_t</span><span class="p">)</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">,</span> <span class="n">bfa_status_t</span> <span class="n">status</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">bfa_sfp_s</span> <span class="p">{</span>
	<span class="kt">void</span>	<span class="o">*</span><span class="n">dev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_ioc_s</span>	<span class="o">*</span><span class="n">ioc</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_trc_mod_s</span>	<span class="o">*</span><span class="n">trcmod</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sfp_mem_s</span>	<span class="o">*</span><span class="n">sfpmem</span><span class="p">;</span>
	<span class="n">bfa_cb_sfp_t</span>		<span class="n">cbfn</span><span class="p">;</span>
	<span class="kt">void</span>			<span class="o">*</span><span class="n">cbarg</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">bfi_sfp_mem_e</span>	<span class="n">memtype</span><span class="p">;</span> <span class="cm">/* mem access type   */</span>
	<span class="n">u32</span>			<span class="n">status</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_mbox_cmd_s</span>	<span class="n">mbcmd</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="o">*</span><span class="n">dbuf_kva</span><span class="p">;</span> <span class="cm">/* dma buf virtual address */</span>
	<span class="n">u64</span>			<span class="n">dbuf_pa</span><span class="p">;</span>   <span class="cm">/* dma buf physical address */</span>
	<span class="k">struct</span> <span class="n">bfa_ioc_notify_s</span>	<span class="n">ioc_notify</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">bfa_defs_sfp_media_e</span> <span class="o">*</span><span class="n">media</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">bfa_port_speed</span>	<span class="n">portspeed</span><span class="p">;</span>
	<span class="n">bfa_cb_sfp_t</span>		<span class="n">state_query_cbfn</span><span class="p">;</span>
	<span class="kt">void</span>			<span class="o">*</span><span class="n">state_query_cbarg</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">lock</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">data_valid</span><span class="p">;</span> <span class="cm">/* data in dbuf is valid */</span>
	<span class="n">u8</span>			<span class="n">state</span><span class="p">;</span>	    <span class="cm">/* sfp state  */</span>
	<span class="n">u8</span>			<span class="n">state_query_lock</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_mem_dma_s</span>	<span class="n">sfp_dma</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">is_elb</span><span class="p">;</span>	    <span class="cm">/* eloopback  */</span>
<span class="p">};</span>

<span class="cp">#define BFA_SFP_MOD(__bfa)	(&amp;(__bfa)-&gt;modules.sfp)</span>
<span class="cp">#define BFA_MEM_SFP_DMA(__bfa)	(&amp;(BFA_SFP_MOD(__bfa)-&gt;sfp_dma))</span>

<span class="n">u32</span>	<span class="n">bfa_sfp_meminfo</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="kt">void</span>	<span class="n">bfa_sfp_attach</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_sfp_s</span> <span class="o">*</span><span class="n">sfp</span><span class="p">,</span> <span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span>
			<span class="kt">void</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="k">struct</span> <span class="n">bfa_trc_mod_s</span> <span class="o">*</span><span class="n">trcmod</span><span class="p">);</span>

<span class="kt">void</span>	<span class="n">bfa_sfp_memclaim</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_sfp_s</span> <span class="o">*</span><span class="n">diag</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">dm_kva</span><span class="p">,</span> <span class="n">u64</span> <span class="n">dm_pa</span><span class="p">);</span>
<span class="kt">void</span>	<span class="n">bfa_sfp_intr</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">bfaarg</span><span class="p">,</span> <span class="k">struct</span> <span class="n">bfi_mbmsg_s</span> <span class="o">*</span><span class="n">msg</span><span class="p">);</span>

<span class="n">bfa_status_t</span>	<span class="n">bfa_sfp_show</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_sfp_s</span> <span class="o">*</span><span class="n">sfp</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sfp_mem_s</span> <span class="o">*</span><span class="n">sfpmem</span><span class="p">,</span>
			     <span class="n">bfa_cb_sfp_t</span> <span class="n">cbfn</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">);</span>

<span class="n">bfa_status_t</span>	<span class="n">bfa_sfp_media</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_sfp_s</span> <span class="o">*</span><span class="n">sfp</span><span class="p">,</span>
			<span class="k">enum</span> <span class="n">bfa_defs_sfp_media_e</span> <span class="o">*</span><span class="n">media</span><span class="p">,</span>
			<span class="n">bfa_cb_sfp_t</span> <span class="n">cbfn</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">);</span>

<span class="n">bfa_status_t</span>	<span class="n">bfa_sfp_speed</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_sfp_s</span> <span class="o">*</span><span class="n">sfp</span><span class="p">,</span>
			<span class="k">enum</span> <span class="n">bfa_port_speed</span> <span class="n">portspeed</span><span class="p">,</span>
			<span class="n">bfa_cb_sfp_t</span> <span class="n">cbfn</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> *	Flash module specific</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="kt">void</span>	<span class="p">(</span><span class="o">*</span><span class="n">bfa_cb_flash_t</span><span class="p">)</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">,</span> <span class="n">bfa_status_t</span> <span class="n">status</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">bfa_flash_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">;</span>		<span class="cm">/* back pointer to ioc */</span>
	<span class="k">struct</span> <span class="n">bfa_trc_mod_s</span> <span class="o">*</span><span class="n">trcmod</span><span class="p">;</span>
	<span class="n">u32</span>		<span class="n">type</span><span class="p">;</span>           <span class="cm">/* partition type */</span>
	<span class="n">u8</span>		<span class="n">instance</span><span class="p">;</span>       <span class="cm">/* partition instance */</span>
	<span class="n">u8</span>		<span class="n">rsv</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u32</span>		<span class="n">op_busy</span><span class="p">;</span>        <span class="cm">/*  operation busy flag */</span>
	<span class="n">u32</span>		<span class="n">residue</span><span class="p">;</span>        <span class="cm">/*  residual length */</span>
	<span class="n">u32</span>		<span class="n">offset</span><span class="p">;</span>         <span class="cm">/*  offset */</span>
	<span class="n">bfa_status_t</span>	<span class="n">status</span><span class="p">;</span>         <span class="cm">/*  status */</span>
	<span class="n">u8</span>		<span class="o">*</span><span class="n">dbuf_kva</span><span class="p">;</span>      <span class="cm">/*  dma buf virtual address */</span>
	<span class="n">u64</span>		<span class="n">dbuf_pa</span><span class="p">;</span>        <span class="cm">/*  dma buf physical address */</span>
	<span class="k">struct</span> <span class="n">bfa_reqq_wait_s</span>	<span class="n">reqq_wait</span><span class="p">;</span> <span class="cm">/*  to wait for room in reqq */</span>
	<span class="n">bfa_cb_flash_t</span>	<span class="n">cbfn</span><span class="p">;</span>           <span class="cm">/*  user callback function */</span>
	<span class="kt">void</span>		<span class="o">*</span><span class="n">cbarg</span><span class="p">;</span>         <span class="cm">/*  user callback arg */</span>
	<span class="n">u8</span>		<span class="o">*</span><span class="n">ubuf</span><span class="p">;</span>          <span class="cm">/*  user supplied buffer */</span>
	<span class="k">struct</span> <span class="n">bfa_cb_qe_s</span>	<span class="n">hcb_qe</span><span class="p">;</span> <span class="cm">/*  comp: BFA callback qelem */</span>
	<span class="n">u32</span>		<span class="n">addr_off</span><span class="p">;</span>       <span class="cm">/*  partition address offset */</span>
	<span class="k">struct</span> <span class="n">bfa_mbox_cmd_s</span>	<span class="n">mb</span><span class="p">;</span>       <span class="cm">/*  mailbox */</span>
	<span class="k">struct</span> <span class="n">bfa_ioc_notify_s</span>	<span class="n">ioc_notify</span><span class="p">;</span> <span class="cm">/*  ioc event notify */</span>
	<span class="k">struct</span> <span class="n">bfa_mem_dma_s</span>	<span class="n">flash_dma</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define BFA_FLASH(__bfa)		(&amp;(__bfa)-&gt;modules.flash)</span>
<span class="cp">#define BFA_MEM_FLASH_DMA(__bfa)	(&amp;(BFA_FLASH(__bfa)-&gt;flash_dma))</span>

<span class="n">bfa_status_t</span> <span class="n">bfa_flash_get_attr</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_flash_s</span> <span class="o">*</span><span class="n">flash</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">bfa_flash_attr_s</span> <span class="o">*</span><span class="n">attr</span><span class="p">,</span>
			<span class="n">bfa_cb_flash_t</span> <span class="n">cbfn</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">);</span>
<span class="n">bfa_status_t</span> <span class="n">bfa_flash_erase_part</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_flash_s</span> <span class="o">*</span><span class="n">flash</span><span class="p">,</span>
			<span class="k">enum</span> <span class="n">bfa_flash_part_type</span> <span class="n">type</span><span class="p">,</span> <span class="n">u8</span> <span class="n">instance</span><span class="p">,</span>
			<span class="n">bfa_cb_flash_t</span> <span class="n">cbfn</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">);</span>
<span class="n">bfa_status_t</span> <span class="n">bfa_flash_update_part</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_flash_s</span> <span class="o">*</span><span class="n">flash</span><span class="p">,</span>
			<span class="k">enum</span> <span class="n">bfa_flash_part_type</span> <span class="n">type</span><span class="p">,</span> <span class="n">u8</span> <span class="n">instance</span><span class="p">,</span>
			<span class="kt">void</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="n">u32</span> <span class="n">len</span><span class="p">,</span> <span class="n">u32</span> <span class="n">offset</span><span class="p">,</span>
			<span class="n">bfa_cb_flash_t</span> <span class="n">cbfn</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">);</span>
<span class="n">bfa_status_t</span> <span class="n">bfa_flash_read_part</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_flash_s</span> <span class="o">*</span><span class="n">flash</span><span class="p">,</span>
			<span class="k">enum</span> <span class="n">bfa_flash_part_type</span> <span class="n">type</span><span class="p">,</span> <span class="n">u8</span> <span class="n">instance</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span>
			<span class="n">u32</span> <span class="n">len</span><span class="p">,</span> <span class="n">u32</span> <span class="n">offset</span><span class="p">,</span> <span class="n">bfa_cb_flash_t</span> <span class="n">cbfn</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">);</span>
<span class="n">u32</span>	<span class="n">bfa_flash_meminfo</span><span class="p">(</span><span class="n">bfa_boolean_t</span> <span class="n">mincfg</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_flash_attach</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_flash_s</span> <span class="o">*</span><span class="n">flash</span><span class="p">,</span> <span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span>
		<span class="kt">void</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="k">struct</span> <span class="n">bfa_trc_mod_s</span> <span class="o">*</span><span class="n">trcmod</span><span class="p">,</span> <span class="n">bfa_boolean_t</span> <span class="n">mincfg</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_flash_memclaim</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_flash_s</span> <span class="o">*</span><span class="n">flash</span><span class="p">,</span>
		<span class="n">u8</span> <span class="o">*</span><span class="n">dm_kva</span><span class="p">,</span> <span class="n">u64</span> <span class="n">dm_pa</span><span class="p">,</span> <span class="n">bfa_boolean_t</span> <span class="n">mincfg</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> *	DIAG module specific</span>
<span class="cm"> */</span>

<span class="k">typedef</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">bfa_cb_diag_t</span><span class="p">)</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">,</span> <span class="n">bfa_status_t</span> <span class="n">status</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">bfa_cb_diag_beacon_t</span><span class="p">)</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="n">bfa_boolean_t</span> <span class="n">beacon</span><span class="p">,</span>
			<span class="n">bfa_boolean_t</span> <span class="n">link_e2e_beacon</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> *      Firmware ping test results</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfa_diag_results_fwping</span> <span class="p">{</span>
	<span class="n">u32</span>     <span class="n">data</span><span class="p">;</span>   <span class="cm">/* store the corrupted data */</span>
	<span class="n">u32</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">u32</span>     <span class="n">dmastatus</span><span class="p">;</span>
	<span class="n">u8</span>      <span class="n">rsvd</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfa_diag_qtest_result_s</span> <span class="p">{</span>
	<span class="n">u32</span>	<span class="n">status</span><span class="p">;</span>
	<span class="n">u16</span>	<span class="n">count</span><span class="p">;</span>	<span class="cm">/* sucessful queue test count */</span>
	<span class="n">u8</span>	<span class="n">queue</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">rsvd</span><span class="p">;</span>	<span class="cm">/* 64-bit align */</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Firmware ping test results</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfa_diag_fwping_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfa_diag_results_fwping</span> <span class="o">*</span><span class="n">result</span><span class="p">;</span>
	<span class="n">bfa_cb_diag_t</span>  <span class="n">cbfn</span><span class="p">;</span>
	<span class="kt">void</span>            <span class="o">*</span><span class="n">cbarg</span><span class="p">;</span>
	<span class="n">u32</span>             <span class="n">data</span><span class="p">;</span>
	<span class="n">u8</span>              <span class="n">lock</span><span class="p">;</span>
	<span class="n">u8</span>              <span class="n">rsv</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u32</span>             <span class="n">status</span><span class="p">;</span>
	<span class="n">u32</span>             <span class="n">count</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_mbox_cmd_s</span>   <span class="n">mbcmd</span><span class="p">;</span>
	<span class="n">u8</span>              <span class="o">*</span><span class="n">dbuf_kva</span><span class="p">;</span>      <span class="cm">/* dma buf virtual address */</span>
	<span class="n">u64</span>             <span class="n">dbuf_pa</span><span class="p">;</span>        <span class="cm">/* dma buf physical address */</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> *      Temperature sensor query results</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfa_diag_results_tempsensor_s</span> <span class="p">{</span>
	<span class="n">u32</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">u16</span>     <span class="n">temp</span><span class="p">;</span>           <span class="cm">/* 10-bit A/D value */</span>
	<span class="n">u16</span>     <span class="n">brd_temp</span><span class="p">;</span>       <span class="cm">/* 9-bit board temp */</span>
	<span class="n">u8</span>      <span class="n">ts_junc</span><span class="p">;</span>        <span class="cm">/* show junction tempsensor   */</span>
	<span class="n">u8</span>      <span class="n">ts_brd</span><span class="p">;</span>         <span class="cm">/* show board tempsensor      */</span>
	<span class="n">u8</span>      <span class="n">rsvd</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>        <span class="cm">/* keep 8 bytes alignment     */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfa_diag_tsensor_s</span> <span class="p">{</span>
	<span class="n">bfa_cb_diag_t</span>   <span class="n">cbfn</span><span class="p">;</span>
	<span class="kt">void</span>            <span class="o">*</span><span class="n">cbarg</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_diag_results_tempsensor_s</span> <span class="o">*</span><span class="n">temp</span><span class="p">;</span>
	<span class="n">u8</span>              <span class="n">lock</span><span class="p">;</span>
	<span class="n">u8</span>              <span class="n">rsv</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u32</span>             <span class="n">status</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_mbox_cmd_s</span>   <span class="n">mbcmd</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfa_diag_sfpshow_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">sfp_mem_s</span>        <span class="o">*</span><span class="n">sfpmem</span><span class="p">;</span>
	<span class="n">bfa_cb_diag_t</span>           <span class="n">cbfn</span><span class="p">;</span>
	<span class="kt">void</span>                    <span class="o">*</span><span class="n">cbarg</span><span class="p">;</span>
	<span class="n">u8</span>      <span class="n">lock</span><span class="p">;</span>
	<span class="n">u8</span>      <span class="n">static_data</span><span class="p">;</span>
	<span class="n">u8</span>      <span class="n">rsv</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u32</span>     <span class="n">status</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_mbox_cmd_s</span>    <span class="n">mbcmd</span><span class="p">;</span>
	<span class="n">u8</span>      <span class="o">*</span><span class="n">dbuf_kva</span><span class="p">;</span>      <span class="cm">/* dma buf virtual address */</span>
	<span class="n">u64</span>     <span class="n">dbuf_pa</span><span class="p">;</span>        <span class="cm">/* dma buf physical address */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfa_diag_led_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfa_mbox_cmd_s</span>   <span class="n">mbcmd</span><span class="p">;</span>
	<span class="n">bfa_boolean_t</span>   <span class="n">lock</span><span class="p">;</span>   <span class="cm">/* 1: ledtest is operating */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfa_diag_beacon_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfa_mbox_cmd_s</span>   <span class="n">mbcmd</span><span class="p">;</span>
	<span class="n">bfa_boolean_t</span>   <span class="n">state</span><span class="p">;</span>          <span class="cm">/* port beacon state */</span>
	<span class="n">bfa_boolean_t</span>   <span class="n">link_e2e</span><span class="p">;</span>       <span class="cm">/* link beacon state */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfa_diag_s</span> <span class="p">{</span>
	<span class="kt">void</span>	<span class="o">*</span><span class="n">dev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_ioc_s</span>		<span class="o">*</span><span class="n">ioc</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_trc_mod_s</span>		<span class="o">*</span><span class="n">trcmod</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_diag_fwping_s</span>	<span class="n">fwping</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_diag_tsensor_s</span>	<span class="n">tsensor</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_diag_sfpshow_s</span>	<span class="n">sfpshow</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_diag_led_s</span>		<span class="n">ledtest</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_diag_beacon_s</span>	<span class="n">beacon</span><span class="p">;</span>
	<span class="kt">void</span>	<span class="o">*</span><span class="n">result</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_timer_s</span> <span class="n">timer</span><span class="p">;</span>
	<span class="n">bfa_cb_diag_beacon_t</span>  <span class="n">cbfn_beacon</span><span class="p">;</span>
	<span class="n">bfa_cb_diag_t</span>  <span class="n">cbfn</span><span class="p">;</span>
	<span class="kt">void</span>		<span class="o">*</span><span class="n">cbarg</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">block</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">timer_active</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">rsvd</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u32</span>		<span class="n">status</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_ioc_notify_s</span>	<span class="n">ioc_notify</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_mem_dma_s</span>	<span class="n">diag_dma</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define BFA_DIAG_MOD(__bfa)     (&amp;(__bfa)-&gt;modules.diag_mod)</span>
<span class="cp">#define BFA_MEM_DIAG_DMA(__bfa) (&amp;(BFA_DIAG_MOD(__bfa)-&gt;diag_dma))</span>

<span class="n">u32</span>	<span class="n">bfa_diag_meminfo</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_diag_memclaim</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_diag_s</span> <span class="o">*</span><span class="n">diag</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">dm_kva</span><span class="p">,</span> <span class="n">u64</span> <span class="n">dm_pa</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_diag_attach</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_diag_s</span> <span class="o">*</span><span class="n">diag</span><span class="p">,</span> <span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
		     <span class="n">bfa_cb_diag_beacon_t</span> <span class="n">cbfn_beacon</span><span class="p">,</span>
		     <span class="k">struct</span> <span class="n">bfa_trc_mod_s</span> <span class="o">*</span><span class="n">trcmod</span><span class="p">);</span>
<span class="n">bfa_status_t</span>	<span class="n">bfa_diag_reg_read</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_diag_s</span> <span class="o">*</span><span class="n">diag</span><span class="p">,</span> <span class="n">u32</span> <span class="n">offset</span><span class="p">,</span>
			<span class="n">u32</span> <span class="n">len</span><span class="p">,</span> <span class="n">u32</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="n">u32</span> <span class="n">force</span><span class="p">);</span>
<span class="n">bfa_status_t</span>	<span class="n">bfa_diag_reg_write</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_diag_s</span> <span class="o">*</span><span class="n">diag</span><span class="p">,</span> <span class="n">u32</span> <span class="n">offset</span><span class="p">,</span>
			<span class="n">u32</span> <span class="n">len</span><span class="p">,</span> <span class="n">u32</span> <span class="n">value</span><span class="p">,</span> <span class="n">u32</span> <span class="n">force</span><span class="p">);</span>
<span class="n">bfa_status_t</span>	<span class="n">bfa_diag_tsensor_query</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_diag_s</span> <span class="o">*</span><span class="n">diag</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">bfa_diag_results_tempsensor_s</span> <span class="o">*</span><span class="n">result</span><span class="p">,</span>
			<span class="n">bfa_cb_diag_t</span> <span class="n">cbfn</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">);</span>
<span class="n">bfa_status_t</span>	<span class="n">bfa_diag_fwping</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_diag_s</span> <span class="o">*</span><span class="n">diag</span><span class="p">,</span> <span class="n">u32</span> <span class="n">cnt</span><span class="p">,</span>
			<span class="n">u32</span> <span class="n">pattern</span><span class="p">,</span> <span class="k">struct</span> <span class="n">bfa_diag_results_fwping</span> <span class="o">*</span><span class="n">result</span><span class="p">,</span>
			<span class="n">bfa_cb_diag_t</span> <span class="n">cbfn</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">);</span>
<span class="n">bfa_status_t</span>	<span class="n">bfa_diag_sfpshow</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_diag_s</span> <span class="o">*</span><span class="n">diag</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">sfp_mem_s</span> <span class="o">*</span><span class="n">sfpmem</span><span class="p">,</span> <span class="n">u8</span> <span class="n">static_data</span><span class="p">,</span>
			<span class="n">bfa_cb_diag_t</span> <span class="n">cbfn</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">);</span>
<span class="n">bfa_status_t</span>	<span class="n">bfa_diag_memtest</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_diag_s</span> <span class="o">*</span><span class="n">diag</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">bfa_diag_memtest_s</span> <span class="o">*</span><span class="n">memtest</span><span class="p">,</span> <span class="n">u32</span> <span class="n">pattern</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">bfa_diag_memtest_result</span> <span class="o">*</span><span class="n">result</span><span class="p">,</span>
			<span class="n">bfa_cb_diag_t</span> <span class="n">cbfn</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">);</span>
<span class="n">bfa_status_t</span>	<span class="n">bfa_diag_ledtest</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_diag_s</span> <span class="o">*</span><span class="n">diag</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">bfa_diag_ledtest_s</span> <span class="o">*</span><span class="n">ledtest</span><span class="p">);</span>
<span class="n">bfa_status_t</span>	<span class="n">bfa_diag_beacon_port</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_diag_s</span> <span class="o">*</span><span class="n">diag</span><span class="p">,</span>
			<span class="n">bfa_boolean_t</span> <span class="n">beacon</span><span class="p">,</span> <span class="n">bfa_boolean_t</span> <span class="n">link_e2e_beacon</span><span class="p">,</span>
			<span class="n">u32</span> <span class="n">sec</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> *	PHY module specific</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">bfa_cb_phy_t</span><span class="p">)</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">,</span> <span class="n">bfa_status_t</span> <span class="n">status</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">bfa_phy_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">;</span>          <span class="cm">/* back pointer to ioc */</span>
	<span class="k">struct</span> <span class="n">bfa_trc_mod_s</span> <span class="o">*</span><span class="n">trcmod</span><span class="p">;</span>   <span class="cm">/* trace module */</span>
	<span class="n">u8</span>	<span class="n">instance</span><span class="p">;</span>       <span class="cm">/* port instance */</span>
	<span class="n">u8</span>	<span class="n">op_busy</span><span class="p">;</span>        <span class="cm">/* operation busy flag */</span>
	<span class="n">u8</span>	<span class="n">rsv</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u32</span>	<span class="n">residue</span><span class="p">;</span>        <span class="cm">/* residual length */</span>
	<span class="n">u32</span>	<span class="n">offset</span><span class="p">;</span>         <span class="cm">/* offset */</span>
	<span class="n">bfa_status_t</span>	<span class="n">status</span><span class="p">;</span>         <span class="cm">/* status */</span>
	<span class="n">u8</span>	<span class="o">*</span><span class="n">dbuf_kva</span><span class="p">;</span>      <span class="cm">/* dma buf virtual address */</span>
	<span class="n">u64</span>	<span class="n">dbuf_pa</span><span class="p">;</span>        <span class="cm">/* dma buf physical address */</span>
	<span class="k">struct</span> <span class="n">bfa_reqq_wait_s</span> <span class="n">reqq_wait</span><span class="p">;</span> <span class="cm">/* to wait for room in reqq */</span>
	<span class="n">bfa_cb_phy_t</span>	<span class="n">cbfn</span><span class="p">;</span>           <span class="cm">/* user callback function */</span>
	<span class="kt">void</span>		<span class="o">*</span><span class="n">cbarg</span><span class="p">;</span>         <span class="cm">/* user callback arg */</span>
	<span class="n">u8</span>		<span class="o">*</span><span class="n">ubuf</span><span class="p">;</span>          <span class="cm">/* user supplied buffer */</span>
	<span class="k">struct</span> <span class="n">bfa_cb_qe_s</span>	<span class="n">hcb_qe</span><span class="p">;</span> <span class="cm">/* comp: BFA callback qelem */</span>
	<span class="n">u32</span>	<span class="n">addr_off</span><span class="p">;</span>       <span class="cm">/* phy address offset */</span>
	<span class="k">struct</span> <span class="n">bfa_mbox_cmd_s</span>	<span class="n">mb</span><span class="p">;</span>       <span class="cm">/* mailbox */</span>
	<span class="k">struct</span> <span class="n">bfa_ioc_notify_s</span>	<span class="n">ioc_notify</span><span class="p">;</span> <span class="cm">/* ioc event notify */</span>
	<span class="k">struct</span> <span class="n">bfa_mem_dma_s</span>	<span class="n">phy_dma</span><span class="p">;</span>
<span class="p">};</span>
<span class="cp">#define BFA_PHY(__bfa)	(&amp;(__bfa)-&gt;modules.phy)</span>
<span class="cp">#define BFA_MEM_PHY_DMA(__bfa)	(&amp;(BFA_PHY(__bfa)-&gt;phy_dma))</span>

<span class="n">bfa_boolean_t</span> <span class="n">bfa_phy_busy</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
<span class="n">bfa_status_t</span> <span class="n">bfa_phy_get_attr</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_phy_s</span> <span class="o">*</span><span class="n">phy</span><span class="p">,</span> <span class="n">u8</span> <span class="n">instance</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">bfa_phy_attr_s</span> <span class="o">*</span><span class="n">attr</span><span class="p">,</span>
			<span class="n">bfa_cb_phy_t</span> <span class="n">cbfn</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">);</span>
<span class="n">bfa_status_t</span> <span class="n">bfa_phy_get_stats</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_phy_s</span> <span class="o">*</span><span class="n">phy</span><span class="p">,</span> <span class="n">u8</span> <span class="n">instance</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">bfa_phy_stats_s</span> <span class="o">*</span><span class="n">stats</span><span class="p">,</span>
			<span class="n">bfa_cb_phy_t</span> <span class="n">cbfn</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">);</span>
<span class="n">bfa_status_t</span> <span class="n">bfa_phy_update</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_phy_s</span> <span class="o">*</span><span class="n">phy</span><span class="p">,</span> <span class="n">u8</span> <span class="n">instance</span><span class="p">,</span>
			<span class="kt">void</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="n">u32</span> <span class="n">len</span><span class="p">,</span> <span class="n">u32</span> <span class="n">offset</span><span class="p">,</span>
			<span class="n">bfa_cb_phy_t</span> <span class="n">cbfn</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">);</span>
<span class="n">bfa_status_t</span> <span class="n">bfa_phy_read</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_phy_s</span> <span class="o">*</span><span class="n">phy</span><span class="p">,</span> <span class="n">u8</span> <span class="n">instance</span><span class="p">,</span>
			<span class="kt">void</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="n">u32</span> <span class="n">len</span><span class="p">,</span> <span class="n">u32</span> <span class="n">offset</span><span class="p">,</span>
			<span class="n">bfa_cb_phy_t</span> <span class="n">cbfn</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">);</span>

<span class="n">u32</span>	<span class="n">bfa_phy_meminfo</span><span class="p">(</span><span class="n">bfa_boolean_t</span> <span class="n">mincfg</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_phy_attach</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_phy_s</span> <span class="o">*</span><span class="n">phy</span><span class="p">,</span> <span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span>
		<span class="kt">void</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="k">struct</span> <span class="n">bfa_trc_mod_s</span> <span class="o">*</span><span class="n">trcmod</span><span class="p">,</span> <span class="n">bfa_boolean_t</span> <span class="n">mincfg</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_phy_memclaim</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_phy_s</span> <span class="o">*</span><span class="n">phy</span><span class="p">,</span>
		<span class="n">u8</span> <span class="o">*</span><span class="n">dm_kva</span><span class="p">,</span> <span class="n">u64</span> <span class="n">dm_pa</span><span class="p">,</span> <span class="n">bfa_boolean_t</span> <span class="n">mincfg</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_phy_intr</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">phyarg</span><span class="p">,</span> <span class="k">struct</span> <span class="n">bfi_mbmsg_s</span> <span class="o">*</span><span class="n">msg</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Driver Config( dconf) specific</span>
<span class="cm"> */</span>
<span class="cp">#define BFI_DCONF_SIGNATURE	0xabcdabcd</span>
<span class="cp">#define BFI_DCONF_VERSION	1</span>

<span class="cp">#pragma pack(1)</span>
<span class="k">struct</span> <span class="n">bfa_dconf_hdr_s</span> <span class="p">{</span>
	<span class="n">u32</span>	<span class="n">signature</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">version</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfa_dconf_s</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfa_dconf_hdr_s</span>		<span class="n">hdr</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_lunmask_cfg_s</span>	<span class="n">lun_mask</span><span class="p">;</span>
<span class="p">};</span>
<span class="cp">#pragma pack()</span>

<span class="k">struct</span> <span class="n">bfa_dconf_mod_s</span> <span class="p">{</span>
	<span class="n">bfa_sm_t</span>		<span class="n">sm</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">instance</span><span class="p">;</span>
	<span class="n">bfa_boolean_t</span>		<span class="n">read_data_valid</span><span class="p">;</span>
	<span class="n">bfa_boolean_t</span>		<span class="n">min_cfg</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_timer_s</span>	<span class="n">timer</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_s</span>		<span class="o">*</span><span class="n">bfa</span><span class="p">;</span>
	<span class="kt">void</span>			<span class="o">*</span><span class="n">bfad</span><span class="p">;</span>
	<span class="kt">void</span>			<span class="o">*</span><span class="n">trcmod</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_dconf_s</span>	<span class="o">*</span><span class="n">dconf</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfa_mem_kva_s</span>	<span class="n">kva_seg</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define BFA_DCONF_MOD(__bfa)	\</span>
<span class="cp">	(&amp;(__bfa)-&gt;modules.dconf_mod)</span>
<span class="cp">#define BFA_MEM_DCONF_KVA(__bfa)	(&amp;(BFA_DCONF_MOD(__bfa)-&gt;kva_seg))</span>
<span class="cp">#define bfa_dconf_read_data_valid(__bfa)	\</span>
<span class="cp">	(BFA_DCONF_MOD(__bfa)-&gt;read_data_valid)</span>
<span class="cp">#define BFA_DCONF_UPDATE_TOV	5000	</span><span class="cm">/* memtest timeout in msec */</span><span class="cp"></span>

<span class="kt">void</span>	<span class="n">bfa_dconf_modinit</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_s</span> <span class="o">*</span><span class="n">bfa</span><span class="p">);</span>
<span class="kt">void</span>	<span class="n">bfa_dconf_modexit</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_s</span> <span class="o">*</span><span class="n">bfa</span><span class="p">);</span>
<span class="n">bfa_status_t</span>	<span class="n">bfa_dconf_update</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_s</span> <span class="o">*</span><span class="n">bfa</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> *	IOC specfic macros</span>
<span class="cm"> */</span>
<span class="cp">#define bfa_ioc_pcifn(__ioc)		((__ioc)-&gt;pcidev.pci_func)</span>
<span class="cp">#define bfa_ioc_devid(__ioc)		((__ioc)-&gt;pcidev.device_id)</span>
<span class="cp">#define bfa_ioc_bar0(__ioc)		((__ioc)-&gt;pcidev.pci_bar_kva)</span>
<span class="cp">#define bfa_ioc_portid(__ioc)		((__ioc)-&gt;port_id)</span>
<span class="cp">#define bfa_ioc_asic_gen(__ioc)		((__ioc)-&gt;asic_gen)</span>
<span class="cp">#define bfa_ioc_is_cna(__ioc)	\</span>
<span class="cp">	((bfa_ioc_get_type(__ioc) == BFA_IOC_TYPE_FCoE) ||	\</span>
<span class="cp">	 (bfa_ioc_get_type(__ioc) == BFA_IOC_TYPE_LL))</span>
<span class="cp">#define bfa_ioc_fetch_stats(__ioc, __stats) \</span>
<span class="cp">		(((__stats)-&gt;drv_stats) = (__ioc)-&gt;stats)</span>
<span class="cp">#define bfa_ioc_clr_stats(__ioc)	\</span>
<span class="cp">		memset(&amp;(__ioc)-&gt;stats, 0, sizeof((__ioc)-&gt;stats))</span>
<span class="cp">#define bfa_ioc_maxfrsize(__ioc)	((__ioc)-&gt;attr-&gt;maxfrsize)</span>
<span class="cp">#define bfa_ioc_rx_bbcredit(__ioc)	((__ioc)-&gt;attr-&gt;rx_bbcredit)</span>
<span class="cp">#define bfa_ioc_speed_sup(__ioc)	\</span>
<span class="cp">	BFI_ADAPTER_GETP(SPEED, (__ioc)-&gt;attr-&gt;adapter_prop)</span>
<span class="cp">#define bfa_ioc_get_nports(__ioc)	\</span>
<span class="cp">	BFI_ADAPTER_GETP(NPORTS, (__ioc)-&gt;attr-&gt;adapter_prop)</span>

<span class="cp">#define bfa_ioc_stats(_ioc, _stats)	((_ioc)-&gt;stats._stats++)</span>
<span class="cp">#define BFA_IOC_FWIMG_MINSZ	(16 * 1024)</span>
<span class="cp">#define BFA_IOC_FW_SMEM_SIZE(__ioc)			\</span>
<span class="cp">	((bfa_ioc_asic_gen(__ioc) == BFI_ASIC_GEN_CB)	\</span>
<span class="cp">	 ? BFI_SMEM_CB_SIZE : BFI_SMEM_CT_SIZE)</span>
<span class="cp">#define BFA_IOC_FLASH_CHUNK_NO(off)		(off / BFI_FLASH_CHUNK_SZ_WORDS)</span>
<span class="cp">#define BFA_IOC_FLASH_OFFSET_IN_CHUNK(off)	(off % BFI_FLASH_CHUNK_SZ_WORDS)</span>
<span class="cp">#define BFA_IOC_FLASH_CHUNK_ADDR(chunkno)  (chunkno * BFI_FLASH_CHUNK_SZ_WORDS)</span>

<span class="cm">/*</span>
<span class="cm"> * IOC mailbox interface</span>
<span class="cm"> */</span>
<span class="kt">void</span> <span class="n">bfa_ioc_mbox_queue</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">bfa_mbox_cmd_s</span> <span class="o">*</span><span class="n">cmd</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ioc_mbox_register</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span>
		<span class="n">bfa_ioc_mbox_mcfunc_t</span> <span class="o">*</span><span class="n">mcfuncs</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ioc_mbox_isr</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ioc_mbox_send</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">ioc_msg</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">);</span>
<span class="n">bfa_boolean_t</span> <span class="n">bfa_ioc_msgget</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">mbmsg</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ioc_mbox_regisr</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span> <span class="k">enum</span> <span class="n">bfi_mclass</span> <span class="n">mc</span><span class="p">,</span>
		<span class="n">bfa_ioc_mbox_mcfunc_t</span> <span class="n">cbfn</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * IOC interfaces</span>
<span class="cm"> */</span>

<span class="cp">#define bfa_ioc_pll_init_asic(__ioc) \</span>
<span class="cp">	((__ioc)-&gt;ioc_hwif-&gt;ioc_pll_init((__ioc)-&gt;pcidev.pci_bar_kva, \</span>
<span class="cp">			   (__ioc)-&gt;asic_mode))</span>

<span class="n">bfa_status_t</span> <span class="n">bfa_ioc_pll_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
<span class="n">bfa_status_t</span> <span class="n">bfa_ioc_cb_pll_init</span><span class="p">(</span><span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">rb</span><span class="p">,</span> <span class="k">enum</span> <span class="n">bfi_asic_mode</span> <span class="n">mode</span><span class="p">);</span>
<span class="n">bfa_status_t</span> <span class="n">bfa_ioc_ct_pll_init</span><span class="p">(</span><span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">rb</span><span class="p">,</span> <span class="k">enum</span> <span class="n">bfi_asic_mode</span> <span class="n">mode</span><span class="p">);</span>
<span class="n">bfa_status_t</span> <span class="n">bfa_ioc_ct2_pll_init</span><span class="p">(</span><span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">rb</span><span class="p">,</span> <span class="k">enum</span> <span class="n">bfi_asic_mode</span> <span class="n">mode</span><span class="p">);</span>

<span class="cp">#define bfa_ioc_isr_mode_set(__ioc, __msix) do {			\</span>
<span class="cp">	if ((__ioc)-&gt;ioc_hwif-&gt;ioc_isr_mode_set)			\</span>
<span class="cp">		((__ioc)-&gt;ioc_hwif-&gt;ioc_isr_mode_set(__ioc, __msix));	\</span>
<span class="cp">} while (0)</span>
<span class="cp">#define	bfa_ioc_ownership_reset(__ioc)				\</span>
<span class="cp">			((__ioc)-&gt;ioc_hwif-&gt;ioc_ownership_reset(__ioc))</span>
<span class="cp">#define bfa_ioc_get_fcmode(__ioc)	((__ioc)-&gt;fcmode)</span>
<span class="cp">#define bfa_ioc_lpu_read_stat(__ioc) do {			\</span>
<span class="cp">	if ((__ioc)-&gt;ioc_hwif-&gt;ioc_lpu_read_stat)		\</span>
<span class="cp">		((__ioc)-&gt;ioc_hwif-&gt;ioc_lpu_read_stat(__ioc));	\</span>
<span class="cp">} while (0)</span>

<span class="kt">void</span> <span class="n">bfa_ioc_set_cb_hwif</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ioc_set_ct_hwif</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ioc_set_ct2_hwif</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ioc_ct2_poweron</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">bfa_ioc_attach</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">bfa</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">bfa_ioc_cbfn_s</span> <span class="o">*</span><span class="n">cbfn</span><span class="p">,</span> <span class="k">struct</span> <span class="n">bfa_timer_mod_s</span> <span class="o">*</span><span class="n">timer_mod</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ioc_auto_recover</span><span class="p">(</span><span class="n">bfa_boolean_t</span> <span class="n">auto_recover</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ioc_detach</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ioc_pci_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">bfa_pcidev_s</span> <span class="o">*</span><span class="n">pcidev</span><span class="p">,</span>
		<span class="k">enum</span> <span class="n">bfi_pcifn_class</span> <span class="n">clscode</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ioc_mem_claim</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span>  <span class="n">u8</span> <span class="o">*</span><span class="n">dm_kva</span><span class="p">,</span> <span class="n">u64</span> <span class="n">dm_pa</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ioc_enable</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ioc_disable</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
<span class="n">bfa_boolean_t</span> <span class="n">bfa_ioc_intx_claim</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">bfa_ioc_boot</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span> <span class="n">u32</span> <span class="n">boot_type</span><span class="p">,</span>
		<span class="n">u32</span> <span class="n">boot_env</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ioc_isr</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">bfi_mbmsg_s</span> <span class="o">*</span><span class="n">msg</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ioc_error_isr</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
<span class="n">bfa_boolean_t</span> <span class="n">bfa_ioc_is_operational</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
<span class="n">bfa_boolean_t</span> <span class="n">bfa_ioc_is_initialized</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
<span class="n">bfa_boolean_t</span> <span class="n">bfa_ioc_is_disabled</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
<span class="n">bfa_boolean_t</span> <span class="n">bfa_ioc_is_acq_addr</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
<span class="n">bfa_boolean_t</span> <span class="n">bfa_ioc_fw_mismatch</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
<span class="n">bfa_boolean_t</span> <span class="n">bfa_ioc_adapter_is_disabled</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ioc_reset_fwstate</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
<span class="k">enum</span> <span class="n">bfa_ioc_type_e</span> <span class="n">bfa_ioc_get_type</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ioc_get_adapter_serial_num</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">serial_num</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ioc_get_adapter_fw_ver</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">fw_ver</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ioc_get_adapter_optrom_ver</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">optrom_ver</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ioc_get_adapter_model</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">model</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ioc_get_adapter_manufacturer</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span>
		<span class="kt">char</span> <span class="o">*</span><span class="n">manufacturer</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ioc_get_pci_chip_rev</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">chip_rev</span><span class="p">);</span>
<span class="k">enum</span> <span class="n">bfa_ioc_state</span> <span class="n">bfa_ioc_get_state</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">bfa_ioc_get_attr</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">bfa_ioc_attr_s</span> <span class="o">*</span><span class="n">ioc_attr</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ioc_get_adapter_attr</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">bfa_adapter_attr_s</span> <span class="o">*</span><span class="n">ad_attr</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ioc_debug_memclaim</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">dbg_fwsave</span><span class="p">);</span>
<span class="n">bfa_status_t</span> <span class="n">bfa_ioc_debug_fwsave</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">trcdata</span><span class="p">,</span>
		<span class="kt">int</span> <span class="o">*</span><span class="n">trclen</span><span class="p">);</span>
<span class="n">bfa_status_t</span> <span class="n">bfa_ioc_debug_fwtrc</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">trcdata</span><span class="p">,</span>
				 <span class="kt">int</span> <span class="o">*</span><span class="n">trclen</span><span class="p">);</span>
<span class="n">bfa_status_t</span> <span class="n">bfa_ioc_debug_fwcore</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span>
	<span class="n">u32</span> <span class="o">*</span><span class="n">offset</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">buflen</span><span class="p">);</span>
<span class="n">bfa_boolean_t</span> <span class="n">bfa_ioc_sem_get</span><span class="p">(</span><span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">sem_reg</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ioc_fwver_get</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">bfi_ioc_image_hdr_s</span> <span class="o">*</span><span class="n">fwhdr</span><span class="p">);</span>
<span class="n">bfa_boolean_t</span> <span class="n">bfa_ioc_fwver_cmp</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">bfi_ioc_image_hdr_s</span> <span class="o">*</span><span class="n">fwhdr</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ioc_aen_post</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span> <span class="k">enum</span> <span class="n">bfa_ioc_aen_event</span> <span class="n">event</span><span class="p">);</span>
<span class="n">bfa_status_t</span> <span class="n">bfa_ioc_fw_stats_get</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">stats</span><span class="p">);</span>
<span class="n">bfa_status_t</span> <span class="n">bfa_ioc_fw_stats_clear</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * asic block configuration related APIs</span>
<span class="cm"> */</span>
<span class="n">u32</span>	<span class="n">bfa_ablk_meminfo</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ablk_memclaim</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ablk_s</span> <span class="o">*</span><span class="n">ablk</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">dma_kva</span><span class="p">,</span> <span class="n">u64</span> <span class="n">dma_pa</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bfa_ablk_attach</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ablk_s</span> <span class="o">*</span><span class="n">ablk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
<span class="n">bfa_status_t</span> <span class="n">bfa_ablk_query</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ablk_s</span> <span class="o">*</span><span class="n">ablk</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">bfa_ablk_cfg_s</span> <span class="o">*</span><span class="n">ablk_cfg</span><span class="p">,</span>
		<span class="n">bfa_ablk_cbfn_t</span> <span class="n">cbfn</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">);</span>
<span class="n">bfa_status_t</span> <span class="n">bfa_ablk_adapter_config</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ablk_s</span> <span class="o">*</span><span class="n">ablk</span><span class="p">,</span>
		<span class="k">enum</span> <span class="n">bfa_mode_s</span> <span class="n">mode</span><span class="p">,</span> <span class="kt">int</span> <span class="n">max_pf</span><span class="p">,</span> <span class="kt">int</span> <span class="n">max_vf</span><span class="p">,</span>
		<span class="n">bfa_ablk_cbfn_t</span> <span class="n">cbfn</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">);</span>
<span class="n">bfa_status_t</span> <span class="n">bfa_ablk_port_config</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ablk_s</span> <span class="o">*</span><span class="n">ablk</span><span class="p">,</span> <span class="kt">int</span> <span class="n">port</span><span class="p">,</span>
		<span class="k">enum</span> <span class="n">bfa_mode_s</span> <span class="n">mode</span><span class="p">,</span> <span class="kt">int</span> <span class="n">max_pf</span><span class="p">,</span> <span class="kt">int</span> <span class="n">max_vf</span><span class="p">,</span>
		<span class="n">bfa_ablk_cbfn_t</span> <span class="n">cbfn</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">);</span>
<span class="n">bfa_status_t</span> <span class="n">bfa_ablk_pf_create</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ablk_s</span> <span class="o">*</span><span class="n">ablk</span><span class="p">,</span> <span class="n">u16</span> <span class="o">*</span><span class="n">pcifn</span><span class="p">,</span>
		<span class="n">u8</span> <span class="n">port</span><span class="p">,</span> <span class="k">enum</span> <span class="n">bfi_pcifn_class</span> <span class="n">personality</span><span class="p">,</span> <span class="kt">int</span> <span class="n">bw</span><span class="p">,</span>
		<span class="n">bfa_ablk_cbfn_t</span> <span class="n">cbfn</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">);</span>
<span class="n">bfa_status_t</span> <span class="n">bfa_ablk_pf_delete</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ablk_s</span> <span class="o">*</span><span class="n">ablk</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pcifn</span><span class="p">,</span>
		<span class="n">bfa_ablk_cbfn_t</span> <span class="n">cbfn</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">);</span>
<span class="n">bfa_status_t</span> <span class="n">bfa_ablk_pf_update</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ablk_s</span> <span class="o">*</span><span class="n">ablk</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pcifn</span><span class="p">,</span> <span class="kt">int</span> <span class="n">bw</span><span class="p">,</span>
		<span class="n">bfa_ablk_cbfn_t</span> <span class="n">cbfn</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">);</span>
<span class="n">bfa_status_t</span> <span class="n">bfa_ablk_optrom_en</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ablk_s</span> <span class="o">*</span><span class="n">ablk</span><span class="p">,</span>
		<span class="n">bfa_ablk_cbfn_t</span> <span class="n">cbfn</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">);</span>
<span class="n">bfa_status_t</span> <span class="n">bfa_ablk_optrom_dis</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ablk_s</span> <span class="o">*</span><span class="n">ablk</span><span class="p">,</span>
		<span class="n">bfa_ablk_cbfn_t</span> <span class="n">cbfn</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">cbarg</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * bfa mfg wwn API functions</span>
<span class="cm"> */</span>
<span class="n">mac_t</span> <span class="n">bfa_ioc_get_mac</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>
<span class="n">mac_t</span> <span class="n">bfa_ioc_get_mfg_mac</span><span class="p">(</span><span class="k">struct</span> <span class="n">bfa_ioc_s</span> <span class="o">*</span><span class="n">ioc</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * F/W Image Size &amp; Chunk</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="n">u32</span> <span class="n">bfi_image_cb_size</span><span class="p">;</span>
<span class="k">extern</span> <span class="n">u32</span> <span class="n">bfi_image_ct_size</span><span class="p">;</span>
<span class="k">extern</span> <span class="n">u32</span> <span class="n">bfi_image_ct2_size</span><span class="p">;</span>
<span class="k">extern</span> <span class="n">u32</span> <span class="o">*</span><span class="n">bfi_image_cb</span><span class="p">;</span>
<span class="k">extern</span> <span class="n">u32</span> <span class="o">*</span><span class="n">bfi_image_ct</span><span class="p">;</span>
<span class="k">extern</span> <span class="n">u32</span> <span class="o">*</span><span class="n">bfi_image_ct2</span><span class="p">;</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="o">*</span>
<span class="nf">bfi_image_cb_get_chunk</span><span class="p">(</span><span class="n">u32</span> <span class="n">off</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">u32</span> <span class="o">*</span><span class="p">)(</span><span class="n">bfi_image_cb</span> <span class="o">+</span> <span class="n">off</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="o">*</span>
<span class="nf">bfi_image_ct_get_chunk</span><span class="p">(</span><span class="n">u32</span> <span class="n">off</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">u32</span> <span class="o">*</span><span class="p">)(</span><span class="n">bfi_image_ct</span> <span class="o">+</span> <span class="n">off</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="o">*</span>
<span class="nf">bfi_image_ct2_get_chunk</span><span class="p">(</span><span class="n">u32</span> <span class="n">off</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">u32</span> <span class="o">*</span><span class="p">)(</span><span class="n">bfi_image_ct2</span> <span class="o">+</span> <span class="n">off</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span><span class="o">*</span>
<span class="nf">bfa_cb_image_get_chunk</span><span class="p">(</span><span class="k">enum</span> <span class="n">bfi_asic_gen</span> <span class="n">asic_gen</span><span class="p">,</span> <span class="n">u32</span> <span class="n">off</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">asic_gen</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">BFI_ASIC_GEN_CB</span>:
		<span class="k">return</span> <span class="n">bfi_image_cb_get_chunk</span><span class="p">(</span><span class="n">off</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">BFI_ASIC_GEN_CT</span>:
		<span class="k">return</span> <span class="n">bfi_image_ct_get_chunk</span><span class="p">(</span><span class="n">off</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">BFI_ASIC_GEN_CT2</span>:
		<span class="k">return</span> <span class="n">bfi_image_ct2_get_chunk</span><span class="p">(</span><span class="n">off</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span>
<span class="nf">bfa_cb_image_get_size</span><span class="p">(</span><span class="k">enum</span> <span class="n">bfi_asic_gen</span> <span class="n">asic_gen</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">asic_gen</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">BFI_ASIC_GEN_CB</span>:
		<span class="k">return</span> <span class="n">bfi_image_cb_size</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">BFI_ASIC_GEN_CT</span>:
		<span class="k">return</span> <span class="n">bfi_image_ct_size</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">BFI_ASIC_GEN_CT2</span>:
		<span class="k">return</span> <span class="n">bfi_image_ct2_size</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * CNA TRCMOD declaration</span>
<span class="cm"> */</span>
<span class="cm">/*</span>
<span class="cm"> * !!! Only append to the enums defined here to avoid any versioning</span>
<span class="cm"> * !!! needed between trace utility and driver version</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">BFA_TRC_CNA_PORT</span>	<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">BFA_TRC_CNA_IOC</span>		<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">BFA_TRC_CNA_IOC_CB</span>	<span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">BFA_TRC_CNA_IOC_CT</span>	<span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="cm">/* __BFA_IOC_H__ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
