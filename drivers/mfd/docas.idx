f | stmpe.h | s | 6.9K | 211 | Viresh Kumar | viresh.kumar@st.com | 1326065864 |  | mfd: Add support for stmpe variant 801  STMPE801 is a GPIO expander. Registers for 801 are much different from other variants. This patch adds support for STMPE801 in stmpe mfd driver.  Signed-off-by: Bhupesh Sharma <bhupesh.sharma@st.com> Signed-off-by: Pratyush Anand <pratyush.anand@st.com> Signed-off-by: Viresh Kumar <viresh.kumar@st.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | twl4030-power.c | s | 14K | 524 | Russell King | rmk+kernel@arm.linux.org.uk | 1329127235 |  | ARM: omap: fix section mismatch errors in TWL PMIC driver  WARNING: drivers/mfd/built-in.o(.devinit.text+0x258): Section mismatch in reference from the function twl_probe() to the function .init.text:twl4030_power_init() The function __devinit twl_probe() references a function __init twl4030_power_init(). If twl4030_power_init is only used by twl_probe then annotate twl4030_power_init with a matching annotation.  twl4030_power_init() references other __init marked functions, so these too must become __devinit.  Acked-by: Tony Lindgren <tony@atomide.com> Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
f | htc-i2cpld.c | s | 17K | 588 | Thomas Gleixner | tglx@linutronix.de | 1301180992 |  | mfd: Fold irq_set_chip/irq_set_handler  Use the combined irq_set_chip_and_handler() function instead. Converted with coccinelle.  Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | t7l66xb.c | s | 10K | 363 | Mark Brown | broonie@opensource.wolfsonmicro.com | 1326065851 |  | mfd: Convert MFD drivers to use module_platform_driver  Factors out some boilerplate code for drivers doing the default thing for platform driver registration. Drivers using platform_driver_probe or an initcall other than module_init can't be converted.  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | mc13xxx-core.c | s | 18K | 584 | Linus Torvalds | torvalds@linux-foundation.org | 1338317591 |  | 
f | s5m-core.c | s | 4.6K | 175 | Axel Lin | axel.lin@gmail.com | 1336578653 |  | mfd: Convert s5m-core to devm_regmap_init_i2c()  Signed-off-by: Axel Lin <axel.lin@gmail.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | htc-pasic3.c | s | 5.2K | 184 | Jean-François Dagenais | dagenaisj@sonatest.com | 1310184884 |  | w1: ds1wm: add a reset recovery parameter  This fixes a regression in 3.0 reported by Paul Parsons regarding the removal of the msleep(1) in the ds1wm_reset() function:  : The linux-3.0-rc4 DS1WM 1-wire driver is logging "bus error, retrying" : error messages on an HP iPAQ hx4700 PDA (XScale-PXA270): : : <snip> : Driver for 1-wire Dallas network protocol. : DS1WM w1 busmaster driver - (c) 2004 Szabolcs Gyurko : 1-Wire driver for the DS2760 battery monitor  chip  - (c) 2004-2005, Szabolcs Gyurko : ds1wm ds1wm: pass: 1 bus error, retrying : ds1wm ds1wm: pass: 2 bus error, retrying : ds1wm ds1wm: pass: 3 bus error, retrying : ds1wm ds1wm: pass: 4 bus error, retrying : ds1wm ds1wm: pass: 5 bus error, retrying : ... : : The visible result is that the battery charging LED is erratic; sometimes : it works, mostly it doesn't. : : The linux-2.6.39 DS1WM 1-wire driver worked OK.  I haven't tried 3.0-rc1, : 3.0-rc2, or 3.0-rc3.  This sleep should not be required on normal circuitry provided the pull-ups on the bus are correctly adapted to the slaves.  Unfortunately, this is not always the case.  The sleep is restored but as a parameter to the probe function in the pdata.  [akpm@linux-foundation.org: coding-style fixes] Reported-by: Paul Parsons <lost.distance@yahoo.com> Tested-by: Paul Parsons <lost.distance@yahoo.com> Signed-off-by: Jean-François Dagenais <dagenaisj@sonatest.com> Cc: Evgeniy Polyakov <johnpol@2ka.mipt.ru> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | wm8350-regmap.c | s | 123K | 3396 | Mark Brown | broonie@opensource.wolfsonmicro.com | 1260728513 |  | mfd: Remove build time warning for WM835x register default tables  Systems using the WM835x need to choose which of the default register settings are required on the system.  Currently there is a compile time warning as well as a runtime error intended to flag up to users that this is required but this also triggers for people building the driver in order to obtain build coverage.  Remove the build warning, leaving only the runtime error, in order to reduce noise for people doing generic kernel work.  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | db8500-prcmu.c | s | 76K | 2547 | Lee Jones | lee.jones@linaro.org | 1338509086 |  | ARM: ux500: Provide regulator support for SMSC911x via Device Tree  This patch adds a fixed regulator for use by the SMSC911x Ethernet chip driver into the db8500 Device Tree. It also references other regulators required by the same device.  Acked-by: Linus Walleij <linus.walleij@linaro.org> Signed-off-by: Lee Jones <lee.jones@linaro.org> Signed-off-by: Arnd Bergmann <arnd@arndb.de>
f | Makefile | g | 4.6K |  | Linus Torvalds | torvalds@linux-foundation.org | 1338317591 |  | 
f | ab8500-sysctrl.c | s | 1.9K | 70 | Lee Jones | lee.jones@linaro.org | 1337527633 |  | mfd: Enable Device Tree support in the ab8500-sysctrl driver  This patch ensures probing of the ab8500-sysctrl driver during a DT enabled boot, so long as the associated nodes are present in the Device Tree binary.  Signed-off-by: Lee Jones <lee.jones@linaro.org> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | 88pm860x-i2c.c | s | 9.6K | 343 | Jett.Zhou | jtzhou@marvell.com | 1331056009 |  | mfd: Add ability to wake the system for 88pm860x  For 88pm860x pmic, it can wake the system from low power mode by irq, its sub-devs like RTC and onkey can be enabled for this usage.  Signed-off-by: Jett.Zhou <jtzhou@marvell.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | lpc_sch.c | s | 4.8K | 153 | Wim Van Sebroeck | wim@iguana.be | 1337527623 |  | mfd: Change tunnelcreek watchdog name on the lpc_sch subdevices array  The name of the tunnelcreek watchdog device is not tunnelcreek_wdt but ie6xx_wdt.  Signed-off-by: Wim Van Sebroeck <wim@iguana.be> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | tps65912-core.c | s | 4.0K | 144 | Axel Lin | axel.lin@gmail.com | 1330015090 |  | mfd: Initialize tps65912 irq platform data properly  irq_base of the tps65912 irq platform data should be initialized with the board provided irq_base data.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | wm831x-i2c.c | s | 2.6K | 97 | Mark Brown | broonie@opensource.wolfsonmicro.com | 1329919025 |  | mfd: wm831x: Convert to devm_regmap_init()  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Acked-by: Samuel Ortiz <sameo@linux.intel.com>
f | tc3589x.c | s | 9.3K | 349 | Linus Walleij | linus.walleij@linaro.org | 1319458149 |  | mfd: Add missing #ifdef around tc3589x PM block  The CONFIG_PM code was unconditionally compiled in despite the dev_pm_ops only being included into the driver struct if used. Fix this by adding the missing #ifdef.  Signed-off-by: Linus Walleij <linus.walleij@linaro.org> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | wm831x-core.c | s | 42K | 1839 | Mark Brown | broonie@opensource.wolfsonmicro.com | 1337527627 |  | mfd: Convert wm831x to irq_domain  The modern idiom is to use irq_domain to allocate interrupts. This is useful partly to allow further infrastructure to be based on the domains and partly because it makes it much easier to allocate virtual interrupts to devices as we don't need to allocate a contiguous range of interrupt numbers.  Convert the wm831x driver over to this infrastructure, using a legacy IRQ mapping if an irq_base is specified in platform data and otherwise using a linear mapping, always registering the interrupts even if they won't ever be used. Only boards which need to use the GPIOs as interrupts should need to use an irq_base.  This means that we can't use the MFD irq_base management since the unless we're using an explicit irq_base from platform data we can't rely on a linear mapping of interrupts.  Instead we need to map things via the irq_domain - provide a conveniencem function wm831x_irq() to save a small amount of typing when doing so. Looking at this I couldn't clearly see anything the MFD core could do to make this nicer.  Since we're not supporting device tree yet there's no meaningful advantage if we don't do this conversion in one, the fact that the interrupt resources are used for repeated IP blocks makes accessor functions for the irq_domain more trouble to do than they're worth.  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | omap-usb-host.c | s | 24K | 721 | Russ Dill | Russ.Dill@ti.com | 1335866104 |  | mfd: Fix build breakage in omap-usb-host.c  'ARM: OMAP3: USB: Fix the EHCI ULPI PHY reset issue' removes the include for linux/gpio.h from omap-usb-host.c. This include indirectly includes plat/cpu.h which is required by omap-usb-host.c. Fix the build breakage by including it directly.  Acked-by: Keshava Munegowda <keshava_mgowda@ti.com> Acked-by: Kevin Hilman <khilman@ti.com> Tested-by: Arend van Spriel <arend@broadcom.com> Signed-off-by: Russ Dill <Russ.Dill@ti.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | stmpe-i2c.c | s | 2.6K | 90 | Viresh Kumar | viresh.linux@gmail.com | 1340228376 |  | Viresh has moved  viresh.kumar@st.com email-id doesn't exist anymore as I have left the company.  Replace ST's id with viresh.linux@gmail.com.  It also updates .mailmap file to fix address for 'git shortlog'  Signed-off-by: Viresh Kumar <viresh.linux@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | tps65912-spi.c | s | 3.2K | 115 | Lars-Peter Clausen | lars@metafoo.de | 1326065851 |  | mfd: Remove redundant spi driver bus initialization  In ancient times it was necessary to manually initialize the bus field of an spi_driver to spi_bus_type. These days this is done in spi_driver_register(), so we can drop the manual assignment.  The patch was generated using the following coccinelle semantic patch: // <smpl> @@ identifier _driver; @@ struct spi_driver _driver = { 	.driver = { -		.bus = &spi_bus_type, 	}, }; // </smpl>  Signed-off-by: Lars-Peter Clausen <lars@metafoo.de> Acked-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | janz-cmodio.c | s | 7.1K | 237 | Axel Lin | axel.lin@gmail.com | 1335866421 |  | mfd: Use module_pci_driver  This patch converts the drivers in drivers/mfd/* to use module_pci_driver() macro which makes the code smaller and a bit simpler.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Cc: Andres Salomon <dilinger@queued.net> Cc: Ira W. Snyder <iws@ovro.caltech.edu> Cc: Florian Fainelli <florian@openwrt.org> Cc: Denis Turischev <denis@compulab.co.il> Cc: Harald Welte <HaraldWelte@viatech.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | pcf50633-irq.c | s | 7.6K | 247 | Axel Lin | axel.lin@gmail.com | 1331056011 |  | mfd: Include linux/mfd/pcf50633/mbc.h in pcf50633-irq.c  Include linux/mfd/pcf50633/mbc.h instead of duplicating the same defines.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | tps6586x.c | s | 17K | 558 | Thierry Reding | thierry.reding@avionic-design.de | 1336134316 |  | tps6586x: Add device tree support  This commit adds device tree support for the TPS6586x regulator.  Signed-off-by: Thierry Reding <thierry.reding@avionic-design.de> Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com>
f | pcf50633-gpio.c | s | 2.7K | 76 | Axel Lin | axel.lin@gmail.com | 1331056011 |  | mfd: Include linux/mfd/pcf50633/pmic.h in pcf50633-gpio.c  Include linux/mfd/pcf50633/pmic.h instead of duplicating the same defines.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | rc5t583.c | s | 8.7K | 297 | Axel Lin | axel.lin@gmail.com | 1336578629 |  | mfd: Convert rc5t583 to devm_regmap_init_i2c()  Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: Laxman Dewangan <ldewangan@nvidia.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | ucb1x00-core.c | s | 19K | 670 | Russell King | rmk+kernel@arm.linux.org.uk | 1329606943 |  | MFD: ucb1x00-core: add wakeup support  Add genirq wakeup support for the ucb1x00 device.  This allows an attached gpio_keys driver to wakeup the system.  Touchscreen is also possible.  When there are no wakeup sources, ask the platform to assert the reset signal to avoid any unexpected behaviour; this also puts the reset signal at the right level when power is removed from the device.  Acked-by: Jochen Friedrich <jochen@scram.de> Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
f | ti-ssp.c | s | 11K | 379 | Mark Brown | broonie@opensource.wolfsonmicro.com | 1326065851 |  | mfd: Convert MFD drivers to use module_platform_driver  Factors out some boilerplate code for drivers doing the default thing for platform driver registration. Drivers using platform_driver_probe or an initcall other than module_init can't be converted.  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | tmio_core.c | s | 1.4K | 41 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103925 |  | mfd: Add export.h for EXPORT_SYMBOL/THIS_MODULE as required  These macros are in <linux/export.h> and will no longer be implicitly everywhere anymore.  Fix it up in advance.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | stmpe-spi.c | s | 3.2K | 121 | Viresh Kumar | viresh.linux@gmail.com | 1340228376 |  | Viresh has moved  viresh.kumar@st.com email-id doesn't exist anymore as I have left the company.  Replace ST's id with viresh.linux@gmail.com.  It also updates .mailmap file to fix address for 'git shortlog'  Signed-off-by: Viresh Kumar <viresh.linux@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | da9052-i2c.c | s | 3.7K | 138 | Axel Lin | axel.lin@gmail.com | 1337527623 |  | mfd: Convert da9052 to use devm_* APIs  Signed-off-by: Axel Lin <axel.lin@gmail.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | pm8xxx-irq.c | s | 9.4K | 312 | Abhijeet Dharmapurikar | adharmap@codeaurora.org | 1306431928 |  | mfd: Add pm8xxx irq support  Add support for the irq controller in Qualcomm 8xxx pmic. The 8xxx interrupt controller provides control for gpio and mpp configured as interrupts in addition to other subdevice interrupts. The interrupt controller also provides a way to read the real time status of an interrupt. This real time status is the only way one can get the input values of gpio and mpp lines.  Signed-off-by: Abhijeet Dharmapurikar <adharmap@codeaurora.org> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | palmas.c | s | 11K | 468 | Graeme Gregory | gg@slimlogic.co.uk | 1337356487 |  | mfd: palmas PMIC device support  Palmas is a PMIC from Texas Instruments and this is the MFD part of the driver for this chip. The PMIC has SMPS and LDO regulators, a general purpose ADC, GPIO, USB OTG mode detection, watchdog and RTC features.  Signed-off-by: Graeme Gregory <gg@slimlogic.co.uk> Acked-by: Samuel Ortiz <sameo@linux.intel.com> Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com>
f | ucb1x00-ts.c | s | 10K | 369 | Russell King | rmk+kernel@arm.linux.org.uk | 1329606943 |  | MFD: ucb1x00: convert to use genirq  Convert the ucb1x00 driver to use genirq's interrupt services, rather than its own private implementation.  This allows a wider range of drivers to use the GPIO interrupts (such as the gpio_keys driver) without being aware of the UCB1x00's private IRQ system.  This prevents the UCB1x00 core driver from being built as a module, so adjust the configuration to add that restriction.  Acked-by: Jochen Friedrich <jochen@scram.de> Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
f | mfd-core.c | s | 5.5K | 194 | Jean Delvare | khali@linux-fr.org | 1331056007 |  | mfd: Fix ACPI conflict check  The code is currently always checking the first resource of every device only (several times.) This has been broken since the ACPI check was added in February 2010 in commit 91fedede0338eb6203cdd618d8ece873fdb7c22c.  Fix the check to run on each resource individually, once.  Signed-off-by: Jean Delvare <khali@linux-fr.org> Cc: stable@vger.kernel.org Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | cs5535-mfd.c | s | 4.8K | 163 | Axel Lin | axel.lin@gmail.com | 1335866421 |  | mfd: Use module_pci_driver  This patch converts the drivers in drivers/mfd/* to use module_pci_driver() macro which makes the code smaller and a bit simpler.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Cc: Andres Salomon <dilinger@queued.net> Cc: Ira W. Snyder <iws@ovro.caltech.edu> Cc: Florian Fainelli <florian@openwrt.org> Cc: Denis Turischev <denis@compulab.co.il> Cc: Harald Welte <HaraldWelte@viatech.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | max8925-core.c | s | 16K | 622 | Philip Rakity | prakity@marvell.com | 1322249085 |  | max8925_power: Remove support for irq bits that do not exist  The max8925 cannot return usb status.  The bits         [MAX8925_IRQ_VCHG_USB_OVP] = {                .reg            = MAX8925_CHG_IRQ1,                .mask_reg       = MAX8925_CHG_IRQ1_MASK,                .offs           = 1 << 3,        },        [MAX8925_IRQ_VCHG_USB_F] =  {                .reg            = MAX8925_CHG_IRQ1,                .mask_reg       = MAX8925_CHG_IRQ1_MASK,                .offs           = 1 << 4,        },        [MAX8925_IRQ_VCHG_USB_R] = {                .reg            = MAX8925_CHG_IRQ1,                .mask_reg       = MAX8925_CHG_IRQ1_MASK,                .offs           = 1 << 5,        },  do not exist in the irq register.  Signed-off-by: Philip Rakity <prakity@marvell.com> Signed-off-by: Anton Vorontsov <cbouatmailru@gmail.com>
f | max8998-irq.c | s | 6.1K | 234 | Thomas Gleixner | tglx@linutronix.de | 1301180991 |  | mfd: Cleanup irq namespace  Converted with coccinelle.  Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Acked-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | max8997-irq.c | s | 10K | 321 | Jesper Juhl | jj@chaosbits.net | 1312147705 |  | mfd: Remove dead code from max8997-irq  We either hit one of the case's or the default in the switch statement in get_i2c(), so the 'return ERR_PTR(-EINVAL);' at the end of the function is just dead code - remove it.  Signed-off-by: Jesper Juhl <jj@chaosbits.net> Acked-by: MyungJoo Ham <myungjoo.ham@samsung.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | max77693-irq.c | s | 9.2K | 263 | Chanwoo Choi | cw00.choi@samsung.com | 1337527626 |  | mfd: Add MAX77693 irq handler  This patch supports IRQ handling for MAX77693.  Signed-off-by: Chanwoo Choi <cw00.choi@samsung.com> Signed-off-by: Myungjoo Ham <myungjoo.ham@samsung.com> Signed-off-by: Kyungmin Park <kyungmin.park@samsung.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | wm831x-otp.c | s | 1.8K | 65 | Mark Brown | broonie@opensource.wolfsonmicro.com | 1253173619 |  | mfd: Add basic WM831x OTP support  The WM831x series of devices use OTP (One Time Programmable, a type of PROM) to store system configuration. At run time this data is visible via registers.  Currently the only explicitly supported feature is that the unique ID provided by every WM831x device is exported to user space via sysfs. Other configuration data may be read by system-specific code in the pre_init() and post_init() platform data operations.  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | ab3100-core.c | s | 22K | 896 | Stephen Boyd | sboyd@codeaurora.org | 1333664750 |  | simple_open: automatically convert to simple_open()  Many users of debugfs copy the implementation of default_open() when they want to support a custom read/write function op.  This leads to a proliferation of the default_open() implementation across the entire tree.  Now that the common implementation has been consolidated into libfs we can replace all the users of this function with simple_open().  This replacement was done with the following semantic patch:  <smpl> @ open @ identifier open_f != simple_open; identifier i, f; @@ -int open_f(struct inode *i, struct file *f) -{ ( -if (i->i_private) -f->private_data = i->i_private; || -f->private_data = i->i_private; ) -return 0; -}  @ has_open depends on open @ identifier fops; identifier open.open_f; @@ struct file_operations fops = { ... -.open = open_f, +.open = simple_open, ... }; </smpl>  [akpm@linux-foundation.org: checkpatch fixes] Signed-off-by: Stephen Boyd <sboyd@codeaurora.org> Cc: Greg Kroah-Hartman <gregkh@linuxfoundation.org> Cc: Al Viro <viro@zeniv.linux.org.uk> Cc: Julia Lawall <Julia.Lawall@lip6.fr> Acked-by: Ingo Molnar <mingo@elte.hu> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | dm355evm_msp.c | s | 10K | 366 | Axel Lin | axel.lin@gmail.com | 1326065858 |  | mfd: Use gpio_request_one from dm355evm_msp  Use gpio_request_one() instead of multiple gpiolib calls.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | wm8350-gpio.c | s | 6.1K | 207 | Sascha Hauer | s.hauer@pengutronix.de | 1315319878 |  | mfd: Rename wm8350 static gpio_set_debounce()  The kernel already has a function with this name declared in asm-generic/gpio.h. So if this header leaks into wm8350/gpio.c we get  drivers/mfd/wm8350-gpio.c:40:12: error: conflicting types for 'gpio_set_debounce' include/asm-generic/gpio.h:156:12: note: previous declaration of 'gpio_set_debounce' was here  Fix this by adding a wm8350_ prefix to the function.  Signed-off-by: Sascha Hauer <s.hauer@pengutronix.de> Acked-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | mc13xxx-spi.c | s | 3.4K | 117 | Marc Reilly | marc@cpdesign.com.au | 1335868540 |  | mfd: Move the mc13xxx-core spi specific code into a separate module  All spi specific code is moved into a new module. The mc13xxx struct moves to a new local include file by necessity.  A new config choice selects the SPI bus type support and by default is value of SPI_MASTER to remain compatible with existing configs.  Signed-off-by: Marc Reilly <marc@cpdesign.com.au> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | max77693.c | s | 6.1K | 200 | Chanwoo Choi | cw00.choi@samsung.com | 1337527626 |  | mfd: Add MAX77693 irq handler  This patch supports IRQ handling for MAX77693.  Signed-off-by: Chanwoo Choi <cw00.choi@samsung.com> Signed-off-by: Myungjoo Ham <myungjoo.ham@samsung.com> Signed-off-by: Kyungmin Park <kyungmin.park@samsung.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | tps65217.c | s | 5.7K | 202 | Mark Brown | broonie@opensource.wolfsonmicro.com | 1337527620 |  | mfd: Staticise non-exported tps65217_update_bits()  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Acked-by: AnilKumar Ch <anilkumar@ti.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | wm8994-irq.c | s | 3.7K | 156 | Mark Brown | broonie@opensource.wolfsonmicro.com | 1337104645 |  | mfd: wm8994: Update to fully use irq_domain  Take advantage of the new regmap irq_domain support to dynamically allocate interrupts, using regmap_irq_get_virq() rather than irq_base to look up the interrupts. This means that most users should not need to specify an irq_base at all.  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Acked-by: Samuel Ortiz <sameo@linux.intel.com>
f | menelaus.c | s | 31K | 1119 | Linus Torvalds | torvalds@linux-foundation.org | 1320338451 |  | Merge branch 'for-next' of git://git.infradead.org/users/sameo/mfd-2.6  * 'for-next' of git://git.infradead.org/users/sameo/mfd-2.6: (80 commits)   mfd: Fix missing abx500 header file updates   mfd: Add missing <linux/io.h> include to intel_msic   x86, mrst: add platform support for MSIC MFD driver   mfd: Expose TurnOnStatus in ab8500 sysfs   mfd: Remove support for early drop ab8500 chip   mfd: Add support for ab8500 v3.3   mfd: Add ab8500 interrupt disable hook   mfd: Convert db8500-prcmu panic() into pr_crit()   mfd: Refactor db8500-prcmu request_clock() function   mfd: Rename db8500-prcmu init function   mfd: Fix db5500-prcmu defines   mfd: db8500-prcmu voltage domain consumers additions   mfd: db8500-prcmu reset code retrieval   mfd: db8500-prcmu tweak for modem wakeup   mfd: Add db8500-pcmu watchdog accessor functions for watchdog   mfd: hwacc power state db8500-prcmu accessor   mfd: Add db8500-prcmu accessors for PLL and SGA clock   mfd: Move to the new db500 PRCMU API   mfd: Create a common interface for dbx500 PRCMU drivers   mfd: Initialize DB8500 PRCMU regs   ...  Fix up trivial conflicts in 	arch/arm/mach-imx/mach-mx31moboard.c 	arch/arm/mach-omap2/board-omap3beagle.c 	arch/arm/mach-u300/include/mach/irqs.h 	drivers/mfd/wm831x-spi.c
f | tps65090.c | s | 9.1K | 317 | Linus Torvalds | torvalds@linux-foundation.org | 1338317591 |  | 
f | twl4030-irq.c | s | 20K | 682 | NeilBrown | neilb@suse.de | 1336579371 |  | mfd: enable wakeup on twl4030 IRQ.  Most of the interrupts that come through this line should trigger wakeups:   power button   RTC alarm   power available   usb plug/unplug  so mark the interrupt as a wakeup interrupt. This is particularly important for when the interrupt arrives during the late suspend phase.  Without this setting it will be ignored.  Signed-off-by: NeilBrown <neilb@suse.de> Acked-by: Kevin Hilman <khilman@ti.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | htc-egpio.c | s | 10K | 365 | Thomas Gleixner | tglx@linutronix.de | 1301180992 |  | mfd: Fold irq_set_chip/irq_set_handler  Use the combined irq_set_chip_and_handler() function instead. Converted with coccinelle.  Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | tps65912-irq.c | s | 6.2K | 190 | Margarita Olaya | magi@slimlogic.co.uk | 1312147702 |  | tps65912: irq: add interrupt controller  This module controls the interrupt handling for the tps65912. The interrupt sources can be the following:  - GPIO - PWRON signal - PWRHOLD signal - Temperature detection  Signed-off-by: Margarita Olaya Cabrera <magi@slimlogic.co.uk> Acked-by: Samuel Ortiz <sameo@linux.intel.com> Acked-by: Liam Girdwood <lrg@ti.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | dbx500-prcmu-regs.h | s | 9.3K | 208 | Daniel Lezcano | daniel.lezcano@linaro.org | 1331056016 |  | mfd : Check if the other db8500 core is in WFI  This patch allows to check if the other core is in WFI mode. It is the last check the idle routine has to do before entering into the retention state.  Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | wm831x-auxadc.c | s | 6.6K | 245 | Mark Brown | broonie@opensource.wolfsonmicro.com | 1337527627 |  | mfd: Convert wm831x to irq_domain  The modern idiom is to use irq_domain to allocate interrupts. This is useful partly to allow further infrastructure to be based on the domains and partly because it makes it much easier to allocate virtual interrupts to devices as we don't need to allocate a contiguous range of interrupt numbers.  Convert the wm831x driver over to this infrastructure, using a legacy IRQ mapping if an irq_base is specified in platform data and otherwise using a linear mapping, always registering the interrupts even if they won't ever be used. Only boards which need to use the GPIOs as interrupts should need to use an irq_base.  This means that we can't use the MFD irq_base management since the unless we're using an explicit irq_base from platform data we can't rely on a linear mapping of interrupts.  Instead we need to map things via the irq_domain - provide a conveniencem function wm831x_irq() to save a small amount of typing when doing so. Looking at this I couldn't clearly see anything the MFD core could do to make this nicer.  Since we're not supporting device tree yet there's no meaningful advantage if we don't do this conversion in one, the fact that the interrupt resources are used for repeated IP blocks makes accessor functions for the irq_domain more trouble to do than they're worth.  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | sm501.c | s | 40K | 1402 | Axel Lin | axel.lin@gmail.com | 1331926667 |  | mfd: Use DIV_ROUND_CLOSEST for sm501 clock  Use DIV_ROUND_CLOSEST to replace sm501fb_round_div function.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | mc13xxx.h | s | 960B | 34 | Marc Reilly | marc@cpdesign.com.au | 1335868540 |  | mfd: Move the mc13xxx-core spi specific code into a separate module  All spi specific code is moved into a new module. The mc13xxx struct moves to a new local include file by necessity.  A new config choice selects the SPI bus type support and by default is value of SPI_MASTER to remain compatible with existing configs.  Signed-off-by: Marc Reilly <marc@cpdesign.com.au> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | vx855.c | s | 3.8K | 117 | Axel Lin | axel.lin@gmail.com | 1335866421 |  | mfd: Use module_pci_driver  This patch converts the drivers in drivers/mfd/* to use module_pci_driver() macro which makes the code smaller and a bit simpler.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Cc: Andres Salomon <dilinger@queued.net> Cc: Ira W. Snyder <iws@ovro.caltech.edu> Cc: Florian Fainelli <florian@openwrt.org> Cc: Denis Turischev <denis@compulab.co.il> Cc: Harald Welte <HaraldWelte@viatech.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | wl1273-core.c | s | 6.5K | 234 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103924 |  | mfd: Add module.h to the implicit drivers/mfd users  With the pending module.h cleanup, these files will fail to compile, unless they explicitly call out the include of this file.  [omap-usb-host addition courtesy of Anand Gadiyar <gadiyar@ti.com>]  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | tps6507x.c | s | 3.2K | 129 | Axel Lin | axel.lin@gmail.com | 1288305029 |  | mfd: Fix off-by-one value range checking for tps6507x  If bytes == (TPS6507X_MAX_REGISTER + 1), we have a buffer overflow when doing memcpy(&msg[1], src, bytes).  Signed-off-by: Axel Lin <axel.lin@gmail.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | rc5t583-irq.c | s | 11K | 356 | Laxman Dewangan | ldewangan@nvidia.com | 1331924745 |  | mfd: Add support for RICOH PMIC RC5T583  Ricoh power management IC  RC5T583 contains is multi functional device having multiple sub devices inside this. This device has multiple dcdc/ldo regulators, gpios, interrupt controllers, on-key, RTCs, ADCs. This device have 4 DCDCs, 8 LDOs, 8 GPIOs, 6 ADCs, 3 RTCs etc.  Signed-off-by: Laxman Dewangan <ldewangan@nvidia.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | wm8400-core.c | s | 5.2K | 202 | Mark Brown | broonie@opensource.wolfsonmicro.com | 1337527625 |  | mfd: Export wm8400_block_read()  Used by the regulator driver.  Reported-by: Stephen Rothwell <sfr@canb.auug.org.au> Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | twl6030-irq.c | s | 12K | 383 | Benoit Cousson | b-cousson@ti.com | 1332417934 |  | mfd: Replace twl-* pr_ macros by the dev_ equivalent and do various cleanups  Since a structure device is available now, use the dev_ macros instead of the pr_ ones.  Clean some badly formatted comments. Remove some unused variables. Move some variable to the place they belong. Clean some badly wrapped lines. Align variable definition Add missing braces in if-then-else block. Add blank line for better readability. Move stuff here and there...  Conflicts:  	drivers/mfd/twl-core.c  Signed-off-by: Benoit Cousson <b-cousson@ti.com> Cc: Felipe Balbi <balbi@ti.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | stmpe.c | s | 25K | 946 | Chris Blair | chris.blair@stericsson.com | 1331055998 |  | mfd: Add support for no-interrupt stmpe config  Adds support for boards which have an STMPE device without the interrupt pin connected.  Acked-by: Viresh Kumar <viresh.kumar@st.com> Signed-off-by: Chris Blair <chris.blair@stericsson.com> Tested-by: Michel Jaouen <michel.jaouen@stericsson.com> Reviewed-by: Srinidhi Kasagar <srinidhi.kasagar@stericsson.com> Signed-off-by: Linus Walleij <linus.walleij@linaro.org> Acked-by: Viresh Kumar <viresh.kumar@st.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | twl6030-pwm.c | s | 3.6K | 132 | Randy Dunlap | rdunlap@xenotime.net | 1312147707 |  | mfd: twl6030-pwm.c needs MODULE_LICENSE  twl6030_pwm: module license 'unspecified' taints kernel.  Signed-off-by: Randy Dunlap <rdunlap@xenotime.net> Acked-by: Hemanth V <hemanthv@ti.com> Acked-by: Felipe Balbi <balbi@ti.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | wm8350-irq.c | s | 14K | 514 | Jonghwan Choi | jhbird.choi@samsung.com | 1329751127 |  | mfd: wm8350 variable dereferenced before check  Remove "wm8350->irq_base = pdata->irq_base" to avoid null pointer exception and wm8350->irq_base got from irq_alloc_descs().  Signed-off-by: Jonghwan Choi <jhbird.choi@samsung.com> Acked-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | ezx-pcap.c | s | 12K | 449 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | twl-core.h | s | 323B | 8 | Benoit Cousson | b-cousson@ti.com | 1332417873 |  | mfd: Move twl-core IRQ allocation into twl[4030||6030]-irq files  During DT adaptation, the irq_alloc_desc was added into twl-core, but due to the rather different and weird IRQ management required by the twl4030, it is much better to have a different approach for it. The issue is that twl4030 uses a two level IRQ mechanism but handles all the PWR interrupts as part of the twl-core interrupt range. It ends up with a range of 16 interrupts total for CORE and PWR.  The other twl4030 functionalities already have a dedicated driver and thus their IRQs and irqdomain can and should be defined localy.  twl6030 is using a single level IRQ controller and thus does not require any trick.  Move the irq_alloc_desc and irq_domain_add_legacy in twl4030-irq and twl6030-irq.  Allocate together CORE and PWR IRQs for twl4030-irq.  Conflicts:          drivers/mfd/twl-core.c  Signed-off-by: Benoit Cousson <b-cousson@ti.com> Acked-by: Felipe Balbi <balbi@ti.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | mc13xxx-i2c.c | s | 3.0K | 105 | Marc Reilly | marc@cpdesign.com.au | 1335868541 |  | mfd: Add mc13xxx i2c driver  Adds support for mc13xxx family ICs connected via i2c.  Signed-off-by: Marc Reilly <marc@cpdesign.com.au> Acked-by: Oskar Schirmer <oskar@scara.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | wm8350-i2c.c | s | 2.3K | 81 | Johan Hovold | jhovold@gmail.com | 1337527629 |  | mfd: Fix double free in wm8350 error path  Fix double free in probe error path introduced by the recent conversion of wm8350 to use regmap.  Signed-off-by: Johan Hovold <jhovold@gmail.com> Acked-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | twl-core.c | s | 35K | 1166 | NeilBrown | neilb@suse.de | 1336554263 |  | mfd: twl: define all feature flags in one place.  twl-regulator has a collection of feature flags, some defined in twl-core.c and  one defined in i2c/twl.h. This is confusing for anyone adding a new feature flag.  So collect them together and place them in twl.h immediately after the structure in which they are initially set.  Signed-off-by: NeilBrown <neilb@suse.de> Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com>
f | max8998.c | s | 8.4K | 291 | Jonghwan Choi | jhbird.choi@samsung.com | 1326065856 |  | mfd: Use standard device wakeup for handling max8998 wakeup device  Use device_init_wakeup & device_may_wakeup to init wakeup  Signed-off-by: Jonghwan Choi <jhbird.choi@samsung.com> Acked-by: Kyungmin Park <kyungmin.park@samsung.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | tps6105x.c | s | 5.6K | 215 | Samuel Ortiz | sameo@linux.intel.com | 1306431911 |  | mfd: Use mfd cell platform_data for tps6105x cells platform bits  With the addition of a platform device mfd_cell pointer, MFD drivers can go back to passing platform data back to their sub drivers. This allows for an mfd_cell->mfd_data removal and thus keep the sub drivers MFD agnostic. This is mostly needed for non MFD aware sub drivers.  Cc: Mark Brown <broonie@opensource.wolfsonmicro.com> Cc: Liam Girdwood <lrg@slimlogic.co.uk> Cc: Linus Walleij <linus.walleij@linaro.org> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | ab8500-core.c | s | 34K | 1317 | Lee Jones | lee.jones@linaro.org | 1337527630 |  | mfd: Enable Device Tree for ab8500-core driver  This patch will allow the ab8500-core driver to be probed and set up when booting when Device Tree is enabled. This includes platform ID look-up which identifies the machine it is currently running on. If we are undergoing a DT enabled boot, we will refuse to setup each of the other ab8500-* devices, as they will be probed individually by DT.  Signed-off-by: Lee Jones <lee.jones@linaro.org> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | lpc_ich.c | s | 23K | 839 | Aaron Sierra | asierra@xes-inc.com | 1336576809 |  | watchdog: Convert iTCO_wdt driver to mfd model  This patch converts the iTCO_wdt driver to use the multi-function device driver model. It uses resources discovered by the lpc_ich driver, so that it no longer does its own PCI scanning.  Signed-off-by: Aaron Sierra <asierra@xes-inc.com> Signed-off-by: Guenter Roeck <linux@roeck-us.net> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | pcf50633-core.c | s | 7.7K | 263 | Axel Lin | axel.lin@gmail.com | 1337527624 |  | mfd: Convert pcf50633-core to use devm_* APIs  Signed-off-by: Axel Lin <axel.lin@gmail.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | 88pm860x-core.c | s | 24K | 805 | Samuel Ortiz | sameo@linux.intel.com | 1331056017 |  | mfd: Fix pm8606 build failure  Reported by Andrew Morton <akpm@linux-foundation.org>, with i386 allmodconfig:  ERROR: "pm8606_osc_disable" [drivers/video/backlight/88pm860x_bl.ko] undefined! ERROR: "pm8606_osc_enable" [drivers/video/backlight/88pm860x_bl.ko] undefined! ERROR: "pm8606_osc_disable" [drivers/leds/leds-88pm860x.ko] undefined! ERROR: "pm8606_osc_enable" [drivers/leds/leds-88pm860x.ko] undefined!  Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | asic3.c | s | 26K | 884 | Samuel Ortiz | sameo@linux.intel.com | 1335866423 |  | mfd: No need to check for the GPIO offset from asic3_gpio_to_irq  The gpiolib code will only call our gpio_to_irq ops for our registered GPIO range.  Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | wm8994-regmap.c | s | 53K | 1198 | Mark Brown | broonie@opensource.wolfsonmicro.com | 1335866421 |  | mfd: Cache wm8994 chip revision  There's no need to mark the chip revision registers as volatile, it won't change at runtime so we can cache it from the device at startup.  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | mcp-sa11x0.c | s | 7.1K | 263 | Linus Torvalds | torvalds@linux-foundation.org | 1332975501 |  | 
f | da903x.c | s | 13K | 470 | Axel Lin | axel.lin@gmail.com | 1324403456 |  | mfd: Set da903x bits if new value is different from the old one  It does not make sense to write new value only when all the bit_mask bits are zero. We need to write new value if the bit mask fields of new value is not equal to old value.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | anatop-mfd.c | s | 3.5K | 109 | Richard Zhao | richard.zhao@linaro.org | 1337527627 |  | mfd: Make anatop register accessor more flexible and rename meaningfully   - rename to anatop_read_reg and anatop_write_reg  - anatop_read_reg directly return reg value  - anatop_write_reg write reg with mask  Signed-off-by: Richard Zhao <richard.zhao@freescale.com> Reviewed-by: Ying-Chun Liu (PaulLiu) <paul.liu@linaro.org> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | twl4030-madc.c | s | 21K | 747 | Mark Brown | broonie@opensource.wolfsonmicro.com | 1326065851 |  | mfd: Convert MFD drivers to use module_platform_driver  Factors out some boilerplate code for drivers doing the default thing for platform driver registration. Drivers using platform_driver_probe or an initcall other than module_init can't be converted.  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | max8997.c | s | 11K | 398 | Donggeun Kim | dg77.kim@samsung.com | 1326065861 |  | mfd: Add platform data and devices for MAX8997 LED control  MAX8997 device does not support LED control function of it. To enable MAX8997-LED driver, platform data and devices for LED are updated.  Signed-off-by: Donggeun Kim <dg77.kim@samsung.com> Signed-off-by: MyungJoo Ham <myungjoo.ham@samsung.com> Signed-off-by: Kyungmin Park <kyungmin.park@samsung.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | tps65911-comparator.c | s | 4.5K | 157 | Thomas Weber | thomas@tweber.de | 1333670303 |  | Fix typo milivolt => millivolt  Signed-off-by: Thomas Weber <thomas@tweber.de> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | wm8350-core.c | s | 17K | 657 | Mark Brown | broonie@opensource.wolfsonmicro.com | 1336383128 |  | mfd: Convert wm8350 physical I/O to regmap API  The driver still uses a custom cache implementation but the underlying physical I/O is now done using the regmap API, saving some code and avoiding allocating enormous scratch arrays on the stack.  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | jz4740-adc.c | s | 7.9K | 274 | Axel Lin | axel.lin@gmail.com | 1326065856 |  | mfd: Don't declare jz4740_adc_cells const  Remove the const keyword to fix below warning:    CC      drivers/mfd/jz4740-adc.o drivers/mfd/jz4740-adc.c: In function 'jz4740_adc_probe': drivers/mfd/jz4740-adc.c:290: warning: passing argument 3 of 'mfd_add_devices' discards qualifiers from pointer target type include/linux/mfd/core.h:93: note: expected 'struct mfd_cell *' but argument is of type 'const struct mfd_cell *'  Also make jz4740_adc_cells static, is not used outside this driver so no need to make the symbol global.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | timberdale.c | s | 22K | 814 | Axel Lin | axel.lin@gmail.com | 1326065857 |  | mfd: Convert to DEFINE_PCI_DEVICE_TABLE  Convert static struct pci_device_id *[] to static DEFINE_PCI_DEVICE_TABLE tables.  Cc: Andres Salomon <dilinger@queued.net> Cc: Denis Turischev <denis@compulab.co.il> Cc: Ben Dooks <ben@simtec.co.uk> Cc: Vincent Sanders <vince@simtec.co.uk> Cc: Mocean Laboratories <info@mocean-labs.com> Cc: Harald Welte <HaraldWelte@viatech.com> Signed-off-by: Axel Lin <axel.lin@gmail.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | ucb1400_core.c | s | 3.5K | 132 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | tps65910-irq.c | s | 6.5K | 219 | Rhyland Klein | rklein@nvidia.com | 1337527628 |  | mfd: Add tps65910-irq devicetree init and irqdomain support  This change changes the tps65910-irq code to use irqdomain, and support initialization from devicetree. This assumes that the irq_base in the platform data is -1 if devicetree is used.  Signed-off-by: Rhyland Klein <rklein@nvidia.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | twl6040-irq.c | s | 5.2K | 173 | Peter Ujfalusi | peter.ujfalusi@ti.com | 1337527632 |  | mfd: Add support for Device Tree to twl6040  Device tree based probing support for the core twl6040 driver. Child devices will be created as MFD devices: - ASoC codec is always created - Vibra child is only created if the vibra section present in the DT blob.  Signed-off-by: Peter Ujfalusi <peter.ujfalusi@ti.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | pm8921-core.c | s | 5.4K | 177 | Abhijeet Dharmapurikar | adharmap@codeaurora.org | 1306431928 |  | mfd: Add pm8xxx irq support  Add support for the irq controller in Qualcomm 8xxx pmic. The 8xxx interrupt controller provides control for gpio and mpp configured as interrupts in addition to other subdevice interrupts. The interrupt controller also provides a way to read the real time status of an interrupt. This real time status is the only way one can get the input values of gpio and mpp lines.  Signed-off-by: Abhijeet Dharmapurikar <adharmap@codeaurora.org> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | ab5500-core.h | s | 2.5K | 78 | Linus Walleij | linus.walleij@linaro.org | 1319458156 |  | mfd: Break out ab5500 debugfs code  This breaks the debugfs portions of the AB5500 driver into its own file. Split off a _raw function to access registers since we don't want to expose a generically named function globally. Move all required data structures to a shared ab5500-core.h file.  Cc: Mattias Wallin <mattias.wallin@stericsson.com> Signed-off-by: Linus Walleij <linus.walleij@linaro.org> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | Kconfig | g | 28K |  | Linus Torvalds | torvalds@linux-foundation.org | 1338317591 |  | 
f | adp5520.c | s | 8.5K | 307 | Axel Lin | axel.lin@gmail.com | 1324403455 |  | mfd: Set adp5520 bits if new value is different from the old one  Current code checks if all the bit_mask bits are all zero is wrong. We need to write new value if the bit mask fields of new value is not equal to old value.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: Michael Hennerich <michael.hennerich@analog.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | abx500-core.c | s | 3.9K | 133 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103924 |  | mfd: Add module.h to the implicit drivers/mfd users  With the pending module.h cleanup, these files will fail to compile, unless they explicitly call out the include of this file.  [omap-usb-host addition courtesy of Anand Gadiyar <gadiyar@ti.com>]  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | pcf50633-adc.c | s | 5.9K | 198 | Mark Brown | broonie@opensource.wolfsonmicro.com | 1326065851 |  | mfd: Convert MFD drivers to use module_platform_driver  Factors out some boilerplate code for drivers doing the default thing for platform driver registration. Drivers using platform_driver_probe or an initcall other than module_init can't be converted.  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | wm831x-spi.c | s | 2.9K | 102 | Linus Torvalds | torvalds@linux-foundation.org | 1332968195 |  | 
f | tps65912-i2c.c | s | 3.1K | 115 | Axel Lin | axel.lin@gmail.com | 1312147705 |  | mfd: Fix off-by-one value range checking for tps65912_i2c_write  If bytes == (TPS6591X_MAX_REGISTER + 1), we have a buffer overflow when doing memcpy(&msg[1], src, bytes).  Signed-off-by: Axel Lin <axel.lin@gmail.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | twl4030-audio.c | s | 6.5K | 222 | Mark Brown | broonie@opensource.wolfsonmicro.com | 1326065851 |  | mfd: Convert MFD drivers to use module_platform_driver  Factors out some boilerplate code for drivers doing the default thing for platform driver registration. Drivers using platform_driver_probe or an initcall other than module_init can't be converted.  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | max8925-i2c.c | s | 5.4K | 194 | Kevin Liu | kliu5@marvell.com | 1326067414 |  | mfd: Add pm ops to max8925  Signed-off-by: Kevin Liu <kliu5@marvell.com> Signed-off-by: Haojian Zhuang <haojian.zhuang@marvell.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | twl6040-core.c | s | 17K | 615 | Samuel Ortiz | sameo@linux.intel.com | 1337783054 |  | mfd: Fix twl6040 build failure  Without it we get:   CC      drivers/mfd/twl6040-core.o drivers/mfd/twl6040-core.c: In function ‘twl6040_has_vibra’: drivers/mfd/twl6040-core.c:55:2: error: implicit declaration of function ‘of_find_node_by_name’ [-Werror=implicit-function-declaration]  Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | ucb1x00-assabet.c | s | 2.9K | 89 | Russell King | rmk+kernel@arm.linux.org.uk | 1329606944 |  | MFD: ucb1x00-assabet: add support for UCB1x00 GPIO switches  Add support for UCB1x00 GPIO buttons found on the Assabet platform. We can now trivially support these buttons as we have standardized gpiolib, genirq and gpio keyboard support in place for this device.  Acked-by: Jochen Friedrich <jochen@scram.de> Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
f | ab3100-otp.c | s | 6.8K | 234 | Axel Lin | axel.lin@gmail.com | 1281605237 |  | mfd: Fix memory leak in ab3100_otp_probe  In current implementation, there is a memory leak if ab3100_otp_read fail. And in the case of ab3100_otp_init_debugfs fail, it does not properly remove sysfs entries. This patch properly handle above failure cases.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: Linus Walleij <linus.walleij@stericsson.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | timberdale.h | s | 3.4K | 112 | Richard RÃ¶jfors | richard.rojfors@pelagicore.com | 1293617806 |  | [media] mfd: Add timberdale video-in driver to timberdale  This patch defines platform data for the video-in driver and adds it to all configurations of timberdale.  Signed-off-by: Richard Röjfors <richard.rojfors@pelagicore.com> Acked-by: Samuel Ortiz <sameo@linux.intel.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | da9052-core.c | s | 19K | 780 | Linus Torvalds | torvalds@linux-foundation.org | 1338317591 |  | 
f | wm8994-core.c | s | 17K | 648 | Mark Brown | broonie@opensource.wolfsonmicro.com | 1336383129 |  | mfd: Convert wm8994 to module_i2c_driver()  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | davinci_voicecodec.c | s | 4.9K | 161 | Samuel Ortiz | sameo@linux.intel.com | 1306431913 |  | mfd: Use mfd cell platform_data for davinci cells platform bits  With the addition of a platform device mfd_cell pointer, MFD drivers can go back to passing platform back to their sub drivers. This allows for an mfd_cell->mfd_data removal and thus keep the sub drivers MFD agnostic. This is mostly needed for non MFD aware sub drivers.  Cc: Miguel Aguilar <miguel.aguilar@ridgerun.com> Cc: Mark Brown <broonie@opensource.wolfsonmicro.com> Cc: Liam Girdwood <lrg@slimlogic.co.uk> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | sta2x11-mfd.c | s | 11K | 401 | Alessandro Rubini | rubini@gnudd.com | 1336570468 |  | mfd: Add driver for STA2X11 MFD block  This also introduces <asm/sta2x11.h> to export a function that is in the base sta2x11 support patches. The header will increase with other prototypes and constants over time.  Signed-off-by: Alessandro Rubini <rubini@gnudd.com> Acked-by: Giancarlo Asnaghi <giancarlo.asnaghi@st.com> Cc: Alan Cox <alan@linux.intel.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | tps65910.c | s | 7.2K | 249 | Laxman Dewangan | ldewangan@nvidia.com | 1337723392 |  | mfd: Remove the parsing of dt info for tps65910 gpio  Remove the parsing of device node information for sub devices from core file. The sub devices will parse the information as per the sub-devices specific information.  Signed-off-by: Laxman Dewangan <ldewangan@nvidia.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | ab8500-debugfs.c | s | 12K | 585 | Lee Jones | lee.jones@linaro.org | 1337527630 |  | mfd: Enable ab8500-debug when Device Tree is enabled  Allow the ab8500-debugfs driver to be probed during DT start-up.  Signed-off-by: Lee Jones <lee.jones@linaro.org> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | s5m-irq.c | s | 10K | 439 | Jonghwan Choi | jhbird.choi@samsung.com | 1331055995 |  | mfd: Fix s5m error handling for invalid device type  If device type is not supported in driver, have to retun error.  Signed-off-by: Jonghwan Choi <jhbird.choi@samsung.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | tps65010.c | s | 28K | 899 | Axel Lin | axel.lin@gmail.com | 1295005056 |  | mfd: Include <linux/gpio.h> instead of <asm/gpio.h>  As warned by checkpatch.pl, use #include <linux/gpio.h> instead of <asm/gpio.h>.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | da9052-spi.c | s | 2.4K | 89 | Axel Lin | axel.lin@gmail.com | 1337527623 |  | mfd: Convert da9052 to use devm_* APIs  Signed-off-by: Axel Lin <axel.lin@gmail.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | wm831x-irq.c | s | 15K | 607 | Mark Brown | broonie@opensource.wolfsonmicro.com | 1337527634 |  | mfd: Emulate active low IRQs as well as active high IRQs for wm831x  As with the existing emulation this should not be used in production systems but is useful for test purposes.  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | tc6393xb.c | s | 21K | 701 | Samuel Ortiz | sameo@linux.intel.com | 1306431904 |  | mtd: Use platform_data to retrieve tmio_nand platform bits  With the addition of the platform device mfd_cell pointer, we can now cleanly pass the sub device drivers platform data pointers through the regular device platform_data one, and get rid of mfd_get_data().  Cc: Ian Molton <spyro@f2s.com> Cc: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Acked-by: Dmitry Eremin-Solenikov <dbaryshkov@gmail.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | tc6387xb.c | s | 5.5K | 193 | Mark Brown | broonie@opensource.wolfsonmicro.com | 1326065851 |  | mfd: Convert MFD drivers to use module_platform_driver  Factors out some boilerplate code for drivers doing the default thing for platform driver registration. Drivers using platform_driver_probe or an initcall other than module_init can't be converted.  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | lm3533-core.c | s | 14K | 536 | Johan Hovold | jhovold@gmail.com | 1337527634 |  | mfd: Mark two lm3533 zone registers as volatile  Mark the two currently unused zone registers as volatile in regmap for completeness.  Signed-off-by: Johan Hovold <jhovold@gmail.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | wm8994.h | s | 717B | 21 | Mark Brown | broonie@opensource.wolfsonmicro.com | 1323706273 |  | mfd: Initialise WM8994 register cache after reading chip ID registers  The different devices handled by the WM8994 can be distinguished using their ID registers so we don't need to rely on the user having registered the device correctly. Instead do the initial regmap setup with a minimal configuration only supporting physical I/O and then configure the cache once we have identified the device.  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Acked-by: Samuel Ortiz <sameo@linux.intel.com>
f | intel_msic.c | s | 11K | 410 | Pasi Savanainen | ext-pasi.m.savanainen@nokia.com | 1335866423 |  | mfd: Convert Intel MSIC driver to use devm_* interfaces.  The devm_* functions eliminate the need for manual resource releasing and simplify error handling. Resources allocated by devm_* are freed automatically on driver detach.  Signed-off-by: Pasi Savanainen <ext-pasi.m.savanainen@gmail.com> Acked-by: Mika Westerberg <mika.westerberg@linux.intel.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | rdc321x-southbridge.c | s | 3.1K | 101 | Axel Lin | axel.lin@gmail.com | 1335866421 |  | mfd: Use module_pci_driver  This patch converts the drivers in drivers/mfd/* to use module_pci_driver() macro which makes the code smaller and a bit simpler.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Cc: Andres Salomon <dilinger@queued.net> Cc: Ira W. Snyder <iws@ovro.caltech.edu> Cc: Florian Fainelli <florian@openwrt.org> Cc: Denis Turischev <denis@compulab.co.il> Cc: Harald Welte <HaraldWelte@viatech.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | lm3533-ctrlbank.c | s | 3.7K | 121 | Johan Hovold | jhovold@gmail.com | 1337527622 |  | mfd: Use SI-units for the lm3533 max-current interface  Use SI-units (uA) for max-current interface (5000 - 29800 uA).  Signed-off-by: Johan Hovold <jhovold@gmail.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | ab8500-gpadc.c | s | 18K | 602 | Lee Jones | lee.jones@linaro.org | 1337527631 |  | mfd: Enable ab8500-gpadc driver for Device Tree  This patch will allow the ab8500-gpadc driver to be probed during Device Tree enabled boot.  Signed-off-by: Lee Jones <lee.jones@linaro.org> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | mcp-core.c | s | 5.6K | 205 | Linus Torvalds | torvalds@linux-foundation.org | 1332975501 |  | 
f | aat2870-core.c | s | 12K | 440 | Stephen Boyd | sboyd@codeaurora.org | 1333664750 |  | simple_open: automatically convert to simple_open()  Many users of debugfs copy the implementation of default_open() when they want to support a custom read/write function op.  This leads to a proliferation of the default_open() implementation across the entire tree.  Now that the common implementation has been consolidated into libfs we can replace all the users of this function with simple_open().  This replacement was done with the following semantic patch:  <smpl> @ open @ identifier open_f != simple_open; identifier i, f; @@ -int open_f(struct inode *i, struct file *f) -{ ( -if (i->i_private) -f->private_data = i->i_private; || -f->private_data = i->i_private; ) -return 0; -}  @ has_open depends on open @ identifier fops; identifier open.open_f; @@ struct file_operations fops = { ... -.open = open_f, +.open = simple_open, ... }; </smpl>  [akpm@linux-foundation.org: checkpatch fixes] Signed-off-by: Stephen Boyd <sboyd@codeaurora.org> Cc: Greg Kroah-Hartman <gregkh@linuxfoundation.org> Cc: Al Viro <viro@zeniv.linux.org.uk> Cc: Julia Lawall <Julia.Lawall@lip6.fr> Acked-by: Ingo Molnar <mingo@elte.hu> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
