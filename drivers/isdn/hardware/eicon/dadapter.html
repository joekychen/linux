<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › isdn › hardware › eicon › dadapter.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>dadapter.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> *</span>
<span class="cm"> Copyright (c) Eicon Networks, 2002.</span>
<span class="cm"> *</span>
<span class="cm"> This source file is supplied for the use with</span>
<span class="cm"> Eicon Networks range of DIVA Server Adapters.</span>
<span class="cm"> *</span>
<span class="cm"> Eicon File Revision :    2.1</span>
<span class="cm"> *</span>
<span class="cm"> This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> it under the terms of the GNU General Public License as published by</span>
<span class="cm"> the Free Software Foundation; either version 2, or (at your option)</span>
<span class="cm"> any later version.</span>
<span class="cm"> *</span>
<span class="cm"> This program is distributed in the hope that it will be useful,</span>
<span class="cm"> but WITHOUT ANY WARRANTY OF ANY KIND WHATSOEVER INCLUDING ANY</span>
<span class="cm"> implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span>
<span class="cm"> See the GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> You should have received a copy of the GNU General Public License</span>
<span class="cm"> along with this program; if not, write to the Free Software</span>
<span class="cm"> Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="cp">#ifndef __DIVA_DIDD_DADAPTER_INC__</span>
<span class="cp">#define __DIVA_DIDD_DADAPTER_INC__</span>

<span class="kt">void</span> <span class="n">diva_didd_load_time_init</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">diva_didd_load_time_finit</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cp">#define NEW_MAX_DESCRIPTORS     64</span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
">;</span>
<span class="p">}</span> <span class="n">didd_adapter_change_notification_t</span><span class="p">,</span>				\
	<span class="o">*</span> <span class="n">IDI_CALL_ENTITY_T</span> <span class="n">pdidd_adapter_change_notification_t</span><span class="p">;</span>
<span class="cp">#define DIVA_DIDD_MAX_NOTIFICATIONS 256</span>
<span class="k">static</span> <span class="n">didd_adapter_change_notification_t</span>	\
<span class="n">NotificationTable</span><span class="p">[</span><span class="n">DIVA_DIDD_MAX_NOTIFICATIONS</span><span class="p">];</span>
<span class="cm">/* --------------------------------------------------------------------------</span>
<span class="cm">   Array to held adapter information</span>
<span class="cm">   -------------------------------------------------------------------------- */</span>
<span class="k">static</span> <span class="n">DESCRIPTOR</span>  <span class="n">HandleTable</span><span class="p">[</span><span class="n">NEW_MAX_DESCRIPTORS</span><span class="p">];</span>
<span class="k">static</span> <span class="n">dword</span> <span class="n">Adapters</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="cm">/* Number of adapters */</span>
<span class="cm">/* --------------------------------------------------------------------------</span>
<span class="cm">   Shadow IDI_DIMAINT</span>
<span class="cm">   and &#39;shadow&#39; debug stuff</span>
<span class="cm">   -------------------------------------------------------------------------- */</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">no_printf</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">format</span><span class="p">,</span> <span class="p">...)</span>
<span class="p">{</span>
<span class="cp">#ifdef EBUG</span>
	<span class="kt">va_list</span> <span class="n">ap</span><span class="p">;</span>
	<span class="n">va_start</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="n">format</span><span class="p">);</span>
	<span class="n">debug</span><span class="p">((</span><span class="n">format</span><span class="p">,</span> <span class="n">ap</span><span class="p">));</span>
	<span class="n">va_end</span><span class="p">(</span><span class="n">ap</span><span class="p">);</span>
<span class="cp">#endif</span>
<span class="p">}</span>

<span class="cm">/* -------------------------------------------------------------------------</span>
<span class="cm">   Portable debug Library</span>
<span class="cm">   ------------------------------------------------------------------------- */</span>
<span class="cp">#include &quot;debuglib.c&quot;</span>

<span class="k">static</span> <span class="n">DESCRIPTOR</span>  <span class="n">MAdapter</span> <span class="o">=</span>  <span class="p">{</span><span class="n">IDI_DIMAINT</span><span class="p">,</span> <span class="cm">/* Adapter Type */</span>
				<span class="mh">0x00</span><span class="p">,</span>     <span class="cm">/* Channels */</span>
				<span class="mh">0x0000</span><span class="p">,</span>    <span class="cm">/* Features */</span>
				<span class="p">(</span><span class="n">IDI_CALL</span><span class="p">)</span><span class="n">no_printf</span><span class="p">};</span>
<span class="cm">/* --------------------------------------------------------------------------</span>
<span class="cm">   DAdapter. Only IDI clients with buffer, that is huge enough to</span>
<span class="cm">   get all descriptors will receive information about DAdapter</span>
<span class="cm">   { byte type, byte channels, word features, IDI_CALL request }</span>
<span class="cm">   -------------------------------------------------------------------------- */</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">IDI_CALL_LINK_T</span> <span class="n">diva_dadapter_request</span><span class="p">(</span><span class="n">ENTITY</span> <span class="n">IDI_CALL_ENTITY_T</span> <span class="o">*</span><span class="p">);</span>
<span class="k">static</span> <span class="n">DESCRIPTOR</span>  <span class="n">DAdapter</span> <span class="o">=</span>  <span class="p">{</span><span class="n">IDI_DADAPTER</span><span class="p">,</span> <span class="cm">/* Adapter Type */</span>
				<span class="mh">0x00</span><span class="p">,</span>     <span class="cm">/* Channels */</span>
				<span class="mh">0x0000</span><span class="p">,</span>    <span class="cm">/* Features */</span>
				<span class="n">diva_dadapter_request</span> <span class="p">};</span>
<span class="cm">/* --------------------------------------------------------------------------</span>
<span class="cm">   LOCALS</span>
<span class="cm">   -------------------------------------------------------------------------- */</span>
<span class="k">static</span> <span class="n">dword</span> <span class="n">diva_register_adapter_callback</span><span class="p">(</span>\
	<span class="n">didd_adapter_change_callback_t</span> <span class="n">callback</span><span class="p">,</span>
	<span class="kt">void</span> <span class="n">IDI_CALL_ENTITY_T</span> <span class="o">*</span><span class="n">context</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">diva_remove_adapter_callback</span><span class="p">(</span><span class="n">dword</span> <span class="n">handle</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">diva_notify_adapter_change</span><span class="p">(</span><span class="n">DESCRIPTOR</span> <span class="o">*</span><span class="n">d</span><span class="p">,</span> <span class="kt">int</span> <span class="n">removal</span><span class="p">);</span>
<span class="k">static</span> <span class="n">diva_os_spin_lock_t</span> <span class="n">didd_spin</span><span class="p">;</span>
<span class="cm">/* --------------------------------------------------------------------------</span>
<span class="cm">   Should be called as first step, after driver init</span>
<span class="cm">   -------------------------------------------------------------------------- */</span>
<span class="kt">void</span> <span class="nf">diva_didd_load_time_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">HandleTable</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mh">0x00</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">HandleTable</span><span class="p">));</span>
	<span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">NotificationTable</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mh">0x00</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">NotificationTable</span><span class="p">));</span>
	<span class="n">diva_os_initialize_spin_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">didd_spin</span><span class="p">,</span> <span class="s">&quot;didd&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="cm">/* --------------------------------------------------------------------------</span>
<span class="cm">   Should be called as last step, if driver does unload</span>
<span class="cm">   -------------------------------------------------------------------------- */</span>
<span class="kt">void</span> <span class="nf">diva_didd_load_time_finit</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">diva_os_destroy_spin_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">didd_spin</span><span class="p">,</span> <span class="s">&quot;didd&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="cm">/* --------------------------------------------------------------------------</span>
<span class="cm">   Called in order to register new adapter in adapter array</span>
<span class="cm">   return adapter handle (&gt; 0) on success</span>
<span class="cm">   return -1 adapter array overflow</span>
<span class="cm">   -------------------------------------------------------------------------- */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">diva_didd_add_descriptor</span><span class="p">(</span><span class="n">DESCRIPTOR</span> <span class="o">*</span><span class="n">d</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">diva_os_spin_lock_magic_t</span>      <span class="n">irql</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">d</span><span class="o">-&gt;</span><span class="n">type</span> <span class="o">==</span> <span class="n">IDI_DIMAINT</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">d</span><span class="o">-&gt;</span><span class="n">request</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">MAdapter</span><span class="p">.</span><span class="n">request</span> <span class="o">=</span> <span class="n">d</span><span class="o">-&gt;</span><span class="n">request</span><span class="p">;</span>
			<span class="n">dprintf</span> <span class="o">=</span> <span class="p">(</span><span class="n">DIVA_DI_PRINTF</span><span class="p">)</span><span class="n">d</span><span class="o">-&gt;</span><span class="n">request</span><span class="p">;</span>
			<span class="n">diva_notify_adapter_change</span><span class="p">(</span><span class="o">&amp;</span><span class="n">MAdapter</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> <span class="cm">/* Inserted */</span>
			<span class="n">DBG_TRC</span><span class="p">((</span><span class="s">&quot;DIMAINT registered, dprintf=%08x&quot;</span><span class="p">,</span> <span class="n">d</span><span class="o">-&gt;</span><span class="n">request</span><span class="p">))</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">DBG_TRC</span><span class="p">((</span><span class="s">&quot;DIMAINT removed&quot;</span><span class="p">))</span>
				<span class="n">diva_notify_adapter_change</span><span class="p">(</span><span class="o">&amp;</span><span class="n">MAdapter</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="cm">/* About to remove */</span>
			<span class="n">MAdapter</span><span class="p">.</span><span class="n">request</span> <span class="o">=</span> <span class="p">(</span><span class="n">IDI_CALL</span><span class="p">)</span><span class="n">no_printf</span><span class="p">;</span>
			<span class="n">dprintf</span> <span class="o">=</span> <span class="n">no_printf</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="p">(</span><span class="n">NEW_MAX_DESCRIPTORS</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">NEW_MAX_DESCRIPTORS</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">diva_os_enter_spin_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">didd_spin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">irql</span><span class="p">,</span> <span class="s">&quot;didd_add&quot;</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">HandleTable</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">type</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">memcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">HandleTable</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">d</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">d</span><span class="p">));</span>
			<span class="n">Adapters</span><span class="o">++</span><span class="p">;</span>
			<span class="n">diva_os_leave_spin_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">didd_spin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">irql</span><span class="p">,</span> <span class="s">&quot;didd_add&quot;</span><span class="p">);</span>
			<span class="n">diva_notify_adapter_change</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> <span class="cm">/* we have new adapter */</span>
			<span class="n">DBG_TRC</span><span class="p">((</span><span class="s">&quot;Add adapter[%d], request=%08x&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">d</span><span class="o">-&gt;</span><span class="n">request</span><span class="p">))</span>
				<span class="k">return</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">diva_os_leave_spin_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">didd_spin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">irql</span><span class="p">,</span> <span class="s">&quot;didd_add&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">DBG_ERR</span><span class="p">((</span><span class="s">&quot;Can&#39;t add adapter, out of resources&quot;</span><span class="p">))</span>
		<span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
<span class="cm">/* --------------------------------------------------------------------------</span>
<span class="cm">   Called in order to remove one registered adapter from array</span>
<span class="cm">   return adapter handle (&gt; 0) on success</span>
<span class="cm">   return 0 on success</span>
<span class="cm">   -------------------------------------------------------------------------- */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">diva_didd_remove_descriptor</span><span class="p">(</span><span class="n">IDI_CALL</span> <span class="n">request</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">diva_os_spin_lock_magic_t</span>      <span class="n">irql</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">request</span> <span class="o">==</span> <span class="n">MAdapter</span><span class="p">.</span><span class="n">request</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DBG_TRC</span><span class="p">((</span><span class="s">&quot;DIMAINT removed&quot;</span><span class="p">))</span>
			<span class="n">dprintf</span> <span class="o">=</span> <span class="n">no_printf</span><span class="p">;</span>
		<span class="n">diva_notify_adapter_change</span><span class="p">(</span><span class="o">&amp;</span><span class="n">MAdapter</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="cm">/* About to remove */</span>
		<span class="n">MAdapter</span><span class="p">.</span><span class="n">request</span> <span class="o">=</span> <span class="p">(</span><span class="n">IDI_CALL</span><span class="p">)</span><span class="n">no_printf</span><span class="p">;</span>
		<span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">(</span><span class="n">Adapters</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">NEW_MAX_DESCRIPTORS</span><span class="p">));</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">HandleTable</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">request</span> <span class="o">==</span> <span class="n">request</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">diva_notify_adapter_change</span><span class="p">(</span><span class="o">&amp;</span><span class="n">HandleTable</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">);</span> <span class="cm">/* About to remove */</span>
			<span class="n">diva_os_enter_spin_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">didd_spin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">irql</span><span class="p">,</span> <span class="s">&quot;didd_rm&quot;</span><span class="p">);</span>
			<span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">HandleTable</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mh">0x00</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">HandleTable</span><span class="p">[</span><span class="mi">0</span><span class="p">]));</span>
			<span class="n">Adapters</span><span class="o">--</span><span class="p">;</span>
			<span class="n">diva_os_leave_spin_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">didd_spin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">irql</span><span class="p">,</span> <span class="s">&quot;didd_rm&quot;</span><span class="p">);</span>
			<span class="n">DBG_TRC</span><span class="p">((</span><span class="s">&quot;Remove adapter[%d], request=%08x&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">request</span><span class="p">))</span>
				<span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">DBG_ERR</span><span class="p">((</span><span class="s">&quot;Invalid request=%08x, can&#39;t remove adapter&quot;</span><span class="p">,</span> <span class="n">request</span><span class="p">))</span>
		<span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
<span class="cm">/* --------------------------------------------------------------------------</span>
<span class="cm">   Read adapter array</span>
<span class="cm">   return 1 if not enough space to save all available adapters</span>
<span class="cm">   -------------------------------------------------------------------------- */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">diva_didd_read_adapter_array</span><span class="p">(</span><span class="n">DESCRIPTOR</span> <span class="o">*</span><span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">length</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">diva_os_spin_lock_magic_t</span>      <span class="n">irql</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">;</span>
	<span class="n">memset</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="n">length</span><span class="p">);</span>
	<span class="n">length</span> <span class="o">/=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">DESCRIPTOR</span><span class="p">);</span>
	<span class="n">DBG_TRC</span><span class="p">((</span><span class="s">&quot;DIDD_Read, space = %d, Adapters = %d&quot;</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">Adapters</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span>

		<span class="n">diva_os_enter_spin_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">didd_spin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">irql</span><span class="p">,</span> <span class="s">&quot;didd_read&quot;</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">src</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dst</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	     <span class="p">(</span><span class="n">Adapters</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">src</span> <span class="o">&lt;</span> <span class="n">NEW_MAX_DESCRIPTORS</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">dst</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">));</span>
	     <span class="n">src</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">HandleTable</span><span class="p">[</span><span class="n">src</span><span class="p">].</span><span class="n">type</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">memcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buffer</span><span class="p">[</span><span class="n">dst</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">HandleTable</span><span class="p">[</span><span class="n">src</span><span class="p">],</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">DESCRIPTOR</span><span class="p">));</span>
			<span class="n">dst</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">diva_os_leave_spin_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">didd_spin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">irql</span><span class="p">,</span> <span class="s">&quot;didd_read&quot;</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">dst</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">memcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buffer</span><span class="p">[</span><span class="n">dst</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">MAdapter</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">DESCRIPTOR</span><span class="p">));</span>
		<span class="n">dst</span><span class="o">++</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">DBG_ERR</span><span class="p">((</span><span class="s">&quot;Can&#39;t write DIMAINT. Array too small&quot;</span><span class="p">))</span>
			<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">dst</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">memcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buffer</span><span class="p">[</span><span class="n">dst</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">DAdapter</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">DESCRIPTOR</span><span class="p">));</span>
		<span class="n">dst</span><span class="o">++</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">DBG_ERR</span><span class="p">((</span><span class="s">&quot;Can&#39;t write DADAPTER. Array too small&quot;</span><span class="p">))</span>
			<span class="p">}</span>
	<span class="n">DBG_TRC</span><span class="p">((</span><span class="s">&quot;Read %d adapters&quot;</span><span class="p">,</span> <span class="n">dst</span><span class="p">))</span>
		<span class="k">return</span> <span class="p">(</span><span class="n">dst</span> <span class="o">==</span> <span class="n">length</span><span class="p">);</span>
<span class="p">}</span>
<span class="cm">/* --------------------------------------------------------------------------</span>
<span class="cm">   DAdapter request function.</span>
<span class="cm">   This function does process only synchronous requests, and is used</span>
<span class="cm">   for reception/registration of new interfaces</span>
<span class="cm">   -------------------------------------------------------------------------- */</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">IDI_CALL_LINK_T</span> <span class="nf">diva_dadapter_request</span><span class="p">(</span>	\
	<span class="n">ENTITY</span> <span class="n">IDI_CALL_ENTITY_T</span> <span class="o">*</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">IDI_SYNC_REQ</span> <span class="o">*</span><span class="n">syncReq</span> <span class="o">=</span> <span class="p">(</span><span class="n">IDI_SYNC_REQ</span> <span class="o">*</span><span class="p">)</span><span class="n">e</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="o">-&gt;</span><span class="n">Req</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* We do not process it, also return error */</span>
		<span class="n">e</span><span class="o">-&gt;</span><span class="n">Rc</span> <span class="o">=</span> <span class="n">OUT_OF_RESOURCES</span><span class="p">;</span>
		<span class="n">DBG_ERR</span><span class="p">((</span><span class="s">&quot;Can&#39;t process async request, Req=%02x&quot;</span><span class="p">,</span> <span class="n">e</span><span class="o">-&gt;</span><span class="n">Req</span><span class="p">))</span>
			<span class="k">return</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="cm">/*</span>
<span class="cm">	  So, we process sync request</span>
<span class="cm">	*/</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">e</span><span class="o">-&gt;</span><span class="n">Rc</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">IDI_SYNC_REQ_DIDD_REGISTER_ADAPTER_NOTIFY</span>: <span class="p">{</span>
		<span class="n">diva_didd_adapter_notify_t</span> <span class="o">*</span><span class="n">pinfo</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">syncReq</span><span class="o">-&gt;</span><span class="n">didd_notify</span><span class="p">.</span><span class="n">info</span><span class="p">;</span>
		<span class="n">pinfo</span><span class="o">-&gt;</span><span class="n">handle</span> <span class="o">=</span> <span class="n">diva_register_adapter_callback</span><span class="p">(</span>		\
			<span class="p">(</span><span class="n">didd_adapter_change_callback_t</span><span class="p">)</span><span class="n">pinfo</span><span class="o">-&gt;</span><span class="n">callback</span><span class="p">,</span>
			<span class="p">(</span><span class="kt">void</span> <span class="n">IDI_CALL_ENTITY_T</span> <span class="o">*</span><span class="p">)</span><span class="n">pinfo</span><span class="o">-&gt;</span><span class="n">context</span><span class="p">);</span>
		<span class="n">e</span><span class="o">-&gt;</span><span class="n">Rc</span> <span class="o">=</span> <span class="mh">0xff</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IDI_SYNC_REQ_DIDD_REMOVE_ADAPTER_NOTIFY</span>: <span class="p">{</span>
		<span class="n">diva_didd_adapter_notify_t</span> <span class="o">*</span><span class="n">pinfo</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">syncReq</span><span class="o">-&gt;</span><span class="n">didd_notify</span><span class="p">.</span><span class="n">info</span><span class="p">;</span>
		<span class="n">diva_remove_adapter_callback</span><span class="p">(</span><span class="n">pinfo</span><span class="o">-&gt;</span><span class="n">handle</span><span class="p">);</span>
		<span class="n">e</span><span class="o">-&gt;</span><span class="n">Rc</span> <span class="o">=</span> <span class="mh">0xff</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IDI_SYNC_REQ_DIDD_ADD_ADAPTER</span>: <span class="p">{</span>
		<span class="n">diva_didd_add_adapter_t</span> <span class="o">*</span><span class="n">pinfo</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">syncReq</span><span class="o">-&gt;</span><span class="n">didd_add_adapter</span><span class="p">.</span><span class="n">info</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">diva_didd_add_descriptor</span><span class="p">((</span><span class="n">DESCRIPTOR</span> <span class="o">*</span><span class="p">)</span><span class="n">pinfo</span><span class="o">-&gt;</span><span class="n">descriptor</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">e</span><span class="o">-&gt;</span><span class="n">Rc</span> <span class="o">=</span> <span class="n">OUT_OF_RESOURCES</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">e</span><span class="o">-&gt;</span><span class="n">Rc</span> <span class="o">=</span> <span class="mh">0xff</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span> <span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IDI_SYNC_REQ_DIDD_REMOVE_ADAPTER</span>: <span class="p">{</span>
		<span class="n">diva_didd_remove_adapter_t</span> <span class="o">*</span><span class="n">pinfo</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">syncReq</span><span class="o">-&gt;</span><span class="n">didd_remove_adapter</span><span class="p">.</span><span class="n">info</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">diva_didd_remove_descriptor</span><span class="p">((</span><span class="n">IDI_CALL</span><span class="p">)</span><span class="n">pinfo</span><span class="o">-&gt;</span><span class="n">p_request</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">e</span><span class="o">-&gt;</span><span class="n">Rc</span> <span class="o">=</span> <span class="n">OUT_OF_RESOURCES</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">e</span><span class="o">-&gt;</span><span class="n">Rc</span> <span class="o">=</span> <span class="mh">0xff</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span> <span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IDI_SYNC_REQ_DIDD_READ_ADAPTER_ARRAY</span>: <span class="p">{</span>
		<span class="n">diva_didd_read_adapter_array_t</span> <span class="o">*</span><span class="n">pinfo</span> <span class="o">=</span>\
			<span class="o">&amp;</span><span class="n">syncReq</span><span class="o">-&gt;</span><span class="n">didd_read_adapter_array</span><span class="p">.</span><span class="n">info</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">diva_didd_read_adapter_array</span><span class="p">((</span><span class="n">DESCRIPTOR</span> <span class="o">*</span><span class="p">)</span><span class="n">pinfo</span><span class="o">-&gt;</span><span class="n">buffer</span><span class="p">,</span>
						  <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">pinfo</span><span class="o">-&gt;</span><span class="n">length</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">e</span><span class="o">-&gt;</span><span class="n">Rc</span> <span class="o">=</span> <span class="n">OUT_OF_RESOURCES</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">e</span><span class="o">-&gt;</span><span class="n">Rc</span> <span class="o">=</span> <span class="mh">0xff</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span> <span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="n">DBG_ERR</span><span class="p">((</span><span class="s">&quot;Can&#39;t process sync request, Req=%02x&quot;</span><span class="p">,</span> <span class="n">e</span><span class="o">-&gt;</span><span class="n">Rc</span><span class="p">))</span>
			<span class="n">e</span><span class="o">-&gt;</span><span class="n">Rc</span> <span class="o">=</span> <span class="n">OUT_OF_RESOURCES</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span>
<span class="cm">/* --------------------------------------------------------------------------</span>
<span class="cm">   IDI client does register his notification function</span>
<span class="cm">   -------------------------------------------------------------------------- */</span>
<span class="k">static</span> <span class="n">dword</span> <span class="nf">diva_register_adapter_callback</span><span class="p">(</span>		\
	<span class="n">didd_adapter_change_callback_t</span> <span class="n">callback</span><span class="p">,</span>
	<span class="kt">void</span> <span class="n">IDI_CALL_ENTITY_T</span> <span class="o">*</span><span class="n">context</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">diva_os_spin_lock_magic_t</span> <span class="n">irql</span><span class="p">;</span>
	<span class="n">dword</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">DIVA_DIDD_MAX_NOTIFICATIONS</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">diva_os_enter_spin_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">didd_spin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">irql</span><span class="p">,</span> <span class="s">&quot;didd_nfy_add&quot;</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">NotificationTable</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">callback</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">NotificationTable</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">callback</span> <span class="o">=</span> <span class="n">callback</span><span class="p">;</span>
			<span class="n">NotificationTable</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">context</span> <span class="o">=</span> <span class="n">context</span><span class="p">;</span>
			<span class="n">diva_os_leave_spin_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">didd_spin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">irql</span><span class="p">,</span> <span class="s">&quot;didd_nfy_add&quot;</span><span class="p">);</span>
			<span class="n">DBG_TRC</span><span class="p">((</span><span class="s">&quot;Register adapter notification[%d]=%08x&quot;</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">callback</span><span class="p">))</span>
				<span class="k">return</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">diva_os_leave_spin_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">didd_spin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">irql</span><span class="p">,</span> <span class="s">&quot;didd_nfy_add&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">DBG_ERR</span><span class="p">((</span><span class="s">&quot;Can&#39;t register adapter notification, overflow&quot;</span><span class="p">))</span>
		<span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
<span class="cm">/* --------------------------------------------------------------------------</span>
<span class="cm">   IDI client does register his notification function</span>
<span class="cm">   -------------------------------------------------------------------------- */</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">diva_remove_adapter_callback</span><span class="p">(</span><span class="n">dword</span> <span class="n">handle</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">diva_os_spin_lock_magic_t</span> <span class="n">irql</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">handle</span> <span class="o">&amp;&amp;</span> <span class="p">((</span><span class="o">--</span><span class="n">handle</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">DIVA_DIDD_MAX_NOTIFICATIONS</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">diva_os_enter_spin_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">didd_spin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">irql</span><span class="p">,</span> <span class="s">&quot;didd_nfy_rm&quot;</span><span class="p">);</span>
		<span class="n">NotificationTable</span><span class="p">[</span><span class="n">handle</span><span class="p">].</span><span class="n">callback</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
		<span class="n">NotificationTable</span><span class="p">[</span><span class="n">handle</span><span class="p">].</span><span class="n">context</span>  <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
		<span class="n">diva_os_leave_spin_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">didd_spin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">irql</span><span class="p">,</span> <span class="s">&quot;didd_nfy_rm&quot;</span><span class="p">);</span>
		<span class="n">DBG_TRC</span><span class="p">((</span><span class="s">&quot;Remove adapter notification[%d]&quot;</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="n">handle</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
			<span class="k">return</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">DBG_ERR</span><span class="p">((</span><span class="s">&quot;Can&#39;t remove adapter notification, handle=%d&quot;</span><span class="p">,</span> <span class="n">handle</span><span class="p">))</span>
		<span class="p">}</span>
<span class="cm">/* --------------------------------------------------------------------------</span>
<span class="cm">   Notify all client about adapter array change</span>
<span class="cm">   Does suppose following behavior in the client side:</span>
<span class="cm">   Step 1: Redister Notification</span>
<span class="cm">   Step 2: Read Adapter Array</span>
<span class="cm">   -------------------------------------------------------------------------- */</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">diva_notify_adapter_change</span><span class="p">(</span><span class="n">DESCRIPTOR</span> <span class="o">*</span><span class="n">d</span><span class="p">,</span> <span class="kt">int</span> <span class="n">removal</span><span class="p">)</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">do_notify</span><span class="p">;</span>
	<span class="n">didd_adapter_change_notification_t</span> <span class="n">nfy</span><span class="p">;</span>
	<span class="n">diva_os_spin_lock_magic_t</span> <span class="n">irql</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">DIVA_DIDD_MAX_NOTIFICATIONS</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">do_notify</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">diva_os_enter_spin_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">didd_spin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">irql</span><span class="p">,</span> <span class="s">&quot;didd_nfy&quot;</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">NotificationTable</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">callback</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">memcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">nfy</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">NotificationTable</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">nfy</span><span class="p">));</span>
			<span class="n">do_notify</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">diva_os_leave_spin_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">didd_spin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">irql</span><span class="p">,</span> <span class="s">&quot;didd_nfy&quot;</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">do_notify</span><span class="p">)</span> <span class="p">{</span>
			<span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">nfy</span><span class="p">.</span><span class="n">callback</span><span class="p">))(</span><span class="n">nfy</span><span class="p">.</span><span class="n">context</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">removal</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>
<span class="cm">/* --------------------------------------------------------------------------</span>
<span class="cm">   For all systems, that are linked by Kernel Mode Linker this is ONLY one</span>
<span class="cm">   function thet should be exported by this device driver</span>
<span class="cm">   IDI clients should look for IDI_DADAPTER, and use request function</span>
<span class="cm">   of this adapter (sync request) in order to receive appropriate services:</span>
<span class="cm">   - add new adapter</span>
<span class="cm">   - remove existing adapter</span>
<span class="cm">   - add adapter array notification</span>
<span class="cm">   - remove adapter array notification</span>
<span class="cm">   (read adapter is redundant in this case)</span>
<span class="cm">   INPUT:</span>
<span class="cm">   buffer - pointer to buffer that will receive adapter array</span>
<span class="cm">   length  - length (in bytes) of space in buffer</span>
<span class="cm">   OUTPUT:</span>
<span class="cm">   Adapter array will be written to memory described by &#39;buffer&#39;</span>
<span class="cm">   If the last adapter seen in the returned adapter array is</span>
<span class="cm">   IDI_DADAPTER or if last adapter in array does have type &#39;0&#39;, then</span>
<span class="cm">   it was enougth space in buffer to accommodate all available</span>
<span class="cm">   adapter descriptors</span>
<span class="cm">   *NOTE 1 (debug interface):</span>
<span class="cm">   The IDI adapter of type &#39;IDI_DIMAINT&#39; does register as &#39;request&#39;</span>
<span class="cm">   famous &#39;dprintf&#39; function (of type DI_PRINTF, please look</span>
<span class="cm">   include/debuglib.c and include/debuglib.h) for details.</span>
<span class="cm">   So dprintf is not exported from module debug module directly,</span>
<span class="cm">   instead of this IDI_DIMAINT is registered.</span>
<span class="cm">   Module load order will receive in this case:</span>
<span class="cm">   1. DIDD (this file)</span>
<span class="cm">   2. DIMAINT does load and register &#39;IDI_DIMAINT&#39;, at this step</span>
<span class="cm">   DIDD should be able to get &#39;dprintf&#39;, save it, and</span>
<span class="cm">   register with DIDD by means of &#39;dprintf&#39; function.</span>
<span class="cm">   3. any other driver is loaded and is able to access adapter array</span>
<span class="cm">   and debug interface</span>
<span class="cm">   This approach does allow to load/unload debug interface on demand,</span>
<span class="cm">   and save memory, it it is necessary.</span>
<span class="cm">   -------------------------------------------------------------------------- */</span>
<span class="kt">void</span> <span class="n">IDI_CALL_LINK_T</span> <span class="nf">DIVA_DIDD_Read</span><span class="p">(</span><span class="kt">void</span> <span class="n">IDI_CALL_ENTITY_T</span> <span class="o">*</span><span class="n">buffer</span><span class="p">,</span>
				    <span class="kt">int</span> <span class="n">length</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">diva_didd_read_adapter_array</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">length</span><span class="p">);</span>
<span class="p">}</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
