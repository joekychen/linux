<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › crypto › caam › regs.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>regs.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * CAAM hardware register-level view</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright 2008-2011 Freescale Semiconductor, Inc.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef REGS_H</span>
<span class="cp">#define REGS_H</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>
<span class="cp">#include &lt;linux/io.h&gt;</span>

<span class="cm">/*</span>
<span class="cm"> * Architecture-specific register access methods</span>
<span class="cm"> *</span>
<span class="cm"> * CAAM&#39;s bus-addressable registers are 64 bits internally.</span>
<span class="cm"> * They have been wired to be safely accessible on 32-bit</span>
<span class="cm"> * architectures, however. Registers were organized such</span>
<span class="cm"> * that (a) they can be contained in 32 bits, (b) if not, then they</span>
<span class="cm"> * can be treated as two 32-bit entities, or finally (c) if they</span>
<span class="cm"> * must be treated as a single 64-bit value, then this can safely</span>
<span class="cm"> * be done with two 32-bit cycles.</span>
<span class="cm"> *</span>
<span class="cm"> * For 32-bit operations on 64-bit values, CAAM follows the same</span>
<span class="cm"> * 64-bit register access conventions as it&#39;s predecessors, in that</span>
<span class="cm"> * writes are &quot;triggered&quot; by a write to the register at the numerically</span>
<span class="cm"> * higher address, thus, a full 64-bit write cycle requires a write</span>
<span class="cm"> * to the lower address, followed by a write to the higher address,</span>
<span class="cm"> * which will latch/execute the write cycle.</span>
<span class="cm"> *</span>
<span class="cm"> * For example, let&#39;s assume a SW reset of CAAM through the master</span>
<span class="cm"> * configuration register.</span>
<span class="cm"> * - SWRST is in bit 31 of MCFG.</span>
<span class="cm"> * - MCFG begins at base+0x0000.</span>
<span class="cm"> * - Bits 63-32 are a 32-bit word at base+0x0000 (numerically-lower)</span>
<span class="cm"> * - Bits 31-0 are a 32-bit word at base+0x0004 (numerically-higher)</span>
<span class="cm"> *</span>
<span class="cm"> * (and on Power, the convention is 0-31, 32-63, I know...)</span>
<span class="cm"> *</span>
<span class="cm"> * Assuming a 64-bit write to this MCFG to perform a software reset</span>
<span class="cm"> * would then require a write of 0 to base+0x0000, followed by a</span>
<span class="cm"> * write of 0x80000000 to base+0x0004, which would &quot;execute&quot; the</span>
<span class="cm"> * reset.</span>
<span class="cm"> *</span>
<span class="cm"> * Of course, since MCFG 63-32 is all zero, we could cheat and simply</span>
<span class="cm"> * write 0x8000000 to base+0x0004, and the reset would work fine.</span>
<span class="cm"> * However, since CAAM does contain some write-and-read-intended</span>
<span class="cm"> * 64-bit registers, this code defines 64-bit access methods for</span>
<span class="cm"> * the sake of internal consistency and simplicity, and so that a</span>
<span class="cm"> * clean transition to 64-bit is possible when it becomes necessary.</span>
<span class="cm"> *</span>
<span class="cm"> * There are limitations to this that the developer must recognize.</span>
<span class="cm"> * 32-bit architectures cannot enforce an atomic-64 operation,</span>
<span class="cm"> * Therefore:</span>
<span class="cm"> *</span>
<span class="cm"> * - On writes, since the HW is assumed to latch the cycle on the</span>
<span class="cm"> *   write of the higher-numeric-address word, then ordered</span>
<span class="cm"> *   writes work OK.</span>
<span class="cm"> *</span>
<span class="cm"> * - For reads, where a register contains a relevant value of more</span>
<span class="cm"> *   that 32 bits, the hardware employs logic to latch the other</span>
<span class="cm"> *   &quot;half&quot; of the data until read, ensuring an accurate value.</span>
<span class="cm"> *   This is of particular relevance when dealing with CAAM&#39;s</span>
<span class="cm"> *   performance counters.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cp">#ifdef __BIG_ENDIAN</span>
<span class="cp">#define wr_reg32(reg, data) out_be32(reg, data)</span>
<span class="cp">#define rd_reg32(reg) in_be32(reg)</span>
<span class="cp">#ifdef CONFIG_64BIT</span>
<span class="cp">#define wr_reg64(reg, data) out_be64(reg, data)</span>
<span class="cp">#define rd_reg64(reg) in_be64(reg)</span>
<span class="cp">#endif</span>
<span class="cp">#else</span>
<span class="cp">#ifdef __LITTLE_ENDIAN</span>
<span class="cp">#define wr_reg32(reg, data) __raw_writel(reg, data)</span>
<span class="cp">#define rd_reg32(reg) __raw_readl(reg)</span>
<span class="cp">#ifdef CONFIG_64BIT</span>
<span class="cp">#define wr_reg64(reg, data) __raw_writeq(reg, data)</span>
<span class="cp">#define rd_reg64(reg) __raw_readq(reg)</span>
<span class="cp">#endif</span>
<span class="cp">#endif</span>
<span class="cp">#endif</span>

<span class="cp">#ifndef CONFIG_64BIT</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">wr_reg64</span><span class="p">(</span><span class="n">u64</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">reg</span><span class="p">,</span> <span class="n">u64</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">wr_reg32</span><span class="p">((</span><span class="n">u32</span> <span class="n">__iomem</span> <span class="o">*</span><span class="p">)</span><span class="n">reg</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span> <span class="o">&amp;</span> <span class="mh">0xffffffff00000000ull</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">);</span>
	<span class="n">wr_reg32</span><span class="p">((</span><span class="n">u32</span> <span class="n">__iomem</span> <span class="o">*</span><span class="p">)</span><span class="n">reg</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">data</span> <span class="o">&amp;</span> <span class="mh">0x00000000ffffffffull</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">u64</span> <span class="nf">rd_reg64</span><span class="p">(</span><span class="n">u64</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">reg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(((</span><span class="n">u64</span><span class="p">)</span><span class="n">rd_reg32</span><span class="p">((</span><span class="n">u32</span> <span class="n">__iomem</span> <span class="o">*</span><span class="p">)</span><span class="n">reg</span><span class="p">))</span> <span class="o">&lt;&lt;</span> <span class="mi">32</span><span class="p">)</span> <span class="o">|</span>
		<span class="p">((</span><span class="n">u64</span><span class="p">)</span><span class="n">rd_reg32</span><span class="p">((</span><span class="n">u32</span> <span class="n">__iomem</span> <span class="o">*</span><span class="p">)</span><span class="n">reg</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
<span class="p">}</span>
<span class="cp">#endif</span>

<span class="cm">/*</span>
<span class="cm"> * jr_outentry</span>
<span class="cm"> * Represents each entry in a JobR output ring</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">jr_outentry</span> <span class="p">{</span>
	<span class="n">dma_addr_t</span> <span class="n">desc</span><span class="p">;</span><span class="cm">/* Pointer to completed descriptor */</span>
	<span class="n">u32</span> <span class="n">jrstatus</span><span class="p">;</span>	<span class="cm">/* Status for completed descriptor */</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * caam_perfmon - Performance Monitor/Secure Memory Status/</span>
<span class="cm"> *                CAAM Global Status/Component Version IDs</span>
<span class="cm"> *</span>
<span class="cm"> * Spans f00-fff wherever instantiated</span>
<span class="cm"> */</span>

<span class="cm">/* Number of DECOs */</span>
<span class="cp">#define CHA_NUM_DECONUM_SHIFT	56</span>
<span class="cp">#define CHA_NUM_DECONUM_MASK	(0xfull &lt;&lt; CHA_NUM_DECONUM_SHIFT)</span>

<span class="k">struct</span> <span class="n">caam_perfmon</span> <span class="p">{</span>
	<span class="cm">/* Performance Monitor Registers			f00-f9f */</span>
	<span class="n">u64</span> <span class="n">req_dequeued</span><span class="p">;</span>	<span class="cm">/* PC_REQ_DEQ - Dequeued Requests	     */</span>
	<span class="n">u64</span> <span class="n">ob_enc_req</span><span class="p">;</span>	<span class="cm">/* PC_OB_ENC_REQ - Outbound Encrypt Requests */</span>
	<span class="n">u64</span> <span class="n">ib_dec_req</span><span class="p">;</span>	<span class="cm">/* PC_IB_DEC_REQ - Inbound Decrypt Requests  */</span>
	<span class="n">u64</span> <span class="n">ob_enc_bytes</span><span class="p">;</span>	<span class="cm">/* PC_OB_ENCRYPT - Outbound Bytes Encrypted  */</span>
	<span class="n">u64</span> <span class="n">ob_prot_bytes</span><span class="p">;</span>	<span class="cm">/* PC_OB_PROTECT - Outbound Bytes Protected  */</span>
	<span class="n">u64</span> <span class="n">ib_dec_bytes</span><span class="p">;</span>	<span class="cm">/* PC_IB_DECRYPT - Inbound Bytes Decrypted   */</span>
	<span class="n">u64</span> <span class="n">ib_valid_bytes</span><span class="p">;</span>	<span class="cm">/* PC_IB_VALIDATED Inbound Bytes Validated   */</span>
	<span class="n">u64</span> <span class="n">rsvd</span><span class="p">[</span><span class="mi">13</span><span class="p">];</span>

	<span class="cm">/* CAAM Hardware Instantiation Parameters		fa0-fbf */</span>
	<span class="n">u64</span> <span class="n">cha_rev</span><span class="p">;</span>		<span class="cm">/* CRNR - CHA Revision Number		*/</span>
<span class="cp">#define CTPR_QI_SHIFT		57</span>
<span class="cp">#define CTPR_QI_MASK		(0x1ull &lt;&lt; CTPR_QI_SHIFT)</span>
	<span class="n">u64</span> <span class="n">comp_parms</span><span class="p">;</span>	<span class="cm">/* CTPR - Compile Parameters Register	*/</span>
	<span class="n">u64</span> <span class="n">rsvd1</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>

	<span class="cm">/* CAAM Global Status					fc0-fdf */</span>
	<span class="n">u64</span> <span class="n">faultaddr</span><span class="p">;</span>	<span class="cm">/* FAR  - Fault Address		*/</span>
	<span class="n">u32</span> <span class="n">faultliodn</span><span class="p">;</span>	<span class="cm">/* FALR - Fault Address LIODN	*/</span>
	<span class="n">u32</span> <span class="n">faultdetail</span><span class="p">;</span>	<span class="cm">/* FADR - Fault Addr Detail	*/</span>
	<span class="n">u32</span> <span class="n">rsvd2</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">status</span><span class="p">;</span>		<span class="cm">/* CSTA - CAAM Status */</span>
	<span class="n">u64</span> <span class="n">rsvd3</span><span class="p">;</span>

	<span class="cm">/* Component Instantiation Parameters			fe0-fff */</span>
	<span class="n">u32</span> <span class="n">rtic_id</span><span class="p">;</span>		<span class="cm">/* RVID - RTIC Version ID	*/</span>
	<span class="n">u32</span> <span class="n">ccb_id</span><span class="p">;</span>		<span class="cm">/* CCBVID - CCB Version ID	*/</span>
	<span class="n">u64</span> <span class="n">cha_id</span><span class="p">;</span>		<span class="cm">/* CHAVID - CHA Version ID	*/</span>
	<span class="n">u64</span> <span class="n">cha_num</span><span class="p">;</span>		<span class="cm">/* CHANUM - CHA Number		*/</span>
	<span class="n">u64</span> <span class="n">caam_id</span><span class="p">;</span>		<span class="cm">/* CAAMVID - CAAM Version ID	*/</span>
<span class="p">};</span>

<span class="cm">/* LIODN programming for DMA configuration */</span>
<span class="cp">#define MSTRID_LOCK_LIODN	0x80000000</span>
<span class="cp">#define MSTRID_LOCK_MAKETRUSTED	0x00010000	</span><span class="cm">/* only for JR masterid */</span><span class="cp"></span>

<span class="cp">#define MSTRID_LIODN_MASK	0x0fff</span>
<span class="k">struct</span> <span class="n">masterid</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">liodn_ms</span><span class="p">;</span>	<span class="cm">/* lock and make-trusted control bits */</span>
	<span class="n">u32</span> <span class="n">liodn_ls</span><span class="p">;</span>	<span class="cm">/* LIODN for non-sequence and seq access */</span>
<span class="p">};</span>

<span class="cm">/* Partition ID for DMA configuration */</span>
<span class="k">struct</span> <span class="n">partid</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">rsvd1</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pidr</span><span class="p">;</span>	<span class="cm">/* partition ID, DECO */</span>
<span class="p">};</span>

<span class="cm">/* RNG test mode (replicated twice in some configurations) */</span>
<span class="cm">/* Padded out to 0x100 */</span>
<span class="k">struct</span> <span class="n">rngtst</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">mode</span><span class="p">;</span>		<span class="cm">/* RTSTMODEx - Test mode */</span>
	<span class="n">u32</span> <span class="n">rsvd1</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">reset</span><span class="p">;</span>		<span class="cm">/* RTSTRESETx - Test reset control */</span>
	<span class="n">u32</span> <span class="n">rsvd2</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">status</span><span class="p">;</span>		<span class="cm">/* RTSTSSTATUSx - Test status */</span>
	<span class="n">u32</span> <span class="n">rsvd3</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">errstat</span><span class="p">;</span>		<span class="cm">/* RTSTERRSTATx - Test error status */</span>
	<span class="n">u32</span> <span class="n">rsvd4</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">errctl</span><span class="p">;</span>		<span class="cm">/* RTSTERRCTLx - Test error control */</span>
	<span class="n">u32</span> <span class="n">rsvd5</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">entropy</span><span class="p">;</span>		<span class="cm">/* RTSTENTROPYx - Test entropy */</span>
	<span class="n">u32</span> <span class="n">rsvd6</span><span class="p">[</span><span class="mi">15</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">verifctl</span><span class="p">;</span>	<span class="cm">/* RTSTVERIFCTLx - Test verification control */</span>
	<span class="n">u32</span> <span class="n">rsvd7</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">verifstat</span><span class="p">;</span>	<span class="cm">/* RTSTVERIFSTATx - Test verification status */</span>
	<span class="n">u32</span> <span class="n">rsvd8</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">verifdata</span><span class="p">;</span>	<span class="cm">/* RTSTVERIFDx - Test verification data */</span>
	<span class="n">u32</span> <span class="n">rsvd9</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">xkey</span><span class="p">;</span>		<span class="cm">/* RTSTXKEYx - Test XKEY */</span>
	<span class="n">u32</span> <span class="n">rsvd10</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">oscctctl</span><span class="p">;</span>	<span class="cm">/* RTSTOSCCTCTLx - Test osc. counter control */</span>
	<span class="n">u32</span> <span class="n">rsvd11</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">oscct</span><span class="p">;</span>		<span class="cm">/* RTSTOSCCTx - Test oscillator counter */</span>
	<span class="n">u32</span> <span class="n">rsvd12</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">oscctstat</span><span class="p">;</span>	<span class="cm">/* RTSTODCCTSTATx - Test osc counter status */</span>
	<span class="n">u32</span> <span class="n">rsvd13</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">ofifo</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>	<span class="cm">/* RTSTOFIFOx - Test output FIFO */</span>
	<span class="n">u32</span> <span class="n">rsvd14</span><span class="p">[</span><span class="mi">15</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * caam_ctrl - basic core configuration</span>
<span class="cm"> * starts base + 0x0000 padded out to 0x1000</span>
<span class="cm"> */</span>

<span class="cp">#define KEK_KEY_SIZE		8</span>
<span class="cp">#define TKEK_KEY_SIZE		8</span>
<span class="cp">#define TDSK_KEY_SIZE		8</span>

<span class="cp">#define DECO_RESET	1	</span><span class="cm">/* Use with DECO reset/availability regs */</span><span class="cp"></span>
<span class="cp">#define DECO_RESET_0	(DECO_RESET &lt;&lt; 0)</span>
<span class="cp">#define DECO_RESET_1	(DECO_RESET &lt;&lt; 1)</span>
<span class="cp">#define DECO_RESET_2	(DECO_RESET &lt;&lt; 2)</span>
<span class="cp">#define DECO_RESET_3	(DECO_RESET &lt;&lt; 3)</span>
<span class="cp">#define DECO_RESET_4	(DECO_RESET &lt;&lt; 4)</span>

<span class="k">struct</span> <span class="n">caam_ctrl</span> <span class="p">{</span>
	<span class="cm">/* Basic Configuration Section				000-01f */</span>
	<span class="cm">/* Read/Writable					        */</span>
	<span class="n">u32</span> <span class="n">rsvd1</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">mcr</span><span class="p">;</span>		<span class="cm">/* MCFG      Master Config Register  */</span>
	<span class="n">u32</span> <span class="n">rsvd2</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>

	<span class="cm">/* Bus Access Configuration Section			010-11f */</span>
	<span class="cm">/* Read/Writable                                                */</span>
	<span class="k">struct</span> <span class="n">masterid</span> <span class="n">jr_mid</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>	<span class="cm">/* JRxLIODNR - JobR LIODN setup */</span>
	<span class="n">u32</span> <span class="n">rsvd3</span><span class="p">[</span><span class="mi">12</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">masterid</span> <span class="n">rtic_mid</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>	<span class="cm">/* RTICxLIODNR - RTIC LIODN setup */</span>
	<span class="n">u32</span> <span class="n">rsvd4</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">deco_rq</span><span class="p">;</span>			<span class="cm">/* DECORR - DECO Request */</span>
	<span class="k">struct</span> <span class="n">partid</span> <span class="n">deco_mid</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>	<span class="cm">/* DECOxLIODNR - 1 per DECO */</span>
	<span class="n">u32</span> <span class="n">rsvd5</span><span class="p">[</span><span class="mi">22</span><span class="p">];</span>

	<span class="cm">/* DECO Availability/Reset Section			120-3ff */</span>
	<span class="n">u32</span> <span class="n">deco_avail</span><span class="p">;</span>		<span class="cm">/* DAR - DECO availability */</span>
	<span class="n">u32</span> <span class="n">deco_reset</span><span class="p">;</span>		<span class="cm">/* DRR - DECO reset */</span>
	<span class="n">u32</span> <span class="n">rsvd6</span><span class="p">[</span><span class="mi">182</span><span class="p">];</span>

	<span class="cm">/* Key Encryption/Decryption Configuration              400-5ff */</span>
	<span class="cm">/* Read/Writable only while in Non-secure mode                  */</span>
	<span class="n">u32</span> <span class="n">kek</span><span class="p">[</span><span class="n">KEK_KEY_SIZE</span><span class="p">];</span>	<span class="cm">/* JDKEKR - Key Encryption Key */</span>
	<span class="n">u32</span> <span class="n">tkek</span><span class="p">[</span><span class="n">TKEK_KEY_SIZE</span><span class="p">];</span>	<span class="cm">/* TDKEKR - Trusted Desc KEK */</span>
	<span class="n">u32</span> <span class="n">tdsk</span><span class="p">[</span><span class="n">TDSK_KEY_SIZE</span><span class="p">];</span>	<span class="cm">/* TDSKR - Trusted Desc Signing Key */</span>
	<span class="n">u32</span> <span class="n">rsvd7</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
	<span class="n">u64</span> <span class="n">sknonce</span><span class="p">;</span>			<span class="cm">/* SKNR - Secure Key Nonce */</span>
	<span class="n">u32</span> <span class="n">rsvd8</span><span class="p">[</span><span class="mi">70</span><span class="p">];</span>

	<span class="cm">/* RNG Test/Verification/Debug Access                   600-7ff */</span>
	<span class="cm">/* (Useful in Test/Debug modes only...)                         */</span>
	<span class="k">struct</span> <span class="n">rngtst</span> <span class="n">rtst</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>

	<span class="n">u32</span> <span class="n">rsvd9</span><span class="p">[</span><span class="mi">448</span><span class="p">];</span>

	<span class="cm">/* Performance Monitor                                  f00-fff */</span>
	<span class="k">struct</span> <span class="n">caam_perfmon</span> <span class="n">perfmon</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Controller master config register defs</span>
<span class="cm"> */</span>
<span class="cp">#define MCFGR_SWRESET		0x80000000 </span><span class="cm">/* software reset */</span><span class="cp"></span>
<span class="cp">#define MCFGR_WDENABLE		0x40000000 </span><span class="cm">/* DECO watchdog enable */</span><span class="cp"></span>
<span class="cp">#define MCFGR_WDFAIL		0x20000000 </span><span class="cm">/* DECO watchdog force-fail */</span><span class="cp"></span>
<span class="cp">#define MCFGR_DMA_RESET		0x10000000</span>
<span class="cp">#define MCFGR_LONG_PTR		0x00010000 </span><span class="cm">/* Use &gt;32-bit desc addressing */</span><span class="cp"></span>

<span class="cm">/* AXI read cache control */</span>
<span class="cp">#define MCFGR_ARCACHE_SHIFT	12</span>
<span class="cp">#define MCFGR_ARCACHE_MASK	(0xf &lt;&lt; MCFGR_ARCACHE_SHIFT)</span>

<span class="cm">/* AXI write cache control */</span>
<span class="cp">#define MCFGR_AWCACHE_SHIFT	8</span>
<span class="cp">#define MCFGR_AWCACHE_MASK	(0xf &lt;&lt; MCFGR_AWCACHE_SHIFT)</span>

<span class="cm">/* AXI pipeline depth */</span>
<span class="cp">#define MCFGR_AXIPIPE_SHIFT	4</span>
<span class="cp">#define MCFGR_AXIPIPE_MASK	(0xf &lt;&lt; MCFGR_AXIPIPE_SHIFT)</span>

<span class="cp">#define MCFGR_AXIPRI		0x00000008 </span><span class="cm">/* Assert AXI priority sideband */</span><span class="cp"></span>
<span class="cp">#define MCFGR_BURST_64		0x00000001 </span><span class="cm">/* Max burst size */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * caam_job_ring - direct job ring setup</span>
<span class="cm"> * 1-4 possible per instantiation, base + 1000/2000/3000/4000</span>
<span class="cm"> * Padded out to 0x1000</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">caam_job_ring</span> <span class="p">{</span>
	<span class="cm">/* Input ring */</span>
	<span class="n">u64</span> <span class="n">inpring_base</span><span class="p">;</span>	<span class="cm">/* IRBAx -  Input desc ring baseaddr */</span>
	<span class="n">u32</span> <span class="n">rsvd1</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">inpring_size</span><span class="p">;</span>	<span class="cm">/* IRSx - Input ring size */</span>
	<span class="n">u32</span> <span class="n">rsvd2</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">inpring_avail</span><span class="p">;</span>	<span class="cm">/* IRSAx - Input ring room remaining */</span>
	<span class="n">u32</span> <span class="n">rsvd3</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">inpring_jobadd</span><span class="p">;</span>	<span class="cm">/* IRJAx - Input ring jobs added */</span>

	<span class="cm">/* Output Ring */</span>
	<span class="n">u64</span> <span class="n">outring_base</span><span class="p">;</span>	<span class="cm">/* ORBAx - Output status ring base addr */</span>
	<span class="n">u32</span> <span class="n">rsvd4</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">outring_size</span><span class="p">;</span>	<span class="cm">/* ORSx - Output ring size */</span>
	<span class="n">u32</span> <span class="n">rsvd5</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">outring_rmvd</span><span class="p">;</span>	<span class="cm">/* ORJRx - Output ring jobs removed */</span>
	<span class="n">u32</span> <span class="n">rsvd6</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">outring_used</span><span class="p">;</span>	<span class="cm">/* ORSFx - Output ring slots full */</span>

	<span class="cm">/* Status/Configuration */</span>
	<span class="n">u32</span> <span class="n">rsvd7</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">jroutstatus</span><span class="p">;</span>	<span class="cm">/* JRSTAx - JobR output status */</span>
	<span class="n">u32</span> <span class="n">rsvd8</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">jrintstatus</span><span class="p">;</span>	<span class="cm">/* JRINTx - JobR interrupt status */</span>
	<span class="n">u32</span> <span class="n">rconfig_hi</span><span class="p">;</span>	<span class="cm">/* JRxCFG - Ring configuration */</span>
	<span class="n">u32</span> <span class="n">rconfig_lo</span><span class="p">;</span>

	<span class="cm">/* Indices. CAAM maintains as &quot;heads&quot; of each queue */</span>
	<span class="n">u32</span> <span class="n">rsvd9</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">inp_rdidx</span><span class="p">;</span>	<span class="cm">/* IRRIx - Input ring read index */</span>
	<span class="n">u32</span> <span class="n">rsvd10</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">out_wtidx</span><span class="p">;</span>	<span class="cm">/* ORWIx - Output ring write index */</span>

	<span class="cm">/* Command/control */</span>
	<span class="n">u32</span> <span class="n">rsvd11</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">jrcommand</span><span class="p">;</span>	<span class="cm">/* JRCRx - JobR command */</span>

	<span class="n">u32</span> <span class="n">rsvd12</span><span class="p">[</span><span class="mi">932</span><span class="p">];</span>

	<span class="cm">/* Performance Monitor                                  f00-fff */</span>
	<span class="k">struct</span> <span class="n">caam_perfmon</span> <span class="n">perfmon</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define JR_RINGSIZE_MASK	0x03ff</span>
<span class="cm">/*</span>
<span class="cm"> * jrstatus - Job Ring Output Status</span>
<span class="cm"> * All values in lo word</span>
<span class="cm"> * Also note, same values written out as status through QI</span>
<span class="cm"> * in the command/status field of a frame descriptor</span>
<span class="cm"> */</span>
<span class="cp">#define JRSTA_SSRC_SHIFT            28</span>
<span class="cp">#define JRSTA_SSRC_MASK             0xf0000000</span>

<span class="cp">#define JRSTA_SSRC_NONE             0x00000000</span>
<span class="cp">#define JRSTA_SSRC_CCB_ERROR        0x20000000</span>
<span class="cp">#define JRSTA_SSRC_JUMP_HALT_USER   0x30000000</span>
<span class="cp">#define JRSTA_SSRC_DECO             0x40000000</span>
<span class="cp">#define JRSTA_SSRC_JRERROR          0x60000000</span>
<span class="cp">#define JRSTA_SSRC_JUMP_HALT_CC     0x70000000</span>

<span class="cp">#define JRSTA_DECOERR_JUMP          0x08000000</span>
<span class="cp">#define JRSTA_DECOERR_INDEX_SHIFT   8</span>
<span class="cp">#define JRSTA_DECOERR_INDEX_MASK    0xff00</span>
<span class="cp">#define JRSTA_DECOERR_ERROR_MASK    0x00ff</span>

<span class="cp">#define JRSTA_DECOERR_NONE          0x00</span>
<span class="cp">#define JRSTA_DECOERR_LINKLEN       0x01</span>
<span class="cp">#define JRSTA_DECOERR_LINKPTR       0x02</span>
<span class="cp">#define JRSTA_DECOERR_JRCTRL        0x03</span>
<span class="cp">#define JRSTA_DECOERR_DESCCMD       0x04</span>
<span class="cp">#define JRSTA_DECOERR_ORDER         0x05</span>
<span class="cp">#define JRSTA_DECOERR_KEYCMD        0x06</span>
<span class="cp">#define JRSTA_DECOERR_LOADCMD       0x07</span>
<span class="cp">#define JRSTA_DECOERR_STORECMD      0x08</span>
<span class="cp">#define JRSTA_DECOERR_OPCMD         0x09</span>
<span class="cp">#define JRSTA_DECOERR_FIFOLDCMD     0x0a</span>
<span class="cp">#define JRSTA_DECOERR_FIFOSTCMD     0x0b</span>
<span class="cp">#define JRSTA_DECOERR_MOVECMD       0x0c</span>
<span class="cp">#define JRSTA_DECOERR_JUMPCMD       0x0d</span>
<span class="cp">#define JRSTA_DECOERR_MATHCMD       0x0e</span>
<span class="cp">#define JRSTA_DECOERR_SHASHCMD      0x0f</span>
<span class="cp">#define JRSTA_DECOERR_SEQCMD        0x10</span>
<span class="cp">#define JRSTA_DECOERR_DECOINTERNAL  0x11</span>
<span class="cp">#define JRSTA_DECOERR_SHDESCHDR     0x12</span>
<span class="cp">#define JRSTA_DECOERR_HDRLEN        0x13</span>
<span class="cp">#define JRSTA_DECOERR_BURSTER       0x14</span>
<span class="cp">#define JRSTA_DECOERR_DESCSIGNATURE 0x15</span>
<span class="cp">#define JRSTA_DECOERR_DMA           0x16</span>
<span class="cp">#define JRSTA_DECOERR_BURSTFIFO     0x17</span>
<span class="cp">#define JRSTA_DECOERR_JRRESET       0x1a</span>
<span class="cp">#define JRSTA_DECOERR_JOBFAIL       0x1b</span>
<span class="cp">#define JRSTA_DECOERR_DNRERR        0x80</span>
<span class="cp">#define JRSTA_DECOERR_UNDEFPCL      0x81</span>
<span class="cp">#define JRSTA_DECOERR_PDBERR        0x82</span>
<span class="cp">#define JRSTA_DECOERR_ANRPLY_LATE   0x83</span>
<span class="cp">#define JRSTA_DECOERR_ANRPLY_REPLAY 0x84</span>
<span class="cp">#define JRSTA_DECOERR_SEQOVF        0x85</span>
<span class="cp">#define JRSTA_DECOERR_INVSIGN       0x86</span>
<span class="cp">#define JRSTA_DECOERR_DSASIGN       0x87</span>

<span class="cp">#define JRSTA_CCBERR_JUMP           0x08000000</span>
<span class="cp">#define JRSTA_CCBERR_INDEX_MASK     0xff00</span>
<span class="cp">#define JRSTA_CCBERR_INDEX_SHIFT    8</span>
<span class="cp">#define JRSTA_CCBERR_CHAID_MASK     0x00f0</span>
<span class="cp">#define JRSTA_CCBERR_CHAID_SHIFT    4</span>
<span class="cp">#define JRSTA_CCBERR_ERRID_MASK     0x000f</span>

<span class="cp">#define JRSTA_CCBERR_CHAID_AES      (0x01 &lt;&lt; JRSTA_CCBERR_CHAID_SHIFT)</span>
<span class="cp">#define JRSTA_CCBERR_CHAID_DES      (0x02 &lt;&lt; JRSTA_CCBERR_CHAID_SHIFT)</span>
<span class="cp">#define JRSTA_CCBERR_CHAID_ARC4     (0x03 &lt;&lt; JRSTA_CCBERR_CHAID_SHIFT)</span>
<span class="cp">#define JRSTA_CCBERR_CHAID_MD       (0x04 &lt;&lt; JRSTA_CCBERR_CHAID_SHIFT)</span>
<span class="cp">#define JRSTA_CCBERR_CHAID_RNG      (0x05 &lt;&lt; JRSTA_CCBERR_CHAID_SHIFT)</span>
<span class="cp">#define JRSTA_CCBERR_CHAID_SNOW     (0x06 &lt;&lt; JRSTA_CCBERR_CHAID_SHIFT)</span>
<span class="cp">#define JRSTA_CCBERR_CHAID_KASUMI   (0x07 &lt;&lt; JRSTA_CCBERR_CHAID_SHIFT)</span>
<span class="cp">#define JRSTA_CCBERR_CHAID_PK       (0x08 &lt;&lt; JRSTA_CCBERR_CHAID_SHIFT)</span>
<span class="cp">#define JRSTA_CCBERR_CHAID_CRC      (0x09 &lt;&lt; JRSTA_CCBERR_CHAID_SHIFT)</span>

<span class="cp">#define JRSTA_CCBERR_ERRID_NONE     0x00</span>
<span class="cp">#define JRSTA_CCBERR_ERRID_MODE     0x01</span>
<span class="cp">#define JRSTA_CCBERR_ERRID_DATASIZ  0x02</span>
<span class="cp">#define JRSTA_CCBERR_ERRID_KEYSIZ   0x03</span>
<span class="cp">#define JRSTA_CCBERR_ERRID_PKAMEMSZ 0x04</span>
<span class="cp">#define JRSTA_CCBERR_ERRID_PKBMEMSZ 0x05</span>
<span class="cp">#define JRSTA_CCBERR_ERRID_SEQUENCE 0x06</span>
<span class="cp">#define JRSTA_CCBERR_ERRID_PKDIVZRO 0x07</span>
<span class="cp">#define JRSTA_CCBERR_ERRID_PKMODEVN 0x08</span>
<span class="cp">#define JRSTA_CCBERR_ERRID_KEYPARIT 0x09</span>
<span class="cp">#define JRSTA_CCBERR_ERRID_ICVCHK   0x0a</span>
<span class="cp">#define JRSTA_CCBERR_ERRID_HARDWARE 0x0b</span>
<span class="cp">#define JRSTA_CCBERR_ERRID_CCMAAD   0x0c</span>
<span class="cp">#define JRSTA_CCBERR_ERRID_INVCHA   0x0f</span>

<span class="cp">#define JRINT_ERR_INDEX_MASK        0x3fff0000</span>
<span class="cp">#define JRINT_ERR_INDEX_SHIFT       16</span>
<span class="cp">#define JRINT_ERR_TYPE_MASK         0xf00</span>
<span class="cp">#define JRINT_ERR_TYPE_SHIFT        8</span>
<span class="cp">#define JRINT_ERR_HALT_MASK         0xc</span>
<span class="cp">#define JRINT_ERR_HALT_SHIFT        2</span>
<span class="cp">#define JRINT_ERR_HALT_INPROGRESS   0x4</span>
<span class="cp">#define JRINT_ERR_HALT_COMPLETE     0x8</span>
<span class="cp">#define JRINT_JR_ERROR              0x02</span>
<span class="cp">#define JRINT_JR_INT                0x01</span>

<span class="cp">#define JRINT_ERR_TYPE_WRITE        1</span>
<span class="cp">#define JRINT_ERR_TYPE_BAD_INPADDR  3</span>
<span class="cp">#define JRINT_ERR_TYPE_BAD_OUTADDR  4</span>
<span class="cp">#define JRINT_ERR_TYPE_INV_INPWRT   5</span>
<span class="cp">#define JRINT_ERR_TYPE_INV_OUTWRT   6</span>
<span class="cp">#define JRINT_ERR_TYPE_RESET        7</span>
<span class="cp">#define JRINT_ERR_TYPE_REMOVE_OFL   8</span>
<span class="cp">#define JRINT_ERR_TYPE_ADD_OFL      9</span>

<span class="cp">#define JRCFG_SOE		0x04</span>
<span class="cp">#define JRCFG_ICEN		0x02</span>
<span class="cp">#define JRCFG_IMSK		0x01</span>
<span class="cp">#define JRCFG_ICDCT_SHIFT	8</span>
<span class="cp">#define JRCFG_ICTT_SHIFT	16</span>

<span class="cp">#define JRCR_RESET                  0x01</span>

<span class="cm">/*</span>
<span class="cm"> * caam_assurance - Assurance Controller View</span>
<span class="cm"> * base + 0x6000 padded out to 0x1000</span>
<span class="cm"> */</span>

<span class="k">struct</span> <span class="n">rtic_element</span> <span class="p">{</span>
	<span class="n">u64</span> <span class="n">address</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rsvd</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">length</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">rtic_block</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">rtic_element</span> <span class="n">element</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">rtic_memhash</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">memhash_be</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">memhash_le</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">caam_assurance</span> <span class="p">{</span>
    <span class="cm">/* Status/Command/Watchdog */</span>
	<span class="n">u32</span> <span class="n">rsvd1</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">status</span><span class="p">;</span>		<span class="cm">/* RSTA - Status */</span>
	<span class="n">u32</span> <span class="n">rsvd2</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">cmd</span><span class="p">;</span>		<span class="cm">/* RCMD - Command */</span>
	<span class="n">u32</span> <span class="n">rsvd3</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">ctrl</span><span class="p">;</span>		<span class="cm">/* RCTL - Control */</span>
	<span class="n">u32</span> <span class="n">rsvd4</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">throttle</span><span class="p">;</span>	<span class="cm">/* RTHR - Throttle */</span>
	<span class="n">u32</span> <span class="n">rsvd5</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u64</span> <span class="n">watchdog</span><span class="p">;</span>	<span class="cm">/* RWDOG - Watchdog Timer */</span>
	<span class="n">u32</span> <span class="n">rsvd6</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rend</span><span class="p">;</span>		<span class="cm">/* REND - Endian corrections */</span>
	<span class="n">u32</span> <span class="n">rsvd7</span><span class="p">[</span><span class="mi">50</span><span class="p">];</span>

	<span class="cm">/* Block access/configuration @ 100/110/120/130 */</span>
	<span class="k">struct</span> <span class="n">rtic_block</span> <span class="n">memblk</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>	<span class="cm">/* Memory Blocks A-D */</span>
	<span class="n">u32</span> <span class="n">rsvd8</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>

	<span class="cm">/* Block hashes @ 200/300/400/500 */</span>
	<span class="k">struct</span> <span class="n">rtic_memhash</span> <span class="n">hash</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>	<span class="cm">/* Block hash values A-D */</span>
	<span class="n">u32</span> <span class="n">rsvd_3</span><span class="p">[</span><span class="mi">640</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * caam_queue_if - QI configuration and control</span>
<span class="cm"> * starts base + 0x7000, padded out to 0x1000 long</span>
<span class="cm"> */</span>

<span class="k">struct</span> <span class="n">caam_queue_if</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">qi_control_hi</span><span class="p">;</span>	<span class="cm">/* QICTL  - QI Control */</span>
	<span class="n">u32</span> <span class="n">qi_control_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rsvd1</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">qi_status</span><span class="p">;</span>	<span class="cm">/* QISTA  - QI Status */</span>
	<span class="n">u32</span> <span class="n">qi_deq_cfg_hi</span><span class="p">;</span>	<span class="cm">/* QIDQC  - QI Dequeue Configuration */</span>
	<span class="n">u32</span> <span class="n">qi_deq_cfg_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">qi_enq_cfg_hi</span><span class="p">;</span>	<span class="cm">/* QISEQC - QI Enqueue Command     */</span>
	<span class="n">u32</span> <span class="n">qi_enq_cfg_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rsvd2</span><span class="p">[</span><span class="mi">1016</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/* QI control bits - low word */</span>
<span class="cp">#define QICTL_DQEN      0x01              </span><span class="cm">/* Enable frame pop          */</span><span class="cp"></span>
<span class="cp">#define QICTL_STOP      0x02              </span><span class="cm">/* Stop dequeue/enqueue      */</span><span class="cp"></span>
<span class="cp">#define QICTL_SOE       0x04              </span><span class="cm">/* Stop on error             */</span><span class="cp"></span>

<span class="cm">/* QI control bits - high word */</span>
<span class="cp">#define QICTL_MBSI	0x01</span>
<span class="cp">#define QICTL_MHWSI	0x02</span>
<span class="cp">#define QICTL_MWSI	0x04</span>
<span class="cp">#define QICTL_MDWSI	0x08</span>
<span class="cp">#define QICTL_CBSI	0x10		</span><span class="cm">/* CtrlDataByteSwapInput     */</span><span class="cp"></span>
<span class="cp">#define QICTL_CHWSI	0x20		</span><span class="cm">/* CtrlDataHalfSwapInput     */</span><span class="cp"></span>
<span class="cp">#define QICTL_CWSI	0x40		</span><span class="cm">/* CtrlDataWordSwapInput     */</span><span class="cp"></span>
<span class="cp">#define QICTL_CDWSI	0x80		</span><span class="cm">/* CtrlDataDWordSwapInput    */</span><span class="cp"></span>
<span class="cp">#define QICTL_MBSO	0x0100</span>
<span class="cp">#define QICTL_MHWSO	0x0200</span>
<span class="cp">#define QICTL_MWSO	0x0400</span>
<span class="cp">#define QICTL_MDWSO	0x0800</span>
<span class="cp">#define QICTL_CBSO	0x1000		</span><span class="cm">/* CtrlDataByteSwapOutput    */</span><span class="cp"></span>
<span class="cp">#define QICTL_CHWSO	0x2000		</span><span class="cm">/* CtrlDataHalfSwapOutput    */</span><span class="cp"></span>
<span class="cp">#define QICTL_CWSO	0x4000		</span><span class="cm">/* CtrlDataWordSwapOutput    */</span><span class="cp"></span>
<span class="cp">#define QICTL_CDWSO     0x8000		</span><span class="cm">/* CtrlDataDWordSwapOutput   */</span><span class="cp"></span>
<span class="cp">#define QICTL_DMBS	0x010000</span>
<span class="cp">#define QICTL_EPO	0x020000</span>

<span class="cm">/* QI status bits */</span>
<span class="cp">#define QISTA_PHRDERR   0x01              </span><span class="cm">/* PreHeader Read Error      */</span><span class="cp"></span>
<span class="cp">#define QISTA_CFRDERR   0x02              </span><span class="cm">/* Compound Frame Read Error */</span><span class="cp"></span>
<span class="cp">#define QISTA_OFWRERR   0x04              </span><span class="cm">/* Output Frame Read Error   */</span><span class="cp"></span>
<span class="cp">#define QISTA_BPDERR    0x08              </span><span class="cm">/* Buffer Pool Depleted      */</span><span class="cp"></span>
<span class="cp">#define QISTA_BTSERR    0x10              </span><span class="cm">/* Buffer Undersize          */</span><span class="cp"></span>
<span class="cp">#define QISTA_CFWRERR   0x20              </span><span class="cm">/* Compound Frame Write Err  */</span><span class="cp"></span>
<span class="cp">#define QISTA_STOPD     0x80000000        </span><span class="cm">/* QI Stopped (see QICTL)    */</span><span class="cp"></span>

<span class="cm">/* deco_sg_table - DECO view of scatter/gather table */</span>
<span class="k">struct</span> <span class="n">deco_sg_table</span> <span class="p">{</span>
	<span class="n">u64</span> <span class="n">addr</span><span class="p">;</span>		<span class="cm">/* Segment Address */</span>
	<span class="n">u32</span> <span class="n">elen</span><span class="p">;</span>		<span class="cm">/* E, F bits + 30-bit length */</span>
	<span class="n">u32</span> <span class="n">bpid_offset</span><span class="p">;</span>	<span class="cm">/* Buffer Pool ID + 16-bit length */</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * caam_deco - descriptor controller - CHA cluster block</span>
<span class="cm"> *</span>
<span class="cm"> * Only accessible when direct DECO access is turned on</span>
<span class="cm"> * (done in DECORR, via MID programmed in DECOxMID</span>
<span class="cm"> *</span>
<span class="cm"> * 5 typical, base + 0x8000/9000/a000/b000</span>
<span class="cm"> * Padded out to 0x1000 long</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">caam_deco</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">rsvd1</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">cls1_mode</span><span class="p">;</span>	<span class="cm">/* CxC1MR -  Class 1 Mode */</span>
	<span class="n">u32</span> <span class="n">rsvd2</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">cls1_keysize</span><span class="p">;</span>	<span class="cm">/* CxC1KSR - Class 1 Key Size */</span>
	<span class="n">u32</span> <span class="n">cls1_datasize_hi</span><span class="p">;</span>	<span class="cm">/* CxC1DSR - Class 1 Data Size */</span>
	<span class="n">u32</span> <span class="n">cls1_datasize_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rsvd3</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">cls1_icvsize</span><span class="p">;</span>	<span class="cm">/* CxC1ICVSR - Class 1 ICV size */</span>
	<span class="n">u32</span> <span class="n">rsvd4</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">cha_ctrl</span><span class="p">;</span>	<span class="cm">/* CCTLR - CHA control */</span>
	<span class="n">u32</span> <span class="n">rsvd5</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">irq_crtl</span><span class="p">;</span>	<span class="cm">/* CxCIRQ - CCB interrupt done/error/clear */</span>
	<span class="n">u32</span> <span class="n">rsvd6</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">clr_written</span><span class="p">;</span>	<span class="cm">/* CxCWR - Clear-Written */</span>
	<span class="n">u32</span> <span class="n">ccb_status_hi</span><span class="p">;</span>	<span class="cm">/* CxCSTA - CCB Status/Error */</span>
	<span class="n">u32</span> <span class="n">ccb_status_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rsvd7</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">aad_size</span><span class="p">;</span>	<span class="cm">/* CxAADSZR - Current AAD Size */</span>
	<span class="n">u32</span> <span class="n">rsvd8</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">cls1_iv_size</span><span class="p">;</span>	<span class="cm">/* CxC1IVSZR - Current Class 1 IV Size */</span>
	<span class="n">u32</span> <span class="n">rsvd9</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">pkha_a_size</span><span class="p">;</span>	<span class="cm">/* PKASZRx - Size of PKHA A */</span>
	<span class="n">u32</span> <span class="n">rsvd10</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pkha_b_size</span><span class="p">;</span>	<span class="cm">/* PKBSZRx - Size of PKHA B */</span>
	<span class="n">u32</span> <span class="n">rsvd11</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pkha_n_size</span><span class="p">;</span>	<span class="cm">/* PKNSZRx - Size of PKHA N */</span>
	<span class="n">u32</span> <span class="n">rsvd12</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pkha_e_size</span><span class="p">;</span>	<span class="cm">/* PKESZRx - Size of PKHA E */</span>
	<span class="n">u32</span> <span class="n">rsvd13</span><span class="p">[</span><span class="mi">24</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">cls1_ctx</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>	<span class="cm">/* CxC1CTXR - Class 1 Context @100 */</span>
	<span class="n">u32</span> <span class="n">rsvd14</span><span class="p">[</span><span class="mi">48</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">cls1_key</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>	<span class="cm">/* CxC1KEYR - Class 1 Key @200 */</span>
	<span class="n">u32</span> <span class="n">rsvd15</span><span class="p">[</span><span class="mi">121</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">cls2_mode</span><span class="p">;</span>	<span class="cm">/* CxC2MR - Class 2 Mode */</span>
	<span class="n">u32</span> <span class="n">rsvd16</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">cls2_keysize</span><span class="p">;</span>	<span class="cm">/* CxX2KSR - Class 2 Key Size */</span>
	<span class="n">u32</span> <span class="n">cls2_datasize_hi</span><span class="p">;</span>	<span class="cm">/* CxC2DSR - Class 2 Data Size */</span>
	<span class="n">u32</span> <span class="n">cls2_datasize_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rsvd17</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">cls2_icvsize</span><span class="p">;</span>	<span class="cm">/* CxC2ICVSZR - Class 2 ICV Size */</span>
	<span class="n">u32</span> <span class="n">rsvd18</span><span class="p">[</span><span class="mi">56</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">cls2_ctx</span><span class="p">[</span><span class="mi">18</span><span class="p">];</span>	<span class="cm">/* CxC2CTXR - Class 2 Context @500 */</span>
	<span class="n">u32</span> <span class="n">rsvd19</span><span class="p">[</span><span class="mi">46</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">cls2_key</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>	<span class="cm">/* CxC2KEYR - Class2 Key @600 */</span>
	<span class="n">u32</span> <span class="n">rsvd20</span><span class="p">[</span><span class="mi">84</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">inp_infofifo_hi</span><span class="p">;</span>	<span class="cm">/* CxIFIFO - Input Info FIFO @7d0 */</span>
	<span class="n">u32</span> <span class="n">inp_infofifo_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rsvd21</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u64</span> <span class="n">inp_datafifo</span><span class="p">;</span>	<span class="cm">/* CxDFIFO - Input Data FIFO */</span>
	<span class="n">u32</span> <span class="n">rsvd22</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u64</span> <span class="n">out_datafifo</span><span class="p">;</span>	<span class="cm">/* CxOFIFO - Output Data FIFO */</span>
	<span class="n">u32</span> <span class="n">rsvd23</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">jr_ctl_hi</span><span class="p">;</span>	<span class="cm">/* CxJRR - JobR Control Register      @800 */</span>
	<span class="n">u32</span> <span class="n">jr_ctl_lo</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">jr_descaddr</span><span class="p">;</span>	<span class="cm">/* CxDADR - JobR Descriptor Address */</span>
	<span class="n">u32</span> <span class="n">op_status_hi</span><span class="p">;</span>	<span class="cm">/* DxOPSTA - DECO Operation Status */</span>
	<span class="n">u32</span> <span class="n">op_status_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rsvd24</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">liodn</span><span class="p">;</span>		<span class="cm">/* DxLSR - DECO LIODN Status - non-seq */</span>
	<span class="n">u32</span> <span class="n">td_liodn</span><span class="p">;</span>	<span class="cm">/* DxLSR - DECO LIODN Status - trustdesc */</span>
	<span class="n">u32</span> <span class="n">rsvd26</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">u64</span> <span class="n">math</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>		<span class="cm">/* DxMTH - Math register */</span>
	<span class="n">u32</span> <span class="n">rsvd27</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">deco_sg_table</span> <span class="n">gthr_tbl</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>	<span class="cm">/* DxGTR - Gather Tables */</span>
	<span class="n">u32</span> <span class="n">rsvd28</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">deco_sg_table</span> <span class="n">sctr_tbl</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>	<span class="cm">/* DxSTR - Scatter Tables */</span>
	<span class="n">u32</span> <span class="n">rsvd29</span><span class="p">[</span><span class="mi">48</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">descbuf</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>	<span class="cm">/* DxDESB - Descriptor buffer */</span>
	<span class="n">u32</span> <span class="n">rsvd30</span><span class="p">[</span><span class="mi">320</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Current top-level view of memory map is:</span>
<span class="cm"> *</span>
<span class="cm"> * 0x0000 - 0x0fff - CAAM Top-Level Control</span>
<span class="cm"> * 0x1000 - 0x1fff - Job Ring 0</span>
<span class="cm"> * 0x2000 - 0x2fff - Job Ring 1</span>
<span class="cm"> * 0x3000 - 0x3fff - Job Ring 2</span>
<span class="cm"> * 0x4000 - 0x4fff - Job Ring 3</span>
<span class="cm"> * 0x5000 - 0x5fff - (unused)</span>
<span class="cm"> * 0x6000 - 0x6fff - Assurance Controller</span>
<span class="cm"> * 0x7000 - 0x7fff - Queue Interface</span>
<span class="cm"> * 0x8000 - 0x8fff - DECO-CCB 0</span>
<span class="cm"> * 0x9000 - 0x9fff - DECO-CCB 1</span>
<span class="cm"> * 0xa000 - 0xafff - DECO-CCB 2</span>
<span class="cm"> * 0xb000 - 0xbfff - DECO-CCB 3</span>
<span class="cm"> * 0xc000 - 0xcfff - DECO-CCB 4</span>
<span class="cm"> *</span>
<span class="cm"> * caam_full describes the full register view of CAAM if useful,</span>
<span class="cm"> * although many configurations may choose to implement parts of</span>
<span class="cm"> * the register map separately, in differing privilege regions</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">caam_full</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">caam_ctrl</span> <span class="n">__iomem</span> <span class="n">ctrl</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">caam_job_ring</span> <span class="n">jr</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">u64</span> <span class="n">rsvd</span><span class="p">[</span><span class="mi">512</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">caam_assurance</span> <span class="n">assure</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">caam_queue_if</span> <span class="n">qi</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="cm">/* REGS_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
