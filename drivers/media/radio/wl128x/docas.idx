f | fmdrv_tx.h | s | 1.3K | 33 | Xi Wang | xi.wang@gmail.com | 1325271712 |  | [media] wl128x: fmdrv_tx: fix signedness bugs  Message-Id: <1322820073-19347-4-git-send-email-xi.wang@gmail.com>  The error handling with (ret < 0) didn't work where ret is a u32. Use int instead.  To be consistent we also change the functions to return an int.  Signed-off-by: Xi Wang <xi.wang@gmail.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | fmdrv_rx.c | s | 19K | 692 | Xi Wang | xi.wang@gmail.com | 1325271698 |  | [media] wl128x: fmdrv_rx: fix signedness bugs  Message-Id: <1322820073-19347-3-git-send-email-xi.wang@gmail.com>  The error handling with (ret < 0) didn't work where ret is a u32. Use int instead.  To be consistent we also change the functions to return an int.  Signed-off-by: Xi Wang <xi.wang@gmail.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | fmdrv_tx.c | s | 9.1K | 338 | Xi Wang | xi.wang@gmail.com | 1325271712 |  | [media] wl128x: fmdrv_tx: fix signedness bugs  Message-Id: <1322820073-19347-4-git-send-email-xi.wang@gmail.com>  The error handling with (ret < 0) didn't work where ret is a u32. Use int instead.  To be consistent we also change the functions to return an int.  Signed-off-by: Xi Wang <xi.wang@gmail.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | Makefile | g | 178B |  | Manjunatha Halli | manjunatha_halli@ti.com | 1300750356 |  | [media] drivers:media:radio: wl128x: Kconfig & Makefile for wl128x driver  Signed-off-by: Manjunatha Halli <manjunatha_halli@ti.com> Reviewed-by: Hans Verkuil <hverkuil@xs4all.nl> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | fmdrv_v4l2.c | s | 14K | 480 | Hans Verkuil | hans.verkuil@cisco.com | 1336997978 |  | [media] v4l2-dev: add flag to have the core lock all file operations  This used to be the default if the lock pointer was set, but now that lock is by default only used for ioctl serialization. Those drivers that already used core locking have this flag set explicitly, except for some drivers where it was obvious that there was no need to serialize any file operations other than ioctl.  The drivers that didn't need this flag were:  drivers/media/radio/dsbr100.c drivers/media/radio/radio-isa.c drivers/media/radio/radio-keene.c drivers/media/radio/radio-miropcm20.c drivers/media/radio/radio-mr800.c drivers/media/radio/radio-tea5764.c drivers/media/radio/radio-timb.c drivers/media/video/vivi.c sound/i2c/other/tea575x-tuner.c  The other drivers that use core locking and where it was not immediately obvious that this flag wasn't needed were changed so that the flag is set together with a comment that that driver needs work to avoid having to set that flag. This will often involve taking the core lock in the fops themselves.  Eventually this flag should go and it should not be used in new drivers.  There are a few reasons why we want to avoid core locking of non-ioctl fops: in the case of mmap this can lead to a deadlock in rare situations since when mmap is called the mmap_sem is held and it is possible for other parts of the code to take that lock as well (copy_from_user()/copy_to_user() perform a down_read(&mm->mmap_sem) when a page fault occurs).  It is very unlikely that that happens since the core lock serializes all fops, but the kernel warns about it if lock validation is turned on.  For poll it is also undesirable to take the core lock as that can introduce increased latency. The same is true for read/write.  While it was possible to make flags or something to turn on/off taking the core lock for each file operation, in practice it is much simpler to just not take it at all except for ioctl and leave it to the driver to take the lock. There are only a handful fops compared to the zillion ioctls we have.  I also wanted to make it obvious which drivers still take the lock for all fops, so that's why I chose to have drivers set it explicitly.  Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com> Acked-by: Hans de Goede <hdegoede@redhat.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | fmdrv_common.c | s | 44K | 1415 | Xi Wang | xi.wang@gmail.com | 1325271656 |  | [media] wl128x: fmdrv_common: fix signedness bugs  Message-Id: <1322820073-19347-2-git-send-email-xi.wang@gmail.com>  The error handling with (ret < 0) didn't work where ret is a u32. Use int instead.  To be consistent we also change the functions to return an int.  Signed-off-by: Xi Wang <xi.wang@gmail.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | fmdrv.h | s | 6.1K | 215 | Mauro Carvalho Chehab | mchehab@redhat.com | 1311799996 |  | [media] radio: Use the subsystem version control for VIDIOC_QUERYCAP  Just like the video drivers, the right thing to do is to use the per-subsystem version control.  Acked-by: Hans Verkuil <hans.verkuil@cisco.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | fmdrv_v4l2.h | s | 1.0K | 29 | Manjunatha Halli | manjunatha_halli@ti.com | 1300750355 |  | [media] drivers:media:radio: wl128x: FM Driver V4L2 sources  This module interfaces V4L2 subsystem and FM common module. It registers itself with V4L2 as Radio module.  Signed-off-by: Manjunatha Halli <manjunatha_halli@ti.com> Reviewed-by: Hans Verkuil <hverkuil@xs4all.nl> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | Kconfig | g | 539B |  | Randy Dunlap | rdunlap@xenotime.net | 1329317220 |  | [media] wl128x: fix build errors when GPIOLIB is not enabled  From: Randy Dunlap <rdunlap@xenotime.net>  Fix wl128x Kconfig to depend on GPIOLIB since TI_ST also depends on GPIOLIB.  (.text+0xe6d60): undefined reference to `st_register' (.text+0xe7016): undefined reference to `st_unregister' (.text+0xe70ce): undefined reference to `st_unregister'  Signed-off-by: Randy Dunlap <rdunlap@xenotime.net> Acked-by: Manjunatha Halli <manjunatha_halli@ti.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | fmdrv_rx.h | s | 2.2K | 52 | Xi Wang | xi.wang@gmail.com | 1325271698 |  | [media] wl128x: fmdrv_rx: fix signedness bugs  Message-Id: <1322820073-19347-3-git-send-email-xi.wang@gmail.com>  The error handling with (ret < 0) didn't work where ret is a u32. Use int instead.  To be consistent we also change the functions to return an int.  Signed-off-by: Xi Wang <xi.wang@gmail.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | fmdrv_common.h | s | 12K | 344 | Xi Wang | xi.wang@gmail.com | 1325271656 |  | [media] wl128x: fmdrv_common: fix signedness bugs  Message-Id: <1322820073-19347-2-git-send-email-xi.wang@gmail.com>  The error handling with (ret < 0) didn't work where ret is a u32. Use int instead.  To be consistent we also change the functions to return an int.  Signed-off-by: Xi Wang <xi.wang@gmail.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
