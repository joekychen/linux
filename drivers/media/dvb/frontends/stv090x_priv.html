<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › media › dvb › frontends › stv090x_priv.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>stv090x_priv.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm">	STV0900/0903 Multistandard Broadcast Frontend driver</span>
<span class="cm">	Copyright (C) Manu Abraham &lt;abraham.manu@gmail.com&gt;</span>

<span class="cm">	Copyright (C) ST Microelectronics</span>

<span class="cm">	This program is free software; you can redistribute it and/or modify</span>
<span class="cm">	it under the terms of the GNU General Public License as published by</span>
<span class="cm">	the Free Software Foundation; either version 2 of the License, or</span>
<span class="cm">	(at your option) any later version.</span>

<span class="cm">	This program is distributed in the hope that it will be useful,</span>
<span class="cm">	but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm">	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm">	GNU General Public License for more details.</span>

<span class="cm">	You should have received a copy of the GNU General Public License</span>
<span class="cm">	along with this program; if not, write to the Free Software</span>
<span class="cm">	Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span>
<span class="cm">*/</span>

<span class="cp">#ifndef __STV090x_PRIV_H</span>
<span class="cp">#define __STV090x_PRIV_H</span>

<span class="cp">#include &quot;dvb_frontend.h&quot;</span>

<span class="cp">#define FE_ERROR				0</span>
<span class="cp">#define FE_NOTICE				1</span>
<span class="cp">#define FE_INFO					2</span>
<span class="cp">#define FE_DEBUG				3</span>
<span class="cp">#define FE_DEBUGREG				4</span>

<span class="cp">#define dprintk(__y, __z, format, arg...) do {						\</span>
<span class="cp">	if (__z) {									\</span>
<span class="cp">		if	((verbose &gt; FE_ERROR) &amp;&amp; (verbose &gt; __y))			\</span>
<span class="cp">			printk(KERN_ERR &quot;%s: &quot; format &quot;\n&quot;, __func__ , ##arg);		\</span>
<span class="cp">		else if	((verbose &gt; FE_NOTICE) &amp;&amp; (verbose &gt; __y))			\</span>
<span class="cp">			printk(KERN_NOTICE &quot;%s: &quot; format &quot;\n&quot;, __func__ , ##arg);	\</span>
<span class="cp">		else if ((verbose &gt; FE_INFO) &amp;&amp; (verbose &gt; __y))			\</span>
<span class="cp">			printk(KERN_INFO &quot;%s: &quot; format &quot;\n&quot;, __func__ , ##arg);		\</span>
<span class="cp">		else if ((verbose &gt; FE_DEBUG) &amp;&amp; (verbose &gt; __y))			\</span>
<span class="cp">			printk(KERN_DEBUG &quot;%s: &quot; format &quot;\n&quot;, __func__ , ##arg);	\</span>
<span class="cp">	} else {									\</span>
<span class="cp">		if (verbose &gt; __y)							\</span>
<span class="cp">			printk(format, ##arg);						\</span>
<span class="cp">	}										\</span>
<span class="cp">} while (0)</span>

<span class="cp">#define STV090x_READ_DEMOD(__state, __reg) ((			\</span>
<span class="cp">	(__state)-&gt;demod == STV090x_DEMODULATOR_1)	?	\</span>
<span class="cp">	stv090x_read_reg(__state, STV090x_P2_##__reg) :		\</span>
<span class="cp">	stv090x_read_reg(__state, STV090x_P1_##__reg))</span>

<span class="cp">#define STV090x_WRITE_DEMOD(__state, __reg, __data) ((		\</span>
<span class="cp">	(__state)-&gt;demod == STV090x_DEMODULATOR_1)	?	\</span>
<span class="cp">	stv090x_write_reg(__state, STV090x_P2_##__reg, __data) :\</span>
<span class="cp">	stv090x_write_reg(__state, STV090x_P1_##__reg, __data))</span>

<span class="cp">#define STV090x_ADDR_OFFST(__state, __x) ((			\</span>
<span class="cp">	(__state-&gt;demod) == STV090x_DEMODULATOR_1)	?	\</span>
<span class="cp">		STV090x_P1_##__x :				\</span>
<span class="cp">		STV090x_P2_##__x)</span>


<span class="cp">#define STV090x_SETFIELD(mask, bitf, val)	(mask = (mask &amp; (~(((1 &lt;&lt; STV090x_WIDTH_##bitf) - 1) &lt;&lt;\</span>
<span class="cp">							 STV090x_OFFST_##bitf))) | \</span>
<span class="cp">							 (val &lt;&lt; STV090x_OFFST_##bitf))</span>

<span class="cp">#define STV090x_GETFIELD(val, bitf)		((val &gt;&gt; STV090x_OFFST_##bitf) &amp; ((1 &lt;&lt; STV090x_WIDTH_##bitf) - 1))</span>


<span class="cp">#define STV090x_SETFIELD_Px(mask, bitf, val)	(mask = (mask &amp; (~(((1 &lt;&lt; STV090x_WIDTH_Px_##bitf) - 1) &lt;&lt;\</span>
<span class="cp">							 STV090x_OFFST_Px_##bitf))) | \</span>
<span class="cp">							 (val &lt;&lt; STV090x_OFFST_Px_##bitf))</span>

<span class="cp">#define STV090x_GETFIELD_Px(val, bitf)		((val &gt;&gt; STV090x_OFFST_Px_##bitf) &amp; ((1 &lt;&lt; STV090x_WIDTH_Px_##bitf) - 1))</span>

<span class="cp">#define MAKEWORD16(__a, __b)			(((__a) &lt;&lt; 8) | (__b))</span>

<span class="cp">#define MSB(__x)				((__x &gt;&gt; 8) &amp; 0xff)</span>
<span class="cp">#define LSB(__x)				(__x &amp; 0xff)</span>


<span class="cp">#define STV090x_IQPOWER_THRESHOLD	  30</span>
<span class="cp">#define STV090x_SEARCH_AGC2_TH_CUT20	 700</span>
<span class="cp">#define STV090x_SEARCH_AGC2_TH_CUT30	1400</span>

<span class="cp">#define STV090x_SEARCH_AGC2_TH(__ver)	\</span>
<span class="cp">	((__ver &lt;= 0x20) ?		\</span>
<span class="cp">	STV090x_SEARCH_AGC2_TH_CUT20 :	\</span>
<span class="cp">	STV090x_SEARCH_AGC2_TH_CUT30)</span>

<span class="k">enum</span> <span class="n">stv090x_signal_state</span> <span class="p">{</span>
	<span class="n">STV090x_NOAGC1</span><span class="p">,</span>
	<span class="n">STV090x_NOCARRIER</span><span class="p">,</span>
	<span class="n">STV090x_NODATA</span><span class="p">,</span>
	<span class="n">STV090x_DATAOK</span><span class="p">,</span>
	<span class="n">STV090x_RANGEOK</span><span class="p">,</span>
	<span class="n">STV090x_OUTOFRANGE</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">stv090x_fec</span> <span class="p">{</span>
	<span class="n">STV090x_PR12</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">STV090x_PR23</span><span class="p">,</span>
	<span class="n">STV090x_PR34</span><span class="p">,</span>
	<span class="n">STV090x_PR45</span><span class="p">,</span>
	<span class="n">STV090x_PR56</span><span class="p">,</span>
	<span class="n">STV090x_PR67</span><span class="p">,</span>
	<span class="n">STV090x_PR78</span><span class="p">,</span>
	<span class="n">STV090x_PR89</span><span class="p">,</span>
	<span class="n">STV090x_PR910</span><span class="p">,</span>
	<span class="n">STV090x_PRERR</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">stv090x_modulation</span> <span class="p">{</span>
	<span class="n">STV090x_QPSK</span><span class="p">,</span>
	<span class="n">STV090x_8PSK</span><span class="p">,</span>
	<span class="n">STV090x_16APSK</span><span class="p">,</span>
	<span class="n">STV090x_32APSK</span><span class="p">,</span>
	<span class="n">STV090x_UNKNOWN</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">stv090x_frame</span> <span class="p">{</span>
	<span class="n">STV090x_LONG_FRAME</span><span class="p">,</span>
	<span class="n">STV090x_SHORT_FRAME</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">stv090x_pilot</span> <span class="p">{</span>
	<span class="n">STV090x_PILOTS_OFF</span><span class="p">,</span>
	<span class="n">STV090x_PILOTS_ON</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">stv090x_rolloff</span> <span class="p">{</span>
	<span class="n">STV090x_RO_35</span><span class="p">,</span>
	<span class="n">STV090x_RO_25</span><span class="p">,</span>
	<span class="n">STV090x_RO_20</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">stv090x_inversion</span> <span class="p">{</span>
	<span class="n">STV090x_IQ_AUTO</span><span class="p">,</span>
	<span class="n">STV090x_IQ_NORMAL</span><span class="p">,</span>
	<span class="n">STV090x_IQ_SWAP</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">stv090x_modcod</span> <span class="p">{</span>
	<span class="n">STV090x_DUMMY_PLF</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">STV090x_QPSK_14</span><span class="p">,</span>
	<span class="n">STV090x_QPSK_13</span><span class="p">,</span>
	<span class="n">STV090x_QPSK_25</span><span class="p">,</span>
	<span class="n">STV090x_QPSK_12</span><span class="p">,</span>
	<span class="n">STV090x_QPSK_35</span><span class="p">,</span>
	<span class="n">STV090x_QPSK_23</span><span class="p">,</span>
	<span class="n">STV090x_QPSK_34</span><span class="p">,</span>
	<span class="n">STV090x_QPSK_45</span><span class="p">,</span>
	<span class="n">STV090x_QPSK_56</span><span class="p">,</span>
	<span class="n">STV090x_QPSK_89</span><span class="p">,</span>
	<span class="n">STV090x_QPSK_910</span><span class="p">,</span>
	<span class="n">STV090x_8PSK_35</span><span class="p">,</span>
	<span class="n">STV090x_8PSK_23</span><span class="p">,</span>
	<span class="n">STV090x_8PSK_34</span><span class="p">,</span>
	<span class="n">STV090x_8PSK_56</span><span class="p">,</span>
	<span class="n">STV090x_8PSK_89</span><span class="p">,</span>
	<span class="n">STV090x_8PSK_910</span><span class="p">,</span>
	<span class="n">STV090x_16APSK_23</span><span class="p">,</span>
	<span class="n">STV090x_16APSK_34</span><span class="p">,</span>
	<span class="n">STV090x_16APSK_45</span><span class="p">,</span>
	<span class="n">STV090x_16APSK_56</span><span class="p">,</span>
	<span class="n">STV090x_16APSK_89</span><span class="p">,</span>
	<span class="n">STV090x_16APSK_910</span><span class="p">,</span>
	<span class="n">STV090x_32APSK_34</span><span class="p">,</span>
	<span class="n">STV090x_32APSK_45</span><span class="p">,</span>
	<span class="n">STV090x_32APSK_56</span><span class="p">,</span>
	<span class="n">STV090x_32APSK_89</span><span class="p">,</span>
	<span class="n">STV090x_32APSK_910</span><span class="p">,</span>
	<span class="n">STV090x_MODCODE_UNKNOWN</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">stv090x_search</span> <span class="p">{</span>
	<span class="n">STV090x_SEARCH_DSS</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">STV090x_SEARCH_DVBS1</span><span class="p">,</span>
	<span class="n">STV090x_SEARCH_DVBS2</span><span class="p">,</span>
	<span class="n">STV090x_SEARCH_AUTO</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">stv090x_algo</span> <span class="p">{</span>
	<span class="n">STV090x_BLIND_SEARCH</span><span class="p">,</span>
	<span class="n">STV090x_COLD_SEARCH</span><span class="p">,</span>
	<span class="n">STV090x_WARM_SEARCH</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">stv090x_delsys</span> <span class="p">{</span>
	<span class="n">STV090x_ERROR</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">STV090x_DVBS1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">STV090x_DVBS2</span><span class="p">,</span>
	<span class="n">STV090x_DSS</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">stv090x_long_frame_crloop</span> <span class="p">{</span>
	<span class="k">enum</span> <span class="n">stv090x_modcod</span>	<span class="n">modcod</span><span class="p">;</span>

	<span class="n">u8</span> <span class="n">crl_pilots_on_2</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">crl_pilots_off_2</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">crl_pilots_on_5</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">crl_pilots_off_5</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">crl_pilots_on_10</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">crl_pilots_off_10</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">crl_pilots_on_20</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">crl_pilots_off_20</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">crl_pilots_on_30</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">crl_pilots_off_30</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">stv090x_short_frame_crloop</span> <span class="p">{</span>
	<span class="k">enum</span> <span class="n">stv090x_modulation</span>	<span class="n">modulation</span><span class="p">;</span>

	<span class="n">u8</span> <span class="n">crl_2</span><span class="p">;</span>  <span class="cm">/*      SR &lt;   3M */</span>
	<span class="n">u8</span> <span class="n">crl_5</span><span class="p">;</span>  <span class="cm">/*  3 &lt; SR &lt;=  7M */</span>
	<span class="n">u8</span> <span class="n">crl_10</span><span class="p">;</span> <span class="cm">/*  7 &lt; SR &lt;= 15M */</span>
	<span class="n">u8</span> <span class="n">crl_20</span><span class="p">;</span> <span class="cm">/* 10 &lt; SR &lt;= 25M */</span>
	<span class="n">u8</span> <span class="n">crl_30</span><span class="p">;</span> <span class="cm">/* 10 &lt; SR &lt;= 45M */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">stv090x_reg</span> <span class="p">{</span>
	<span class="n">u16</span> <span class="n">addr</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">data</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">stv090x_tab</span> <span class="p">{</span>
	<span class="n">s32</span> <span class="n">real</span><span class="p">;</span>
	<span class="n">s32</span> <span class="n">read</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">stv090x_internal</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">i2c_adapter</span> 	<span class="o">*</span><span class="n">i2c_adap</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">i2c_addr</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">mutex</span>		<span class="n">demod_lock</span><span class="p">;</span> <span class="cm">/* Lock access to shared register */</span>
	<span class="k">struct</span> <span class="n">mutex</span>		<span class="n">tuner_lock</span><span class="p">;</span> <span class="cm">/* Lock access to tuners */</span>
	<span class="n">s32</span>			<span class="n">mclk</span><span class="p">;</span> <span class="cm">/* Masterclock Divider factor */</span>
	<span class="n">u32</span>			<span class="n">dev_ver</span><span class="p">;</span>

	<span class="kt">int</span>			<span class="n">num_used</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">stv090x_state</span> <span class="p">{</span>
	<span class="k">enum</span> <span class="n">stv090x_device</span>		<span class="n">device</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">stv090x_demodulator</span>	<span class="n">demod</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">stv090x_mode</span>		<span class="n">demod_mode</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">stv090x_internal</span>		<span class="o">*</span><span class="n">internal</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">i2c_adapter</span>		<span class="o">*</span><span class="n">i2c</span><span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">stv090x_config</span>	<span class="o">*</span><span class="n">config</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">dvb_frontend</span>		<span class="n">frontend</span><span class="p">;</span>

	<span class="n">u32</span>				<span class="o">*</span><span class="n">verbose</span><span class="p">;</span> <span class="cm">/* Cached module verbosity */</span>

	<span class="k">enum</span> <span class="n">stv090x_delsys</span>		<span class="n">delsys</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">stv090x_fec</span>		<span class="n">fec</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">stv090x_modulation</span>		<span class="n">modulation</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">stv090x_modcod</span>		<span class="n">modcod</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">stv090x_search</span>		<span class="n">search_mode</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">stv090x_frame</span>		<span class="n">frame_len</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">stv090x_pilot</span>		<span class="n">pilots</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">stv090x_rolloff</span>		<span class="n">rolloff</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">stv090x_inversion</span>		<span class="n">inversion</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">stv090x_algo</span>		<span class="n">algo</span><span class="p">;</span>

	<span class="n">u32</span>				<span class="n">frequency</span><span class="p">;</span>
	<span class="n">u32</span>				<span class="n">srate</span><span class="p">;</span>

	<span class="n">s32</span>				<span class="n">tuner_bw</span><span class="p">;</span>

	<span class="n">s32</span>				<span class="n">search_range</span><span class="p">;</span>

	<span class="n">s32</span>				<span class="n">DemodTimeout</span><span class="p">;</span>
	<span class="n">s32</span>				<span class="n">FecTimeout</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="cm">/* __STV090x_PRIV_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
