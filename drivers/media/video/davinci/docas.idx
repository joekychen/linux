f | vpbe_osd.c | s | 42K | 1445 | Rob Herring | rob.herring@calxeda.com | 1331091279 |  | [media] davinci: remove includes of mach/io.h  Remove a few remaining includes of mach/io.h.  Signed-off-by: Rob Herring <rob.herring@calxeda.com> Cc: Mauro Carvalho Chehab <mchehab@infradead.org>
f | dm644x_ccdc.c | s | 31K | 963 | Axel Lin | axel.lin@gmail.com | 1326245233 |  | [media] convert drivers/media/* to use module_platform_driver()  This patch converts the drivers in drivers/media/* to use the module_platform_driver() macro which makes the code smaller and a bit simpler.  Cc: Mauro Carvalho Chehab <mchehab@infradead.org> Cc: Laurent Pinchart <laurent.pinchart@ideasonboard.com> Cc: Kyungmin Park <kyungmin.park@samsung.com> Cc: Hans Verkuil <hans.verkuil@cisco.com> Cc: "Richard Röjfors" <richard.rojfors@pelagicore.com> Cc: "Matti J. Aaltonen" <matti.j.aaltonen@nokia.com> Cc: Lucas De Marchi <lucas.demarchi@profusion.mobi> Cc: Manjunath Hadli <manjunath.hadli@ti.com> Cc: Muralidharan Karicheri <m-karicheri2@ti.com> Cc: Anatolij Gustschin <agust@denx.de> Cc: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Cc: Marek Szyprowski <m.szyprowski@samsung.com> Cc: Robert Jarzmik <robert.jarzmik@free.fr> Cc: Jonathan Corbet <corbet@lwn.net> Cc: Daniel Drake <dsd@laptop.org> Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com> Acked-by: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Acked-by: Marek Szyprowski <m.szyprowski@samsung.com> Acked-by: Matti J. Aaltonen <matti.j.aaltonen@nokia.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | vpif_display.h | s | 5.1K | 150 | Manjunath Hadli | manjunath.hadli@ti.com | 1322852630 |  | ARM: davinci: vpif: move code to driver core header from platform  Move vpif related definitions for capture and display drivers from dm646x platform header file to vpif_types.h inside the driver as these definitions are related to driver code rather than the platform or board.  This enables reusing this IP across platforms.  Signed-off-by: Manjunath Hadli <manjunath.hadli@ti.com> Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Signed-off-by: Sekhar Nori <nsekhar@ti.com>
f | Makefile | g | 646B |  | Manjunath Hadli | manjunath.hadli@ti.com | 1311799990 |  | [media] davinci vpbe: Build infrastructure for VPBE driver  This patch adds the build infra-structure for Davinci VPBE dislay driver.  Signed-off-by: Manjunath Hadli <manjunath.hadli@ti.com> Acked-by: Muralidharan Karicheri <m-karicheri2@ti.com> Acked-by: Hans Verkuil <hverkuil@xs4all.nl> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | vpbe_venc.c | s | 17K | 586 | Rob Herring | rob.herring@calxeda.com | 1331091279 |  | [media] davinci: remove includes of mach/io.h  Remove a few remaining includes of mach/io.h.  Signed-off-by: Rob Herring <rob.herring@calxeda.com> Cc: Mauro Carvalho Chehab <mchehab@infradead.org>
f | vpif_capture.c | s | 62K | 2087 | Hans Verkuil | hans.verkuil@cisco.com | 1336997978 |  | [media] v4l2-dev: add flag to have the core lock all file operations  This used to be the default if the lock pointer was set, but now that lock is by default only used for ioctl serialization. Those drivers that already used core locking have this flag set explicitly, except for some drivers where it was obvious that there was no need to serialize any file operations other than ioctl.  The drivers that didn't need this flag were:  drivers/media/radio/dsbr100.c drivers/media/radio/radio-isa.c drivers/media/radio/radio-keene.c drivers/media/radio/radio-miropcm20.c drivers/media/radio/radio-mr800.c drivers/media/radio/radio-tea5764.c drivers/media/radio/radio-timb.c drivers/media/video/vivi.c sound/i2c/other/tea575x-tuner.c  The other drivers that use core locking and where it was not immediately obvious that this flag wasn't needed were changed so that the flag is set together with a comment that that driver needs work to avoid having to set that flag. This will often involve taking the core lock in the fops themselves.  Eventually this flag should go and it should not be used in new drivers.  There are a few reasons why we want to avoid core locking of non-ioctl fops: in the case of mmap this can lead to a deadlock in rare situations since when mmap is called the mmap_sem is held and it is possible for other parts of the code to take that lock as well (copy_from_user()/copy_to_user() perform a down_read(&mm->mmap_sem) when a page fault occurs).  It is very unlikely that that happens since the core lock serializes all fops, but the kernel warns about it if lock validation is turned on.  For poll it is also undesirable to take the core lock as that can introduce increased latency. The same is true for read/write.  While it was possible to make flags or something to turn on/off taking the core lock for each file operation, in practice it is much simpler to just not take it at all except for ioctl and leave it to the driver to take the lock. There are only a handful fops compared to the zillion ioctls we have.  I also wanted to make it obvious which drivers still take the lock for all fops, so that's why I chose to have drivers set it explicitly.  Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com> Acked-by: Hans de Goede <hdegoede@redhat.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | vpif_display.c | s | 49K | 1623 | Hans Verkuil | hans.verkuil@cisco.com | 1336997978 |  | [media] v4l2-dev: add flag to have the core lock all file operations  This used to be the default if the lock pointer was set, but now that lock is by default only used for ioctl serialization. Those drivers that already used core locking have this flag set explicitly, except for some drivers where it was obvious that there was no need to serialize any file operations other than ioctl.  The drivers that didn't need this flag were:  drivers/media/radio/dsbr100.c drivers/media/radio/radio-isa.c drivers/media/radio/radio-keene.c drivers/media/radio/radio-miropcm20.c drivers/media/radio/radio-mr800.c drivers/media/radio/radio-tea5764.c drivers/media/radio/radio-timb.c drivers/media/video/vivi.c sound/i2c/other/tea575x-tuner.c  The other drivers that use core locking and where it was not immediately obvious that this flag wasn't needed were changed so that the flag is set together with a comment that that driver needs work to avoid having to set that flag. This will often involve taking the core lock in the fops themselves.  Eventually this flag should go and it should not be used in new drivers.  There are a few reasons why we want to avoid core locking of non-ioctl fops: in the case of mmap this can lead to a deadlock in rare situations since when mmap is called the mmap_sem is held and it is possible for other parts of the code to take that lock as well (copy_from_user()/copy_to_user() perform a down_read(&mm->mmap_sem) when a page fault occurs).  It is very unlikely that that happens since the core lock serializes all fops, but the kernel warns about it if lock validation is turned on.  For poll it is also undesirable to take the core lock as that can introduce increased latency. The same is true for read/write.  While it was possible to make flags or something to turn on/off taking the core lock for each file operation, in practice it is much simpler to just not take it at all except for ioctl and leave it to the driver to take the lock. There are only a handful fops compared to the zillion ioctls we have.  I also wanted to make it obvious which drivers still take the lock for all fops, so that's why I chose to have drivers set it explicitly.  Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com> Acked-by: Hans de Goede <hdegoede@redhat.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | dm355_ccdc_regs.h | s | 10K | 292 | Muralidharan Karicheri | m-karicheri2@ti.com | 1253330295 |  | V4L/DVB (12250): v4l: dm355 ccdc module for vpfe capture driver  Adds ccdc hw module for DM355 CCDC. This registers with the bridge driver a set of hw_ops for configuring the CCDC for a specific decoder device connected to vpfe.  Reviewed by: Hans Verkuil <hverkuil@xs4all.nl> Reviewed by: Laurent Pinchart <laurent.pinchart@skynet.be> Reviewed by: Mauro Carvalho Chehab <mchehab@infradead.org>  Signed-off-by: Muralidharan Karicheri <m-karicheri2@ti.com> Signed-off-by: Hans Verkuil <hverkuil@xs4all.nl> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | dm355_ccdc.c | s | 28K | 948 | Masanari Iida | standby24x7@gmail.com | 1329820839 |  | davinci: Fix typo in dm355_ccdvc.c  Correct spelling "thresold" to "threshold" in drivers/media/video/davinci/dm355_ccdc.c  Signed-off-by: Masanari Iida <standby24x7@gmail.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | vpif_capture.h | s | 4.8K | 148 | Manjunath Hadli | manjunath.hadli@ti.com | 1322852630 |  | ARM: davinci: vpif: move code to driver core header from platform  Move vpif related definitions for capture and display drivers from dm646x platform header file to vpif_types.h inside the driver as these definitions are related to driver code rather than the platform or board.  This enables reusing this IP across platforms.  Signed-off-by: Manjunath Hadli <manjunath.hadli@ti.com> Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Signed-off-by: Sekhar Nori <nsekhar@ti.com>
f | isif_regs.h | s | 7.7K | 251 | Mauro Carvalho Chehab | mchehab@redhat.com | 1274154421 |  | V4L/DVB: Fix bad whitespacing  Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | vpbe_osd_regs.h | s | 10K | 306 | Manjunath Hadli | manjunath.hadli@ti.com | 1311799990 |  | [media] davinci vpbe: OSD(On Screen Display) block  This patch implements the functionality of the OSD block of the VPBE. The OSD in total supports 4 planes or Video sources - 2 mainly RGB and 2 Video. The patch implements general handling of all the planes, with specific emphasis on the Video plane capabilities as the Video planes are supported through the V4L2 driver.  Signed-off-by: Manjunath Hadli <manjunath.hadli@ti.com> Acked-by: Muralidharan Karicheri <m-karicheri2@ti.com> Acked-by: Hans Verkuil <hverkuil@xs4all.nl> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | isif.c | s | 30K | 1018 | Henrique Camargo | henrique@henriquecamargo.com | 1330459614 |  | [media] media: davinci: added module.h to resolve unresolved macros  Included module.h explicitly to resolve the macros THIS_MODULE and MODULE_LICENSE. This avoids compilations errors as those defines were not declared.  Signed-off-by: Henrique Camargo <henrique@henriquecamargo.com> Signed-off-by: Diogo Luvizon <diogoluvizon@gmail.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | vpbe.c | s | 23K | 768 | Axel Lin | axel.lin@gmail.com | 1326245233 |  | [media] convert drivers/media/* to use module_platform_driver()  This patch converts the drivers in drivers/media/* to use the module_platform_driver() macro which makes the code smaller and a bit simpler.  Cc: Mauro Carvalho Chehab <mchehab@infradead.org> Cc: Laurent Pinchart <laurent.pinchart@ideasonboard.com> Cc: Kyungmin Park <kyungmin.park@samsung.com> Cc: Hans Verkuil <hans.verkuil@cisco.com> Cc: "Richard Röjfors" <richard.rojfors@pelagicore.com> Cc: "Matti J. Aaltonen" <matti.j.aaltonen@nokia.com> Cc: Lucas De Marchi <lucas.demarchi@profusion.mobi> Cc: Manjunath Hadli <manjunath.hadli@ti.com> Cc: Muralidharan Karicheri <m-karicheri2@ti.com> Cc: Anatolij Gustschin <agust@denx.de> Cc: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Cc: Marek Szyprowski <m.szyprowski@samsung.com> Cc: Robert Jarzmik <robert.jarzmik@free.fr> Cc: Jonathan Corbet <corbet@lwn.net> Cc: Daniel Drake <dsd@laptop.org> Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com> Acked-by: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Acked-by: Marek Szyprowski <m.szyprowski@samsung.com> Acked-by: Matti J. Aaltonen <matti.j.aaltonen@nokia.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | vpss.c | s | 11K | 423 | Uwe Kleine-König | u.kleine-koenig@pengutronix.de | 1288640314 |  | tree-wide: fix comment/printk typos  "gadget", "through", "command", "maintain", "maintain", "controller", "address", "between", "initiali[zs]e", "instead", "function", "select", "already", "equal", "access", "management", "hierarchy", "registration", "interest", "relative", "memory", "offset", "already",  Signed-off-by: Uwe Kleine-König <u.kleine-koenig@pengutronix.de> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | vpbe_venc_regs.h | s | 5.3K | 166 | Manjunath Hadli | manjunath.hadli@ti.com | 1311799990 |  | [media] davinci vpbe: VENC( Video Encoder) implementation  This patch adds the VENC or the Video encoder, which is responsible for the blending of all source planes and timing generation for Video modes like NTSC, PAL and other digital outputs. the VENC implementation currently supports COMPOSITE and COMPONENT outputs and NTSC and PAL resolutions through the analog DACs. The venc block is implemented as a subdevice, allowing for additional external and internal encoders of other kind to plug-in.  Signed-off-by: Manjunath Hadli <manjunath.hadli@ti.com> Acked-by: Muralidharan Karicheri <m-karicheri2@ti.com> Acked-by: Hans Verkuil <hverkuil@xs4all.nl> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | vpfe_capture.c | s | 56K | 1798 | Hans Verkuil | hans.verkuil@cisco.com | 1334867035 |  | [media] V4L2: drivers implementing vidioc_default should also return -ENOTTY  If the vidioc_default implementation doesn't support the ioctl, then drivers must return -ENOTTY instead of -EINVAL.  Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | Kconfig | g | 3.5K |  | Arnd Bergmann | arnd@arndb.de | 1337079203 |  | [media] media/video: add I2C dependencies  Davinci VIDEO_VPFE_CAPTURE depends on I2C, so reflect that in Kconfig to avoid build failures in random configurations.  Signed-off-by: Arnd Bergmann <arnd@arndb.de> Signed-off-by: Mathieu Poirier <mathieu.poirier@linaro.org> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | vpif.c | s | 11K | 423 | Joe Perches | joe@perches.com | 1307710536 |  | treewide: Convert uses of struct resource to resource_size(ptr)  Several fixes as well where the +1 was missing.  Done via coccinelle scripts like:  @@ struct resource *ptr; @@  - ptr->end - ptr->start + 1 + resource_size(ptr)  and some grep and typing.  Mostly uncompiled, no cross-compilers.  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | dm644x_ccdc_regs.h | s | 5.5K | 151 | Vaibhav Hiremath | hvaibhav@ti.com | 1274154765 |  | V4L/DVB: V4L: dm644x_ccdc: Add Suspend/Resume Support  Signed-off-by: Vaibhav Hiremath <hvaibhav@ti.com> Signed-off-by: Muralidharan Karicheri <mkaricheri@gmail.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | vpbe_display.c | s | 48K | 1564 | Hans Verkuil | hans.verkuil@cisco.com | 1336997978 |  | [media] v4l2-dev: add flag to have the core lock all file operations  This used to be the default if the lock pointer was set, but now that lock is by default only used for ioctl serialization. Those drivers that already used core locking have this flag set explicitly, except for some drivers where it was obvious that there was no need to serialize any file operations other than ioctl.  The drivers that didn't need this flag were:  drivers/media/radio/dsbr100.c drivers/media/radio/radio-isa.c drivers/media/radio/radio-keene.c drivers/media/radio/radio-miropcm20.c drivers/media/radio/radio-mr800.c drivers/media/radio/radio-tea5764.c drivers/media/radio/radio-timb.c drivers/media/video/vivi.c sound/i2c/other/tea575x-tuner.c  The other drivers that use core locking and where it was not immediately obvious that this flag wasn't needed were changed so that the flag is set together with a comment that that driver needs work to avoid having to set that flag. This will often involve taking the core lock in the fops themselves.  Eventually this flag should go and it should not be used in new drivers.  There are a few reasons why we want to avoid core locking of non-ioctl fops: in the case of mmap this can lead to a deadlock in rare situations since when mmap is called the mmap_sem is held and it is possible for other parts of the code to take that lock as well (copy_from_user()/copy_to_user() perform a down_read(&mm->mmap_sem) when a page fault occurs).  It is very unlikely that that happens since the core lock serializes all fops, but the kernel warns about it if lock validation is turned on.  For poll it is also undesirable to take the core lock as that can introduce increased latency. The same is true for read/write.  While it was possible to make flags or something to turn on/off taking the core lock for each file operation, in practice it is much simpler to just not take it at all except for ioctl and leave it to the driver to take the lock. There are only a handful fops compared to the zillion ioctls we have.  I also wanted to make it obvious which drivers still take the lock for all fops, so that's why I chose to have drivers set it explicitly.  Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com> Acked-by: Hans de Goede <hdegoede@redhat.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | vpif.h | s | 19K | 549 | Manjunath Hadli | manjunath.hadli@ti.com | 1328705214 |  | [media] davinci: vpif: remove machine specific header file includes  remove unnecessary inclusion of machine specific header files mach/dm646x.h, mach/hardware.h from vpif.h  and aslo mach/dm646x.h from vpif_display.c driver which comes in the way of platform code consolidation. Add linux/i2c.h header file in vpif_types.h which is required for building.  Signed-off-by: Manjunath Hadli <manjunath.hadli@ti.com> Cc: Mauro Carvalho Chehab <mchehab@infradead.org> Cc: LMML <linux-media@vger.kernel.org> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | ccdc_hw_device.h | s | 3.6K | 102 | Muralidharan Karicheri | m-karicheri2@ti.com | 1253330293 |  | V4L/DVB (12249): v4l: ccdc hw device header file for vpfe capture  Adds ccdc hw device header for vpfe capture driver  Reviewed by: Hans Verkuil <hverkuil@xs4all.nl> Reviewed by: Laurent Pinchart <laurent.pinchart@skynet.be>  Signed-off-by: Muralidharan Karicheri <m-karicheri2@ti.com> Signed-off-by: Hans Verkuil <hverkuil@xs4all.nl> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
