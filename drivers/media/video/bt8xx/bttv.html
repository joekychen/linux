<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › media › video › bt8xx › bttv.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>bttv.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> *</span>
<span class="cm"> *  bttv - Bt848 frame grabber driver</span>
<span class="cm"> *</span>
<span class="cm"> *  card ID&#39;s and external interfaces of the bttv driver</span>
<span class="cm"> *  basically stuff needed by other drivers (i2c, lirc, ...)</span>
<span class="cm"> *  and is supported not to change much over time.</span>
<span class="cm"> *</span>
<span class="cm"> *  Copyright (C) 1996,97 Ralph Metzler (rjkm@thp.uni-koeln.de)</span>
<span class="cm"> *  (c) 1999,2000 Gerd Knorr &lt;kraxel@goldbach.in-berlin.de&gt;</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _BTTV_H_</span>
<span class="cp">#define _BTTV_H_</span>

<span class="cp">#include &lt;linux/videodev2.h&gt;</span>
<span class="cp">#include &lt;linux/i2c.h&gt;</span>
<span class="cp">#include &lt;media/v4l2-device.h&gt;</span>
<span class="cp">#include &lt;media/i2c-addr.h&gt;</span>
<span class="cp">#include &lt;media/tuner.h&gt;</span>

<span class="cm">/* ---------------------------------------------------------- */</span>
<span class="cm">/* exported by bttv-cards.c                                   */</span>

<span class="cp">#define BTTV_BOARD_UNKNOWN                 0x00</span>
<span class="cp">#define BTTV_BOARD_MIRO                    0x01</span>
<span class="cp">#define BTTV_BOARD_HAUPPAUGE               0x02</span>
<span class="cp">#define BTTV_BOARD_STB                     0x03</span>
<span class="cp">#define BTTV_BOARD_INTEL                   0x04</span>
<span class="cp">#define BTTV_BOARD_DIAMOND                 0x05</span>
<span class="cp">#define BTTV_BOARD_AVERMEDIA               0x06</span>
<span class="cp">#define BTTV_BOARD_MATRIX_VISION           0x07</span>
<span class="cp">#define BTTV_BOARD_FLYVIDEO                0x08</span>
<span class="cp">#define BTTV_BOARD_TURBOTV                 0x09</span>
<span class="cp">#define BTTV_BOARD_HAUPPAUGE878            0x0a</span>
<span class="cp">#define BTTV_BOARD_MIROPRO                 0x0b</span>
<span class="cp">#define BTTV_BOARD_ADSTECH_TV              0x0c</span>
<span class="cp">#define BTTV_BOARD_AVERMEDIA98             0x0d</span>
<span class="cp">#define BTTV_BOARD_VHX                     0x0e</span>
<span class="cp">#define BTTV_BOARD_ZOLTRIX                 0x0f</span>
<span class="cp">#define BTTV_BOARD_PIXVIEWPLAYTV           0x10</span>
<span class="cp">#define BTTV_BOARD_WINVIEW_601             0x11</span>
<span class="cp">#define BTTV_BOARD_AVEC_INTERCAP           0x12</span>
<span class="cp">#define BTTV_BOARD_LIFE_FLYKIT             0x13</span>
<span class="cp">#define BTTV_BOARD_CEI_RAFFLES             0x14</span>
<span class="cp">#define BTTV_BOARD_CONFERENCETV            0x15</span>
<span class="cp">#define BTTV_BOARD_PHOEBE_TVMAS            0x16</span>
<span class="cp">#define BTTV_BOARD_MODTEC_205              0x17</span>
<span class="cp">#define BTTV_BOARD_MAGICTVIEW061           0x18</span>
<span class="cp">#define BTTV_BOARD_VOBIS_BOOSTAR           0x19</span>
<span class="cp">#define BTTV_BOARD_HAUPPAUG_WCAM           0x1a</span>
<span class="cp">#define BTTV_BOARD_MAXI                    0x1b</span>
<span class="cp">#define BTTV_BOARD_TERRATV                 0x1c</span>
<span class="cp">#define BTTV_BOARD_PXC200                  0x1d</span>
<span class="cp">#define BTTV_BOARD_FLYVIDEO_98             0x1e</span>
<span class="cp">#define BTTV_BOARD_IPROTV                  0x1f</span>
<span class="cp">#define BTTV_BOARD_INTEL_C_S_PCI           0x20</span>
<span class="cp">#define BTTV_BOARD_TERRATVALUE             0x21</span>
<span class="cp">#define BTTV_BOARD_WINFAST2000             0x22</span>
<span class="cp">#define BTTV_BOARD_CHRONOS_VS2             0x23</span>
<span class="cp">#define BTTV_BOARD_TYPHOON_TVIEW           0x24</span>
<span class="cp">#define BTTV_BOARD_PXELVWPLTVPRO           0x25</span>
<span class="cp">#define BTTV_BOARD_MAGICTVIEW063           0x26</span>
<span class="cp">#define BTTV_BOARD_PINNACLE                0x27</span>
<span class="cp">#define BTTV_BOARD_STB2                    0x28</span>
<span class="cp">#define BTTV_BOARD_AVPHONE98               0x29</span>
<span class="cp">#define BTTV_BOARD_PV951                   0x2a</span>
<span class="cp">#define BTTV_BOARD_ONAIR_TV                0x2b</span>
<span class="cp">#define BTTV_BOARD_SIGMA_TVII_FM           0x2c</span>
<span class="cp">#define BTTV_BOARD_MATRIX_VISION2          0x2d</span>
<span class="cp">#define BTTV_BOARD_ZOLTRIX_GENIE           0x2e</span>
<span class="cp">#define BTTV_BOARD_TERRATVRADIO            0x2f</span>
<span class="cp">#define BTTV_BOARD_DYNALINK                0x30</span>
<span class="cp">#define BTTV_BOARD_GVBCTV3PCI              0x31</span>
<span class="cp">#define BTTV_BOARD_PXELVWPLTVPAK           0x32</span>
<span class="cp">#define BTTV_BOARD_EAGLE                   0x33</span>
<span class="cp">#define BTTV_BOARD_PINNACLEPRO             0x34</span>
<span class="cp">#define BTTV_BOARD_TVIEW_RDS_FM            0x35</span>
<span class="cp">#define BTTV_BOARD_LIFETEC_9415            0x36</span>
<span class="cp">#define BTTV_BOARD_BESTBUY_EASYTV          0x37</span>
<span class="cp">#define BTTV_BOARD_FLYVIDEO_98FM           0x38</span>
<span class="cp">#define BTTV_BOARD_GRANDTEC                0x39</span>
<span class="cp">#define BTTV_BOARD_ASKEY_CPH060            0x3a</span>
<span class="cp">#define BTTV_BOARD_ASKEY_CPH03X            0x3b</span>
<span class="cp">#define BTTV_BOARD_MM100PCTV               0x3c</span>
<span class="cp">#define BTTV_BOARD_GMV1                    0x3d</span>
<span class="cp">#define BTTV_BOARD_BESTBUY_EASYTV2         0x3e</span>
<span class="cp">#define BTTV_BOARD_ATI_TVWONDER            0x3f</span>
<span class="cp">#define BTTV_BOARD_ATI_TVWONDERVE          0x40</span>
<span class="cp">#define BTTV_BOARD_FLYVIDEO2000            0x41</span>
<span class="cp">#define BTTV_BOARD_TERRATVALUER            0x42</span>
<span class="cp">#define BTTV_BOARD_GVBCTV4PCI              0x43</span>
<span class="cp">#define BTTV_BOARD_VOODOOTV_FM             0x44</span>
<span class="cp">#define BTTV_BOARD_AIMMS                   0x45</span>
<span class="cp">#define BTTV_BOARD_PV_BT878P_PLUS          0x46</span>
<span class="cp">#define BTTV_BOARD_FLYVIDEO98EZ            0x47</span>
<span class="cp">#define BTTV_BOARD_PV_BT878P_9B            0x48</span>
<span class="cp">#define BTTV_BOARD_SENSORAY311_611         0x49</span>
<span class="cp">#define BTTV_BOARD_RV605                   0x4a</span>
<span class="cp">#define BTTV_BOARD_POWERCLR_MTV878         0x4b</span>
<span class="cp">#define BTTV_BOARD_WINDVR                  0x4c</span>
<span class="cp">#define BTTV_BOARD_GRANDTEC_MULTI          0x4d</span>
<span class="cp">#define BTTV_BOARD_KWORLD                  0x4e</span>
<span class="cp">#define BTTV_BOARD_DSP_TCVIDEO             0x4f</span>
<span class="cp">#define BTTV_BOARD_HAUPPAUGEPVR            0x50</span>
<span class="cp">#define BTTV_BOARD_GVBCTV5PCI              0x51</span>
<span class="cp">#define BTTV_BOARD_OSPREY1x0               0x52</span>
<span class="cp">#define BTTV_BOARD_OSPREY1x0_848           0x53</span>
<span class="cp">#define BTTV_BOARD_OSPREY101_848           0x54</span>
<span class="cp">#define BTTV_BOARD_OSPREY1x1               0x55</span>
<span class="cp">#define BTTV_BOARD_OSPREY1x1_SVID          0x56</span>
<span class="cp">#define BTTV_BOARD_OSPREY2xx               0x57</span>
<span class="cp">#define BTTV_BOARD_OSPREY2x0_SVID          0x58</span>
<span class="cp">#define BTTV_BOARD_OSPREY2x0               0x59</span>
<span class="cp">#define BTTV_BOARD_OSPREY500               0x5a</span>
<span class="cp">#define BTTV_BOARD_OSPREY540               0x5b</span>
<span class="cp">#define BTTV_BOARD_OSPREY2000              0x5c</span>
<span class="cp">#define BTTV_BOARD_IDS_EAGLE               0x5d</span>
<span class="cp">#define BTTV_BOARD_PINNACLESAT             0x5e</span>
<span class="cp">#define BTTV_BOARD_FORMAC_PROTV            0x5f</span>
<span class="cp">#define BTTV_BOARD_MACHTV                  0x60</span>
<span class="cp">#define BTTV_BOARD_EURESYS_PICOLO          0x61</span>
<span class="cp">#define BTTV_BOARD_PV150                   0x62</span>
<span class="cp">#define BTTV_BOARD_AD_TVK503               0x63</span>
<span class="cp">#define BTTV_BOARD_HERCULES_SM_TV          0x64</span>
<span class="cp">#define BTTV_BOARD_PACETV                  0x65</span>
<span class="cp">#define BTTV_BOARD_IVC200                  0x66</span>
<span class="cp">#define BTTV_BOARD_XGUARD                  0x67</span>
<span class="cp">#define BTTV_BOARD_NEBULA_DIGITV           0x68</span>
<span class="cp">#define BTTV_BOARD_PV143                   0x69</span>
<span class="cp">#define BTTV_BOARD_VD009X1_VD011_MINIDIN   0x6a</span>
<span class="cp">#define BTTV_BOARD_VD009X1_VD011_COMBI     0x6b</span>
<span class="cp">#define BTTV_BOARD_VD009_MINIDIN           0x6c</span>
<span class="cp">#define BTTV_BOARD_VD009_COMBI             0x6d</span>
<span class="cp">#define BTTV_BOARD_IVC100                  0x6e</span>
<span class="cp">#define BTTV_BOARD_IVC120                  0x6f</span>
<span class="cp">#define BTTV_BOARD_PC_HDTV                 0x70</span>
<span class="cp">#define BTTV_BOARD_TWINHAN_DST             0x71</span>
<span class="cp">#define BTTV_BOARD_WINFASTVC100            0x72</span>
<span class="cp">#define BTTV_BOARD_TEV560                  0x73</span>
<span class="cp">#define BTTV_BOARD_SIMUS_GVC1100           0x74</span>
<span class="cp">#define BTTV_BOARD_NGSTV_PLUS              0x75</span>
<span class="cp">#define BTTV_BOARD_LMLBT4                  0x76</span>
<span class="cp">#define BTTV_BOARD_TEKRAM_M205             0x77</span>
<span class="cp">#define BTTV_BOARD_CONTVFMI                0x78</span>
<span class="cp">#define BTTV_BOARD_PICOLO_TETRA_CHIP       0x79</span>
<span class="cp">#define BTTV_BOARD_SPIRIT_TV               0x7a</span>
<span class="cp">#define BTTV_BOARD_AVDVBT_771              0x7b</span>
<span class="cp">#define BTTV_BOARD_AVDVBT_761              0x7c</span>
<span class="cp">#define BTTV_BOARD_MATRIX_VISIONSQ         0x7d</span>
<span class="cp">#define BTTV_BOARD_MATRIX_VISIONSLC        0x7e</span>
<span class="cp">#define BTTV_BOARD_APAC_VIEWCOMP           0x7f</span>
<span class="cp">#define BTTV_BOARD_DVICO_DVBT_LITE         0x80</span>
<span class="cp">#define BTTV_BOARD_VGEAR_MYVCD             0x81</span>
<span class="cp">#define BTTV_BOARD_SUPER_TV                0x82</span>
<span class="cp">#define BTTV_BOARD_TIBET_CS16              0x83</span>
<span class="cp">#define BTTV_BOARD_KODICOM_4400R           0x84</span>
<span class="cp">#define BTTV_BOARD_KODICOM_4400R_SL        0x85</span>
<span class="cp">#define BTTV_BOARD_ADLINK_RTV24            0x86</span>
<span class="cp">#define BTTV_BOARD_DVICO_FUSIONHDTV_5_LITE 0x87</span>
<span class="cp">#define BTTV_BOARD_ACORP_Y878F             0x88</span>
<span class="cp">#define BTTV_BOARD_CONCEPTRONIC_CTVFMI2    0x89</span>
<span class="cp">#define BTTV_BOARD_PV_BT878P_2E            0x8a</span>
<span class="cp">#define BTTV_BOARD_PV_M4900                0x8b</span>
<span class="cp">#define BTTV_BOARD_OSPREY440               0x8c</span>
<span class="cp">#define BTTV_BOARD_ASOUND_SKYEYE	   0x8d</span>
<span class="cp">#define BTTV_BOARD_SABRENT_TVFM   	   0x8e</span>
<span class="cp">#define BTTV_BOARD_HAUPPAUGE_IMPACTVCB     0x8f</span>
<span class="cp">#define BTTV_BOARD_MACHTV_MAGICTV          0x90</span>
<span class="cp">#define BTTV_BOARD_SSAI_SECURITY	   0x91</span>
<span class="cp">#define BTTV_BOARD_SSAI_ULTRASOUND	   0x92</span>
<span class="cp">#define BTTV_BOARD_VOODOOTV_200		   0x93</span>
<span class="cp">#define BTTV_BOARD_DVICO_FUSIONHDTV_2	   0x94</span>
<span class="cp">#define BTTV_BOARD_TYPHOON_TVTUNERPCI	   0x95</span>
<span class="cp">#define BTTV_BOARD_GEOVISION_GV600	   0x96</span>
<span class="cp">#define BTTV_BOARD_KOZUMI_KTV_01C          0x97</span>
<span class="cp">#define BTTV_BOARD_ENLTV_FM_2		   0x98</span>
<span class="cp">#define BTTV_BOARD_VD012		   0x99</span>
<span class="cp">#define BTTV_BOARD_VD012_X1		   0x9a</span>
<span class="cp">#define BTTV_BOARD_VD012_X2		   0x9b</span>
<span class="cp">#define BTTV_BOARD_IVCE8784		   0x9c</span>
<span class="cp">#define BTTV_BOARD_GEOVISION_GV800S	   0x9d</span>
<span class="cp">#define BTTV_BOARD_GEOVISION_GV800S_SL	   0x9e</span>
<span class="cp">#define BTTV_BOARD_PV183                   0x9f</span>
<span class="cp">#define BTTV_BOARD_TVT_TD3116		   0xa0</span>


<span class="cm">/* more card-specific defines */</span>
<span class="cp">#define PT2254_L_CHANNEL 0x10</span>
<span class="cp">#define PT2254_R_CHANNEL 0x08</span>
<span class="cp">#define PT2254_DBS_IN_2 0x400</span>
<span class="cp">#define PT2254_DBS_IN_10 0x20000</span>
<span class="cp">#define WINVIEW_PT2254_CLK  0x40</span>
<span class="cp">#define WINVIEW_PT2254_DATA 0x20</span>
<span class="cp">#define WINVIEW_PT2254_STROBE 0x80</span>

<span class="k">struct</span> <span class="n">bttv_core</span> <span class="p">{</span>
	<span class="cm">/* device structs */</span>
	<span class="k">struct</span> <span class="n">v4l2_device</span>   <span class="n">v4l2_dev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">pci_dev</span>       <span class="o">*</span><span class="n">pci</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">i2c_adapter</span>   <span class="n">i2c_adap</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span>     <span class="n">subs</span><span class="p">;</span>     <span class="cm">/* struct bttv_sub_device */</span>

	<span class="cm">/* device config */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>         <span class="n">nr</span><span class="p">;</span>       <span class="cm">/* dev nr (for printk(&quot;bttv%d: ...&quot;);  */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>         <span class="n">type</span><span class="p">;</span>     <span class="cm">/* card type (pointer into tvcards[])  */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bttv</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">tvcard</span> <span class="p">{</span>
	<span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">;</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">volume_gpio</span><span class="p">)(</span><span class="k">struct</span> <span class="n">bttv</span> <span class="o">*</span><span class="n">btv</span><span class="p">,</span> <span class="n">__u16</span> <span class="n">volume</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">audio_mode_gpio</span><span class="p">)(</span><span class="k">struct</span> <span class="n">bttv</span> <span class="o">*</span><span class="n">btv</span><span class="p">,</span> <span class="k">struct</span> <span class="n">v4l2_tuner</span> <span class="o">*</span><span class="n">tuner</span><span class="p">,</span> <span class="kt">int</span> <span class="n">set</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">muxsel_hook</span><span class="p">)(</span><span class="k">struct</span> <span class="n">bttv</span> <span class="o">*</span><span class="n">btv</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">input</span><span class="p">);</span>

	<span class="cm">/* MUX bits for each input, two bits per input starting with the LSB */</span>
	<span class="n">u32</span> <span class="n">muxsel</span><span class="p">;</span> <span class="cm">/* Use MUXSEL() to set */</span>

	<span class="n">u32</span> <span class="n">gpiomask</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">gpiomux</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>  <span class="cm">/* Tuner, Radio, external, internal */</span>
	<span class="n">u32</span> <span class="n">gpiomute</span><span class="p">;</span>    <span class="cm">/* GPIO mute setting */</span>
	<span class="n">u32</span> <span class="n">gpiomask2</span><span class="p">;</span>   <span class="cm">/* GPIO MUX mask */</span>

	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tuner_type</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">tuner_addr</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">video_inputs</span><span class="p">;</span>	<span class="cm">/* Number of inputs */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">svhs</span><span class="o">:</span><span class="mi">4</span><span class="p">;</span>	<span class="cm">/* Which input is s-video */</span>
<span class="cp">#define NO_SVHS	15</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">pll</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span>
<span class="cp">#define PLL_NONE 0</span>
<span class="cp">#define PLL_28   1</span>
<span class="cp">#define PLL_35   2</span>

	<span class="cm">/* i2c audio flags */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">no_msp34xx</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">no_tda7432</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">msp34xx_alt</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="cm">/* Note: currently no card definition needs to mark the presence</span>
<span class="cm">	   of a RDS saa6588 chip. If this is ever needed, then add a new</span>
<span class="cm">	   &#39;has_saa6588&#39; bit here. */</span>

	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">no_video</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span> <span class="cm">/* video pci function is unused */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">has_dvb</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">has_remote</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">has_radio</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">has_dig_in</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span> <span class="cm">/* Has digital input (always last input) */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">no_gpioirq</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">extern</span> <span class="k">struct</span> <span class="n">tvcard</span> <span class="n">bttv_tvcards</span><span class="p">[];</span>

<span class="cm">/*</span>
<span class="cm"> * This bit of cpp voodoo is used to create a macro with a variable number of</span>
<span class="cm"> * arguments (1 to 16).  It will pack each argument into a word two bits at a</span>
<span class="cm"> * time.  It can&#39;t be a function because it needs to be compile time constant to</span>
<span class="cm"> * initialize structures.  Since each argument must fit in two bits, it&#39;s ok</span>
<span class="cm"> * that they are changed to octal.  One should not use hex number, macros, or</span>
<span class="cm"> * anything else with this macro.  Just use plain integers from 0 to 3.</span>
<span class="cm"> */</span>
<span class="cp">#define _MUXSELf(a)      	0##a &lt;&lt; 30</span>
<span class="cp">#define _MUXSELe(a, b...)	0##a &lt;&lt; 28 | _MUXSELf(b)</span>
<span class="cp">#define _MUXSELd(a, b...)	0##a &lt;&lt; 26 | _MUXSELe(b)</span>
<span class="cp">#define _MUXSELc(a, b...)	0##a &lt;&lt; 24 | _MUXSELd(b)</span>
<span class="cp">#define _MUXSELb(a, b...)	0##a &lt;&lt; 22 | _MUXSELc(b)</span>
<span class="cp">#define _MUXSELa(a, b...)	0##a &lt;&lt; 20 | _MUXSELb(b)</span>
<span class="cp">#define _MUXSEL9(a, b...)	0##a &lt;&lt; 18 | _MUXSELa(b)</span>
<span class="cp">#define _MUXSEL8(a, b...)	0##a &lt;&lt; 16 | _MUXSEL9(b)</span>
<span class="cp">#define _MUXSEL7(a, b...)	0##a &lt;&lt; 14 | _MUXSEL8(b)</span>
<span class="cp">#define _MUXSEL6(a, b...)	0##a &lt;&lt; 12 | _MUXSEL7(b)</span>
<span class="cp">#define _MUXSEL5(a, b...)	0##a &lt;&lt; 10 | _MUXSEL6(b)</span>
<span class="cp">#define _MUXSEL4(a, b...)	0##a &lt;&lt; 8  | _MUXSEL5(b)</span>
<span class="cp">#define _MUXSEL3(a, b...)	0##a &lt;&lt; 6  | _MUXSEL4(b)</span>
<span class="cp">#define _MUXSEL2(a, b...)	0##a &lt;&lt; 4  | _MUXSEL3(b)</span>
<span class="cp">#define _MUXSEL1(a, b...)	0##a &lt;&lt; 2  | _MUXSEL2(b)</span>
<span class="cp">#define MUXSEL(a, b...)		(a | _MUXSEL1(b))</span>

<span class="cm">/* identification / initialization of the card */</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">bttv_idcard</span><span class="p">(</span><span class="k">struct</span> <span class="n">bttv</span> <span class="o">*</span><span class="n">btv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">bttv_init_card1</span><span class="p">(</span><span class="k">struct</span> <span class="n">bttv</span> <span class="o">*</span><span class="n">btv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">bttv_init_card2</span><span class="p">(</span><span class="k">struct</span> <span class="n">bttv</span> <span class="o">*</span><span class="n">btv</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">bttv_init_tuner</span><span class="p">(</span><span class="k">struct</span> <span class="n">bttv</span> <span class="o">*</span><span class="n">btv</span><span class="p">);</span>

<span class="cm">/* card-specific funtions */</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">tea5757_set_freq</span><span class="p">(</span><span class="k">struct</span> <span class="n">bttv</span> <span class="o">*</span><span class="n">btv</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">freq</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u32</span> <span class="n">bttv_tda9880_setnorm</span><span class="p">(</span><span class="k">struct</span> <span class="n">bttv</span> <span class="o">*</span><span class="n">btv</span><span class="p">,</span> <span class="n">u32</span> <span class="n">gpiobits</span><span class="p">);</span>

<span class="cm">/* extra tweaks for some chipsets */</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">bttv_check_chipset</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">bttv_handle_chipset</span><span class="p">(</span><span class="k">struct</span> <span class="n">bttv</span> <span class="o">*</span><span class="n">btv</span><span class="p">);</span>

<span class="cm">/* ---------------------------------------------------------- */</span>
<span class="cm">/* exported by bttv-if.c                                      */</span>

<span class="cm">/* this obsolete -- please use the sysfs-based</span>
<span class="cm">   interface below for new code */</span>

<span class="k">extern</span> <span class="k">struct</span> <span class="n">pci_dev</span><span class="o">*</span> <span class="n">bttv_get_pcidev</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">card</span><span class="p">);</span>

<span class="cm">/* sets GPOE register (BT848_GPIO_OUT_EN) to new value:</span>
<span class="cm">   data | (current_GPOE_value &amp; ~mask)</span>
<span class="cm">   returns negative value if error occurred</span>
<span class="cm">*/</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">bttv_gpio_enable</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">card</span><span class="p">,</span>
			    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">mask</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">data</span><span class="p">);</span>

<span class="cm">/* fills data with GPDATA register contents</span>
<span class="cm">   returns negative value if error occurred</span>
<span class="cm">*/</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">bttv_read_gpio</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">card</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="o">*</span><span class="n">data</span><span class="p">);</span>

<span class="cm">/* sets GPDATA register to new value:</span>
<span class="cm">  (data &amp; mask) | (current_GPDATA_value &amp; ~mask)</span>
<span class="cm">  returns negative value if error occurred</span>
<span class="cm">*/</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">bttv_write_gpio</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">card</span><span class="p">,</span>
			   <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">mask</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">data</span><span class="p">);</span>




<span class="cm">/* ---------------------------------------------------------- */</span>
<span class="cm">/* sysfs/driver-moded based gpio access interface             */</span>

<span class="k">struct</span> <span class="n">bttv_sub_device</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">device</span>    <span class="n">dev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bttv_core</span> <span class="o">*</span><span class="n">core</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">list</span><span class="p">;</span>
<span class="p">};</span>
<span class="cp">#define to_bttv_sub_dev(x) container_of((x), struct bttv_sub_device, dev)</span>

<span class="k">struct</span> <span class="n">bttv_sub_driver</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">device_driver</span>   <span class="n">drv</span><span class="p">;</span>
	<span class="kt">char</span>                   <span class="n">wanted</span><span class="p">[</span><span class="mi">20</span><span class="p">];</span>
	<span class="kt">int</span>                    <span class="p">(</span><span class="o">*</span><span class="n">probe</span><span class="p">)(</span><span class="k">struct</span> <span class="n">bttv_sub_device</span> <span class="o">*</span><span class="n">sub</span><span class="p">);</span>
	<span class="kt">void</span>                   <span class="p">(</span><span class="o">*</span><span class="n">remove</span><span class="p">)(</span><span class="k">struct</span> <span class="n">bttv_sub_device</span> <span class="o">*</span><span class="n">sub</span><span class="p">);</span>
<span class="p">};</span>
<span class="cp">#define to_bttv_sub_drv(x) container_of((x), struct bttv_sub_driver, drv)</span>

<span class="kt">int</span> <span class="n">bttv_sub_register</span><span class="p">(</span><span class="k">struct</span> <span class="n">bttv_sub_driver</span> <span class="o">*</span><span class="n">drv</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">wanted</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">bttv_sub_unregister</span><span class="p">(</span><span class="k">struct</span> <span class="n">bttv_sub_driver</span> <span class="o">*</span><span class="n">drv</span><span class="p">);</span>

<span class="cm">/* gpio access functions */</span>
<span class="kt">void</span> <span class="n">bttv_gpio_inout</span><span class="p">(</span><span class="k">struct</span> <span class="n">bttv_core</span> <span class="o">*</span><span class="n">core</span><span class="p">,</span> <span class="n">u32</span> <span class="n">mask</span><span class="p">,</span> <span class="n">u32</span> <span class="n">outbits</span><span class="p">);</span>
<span class="n">u32</span> <span class="n">bttv_gpio_read</span><span class="p">(</span><span class="k">struct</span> <span class="n">bttv_core</span> <span class="o">*</span><span class="n">core</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bttv_gpio_write</span><span class="p">(</span><span class="k">struct</span> <span class="n">bttv_core</span> <span class="o">*</span><span class="n">core</span><span class="p">,</span> <span class="n">u32</span> <span class="n">value</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">bttv_gpio_bits</span><span class="p">(</span><span class="k">struct</span> <span class="n">bttv_core</span> <span class="o">*</span><span class="n">core</span><span class="p">,</span> <span class="n">u32</span> <span class="n">mask</span><span class="p">,</span> <span class="n">u32</span> <span class="n">bits</span><span class="p">);</span>

<span class="cp">#define gpio_inout(mask,bits)  bttv_gpio_inout(&amp;btv-&gt;c, mask, bits)</span>
<span class="cp">#define gpio_read()            bttv_gpio_read(&amp;btv-&gt;c)</span>
<span class="cp">#define gpio_write(value)      bttv_gpio_write(&amp;btv-&gt;c, value)</span>
<span class="cp">#define gpio_bits(mask,bits)   bttv_gpio_bits(&amp;btv-&gt;c, mask, bits)</span>


<span class="cm">/* ---------------------------------------------------------- */</span>
<span class="cm">/* i2c                                                        */</span>

<span class="cp">#define bttv_call_all(btv, o, f, args...) \</span>
<span class="cp">	v4l2_device_call_all(&amp;btv-&gt;c.v4l2_dev, 0, o, f, ##args)</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">bttv_I2CRead</span><span class="p">(</span><span class="k">struct</span> <span class="n">bttv</span> <span class="o">*</span><span class="n">btv</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">addr</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">probe_for</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">bttv_I2CWrite</span><span class="p">(</span><span class="k">struct</span> <span class="n">bttv</span> <span class="o">*</span><span class="n">btv</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">addr</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">b1</span><span class="p">,</span>
			 <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">b2</span><span class="p">,</span> <span class="kt">int</span> <span class="n">both</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">bttv_readee</span><span class="p">(</span><span class="k">struct</span> <span class="n">bttv</span> <span class="o">*</span><span class="n">btv</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">eedata</span><span class="p">,</span> <span class="kt">int</span> <span class="n">addr</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">bttv_input_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">bttv</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">bttv_input_fini</span><span class="p">(</span><span class="k">struct</span> <span class="n">bttv</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">bttv_input_irq</span><span class="p">(</span><span class="k">struct</span> <span class="n">bttv</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* _BTTV_H_ */</span><span class="cp"></span>
<span class="cm">/*</span>
<span class="cm"> * Local variables:</span>
<span class="cm"> * c-basic-offset: 8</span>
<span class="cm"> * End:</span>
<span class="cm"> */</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
