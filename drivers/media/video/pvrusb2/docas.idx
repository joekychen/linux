f | pvrusb2-ctrl.c | s | 13K | 543 | Hans Verkuil | hverkuil@xs4all.nl | 1293703334 |  | [media] v4l2-ctrls: use const char * const * for the menu arrays  This prevents checkpatch warnings generated when defining 'static const char *foo[]' arrays. It makes sense to use const char * const * anyway since the pointers in the array are indeed const.  Signed-off-by: Hans Verkuil <hverkuil@xs4all.nl> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | pvrusb2-cx2584x-v4l.c | s | 4.4K | 145 | Mike Isely | isely@pobox.com | 1300780475 |  | [media] pvrusb2: Implement support for Terratec Grabster AV400  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | pvrusb2-ctrl.h | s | 3.8K | 96 | Mike Isely | isely@pobox.com | 1223811417 |  | V4L/DVB (8898): pvrusb2: Be able to programmatically retrieve a control's default value  The pvrusb2 control mechanism up until now has used a constant int to hold a control's default value.  This change makes it possible to retrieve the control's default through some other means, e.g. as a result of a query from lower level software.  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | pvrusb2-io.h | s | 3.3K | 84 | Mike Isely | isely@pobox.com | 1216548412 |  | V4L/DVB (7936): pvrusb2: Remove svn Id keyword from all sources  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@infradead.org>
f | pvrusb2-hdw.c | s | 138K | 4618 | Mike Isely | isely@pobox.com | 1336420680 |  | [media] pvrusb2: For querystd, start with list of hardware-supported standards  The V4L querystd implementation appears to want to narrow down the list of available standards by starting with a hardware-supported list and then attempting to detect which among those are actually available.  Prior to this change in the pvrusb2 driver we started with all possible standards.  With this change in place we instead narrow to just the standards that we know the hardware can actually support. For example, this removes the ATSC standards from the list if we aren't dealing with a hybrid device...  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | Makefile | g | 854B |  | Arnaud Lacombe | lacombar@gmail.com | 1315086659 |  | [media] drivers/media: do not use EXTRA_CFLAGS  Usage of these flags has been deprecated for nearly 4 years by:      commit f77bf01425b11947eeb3b5b54685212c302741b8     Author: Sam Ravnborg <sam@neptun.(none)>     Date:   Mon Oct 15 22:25:06 2007 +0200          kbuild: introduce ccflags-y, asflags-y and ldflags-y  Moreover, these flags (at least EXTRA_CFLAGS) have been documented for command line use. By default, gmake(1) do not override command line setting, so this is likely to result in build failure or unexpected behavior.  Replace their usage by Kbuild's `{as,cc,ld}flags-y'.  Cc: Sam Ravnborg <sam@ravnborg.org> Cc: Mauro Carvalho Chehab <mchehab@infradead.org> Cc: linux-media@vger.kernel.org Signed-off-by: Arnaud Lacombe <lacombar@gmail.com> Acked-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | pvrusb2-debugifc.h | s | 1.8K | 46 | Mike Isely | isely@pobox.com | 1238427815 |  | V4L/DVB (11173): pvrusb2: Fix backwards function header comments  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | pvrusb2-ioread.h | s | 1.6K | 43 | Mike Isely | isely@pobox.com | 1216548412 |  | V4L/DVB (7936): pvrusb2: Remove svn Id keyword from all sources  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@infradead.org>
f | pvrusb2-eeprom.c | s | 4.7K | 141 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | pvrusb2-sysfs.c | s | 23K | 763 | Mike Isely | isely@pobox.com | 1300750342 |  | [media] pvrusb2: Use sysfs_attr_init() where appropriate  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | pvrusb2-cs53l32a.c | s | 2.5K | 80 | Tejun Heo | tj@kernel.org | 1269954152 |  | include cleanup: Update gfp.h and slab.h includes to prepare for breaking implicit slab.h inclusion from percpu.h  percpu.h is included by sched.h and module.h and thus ends up being included when building most .c files.  percpu.h includes slab.h which in turn includes gfp.h making everything defined by the two files universally available and complicating inclusion dependencies.  percpu.h -> slab.h dependency is about to be removed.  Prepare for this change by updating users of gfp and slab facilities include those headers directly instead of assuming availability.  As this conversion needs to touch large number of source files, the following script is used as the basis of conversion.    http://userweb.kernel.org/~tj/misc/slabh-sweep.py  The script does the followings.  * Scan files for gfp and slab usages and update includes such that   only the necessary includes are there.  ie. if only gfp is used,   gfp.h, if slab is used, slab.h.  * When the script inserts a new include, it looks at the include   blocks and try to put the new include such that its order conforms   to its surrounding.  It's put in the include block which contains   core kernel includes, in the same order that the rest are ordered -   alphabetical, Christmas tree, rev-Xmas-tree or at the end if there   doesn't seem to be any matching order.  * If the script can't find a place to put a new include (mostly   because the file doesn't have fitting include block), it prints out   an error message indicating which .h file needs to be added to the   file.  The conversion was done in the following steps.  1. The initial automatic conversion of all .c files updated slightly    over 4000 files, deleting around 700 includes and adding ~480 gfp.h    and ~3000 slab.h inclusions.  The script emitted errors for ~400    files.  2. Each error was manually checked.  Some didn't need the inclusion,    some needed manual addition while adding it to implementation .h or    embedding .c file was more appropriate for others.  This step added    inclusions to around 150 files.  3. The script was run again and the output was compared to the edits    from #2 to make sure no file was left behind.  4. Several build tests were done and a couple of problems were fixed.    e.g. lib/decompress_*.c used malloc/free() wrappers around slab    APIs requiring slab.h to be added manually.  5. The script was run on all .h files but without automatically    editing them as sprinkling gfp.h and slab.h inclusions around .h    files could easily lead to inclusion dependency hell.  Most gfp.h    inclusion directives were ignored as stuff from gfp.h was usually    wildly available and often used in preprocessor macros.  Each    slab.h inclusion directive was examined and added manually as    necessary.  6. percpu.h was updated not to include slab.h.  7. Build test were done on the following configurations and failures    were fixed.  CONFIG_GCOV_KERNEL was turned off for all tests (as my    distributed build env didn't work with gcov compiles) and a few    more options had to be turned off depending on archs to make things    build (like ipr on powerpc/64 which failed due to missing writeq).     * x86 and x86_64 UP and SMP allmodconfig and a custom test config.    * powerpc and powerpc64 SMP allmodconfig    * sparc and sparc64 SMP allmodconfig    * ia64 SMP allmodconfig    * s390 SMP allmodconfig    * alpha SMP allmodconfig    * um on x86_64 SMP allmodconfig  8. percpu.h modifications were reverted so that it could be applied as    a separate patch and serve as bisection point.  Given the fact that I had only a couple of failures from tests on step 6, I'm fairly confident about the coverage of this conversion patch. If there is a breakage, it's likely to be something in one of the arch headers which should be easily discoverable easily on most builds of the specific arch.  Signed-off-by: Tejun Heo <tj@kernel.org> Guess-its-ok-by: Christoph Lameter <cl@linux-foundation.org> Cc: Ingo Molnar <mingo@redhat.com> Cc: Lee Schermerhorn <Lee.Schermerhorn@hp.com>
f | pvrusb2-fx2-cmd.h | s | 2.1K | 56 | Mike Isely | isely@pobox.com | 1217087675 |  | V4L/DVB (8474): pvrusb2: Enable IR chip on HVR-1900 class devices  The Zilog IR chip on HVR-1900 devices is held in reset when the device initializes.  We have to bring this chip out of reset before LIRC has any chance of operating the chip.  So do it.  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@infradead.org>
f | pvrusb2-devattr.c | s | 16K | 477 | Michael Krufky | mkrufky@linuxtv.org | 1332206761 |  | [media] pvrusb2: fix 7MHz & 8MHz DVB-T tuner support for HVR1900 rev D1F5  The D1F5 revision of the WinTV HVR-1900 uses a tda18271c2 tuner instead of a tda18271c1 tuner as used in revision D1E9. To account for this, we must hardcode the frontend configuration to use the same IF frequency configuration for both revisions of the device.  6MHz DVB-T is unaffected by this issue, as the recommended IF Frequency configuration for 6MHz DVB-T is the same on both c1 and c2 revisions of the tda18271 tuner.  Signed-off-by: Michael Krufky <mkrufky@linuxtv.org> Cc: Mike Isely <isely@pobox.com> Cc: stable@kernel.org Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | pvrusb2-video-v4l.c | s | 3.1K | 95 | Tejun Heo | tj@kernel.org | 1269954152 |  | include cleanup: Update gfp.h and slab.h includes to prepare for breaking implicit slab.h inclusion from percpu.h  percpu.h is included by sched.h and module.h and thus ends up being included when building most .c files.  percpu.h includes slab.h which in turn includes gfp.h making everything defined by the two files universally available and complicating inclusion dependencies.  percpu.h -> slab.h dependency is about to be removed.  Prepare for this change by updating users of gfp and slab facilities include those headers directly instead of assuming availability.  As this conversion needs to touch large number of source files, the following script is used as the basis of conversion.    http://userweb.kernel.org/~tj/misc/slabh-sweep.py  The script does the followings.  * Scan files for gfp and slab usages and update includes such that   only the necessary includes are there.  ie. if only gfp is used,   gfp.h, if slab is used, slab.h.  * When the script inserts a new include, it looks at the include   blocks and try to put the new include such that its order conforms   to its surrounding.  It's put in the include block which contains   core kernel includes, in the same order that the rest are ordered -   alphabetical, Christmas tree, rev-Xmas-tree or at the end if there   doesn't seem to be any matching order.  * If the script can't find a place to put a new include (mostly   because the file doesn't have fitting include block), it prints out   an error message indicating which .h file needs to be added to the   file.  The conversion was done in the following steps.  1. The initial automatic conversion of all .c files updated slightly    over 4000 files, deleting around 700 includes and adding ~480 gfp.h    and ~3000 slab.h inclusions.  The script emitted errors for ~400    files.  2. Each error was manually checked.  Some didn't need the inclusion,    some needed manual addition while adding it to implementation .h or    embedding .c file was more appropriate for others.  This step added    inclusions to around 150 files.  3. The script was run again and the output was compared to the edits    from #2 to make sure no file was left behind.  4. Several build tests were done and a couple of problems were fixed.    e.g. lib/decompress_*.c used malloc/free() wrappers around slab    APIs requiring slab.h to be added manually.  5. The script was run on all .h files but without automatically    editing them as sprinkling gfp.h and slab.h inclusions around .h    files could easily lead to inclusion dependency hell.  Most gfp.h    inclusion directives were ignored as stuff from gfp.h was usually    wildly available and often used in preprocessor macros.  Each    slab.h inclusion directive was examined and added manually as    necessary.  6. percpu.h was updated not to include slab.h.  7. Build test were done on the following configurations and failures    were fixed.  CONFIG_GCOV_KERNEL was turned off for all tests (as my    distributed build env didn't work with gcov compiles) and a few    more options had to be turned off depending on archs to make things    build (like ipr on powerpc/64 which failed due to missing writeq).     * x86 and x86_64 UP and SMP allmodconfig and a custom test config.    * powerpc and powerpc64 SMP allmodconfig    * sparc and sparc64 SMP allmodconfig    * ia64 SMP allmodconfig    * s390 SMP allmodconfig    * alpha SMP allmodconfig    * um on x86_64 SMP allmodconfig  8. percpu.h modifications were reverted so that it could be applied as    a separate patch and serve as bisection point.  Given the fact that I had only a couple of failures from tests on step 6, I'm fairly confident about the coverage of this conversion patch. If there is a breakage, it's likely to be something in one of the arch headers which should be easily discoverable easily on most builds of the specific arch.  Signed-off-by: Tejun Heo <tj@kernel.org> Guess-its-ok-by: Christoph Lameter <cl@linux-foundation.org> Cc: Ingo Molnar <mingo@redhat.com> Cc: Lee Schermerhorn <Lee.Schermerhorn@hp.com>
f | pvrusb2-video-v4l.h | s | 1.5K | 40 | Mike Isely | isely@pobox.com | 1238427819 |  | V4L/DVB (11204): pvrusb2: Remove old i2c layer; we use v4l2-subdev now  This change removes the old i2c module controlling layer from the pvrusb2 driver.  This is code that first had appeared in the driver back in December 2005.  It's history.  Now we use v4l2-subdev.  Please note also that with this change, the driver will no longer be usable in kernels older that 2.6.22.  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | pvrusb2-i2c-core.h | s | 1.1K | 34 | Mike Isely | isely@pobox.com | 1238427812 |  | V4L/DVB (11154): pvrusb2: Split i2c module handling from i2c adapter  This is the first step in the effort to move the pvrusb2 driver over to using the v4l2-subdev framework.  This commit involves mainly splitting apart pvrusb2-i2c-core - part of it is the driver's I2C adapter driver and the rest is the old i2c module handling logic.  The i2c module handling junk is moved out to pvrusb2-i2c-track and various header references are correspondingly updated.  Yes, this patch has a huge pile of checkpatch complaints, but I'm NOT going to fix any of it.  Why?  First, I'm moving a large chunk of existing code and I'm not going to spend time adjusting it to match someone's idea of coding style.  Second, in the end I expect all that moved code to go away by the time the rework is done so wasting time on it now to adhere to the standard is in the end a large waste of time.  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | pvrusb2-hdw-internal.h | s | 13K | 335 | Mike Isely | isely@pobox.com | 1336420625 |  | [media] pvrusb2: Get rid of obsolete code for video standard enumeration  Get rid of pvrusb2-local implementation for enumeration of video standards - with video_ioctl2 this happens automatically now in the v4l core.  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | pvrusb2-wm8775.h | s | 1.5K | 41 | Mike Isely | isely@pobox.com | 1238427819 |  | V4L/DVB (11204): pvrusb2: Remove old i2c layer; we use v4l2-subdev now  This change removes the old i2c module controlling layer from the pvrusb2 driver.  This is code that first had appeared in the driver back in December 2005.  It's history.  Now we use v4l2-subdev.  Please note also that with this change, the driver will no longer be usable in kernels older that 2.6.22.  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | pvrusb2-dvb.c | s | 10K | 366 | Tejun Heo | tj@kernel.org | 1269954152 |  | include cleanup: Update gfp.h and slab.h includes to prepare for breaking implicit slab.h inclusion from percpu.h  percpu.h is included by sched.h and module.h and thus ends up being included when building most .c files.  percpu.h includes slab.h which in turn includes gfp.h making everything defined by the two files universally available and complicating inclusion dependencies.  percpu.h -> slab.h dependency is about to be removed.  Prepare for this change by updating users of gfp and slab facilities include those headers directly instead of assuming availability.  As this conversion needs to touch large number of source files, the following script is used as the basis of conversion.    http://userweb.kernel.org/~tj/misc/slabh-sweep.py  The script does the followings.  * Scan files for gfp and slab usages and update includes such that   only the necessary includes are there.  ie. if only gfp is used,   gfp.h, if slab is used, slab.h.  * When the script inserts a new include, it looks at the include   blocks and try to put the new include such that its order conforms   to its surrounding.  It's put in the include block which contains   core kernel includes, in the same order that the rest are ordered -   alphabetical, Christmas tree, rev-Xmas-tree or at the end if there   doesn't seem to be any matching order.  * If the script can't find a place to put a new include (mostly   because the file doesn't have fitting include block), it prints out   an error message indicating which .h file needs to be added to the   file.  The conversion was done in the following steps.  1. The initial automatic conversion of all .c files updated slightly    over 4000 files, deleting around 700 includes and adding ~480 gfp.h    and ~3000 slab.h inclusions.  The script emitted errors for ~400    files.  2. Each error was manually checked.  Some didn't need the inclusion,    some needed manual addition while adding it to implementation .h or    embedding .c file was more appropriate for others.  This step added    inclusions to around 150 files.  3. The script was run again and the output was compared to the edits    from #2 to make sure no file was left behind.  4. Several build tests were done and a couple of problems were fixed.    e.g. lib/decompress_*.c used malloc/free() wrappers around slab    APIs requiring slab.h to be added manually.  5. The script was run on all .h files but without automatically    editing them as sprinkling gfp.h and slab.h inclusions around .h    files could easily lead to inclusion dependency hell.  Most gfp.h    inclusion directives were ignored as stuff from gfp.h was usually    wildly available and often used in preprocessor macros.  Each    slab.h inclusion directive was examined and added manually as    necessary.  6. percpu.h was updated not to include slab.h.  7. Build test were done on the following configurations and failures    were fixed.  CONFIG_GCOV_KERNEL was turned off for all tests (as my    distributed build env didn't work with gcov compiles) and a few    more options had to be turned off depending on archs to make things    build (like ipr on powerpc/64 which failed due to missing writeq).     * x86 and x86_64 UP and SMP allmodconfig and a custom test config.    * powerpc and powerpc64 SMP allmodconfig    * sparc and sparc64 SMP allmodconfig    * ia64 SMP allmodconfig    * s390 SMP allmodconfig    * alpha SMP allmodconfig    * um on x86_64 SMP allmodconfig  8. percpu.h modifications were reverted so that it could be applied as    a separate patch and serve as bisection point.  Given the fact that I had only a couple of failures from tests on step 6, I'm fairly confident about the coverage of this conversion patch. If there is a breakage, it's likely to be something in one of the arch headers which should be easily discoverable easily on most builds of the specific arch.  Signed-off-by: Tejun Heo <tj@kernel.org> Guess-its-ok-by: Christoph Lameter <cl@linux-foundation.org> Cc: Ingo Molnar <mingo@redhat.com> Cc: Lee Schermerhorn <Lee.Schermerhorn@hp.com>
f | pvrusb2-context.c | s | 10K | 375 | Mike Isely | isely@pobox.com | 1216548412 |  | V4L/DVB (7936): pvrusb2: Remove svn Id keyword from all sources  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@infradead.org>
f | pvrusb2-v4l2.c | s | 35K | 1240 | Mike Isely | isely@pobox.com | 1336420591 |  | [media] pvrusb2: Trivial tweak to get rid of some redundant dereferences  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | pvrusb2-std.c | s | 9.4K | 372 | Dan Carpenter | error27@gmail.com | 1305894505 |  | [media] pvrusb2: delete generic_standards_cnt  The generic_standards_cnt define is only used in one place and it's more readable to just call ARRAY_SIZE(generic_standards) directly.  Signed-off-by: Dan Carpenter <error27@gmail.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | pvrusb2-sysfs.h | s | 1.4K | 40 | Mike Isely | isely@pobox.com | 1216548412 |  | V4L/DVB (7936): pvrusb2: Remove svn Id keyword from all sources  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@infradead.org>
f | pvrusb2-util.h | s | 1.7K | 55 | Mike Isely | isely@pobox.com | 1216548412 |  | V4L/DVB (7936): pvrusb2: Remove svn Id keyword from all sources  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@infradead.org>
f | pvrusb2-i2c-core.c | s | 19K | 631 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103911 |  | drivers/media: Add module.h to all files using it implicitly  A pending cleanup will mean that module.h won't be implicitly everywhere anymore.  Make sure the modular drivers in clocksource are actually calling out for <module.h> explicitly in advance.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | pvrusb2-debugifc.c | s | 8.4K | 295 | Andy Shevchenko | andy.shevchenko@gmail.com | 1281321786 |  | V4L/DVB: media: video: pvrusb2: remove custom hex_to_bin()  Signed-off-by: Andy Shevchenko <andy.shevchenko@gmail.com> Acked-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | pvrusb2-debug.h | s | 3.3K | 63 | Mike Isely | isely@pobox.com | 1216548412 |  | V4L/DVB (7936): pvrusb2: Remove svn Id keyword from all sources  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@infradead.org>
f | pvrusb2-cs53l32a.h | s | 1.5K | 40 | Mike Isely | isely@pobox.com | 1238427820 |  | V4L/DVB (11207): pvrusb2: Add composite and s-video input support for OnAir devices  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | pvrusb2-wm8775.c | s | 1.7K | 58 | Tejun Heo | tj@kernel.org | 1269954152 |  | include cleanup: Update gfp.h and slab.h includes to prepare for breaking implicit slab.h inclusion from percpu.h  percpu.h is included by sched.h and module.h and thus ends up being included when building most .c files.  percpu.h includes slab.h which in turn includes gfp.h making everything defined by the two files universally available and complicating inclusion dependencies.  percpu.h -> slab.h dependency is about to be removed.  Prepare for this change by updating users of gfp and slab facilities include those headers directly instead of assuming availability.  As this conversion needs to touch large number of source files, the following script is used as the basis of conversion.    http://userweb.kernel.org/~tj/misc/slabh-sweep.py  The script does the followings.  * Scan files for gfp and slab usages and update includes such that   only the necessary includes are there.  ie. if only gfp is used,   gfp.h, if slab is used, slab.h.  * When the script inserts a new include, it looks at the include   blocks and try to put the new include such that its order conforms   to its surrounding.  It's put in the include block which contains   core kernel includes, in the same order that the rest are ordered -   alphabetical, Christmas tree, rev-Xmas-tree or at the end if there   doesn't seem to be any matching order.  * If the script can't find a place to put a new include (mostly   because the file doesn't have fitting include block), it prints out   an error message indicating which .h file needs to be added to the   file.  The conversion was done in the following steps.  1. The initial automatic conversion of all .c files updated slightly    over 4000 files, deleting around 700 includes and adding ~480 gfp.h    and ~3000 slab.h inclusions.  The script emitted errors for ~400    files.  2. Each error was manually checked.  Some didn't need the inclusion,    some needed manual addition while adding it to implementation .h or    embedding .c file was more appropriate for others.  This step added    inclusions to around 150 files.  3. The script was run again and the output was compared to the edits    from #2 to make sure no file was left behind.  4. Several build tests were done and a couple of problems were fixed.    e.g. lib/decompress_*.c used malloc/free() wrappers around slab    APIs requiring slab.h to be added manually.  5. The script was run on all .h files but without automatically    editing them as sprinkling gfp.h and slab.h inclusions around .h    files could easily lead to inclusion dependency hell.  Most gfp.h    inclusion directives were ignored as stuff from gfp.h was usually    wildly available and often used in preprocessor macros.  Each    slab.h inclusion directive was examined and added manually as    necessary.  6. percpu.h was updated not to include slab.h.  7. Build test were done on the following configurations and failures    were fixed.  CONFIG_GCOV_KERNEL was turned off for all tests (as my    distributed build env didn't work with gcov compiles) and a few    more options had to be turned off depending on archs to make things    build (like ipr on powerpc/64 which failed due to missing writeq).     * x86 and x86_64 UP and SMP allmodconfig and a custom test config.    * powerpc and powerpc64 SMP allmodconfig    * sparc and sparc64 SMP allmodconfig    * ia64 SMP allmodconfig    * s390 SMP allmodconfig    * alpha SMP allmodconfig    * um on x86_64 SMP allmodconfig  8. percpu.h modifications were reverted so that it could be applied as    a separate patch and serve as bisection point.  Given the fact that I had only a couple of failures from tests on step 6, I'm fairly confident about the coverage of this conversion patch. If there is a breakage, it's likely to be something in one of the arch headers which should be easily discoverable easily on most builds of the specific arch.  Signed-off-by: Tejun Heo <tj@kernel.org> Guess-its-ok-by: Christoph Lameter <cl@linux-foundation.org> Cc: Ingo Molnar <mingo@redhat.com> Cc: Lee Schermerhorn <Lee.Schermerhorn@hp.com>
f | pvrusb2-cx2584x-v4l.h | s | 1.5K | 41 | Mike Isely | isely@pobox.com | 1238427819 |  | V4L/DVB (11204): pvrusb2: Remove old i2c layer; we use v4l2-subdev now  This change removes the old i2c module controlling layer from the pvrusb2 driver.  This is code that first had appeared in the driver back in December 2005.  It's history.  Now we use v4l2-subdev.  Please note also that with this change, the driver will no longer be usable in kernels older that 2.6.22.  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | pvrusb2-ioread.c | s | 12K | 458 | Julia Lawall | julia@diku.dk | 1280772062 |  | V4L/DVB: drivers/media/video/pvrusb2: Add missing mutex_unlock  Add a mutex_unlock missing on the error path.  In the other functions in the same file the locks and unlocks of this mutex appear to be balanced, so it would seem that the same should hold in this case.  The semantic match that finds this problem is as follows: (http://coccinelle.lip6.fr/)  // <smpl> @@ expression E1; @@  * mutex_lock(E1,...);   <+... when != E1   if (...) {     ... when != E1 *   return ...;   }   ...+> * mutex_unlock(E1,...); // </smpl>  Signed-off-by: Julia Lawall <julia@diku.dk> Signed-off-by: Douglas Schilling Landgraf <dougsland@redhat.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | pvrusb2-v4l2.h | s | 1.1K | 34 | Mike Isely | isely@pobox.com | 1216548412 |  | V4L/DVB (7936): pvrusb2: Remove svn Id keyword from all sources  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@infradead.org>
f | pvrusb2-hdw.h | s | 12K | 294 | Mike Isely | isely@pobox.com | 1336420625 |  | [media] pvrusb2: Get rid of obsolete code for video standard enumeration  Get rid of pvrusb2-local implementation for enumeration of video standards - with video_ioctl2 this happens automatically now in the v4l core.  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | pvrusb2-dvb.h | s | 887B | 30 | Mike Isely | isely@pobox.com | 1209056989 |  | V4L/DVB (7713): pvrusb2: Implement cleaner DVB kernel thread shutdown  Earlier fix to handle DVB feed thread aborts was overly-aggressive. We can take better advantage of what kthread_stop() can do.  This change simplifies things.  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@infradead.org>
f | pvrusb2-encoder.h | s | 1.3K | 37 | Mike Isely | isely@pobox.com | 1216548412 |  | V4L/DVB (7936): pvrusb2: Remove svn Id keyword from all sources  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@infradead.org>
f | pvrusb2.h | s | 1.4K | 38 | Mike Isely | isely@pobox.com | 1216548412 |  | V4L/DVB (7936): pvrusb2: Remove svn Id keyword from all sources  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@infradead.org>
f | pvrusb2-devattr.h | s | 6.8K | 161 | Mike Isely | isely@pobox.com | 1275365989 |  | V4L/DVB: pvrusb2: New feature to mark specific hardware support as experimental  This adds a flag in the device attribute structure which can be used to mark support for a particular device as experimental.  Any devices flagged in this way, when encountered at run-time, will generate a warning message to the kernel log.  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | pvrusb2-audio.c | s | 2.7K | 86 | Hans Verkuil | hverkuil@xs4all.nl | 1252768729 |  | V4L/DVB (12426): pvrusb2: fix compile warning  Signed-off-by: Hans Verkuil <hverkuil@xs4all.nl> Acked-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | pvrusb2-context.h | s | 3.0K | 82 | Mike Isely | isely@pobox.com | 1217087677 |  | V4L/DVB (8475): pvrusb2: Cosmetic macro fix (benign)  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@infradead.org>
f | pvrusb2-std.h | s | 2.2K | 52 | Mike Isely | isely@pobox.com | 1216548412 |  | V4L/DVB (7936): pvrusb2: Remove svn Id keyword from all sources  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@infradead.org>
f | pvrusb2-main.c | s | 4.4K | 146 | Mauro Carvalho Chehab | mchehab@redhat.com | 1311799995 |  | [media] pvrusb2: Use LINUX_VERSION_CODE for VIDIOC_QUERYCAP  pvrusb2 doesn't use vidioc_ioctl2. As the API is changing to use a common version for all drivers, we need to expliticly fix this driver.  Acked-by: Hans Verkuil <hans.verkuil@cisco.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | Kconfig | g | 2.0K |  | Mauro Carvalho Chehab | mchehab@redhat.com | 1238427811 |  | V4L/DVB (11127): Kconfig: replace all occurrences of CUSTOMIZE to CUSTOMISE  There are several Kconfig items using CUSTOMIZE. Yet, most use the English writing CUSTOMISE. This generates lots of trouble, because people sometimes type the Kbuild item different.  Let's standardise every occurrence using the same syntax.  The changes were generated by this small shell script:  for i in `find linux -type f`; do sed s,CUSTOMIZE,CUSTOMISE,g $i >/tmp/a && mv /tmp/a $i; done  Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | pvrusb2-audio.h | s | 1.2K | 34 | Mike Isely | isely@pobox.com | 1238427819 |  | V4L/DVB (11204): pvrusb2: Remove old i2c layer; we use v4l2-subdev now  This change removes the old i2c module controlling layer from the pvrusb2 driver.  This is code that first had appeared in the driver back in December 2005.  It's history.  Now we use v4l2-subdev.  Please note also that with this change, the driver will no longer be usable in kernels older that 2.6.22.  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | pvrusb2-eeprom.h | s | 1.2K | 34 | Mike Isely | isely@pobox.com | 1216548412 |  | V4L/DVB (7936): pvrusb2: Remove svn Id keyword from all sources  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@infradead.org>
f | pvrusb2-encoder.c | s | 14K | 471 | Mike Isely | isely@pobox.com | 1260045658 |  | V4L/DVB (13223): pvrusb2: Soften encoder warning message  pvrusb2: Encoder failures are mostly recoverable by the driver.  While it would sure be nice not to have the failure happen in the first place, this has been going on for years and I doubt that a real solution will ever present itself.  I think that part's firmware is just slightly flakey and we have to deal with it.  The driver does deal with it just fine, but the warning message going into the kernel log is probably a little more alarming than it should be.  So try to soften up the warning somewhat.  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | pvrusb2-io.c | s | 18K | 642 | Mike Isely | isely@pobox.com | 1216548412 |  | V4L/DVB (7936): pvrusb2: Remove svn Id keyword from all sources  Signed-off-by: Mike Isely <isely@pobox.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@infradead.org>
