f | spi-sirf.c | s | 18K | 573 | Barry Song | Baohua.Song@csr.com | 1337491051 |  | SPI: PRIMA2: use the newest APIs of PINCTRL to fix compiling errors  Fix the compiling errors: drivers/spi/spi-sirf.c: In function 'spi_sirfsoc_probe': drivers/spi/spi-sirf.c:563: error: implicit declaration of function 'pinmux_get' drivers/spi/spi-sirf.c:563: warning: assignment makes pointer from integer without a cast drivers/spi/spi-sirf.c:568: error: implicit declaration of function 'pinmux_enable' drivers/spi/spi-sirf.c:602: error: implicit declaration of function 'pinmux_disable' drivers/spi/spi-sirf.c:603: error: implicit declaration of function 'pinmux_put' make[3]: *** [drivers/spi/spi-sirf.o] Error 1  Signed-off-by: Barry Song <Baohua.Song@csr.com> Cc: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Acked-by: Linus Walleij <linus.walleij@linaro.org> Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | Makefile | g | 2.5K |  | Scott Jiang | scott.jiang.linux@gmail.com | 1335550545 |  | spi/bfin5xx: rename config macro name for bfin5xx spi controller driver  This controller is only for blackfin 5xx soc, so rename it to BFIN5XX  Signed-off-by: Scott Jiang <scott.jiang.linux@gmail.com> Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | spi-ti-ssp.c | s | 9.2K | 317 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103937 |  | spi: Add module.h to implicit users in drivers/spi  We are clipping down the presence of module.h, since it was everywhere.  If you really need it, you better call it out, as per this changeset.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | spi-au1550.c | s | 26K | 873 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103937 |  | spi: Add module.h to implicit users in drivers/spi  We are clipping down the presence of module.h, since it was everywhere.  If you really need it, you better call it out, as per this changeset.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | spi-bfin5xx.c | s | 40K | 1244 | Scott Jiang | scott.jiang.linux@gmail.com | 1335550839 |  | spi/spi-bfin5xx: Fix flush of last bit after each spi transfer  This patch ensures that the last bit of a transfer gets correctly flushed out of the register.  Signed-off-by: Scott Jiang <scott.jiang.linux@gmail.com> Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | spi-sh.c | s | 12K | 460 | Shimoda, Yoshihiro | yoshihiro.shimoda.uh@renesas.com | 1331173125 |  | spi/spi-sh: add IORESOURCE_MEM_TYPE_MASK decoding for access size  This SPI controller's access size is 32, or 8-bit. The previous driver supported 32-bit only. So, this patch adds IORESOURCE_MEM_TYPE_MASK decoding, an then, the driver can handle the SPI controller of 8-bit.  Signed-off-by: Yoshihiro Shimoda <yoshihiro.shimoda.uh@renesas.com> Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | spi-s3c24xx.c | s | 16K | 582 | Heiko Stuebner | heiko@sntech.de | 1328007987 |  | ARM: S3C24XX: move spi-s3c24xx platdata out of mach  spi.h now only contains the definition of the platform data structure for the driver in spi-s3c24xx.c . Therefore it does not need to stay in include/mach but can instead live in linux/spi/s3c24xx.h .  Signed-off-by: Heiko Stuebner <heiko@sntech.de> Cc: Grant Likely <grant.likely@secretlab.ca> Signed-off-by: Kukjin Kim <kgene.kim@samsung.com>
f | spi-bitbang-txrx.h | s | 3.0K | 86 | Grant Likely | grant.likely@secretlab.ca | 1307344590 |  | spi: reorganize drivers  Sort the SPI makefile and enforce the naming convention spi_*.c for spi drivers.  This change also rolls the contents of atmel_spi.h into the .c file since there is only one user of that particular include file.  v2: - Use 'spi-' prefix instead of 'spi_' to match what seems to be       be the predominant pattern for subsystem prefixes.     - Clean up filenames in Kconfig and header comment blocks  Signed-off-by: Grant Likely <grant.likely@secretlab.ca> Acked-by: Wolfram Sang <w.sang@pengutronix.de> Acked-by: Linus Walleij <linus.walleij@linaro.org>
f | spi-coldfire-qspi.c | s | 15K | 509 | Steven King | sfking@fdwdc.com | 1337489847 |  | spi: refactor spi-coldfire-qspi to use SPI queue framework.  Use the new SPI queue framework; remove use of workqueue, replace mcfqspi_transfer with mcfqspi_transfer_one_message, add mcfqspi_prepare_transfer_hw and mcfqspi_unprepare_transfer_hw, update power management routines.  Signed-off-by: Steven King <sfking@fdwdc.com> Acked-by: Greg Ungerer <gerg@snapgear.com> Acked-by: Linus Walleij <linus.walleij@linaro.org> Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | spi-fsl-spi.c | s | 27K | 985 | Herton Ronaldo Krzesinski | herton.krzesinski@canonical.com | 1337490726 |  | spi/spi-fsl-spi: reference correct pdata in fsl_spi_cs_control  Commit 178db7d3, "spi: Fix device unregistration when unregistering the bus master", changed spi device initialization of dev.parent pointer to be the master's device pointer instead of his parent.  This introduced a bug in spi-fsl-spi, since its usage of spi device pointer was not updated accordingly. This was later fixed by commit 5039a86, "spi/mpc83xx: fix NULL pdata dereference bug", but it missed another spot on fsl_spi_cs_control function where we also need to update usage of spi device pointer. This change address that.  Cc: stable@vger.kernel.org Signed-off-by: Herton Ronaldo Krzesinski <herton.krzesinski@canonical.com> Acked-by: Joakim Tjernlund <Joakim.Tjernlund@transmode.se> Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | spi-mpc52xx-psc.c | s | 13K | 430 | Grant Likely | grant.likely@secretlab.ca | 1319495747 |  | drivercore: Add helper macro for platform_driver boilerplate  For simple modules that contain a single platform_driver without any additional setup code then ends up being a block of duplicated boilerplate.  This patch adds a new macro, module_platform_driver(), which replaces the module_init()/module_exit() registrations with template functions.  Signed-off-by: Grant Likely <grant.likely@secretlab.ca> Acked-by: Greg Kroah-Hartman <gregkh@suse.de> Reviewed-by: Magnus Damm <magnus.damm@gmail.com> Reviewed-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Reviewed-by: Stephen Boyd <sboyd@codeaurora.org>
f | spi-butterfly.c | s | 8.5K | 283 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103937 |  | spi: Add module.h to implicit users in drivers/spi  We are clipping down the presence of module.h, since it was everywhere.  If you really need it, you better call it out, as per this changeset.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | spi-imx.c | s | 24K | 774 | Arnd Bergmann | arnd@arndb.de | 1337002252 |  | Merge branch 'imx/pinctrl' into imx/clock  Conflicts: 	drivers/mmc/host/sdhci-esdhc-imx.c 	drivers/net/ethernet/freescale/fec.c 	drivers/spi/spi-imx.c 	drivers/tty/serial/imx.c  This resolves dependencies between the pinctrl and clock changes in imx.  Signed-off-by: Arnd Bergmann <arnd@arndb.de>
f | spi-tle62x0.c | s | 7.5K | 273 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103937 |  | spi: Add module.h to implicit users in drivers/spi  We are clipping down the presence of module.h, since it was everywhere.  If you really need it, you better call it out, as per this changeset.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | spi-xilinx.c | s | 15K | 455 | Grant Likely | grant.likely@secretlab.ca | 1319495747 |  | drivercore: Add helper macro for platform_driver boilerplate  For simple modules that contain a single platform_driver without any additional setup code then ends up being a block of duplicated boilerplate.  This patch adds a new macro, module_platform_driver(), which replaces the module_init()/module_exit() registrations with template functions.  Signed-off-by: Grant Likely <grant.likely@secretlab.ca> Acked-by: Greg Kroah-Hartman <gregkh@suse.de> Reviewed-by: Magnus Damm <magnus.damm@gmail.com> Reviewed-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Reviewed-by: Stephen Boyd <sboyd@codeaurora.org>
f | spi-dw.h | s | 5.8K | 206 | H Hartley Sweeten | hartleys@visionengravers.com | 1316619708 |  | spi: spi-dw: fix all sparse warnings  The dw_{read,write}[lw] macros produce sparse warnings everytime they are used.  The "read" ones cause:  warning: cast removes address space of expression warning: incorrect type in argument 1 (different address spaces)    expected void const volatile [noderef] <asn:2>*addr    got unsigned int *<noident>  And the "write" ones:  warning: cast removes address space of expression warning: incorrect type in argument 2 (different address spaces)    expected void volatile [noderef] <asn:2>*addr    got unsigned int *<noident>  Fix this by removing struct dw_spi_reg and converting all the register offsets to #defines. Then convert the macros into inlined functions so that proper type checking can occur.  While here, also fix the three sparse warnings in spi-dw-mid.c due to the return value of ioremap_nocache being stored in a u32 * not a void __iomem *.  With these changes the spi-dw* files all build with no sparse warnings.  Signed-off-by: H Hartley Sweeten <hsweeten@visionengravers.com> Acked-by: Feng Tang <feng.tang@intel.com> Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | spi-fsl-espi.c | s | 17K | 613 | Grant Likely | grant.likely@secretlab.ca | 1334334099 |  | spi/devicetree: Move devicetree support code into spi directory  The SPI device tree support code isn't shared by any other subsystem.  It can be moved into the core drivers/spi directory and the exported symbol can be removed.  Signed-off-by: Grant Likely <grant.likely@secretlab.ca> Cc: Rob Herring <rob.herring@calxeda.com>
f | spi-pxa2xx-pci.c | s | 3.8K | 140 | Axel Lin | axel.lin@gmail.com | 1334088694 |  | spi: use module_pci_driver  This patch converts the drivers in drivers/spi/* to use module_pci_driver() macro which makes the code smaller and a bit simpler.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | spi-sh-sci.c | s | 4.7K | 161 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103937 |  | spi: Add module.h to implicit users in drivers/spi  We are clipping down the presence of module.h, since it was everywhere.  If you really need it, you better call it out, as per this changeset.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | spi-dw-mid.c | s | 6.0K | 191 | Alexandre Bounine | alexandre.bounine@idt.com | 1332337822 |  | dmaengine/dma_slave: introduce inline wrappers  Add inline wrappers for device_prep_slave_sg() and device_prep_dma_cyclic() interfaces to hide new parameter from current users of affected interfaces. Convert current users to use new wrappers instead of direct calls. Suggested by Russell King [https://lkml.org/lkml/2012/2/3/269].  Signed-off-by: Alexandre Bounine <alexandre.bounine@idt.com> Signed-off-by: Vinod Koul <vinod.koul@linux.intel.com>
f | spi-dw-mmio.c | s | 3.2K | 119 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103937 |  | spi: Add module.h to implicit users in drivers/spi  We are clipping down the presence of module.h, since it was everywhere.  If you really need it, you better call it out, as per this changeset.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | spi-dw.c | s | 22K | 778 | Stephen Boyd | sboyd@codeaurora.org | 1333664750 |  | simple_open: automatically convert to simple_open()  Many users of debugfs copy the implementation of default_open() when they want to support a custom read/write function op.  This leads to a proliferation of the default_open() implementation across the entire tree.  Now that the common implementation has been consolidated into libfs we can replace all the users of this function with simple_open().  This replacement was done with the following semantic patch:  <smpl> @ open @ identifier open_f != simple_open; identifier i, f; @@ -int open_f(struct inode *i, struct file *f) -{ ( -if (i->i_private) -f->private_data = i->i_private; || -f->private_data = i->i_private; ) -return 0; -}  @ has_open depends on open @ identifier fops; identifier open.open_f; @@ struct file_operations fops = { ... -.open = open_f, +.open = simple_open, ... }; </smpl>  [akpm@linux-foundation.org: checkpatch fixes] Signed-off-by: Stephen Boyd <sboyd@codeaurora.org> Cc: Greg Kroah-Hartman <gregkh@linuxfoundation.org> Cc: Al Viro <viro@zeniv.linux.org.uk> Cc: Julia Lawall <Julia.Lawall@lip6.fr> Acked-by: Ingo Molnar <mingo@elte.hu> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | spi-gpio.c | s | 11K | 351 | Manuel Lauss | manuel.lauss@googlemail.com | 1323292659 |  | spi/gpio: fix section mismatch warning  Fixes: The function __devinit spi_gpio_probe() references a function __init spi_gpio_alloc.isra.4(). If spi_gpio_alloc.isra.4 is only used by spi_gpio_probe then annotate spi_gpio_alloc.isra.4 with a matching annotation.  [wsa: fix spi_gpio_request(), too]  Signed-off-by: Manuel Lauss <manuel.lauss@googlemail.com> Signed-off-by: Wolfram Sang <w.sang@pengutronix.de>
f | spidev.c | s | 17K | 602 | Grant Likely | grant.likely@secretlab.ca | 1307344590 |  | spi: reorganize drivers  Sort the SPI makefile and enforce the naming convention spi_*.c for spi drivers.  This change also rolls the contents of atmel_spi.h into the .c file since there is only one user of that particular include file.  v2: - Use 'spi-' prefix instead of 'spi_' to match what seems to be       be the predominant pattern for subsystem prefixes.     - Clean up filenames in Kconfig and header comment blocks  Signed-off-by: Grant Likely <grant.likely@secretlab.ca> Acked-by: Wolfram Sang <w.sang@pengutronix.de> Acked-by: Linus Walleij <linus.walleij@linaro.org>
f | spi-orion.c | s | 12K | 461 | Andrew Lunn | andrew@lunn.ch | 1336520035 |  | ARM: Orion: SPI: Add clk/clkdev support.  Remove now redundant tclk from SPI platform data. This makes the platform data empty, so remove it.  Signed-off-by: Andrew Lunn <andrew@lunn.ch> Tested-by: Jamie Lentin <jm@lentin.co.uk> Signed-off-by: Mike Turquette <mturquette@linaro.org>
f | spi-tegra.c | s | 15K | 505 | Grant Likely | grant.likely@secretlab.ca | 1319495747 |  | drivercore: Add helper macro for platform_driver boilerplate  For simple modules that contain a single platform_driver without any additional setup code then ends up being a block of duplicated boilerplate.  This patch adds a new macro, module_platform_driver(), which replaces the module_init()/module_exit() registrations with template functions.  Signed-off-by: Grant Likely <grant.likely@secretlab.ca> Acked-by: Greg Kroah-Hartman <gregkh@suse.de> Reviewed-by: Magnus Damm <magnus.damm@gmail.com> Reviewed-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Reviewed-by: Stephen Boyd <sboyd@codeaurora.org>
f | spi-sh-msiof.c | s | 17K | 617 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103937 |  | spi: Add module.h to implicit users in drivers/spi  We are clipping down the presence of module.h, since it was everywhere.  If you really need it, you better call it out, as per this changeset.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | spi-s3c24xx-fiq.h | s | 671B | 23 | Grant Likely | grant.likely@secretlab.ca | 1307344590 |  | spi: reorganize drivers  Sort the SPI makefile and enforce the naming convention spi_*.c for spi drivers.  This change also rolls the contents of atmel_spi.h into the .c file since there is only one user of that particular include file.  v2: - Use 'spi-' prefix instead of 'spi_' to match what seems to be       be the predominant pattern for subsystem prefixes.     - Clean up filenames in Kconfig and header comment blocks  Signed-off-by: Grant Likely <grant.likely@secretlab.ca> Acked-by: Wolfram Sang <w.sang@pengutronix.de> Acked-by: Linus Walleij <linus.walleij@linaro.org>
f | spi-omap2-mcspi.c | s | 32K | 1079 | Russell King | rmk+kernel@arm.linux.org.uk | 1340015224 |  | SPI: fix over-eager devm_xxx() conversion  1a77b127ae (OMAP : SPI : use devm_* functions) converted the SPI device controller state to use devm_kzalloc().  Unfortunately, this is used against an unbound struct device, which results in the following when the device is bound to its driver:  ------------[ cut here ]------------ WARNING: at /home/rmk/git/linux-rmk/drivers/base/dd.c:257 driver_probe_device+0x78/0x21c() Modules linked in: Backtrace: [<c0017d0c>] (dump_backtrace+0x0/0x10c) from [<c033e208>] (dump_stack+0x18/0x1c) r7:00000000 r6:c01ff28c r5:c040050c r4:00000101 [<c033e1f0>] (dump_stack+0x0/0x1c) from [<c00337ec>] (warn_slowpath_common+0x58/0x70) [<c0033794>] (warn_slowpath_common+0x0/0x70) from [<c0033828>] (warn_slowpath_null+0x24/0x2c) [<c0033804>] (warn_slowpath_null+0x0/0x2c) from [<c01ff28c>] (driver_probe_device+0x78/0x21c) [<c01ff214>] (driver_probe_device+0x0/0x21c) from [<c01ff49c>] (__driver_attach+0x6c/0x90) [<c01ff430>] (__driver_attach+0x0/0x90) from [<c01fda70>] (bus_for_each_dev+0x58/0x98) [<c01fda18>] (bus_for_each_dev+0x0/0x98) from [<c01ff0f4>] (driver_attach+0x20/0x28) [<c01ff0d4>] (driver_attach+0x0/0x28) from [<c01fe2f4>] (bus_add_driver+0xb4/0x230) [<c01fe240>] (bus_add_driver+0x0/0x230) from [<c01ffb24>] (driver_register+0xac/0x138) [<c01ffa78>] (driver_register+0x0/0x138) from [<c0215d4c>] (spi_register_driver+0x4c/0x60) [<c0215d00>] (spi_register_driver+0x0/0x60) from [<c045414c>] (ks8851_init+0x14/0x1c) [<c0454138>] (ks8851_init+0x0/0x1c) from [<c0008770>] (do_one_initcall+0x9c/0x164) [<c00086d4>] (do_one_initcall+0x0/0x164) from [<c0436410>] (kernel_init+0x128/0x210) [<c04362e8>] (kernel_init+0x0/0x210) from [<c0038754>] (do_exit+0x0/0x72c) ---[ end trace 4dcda79f5e89dd84 ]--- ks8851 spi1.0: message enable is 0 ks8851 spi1.0: eth0: revision 0, MAC 08:00:28:01:4d:c6, IRQ 194, has EEPROM  Fix this by partially reverting the original commit.  Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
f | spi-s3c64xx.c | s | 32K | 1023 | Mark Brown | broonie@opensource.wolfsonmicro.com | 1331803937 |  | spi: s3c64xx: Fix build  Commit 054ebc (spi: Compatibility with direction which is used in samsung DMA operation) does not build as one hunk adds a brace to the first branch of an if statement without adding at least the correspoding close. Remove the unwanted brace.  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | spi-stmp.c | s | 15K | 552 | Grant Likely | grant.likely@secretlab.ca | 1319495747 |  | drivercore: Add helper macro for platform_driver boilerplate  For simple modules that contain a single platform_driver without any additional setup code then ends up being a block of duplicated boilerplate.  This patch adds a new macro, module_platform_driver(), which replaces the module_init()/module_exit() registrations with template functions.  Signed-off-by: Grant Likely <grant.likely@secretlab.ca> Acked-by: Greg Kroah-Hartman <gregkh@suse.de> Reviewed-by: Magnus Damm <magnus.damm@gmail.com> Reviewed-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Reviewed-by: Stephen Boyd <sboyd@codeaurora.org>
f | spi-fsl-lib.c | s | 5.8K | 194 | Grant Likely | grant.likely@secretlab.ca | 1334334099 |  | spi/devicetree: Move devicetree support code into spi directory  The SPI device tree support code isn't shared by any other subsystem.  It can be moved into the core drivers/spi directory and the exported symbol can be removed.  Signed-off-by: Grant Likely <grant.likely@secretlab.ca> Cc: Rob Herring <rob.herring@calxeda.com>
f | spi-sh-hspi.c | s | 7.0K | 270 | Kuninori Morimoto | kuninori.morimoto.gx@renesas.com | 1331804510 |  | spi: sh-hspi: modify write/read method  Current sh-hspi had wrong write/read method which was not linux standard. If spi_transfer requests tx[2], rx[2] len=2, then, driver should run tx[0], rx[0], tx[1], rx[1]. But current sh-hspi runs tx[0], tx[1], rx[0], rx[1]. This patch fixes it up.  Signed-off-by: Kuninori Morimoto <kuninori.morimoto.gx@renesas.com> Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | spi-lm70llp.c | s | 9.1K | 292 | Grant Likely | grant.likely@secretlab.ca | 1337492528 |  | spi: By default setup spi_masters with 1 chipselect and dynamics bus number  Trivial simplification.  Instead of requiring spi master drivers to always set the bus number (even when a dynamic number is desired), this patch modifies spi_alloc_master() to initialize num_chipselect to 1 (because there will always be at least one CS) and bus_num to -1 for dynamic allocation.  This simplifies the code needed to be written for drivers.  Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | spi-omap-uwire.c | s | 13K | 501 | David Howells | dhowells@redhat.com | 1332955803 |  | Remove all #inclusions of asm/system.h  Remove all #inclusions of asm/system.h preparatory to splitting and killing it.  Performed with the following command:  perl -p -i -e 's!^#\s*include\s*<asm/system[.]h>.*\n!!' `grep -Irl '^#\s*include\s*<asm/system[.]h>' *`  Signed-off-by: David Howells <dhowells@redhat.com>
f | spi-omap-100k.c | s | 15K | 506 | Grant Likely | grant.likely@secretlab.ca | 1307344590 |  | spi: reorganize drivers  Sort the SPI makefile and enforce the naming convention spi_*.c for spi drivers.  This change also rolls the contents of atmel_spi.h into the .c file since there is only one user of that particular include file.  v2: - Use 'spi-' prefix instead of 'spi_' to match what seems to be       be the predominant pattern for subsystem prefixes.     - Clean up filenames in Kconfig and header comment blocks  Signed-off-by: Grant Likely <grant.likely@secretlab.ca> Acked-by: Wolfram Sang <w.sang@pengutronix.de> Acked-by: Linus Walleij <linus.walleij@linaro.org>
f | spi-ep93xx.c | s | 30K | 1019 | Hannu Heikkinen | hannuxx@iki.fi | 1336610262 |  | spi/ep93xx: clean probe/remove routines  Use devm_* functions for managing devres resources.  Also use local variable irq and remove irq variable from struct ep93xx_spi, as it is needed only in probe routine.  Acked-by: Mika Westerberg <mika.westerberg@iki.fi> Acked-by: H Hartley Sweeten <hsweeten@visionengravers.com> Signed-off-by: Hannu Heikkinen <hannuxx@iki.fi> Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | spi-pl022.c | s | 63K | 2086 | Viresh Kumar | viresh.kumar@st.com | 1335550060 |  | spi/pl022: Allow request for higher frequency than maximum possible  Currently, if we request for frequency greater than maximum possible, spi driver returns error.  For example, if the spi block src frequency is 333/4 MHz, i.e. 83.33.. MHz, maximum frequency programmable would be src/2. Which would come around 41.6...  It is difficult to pass frequency in these figures. We normally try to program in round figures, like 42 MHz and it should get programmed to <= requested_frequency, i.e. 41.6...  For this to happen, we must not return error even if requested freq is higher than max possible. But should program it to max possible.  Reported-by: Vinit Kamalaksha Shenoy <vinit.shenoy@st.com> Signed-off-by: Viresh Kumar <viresh.kumar@st.com> Acked-by: Linus Walleij <linus.walleij@linaro.org> Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | spi-nuc900.c | s | 9.9K | 380 | Tobias Klauser | tklauser@distanz.ch | 1328141452 |  | spi/nuc900: Remove unnecessary memset of struct nuc900_spi  The memory allocated using kzalloc by spi_alloc_master so it doesn't need to be set to 0 again.  Signed-off-by: Tobias Klauser <tklauser@distanz.ch> Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | spi-mpc512x-psc.c | s | 13K | 463 | Grant Likely | grant.likely@secretlab.ca | 1319495747 |  | drivercore: Add helper macro for platform_driver boilerplate  For simple modules that contain a single platform_driver without any additional setup code then ends up being a block of duplicated boilerplate.  This patch adds a new macro, module_platform_driver(), which replaces the module_init()/module_exit() registrations with template functions.  Signed-off-by: Grant Likely <grant.likely@secretlab.ca> Acked-by: Greg Kroah-Hartman <gregkh@suse.de> Reviewed-by: Magnus Damm <magnus.damm@gmail.com> Reviewed-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Reviewed-by: Stephen Boyd <sboyd@codeaurora.org>
f | Kconfig | g | 13K |  | Kukjin Kim | kgene.kim@samsung.com | 1336987366 |  | Merge branch 'next/devel-s3c24xx-hsspi' into next/devel-samsung
f | spi-dw-pci.c | s | 3.9K | 144 | Axel Lin | axel.lin@gmail.com | 1334088694 |  | spi: use module_pci_driver  This patch converts the drivers in drivers/spi/* to use module_pci_driver() macro which makes the code smaller and a bit simpler.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | spi-ath79.c | s | 6.4K | 224 | Grant Likely | grant.likely@secretlab.ca | 1337492528 |  | spi: By default setup spi_masters with 1 chipselect and dynamics bus number  Trivial simplification.  Instead of requiring spi master drivers to always set the bus number (even when a dynamic number is desired), this patch modifies spi_alloc_master() to initialize num_chipselect to 1 (because there will always be at least one CS) and bus_num to -1 for dynamic allocation.  This simplifies the code needed to be written for drivers.  Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | spi-fsl-lib.h | s | 3.5K | 100 | Grant Likely | grant.likely@secretlab.ca | 1307344590 |  | spi: reorganize drivers  Sort the SPI makefile and enforce the naming convention spi_*.c for spi drivers.  This change also rolls the contents of atmel_spi.h into the .c file since there is only one user of that particular include file.  v2: - Use 'spi-' prefix instead of 'spi_' to match what seems to be       be the predominant pattern for subsystem prefixes.     - Clean up filenames in Kconfig and header comment blocks  Signed-off-by: Grant Likely <grant.likely@secretlab.ca> Acked-by: Wolfram Sang <w.sang@pengutronix.de> Acked-by: Linus Walleij <linus.walleij@linaro.org>
f | spi-ppc4xx.c | s | 13K | 497 | Grant Likely | grant.likely@secretlab.ca | 1337492528 |  | spi: By default setup spi_masters with 1 chipselect and dynamics bus number  Trivial simplification.  Instead of requiring spi master drivers to always set the bus number (even when a dynamic number is desired), this patch modifies spi_alloc_master() to initialize num_chipselect to 1 (because there will always be at least one CS) and bus_num to -1 for dynamic allocation.  This simplifies the code needed to be written for drivers.  Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | spi-bitbang.c | s | 13K | 436 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103937 |  | spi: Add module.h to implicit users in drivers/spi  We are clipping down the presence of module.h, since it was everywhere.  If you really need it, you better call it out, as per this changeset.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | spi-oc-tiny.c | s | 10K | 375 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103937 |  | spi: Add module.h to implicit users in drivers/spi  We are clipping down the presence of module.h, since it was everywhere.  If you really need it, you better call it out, as per this changeset.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | spi-altera.c | s | 7.9K | 282 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103937 |  | spi: Add module.h to implicit users in drivers/spi  We are clipping down the presence of module.h, since it was everywhere.  If you really need it, you better call it out, as per this changeset.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | spi-mpc52xx.c | s | 14K | 483 | Grant Likely | grant.likely@secretlab.ca | 1337492528 |  | spi: By default setup spi_masters with 1 chipselect and dynamics bus number  Trivial simplification.  Instead of requiring spi master drivers to always set the bus number (even when a dynamic number is desired), this patch modifies spi_alloc_master() to initialize num_chipselect to 1 (because there will always be at least one CS) and bus_num to -1 for dynamic allocation.  This simplifies the code needed to be written for drivers.  Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | spi-atmel.c | s | 27K | 921 | Jean-Christophe PLAGNIOL-VILLARD | plagnioj@jcrosoft.com | 1320850932 |  | atmel/spi: fix missing probe  Commit 940ab889 "drivercore: Add helper macro for platform_driver boilerplate" converted this driver to use module_platform_driver, but due to the use of platform_driver_probe(), this resulted in the call to atmel_spi_probe being lost. Place the call to this function into the driver structure.  fix section missmatch  atmel_spi_probe is marked __init where it's supposed to be __devinit atmel_spi_remove is marked __exit where it's supposed to be __devexit  Signed-off-by: Jean-Christophe PLAGNIOL-VILLARD <plagnioj@jcrosoft.com> Cc: Greg Kroah-Hartman <gregkh@suse.de> Cc: Grant Likely <grant.likely@secretlab.ca> Cc: Russell King - ARM Linux <linux@arm.linux.org.uk> Acked-by: Nicolas Ferre <nicolas.ferre@atmel.com>
f | spi-davinci.c | s | 26K | 854 | Shubhrajyoti D | shubhrajyoti@ti.com | 1333147582 |  | spi/davinci: Fix DMA API usage in davinci  The driver uses NULL for dma_unmap_single instead of the struct device that the API expects.  Signed-off-by: Shubhrajyoti D <shubhrajyoti@ti.com> Tested-by: Akshay Shankarmurthy <akshay.s@ti.com> Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | spi-pxa2xx.c | s | 47K | 1500 | Grant Likely | grant.likely@secretlab.ca | 1307344590 |  | spi: reorganize drivers  Sort the SPI makefile and enforce the naming convention spi_*.c for spi drivers.  This change also rolls the contents of atmel_spi.h into the .c file since there is only one user of that particular include file.  v2: - Use 'spi-' prefix instead of 'spi_' to match what seems to be       be the predominant pattern for subsystem prefixes.     - Clean up filenames in Kconfig and header comment blocks  Signed-off-by: Grant Likely <grant.likely@secretlab.ca> Acked-by: Wolfram Sang <w.sang@pengutronix.de> Acked-by: Linus Walleij <linus.walleij@linaro.org>
f | spi.c | s | 42K | 1338 | Grant Likely | grant.likely@secretlab.ca | 1337492528 |  | spi: By default setup spi_masters with 1 chipselect and dynamics bus number  Trivial simplification.  Instead of requiring spi master drivers to always set the bus number (even when a dynamic number is desired), this patch modifies spi_alloc_master() to initialize num_chipselect to 1 (because there will always be at least one CS) and bus_num to -1 for dynamic allocation.  This simplifies the code needed to be written for drivers.  Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | spi-rspi.c | s | 19K | 693 | Shimoda, Yoshihiro | yoshihiro.shimoda.uh@renesas.com | 1337488636 |  | spi/rspi: add dmaengine support  This patch adds dmaengine supporting using sh_dma driver. The module receives data by DMAC, it also needs TX DMAC to generate SPI's clocks.  Signed-off-by: Yoshihiro Shimoda <yoshihiro.shimoda.uh@renesas.com> Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | spi-txx9.c | s | 11K | 411 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103937 |  | spi: Add module.h to implicit users in drivers/spi  We are clipping down the presence of module.h, since it was everywhere.  If you really need it, you better call it out, as per this changeset.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | spi-s3c24xx-fiq.S | s | 2.9K | 88 | Grant Likely | grant.likely@secretlab.ca | 1307344590 |  | spi: reorganize drivers  Sort the SPI makefile and enforce the naming convention spi_*.c for spi drivers.  This change also rolls the contents of atmel_spi.h into the .c file since there is only one user of that particular include file.  v2: - Use 'spi-' prefix instead of 'spi_' to match what seems to be       be the predominant pattern for subsystem prefixes.     - Clean up filenames in Kconfig and header comment blocks  Signed-off-by: Grant Likely <grant.likely@secretlab.ca> Acked-by: Wolfram Sang <w.sang@pengutronix.de> Acked-by: Linus Walleij <linus.walleij@linaro.org>
f | spi-bfin-sport.c | s | 23K | 770 | Scott Jiang | scott.jiang.linux@gmail.com | 1335550645 |  | spi/spi_bfin_sport: drop bits_per_word from client data  Since the member was dropped from the common Blackfin header, we need to stop using it in the SPORT driver too.  Signed-off-by: Mike Frysinger <vapier@gentoo.org> Signed-off-by: Scott Jiang <scott.jiang.linux@gmail.com> Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | spi-bcm63xx.c | s | 11K | 405 | Florian Fainelli | florian@openwrt.org | 1335547155 |  | spi/bcm63xx: set master driver mode_bits.  We were not properly advertising the MODE bits supported by this driver, fix that.  Signed-off-by: Florian Fainelli <florian@openwrt.org> Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | spi-topcliff-pch.c | s | 48K | 1546 | Grant Likely | grant.likely@secretlab.ca | 1337492528 |  | spi: By default setup spi_masters with 1 chipselect and dynamics bus number  Trivial simplification.  Instead of requiring spi master drivers to always set the bus number (even when a dynamic number is desired), this patch modifies spi_alloc_master() to initialize num_chipselect to 1 (because there will always be at least one CS) and bus_num to -1 for dynamic allocation.  This simplifies the code needed to be written for drivers.  Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
