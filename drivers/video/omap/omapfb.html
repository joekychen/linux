<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › video › omap › omapfb.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>omapfb.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * File: drivers/video/omap/omapfb.h</span>
<span class="cm"> *</span>
<span class="cm"> * Framebuffer driver for TI OMAP boards</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 2004 Nokia Corporation</span>
<span class="cm"> * Author: Imre Deak &lt;imre.deak@nokia.com&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify it</span>
<span class="cm"> * under the terms of the GNU General Public License as published by the</span>
<span class="cm"> * Free Software Foundation; either version 2 of the License, or (at your</span>
<span class="cm"> * option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful, but</span>
<span class="cm"> * WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<span class="cm"> * General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License along</span>
<span class="cm"> * with this program; if not, write to the Free Software Foundation, Inc.,</span>
<span class="cm"> * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef __OMAPFB_H</span>
<span class="cp">#define __OMAPFB_H</span>

<span class="cp">#include &lt;linux/fb.h&gt;</span>
<span class="cp">#include &lt;linux/mutex.h&gt;</span>
<span class="cp">#include &lt;linux/omapfb.h&gt;</span>

<span class="cp">#define OMAPFB_EVENT_READY	1</span>
<span class="cp">#define OMAPFB_EVENT_DISABLED	2</span>

<span class="cp">#define OMAP_LCDC_INV_VSYNC             0x0001</span>
<span class="cp">#define OMAP_LCDC_INV_HSYNC             0x0002</span>
<span class="cp">#define OMAP_LCDC_INV_PIX_CLOCK         0x0004</span>
<span class="cp">#define OMAP_LCDC_INV_OUTPUT_EN         0x0008</span>
<span class="cp">#define OMAP_LCDC_HSVS_RISING_EDGE      0x0010</span>
<span class="cp">#define OMAP_LCDC_HSVS_OPPOSITE         0x0020</span>

<span class="cp">#define OMAP_LCDC_SIGNAL_MASK		0x003f</span>

<span class="cp">#define OMAP_LCDC_PANEL_TFT		0x0100</span>

<span class="cp">#define OMAPFB_PLANE_XRES_MIN		8</span>
<span class="cp">#define OMAPFB_PLANE_YRES_MIN		8</span>

<span class="k">struct</span> <span class="n">omapfb_device</span><span class="p">;</span>

<span class="cp">#define OMAPFB_PLANE_NUM		1</span>

<span class="k">struct</span> <span class="n">omapfb_mem_region</span> <span class="p">{</span>
	<span class="n">u32</span>		<span class="n">paddr</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span>	<span class="o">*</span><span class="n">vaddr</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span>	<span class="n">size</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">type</span><span class="p">;</span>		<span class="cm">/* OMAPFB_PLANE_MEM_* */</span>
	<span class="k">enum</span> <span class="n">omapfb_color_format</span> <span class="n">format</span><span class="p">;</span><span class="cm">/* OMAPFB_COLOR_* */</span>
	<span class="kt">unsigned</span>	<span class="n">format_used</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>	<span class="cm">/* Must be set when format is set.</span>
<span class="cm">					 * Needed b/c of the badly chosen 0</span>
<span class="cm">					 * base for OMAPFB_COLOR_* values</span>
<span class="cm">					 */</span>
	<span class="kt">unsigned</span>	<span class="n">alloc</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>	<span class="cm">/* allocated by the driver */</span>
	<span class="kt">unsigned</span>	<span class="n">map</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>		<span class="cm">/* kernel mapped by the driver */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">omapfb_mem_desc</span> <span class="p">{</span>
	<span class="kt">int</span>				<span class="n">region_cnt</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">omapfb_mem_region</span>	<span class="n">region</span><span class="p">[</span><span class="n">OMAPFB_PLANE_NUM</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">lcd_panel</span> <span class="p">{</span>
	<span class="k">const</span> <span class="kt">char</span>	<span class="o">*</span><span class="n">name</span><span class="p">;</span>
	<span class="kt">int</span>		<span class="n">config</span><span class="p">;</span>		<span class="cm">/* TFT/STN, signal inversion */</span>
	<span class="kt">int</span>		<span class="n">bpp</span><span class="p">;</span>		<span class="cm">/* Pixel format in fb mem */</span>
	<span class="kt">int</span>		<span class="n">data_lines</span><span class="p">;</span>	<span class="cm">/* Lines on LCD HW interface */</span>

	<span class="kt">int</span>		<span class="n">x_res</span><span class="p">,</span> <span class="n">y_res</span><span class="p">;</span>
	<span class="kt">int</span>		<span class="n">pixel_clock</span><span class="p">;</span>	<span class="cm">/* In kHz */</span>
	<span class="kt">int</span>		<span class="n">hsw</span><span class="p">;</span>		<span class="cm">/* Horizontal synchronization</span>
<span class="cm">					   pulse width */</span>
	<span class="kt">int</span>		<span class="n">hfp</span><span class="p">;</span>		<span class="cm">/* Horizontal front porch */</span>
	<span class="kt">int</span>		<span class="n">hbp</span><span class="p">;</span>		<span class="cm">/* Horizontal back porch */</span>
	<span class="kt">int</span>		<span class="n">vsw</span><span class="p">;</span>		<span class="cm">/* Vertical synchronization</span>
<span class="cm">					   pulse width */</span>
	<span class="kt">int</span>		<span class="n">vfp</span><span class="p">;</span>		<span class="cm">/* Vertical front porch */</span>
	<span class="kt">int</span>		<span class="n">vbp</span><span class="p">;</span>		<span class="cm">/* Vertical back porch */</span>
	<span class="kt">int</span>		<span class="n">acb</span><span class="p">;</span>		<span class="cm">/* ac-bias pin frequency */</span>
	<span class="kt">int</span>		<span class="n">pcd</span><span class="p">;</span>		<span class="cm">/* pixel clock divider.</span>
<span class="cm">					   Obsolete use pixel_clock instead */</span>

	<span class="kt">int</span>		<span class="p">(</span><span class="o">*</span><span class="n">init</span><span class="p">)</span>		<span class="p">(</span><span class="k">struct</span> <span class="n">lcd_panel</span> <span class="o">*</span><span class="n">panel</span><span class="p">,</span>
					 <span class="k">struct</span> <span class="n">omapfb_device</span> <span class="o">*</span><span class="n">fbdev</span><span class="p">);</span>
	<span class="kt">void</span>		<span class="p">(</span><span class="o">*</span><span class="n">cleanup</span><span class="p">)</span>	<span class="p">(</span><span class="k">struct</span> <span class="n">lcd_panel</span> <span class="o">*</span><span class="n">panel</span><span class="p">);</span>
	<span class="kt">int</span>		<span class="p">(</span><span class="o">*</span><span class="n">enable</span><span class="p">)</span>	<span class="p">(</span><span class="k">struct</span> <span class="n">lcd_panel</span> <span class="o">*</span><span class="n">panel</span><span class="p">);</span>
	<span class="kt">void</span>		<span class="p">(</span><span class="o">*</span><span class="n">disable</span><span class="p">)</span>	<span class="p">(</span><span class="k">struct</span> <span class="n">lcd_panel</span> <span class="o">*</span><span class="n">panel</span><span class="p">);</span>
	<span class="kt">unsigned</span> <span class="kt">long</span>	<span class="p">(</span><span class="o">*</span><span class="n">get_caps</span><span class="p">)</span>	<span class="p">(</span><span class="k">struct</span> <span class="n">lcd_panel</span> <span class="o">*</span><span class="n">panel</span><span class="p">);</span>
	<span class="kt">int</span>		<span class="p">(</span><span class="o">*</span><span class="n">set_bklight_level</span><span class="p">)(</span><span class="k">struct</span> <span class="n">lcd_panel</span> <span class="o">*</span><span class="n">panel</span><span class="p">,</span>
					     <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">level</span><span class="p">);</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>	<span class="p">(</span><span class="o">*</span><span class="n">get_bklight_level</span><span class="p">)(</span><span class="k">struct</span> <span class="n">lcd_panel</span> <span class="o">*</span><span class="n">panel</span><span class="p">);</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>	<span class="p">(</span><span class="o">*</span><span class="n">get_bklight_max</span><span class="p">)</span>  <span class="p">(</span><span class="k">struct</span> <span class="n">lcd_panel</span> <span class="o">*</span><span class="n">panel</span><span class="p">);</span>
	<span class="kt">int</span>		<span class="p">(</span><span class="o">*</span><span class="n">run_test</span><span class="p">)</span>	<span class="p">(</span><span class="k">struct</span> <span class="n">lcd_panel</span> <span class="o">*</span><span class="n">panel</span><span class="p">,</span> <span class="kt">int</span> <span class="n">test_num</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">extif_timings</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">cs_on_time</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">cs_off_time</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">we_on_time</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">we_off_time</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">re_on_time</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">re_off_time</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">we_cycle_time</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">re_cycle_time</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">cs_pulse_width</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">access_time</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">clk_div</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">tim</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>		<span class="cm">/* set by extif-&gt;convert_timings */</span>

	<span class="kt">int</span> <span class="n">converted</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">lcd_ctrl_extif</span> <span class="p">{</span>
	<span class="kt">int</span>  <span class="p">(</span><span class="o">*</span><span class="n">init</span><span class="p">)</span>		<span class="p">(</span><span class="k">struct</span> <span class="n">omapfb_device</span> <span class="o">*</span><span class="n">fbdev</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">cleanup</span><span class="p">)</span>		<span class="p">(</span><span class="kt">void</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">get_clk_info</span><span class="p">)</span>	<span class="p">(</span><span class="n">u32</span> <span class="o">*</span><span class="n">clk_period</span><span class="p">,</span> <span class="n">u32</span> <span class="o">*</span><span class="n">max_clk_div</span><span class="p">);</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="p">(</span><span class="o">*</span><span class="n">get_max_tx_rate</span><span class="p">)(</span><span class="kt">void</span><span class="p">);</span>
	<span class="kt">int</span>  <span class="p">(</span><span class="o">*</span><span class="n">convert_timings</span><span class="p">)</span>	<span class="p">(</span><span class="k">struct</span> <span class="n">extif_timings</span> <span class="o">*</span><span class="n">timings</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">set_timings</span><span class="p">)</span>	<span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">extif_timings</span> <span class="o">*</span><span class="n">timings</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">set_bits_per_cycle</span><span class="p">)(</span><span class="kt">int</span> <span class="n">bpc</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">write_command</span><span class="p">)</span>	<span class="p">(</span><span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">len</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">read_data</span><span class="p">)</span>	<span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">len</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">write_data</span><span class="p">)</span>	<span class="p">(</span><span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">len</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">transfer_area</span><span class="p">)</span>	<span class="p">(</span><span class="kt">int</span> <span class="n">width</span><span class="p">,</span> <span class="kt">int</span> <span class="n">height</span><span class="p">,</span>
				 <span class="kt">void</span> <span class="p">(</span><span class="n">callback</span><span class="p">)(</span><span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">),</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">);</span>
	<span class="kt">int</span>  <span class="p">(</span><span class="o">*</span><span class="n">setup_tearsync</span><span class="p">)</span>	<span class="p">(</span><span class="kt">unsigned</span> <span class="n">pin_cnt</span><span class="p">,</span>
				 <span class="kt">unsigned</span> <span class="n">hs_pulse_time</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">vs_pulse_time</span><span class="p">,</span>
				 <span class="kt">int</span> <span class="n">hs_pol_inv</span><span class="p">,</span> <span class="kt">int</span> <span class="n">vs_pol_inv</span><span class="p">,</span> <span class="kt">int</span> <span class="n">div</span><span class="p">);</span>
	<span class="kt">int</span>  <span class="p">(</span><span class="o">*</span><span class="n">enable_tearsync</span><span class="p">)</span> <span class="p">(</span><span class="kt">int</span> <span class="n">enable</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">line</span><span class="p">);</span>

	<span class="kt">unsigned</span> <span class="kt">long</span>		<span class="n">max_transmit_size</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">omapfb_notifier_block</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">notifier_block</span>	<span class="n">nb</span><span class="p">;</span>
	<span class="kt">void</span>			<span class="o">*</span><span class="n">data</span><span class="p">;</span>
	<span class="kt">int</span>			<span class="n">plane_idx</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">typedef</span> <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">omapfb_notifier_callback_t</span><span class="p">)(</span><span class="k">struct</span> <span class="n">notifier_block</span> <span class="o">*</span><span class="p">,</span>
					  <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">event</span><span class="p">,</span>
					  <span class="kt">void</span> <span class="o">*</span><span class="n">fbi</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">lcd_ctrl</span> <span class="p">{</span>
	<span class="k">const</span> <span class="kt">char</span>	<span class="o">*</span><span class="n">name</span><span class="p">;</span>
	<span class="kt">void</span>		<span class="o">*</span><span class="n">data</span><span class="p">;</span>

	<span class="kt">int</span>		<span class="p">(</span><span class="o">*</span><span class="n">init</span><span class="p">)</span>		  <span class="p">(</span><span class="k">struct</span> <span class="n">omapfb_device</span> <span class="o">*</span><span class="n">fbdev</span><span class="p">,</span>
					   <span class="kt">int</span> <span class="n">ext_mode</span><span class="p">,</span>
					   <span class="k">struct</span> <span class="n">omapfb_mem_desc</span> <span class="o">*</span><span class="n">req_md</span><span class="p">);</span>
	<span class="kt">void</span>		<span class="p">(</span><span class="o">*</span><span class="n">cleanup</span><span class="p">)</span>	  <span class="p">(</span><span class="kt">void</span><span class="p">);</span>
	<span class="kt">void</span>		<span class="p">(</span><span class="o">*</span><span class="n">bind_client</span><span class="p">)</span>	  <span class="p">(</span><span class="k">struct</span> <span class="n">omapfb_notifier_block</span> <span class="o">*</span><span class="n">nb</span><span class="p">);</span>
	<span class="kt">void</span>		<span class="p">(</span><span class="o">*</span><span class="n">get_caps</span><span class="p">)</span>	  <span class="p">(</span><span class="kt">int</span> <span class="n">plane</span><span class="p">,</span> <span class="k">struct</span> <span class="n">omapfb_caps</span> <span class="o">*</span><span class="n">caps</span><span class="p">);</span>
	<span class="kt">int</span>		<span class="p">(</span><span class="o">*</span><span class="n">set_update_mode</span><span class="p">)(</span><span class="k">enum</span> <span class="n">omapfb_update_mode</span> <span class="n">mode</span><span class="p">);</span>
	<span class="k">enum</span> <span class="n">omapfb_update_mode</span> <span class="p">(</span><span class="o">*</span><span class="n">get_update_mode</span><span class="p">)(</span><span class="kt">void</span><span class="p">);</span>
	<span class="kt">int</span>		<span class="p">(</span><span class="o">*</span><span class="n">setup_plane</span><span class="p">)</span>	  <span class="p">(</span><span class="kt">int</span> <span class="n">plane</span><span class="p">,</span> <span class="kt">int</span> <span class="n">channel_out</span><span class="p">,</span>
					   <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">offset</span><span class="p">,</span>
					   <span class="kt">int</span> <span class="n">screen_width</span><span class="p">,</span>
					   <span class="kt">int</span> <span class="n">pos_x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pos_y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">width</span><span class="p">,</span>
					   <span class="kt">int</span> <span class="n">height</span><span class="p">,</span> <span class="kt">int</span> <span class="n">color_mode</span><span class="p">);</span>
	<span class="kt">int</span>		<span class="p">(</span><span class="o">*</span><span class="n">set_rotate</span><span class="p">)</span>	  <span class="p">(</span><span class="kt">int</span> <span class="n">angle</span><span class="p">);</span>
	<span class="kt">int</span>		<span class="p">(</span><span class="o">*</span><span class="n">setup_mem</span><span class="p">)</span>	  <span class="p">(</span><span class="kt">int</span> <span class="n">plane</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">size</span><span class="p">,</span>
					   <span class="kt">int</span> <span class="n">mem_type</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="o">*</span><span class="n">paddr</span><span class="p">);</span>
	<span class="kt">int</span>		<span class="p">(</span><span class="o">*</span><span class="n">mmap</span><span class="p">)</span>		  <span class="p">(</span><span class="k">struct</span> <span class="n">fb_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
					   <span class="k">struct</span> <span class="n">vm_area_struct</span> <span class="o">*</span><span class="n">vma</span><span class="p">);</span>
	<span class="kt">int</span>		<span class="p">(</span><span class="o">*</span><span class="n">set_scale</span><span class="p">)</span>	  <span class="p">(</span><span class="kt">int</span> <span class="n">plane</span><span class="p">,</span>
					   <span class="kt">int</span> <span class="n">orig_width</span><span class="p">,</span> <span class="kt">int</span> <span class="n">orig_height</span><span class="p">,</span>
					   <span class="kt">int</span> <span class="n">out_width</span><span class="p">,</span> <span class="kt">int</span> <span class="n">out_height</span><span class="p">);</span>
	<span class="kt">int</span>		<span class="p">(</span><span class="o">*</span><span class="n">enable_plane</span><span class="p">)</span>	  <span class="p">(</span><span class="kt">int</span> <span class="n">plane</span><span class="p">,</span> <span class="kt">int</span> <span class="n">enable</span><span class="p">);</span>
	<span class="kt">int</span>		<span class="p">(</span><span class="o">*</span><span class="n">update_window</span><span class="p">)</span>  <span class="p">(</span><span class="k">struct</span> <span class="n">fb_info</span> <span class="o">*</span><span class="n">fbi</span><span class="p">,</span>
					   <span class="k">struct</span> <span class="n">omapfb_update_window</span> <span class="o">*</span><span class="n">win</span><span class="p">,</span>
					   <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">callback</span><span class="p">)(</span><span class="kt">void</span> <span class="o">*</span><span class="p">),</span>
					   <span class="kt">void</span> <span class="o">*</span><span class="n">callback_data</span><span class="p">);</span>
	<span class="kt">void</span>		<span class="p">(</span><span class="o">*</span><span class="n">sync</span><span class="p">)</span>		  <span class="p">(</span><span class="kt">void</span><span class="p">);</span>
	<span class="kt">void</span>		<span class="p">(</span><span class="o">*</span><span class="n">suspend</span><span class="p">)</span>	  <span class="p">(</span><span class="kt">void</span><span class="p">);</span>
	<span class="kt">void</span>		<span class="p">(</span><span class="o">*</span><span class="n">resume</span><span class="p">)</span>	  <span class="p">(</span><span class="kt">void</span><span class="p">);</span>
	<span class="kt">int</span>		<span class="p">(</span><span class="o">*</span><span class="n">run_test</span><span class="p">)</span>	  <span class="p">(</span><span class="kt">int</span> <span class="n">test_num</span><span class="p">);</span>
	<span class="kt">int</span>		<span class="p">(</span><span class="o">*</span><span class="n">setcolreg</span><span class="p">)</span>	  <span class="p">(</span><span class="n">u_int</span> <span class="n">regno</span><span class="p">,</span> <span class="n">u16</span> <span class="n">red</span><span class="p">,</span> <span class="n">u16</span> <span class="n">green</span><span class="p">,</span>
					   <span class="n">u16</span> <span class="n">blue</span><span class="p">,</span> <span class="n">u16</span> <span class="n">transp</span><span class="p">,</span>
					   <span class="kt">int</span> <span class="n">update_hw_mem</span><span class="p">);</span>
	<span class="kt">int</span>		<span class="p">(</span><span class="o">*</span><span class="n">set_color_key</span><span class="p">)</span>  <span class="p">(</span><span class="k">struct</span> <span class="n">omapfb_color_key</span> <span class="o">*</span><span class="n">ck</span><span class="p">);</span>
	<span class="kt">int</span>		<span class="p">(</span><span class="o">*</span><span class="n">get_color_key</span><span class="p">)</span>  <span class="p">(</span><span class="k">struct</span> <span class="n">omapfb_color_key</span> <span class="o">*</span><span class="n">ck</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">omapfb_state</span> <span class="p">{</span>
	<span class="n">OMAPFB_DISABLED</span>		<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">OMAPFB_SUSPENDED</span>	<span class="o">=</span> <span class="mi">99</span><span class="p">,</span>
	<span class="n">OMAPFB_ACTIVE</span>		<span class="o">=</span> <span class="mi">100</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">omapfb_plane_struct</span> <span class="p">{</span>
	<span class="kt">int</span>				<span class="n">idx</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">omapfb_plane_info</span>	<span class="n">info</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">omapfb_color_format</span>	<span class="n">color_mode</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">omapfb_device</span>		<span class="o">*</span><span class="n">fbdev</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">omapfb_device</span> <span class="p">{</span>
	<span class="kt">int</span>			<span class="n">state</span><span class="p">;</span>
	<span class="kt">int</span>                     <span class="n">ext_lcdc</span><span class="p">;</span>		<span class="cm">/* Using external</span>
<span class="cm">							   LCD controller */</span>
	<span class="k">struct</span> <span class="n">mutex</span>		<span class="n">rqueue_mutex</span><span class="p">;</span>

	<span class="kt">int</span>			<span class="n">palette_size</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">pseudo_palette</span><span class="p">[</span><span class="mi">17</span><span class="p">];</span>

	<span class="k">struct</span> <span class="n">lcd_panel</span>	<span class="o">*</span><span class="n">panel</span><span class="p">;</span>			<span class="cm">/* LCD panel */</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">lcd_ctrl</span>	<span class="o">*</span><span class="n">ctrl</span><span class="p">;</span>			<span class="cm">/* LCD controller */</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">lcd_ctrl</span>	<span class="o">*</span><span class="n">int_ctrl</span><span class="p">;</span>		<span class="cm">/* internal LCD ctrl */</span>
	<span class="k">struct</span> <span class="n">lcd_ctrl_extif</span>	<span class="o">*</span><span class="n">ext_if</span><span class="p">;</span>		<span class="cm">/* LCD ctrl external</span>
<span class="cm">							   interface */</span>
	<span class="k">struct</span> <span class="n">device</span>		<span class="o">*</span><span class="n">dev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">fb_var_screeninfo</span>	<span class="n">new_var</span><span class="p">;</span>	<span class="cm">/* for mode changes */</span>

	<span class="k">struct</span> <span class="n">omapfb_mem_desc</span>		<span class="n">mem_desc</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">fb_info</span>			<span class="o">*</span><span class="n">fb_info</span><span class="p">[</span><span class="n">OMAPFB_PLANE_NUM</span><span class="p">];</span>

	<span class="k">struct</span> <span class="n">platform_device</span>	<span class="o">*</span><span class="n">dssdev</span><span class="p">;</span>	<span class="cm">/* dummy dev for clocks */</span>
<span class="p">};</span>

<span class="k">extern</span> <span class="k">struct</span> <span class="n">lcd_ctrl</span> <span class="n">omap1_lcd_ctrl</span><span class="p">;</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">omapfb_register_panel</span><span class="p">(</span><span class="k">struct</span> <span class="n">lcd_panel</span> <span class="o">*</span><span class="n">panel</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">omapfb_write_first_pixel</span><span class="p">(</span><span class="k">struct</span> <span class="n">omapfb_device</span> <span class="o">*</span><span class="n">fbdev</span><span class="p">,</span> <span class="n">u16</span> <span class="n">pixval</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">omapfb_notify_clients</span><span class="p">(</span><span class="k">struct</span> <span class="n">omapfb_device</span> <span class="o">*</span><span class="n">fbdev</span><span class="p">,</span>
				  <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">event</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span>  <span class="n">omapfb_register_client</span><span class="p">(</span><span class="k">struct</span> <span class="n">omapfb_notifier_block</span> <span class="o">*</span><span class="n">nb</span><span class="p">,</span>
				   <span class="n">omapfb_notifier_callback_t</span> <span class="n">callback</span><span class="p">,</span>
				   <span class="kt">void</span> <span class="o">*</span><span class="n">callback_data</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span>  <span class="n">omapfb_unregister_client</span><span class="p">(</span><span class="k">struct</span> <span class="n">omapfb_notifier_block</span> <span class="o">*</span><span class="n">nb</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span>  <span class="n">omapfb_update_window_async</span><span class="p">(</span><span class="k">struct</span> <span class="n">fb_info</span> <span class="o">*</span><span class="n">fbi</span><span class="p">,</span>
				       <span class="k">struct</span> <span class="n">omapfb_update_window</span> <span class="o">*</span><span class="n">win</span><span class="p">,</span>
				       <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">callback</span><span class="p">)(</span><span class="kt">void</span> <span class="o">*</span><span class="p">),</span>
				       <span class="kt">void</span> <span class="o">*</span><span class="n">callback_data</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* __OMAPFB_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
