<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › video › riva › nvreg.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>nvreg.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/* $XConsortium: nvreg.h /main/2 1996/10/28 05:13:41 kaleb $ */</span>
<span class="cm">/*</span>
<span class="cm"> * Copyright 1996-1997  David J. McKay</span>
<span class="cm"> *</span>
<span class="cm"> * Permission is hereby granted, free of charge, to any person obtaining a</span>
<span class="cm"> * copy of this software and associated documentation files (the &quot;Software&quot;),</span>
<span class="cm"> * to deal in the Software without restriction, including without limitation</span>
<span class="cm"> * the rights to use, copy, modify, merge, publish, distribute, sublicense,</span>
<span class="cm"> * and/or sell copies of the Software, and to permit persons to whom the</span>
<span class="cm"> * Software is furnished to do so, subject to the following conditions:</span>
<span class="cm"> *</span>
<span class="cm"> * The above copyright notice and this permission notice shall be included in</span>
<span class="cm"> * all copies or substantial portions of the Software.</span>
<span class="cm"> *</span>
<span class="cm"> * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="cm"> * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="cm"> * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL</span>
<span class="cm"> * DAVID J. MCKAY BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,</span>
<span class="cm"> * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF</span>
<span class="cm"> * OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span>
<span class="cm"> * SOFTWARE.</span>
<span class="cm"> */</span>

<span class="cm">/* $XFree86: xc/programs/Xserver/hw/xfree86/vga256/drivers/nv/nvreg.h,v 3.2.2.1 1998/01/18 10:35:36 hohndel Exp $ */</span>

<span class="cp">#ifndef __NVREG_H_</span>
<span class="cp">#define __NVREG_H_</span>

<span class="cm">/* Little macro to construct bitmask for contiguous ranges of bits */</span>
<span class="cp">#define BITMASK(t,b) (((unsigned)(1U &lt;&lt; (((t)-(b)+1)))-1)  &lt;&lt; (b))</span>
<span class="cp">#define MASKEXPAND(mask) BITMASK(1?mask,0?mask)</span>

<span class="cm">/* Macro to set specific bitfields (mask has to be a macro x:y) ! */</span>
<span class="cp">#define SetBF(mask,value) ((value) &lt;&lt; (0?mask))</span>
<span class="cp">#define GetBF(var,mask) (((unsigned)((var) &amp; MASKEXPAND(mask))) &gt;&gt; (0?mask) )</span>

<span class="cp">#define MaskAndSetBF(var,mask,value) (var)=(((var)&amp;(~MASKEXPAND(mask)) \</span>
<span class="cp">                                             | SetBF(mask,value)))</span>

<span class="cp">#define DEVICE_BASE(device) (0?NV##_##device)</span>
<span class="cp">#define DEVICE_SIZE(device) ((1?NV##_##device) - DEVICE_BASE(device)+1)</span>

<span class="cm">/* This is where we will have to have conditional compilation */</span>
<span class="cp">#define DEVICE_ACCESS(device,reg) \</span>
<span class="cp">  nvCONTROL[(NV_##device##_##reg)/4]</span>

<span class="cp">#define DEVICE_WRITE(device,reg,value) DEVICE_ACCESS(device,reg)=(value)</span>
<span class="cp">#define DEVICE_READ(device,reg)        DEVICE_ACCESS(device,reg)</span>
<span class="cp">#define DEVICE_PRINT(device,reg) \</span>
<span class="cp">  ErrorF(&quot;NV_&quot;#device&quot;_&quot;#reg&quot;=#%08lx\n&quot;,DEVICE_ACCESS(device,reg))</span>
<span class="cp">#define DEVICE_DEF(device,mask,value) \</span>
<span class="cp">  SetBF(NV_##device##_##mask,NV_##device##_##mask##_##value)</span>
<span class="cp">#define DEVICE_VALUE(device,mask,value) SetBF(NV_##device##_##mask,value)</span>
<span class="cp">#define DEVICE_MASK(device,mask) MASKEXPAND(NV_##device##_##mask)</span>

<span class="cp">#define PDAC_Write(reg,value)           DEVICE_WRITE(PDAC,reg,value)</span>
<span class="cp">#define PDAC_Read(reg)                  DEVICE_READ(PDAC,reg)</span>
<span class="cp">#define PDAC_Print(reg)                 DEVICE_PRINT(PDAC,reg)</span>
<span class="cp">#define PDAC_Def(mask,value)            DEVICE_DEF(PDAC,mask,value)</span>
<span class="cp">#define PDAC_Val(mask,value)            DEVICE_VALUE(PDAC,mask,value)</span>
<span class="cp">#define PDAC_Mask(mask)                 DEVICE_MASK(PDAC,mask)</span>

<span class="cp">#define PFB_Write(reg,value)            DEVICE_WRITE(PFB,reg,value)</span>
<span class="cp">#define PFB_Read(reg)                   DEVICE_READ(PFB,reg)</span>
<span class="cp">#define PFB_Print(reg)                  DEVICE_PRINT(PFB,reg)</span>
<span class="cp">#define PFB_Def(mask,value)             DEVICE_DEF(PFB,mask,value)</span>
<span class="cp">#define PFB_Val(mask,value)             DEVICE_VALUE(PFB,mask,value)</span>
<span class="cp">#define PFB_Mask(mask)                  DEVICE_MASK(PFB,mask)</span>

<span class="cp">#define PRM_Write(reg,value)            DEVICE_WRITE(PRM,reg,value)</span>
<span class="cp">#define PRM_Read(reg)                   DEVICE_READ(PRM,reg)</span>
<span class="cp">#define PRM_Print(reg)                  DEVICE_PRINT(PRM,reg)</span>
<span class="cp">#define PRM_Def(mask,value)             DEVICE_DEF(PRM,mask,value)</span>
<span class="cp">#define PRM_Val(mask,value)             DEVICE_VALUE(PRM,mask,value)</span>
<span class="cp">#define PRM_Mask(mask)                  DEVICE_MASK(PRM,mask)</span>

<span class="cp">#define PGRAPH_Write(reg,value)         DEVICE_WRITE(PGRAPH,reg,value)</span>
<span class="cp">#define PGRAPH_Read(reg)                DEVICE_READ(PGRAPH,reg)</span>
<span class="cp">#define PGRAPH_Print(reg)               DEVICE_PRINT(PGRAPH,reg)</span>
<span class="cp">#define PGRAPH_Def(mask,value)          DEVICE_DEF(PGRAPH,mask,value)</span>
<span class="cp">#define PGRAPH_Val(mask,value)          DEVICE_VALUE(PGRAPH,mask,value)</span>
<span class="cp">#define PGRAPH_Mask(mask)               DEVICE_MASK(PGRAPH,mask)</span>

<span class="cp">#define PDMA_Write(reg,value)           DEVICE_WRITE(PDMA,reg,value)</span>
<span class="cp">#define PDMA_Read(reg)                  DEVICE_READ(PDMA,reg)</span>
<span class="cp">#define PDMA_Print(reg)                 DEVICE_PRINT(PDMA,reg)</span>
<span class="cp">#define PDMA_Def(mask,value)            DEVICE_DEF(PDMA,mask,value)</span>
<span class="cp">#define PDMA_Val(mask,value)            DEVICE_VALUE(PDMA,mask,value)</span>
<span class="cp">#define PDMA_Mask(mask)                 DEVICE_MASK(PDMA,mask)</span>

<span class="cp">#define PTIMER_Write(reg,value)         DEVICE_WRITE(PTIMER,reg,value)</span>
<span class="cp">#define PTIMER_Read(reg)                DEVICE_READ(PTIMER,reg)</span>
<span class="cp">#define PTIMER_Print(reg)               DEVICE_PRINT(PTIMER,reg)</span>
<span class="cp">#define PTIMER_Def(mask,value)          DEVICE_DEF(PTIMER,mask,value)</span>
<span class="cp">#define PTIMER_Val(mask,value)          DEVICE_VALUE(PTIEMR,mask,value)</span>
<span class="cp">#define PTIMER_Mask(mask)               DEVICE_MASK(PTIMER,mask)</span>

<span class="cp">#define PEXTDEV_Write(reg,value)         DEVICE_WRITE(PEXTDEV,reg,value)</span>
<span class="cp">#define PEXTDEV_Read(reg)                DEVICE_READ(PEXTDEV,reg)</span>
<span class="cp">#define PEXTDEV_Print(reg)               DEVICE_PRINT(PEXTDEV,reg)</span>
<span class="cp">#define PEXTDEV_Def(mask,value)          DEVICE_DEF(PEXTDEV,mask,value)</span>
<span class="cp">#define PEXTDEV_Val(mask,value)          DEVICE_VALUE(PEXTDEV,mask,value)</span>
<span class="cp">#define PEXTDEV_Mask(mask)               DEVICE_MASK(PEXTDEV,mask)</span>

<span class="cp">#define PFIFO_Write(reg,value)          DEVICE_WRITE(PFIFO,reg,value)</span>
<span class="cp">#define PFIFO_Read(reg)                 DEVICE_READ(PFIFO,reg)</span>
<span class="cp">#define PFIFO_Print(reg)                DEVICE_PRINT(PFIFO,reg)</span>
<span class="cp">#define PFIFO_Def(mask,value)           DEVICE_DEF(PFIFO,mask,value)</span>
<span class="cp">#define PFIFO_Val(mask,value)           DEVICE_VALUE(PFIFO,mask,value)</span>
<span class="cp">#define PFIFO_Mask(mask)                DEVICE_MASK(PFIFO,mask)</span>

<span class="cp">#define PRAM_Write(reg,value)           DEVICE_WRITE(PRAM,reg,value)</span>
<span class="cp">#define PRAM_Read(reg)                  DEVICE_READ(PRAM,reg)</span>
<span class="cp">#define PRAM_Print(reg)                 DEVICE_PRINT(PRAM,reg)</span>
<span class="cp">#define PRAM_Def(mask,value)            DEVICE_DEF(PRAM,mask,value)</span>
<span class="cp">#define PRAM_Val(mask,value)            DEVICE_VALUE(PRAM,mask,value)</span>
<span class="cp">#define PRAM_Mask(mask)                 DEVICE_MASK(PRAM,mask)</span>

<span class="cp">#define PRAMFC_Write(reg,value)         DEVICE_WRITE(PRAMFC,reg,value)</span>
<span class="cp">#define PRAMFC_Read(reg)                DEVICE_READ(PRAMFC,reg)</span>
<span class="cp">#define PRAMFC_Print(reg)               DEVICE_PRINT(PRAMFC,reg)</span>
<span class="cp">#define PRAMFC_Def(mask,value)          DEVICE_DEF(PRAMFC,mask,value)</span>
<span class="cp">#define PRAMFC_Val(mask,value)          DEVICE_VALUE(PRAMFC,mask,value)</span>
<span class="cp">#define PRAMFC_Mask(mask)               DEVICE_MASK(PRAMFC,mask)</span>

<span class="cp">#define PMC_Write(reg,value)            DEVICE_WRITE(PMC,reg,value)</span>
<span class="cp">#define PMC_Read(reg)                   DEVICE_READ(PMC,reg)</span>
<span class="cp">#define PMC_Print(reg)                  DEVICE_PRINT(PMC,reg)</span>
<span class="cp">#define PMC_Def(mask,value)             DEVICE_DEF(PMC,mask,value)</span>
<span class="cp">#define PMC_Val(mask,value)             DEVICE_VALUE(PMC,mask,value)</span>
<span class="cp">#define PMC_Mask(mask)                  DEVICE_MASK(PMC,mask)</span>

<span class="cp">#define PMC_Write(reg,value)            DEVICE_WRITE(PMC,reg,value)</span>
<span class="cp">#define PMC_Read(reg)                   DEVICE_READ(PMC,reg)</span>
<span class="cp">#define PMC_Print(reg)                  DEVICE_PRINT(PMC,reg)</span>
<span class="cp">#define PMC_Def(mask,value)             DEVICE_DEF(PMC,mask,value)</span>
<span class="cp">#define PMC_Val(mask,value)             DEVICE_VALUE(PMC,mask,value)</span>
<span class="cp">#define PMC_Mask(mask)                  DEVICE_MASK(PMC,mask)</span>


<span class="cp">#define PBUS_Write(reg,value)         DEVICE_WRITE(PBUS,reg,value)</span>
<span class="cp">#define PBUS_Read(reg)                DEVICE_READ(PBUS,reg)</span>
<span class="cp">#define PBUS_Print(reg)               DEVICE_PRINT(PBUS,reg)</span>
<span class="cp">#define PBUS_Def(mask,value)          DEVICE_DEF(PBUS,mask,value)</span>
<span class="cp">#define PBUS_Val(mask,value)          DEVICE_VALUE(PBUS,mask,value)</span>
<span class="cp">#define PBUS_Mask(mask)               DEVICE_MASK(PBUS,mask)</span>


<span class="cp">#define PRAMDAC_Write(reg,value)         DEVICE_WRITE(PRAMDAC,reg,value)</span>
<span class="cp">#define PRAMDAC_Read(reg)                DEVICE_READ(PRAMDAC,reg)</span>
<span class="cp">#define PRAMDAC_Print(reg)               DEVICE_PRINT(PRAMDAC,reg)</span>
<span class="cp">#define PRAMDAC_Def(mask,value)          DEVICE_DEF(PRAMDAC,mask,value)</span>
<span class="cp">#define PRAMDAC_Val(mask,value)          DEVICE_VALUE(PRAMDAC,mask,value)</span>
<span class="cp">#define PRAMDAC_Mask(mask)               DEVICE_MASK(PRAMDAC,mask)</span>


<span class="cp">#define PDAC_ReadExt(reg) \</span>
<span class="cp">  ((PDAC_Write(INDEX_LO,(NV_PDAC_EXT_##reg) &amp; 0xff)),\</span>
<span class="cp">  (PDAC_Write(INDEX_HI,((NV_PDAC_EXT_##reg) &gt;&gt; 8) &amp; 0xff)),\</span>
<span class="cp">  (PDAC_Read(INDEX_DATA)))</span>

<span class="cp">#define PDAC_WriteExt(reg,value)\</span>
<span class="cp">  ((PDAC_Write(INDEX_LO,(NV_PDAC_EXT_##reg) &amp; 0xff)),\</span>
<span class="cp">  (PDAC_Write(INDEX_HI,((NV_PDAC_EXT_##reg) &gt;&gt; 8) &amp; 0xff)),\</span>
<span class="cp">  (PDAC_Write(INDEX_DATA,(value))))</span>

<span class="cp">#define CRTC_Write(index,value) outb((index), 0x3d4); outb(value, 0x3d5)</span>
<span class="cp">#define CRTC_Read(index) (outb(index, 0x3d4),inb(0x3d5))</span>

<span class="cp">#define PCRTC_Write(index,value) CRTC_Write(NV_PCRTC_##index,value)</span>
<span class="cp">#define PCRTC_Read(index) CRTC_Read(NV_PCRTC_##index)</span>

<span class="cp">#define PCRTC_Def(mask,value)          DEVICE_DEF(PCRTC,mask,value)</span>
<span class="cp">#define PCRTC_Val(mask,value)          DEVICE_VALUE(PCRTC,mask,value)</span>
<span class="cp">#define PCRTC_Mask(mask)               DEVICE_MASK(PCRTC,mask)</span>

<span class="cp">#define SR_Write(index,value) outb(0x3c4,(index));outb(0x3c5,value)</span>
<span class="cp">#define SR_Read(index) (outb(0x3c4,index),inb(0x3c5))</span>

<span class="k">extern</span> <span class="k">volatile</span> <span class="kt">unsigned</span>  <span class="o">*</span><span class="n">nvCONTROL</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span><span class="n">NV1</span><span class="p">,</span><span class="n">NV3</span><span class="p">,</span><span class="n">NV4</span><span class="p">,</span><span class="n">NumNVChips</span><span class="p">}</span> <span class="n">NVChipType</span><span class="p">;</span>

<span class="n">NVChipType</span> <span class="n">GetChipType</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
