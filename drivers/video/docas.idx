f | vt8500lcdfb.c | s | 11K | 391 | Axel Lin | axel.lin@gmail.com | 1322950122 |  | video: convert drivers/video/* to use module_platform_driver()  This patch converts the drivers in drivers/video/* to use the module_platform_driver() macro which makes the code smaller and a bit simpler.  Cc: Ben Dooks <ben@simtec.co.uk> Cc: Manuel Lauss <mano@roarinelk.homelinux.net> Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: Wan ZongShun <mcuos.com@gmail.com> Acked-by: Sascha Hauer <s.hauer@pengutronix.de> Acked-by: Lennert Buytenhek <buytenh@wantstofly.org> Acked-by: Alexey Charkov <alchark@gmail.com> Acked-by: Damian Hobson-Garcia <dhobsong@igel.co.jp> Acked-by: Jingoo Han <jg1.han@samsung.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | sm501fb.c | s | 53K | 1758 | Axel Lin | axel.lin@gmail.com | 1322950122 |  | video: convert drivers/video/* to use module_platform_driver()  This patch converts the drivers in drivers/video/* to use the module_platform_driver() macro which makes the code smaller and a bit simpler.  Cc: Ben Dooks <ben@simtec.co.uk> Cc: Manuel Lauss <mano@roarinelk.homelinux.net> Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: Wan ZongShun <mcuos.com@gmail.com> Acked-by: Sascha Hauer <s.hauer@pengutronix.de> Acked-by: Lennert Buytenhek <buytenh@wantstofly.org> Acked-by: Alexey Charkov <alchark@gmail.com> Acked-by: Damian Hobson-Garcia <dhobsong@igel.co.jp> Acked-by: Jingoo Han <jg1.han@samsung.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | fb_sys_fops.c | s | 2.0K | 78 | Krzysztof Helt | krzysztof.h1@wp.pl | 1192552997 |  | fbdev: change asm/uaccess.h to linux/uaccess.h  This patch replaces <asm/uaccess.h> with <linux/uaccess.h> after the checkpatch.pl hint.  The include of <asm/uaccess.h> is removed if the driver does not use it.  Signed-off-by: Krzysztof Helt <krzysztof.h1@wp.pl> Signed-off-by: Antonino Daplas <adaplas@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | auo_k190x.h | s | 3.9K | 108 | Heiko Stübner | heiko@sntech.de | 1335728135 |  | video: auo_k190x: add code shared by controller drivers  The AUO-K190X controllers share a very similar set of commands and can therefore also share most of the driver code.  Signed-off-by: Heiko Stübner <heiko@sntech.de> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
d | console |  | 29 items |  | Linus Torvalds | torvalds@linux-foundation.org | 1339891145 |  | 
f | uvesafb.c | s | 50K | 1767 | Eric W. Biederman | ebiederm@xmission.com | 1336706499 |  | connector/userns: replace netlink uses of cap_raised() with capable()  In 2009 Philip Reiser notied that a few users of netlink connector interface needed a capability check and added the idiom cap_raised(nsp->eff_cap, CAP_SYS_ADMIN) to a few of them, on the premise that netlink was asynchronous.  In 2011 Patrick McHardy noticed we were being silly because netlink is synchronous and removed eff_cap from the netlink_skb_params and changed the idiom to cap_raised(current_cap(), CAP_SYS_ADMIN).  Looking at those spots with a fresh eye we should be calling capable(CAP_SYS_ADMIN).  The only reason I can see for not calling capable is that it once appeared we were not in the same task as the caller which would have made calling capable() impossible.  In the initial user_namespace the only difference between between cap_raised(current_cap(), CAP_SYS_ADMIN) and capable(CAP_SYS_ADMIN) are a few sanity checks and the fact that capable(CAP_SYS_ADMIN) sets PF_SUPERPRIV if we use the capability.  Since we are going to be using root privilege setting PF_SUPERPRIV seems the right thing to do.  The motivation for this that patch is that in a child user namespace cap_raised(current_cap(),...) tests your capabilities with respect to that child user namespace not capabilities in the initial user namespace and thus will allow processes that should be unprivielged to use the kernel services that are only protected with cap_raised(current_cap(),..).  To fix possible user_namespace issues and to just clean up the code replace cap_raised(current_cap(), CAP_SYS_ADMIN) with capable(CAP_SYS_ADMIN).  Signed-off-by: Eric W. Biederman <ebiederm@xmission.com> Cc: Patrick McHardy <kaber@trash.net> Cc: Philipp Reisner <philipp.reisner@linbit.com> Acked-by: Serge E. Hallyn <serge.hallyn@canonical.com> Acked-by: Andrew G. Morgan <morgan@kernel.org> Cc: Vasiliy Kulikov <segoon@openwall.com> Cc: David Howells <dhowells@redhat.com> Reviewed-by: James Morris <james.l.morris@oracle.com> Cc: David Miller <davem@davemloft.net> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | mx3fb.c | s | 40K | 1322 | Alexandre Bounine | alexandre.bounine@idt.com | 1332337822 |  | dmaengine/dma_slave: introduce inline wrappers  Add inline wrappers for device_prep_slave_sg() and device_prep_dma_cyclic() interfaces to hide new parameter from current users of affected interfaces. Convert current users to use new wrappers instead of direct calls. Suggested by Russell King [https://lkml.org/lkml/2012/2/3/269].  Signed-off-by: Alexandre Bounine <alexandre.bounine@idt.com> Signed-off-by: Vinod Koul <vinod.koul@linux.intel.com>
f | wmt_ge_rops.c | s | 5.1K | 148 | Axel Lin | axel.lin@gmail.com | 1322950122 |  | video: convert drivers/video/* to use module_platform_driver()  This patch converts the drivers in drivers/video/* to use the module_platform_driver() macro which makes the code smaller and a bit simpler.  Cc: Ben Dooks <ben@simtec.co.uk> Cc: Manuel Lauss <mano@roarinelk.homelinux.net> Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: Wan ZongShun <mcuos.com@gmail.com> Acked-by: Sascha Hauer <s.hauer@pengutronix.de> Acked-by: Lennert Buytenhek <buytenh@wantstofly.org> Acked-by: Alexey Charkov <alchark@gmail.com> Acked-by: Damian Hobson-Garcia <dhobsong@igel.co.jp> Acked-by: Jingoo Han <jg1.han@samsung.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | Makefile | g | 7.2K |  | Heiko Stübner | heiko@sntech.de | 1335728142 |  | video: auo_k190x: add driver for AUO-K1901 variant  This controller not only supports higher resolutions than the K1900 but concurrent updates as well. This results in a generally higher display speed.  Signed-off-by: Heiko Stübner <heiko@sntech.de> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | grvga.c | s | 14K | 489 | Sam Ravnborg | sam@ravnborg.org | 1325606575 |  | grvga: fix section mismatch warnings  Fix following section mismatch warnings:  WARNING: drivers/video/built-in.o(.devinit.text+0x110): Section mismatch in reference from the function grvga_probe() to the function .init.text:grvga_parse_custom() The function __devinit grvga_probe() references a function __init grvga_parse_custom(). If grvga_parse_custom is only used by grvga_probe then annotate grvga_parse_custom with a matching annotation.  WARNING: drivers/video/built-in.o(.devinit.text+0x1f8): Section mismatch in reference from the function grvga_probe() to the variable .init.data:grvga_fix The function __devinit grvga_probe() references a variable __initdata grvga_fix. If grvga_fix is only used by grvga_probe then annotate grvga_fix with a matching annotation.  WARNING: drivers/video/built-in.o(.devinit.text+0x204): Section mismatch in reference from the function grvga_probe() to the variable .init.data:grvga_fix The function __devinit grvga_probe() references a variable __initdata grvga_fix. If grvga_fix is only used by grvga_probe then annotate grvga_fix with a matching annotation.  grvga_fix is used in a function annotated __devinit - so match this using a __devinitdata annotation on grvga_fix.  grvga_parse_custom() is used in a function annotated __devinit - so match this by annotating grvga_parse_custom() with __devinit too.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Cc: Kristoffer Glembo <kristoffer@gaisler.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | modedb.c | s | 32K | 1002 | Timur Tabi | timur@freescale.com | 1316018452 |  | fbdev: fix indentation in modedb.c  Fix the incorrect indentation in functions fb_try_mode() and fb_find_mode().  Signed-off-by: Timur Tabi <timur@freescale.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | tgafb.c | s | 46K | 1522 | Uwe Kleine-König | u.kleine-koenig@pengutronix.de | 1276704305 |  | fix typos concerning "initiali[zs]e"  Signed-off-by: Uwe Kleine-König <u.kleine-koenig@pengutronix.de> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
d | pnx4008 |  | 6 items |  | Axel Lin | axel.lin@gmail.com | 1324326103 |  | video: pnx4008: convert drivers/video/pnx4008/* to use module_platform_driver()  This patch converts the drivers in drivers/video/pnx4008/* to use the module_platform_driver() macro which makes the code smaller and a bit simpler.  Cc: Grigory Tolstolytkin <gtolstolytkin@ru.mvista.com> Signed-off-by: Axel Lin <axel.lin@gmail.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | maxinefb.c | s | 4.6K | 145 | Tejun Heo | tj@kernel.org | 1269954152 |  | include cleanup: Update gfp.h and slab.h includes to prepare for breaking implicit slab.h inclusion from percpu.h  percpu.h is included by sched.h and module.h and thus ends up being included when building most .c files.  percpu.h includes slab.h which in turn includes gfp.h making everything defined by the two files universally available and complicating inclusion dependencies.  percpu.h -> slab.h dependency is about to be removed.  Prepare for this change by updating users of gfp and slab facilities include those headers directly instead of assuming availability.  As this conversion needs to touch large number of source files, the following script is used as the basis of conversion.    http://userweb.kernel.org/~tj/misc/slabh-sweep.py  The script does the followings.  * Scan files for gfp and slab usages and update includes such that   only the necessary includes are there.  ie. if only gfp is used,   gfp.h, if slab is used, slab.h.  * When the script inserts a new include, it looks at the include   blocks and try to put the new include such that its order conforms   to its surrounding.  It's put in the include block which contains   core kernel includes, in the same order that the rest are ordered -   alphabetical, Christmas tree, rev-Xmas-tree or at the end if there   doesn't seem to be any matching order.  * If the script can't find a place to put a new include (mostly   because the file doesn't have fitting include block), it prints out   an error message indicating which .h file needs to be added to the   file.  The conversion was done in the following steps.  1. The initial automatic conversion of all .c files updated slightly    over 4000 files, deleting around 700 includes and adding ~480 gfp.h    and ~3000 slab.h inclusions.  The script emitted errors for ~400    files.  2. Each error was manually checked.  Some didn't need the inclusion,    some needed manual addition while adding it to implementation .h or    embedding .c file was more appropriate for others.  This step added    inclusions to around 150 files.  3. The script was run again and the output was compared to the edits    from #2 to make sure no file was left behind.  4. Several build tests were done and a couple of problems were fixed.    e.g. lib/decompress_*.c used malloc/free() wrappers around slab    APIs requiring slab.h to be added manually.  5. The script was run on all .h files but without automatically    editing them as sprinkling gfp.h and slab.h inclusions around .h    files could easily lead to inclusion dependency hell.  Most gfp.h    inclusion directives were ignored as stuff from gfp.h was usually    wildly available and often used in preprocessor macros.  Each    slab.h inclusion directive was examined and added manually as    necessary.  6. percpu.h was updated not to include slab.h.  7. Build test were done on the following configurations and failures    were fixed.  CONFIG_GCOV_KERNEL was turned off for all tests (as my    distributed build env didn't work with gcov compiles) and a few    more options had to be turned off depending on archs to make things    build (like ipr on powerpc/64 which failed due to missing writeq).     * x86 and x86_64 UP and SMP allmodconfig and a custom test config.    * powerpc and powerpc64 SMP allmodconfig    * sparc and sparc64 SMP allmodconfig    * ia64 SMP allmodconfig    * s390 SMP allmodconfig    * alpha SMP allmodconfig    * um on x86_64 SMP allmodconfig  8. percpu.h modifications were reverted so that it could be applied as    a separate patch and serve as bisection point.  Given the fact that I had only a couple of failures from tests on step 6, I'm fairly confident about the coverage of this conversion patch. If there is a breakage, it's likely to be something in one of the arch headers which should be easily discoverable easily on most builds of the specific arch.  Signed-off-by: Tejun Heo <tj@kernel.org> Guess-its-ok-by: Christoph Lameter <cl@linux-foundation.org> Cc: Ingo Molnar <mingo@redhat.com> Cc: Lee Schermerhorn <Lee.Schermerhorn@hp.com>
f | gxt4500.c | s | 20K | 680 | Laurent Pinchart | laurent.pinchart@ideasonboard.com | 1313742677 |  | gxt4500: use display information in info not in var for panning  We must not use any information in the passed var besides xoffset, yoffset and vmode as otherwise applications might abuse it.  Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
f | acornfb.h | s | 4.7K | 175 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
d | aty |  | 16 items |  | Rusty Russell | rusty@rustcorp.com.au | 1326409340 |  | module_param: make bool parameters really bool (drivers & misc)  module_param(bool) used to counter-intuitively take an int.  In fddd5201 (mid-2009) we allowed bool or int/unsigned int using a messy trick.  It's time to remove the int/unsigned int option.  For this version it'll simply give a warning, but it'll break next kernel version.  Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | pmag-ba-fb.c | s | 6.5K | 244 | David Howells | dhowells@redhat.com | 1332955803 |  | Remove all #inclusions of asm/system.h  Remove all #inclusions of asm/system.h preparatory to splitting and killing it.  Performed with the following command:  perl -p -i -e 's!^#\s*include\s*<asm/system[.]h>.*\n!!' `grep -Irl '^#\s*include\s*<asm/system[.]h>' *`  Signed-off-by: David Howells <dhowells@redhat.com>
f | sysfillrect.c | s | 7.5K | 298 | Michal Januszewski | spock@gentoo.org | 1241652970 |  | fbdev: fix fillrect for 24bpp modes  The software fillrect routines do not work properly when the number of pixels per machine word is not an integer.  To see that, run the following command on a fbdev console with a 24bpp video mode, using a non-accelerated driver such as (u)vesafb:    reset ; echo -e '\e[41mtest\e[K'  The expected result is 'test' displayed on a line with red background. Instead of that, 'test' has a red background, but the rest of the line (rendered using fillrect()) contains a distored colorful pattern.  This patch fixes the problem by correctly computing rotation shifts.  It has been tested in a 24bpp mode on 32- and 64-bit little-endian machines.  Signed-off-by: Michal Januszewski <spock@gentoo.org> Acked-by: Krzysztof Helt <krzysztof.h1@wp.pl> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | au1200fb.h | s | 18K | 516 | Ralf Baechle | ralf@linux-mips.org | 1143477895 |  | [PATCH] au1200fb: Alchemy Au1200 framebuffer driver  Add support for Alchemy Au1200 framebuffer driver  Signed-off-by: Ralf Baechle <ralf@linux-mips.org> Signed-off-by: Antonino Daplas <adaplas@pol.net> Signed-off-by: Andrew Morton <akpm@osdl.org> Signed-off-by: Linus Torvalds <torvalds@osdl.org>
f | smscufx.c | s | 53K | 1526 | H Hartley Sweeten | hartleys@visionengravers.com | 1336496215 |  | video: smscufx.c: local functions should not be exposed globally  Functions not referenced outside of a source file should be marked static to prevent them from being exposed globally.  Quiets the sparse warnings:  warning: symbol 'ufx_handle_damage' was not declared. Should it be static?  Signed-off-by: H Hartley Sweeten <hsweeten@visionengravers.com> Cc: Steve Glendinning <steve.glendinning@smsc.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | sh_mipi_dsi.c | s | 15K | 523 | Kuninori Morimoto | kuninori.morimoto.gx@renesas.com | 1332314641 |  | fbdev: sh_mipi_dsi: add extra phyctrl for sh_mipi_dsi_info  sh_mipi uses some clocks, but the method of setup depends on CPU.  Current SuperH (like sh73a0) can control all of these clocks by CPG (Clock Pulse Generator). It means we can control it by clock framework only. But on sh7372, it needs CPG settings AND sh_mipi PHYCTRL::PLLDS, and only sh7372 has PHYCTRL::PLLDS.  But on current sh_mipi driver, PHYCTRL::PLLDS of sh7372 was overwrote since the callback timing of clock setting was changed by c2658b70f06108361aa5024798f9c1bf47c73374 (fbdev: sh_mipi_dsi: fixup setup timing of sh_mipi_setup()). To solve this issue, this patch adds extra .phyctrl.  This patch adds detail explanation for unclear mipi settings and fixup wrong PHYCTRL::PLLDS value for ap4evb (0xb -> 0x6).  Signed-off-by: Kuninori Morimoto <kuninori.morimoto.gx@renesas.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | s1d13xxxfb.c | s | 28K | 859 | Andres Salomon | dilinger@queued.net | 1292861143 |  | s1d13xxxfb: drop unused code  Silence warnings such as -  drivers/video/s1d13xxxfb.c:421: warning: ‘bltbit_wait_bitset’ defined but not used  Just drop the unused code.  Signed-off-by: Andres Salomon <dilinger@queued.net> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | platinumfb.h | s | 10K | 339 | Benjamin Herrenschmidt | benh@kernel.crashing.org | 1136778831 |  | [PATCH] powerpc: Fix platinumfb for some modes  The platinumfb driver used only on some powermacs has an issue with some video modes & limited VRAM. This patch fixes it.  Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org> Signed-off-by: Paul Mackerras <paulus@samba.org>
d | omap |  | 18 items |  | Peter Meerwald | p.meerwald@bct-electronic.com | 1335167289 |  | OMAPFB: remove unused FB_OMAP_BOOTLOADER_INIT config option  code depending on FB_OMAP_BOOTLOADER_INIT has been removed long before (e.g. Tomi Valkeinen, 03 Mar 2011: OMAP: DSS2: Remove FB_OMAP_BOOTLOADER_INIT support), but the option still exists Kconfig and has no use  Signed-off-by: Peter Meerwald <p.meerwald@bct-electronic.com> Signed-off-by: Tomi Valkeinen <tomi.valkeinen@ti.com>
f | fbsysfs.c | s | 14K | 482 | Dan Carpenter | dan.carpenter@oracle.com | 1338296403 |  | fb: handle NULL pointers in framebuffer release  This function is called with a potential NULL pointer in picolcd_init_framebuffer() and it causes a static checker warning.  This used to handle NULL pointers when the picolcd code was written, but a couple months later we added the "info->apertures" dereference.  Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com> Reviewed-by: Marcin Slusarz <marcin.slusarz@gmail.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | n411.c | s | 4.8K | 169 | Jaya Kumar | jayakumar.lkml@gmail.com | 1209398321 |  | fbdev: platforming hecubafb and n411  This patch splits hecubafb into the platform independent hecubafb and the platform dependent n411.  Signed-off-by: Jaya Kumar <jayakumar.lkml@gmail.com> Cc: "Antonino A. Daplas" <adaplas@pol.net> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | controlfb.h | s | 4.6K | 134 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | arkfb.c | s | 32K | 972 | Laurent Pinchart | laurent.pinchart@ideasonboard.com | 1313742584 |  | arkfb: use display information in info not in var for panning  We must not use any information in the passed var besides xoffset, yoffset and vmode as otherwise applications might abuse it.  Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
f | cg14.c | s | 14K | 533 | axel lin | axel.lin@gmail.com | 1300779344 |  | video: add missing framebuffer_release in error path  This patch fixes a memory leak in the error path.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: David S. Miller <davem@davemloft.net> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | pmagb-b-fb.c | s | 10K | 347 | David Howells | dhowells@redhat.com | 1332955803 |  | Remove all #inclusions of asm/system.h  Remove all #inclusions of asm/system.h preparatory to splitting and killing it.  Performed with the following command:  perl -p -i -e 's!^#\s*include\s*<asm/system[.]h>.*\n!!' `grep -Irl '^#\s*include\s*<asm/system[.]h>' *`  Signed-off-by: David Howells <dhowells@redhat.com>
f | bt455.h | s | 2.0K | 86 | David Howells | dhowells@redhat.com | 1332955803 |  | Remove all #inclusions of asm/system.h  Remove all #inclusions of asm/system.h preparatory to splitting and killing it.  Performed with the following command:  perl -p -i -e 's!^#\s*include\s*<asm/system[.]h>.*\n!!' `grep -Irl '^#\s*include\s*<asm/system[.]h>' *`  Signed-off-by: David Howells <dhowells@redhat.com>
f | fsl-diu-fb.c | s | 44K | 1588 | Timur Tabi | timur@freescale.com | 1336914536 |  | drivers/video: fsl-diu-fb: don't initialize the THRESHOLDS registers  The THRESHOLDS register configures thresholds for two interrupts, but these interrupts are not used in the DIU driver.  An early version of the driver may have used the "lines before vsync" interrupt, which requires the LS_BF_VS of THRESHOLDS to be initialized.  Unfortunately, the initialization of this register does not do a read-modify-write to set only LS_BF_VS.  On the MPC8610, the value written is correct.  On other chips, like the P1022, the value overwrites some reserved bits.  This results in a performance drop on the P1022.  Since the default value is acceptable as-is on all SOCs, we should just avoid touching this register.  Signed-off-by: Timur Tabi <timur@freescale.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | xen-fbfront.c | s | 17K | 595 | Julia Lawall | Julia.Lawall@lip6.fr | 1336387316 |  | drivers/video/xen-fbfront.c: add missing cleanup code  The operations in the subsequent error-handling code appear to be also useful here.  Acked-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de> Signed-off-by: Julia Lawall <Julia.Lawall@lip6.fr> [v1: Collapse some of the error handling functions] [v2: Fix compile warning] Signed-off-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>
f | arcfb.c | s | 16K | 569 | Joe Perches | joe@perches.com | 1307003135 |  | video: Convert vmalloc/memset to vzalloc  Signed-off-by: Joe Perches <joe@perches.com> Acked-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | cfbcopyarea.c | s | 11K | 392 | Tejun Heo | tj@kernel.org | 1269954152 |  | include cleanup: Update gfp.h and slab.h includes to prepare for breaking implicit slab.h inclusion from percpu.h  percpu.h is included by sched.h and module.h and thus ends up being included when building most .c files.  percpu.h includes slab.h which in turn includes gfp.h making everything defined by the two files universally available and complicating inclusion dependencies.  percpu.h -> slab.h dependency is about to be removed.  Prepare for this change by updating users of gfp and slab facilities include those headers directly instead of assuming availability.  As this conversion needs to touch large number of source files, the following script is used as the basis of conversion.    http://userweb.kernel.org/~tj/misc/slabh-sweep.py  The script does the followings.  * Scan files for gfp and slab usages and update includes such that   only the necessary includes are there.  ie. if only gfp is used,   gfp.h, if slab is used, slab.h.  * When the script inserts a new include, it looks at the include   blocks and try to put the new include such that its order conforms   to its surrounding.  It's put in the include block which contains   core kernel includes, in the same order that the rest are ordered -   alphabetical, Christmas tree, rev-Xmas-tree or at the end if there   doesn't seem to be any matching order.  * If the script can't find a place to put a new include (mostly   because the file doesn't have fitting include block), it prints out   an error message indicating which .h file needs to be added to the   file.  The conversion was done in the following steps.  1. The initial automatic conversion of all .c files updated slightly    over 4000 files, deleting around 700 includes and adding ~480 gfp.h    and ~3000 slab.h inclusions.  The script emitted errors for ~400    files.  2. Each error was manually checked.  Some didn't need the inclusion,    some needed manual addition while adding it to implementation .h or    embedding .c file was more appropriate for others.  This step added    inclusions to around 150 files.  3. The script was run again and the output was compared to the edits    from #2 to make sure no file was left behind.  4. Several build tests were done and a couple of problems were fixed.    e.g. lib/decompress_*.c used malloc/free() wrappers around slab    APIs requiring slab.h to be added manually.  5. The script was run on all .h files but without automatically    editing them as sprinkling gfp.h and slab.h inclusions around .h    files could easily lead to inclusion dependency hell.  Most gfp.h    inclusion directives were ignored as stuff from gfp.h was usually    wildly available and often used in preprocessor macros.  Each    slab.h inclusion directive was examined and added manually as    necessary.  6. percpu.h was updated not to include slab.h.  7. Build test were done on the following configurations and failures    were fixed.  CONFIG_GCOV_KERNEL was turned off for all tests (as my    distributed build env didn't work with gcov compiles) and a few    more options had to be turned off depending on archs to make things    build (like ipr on powerpc/64 which failed due to missing writeq).     * x86 and x86_64 UP and SMP allmodconfig and a custom test config.    * powerpc and powerpc64 SMP allmodconfig    * sparc and sparc64 SMP allmodconfig    * ia64 SMP allmodconfig    * s390 SMP allmodconfig    * alpha SMP allmodconfig    * um on x86_64 SMP allmodconfig  8. percpu.h modifications were reverted so that it could be applied as    a separate patch and serve as bisection point.  Given the fact that I had only a couple of failures from tests on step 6, I'm fairly confident about the coverage of this conversion patch. If there is a breakage, it's likely to be something in one of the arch headers which should be easily discoverable easily on most builds of the specific arch.  Signed-off-by: Tejun Heo <tj@kernel.org> Guess-its-ok-by: Christoph Lameter <cl@linux-foundation.org> Cc: Ingo Molnar <mingo@redhat.com> Cc: Lee Schermerhorn <Lee.Schermerhorn@hp.com>
f | s3c2410fb.c | s | 27K | 933 | Jingoo Han | jg1.han@samsung.com | 1322950243 |  | video: s3c2410: fix checkpatch error and warnings  This patch fixes the checkpatch errors listed below:  ERROR: do not initialise statics to 0 or NULL WARNING: Use #include <linux/io.h> instead of <asm/io.h> WARNING: braces {} are not necessary for single statement blocks WARNING: braces {} are not necessary for any arm of this statement WARNING: static char array declaration should probably be static const char WARNING: line over 80 characters WARNING: msleep < 20ms can sleep for up to 20ms; see Documentation/timers/timers-howto.txt  Signed-off-by: Jingoo Han <jg1.han@samsung.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
d | i810 |  | 9 items |  | Rusty Russell | rusty@rustcorp.com.au | 1326410939 |  | module_param: make bool parameters really bool (drivers/video/i810)  module_param(bool) used to counter-intuitively take an int.  In fddd5201 (mid-2009) we allowed bool or int/unsigned int using a messy trick.  It's time to remove the int/unsigned int option.  For this version it'll simply give a warning, but it'll break next kernel version.  Signed-off-by: Rusty Russell <rusty@rustcorp.com.au> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | imxfb.c | s | 23K | 803 | Sascha Hauer | s.hauer@pengutronix.de | 1335366217 |  | video imxfb: do not depend on grouped clocks  the current i.MX clock support groups together unrelated clocks to a single clock which is then used by the driver. This can't be accomplished with the generic clock framework so we instead request the individual clocks in the driver. For i.MX there are generally three different clocks:  ipg: bus clock (needed to access registers) ahb: dma relevant clock, sometimes referred to as hclk in the datasheet per: bit clock, pixel clock  This patch changes the driver to request the individual clocks. Currently all clk_get will get the same clock until the SoCs are converted to the generic clock framework  Signed-off-by: Sascha Hauer <s.hauer@pengutronix.de>
f | c2p_planar.c | s | 3.6K | 134 | Geert Uytterhoeven | geert@linux-m68k.org | 1231790192 |  | fbdev: c2p - Rename c2p to c2p_planar  Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
d | mbx |  | 5 items |  | Arnd Bergmann | arnd@arndb.de | 1339246271 |  | drivers/video: use correct __devexit_p annotation  __devexit functions are discarded when CONFIG_HOTPLUG is not set, so the symbol needs to be referenced carefully.  Signed-off-by: Arnd Bergmann <arnd@arndb.de> Signed-off-by: Mathieu Poirier <mathieu.poirier@linaro.org> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | sh_mobile_hdmi.c | s | 51K | 1263 | Kuninori Morimoto | kuninori.morimoto.gx@renesas.com | 1336914479 |  | fbdev: sh_mobile_hdmi: add HDMI Control Register support  Latest SuperH HDMI uses not only HDMI Core Register (HTOP0) but also HDMI Control Register (HTOP1). This patch adds HDMI Control Register support.  Signed-off-by: Kuninori Morimoto <kuninori.morimoto.gx@renesas.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | neofb.c | s | 55K | 1945 | David Howells | dhowells@redhat.com | 1332955803 |  | Remove all #inclusions of asm/system.h  Remove all #inclusions of asm/system.h preparatory to splitting and killing it.  Performed with the following command:  perl -p -i -e 's!^#\s*include\s*<asm/system[.]h>.*\n!!' `grep -Irl '^#\s*include\s*<asm/system[.]h>' *`  Signed-off-by: David Howells <dhowells@redhat.com>
f | ps3fb.c | s | 33K | 1112 | Yong Zhang | yong.zhang0@gmail.com | 1317657142 |  | video: irq: Remove IRQF_DISABLED  Since commit [e58aa3d2: genirq: Run irq handlers with interrupts disabled], We run all interrupt handlers with interrupts disabled and we even check and yell when an interrupt handler returns with interrupts enabled (see commit [b738a50a: genirq: Warn when handler enables interrupts]).  So now this flag is a NOOP and can be removed.  Signed-off-by: Yong Zhang <yong.zhang0@gmail.com> Acked-by: David Brown <davidb@codeaurora.org> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
d | omap2 |  | 7 items |  | Linus Torvalds | torvalds@linux-foundation.org | 1339599450 |  | 
f | sstfb.c | s | 43K | 1327 | Rusty Russell | rusty@rustcorp.com.au | 1326409340 |  | module_param: make bool parameters really bool (drivers & misc)  module_param(bool) used to counter-intuitively take an int.  In fddd5201 (mid-2009) we allowed bool or int/unsigned int using a messy trick.  It's time to remove the int/unsigned int option.  For this version it'll simply give a warning, but it'll break next kernel version.  Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | valkyriefb.c | s | 16K | 512 | Joe Perches | joe@perches.com | 1308903279 |  | video: Fix speficied typo  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | macmodes.h | s | 2.5K | 61 | Adrian Bunk | bunk@stusta.de | 1184692993 |  | drivers/video/macmodes.c:mac_find_mode() mustn't be __devinit  If it's EXPORT_SYMBOL'ed it can't be __devinit.  Reported by Mikael Pettersson.  Signed-off-by: Adrian Bunk <bunk@stusta.de> Cc: "Antonino A. Daplas" <adaplas@pol.net> Cc: Michal Piotrowski <michal.k.k.piotrowski@gmail.com> Cc: <stable@kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | bfin-lq035q1-fb.c | s | 20K | 695 | Paul Gortmaker | paul.gortmaker@windriver.com | 1335466011 |  | blackfin: fix compile error in bfin-lq035q1-fb.c  This file has an implicit dependency on GPIO stuff, showing up as the following build failure:  drivers/video/bfin-lq035q1-fb.c:369:6: error: 'GPIOF_OUT_INIT_LOW' undeclared  Other more global bfin build issues prevent an automated bisect, but it really doesn't matter - simply add in the appropriate header.  Cc: Florian Tobias Schandinat <FlorianSchandinat@gmx.de> Acked-by: Mike Frysinger <vapier@gentoo.org> Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | leo.c | s | 15K | 585 | Grant Likely | grant.likely@secretlab.ca | 1298924565 |  | dt/video: Eliminate users of of_platform_{,un}register_driver  Get rid of users of of_platform_driver in drivers/video.  The of_platform_{,un}register_driver functions are going away, so the users need to be converted to using the platform_bus_type directly.  Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | metronomefb.c | s | 18K | 660 | Joe Perches | joe@perches.com | 1307003135 |  | video: Convert vmalloc/memset to vzalloc  Signed-off-by: Joe Perches <joe@perches.com> Acked-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | pxa168fb.h | s | 20K | 509 | Lennert Buytenhek | buytenh@marvell.com | 1244822949 |  | fb: add support of LCD display controller on pxa168/910 (base layer)  This driver is originally written by Lennert, modified by Green to be feature complete,  and ported by Jun Nie and Kevin Liu for pxa168/910 processors.  The patch adds support for the on-chip LCD display controller, it currently supports the base (graphics) layer only.  Signed-off-by: Lennert Buytenhek <buytenh@marvell.com> Signed-off-by: Green Wan <gwan@marvell.com> Cc: Peter Liao <pliao@marvell.com> Signed-off-by: Jun Nie <njun@marvell.com> Signed-off-by: Kevin Liu <kliu5@marvell.com> Acked-by: Krzysztof Helt <krzysztof.h1@wp.pl> Signed-off-by: Eric Miao <eric.y.miao@gmail.com>
f | amifb.c | s | 99K | 3293 | David Howells | dhowells@redhat.com | 1332955803 |  | Remove all #inclusions of asm/system.h  Remove all #inclusions of asm/system.h preparatory to splitting and killing it.  Performed with the following command:  perl -p -i -e 's!^#\s*include\s*<asm/system[.]h>.*\n!!' `grep -Irl '^#\s*include\s*<asm/system[.]h>' *`  Signed-off-by: David Howells <dhowells@redhat.com>
f | syscopyarea.c | s | 8.8K | 345 | Tejun Heo | tj@kernel.org | 1269954152 |  | include cleanup: Update gfp.h and slab.h includes to prepare for breaking implicit slab.h inclusion from percpu.h  percpu.h is included by sched.h and module.h and thus ends up being included when building most .c files.  percpu.h includes slab.h which in turn includes gfp.h making everything defined by the two files universally available and complicating inclusion dependencies.  percpu.h -> slab.h dependency is about to be removed.  Prepare for this change by updating users of gfp and slab facilities include those headers directly instead of assuming availability.  As this conversion needs to touch large number of source files, the following script is used as the basis of conversion.    http://userweb.kernel.org/~tj/misc/slabh-sweep.py  The script does the followings.  * Scan files for gfp and slab usages and update includes such that   only the necessary includes are there.  ie. if only gfp is used,   gfp.h, if slab is used, slab.h.  * When the script inserts a new include, it looks at the include   blocks and try to put the new include such that its order conforms   to its surrounding.  It's put in the include block which contains   core kernel includes, in the same order that the rest are ordered -   alphabetical, Christmas tree, rev-Xmas-tree or at the end if there   doesn't seem to be any matching order.  * If the script can't find a place to put a new include (mostly   because the file doesn't have fitting include block), it prints out   an error message indicating which .h file needs to be added to the   file.  The conversion was done in the following steps.  1. The initial automatic conversion of all .c files updated slightly    over 4000 files, deleting around 700 includes and adding ~480 gfp.h    and ~3000 slab.h inclusions.  The script emitted errors for ~400    files.  2. Each error was manually checked.  Some didn't need the inclusion,    some needed manual addition while adding it to implementation .h or    embedding .c file was more appropriate for others.  This step added    inclusions to around 150 files.  3. The script was run again and the output was compared to the edits    from #2 to make sure no file was left behind.  4. Several build tests were done and a couple of problems were fixed.    e.g. lib/decompress_*.c used malloc/free() wrappers around slab    APIs requiring slab.h to be added manually.  5. The script was run on all .h files but without automatically    editing them as sprinkling gfp.h and slab.h inclusions around .h    files could easily lead to inclusion dependency hell.  Most gfp.h    inclusion directives were ignored as stuff from gfp.h was usually    wildly available and often used in preprocessor macros.  Each    slab.h inclusion directive was examined and added manually as    necessary.  6. percpu.h was updated not to include slab.h.  7. Build test were done on the following configurations and failures    were fixed.  CONFIG_GCOV_KERNEL was turned off for all tests (as my    distributed build env didn't work with gcov compiles) and a few    more options had to be turned off depending on archs to make things    build (like ipr on powerpc/64 which failed due to missing writeq).     * x86 and x86_64 UP and SMP allmodconfig and a custom test config.    * powerpc and powerpc64 SMP allmodconfig    * sparc and sparc64 SMP allmodconfig    * ia64 SMP allmodconfig    * s390 SMP allmodconfig    * alpha SMP allmodconfig    * um on x86_64 SMP allmodconfig  8. percpu.h modifications were reverted so that it could be applied as    a separate patch and serve as bisection point.  Given the fact that I had only a couple of failures from tests on step 6, I'm fairly confident about the coverage of this conversion patch. If there is a breakage, it's likely to be something in one of the arch headers which should be easily discoverable easily on most builds of the specific arch.  Signed-off-by: Tejun Heo <tj@kernel.org> Guess-its-ok-by: Christoph Lameter <cl@linux-foundation.org> Cc: Ingo Molnar <mingo@redhat.com> Cc: Lee Schermerhorn <Lee.Schermerhorn@hp.com>
f | wmt_ge_rops.h | s | 226B | 5 | Alexey Charkov | alchark@gmail.com | 1289296327 |  | ARM: Add support for the display controllers in VT8500 and WM8505  This adds drivers for the LCD controller found in VIA VT8500 SoC, GOVR display controller found in WonderMedia WM8505 SoC and for the Graphics Engine present in both of them that provides hardware accelerated raster operations (used for copyarea and fillrect).  Signed-off-by: Alexey Charkov <alchark@gmail.com> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | w100fb.h | s | 23K | 826 | Alberto Mardegan | mardy@users.sourceforge.net | 1143836340 |  | [PATCH] w100fb: Add acceleration support to ATI Imageon  Add acceleration support in w100fb.c (i.e.  ATI Imageons) for the copyarea and fillrect operations.  Signed-off-by: Alberto Mardegan <mardy@users.sourceforge.net> Signed-off-by: Antonino Daplas <adaplas@pol.net> Signed-off-by: Andrew Morton <akpm@osdl.org> Signed-off-by: Linus Torvalds <torvalds@osdl.org>
d | via |  | 44 items |  | Peter Huewe | peterhuewe@gmx.de | 1336496412 |  | video/via: Convert to kstrtou8_from_user  This patch replaces the code for getting an number from a userspace buffer by a simple call to kstrou8_from_user. This makes it easier to read and less error prone.  Signed-off-by: Peter Huewe <peterhuewe@gmx.de> Acked-by: Alexey Dobriyan <adobriyan@gmail.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | bf537-lq035.c | s | 22K | 742 | Jingoo Han | jg1.han@samsung.com | 1327783811 |  | video: use gpio_request_one  Using gpio_request_one can make the code simpler because it can set the direction and initial value in one shot.  Signed-off-by: Jingoo Han <jg1.han@samsung.com> Acked-by: Tomi Valkeinen <tomi.valkeinen@ti.com> Cc: Michael Hennerich <michael.hennerich@analog.com> Cc: Pavel Machek <pavel@ucw.cz> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | cyber2000fb.h | s | 15K | 429 | Russell King | rmk+kernel@arm.linux.org.uk | 1297419367 |  | VIDEO: cyberpro: remove unused cyber2000fb_get_fb_var()  Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
f | igafb.c | s | 15K | 509 | Paul Bolle | pebolle@tiscali.nl | 1317139684 |  | doc: fix broken references  There are numerous broken references to Documentation files (in other Documentation files, in comments, etc.). These broken references are caused by typo's in the references, and by renames or removals of the Documentation files. Some broken references are simply odd.  Fix these broken references, sometimes by dropping the irrelevant text they were part of.  Signed-off-by: Paul Bolle <pebolle@tiscali.nl> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | wm8505fb.c | s | 10K | 326 | Axel Lin | axel.lin@gmail.com | 1322950122 |  | video: convert drivers/video/* to use module_platform_driver()  This patch converts the drivers in drivers/video/* to use the module_platform_driver() macro which makes the code smaller and a bit simpler.  Cc: Ben Dooks <ben@simtec.co.uk> Cc: Manuel Lauss <mano@roarinelk.homelinux.net> Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: Wan ZongShun <mcuos.com@gmail.com> Acked-by: Sascha Hauer <s.hauer@pengutronix.de> Acked-by: Lennert Buytenhek <buytenh@wantstofly.org> Acked-by: Alexey Charkov <alchark@gmail.com> Acked-by: Damian Hobson-Garcia <dhobsong@igel.co.jp> Acked-by: Jingoo Han <jg1.han@samsung.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | macmodes.c | s | 12K | 381 | Finn Thain | fthain@telegraphics.com.au | 1267291874 |  | fbdev: add some missing mac modes  Add the missing mac video modes for the Portrait and 12" RGB displays. The specs come from the Mac LC III developer note.  Signed-off-by: Finn Thain <fthain@telegraphics.com.au> Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
f | imsttfb.c | s | 43K | 1471 | Laurent Pinchart | laurent.pinchart@ideasonboard.com | 1313742699 |  | imsttfb: use display information in info not in var for panning  We must not use any information in the passed var besides xoffset, yoffset and vmode as otherwise applications might abuse it.  Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
f | carminefb_regs.h | s | 6.8K | 156 | Sebastian Siewior | bigeasy@linutronix.de | 1216921654 |  | fbdev: add the carmine FB driver  Basic FB driver for the carmine chip.  The driver registers two FB devices for the two possible screens.  The DRAM settings can be be switched via Kconfig (between eval board and custom).  Signed-off-by: Sebastian Siewior <bigeasy@linutronix.de> Cc: "Antonino A. Daplas" <adaplas@pol.net> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | bfin-t350mcqb-fb.c | s | 16K | 547 | Paul Bolle | pebolle@tiscali.nl | 1323161620 |  | treewide: Fix comment and string typo 'bufer'  Signed-off-by: Paul Bolle <pebolle@tiscali.nl> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | vt8623fb.c | s | 26K | 763 | Laurent Pinchart | laurent.pinchart@ideasonboard.com | 1313742980 |  | vt8623fb: use display information in info not in var for panning  We must not use any information in the passed var besides xoffset, yoffset and vmode as otherwise applications might abuse it.  Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
f | fb-puv3.c | s | 21K | 746 | Laurent Pinchart | laurent.pinchart@ideasonboard.com | 1313742661 |  | fbdev: unicore32: use display information in info not in var for panning  We must not use any information in the passed var besides xoffset, yoffset and vmode as otherwise applications might abuse it.  Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com> Tested-by: Guan Xuetao <gxt@mprc.pku.edu.cn> Acked-by: Guan Xuetao <gxt@mprc.pku.edu.cn>
f | carminefb.h | s | 2.2K | 55 | Sebastian Siewior | bigeasy@linutronix.de | 1216921654 |  | fbdev: add the carmine FB driver  Basic FB driver for the carmine chip.  The driver registers two FB devices for the two possible screens.  The DRAM settings can be be switched via Kconfig (between eval board and custom).  Signed-off-by: Sebastian Siewior <bigeasy@linutronix.de> Cc: "Antonino A. Daplas" <adaplas@pol.net> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | efifb.c | s | 18K | 520 | Matthew Garrett | mjg@redhat.com | 1335257421 |  | vga: fix build when fbdev is a module  This fixes the build breakage reported by Stephen in -next when merging the drm-next tree.  Signed-off-by: Dave Airlie <airlied@redhat.com>
f | au1100fb.c | s | 18K | 564 | Linus Torvalds | torvalds@linux-foundation.org | 1337739770 |  | Merge branch 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/jikos/trivial  Pull trivial updates from Jiri Kosina:  "As usual, it's mostly typo fixes, redundant code elimination and some   documentation updates."  * 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/jikos/trivial: (57 commits)   edac, mips: don't change code that has been removed in edac/mips tree   xtensa: Change mail addresses of Hannes Weiner and Oskar Schirmer   lib: Change mail address of Oskar Schirmer   net: Change mail address of Oskar Schirmer   arm/m68k: Change mail address of Sebastian Hess   i2c: Change mail address of Oskar Schirmer   net: Fix tcp_build_and_update_options comment in struct tcp_sock   atomic64_32.h: fix parameter naming mismatch   Kconfig: replace "--- help ---" with "---help---"   c2port: fix bogus Kconfig "default no"   edac: Fix spelling errors.   qla1280: Remove redundant NULL check before release_firmware() call   remoteproc: remove redundant NULL check before release_firmware()   qla2xxx: Remove redundant NULL check before release_firmware() call.   aic94xx: Get rid of redundant NULL check before release_firmware() call   tehuti: delete redundant NULL check before release_firmware()   qlogic: get rid of a redundant test for NULL before call to release_firmware()   bna: remove redundant NULL test before release_firmware()   tg3: remove redundant NULL test before release_firmware() call   typhoon: get rid of redundant conditional before all to release_firmware()   ...
f | vfb.c | s | 14K | 531 | Rusty Russell | rusty@rustcorp.com.au | 1326409340 |  | module_param: make bool parameters really bool (drivers & misc)  module_param(bool) used to counter-intuitively take an int.  In fddd5201 (mid-2009) we allowed bool or int/unsigned int using a messy trick.  It's time to remove the int/unsigned int option.  For this version it'll simply give a warning, but it'll break next kernel version.  Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
d | kyro |  | 8 items |  | Ondrej Zary | linux@rainbow-software.org | 1333895228 |  | kyrofb: fix on x86_64  kyrofb is completely broken on x86_64 because the registers are defined as unsigned long. Change them to u32 to make the driver work. Tested with Hercules 3D Prophet 4000XT.  Signed-off-by: Ondrej Zary <linux@rainbow-software.org> Acked-by: Paul Mundt <lethal@linux-sh.org> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | skeletonfb.c | s | 36K | 948 | Alexander Guy | alexander.guy@guy-engineering.com | 1334526242 |  | skeletonfb: fixed module exit function typo.  Signed-off-by: Alexander Guy <alexander.guy@guy-engineering.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | au1200fb.c | s | 50K | 1641 | Manuel Lauss | manuel.lauss@googlemail.com | 1333895229 |  | fbdev: fix au1*fb builds  Commit 1c16697bf9d5b206cb0d2b905a54de5e077296be ("drivers/video/au*fb.c: use devm_ functions) introduced 2 build failures in the au1100fb and au1200fb drivers, fix them.  Signed-off-by: Manuel Lauss <manuel.lauss@googlemail.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | svgalib.c | s | 19K | 559 | David Miller | davem@davemloft.net | 1300776442 |  | svga: Make svga_set_timings() take an iomem regbase pointer.  Signed-off-by: David S. Miller <davem@davemloft.net> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | atafb.h | s | 1.7K | 31 | Michael Schmitz | schmitz@opal.biophys.uni-duesseldorf.de | 1178326745 |  | m68k: Atari fb revival  Update the atari fb to 2.6 by Michael Schmitz, Reformatting and rewrite of bit plane functions by Roman Zippel, A few more fixes by Geert Uytterhoeven.  Signed-off-by: Michael Schmitz <schmitz@debian.org> Signed-off-by: Roman Zippel <zippel@linux-m68k.org> Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
d | nvidia |  | 12 items |  | Andrew Morton | akpm@linux-foundation.org | 1326427983 |  | drivers/video/nvidia/nvidia.c: fix warning  Fix the int/bool confusion in there.    drivers/video/nvidia/nvidia.c:1602: warning: return from incompatible pointer type  Cc: Florian Tobias Schandinat <FlorianSchandinat@gmx.de> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | tridentfb.c | s | 40K | 1436 | Laurent Pinchart | laurent.pinchart@ideasonboard.com | 1313742918 |  | tridentfb: use display information in info not in var for panning  We must not use any information in the passed var besides xoffset, yoffset and vmode as otherwise applications might abuse it.  Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
d | logo |  | 20 items |  | Rusty Russell | rusty@rustcorp.com.au | 1326409340 |  | module_param: make bool parameters really bool (drivers & misc)  module_param(bool) used to counter-intuitively take an int.  In fddd5201 (mid-2009) we allowed bool or int/unsigned int using a messy trick.  It's time to remove the int/unsigned int option.  For this version it'll simply give a warning, but it'll break next kernel version.  Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | atafb_iplan2p2.c | s | 6.7K | 252 | Michael Schmitz | schmitz@opal.biophys.uni-duesseldorf.de | 1178326745 |  | m68k: Atari fb revival  Update the atari fb to 2.6 by Michael Schmitz, Reformatting and rewrite of bit plane functions by Roman Zippel, A few more fixes by Geert Uytterhoeven.  Signed-off-by: Michael Schmitz <schmitz@debian.org> Signed-off-by: Roman Zippel <zippel@linux-m68k.org> Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | offb.c | s | 19K | 603 | Benjamin Herrenschmidt | benh@kernel.crashing.org | 1325552965 |  | offb: Fix setting of the pseudo-palette for >8bpp  When using a >8bpp framebuffer, offb advertises truecolor, not directcolor, and doesn't touch the color map even if it has a corresponding access method for the real hardware.  Thus it needs to set the pseudo-palette with all 3 components of the color, like other truecolor framebuffers, not with copies of the color index like a directcolor framebuffer would do.  This went unnoticed for a long time because it's pretty hard to get offb to kick in with anything but 8bpp (old BootX under MacOS will do that and qemu does it).  Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org> CC: stable@kernel.org
f | q40fb.c | s | 3.4K | 131 | David Howells | dhowells@redhat.com | 1332955803 |  | Remove all #inclusions of asm/system.h  Remove all #inclusions of asm/system.h preparatory to splitting and killing it.  Performed with the following command:  perl -p -i -e 's!^#\s*include\s*<asm/system[.]h>.*\n!!' `grep -Irl '^#\s*include\s*<asm/system[.]h>' *`  Signed-off-by: David Howells <dhowells@redhat.com>
f | tdfxfb.c | s | 42K | 1470 | Rusty Russell | rusty@rustcorp.com.au | 1326409340 |  | module_param: make bool parameters really bool (drivers & misc)  module_param(bool) used to counter-intuitively take an int.  In fddd5201 (mid-2009) we allowed bool or int/unsigned int using a messy trick.  It's time to remove the int/unsigned int option.  For this version it'll simply give a warning, but it'll break next kernel version.  Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | sunxvr500.c | s | 11K | 371 | Tejun Heo | tj@kernel.org | 1270435048 |  | Merge branch 'master' into export-slabh
d | msm |  | 13 items |  | David Brown | davidb@codeaurora.org | 1334337797 |  | video: msm: Fix section mismatches in mddi.c  The change     commit 461cbe77d0a4f887c33a3a95ea68a7daf23b4302     Author: Gregory Bean <gbean@codeaurora.org>     Date:   Wed Jul 28 10:22:13 2010 -0700          video: msm: Fix section mismatch in mddi.c.  fixes a section mismatch between the board file and the driver's probe function, however, it misses the additional mismatches between the probe function and some routines it calls.  Fix these up as well.  Signed-off-by: David Brown <davidb@codeaurora.org>
f | s3fb.c | s | 45K | 1312 | Ondrej Zary | linux@rainbow-software.org | 1324434321 |  | s3fb: fix Virge/VX  Add memory size detection for Virge/VX and small delay in mode setting (same as in X.org driver) to fix blank screen problem.  Also adjust DTPC position to fix garbled screen in some modes (tested that this adjustment does not break other cards - at least Trio32, Trio64V+, Trio64V2/DX, Virge, Virge/DX).  Tested on ELSA Winner 2000AVI/3D.  Signed-off-by: Ondrej Zary <linux@rainbow-software.org> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | sunxvr1000.c | s | 4.8K | 178 | Grant Likely | grant.likely@secretlab.ca | 1298924565 |  | dt/video: Eliminate users of of_platform_{,un}register_driver  Get rid of users of of_platform_driver in drivers/video.  The of_platform_{,un}register_driver functions are going away, so the users need to be converted to using the platform_bus_type directly.  Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | output.c | s | 3.5K | 116 | Tejun Heo | tj@kernel.org | 1269954152 |  | include cleanup: Update gfp.h and slab.h includes to prepare for breaking implicit slab.h inclusion from percpu.h  percpu.h is included by sched.h and module.h and thus ends up being included when building most .c files.  percpu.h includes slab.h which in turn includes gfp.h making everything defined by the two files universally available and complicating inclusion dependencies.  percpu.h -> slab.h dependency is about to be removed.  Prepare for this change by updating users of gfp and slab facilities include those headers directly instead of assuming availability.  As this conversion needs to touch large number of source files, the following script is used as the basis of conversion.    http://userweb.kernel.org/~tj/misc/slabh-sweep.py  The script does the followings.  * Scan files for gfp and slab usages and update includes such that   only the necessary includes are there.  ie. if only gfp is used,   gfp.h, if slab is used, slab.h.  * When the script inserts a new include, it looks at the include   blocks and try to put the new include such that its order conforms   to its surrounding.  It's put in the include block which contains   core kernel includes, in the same order that the rest are ordered -   alphabetical, Christmas tree, rev-Xmas-tree or at the end if there   doesn't seem to be any matching order.  * If the script can't find a place to put a new include (mostly   because the file doesn't have fitting include block), it prints out   an error message indicating which .h file needs to be added to the   file.  The conversion was done in the following steps.  1. The initial automatic conversion of all .c files updated slightly    over 4000 files, deleting around 700 includes and adding ~480 gfp.h    and ~3000 slab.h inclusions.  The script emitted errors for ~400    files.  2. Each error was manually checked.  Some didn't need the inclusion,    some needed manual addition while adding it to implementation .h or    embedding .c file was more appropriate for others.  This step added    inclusions to around 150 files.  3. The script was run again and the output was compared to the edits    from #2 to make sure no file was left behind.  4. Several build tests were done and a couple of problems were fixed.    e.g. lib/decompress_*.c used malloc/free() wrappers around slab    APIs requiring slab.h to be added manually.  5. The script was run on all .h files but without automatically    editing them as sprinkling gfp.h and slab.h inclusions around .h    files could easily lead to inclusion dependency hell.  Most gfp.h    inclusion directives were ignored as stuff from gfp.h was usually    wildly available and often used in preprocessor macros.  Each    slab.h inclusion directive was examined and added manually as    necessary.  6. percpu.h was updated not to include slab.h.  7. Build test were done on the following configurations and failures    were fixed.  CONFIG_GCOV_KERNEL was turned off for all tests (as my    distributed build env didn't work with gcov compiles) and a few    more options had to be turned off depending on archs to make things    build (like ipr on powerpc/64 which failed due to missing writeq).     * x86 and x86_64 UP and SMP allmodconfig and a custom test config.    * powerpc and powerpc64 SMP allmodconfig    * sparc and sparc64 SMP allmodconfig    * ia64 SMP allmodconfig    * s390 SMP allmodconfig    * alpha SMP allmodconfig    * um on x86_64 SMP allmodconfig  8. percpu.h modifications were reverted so that it could be applied as    a separate patch and serve as bisection point.  Given the fact that I had only a couple of failures from tests on step 6, I'm fairly confident about the coverage of this conversion patch. If there is a breakage, it's likely to be something in one of the arch headers which should be easily discoverable easily on most builds of the specific arch.  Signed-off-by: Tejun Heo <tj@kernel.org> Guess-its-ok-by: Christoph Lameter <cl@linux-foundation.org> Cc: Ingo Molnar <mingo@redhat.com> Cc: Lee Schermerhorn <Lee.Schermerhorn@hp.com>
d | backlight |  | 48 items |  | Linus Torvalds | torvalds@linux-foundation.org | 1339891145 |  | 
f | cg3.c | s | 11K | 403 | Grant Likely | grant.likely@secretlab.ca | 1298924565 |  | dt/video: Eliminate users of of_platform_{,un}register_driver  Get rid of users of of_platform_driver in drivers/video.  The of_platform_{,un}register_driver functions are going away, so the users need to be converted to using the platform_bus_type directly.  Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | bfin_adv7393fb.h | s | 8.6K | 287 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | c2p.h | s | 631B | 16 | Geert Uytterhoeven | geert@linux-m68k.org | 1231790192 |  | fbdev: c2p - Rename c2p to c2p_planar  Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
d | mb862xx |  | 7 items |  | H Hartley Sweeten | hartleys@visionengravers.com | 1336496250 |  | video: mb862xxfbdrv.c: local functions should not be exposed globally  Functions not referenced outside of a source file should be marked static to prevent them from being exposed globally.  Quiets the sparse warnings:  warning: symbol 'mb862xx_intr' was not declared. Should it be static?  Signed-off-by: H Hartley Sweeten <hsweeten@visionengravers.com> Cc: Anatolij Gustschin <agust@denx.de> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | nuc900fb.c | s | 18K | 640 | Axel Lin | axel.lin@gmail.com | 1322950122 |  | video: convert drivers/video/* to use module_platform_driver()  This patch converts the drivers in drivers/video/* to use the module_platform_driver() macro which makes the code smaller and a bit simpler.  Cc: Ben Dooks <ben@simtec.co.uk> Cc: Manuel Lauss <mano@roarinelk.homelinux.net> Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: Wan ZongShun <mcuos.com@gmail.com> Acked-by: Sascha Hauer <s.hauer@pengutronix.de> Acked-by: Lennert Buytenhek <buytenh@wantstofly.org> Acked-by: Alexey Charkov <alchark@gmail.com> Acked-by: Damian Hobson-Garcia <dhobsong@igel.co.jp> Acked-by: Jingoo Han <jg1.han@samsung.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | fbcvt.c | s | 9.3K | 320 | Justin P. Mattock | justinmattock@gmail.com | 1287392594 |  | Update broken web addresses in the kernel.  The patch below updates broken web addresses in the kernel  Signed-off-by: Justin P. Mattock <justinmattock@gmail.com> Cc: Maciej W. Rozycki <macro@linux-mips.org> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: Finn Thain <fthain@telegraphics.com.au> Cc: Randy Dunlap <rdunlap@xenotime.net> Cc: Matt Turner <mattst88@gmail.com> Cc: Dimitry Torokhov <dmitry.torokhov@gmail.com> Cc: Mike Frysinger <vapier.adi@gmail.com> Acked-by: Ben Pfaff <blp@cs.stanford.edu> Acked-by: Hans J. Koch <hjk@linutronix.de> Reviewed-by: Finn Thain <fthain@telegraphics.com.au> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | stifb.c | s | 35K | 1192 | André Goddard Rosa | andre.goddard@gmail.com | 1259937595 |  | tree-wide: fix assorted typos all over the place  That is "success", "unknown", "through", "performance", "[re||un]mapping" , "access", "default", "reasonable", "[con]currently", "temperature" , "channel", "[un]used", "application", "example","hierarchy", "therefore" , "[over||under]flow", "contiguous", "threshold", "enough" and others.  Signed-off-by: André Goddard Rosa <andre.goddard@gmail.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | da8xx-fb.c | s | 34K | 1212 | Anatolij Gustschin | agust@denx.de | 1332197987 |  | fbdev: da8xx: add support for SP10Q010 display  Add timing data for Hitachi SP10Q010 display and allow configuration of the 4bpp palette. For 4bpp framebuffer enable reversed order of pixels in a byte. This requires defining FB_CFB_REV_PIXELS_IN_BYTE and additionally setting var.nonstd to the value FB_NONSTD_REV_PIX_IN_B. Note that it is not enough to set da8xx_fb_var.nonstd to this value statically, since FBIOPUT_VSCREENINFO ioctl might pass var struct with .nonstd field set to zero or another value. Therefore this setting must be adjusted in fb_check_var() according to the requested bpp value.  Signed-off-by: Anatolij Gustschin <agust@denx.de> Cc: Manjunathappa, Prakash <prakash.pm@ti.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | pxafb.c | s | 61K | 1967 | Philipp Zabel | pzabel@gmx.de | 1332325741 |  | video: pxafb: add clk_prepare/clk_unprepare calls  This patch adds clk_prepare/clk_unprepare calls to the pxafb driver by using the helper functions clk_prepare_enable and clk_disable_unprepare.  Signed-off-by: Philipp Zabel <philipp.zabel@gmail.com> Cc: Haojian Zhuang <haojian.zhuang@marvell.com> Cc: Eric Miao <eric.y.miao@gmail.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | fb_ddc.c | s | 2.6K | 101 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103893 |  | video: Add module.h to drivers/video files who really use it.  They were getting this implicitly by an include of module.h from device.h -- but we are going to clean that up and break that include chain, so include module.h explicitly now.  [ with contributions from Axel Lin <axel.lin@gmail.com> ]  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | fb_notify.c | s | 1.2K | 43 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103893 |  | video: Add export.h for THIS_MODULE/EXPORT_SYMBOL to drivers/video  With module.h being implicitly everywhere via device.h, the absence of explicitly including something for EXPORT_SYMBOL went unnoticed. Since we are heading to fix things up and clean module.h from the device.h file, we need to explicitly include these files now.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | vga16fb.c | s | 37K | 1277 | Laurent Pinchart | laurent.pinchart@ideasonboard.com | 1313742934 |  | vga16fb: use display information in info not in var for panning  We must not use any information in the passed var besides xoffset, yoffset and vmode as otherwise applications might abuse it.  Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
f | nuc900fb.h | s | 1.2K | 44 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | cfbfillrect.c | s | 8.7K | 332 | Michal Januszewski | spock@gentoo.org | 1241652970 |  | fbdev: fix fillrect for 24bpp modes  The software fillrect routines do not work properly when the number of pixels per machine word is not an integer.  To see that, run the following command on a fbdev console with a 24bpp video mode, using a non-accelerated driver such as (u)vesafb:    reset ; echo -e '\e[41mtest\e[K'  The expected result is 'test' displayed on a line with red background. Instead of that, 'test' has a red background, but the rest of the line (rendered using fillrect()) contains a distored colorful pattern.  This patch fixes the problem by correctly computing rotation shifts.  It has been tested in a 24bpp mode on 32- and 64-bit little-endian machines.  Signed-off-by: Michal Januszewski <spock@gentoo.org> Acked-by: Krzysztof Helt <krzysztof.h1@wp.pl> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | vt8500lcdfb.h | s | 811B | 32 | Alexey Charkov | alchark@gmail.com | 1289296327 |  | ARM: Add support for the display controllers in VT8500 and WM8505  This adds drivers for the LCD controller found in VIA VT8500 SoC, GOVR display controller found in WonderMedia WM8505 SoC and for the Graphics Engine present in both of them that provides hardware accelerated raster operations (used for copyarea and fillrect).  Signed-off-by: Alexey Charkov <alchark@gmail.com> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | hpfb.c | s | 10K | 351 | axel lin | axel.lin@gmail.com | 1300777652 |  | video: hpfb: use resource_size()  The size calculation is done incorrectly here because it should include both the start and end (end - start + 1).  Signed-off-by: Axel Lin <axel.lin@gmail.com> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | sysimgblt.c | s | 6.8K | 249 | Harvey Harrison | harvey.harrison@gmail.com | 1209398322 |  | video: replace remaining __FUNCTION__ occurrences  __FUNCTION__ is gcc-specific, use __func__  Signed-off-by: Harvey Harrison <harvey.harrison@gmail.com> Cc: "Antonino A. Daplas" <adaplas@pol.net> Cc: Krzysztof Helt <krzysztof.h1@wp.pl> Cc: Antonino Daplas <adaplas@gmail.com> Cc: Antonino A. Daplas <adaplas@gmail.com> Cc: Antonino Daplas <adaplas@pol.net> Cc: Richard Purdie <rpurdie@rpsys.net> Cc: Jean Delvare <khali@linux-fr.org> Cc: Adrian Bunk <bunk@stusta.de> Cc: Russell King <rmk+kernel@arm.linux.org.uk> Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org> Cc: Ben Dooks <ben-linux@fluff.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | pmag-aa-fb.c | s | 11K | 422 | Tejun Heo | tj@kernel.org | 1269954152 |  | include cleanup: Update gfp.h and slab.h includes to prepare for breaking implicit slab.h inclusion from percpu.h  percpu.h is included by sched.h and module.h and thus ends up being included when building most .c files.  percpu.h includes slab.h which in turn includes gfp.h making everything defined by the two files universally available and complicating inclusion dependencies.  percpu.h -> slab.h dependency is about to be removed.  Prepare for this change by updating users of gfp and slab facilities include those headers directly instead of assuming availability.  As this conversion needs to touch large number of source files, the following script is used as the basis of conversion.    http://userweb.kernel.org/~tj/misc/slabh-sweep.py  The script does the followings.  * Scan files for gfp and slab usages and update includes such that   only the necessary includes are there.  ie. if only gfp is used,   gfp.h, if slab is used, slab.h.  * When the script inserts a new include, it looks at the include   blocks and try to put the new include such that its order conforms   to its surrounding.  It's put in the include block which contains   core kernel includes, in the same order that the rest are ordered -   alphabetical, Christmas tree, rev-Xmas-tree or at the end if there   doesn't seem to be any matching order.  * If the script can't find a place to put a new include (mostly   because the file doesn't have fitting include block), it prints out   an error message indicating which .h file needs to be added to the   file.  The conversion was done in the following steps.  1. The initial automatic conversion of all .c files updated slightly    over 4000 files, deleting around 700 includes and adding ~480 gfp.h    and ~3000 slab.h inclusions.  The script emitted errors for ~400    files.  2. Each error was manually checked.  Some didn't need the inclusion,    some needed manual addition while adding it to implementation .h or    embedding .c file was more appropriate for others.  This step added    inclusions to around 150 files.  3. The script was run again and the output was compared to the edits    from #2 to make sure no file was left behind.  4. Several build tests were done and a couple of problems were fixed.    e.g. lib/decompress_*.c used malloc/free() wrappers around slab    APIs requiring slab.h to be added manually.  5. The script was run on all .h files but without automatically    editing them as sprinkling gfp.h and slab.h inclusions around .h    files could easily lead to inclusion dependency hell.  Most gfp.h    inclusion directives were ignored as stuff from gfp.h was usually    wildly available and often used in preprocessor macros.  Each    slab.h inclusion directive was examined and added manually as    necessary.  6. percpu.h was updated not to include slab.h.  7. Build test were done on the following configurations and failures    were fixed.  CONFIG_GCOV_KERNEL was turned off for all tests (as my    distributed build env didn't work with gcov compiles) and a few    more options had to be turned off depending on archs to make things    build (like ipr on powerpc/64 which failed due to missing writeq).     * x86 and x86_64 UP and SMP allmodconfig and a custom test config.    * powerpc and powerpc64 SMP allmodconfig    * sparc and sparc64 SMP allmodconfig    * ia64 SMP allmodconfig    * s390 SMP allmodconfig    * alpha SMP allmodconfig    * um on x86_64 SMP allmodconfig  8. percpu.h modifications were reverted so that it could be applied as    a separate patch and serve as bisection point.  Given the fact that I had only a couple of failures from tests on step 6, I'm fairly confident about the coverage of this conversion patch. If there is a breakage, it's likely to be something in one of the arch headers which should be easily discoverable easily on most builds of the specific arch.  Signed-off-by: Tejun Heo <tj@kernel.org> Guess-its-ok-by: Christoph Lameter <cl@linux-foundation.org> Cc: Ingo Molnar <mingo@redhat.com> Cc: Lee Schermerhorn <Lee.Schermerhorn@hp.com>
f | cfbimgblt.c | s | 8.2K | 273 | Harvey Harrison | harvey.harrison@gmail.com | 1209398322 |  | video: replace remaining __FUNCTION__ occurrences  __FUNCTION__ is gcc-specific, use __func__  Signed-off-by: Harvey Harrison <harvey.harrison@gmail.com> Cc: "Antonino A. Daplas" <adaplas@pol.net> Cc: Krzysztof Helt <krzysztof.h1@wp.pl> Cc: Antonino Daplas <adaplas@gmail.com> Cc: Antonino A. Daplas <adaplas@gmail.com> Cc: Antonino Daplas <adaplas@pol.net> Cc: Richard Purdie <rpurdie@rpsys.net> Cc: Jean Delvare <khali@linux-fr.org> Cc: Adrian Bunk <bunk@stusta.de> Cc: Russell King <rmk+kernel@arm.linux.org.uk> Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org> Cc: Ben Dooks <ben-linux@fluff.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | sh_mobile_lcdcfb.h | s | 2.6K | 90 | Laurent Pinchart | laurent.pinchart@ideasonboard.com | 1337659172 |  | fbdev: sh_mobile_lcdc: Don't confuse line size with pitch  When using the MERAM the LCDC line size needs to be programmed with a MERAM-specific value different than the real frame buffer pitch. Fix it.  Reported-by: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com> Acked-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de> Cc: stable@vger.kernel.org  # for 3.4 Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | sa1100fb.c | s | 37K | 1179 | Russell King | rmk+kernel@arm.linux.org.uk | 1330076399 |  | FB: sa11x0: convert to use platform resource and ioremap()  Convert the sa11x0 framebuffer driver to obtain the base address of its hardware registers from the platform resources, and ioremap this rather than relying on the static mappings.  Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
f | sh7760fb.c | s | 14K | 487 | Axel Lin | axel.lin@gmail.com | 1322950122 |  | video: convert drivers/video/* to use module_platform_driver()  This patch converts the drivers in drivers/video/* to use the module_platform_driver() macro which makes the code smaller and a bit simpler.  Cc: Ben Dooks <ben@simtec.co.uk> Cc: Manuel Lauss <mano@roarinelk.homelinux.net> Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: Wan ZongShun <mcuos.com@gmail.com> Acked-by: Sascha Hauer <s.hauer@pengutronix.de> Acked-by: Lennert Buytenhek <buytenh@wantstofly.org> Acked-by: Alexey Charkov <alchark@gmail.com> Acked-by: Damian Hobson-Garcia <dhobsong@igel.co.jp> Acked-by: Jingoo Han <jg1.han@samsung.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | macfb.c | s | 22K | 810 | Finn Thain | fthain@telegraphics.com.au | 1327240202 |  | macfb: fix black and white modes  macfb won't init in black & white modes since fb_alloc_cmap() no longer works for zero cmap length. Fix this and also clean up a few printk's and some stylistic inconsistencies.  Signed-off-by: Finn Thain <fthain@telegraphics.com.au> Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
f | mxsfb.c | s | 23K | 779 | Linus Torvalds | torvalds@linux-foundation.org | 1338595071 |  | 
f | fbmon.c | s | 36K | 1318 | Tomi Valkeinen | tomi.valkeinen@ti.com | 1314837065 |  | fbdev: fix parsing of standard timings  The standard timings parses uses 1:1 dimensions when the ratio in the EDID data is 0. However, for EDID 1.3 and later the dimensions are 16:10 when the ratio is 0.  Pass the version and revision numbers to get_std_timing() which can then make the right decision about dimensions.  Signed-off-by: Tomi Valkeinen <tomi.valkeinen@ti.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | asiliantfb.c | s | 16K | 552 | Tejun Heo | tj@kernel.org | 1269954152 |  | include cleanup: Update gfp.h and slab.h includes to prepare for breaking implicit slab.h inclusion from percpu.h  percpu.h is included by sched.h and module.h and thus ends up being included when building most .c files.  percpu.h includes slab.h which in turn includes gfp.h making everything defined by the two files universally available and complicating inclusion dependencies.  percpu.h -> slab.h dependency is about to be removed.  Prepare for this change by updating users of gfp and slab facilities include those headers directly instead of assuming availability.  As this conversion needs to touch large number of source files, the following script is used as the basis of conversion.    http://userweb.kernel.org/~tj/misc/slabh-sweep.py  The script does the followings.  * Scan files for gfp and slab usages and update includes such that   only the necessary includes are there.  ie. if only gfp is used,   gfp.h, if slab is used, slab.h.  * When the script inserts a new include, it looks at the include   blocks and try to put the new include such that its order conforms   to its surrounding.  It's put in the include block which contains   core kernel includes, in the same order that the rest are ordered -   alphabetical, Christmas tree, rev-Xmas-tree or at the end if there   doesn't seem to be any matching order.  * If the script can't find a place to put a new include (mostly   because the file doesn't have fitting include block), it prints out   an error message indicating which .h file needs to be added to the   file.  The conversion was done in the following steps.  1. The initial automatic conversion of all .c files updated slightly    over 4000 files, deleting around 700 includes and adding ~480 gfp.h    and ~3000 slab.h inclusions.  The script emitted errors for ~400    files.  2. Each error was manually checked.  Some didn't need the inclusion,    some needed manual addition while adding it to implementation .h or    embedding .c file was more appropriate for others.  This step added    inclusions to around 150 files.  3. The script was run again and the output was compared to the edits    from #2 to make sure no file was left behind.  4. Several build tests were done and a couple of problems were fixed.    e.g. lib/decompress_*.c used malloc/free() wrappers around slab    APIs requiring slab.h to be added manually.  5. The script was run on all .h files but without automatically    editing them as sprinkling gfp.h and slab.h inclusions around .h    files could easily lead to inclusion dependency hell.  Most gfp.h    inclusion directives were ignored as stuff from gfp.h was usually    wildly available and often used in preprocessor macros.  Each    slab.h inclusion directive was examined and added manually as    necessary.  6. percpu.h was updated not to include slab.h.  7. Build test were done on the following configurations and failures    were fixed.  CONFIG_GCOV_KERNEL was turned off for all tests (as my    distributed build env didn't work with gcov compiles) and a few    more options had to be turned off depending on archs to make things    build (like ipr on powerpc/64 which failed due to missing writeq).     * x86 and x86_64 UP and SMP allmodconfig and a custom test config.    * powerpc and powerpc64 SMP allmodconfig    * sparc and sparc64 SMP allmodconfig    * ia64 SMP allmodconfig    * s390 SMP allmodconfig    * alpha SMP allmodconfig    * um on x86_64 SMP allmodconfig  8. percpu.h modifications were reverted so that it could be applied as    a separate patch and serve as bisection point.  Given the fact that I had only a couple of failures from tests on step 6, I'm fairly confident about the coverage of this conversion patch. If there is a breakage, it's likely to be something in one of the arch headers which should be easily discoverable easily on most builds of the specific arch.  Signed-off-by: Tejun Heo <tj@kernel.org> Guess-its-ok-by: Christoph Lameter <cl@linux-foundation.org> Cc: Ingo Molnar <mingo@redhat.com> Cc: Lee Schermerhorn <Lee.Schermerhorn@hp.com>
f | auo_k1900fb.c | s | 5.0K | 163 | Heiko Stübner | heiko@sntech.de | 1335728140 |  | video: auo_k190x: add driver for AUO-K1900 variant  This controller only supports smaller resolutions and only serial updates, i.e. it has to wait for an update to finish before starting another one.  Signed-off-by: Heiko Stübner <heiko@sntech.de> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | pvr2fb.c | s | 31K | 959 | Julia Lawall | Julia.Lawall@lip6.fr | 1331680651 |  | drivers/video/pvr2fb.c: ensure arguments to request_irq and free_irq are compatible  Convert calls to free_irq so that the second argument is the same as the last argument of the corresponding call to request_irq.  Without this property, free_irq does nothing.  Signed-off-by: Julia Lawall <Julia.Lawall@lip6.fr> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | fbmem.c | s | 45K | 1678 | Inki Dae | inki.dae@samsung.com | 1338333748 |  | fbdev: add events for early fb event support  Add FB_EARLY_EVENT_BLANK and FB_R_EARLY_EVENT_BLANK event mode supports. first, fb_notifier_call_chain() is called with FB_EARLY_EVENT_BLANK and fb_blank() of specific fb driver is called and then fb_notifier_call_chain() is called with FB_EVENT_BLANK again at fb_blank().  and if fb_blank() was failed then fb_nitifier_call_chain() would be called with FB_R_EARLY_EVENT_BLANK to revert the previous effects.  Signed-off-by: Inki Dae <inki.dae@samsung.com> Signed-off-by: Kyungmin Park <kyungmin.park@samsung.com> Cc: Lars-Peter Clausen <lars@metafoo.de> Acked-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de> Cc: Richard Purdie <rpurdie@rpsys.net> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | jz4740_fb.c | s | 19K | 700 | Torben Hohn | torbenh@gmx.de | 1296003006 |  | console: rename acquire/release_console_sem() to console_lock/unlock()  The -rt patches change the console_semaphore to console_mutex.  As a result, a quite large chunk of the patches changes all acquire/release_console_sem() to acquire/release_console_mutex()  This commit makes things use more neutral function names which dont make implications about the underlying lock.  The only real change is the return value of console_trylock which is inverted from try_acquire_console_sem()  This patch also paves the way to switching console_sem from a semaphore to a mutex.  [akpm@linux-foundation.org: coding-style fixes] [akpm@linux-foundation.org: make console_trylock return 1 on success, per Geert] Signed-off-by: Torben Hohn <torbenh@gmx.de> Cc: Thomas Gleixner <tglx@tglx.de> Cc: Greg KH <gregkh@suse.de> Cc: Ingo Molnar <mingo@elte.hu> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | clps711xfb.c | s | 10K | 353 | Alexander Shiyan | shc_work@mail.ru | 1336745881 |  | ARM: clps711x: Using a single definition for the PHYS and VIRT registers offset  Using a single definition for the physical and virtual address register for all variants boards clps711x. This patch also includes the use of a single function clps_read/write in some units.  Signed-off-by: Alexander Shiyan <shc_work@mail.ru> Signed-off-by: Arnd Bergmann <arnd@arndb.de>
f | pm2fb.c | s | 49K | 1668 | Rusty Russell | rusty@rustcorp.com.au | 1326409340 |  | module_param: make bool parameters really bool (drivers & misc)  module_param(bool) used to counter-intuitively take an int.  In fddd5201 (mid-2009) we allowed bool or int/unsigned int using a messy trick.  It's time to remove the int/unsigned int option.  For this version it'll simply give a warning, but it'll break next kernel version.  Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | tcx.c | s | 12K | 449 | axel lin | axel.lin@gmail.com | 1300779344 |  | video: add missing framebuffer_release in error path  This patch fixes a memory leak in the error path.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: David S. Miller <davem@davemloft.net> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | hitfb.c | s | 10K | 423 | Henrik Kretzschmar | henne@nachtwindheim.de | 1274800029 |  | hitfb: fix sections  Since the drivers probe call was changed from .init.text to .devinit.text in commit c2e13037e6794bd0d9de3f9ecabf5615f15c160b ("platform-drivers: move probe to .devinit.text in drivers/video") the fb_fix_screeninfo and fb_var_screeninfo structures must be changed from .init.data to .devinit.data, too.  Also the drivers remove routine should be moved from .exit.text to .devexit.text  Signed-off-by: Henrik Kretzschmar <henne@nachtwindheim.de> Cc: Paul Mundt <lethal@linux-sh.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | sbuslib.c | s | 6.9K | 238 | Zac Storer | zac.3.14159@gmail.com | 1321923624 |  | Drivers: video: sbuslib: fixed a brace coding style issue  Fixed a brace coding style issue.  Signed-off-by: Zac Storer <zac.3.14159@gmail.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | sh_mobile_lcdcfb.c | s | 49K | 1705 | Laurent Pinchart | laurent.pinchart@ideasonboard.com | 1337659172 |  | fbdev: sh_mobile_lcdc: Don't confuse line size with pitch  When using the MERAM the LCDC line size needs to be programmed with a MERAM-specific value different than the real frame buffer pitch. Fix it.  Reported-by: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com> Acked-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de> Cc: stable@vger.kernel.org  # for 3.4 Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | pm3fb.c | s | 42K | 1385 | Rusty Russell | rusty@rustcorp.com.au | 1326409340 |  | module_param: make bool parameters really bool (drivers & misc)  module_param(bool) used to counter-intuitively take an int.  In fddd5201 (mid-2009) we allowed bool or int/unsigned int using a messy trick.  It's time to remove the int/unsigned int option.  For this version it'll simply give a warning, but it'll break next kernel version.  Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | hgafb.c | s | 16K | 553 | Rusty Russell | rusty@rustcorp.com.au | 1326409340 |  | module_param: make bool parameters really bool (drivers & misc)  module_param(bool) used to counter-intuitively take an int.  In fddd5201 (mid-2009) we allowed bool or int/unsigned int using a messy trick.  It's time to remove the int/unsigned int option.  For this version it'll simply give a warning, but it'll break next kernel version.  Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | bw2.c | s | 9.2K | 329 | Grant Likely | grant.likely@secretlab.ca | 1298924565 |  | dt/video: Eliminate users of of_platform_{,un}register_driver  Get rid of users of of_platform_driver in drivers/video.  The of_platform_{,un}register_driver functions are going away, so the users need to be converted to using the platform_bus_type directly.  Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | bfin_adv7393fb.c | s | 19K | 676 | Emil Goode | emilgoode@gmail.com | 1338932846 |  | video: bfin_adv7393fb: Convert to kstrtouint_from_user  This patch removes a call to the deprecated simple_strtoul function and simplifies the code by replacing two function calls with one call to kstrtouint_from_user.  -Simplify the adv7393_write_proc function by replacing the  simple_strtoul and copy_from_user calls with one call  to kstrtouint_from_user.  -Change the count parameter from unsigned long to size_t as  this is the type that the kstrtouint_from_user function expects.  (size_t is what will be passed to the adv7393_write_proc function  by the proc write handler function proc_file_write anyway)  Signed-off-by: Emil Goode <emilgoode@gmail.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
d | savage |  | 5 items |  | Arnd Bergmann | arnd@arndb.de | 1339246272 |  | drivers/savagefb: use mdelay instead of udelay  Long delays need to use mdelay on architectures such as ARM that cannot compute long timeouts in udelay.  Signed-off-by: Arnd Bergmann <arnd@arndb.de> Signed-off-by: Mathieu Poirier <mathieu.poirier@linaro.org> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | platinumfb.c | s | 19K | 602 | Axel Lin | axel.lin@gmail.com | 1318637998 |  | video: platinumfb: Add __devexit_p at necessary place  According to the comments in include/linux/init.h:  "Pointers to __devexit functions must use __devexit_p(function_name), the wrapper will insert either the function_name or NULL, depending on the config options."  We have __devexit annotation for platinumfb_remove(), thus add __devexit_p at necessary place.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | sticore.h | s | 10K | 294 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | controlfb.c | s | 27K | 926 | Zac Storer | zac.3.14159@gmail.com | 1321923616 |  | Drivers: video: controlfb: fixed a brace coding style issue  Fixed a brace coding style issue.  Signed-off-by: Zac Storer <zac.3.14159@gmail.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | sgivwfb.c | s | 22K | 770 | Henrik Kretzschmar | henne@nachtwindheim.de | 1274800029 |  | sgivwfb: fix sections  Since the drivers probe call was changed from .init.text to .devinit.text in commit c2e13037e6794bd0d9de3f9ecabf5615f15c160b ("platform-drivers: move probe to .devinit.text in drivers/video") the fb_fix_screeninfo and fb_var_screeninfo structures must be changed from .init.data to .devinit.data, too.  Also the drivers remove routine should be moved from .text to .devexit.text  It removes these 7 section mismatch warnings from modpost:  WARNING: vmlinux.o(.devinit.text+0x1e28): Section mismatch in reference from the function sgivwfb_probe() to the variable .init.data:sgivwfb_fix The function __devinit sgivwfb_probe() references a variable __initdata sgivwfb_fix. If sgivwfb_fix is only used by sgivwfb_probe then annotate sgivwfb_fix with a matching annotation.  WARNING: vmlinux.o(.devinit.text+0x1e50): Section mismatch in reference from the function sgivwfb_probe() to the (unknown reference) .init.data:(unknown) The function __devinit sgivwfb_probe() references a (unknown reference) __initdata (unknown). If (unknown) is only used by sgivwfb_probe then annotate (unknown) with a matching annotation.  WARNING: vmlinux.o(.devinit.text+0x1e59): Section mismatch in reference from the function sgivwfb_probe() to the (unknown reference) .init.data:(unknown) The function __devinit sgivwfb_probe() references a (unknown reference) __initdata (unknown). If (unknown) is only used by sgivwfb_probe then annotate (unknown) with a matching annotation.  WARNING: vmlinux.o(.devinit.text+0x1e60): Section mismatch in reference from the function sgivwfb_probe() to the variable .init.data:sgivwfb_fix The function __devinit sgivwfb_probe() references a variable __initdata sgivwfb_fix. If sgivwfb_fix is only used by sgivwfb_probe then annotate sgivwfb_fix with a matching annotation.  WARNING: vmlinux.o(.devinit.text+0x1e6a): Section mismatch in reference from the function sgivwfb_probe() to the (unknown reference) .init.data:(unknown) The function __devinit sgivwfb_probe() references a (unknown reference) __initdata (unknown). If (unknown) is only used by sgivwfb_probe then annotate (unknown) with a matching annotation.  WARNING: vmlinux.o(.devinit.text+0x1e7f): Section mismatch in reference from the function sgivwfb_probe() to the variable .init.data:sgivwfb_var1600sw The function __devinit sgivwfb_probe() references a variable __initdata sgivwfb_var1600sw. If sgivwfb_var1600sw is only used by sgivwfb_probe then annotate sgivwfb_var1600sw with a matching annotation.  WARNING: vmlinux.o(.devinit.text+0x1e91): Section mismatch in reference from the function sgivwfb_probe() to the variable .init.data:sgivwfb_var The function __devinit sgivwfb_probe() references a variable __initdata sgivwfb_var. If sgivwfb_var is only used by sgivwfb_probe then annotate sgivwfb_var with a matching annotation.  Signed-off-by: Henrik Kretzschmar <henne@nachtwindheim.de> Cc: Arnaud Patard <arnaud.patard@rtp-net.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | fbcmap.c | s | 8.5K | 326 | Randy Dunlap | randy.dunlap@oracle.com | 1290751508 |  | framebuffer: fix fbcmap.c kernel-doc warning  Fix kernel-doc warning in fbcmap.c:  Warning(drivers/video/fbcmap.c:92): No description found for parameter 'flags'  Signed-off-by: Randy Dunlap <randy.dunlap@oracle.com> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | vgastate.c | s | 13K | 410 | Ondrej Zajicek | santiago@crfreenet.org | 1178648132 |  | vga: vgastate fix  1) sets 'palette access disabled' during read from AR10.    This is usually documented as needed for access AR01-AR0F,    but on ARK Logic card it is needed for AR10 (otherwise read    returns some nonsence and save_vga_text() returns before do    anything).  2) do not restore AR10, because it was not changed during  3) remove modification of misc reg:         /* force graphics mode */         vga_w(state->vgabase, VGA_MIS_W, misc || 1);     as comment is misleading - LSB of misc reg does not set/reset graphics    mode, but set color/mono adresses of CRT and some other regs.    but these regs are not used during save/restore fonts.    (it worked even when (misc || 1) was replaced by (misc & ~1) ).  Signed-off-by: Ondrej Zajicek <santiago@crfreenet.org> Signed-off-by: Antonino Daplas <adaplas@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | i740fb.c | s | 33K | 1143 | Florian Tobias Schandinat | FlorianSchandinat@gmx.de | 1329678711 |  | i740fb: fix compile error when CONFIG_MTRR is not selected  Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | atafb.c | s | 88K | 2935 | Geert Uytterhoeven | geert@linux-m68k.org | 1305821950 |  | m68k/atari: Do not use "/" in interrupt names  It may trigger a warning in fs/proc/generic.c:__xlate_proc_name() when trying to add an entry for the interrupt handler to sysfs.  Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
f | fm2fb.c | s | 9.1K | 286 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | 68328fb.c | s | 13K | 454 | Laurent Pinchart | laurent.pinchart@ideasonboard.com | 1313742538 |  | 68328fb: use display information in info not in var for panning  We must not use any information in the passed var besides xoffset, yoffset and vmode as otherwise applications might abuse it.  Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
f | atmel_lcdfb.c | s | 32K | 970 | Peter Korsgaard | jacmet@sunsite.dk | 1327780450 |  | atmel_lcdfb: support 16bit BGR:565 mode, remove unsupported 15bit modes  Allow framebuffer to be configured in 16bit mode when panel is wired in (the default) BGR configuration, and don't claim to support 15bit input modes, which the LCD controller cannot handle.  Signed-off-by: Peter Korsgaard <jacmet@sunsite.dk> Acked-by: Nicolas Ferre <nicolas.ferre@atmel.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | tmiofb.c | s | 27K | 895 | Yong Zhang | yong.zhang0@gmail.com | 1317657142 |  | video: irq: Remove IRQF_DISABLED  Since commit [e58aa3d2: genirq: Run irq handlers with interrupts disabled], We run all interrupt handlers with interrupts disabled and we even check and yell when an interrupt handler returns with interrupts enabled (see commit [b738a50a: genirq: Warn when handler enables interrupts]).  So now this flag is a NOOP and can be removed.  Signed-off-by: Yong Zhang <yong.zhang0@gmail.com> Acked-by: David Brown <davidb@codeaurora.org> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | auo_k190x.c | s | 24K | 829 | Heiko Stübner | heiko@sntech.de | 1335728135 |  | video: auo_k190x: add code shared by controller drivers  The AUO-K190X controllers share a very similar set of commands and can therefore also share most of the driver code.  Signed-off-by: Heiko Stübner <heiko@sntech.de> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | atafb_iplan2p4.c | s | 7.1K | 267 | Michael Schmitz | schmitz@opal.biophys.uni-duesseldorf.de | 1178326745 |  | m68k: Atari fb revival  Update the atari fb to 2.6 by Michael Schmitz, Reformatting and rewrite of bit plane functions by Roman Zippel, A few more fixes by Geert Uytterhoeven.  Signed-off-by: Michael Schmitz <schmitz@debian.org> Signed-off-by: Roman Zippel <zippel@linux-m68k.org> Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | cobalt_lcdfb.c | s | 8.6K | 334 | Steven J. Hill | sjhill@mips.com | 1335728045 |  | cobalt_lcdfb: LCD panel framebuffer support for SEAD-3 platform.  Add support for LCD panel on MIPS SEAD-3 development platform.  Signed-off-by: Douglas Leung <douglas@mips.com> Signed-off-by: Chris Dearman <chris@mips.com> Signed-off-by: Steven J. Hill <sjhill@mips.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | xilinxfb.c | s | 13K | 435 | Axel Lin | axel.lin@gmail.com | 1322950122 |  | video: convert drivers/video/* to use module_platform_driver()  This patch converts the drivers in drivers/video/* to use the module_platform_driver() macro which makes the code smaller and a bit simpler.  Cc: Ben Dooks <ben@simtec.co.uk> Cc: Manuel Lauss <mano@roarinelk.homelinux.net> Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: Wan ZongShun <mcuos.com@gmail.com> Acked-by: Sascha Hauer <s.hauer@pengutronix.de> Acked-by: Lennert Buytenhek <buytenh@wantstofly.org> Acked-by: Alexey Charkov <alchark@gmail.com> Acked-by: Damian Hobson-Garcia <dhobsong@igel.co.jp> Acked-by: Jingoo Han <jg1.han@samsung.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | ffb.c | s | 24K | 931 | axel lin | axel.lin@gmail.com | 1300778331 |  | video: ffb: fix ffb_probe error path  Current implementation calls of_iounmap for par->fbc twice in error path. In the case of goto out_unmap_dac, we should call of_iounmap for par->dac.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: David S. Miller <davem@davemloft.net> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | vesafb.c | s | 14K | 468 | Daniel J Blueman | daniel.blueman@gmail.com | 1309762968 |  | vesafb: fix memory leak  When releasing framebuffer, free colourmap allocations.  Signed-off-by: Daniel J Blueman <daniel.blueman@gmail.com> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | p9100.c | s | 9.0K | 306 | Grant Likely | grant.likely@secretlab.ca | 1298924565 |  | dt/video: Eliminate users of of_platform_{,un}register_driver  Get rid of users of of_platform_driver in drivers/video.  The of_platform_{,un}register_driver functions are going away, so the users need to be converted to using the platform_bus_type directly.  Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | pxafb.h | s | 4.2K | 166 | Vasily Khoruzhick | anarsoul@gmail.com | 1300268223 |  | ARM: pxafb: rework pxafb overlay memory management  PXAFB overlay memory management is something messy: - it allocates memory dynamically on open/release, and it results   in memory allocation failure after ~1h of uptime (system does not have   115k of physically contiguous memory) - in release callback it tries to free memory even if it was not   allocated.  Also driver touches FDADR1 on main plane reconfiguration, and it can cause problems if overlay1 is enabled.  This patch attempts to fix those issues.  Patch is based on Russell King's work.  Signed-off-by: Vasily Khoruzhick <anarsoul@gmail.com> Signed-off-by: Eric Miao <eric.y.miao@gmail.com>
f | i740_reg.h | s | 8.9K | 279 | Ondrej Zary | linux@rainbow-software.org | 1329280281 |  | Resurrect Intel740 driver: i740fb  This is a resurrection of an old (like 2.4.19) out-of-tree driver for Intel740 graphics cards and adaptation for recent kernels. The old driver by Andrey Ulanov is located at: http://sourceforge.net/projects/i740fbdev/files/  This is a new driver based on skeletonfb, using most of the low level HW code from the old driver. The DDC code is completely new.  The driver was tested on two 8MB cards: Protac AG240D and Diamond Stealth II G460.  Signed-off-by: Ondrej Zary <linux@rainbow-software.org> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | wm8505fb_regs.h | s | 2.1K | 65 | Alexey Charkov | alchark@gmail.com | 1289296327 |  | ARM: Add support for the display controllers in VT8500 and WM8505  This adds drivers for the LCD controller found in VIA VT8500 SoC, GOVR display controller found in WonderMedia WM8505 SoC and for the Graphics Engine present in both of them that provides hardware accelerated raster operations (used for copyarea and fillrect).  Signed-off-by: Alexey Charkov <alchark@gmail.com> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
d | riva |  | 10 items |  | Danny Kukawka | danny.kukawka@bisect.de | 1329101954 |  | riva/fbdev: fix several -Wuninitialized  Fix several -Wuninitialized compiler warnings by changing the order of getting modedb in riva_update_default_var() to set first the fallback and then the prefered timing.  Signed-off-by: Danny Kukawka <danny.kukawka@bisect.de> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
d | vermilion |  | 4 items |  | Arun Sharma | asharma@fb.com | 1311724187 |  | atomic: use <linux/atomic.h>  This allows us to move duplicated code in <asm/atomic.h> (atomic_inc_not_zero() for now) to <linux/atomic.h>  Signed-off-by: Arun Sharma <asharma@fb.com> Reviewed-by: Eric Dumazet <eric.dumazet@gmail.com> Cc: Ingo Molnar <mingo@elte.hu> Cc: David Miller <davem@davemloft.net> Cc: Eric Dumazet <eric.dumazet@gmail.com> Acked-by: Mike Frysinger <vapier@gentoo.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | dnfb.c | s | 7.9K | 251 | David Howells | dhowells@redhat.com | 1332955803 |  | Remove all #inclusions of asm/system.h  Remove all #inclusions of asm/system.h preparatory to splitting and killing it.  Performed with the following command:  perl -p -i -e 's!^#\s*include\s*<asm/system[.]h>.*\n!!' `grep -Irl '^#\s*include\s*<asm/system[.]h>' *`  Signed-off-by: David Howells <dhowells@redhat.com>
f | c2p_core.h | s | 2.6K | 120 | Geert Uytterhoeven | geert@linux-m68k.org | 1231790191 |  | fbdev: c2p/atafb - Add support for Atari interleaved bitplanes  The c2p() for normal bitplanes is not suitable for interleaved bitplanes with 2 bytes of interleave, causing a garbled penguin logo. Add c2p_iplan2().  Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
f | Kconfig | g | 73K |  | Heiko Stübner | heiko@sntech.de | 1335728142 |  | video: auo_k190x: add driver for AUO-K1901 variant  This controller not only supports higher resolutions than the K1900 but concurrent updates as well. This results in a generally higher display speed.  Signed-off-by: Heiko Stübner <heiko@sntech.de> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | udlfb.c | s | 51K | 1600 | Linus Torvalds | torvalds@linux-foundation.org | 1338595071 |  | 
f | epson1355fb.c | s | 17K | 613 | Justin P. Mattock | justinmattock@gmail.com | 1287392594 |  | Update broken web addresses in the kernel.  The patch below updates broken web addresses in the kernel  Signed-off-by: Justin P. Mattock <justinmattock@gmail.com> Cc: Maciej W. Rozycki <macro@linux-mips.org> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: Finn Thain <fthain@telegraphics.com.au> Cc: Randy Dunlap <rdunlap@xenotime.net> Cc: Matt Turner <mattst88@gmail.com> Cc: Dimitry Torokhov <dmitry.torokhov@gmail.com> Cc: Mike Frysinger <vapier.adi@gmail.com> Acked-by: Ben Pfaff <blp@cs.stanford.edu> Acked-by: Hans J. Koch <hjk@linutronix.de> Reviewed-by: Finn Thain <fthain@telegraphics.com.au> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | bt431.h | s | 5.7K | 206 | David Howells | dhowells@redhat.com | 1332955803 |  | Remove all #inclusions of asm/system.h  Remove all #inclusions of asm/system.h preparatory to splitting and killing it.  Performed with the following command:  perl -p -i -e 's!^#\s*include\s*<asm/system[.]h>.*\n!!' `grep -Irl '^#\s*include\s*<asm/system[.]h>' *`  Signed-off-by: David Howells <dhowells@redhat.com>
d | exynos |  | 14 items |  | Jingoo Han | jg1.han@samsung.com | 1338297375 |  | video: exynos_dp: reduce delay time when configuring video setting  This patch reduces delay time when configuring video setting, which is helpful to reduce wakeup time during resume.  Signed-off-by: Jingoo Han <jg1.han@samsung.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | sa1100fb.h | s | 2.4K | 80 | Russell King | rmk+kernel@arm.linux.org.uk | 1330076399 |  | FB: sa11x0: convert to use platform resource and ioremap()  Convert the sa11x0 framebuffer driver to obtain the base address of its hardware registers from the platform resources, and ioremap this rather than relying on the static mappings.  Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
f | fb_draw.h | s | 4.4K | 161 | Michal Januszewski | spock@gentoo.org | 1241652970 |  | fbdev: fix fillrect for 24bpp modes  The software fillrect routines do not work properly when the number of pixels per machine word is not an integer.  To see that, run the following command on a fbdev console with a 24bpp video mode, using a non-accelerated driver such as (u)vesafb:    reset ; echo -e '\e[41mtest\e[K'  The expected result is 'test' displayed on a line with red background. Instead of that, 'test' has a red background, but the rest of the line (rendered using fillrect()) contains a distored colorful pattern.  This patch fixes the problem by correctly computing rotation shifts.  It has been tested in a 24bpp mode on 32- and 64-bit little-endian machines.  Signed-off-by: Michal Januszewski <spock@gentoo.org> Acked-by: Krzysztof Helt <krzysztof.h1@wp.pl> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | atafb_utils.h | s | 10K | 361 | Michael Schmitz | schmitz@opal.biophys.uni-duesseldorf.de | 1178326745 |  | m68k: Atari fb revival  Update the atari fb to 2.6 by Michael Schmitz, Reformatting and rewrite of bit plane functions by Roman Zippel, A few more fixes by Geert Uytterhoeven.  Signed-off-by: Michael Schmitz <schmitz@debian.org> Signed-off-by: Roman Zippel <zippel@linux-m68k.org> Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | acornfb.c | s | 35K | 1212 | Laurent Pinchart | laurent.pinchart@ideasonboard.com | 1313742574 |  | acornfb: use display information in info not in var for panning  We must not use any information in the passed var besides xoffset, yoffset and vmode as otherwise applications might abuse it.  Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
f | carminefb.c | s | 22K | 668 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103893 |  | video: Add module.h to drivers/video files who really use it.  They were getting this implicitly by an include of module.h from device.h -- but we are going to clean that up and break that include chain, so include module.h explicitly now.  [ with contributions from Axel Lin <axel.lin@gmail.com> ]  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | s3c2410fb.h | s | 935B | 37 | Ben Dooks | ben@simtec.co.uk | 1245206879 |  | s3c-fb: CPUFREQ frequency scaling support  Add support for CPU frequency scaling in the S3C24XX video driver.  Signed-off-by: Simtec Linux Team <linux@simtec.co.uk> Signed-off-by: Ben Dooks <ben@simtec.co.uk> Cc: Dave Jones <davej@codemonkey.org.uk> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | au1100fb.h | s | 14K | 336 | Manuel Lauss | manuel.lauss@googlemail.com | 1317657158 |  | fb: fix au1100fb bitrot.  Removes some bitrot from the au1100fb driver and fix it up so it works again.  Signed-off-by: Manuel Lauss <manuel.lauss@googlemail.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | fb_defio.c | s | 6.3K | 202 | H Hartley Sweeten | hartleys@visionengravers.com | 1336496225 |  | video: fb_defio.c: local functions should not be exposed globally  Functions not referenced outside of a source file should be marked static to prevent them from being exposed globally.  Quiets the sparse warning:  warning: symbol 'fb_deferred_io_page' was not declared. Should it be static?  Signed-off-by: H Hartley Sweeten <hsweeten@visionengravers.com> Cc: Jaya Kumar <jayalk@intworks.biz> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
d | matrox |  | 20 items |  | Mark Brown | broonie@opensource.wolfsonmicro.com | 1338368134 |  | i2c: Split I2C_M_NOSTART support out of I2C_FUNC_PROTOCOL_MANGLING  Since there are uses for I2C_M_NOSTART which are much more sensible and standard than most of the protocol mangling functionality (the main one being gather writes to devices where something like a register address needs to be inserted before a block of data) create a new I2C_FUNC_NOSTART for this feature and update all the users to use it.  Also strengthen the disrecommendation of the protocol mangling while we're at it.  In the case of regmap-i2c we remove the requirement for mangling as I2C_M_NOSTART is the only mangling feature which is being used.  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Acked-by: Wolfram Sang <w.sang@pengutronix.de> Signed-off-by: Jean Delvare <khali@linux-fr.org>
f | chipsfb.c | s | 12K | 450 | Torben Hohn | torbenh@gmx.de | 1296003006 |  | console: rename acquire/release_console_sem() to console_lock/unlock()  The -rt patches change the console_semaphore to console_mutex.  As a result, a quite large chunk of the patches changes all acquire/release_console_sem() to acquire/release_console_mutex()  This commit makes things use more neutral function names which dont make implications about the underlying lock.  The only real change is the return value of console_trylock which is inverted from try_acquire_console_sem()  This patch also paves the way to switching console_sem from a semaphore to a mutex.  [akpm@linux-foundation.org: coding-style fixes] [akpm@linux-foundation.org: make console_trylock return 1 on success, per Geert] Signed-off-by: Torben Hohn <torbenh@gmx.de> Cc: Thomas Gleixner <tglx@tglx.de> Cc: Greg KH <gregkh@suse.de> Cc: Ingo Molnar <mingo@elte.hu> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | sunxvr2500.c | s | 6.0K | 219 | Tejun Heo | tj@kernel.org | 1269954152 |  | include cleanup: Update gfp.h and slab.h includes to prepare for breaking implicit slab.h inclusion from percpu.h  percpu.h is included by sched.h and module.h and thus ends up being included when building most .c files.  percpu.h includes slab.h which in turn includes gfp.h making everything defined by the two files universally available and complicating inclusion dependencies.  percpu.h -> slab.h dependency is about to be removed.  Prepare for this change by updating users of gfp and slab facilities include those headers directly instead of assuming availability.  As this conversion needs to touch large number of source files, the following script is used as the basis of conversion.    http://userweb.kernel.org/~tj/misc/slabh-sweep.py  The script does the followings.  * Scan files for gfp and slab usages and update includes such that   only the necessary includes are there.  ie. if only gfp is used,   gfp.h, if slab is used, slab.h.  * When the script inserts a new include, it looks at the include   blocks and try to put the new include such that its order conforms   to its surrounding.  It's put in the include block which contains   core kernel includes, in the same order that the rest are ordered -   alphabetical, Christmas tree, rev-Xmas-tree or at the end if there   doesn't seem to be any matching order.  * If the script can't find a place to put a new include (mostly   because the file doesn't have fitting include block), it prints out   an error message indicating which .h file needs to be added to the   file.  The conversion was done in the following steps.  1. The initial automatic conversion of all .c files updated slightly    over 4000 files, deleting around 700 includes and adding ~480 gfp.h    and ~3000 slab.h inclusions.  The script emitted errors for ~400    files.  2. Each error was manually checked.  Some didn't need the inclusion,    some needed manual addition while adding it to implementation .h or    embedding .c file was more appropriate for others.  This step added    inclusions to around 150 files.  3. The script was run again and the output was compared to the edits    from #2 to make sure no file was left behind.  4. Several build tests were done and a couple of problems were fixed.    e.g. lib/decompress_*.c used malloc/free() wrappers around slab    APIs requiring slab.h to be added manually.  5. The script was run on all .h files but without automatically    editing them as sprinkling gfp.h and slab.h inclusions around .h    files could easily lead to inclusion dependency hell.  Most gfp.h    inclusion directives were ignored as stuff from gfp.h was usually    wildly available and often used in preprocessor macros.  Each    slab.h inclusion directive was examined and added manually as    necessary.  6. percpu.h was updated not to include slab.h.  7. Build test were done on the following configurations and failures    were fixed.  CONFIG_GCOV_KERNEL was turned off for all tests (as my    distributed build env didn't work with gcov compiles) and a few    more options had to be turned off depending on archs to make things    build (like ipr on powerpc/64 which failed due to missing writeq).     * x86 and x86_64 UP and SMP allmodconfig and a custom test config.    * powerpc and powerpc64 SMP allmodconfig    * sparc and sparc64 SMP allmodconfig    * ia64 SMP allmodconfig    * s390 SMP allmodconfig    * alpha SMP allmodconfig    * um on x86_64 SMP allmodconfig  8. percpu.h modifications were reverted so that it could be applied as    a separate patch and serve as bisection point.  Given the fact that I had only a couple of failures from tests on step 6, I'm fairly confident about the coverage of this conversion patch. If there is a breakage, it's likely to be something in one of the arch headers which should be easily discoverable easily on most builds of the specific arch.  Signed-off-by: Tejun Heo <tj@kernel.org> Guess-its-ok-by: Christoph Lameter <cl@linux-foundation.org> Cc: Ingo Molnar <mingo@redhat.com> Cc: Lee Schermerhorn <Lee.Schermerhorn@hp.com>
f | ep93xx-fb.c | s | 17K | 544 | Julia Lawall | Julia.Lawall@lip6.fr | 1335044869 |  | drivers/video/ep93xx-fb.c: clean up error-handling code  There were two problems in this code: failure of the setup function should free locally allocated resources like other nearby failures, and the test if (&info->cmap) can never be false.  To generally clean things up, this patch reorders the error handling code at the failed label and adds labels so that the conditionals are not necessary.  Signed-off-by: Julia Lawall <Julia.Lawall@lip6.fr> Acked-by: H Hartley Sweeten <hsweeten@visionengravers.com> Reviewed-by: Ryan Mallon <rmallon@gmail.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | hecubafb.c | s | 7.5K | 261 | Pavel Shved | shved@ispras.ru | 1308902439 |  | hecubafb: add module_put on error path in hecubafb_probe()  In hecubafb_probe(), after a successful try_module_get, vzalloc may fail and make the hecubafb_probe return, but the module is not put on this error path.  This patch adds an exit point that calls module_put in such situation.  Found by Linux Driver Verification project (linuxtesting.org).  Signed-off-by: Pavel Shved <shved@ispras.ru> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
d | geode |  | 16 items |  | Randy Dunlap | randy.dunlap@oracle.com | 1308902431 |  | gx1fb: Fix section mismatch warnings  Fix a chain of section mismatches in geode driver, beginning with:  WARNING: drivers/video/geode/gx1fb.o(.data+0x70): Section mismatch in reference from the variable gx1fb_driver to the function .init.text:gx1fb_probe() The variable gx1fb_driver references the function __init gx1fb_probe() If the reference is valid then annotate the variable with __init* or __refdata (see linux/init.h) or name the variable: *_template, *_timer, *_sht, *_ops, *_probe, *_probe_one, *_console  Making the changes that Paul pointed out resulted in a few more changes being needed, so they are all included here.  Signed-off-by: Randy Dunlap <randy.dunlap@oracle.com> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | edid.h | s | 4.6K | 105 | Martin Decky | martin@decky.cz | 1300779903 |  | video: Fix EDID macros H_SYNC_WIDTH and H_SYNC_OFFSET  The macros for getting the values for horizontal sync width and offset do not respect the EDID specification. Both these values are 10 bit values according to [1], not 6 bit values. The lower 8 bits are stored in byte 8 and byte 9 of the DTD respectively, while two additional bits for each value are stored in byte 11. The original macros just slammed the bits together.  Although the original macros usually worked fine because the higher two bits are rarely used, it can cause severe problems on plasma panels running at 1920x1080 @ 50 Hz with drivers that rely on the correct parsing of the EDID data by fbmon.c (e.g. udlfb).  The patch should apply cleanly to both the fbdev-2.6.git branch and linux-next.git branch.  [1] VESA Enhanced Extended Display Identification Data Standard,      Release A, Revision 2, page 34, notes 7 & 8, VESA, Sep 2006  Signed-off-by: Martin Decky <martin@decky.cz> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | cyber2000fb.c | s | 47K | 1671 | David Howells | dhowells@redhat.com | 1332955803 |  | Remove all #inclusions of asm/system.h  Remove all #inclusions of asm/system.h preparatory to splitting and killing it.  Performed with the following command:  perl -p -i -e 's!^#\s*include\s*<asm/system[.]h>.*\n!!' `grep -Irl '^#\s*include\s*<asm/system[.]h>' *`  Signed-off-by: David Howells <dhowells@redhat.com>
f | g364fb.c | s | 6.8K | 225 | Laurent Pinchart | laurent.pinchart@ideasonboard.com | 1313742669 |  | g364fb: use display information in info not in var for panning  We must not use any information in the passed var besides xoffset, yoffset and vmode as otherwise applications might abuse it.  Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
f | pxa3xx-gcu.h | s | 890B | 26 | Daniel Mack | daniel@caiaq.de | 1292481078 |  | video: add driver for PXA3xx 2D graphics accelerator  This adds a driver for the the 2D graphics accelerator found on PXA3xx processors. Only resource mapping, interrupt handling and a simple ioctl handler is done by the kernel part, the rest of the logic is implemented in DirectFB userspace.  Graphic applications greatly benefit for line drawing, blend, and rectangle and triangle filling operations.  Benchmarks done on a PXA303 using the df_dok benchmarking tool follow, where the value in square brackets show the CPU usage during that test.  Without accelerator (benchmarking 256x252 on 480x262 RGB16 (16bit)):    Anti-aliased Text                              3.016 secs (   65.649 KChars/sec) [ 99.6%]   Fill Rectangle                                 3.021 secs (  175.107 MPixel/sec) [ 98.0%]   Fill Rectangle (blend)                         3.582 secs (    3.602 MPixel/sec) [ 99.7%]   Fill Rectangles [10]                           3.177 secs (  182.753 MPixel/sec) [ 98.1%]   Fill Rectangles [10] (blend)                  18.020 secs (    3.580 MPixel/sec) [ 98.7%]   Fill Spans                                     3.019 secs (  145.306 MPixel/sec) [ 98.0%]   Fill Spans (blend)                             3.616 secs (    3.568 MPixel/sec) [ 99.4%]   Blit                                           3.074 secs (   39.874 MPixel/sec) [ 98.0%]   Blit 180                                       3.020 secs (   32.042 MPixel/sec) [ 98.0%]   Blit with format conversion                    3.005 secs (   19.321 MPixel/sec) [ 99.6%]   Blit from 32bit (blend)                        4.792 secs (    2.692 MPixel/sec) [ 98.7%]  With accelerator:    Anti-aliased Text                              3.056 secs (*  36.518 KChars/sec) [ 21.3%]   Fill Rectangle                                 3.015 secs (* 115.543 MPixel/sec) [  8.9%]   Fill Rectangle (blend)                         3.180 secs (*  20.286 MPixel/sec) [  1.8%]   Fill Rectangles [10]                           3.251 secs (* 119.062 MPixel/sec) [  1.2%]   Fill Rectangles [10] (blend)                   6.293 secs (*  20.502 MPixel/sec) [  0.3%]   Fill Spans                                     3.051 secs (*  97.264 MPixel/sec) [ 35.7%]   Fill Spans (blend)                             3.377 secs (*  15.282 MPixel/sec) [ 17.8%]   Blit                                           3.046 secs (*  27.533 MPixel/sec) [  2.6%]   Blit 180                                       3.098 secs (*  27.070 MPixel/sec) [  2.2%]   Blit with format conversion                    3.131 secs (*  39.148 MPixel/sec) [  2.8%]   Blit from 32bit (blend)                        3.346 secs (*  11.568 MPixel/sec) [  0.8%]  Signed-off-by: Daniel Mack <daniel@caiaq.de> Tested-by: Sven Neumann <s.neumann@raumfeld.com> Cc: Eric Miao <eric.y.miao@gmail.com> Cc: Denis Oliver Kropp <dok@directfb.org> Cc: Sven Neumann <s.neumann@raumfeld.com> Cc: Haojian Zhuang <haojian.zhuang@gmail.com> Signed-off-by: Eric Miao <eric.y.miao@gmail.com>
f | atafb_mfb.c | s | 2.5K | 94 | Michael Schmitz | schmitz@opal.biophys.uni-duesseldorf.de | 1178326745 |  | m68k: Atari fb revival  Update the atari fb to 2.6 by Michael Schmitz, Reformatting and rewrite of bit plane functions by Roman Zippel, A few more fixes by Geert Uytterhoeven.  Signed-off-by: Michael Schmitz <schmitz@debian.org> Signed-off-by: Roman Zippel <zippel@linux-m68k.org> Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
d | intelfb |  | 6 items |  | Julia Lawall | Julia.Lawall@lip6.fr | 1336914324 |  | drivers/video/intelfb/intelfbdrv.c: add missing agp_backend_release  Release bridge, as done on all other paths out of the function.  Signed-off-by: Julia Lawall <Julia.Lawall@lip6.fr> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | bf54x-lq043fb.c | s | 18K | 617 | Jingoo Han | jg1.han@samsung.com | 1327783811 |  | video: use gpio_request_one  Using gpio_request_one can make the code simpler because it can set the direction and initial value in one shot.  Signed-off-by: Jingoo Han <jg1.han@samsung.com> Acked-by: Tomi Valkeinen <tomi.valkeinen@ti.com> Cc: Michael Hennerich <michael.hennerich@analog.com> Cc: Pavel Machek <pavel@ucw.cz> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | amba-clcd.c | s | 14K | 542 | Dave Martin | dave.martin@linaro.org | 1321959513 |  | fbdev: amba: Enable module alias autogeneration for AMBA drivers  Signed-off-by: Dave Martin <dave.martin@linaro.org>
f | gbefb.c | s | 32K | 1141 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
d | sis |  | 18 items |  | Peter Huewe | peterhuewe@gmx.de | 1336496307 |  | video/sis: Annotate SiS_DRAMType as __devinitconst  SiS_DRAMType is const and only used by sisfb_post_300_rwtest which is marked __devinit we can annotate SiS_DRAMType with __devinitconst and move it into the file scope in order to not have it created on the stack. This patch decreases the compiled module size by about 100bytes.  And since hardcoded values are bad we use ARRAY_SIZE for determining the size of SiS_DRAMType ;)  Signed-off-by: Peter Huewe <peterhuewe@gmx.de> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | pxa3xx-gcu.c | s | 17K | 597 | Axel Lin | axel.lin@gmail.com | 1333988295 |  | video: pxa3xx-gcu: Simplify the logic to exit while loop in pxa3xx_gcu_wait_idle  If wait_event_interruptible_timeout returns a positive value, it means the condition evaluated is true. Which means priv->shared->hw_running is false. And then we will exit the loop.  This patch simplifies the logic to exit the while loop.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | cg6.c | s | 21K | 758 | axel lin | axel.lin@gmail.com | 1300779344 |  | video: add missing framebuffer_release in error path  This patch fixes a memory leak in the error path.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: David S. Miller <davem@davemloft.net> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | atafb_iplan2p8.c | s | 8.2K | 301 | Michael Schmitz | schmitz@opal.biophys.uni-duesseldorf.de | 1178326745 |  | m68k: Atari fb revival  Update the atari fb to 2.6 by Michael Schmitz, Reformatting and rewrite of bit plane functions by Roman Zippel, A few more fixes by Geert Uytterhoeven.  Signed-off-by: Michael Schmitz <schmitz@debian.org> Signed-off-by: Roman Zippel <zippel@linux-m68k.org> Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | s3c-fb.c | s | 51K | 1750 | Jingoo Han | jg1.han@samsung.com | 1339608856 |  | video: s3c-fb: fix possible division by zero in s3c_fb_calc_pixclk  Divider value can be zero and it makes division by zero from debug message in s3c_fb_calc_pixclk; therefore, it should be fixed.  Signed-off-by: Jingoo Han <jg1.han@samsung.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | pxa168fb.c | s | 20K | 710 | Julia Lawall | Julia.Lawall@lip6.fr | 1330044599 |  | drivers/video/pxa168fb.c: use devm_ functions  The various devm_ functions allocate memory that is released when a driver detaches.  This patch uses these functions for data that is allocated in the probe function of a platform device and is only freed in the remove function.  By using devm_ioremap, it also removes a potential memory leak, because there was no call to iounmap in the probe function.  Signed-off-by: Julia Lawall <Julia.Lawall@lip6.fr> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | sbuslib.h | s | 804B | 23 | Robert Reif | reif@earthlink.net | 1210307850 |  | sparc video: remove open boot prom code  Replace remaining open boot prom code with of.  Boot tested on sparc32 and compile tested on sparc64.  Signed-off-by: Robert Reif <reif@earthlink.net> Signed-off-by: David S. Miller <davem@davemloft.net>
f | c2p_iplan2.c | s | 3.5K | 131 | Geert Uytterhoeven | geert@linux-m68k.org | 1231790191 |  | fbdev: c2p/atafb - Add support for Atari interleaved bitplanes  The c2p() for normal bitplanes is not suitable for interleaved bitplanes with 2 bytes of interleave, causing a garbled penguin logo. Add c2p_iplan2().  Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
f | cirrusfb.c | s | 76K | 2583 | Linus Torvalds | torvalds@linux-foundation.org | 1326582679 |  | Merge branch 'fbdev-next' of git://github.com/schandinat/linux-2.6  * 'fbdev-next' of git://github.com/schandinat/linux-2.6: (175 commits)   module_param: make bool parameters really bool (drivers/video/i810)   Revert "atmel_lcdfb: Adjust HFP calculation so it matches the manual."   OMAPDSS: HDMI: Disable DDC internal pull up   OMAPDSS: HDMI: Move duplicate code from boardfile   OMAPDSS: add OrtusTech COM43H4M10XTC display support   OMAP: DSS2: Support for UMSH-8173MD TFT panel   ASoC: OMAP: HDMI: Move HDMI codec trigger function to generic HDMI driver   OMAPDSS: HDMI: Create function to enable HDMI audio   ASoC: OMAP: HDMI: Correct signature of ASoC functions   ASoC: OMAP: HDMI: Introduce driver data for audio codec   grvga: fix section mismatch warnings   video: s3c-fb: Don't keep device runtime active when open   video: s3c-fb: Hold runtime PM references when touching registers   video: s3c-fb: Take a runtime PM reference when unblanked   video: s3c-fb: Disable runtime PM in error paths from probe   video: s3c-fb: Use s3c_fb_enable() to enable the framebuffer   video: s3c-fb: Make runtime PM functional again   drivers/video: fsl-diu-fb: merge fsl_diu_alloc() into map_video_memory()   drivers/video: fsl-diu-fb: add default platform ops functions   drivers/video: fsl-diu-fb: remove broken reference count enabling the display   ...
f | broadsheetfb.c | s | 28K | 980 | Arnd Bergmann | arnd@arndb.de | 1339246271 |  | drivers/video: use correct __devexit_p annotation  __devexit functions are discarded when CONFIG_HOTPLUG is not set, so the symbol needs to be referenced carefully.  Signed-off-by: Arnd Bergmann <arnd@arndb.de> Signed-off-by: Mathieu Poirier <mathieu.poirier@linaro.org> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | valkyriefb.h | s | 5.4K | 183 | Finn Thain | fthain@telegraphics.com.au | 1267291873 |  | valkyriefb: various fixes  Valkyriefb and macfb will adopt the same card if they get the chance, so remove valkyrie support from macfb. Also fix the "valkyriefb: can't do 832x624x8" problem reported by Raylynn Knight some time ago, by adding vmode 13 support for CONFIG_MAC. Also add vmode 11 since that works too. Make use of the monitor sense lines on 68k Macs too. Also some cleanups.  Signed-off-by: Finn Thain <fthain@telegraphics.com.au> Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
f | auo_k1901fb.c | s | 6.6K | 210 | Heiko Stübner | heiko@sntech.de | 1335728142 |  | video: auo_k190x: add driver for AUO-K1901 variant  This controller not only supports higher resolutions than the K1900 but concurrent updates as well. This results in a generally higher display speed.  Signed-off-by: Heiko Stübner <heiko@sntech.de> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | sh_mobile_meram.c | s | 19K | 603 | Laurent Pinchart | laurent.pinchart@ideasonboard.com | 1331588474 |  | fbdev: sh_mobile_meram: Implement system suspend/resume  Supporting runtime PM is very nice, but that's not a reason not to implement system suspend/resume properly.  Reported-by: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
f | w100fb.c | s | 47K | 1348 | Axel Lin | axel.lin@gmail.com | 1322950122 |  | video: convert drivers/video/* to use module_platform_driver()  This patch converts the drivers in drivers/video/* to use the module_platform_driver() macro which makes the code smaller and a bit simpler.  Cc: Ben Dooks <ben@simtec.co.uk> Cc: Manuel Lauss <mano@roarinelk.homelinux.net> Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: Wan ZongShun <mcuos.com@gmail.com> Acked-by: Sascha Hauer <s.hauer@pengutronix.de> Acked-by: Lennert Buytenhek <buytenh@wantstofly.org> Acked-by: Alexey Charkov <alchark@gmail.com> Acked-by: Damian Hobson-Garcia <dhobsong@igel.co.jp> Acked-by: Jingoo Han <jg1.han@samsung.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
