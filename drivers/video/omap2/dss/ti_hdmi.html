<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › video › omap2 › dss › ti_hdmi.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>ti_hdmi.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * ti_hdmi.h</span>
<span class="cm"> *</span>
<span class="cm"> * HDMI driver definition for TI OMAP4, DM81xx, DM38xx  Processor.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 2010-2011 Texas Instruments Incorporated - http://www.ti.com/</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify it</span>
<span class="cm"> * under the terms of the GNU General Public License version 2 as published by</span>
<span class="cm"> * the Free Software Foundation.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful, but WITHOUT</span>
<span class="cm"> * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span>
<span class="cm"> * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for</span>
<span class="cm"> * more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License along with</span>
<span class="cm"> * this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _TI_HDMI_H</span>
<span class="cp">#define _TI_HDMI_H</span>

<span class="k">struct</span> <span class="n">hdmi_ip_data</span><span class="p">;</span>

<span class="k">enum</span> <span class="n">hdmi_pll_pwr</span> <span class="p">{</span>
	<span class="n">HDMI_PLLPWRCMD_ALLOFF</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">HDMI_PLLPWRCMD_PLLONLY</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">HDMI_PLLPWRCMD_BOTHON_ALLCLKS</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">HDMI_PLLPWRCMD_BOTHON_NOPHYCLK</span> <span class="o">=</span> <span class="mi">3</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">hdmi_core_hdmi_dvi</span> <span class="p">{</span>
	<span class="n">HDMI_DVI</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">HDMI_HDMI</span> <span class="o">=</span> <span class="mi">1</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">hdmi_clk_refsel</span> <span class="p">{</span>
	<span class="n">HDMI_REFSEL_PCLK</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">HDMI_REFSEL_REF1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">HDMI_REFSEL_REF2</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">HDMI_REFSEL_SYSCLK</span> <span class="o">=</span> <span class="mi">3</span>
<span class="p">};</span>

<span class="cm">/* HDMI timing structure */</span>
<span class="k">struct</span> <span class="n">hdmi_video_timings</span> <span class="p">{</span>
	<span class="n">u16</span> <span class="n">x_res</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">y_res</span><span class="p">;</span>
	<span class="cm">/* Unit: KHz */</span>
	<span class="n">u32</span> <span class="n">pixel_clock</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">hsw</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">hfp</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">hbp</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">vsw</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">vfp</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">vbp</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">vsync_pol</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">hsync_pol</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">interlace</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">hdmi_cm</span> <span class="p">{</span>
	<span class="kt">int</span>	<span class="n">code</span><span class="p">;</span>
	<span class="kt">int</span>	<span class="n">mode</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">hdmi_config</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">hdmi_video_timings</span> <span class="n">timings</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hdmi_cm</span> <span class="n">cm</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* HDMI PLL structure */</span>
<span class="k">struct</span> <span class="n">hdmi_pll_info</span> <span class="p">{</span>
	<span class="n">u16</span> <span class="n">regn</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">regm</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">regmf</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">regm2</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">regsd</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">dcofreq</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">hdmi_clk_refsel</span> <span class="n">refsel</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ti_hdmi_ip_ops</span> <span class="p">{</span>

	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">video_configure</span><span class="p">)(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">);</span>

	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">phy_enable</span><span class="p">)(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">);</span>

	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">phy_disable</span><span class="p">)(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">);</span>

	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">read_edid</span><span class="p">)(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">edid</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">);</span>

	<span class="n">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">detect</span><span class="p">)(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">);</span>

	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">pll_enable</span><span class="p">)(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">);</span>

	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">pll_disable</span><span class="p">)(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">);</span>

	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">video_enable</span><span class="p">)(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">);</span>

	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">video_disable</span><span class="p">)(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">);</span>

	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">dump_wrapper</span><span class="p">)(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">,</span> <span class="k">struct</span> <span class="n">seq_file</span> <span class="o">*</span><span class="n">s</span><span class="p">);</span>

	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">dump_core</span><span class="p">)(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">,</span> <span class="k">struct</span> <span class="n">seq_file</span> <span class="o">*</span><span class="n">s</span><span class="p">);</span>

	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">dump_pll</span><span class="p">)(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">,</span> <span class="k">struct</span> <span class="n">seq_file</span> <span class="o">*</span><span class="n">s</span><span class="p">);</span>

	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">dump_phy</span><span class="p">)(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">,</span> <span class="k">struct</span> <span class="n">seq_file</span> <span class="o">*</span><span class="n">s</span><span class="p">);</span>

<span class="cp">#if defined(CONFIG_OMAP4_DSS_HDMI_AUDIO)</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">audio_enable</span><span class="p">)(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">);</span>

	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">audio_disable</span><span class="p">)(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">);</span>

	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">audio_start</span><span class="p">)(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">);</span>

	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">audio_stop</span><span class="p">)(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">);</span>

	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">audio_config</span><span class="p">)(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">omap_dss_audio</span> <span class="o">*</span><span class="n">audio</span><span class="p">);</span>
<span class="cp">#endif</span>

<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Refer to section 8.2 in HDMI 1.3 specification for</span>
<span class="cm"> * details about infoframe databytes</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">hdmi_core_infoframe_avi</span> <span class="p">{</span>
	<span class="cm">/* Y0, Y1 rgb,yCbCr */</span>
	<span class="n">u8</span>	<span class="n">db1_format</span><span class="p">;</span>
	<span class="cm">/* A0  Active information Present */</span>
	<span class="n">u8</span>	<span class="n">db1_active_info</span><span class="p">;</span>
	<span class="cm">/* B0, B1 Bar info data valid */</span>
	<span class="n">u8</span>	<span class="n">db1_bar_info_dv</span><span class="p">;</span>
	<span class="cm">/* S0, S1 scan information */</span>
	<span class="n">u8</span>	<span class="n">db1_scan_info</span><span class="p">;</span>
	<span class="cm">/* C0, C1 colorimetry */</span>
	<span class="n">u8</span>	<span class="n">db2_colorimetry</span><span class="p">;</span>
	<span class="cm">/* M0, M1 Aspect ratio (4:3, 16:9) */</span>
	<span class="n">u8</span>	<span class="n">db2_aspect_ratio</span><span class="p">;</span>
	<span class="cm">/* R0...R3 Active format aspect ratio */</span>
	<span class="n">u8</span>	<span class="n">db2_active_fmt_ar</span><span class="p">;</span>
	<span class="cm">/* ITC IT content. */</span>
	<span class="n">u8</span>	<span class="n">db3_itc</span><span class="p">;</span>
	<span class="cm">/* EC0, EC1, EC2 Extended colorimetry */</span>
	<span class="n">u8</span>	<span class="n">db3_ec</span><span class="p">;</span>
	<span class="cm">/* Q1, Q0 Quantization range */</span>
	<span class="n">u8</span>	<span class="n">db3_q_range</span><span class="p">;</span>
	<span class="cm">/* SC1, SC0 Non-uniform picture scaling */</span>
	<span class="n">u8</span>	<span class="n">db3_nup_scaling</span><span class="p">;</span>
	<span class="cm">/* VIC0..6 Video format identification */</span>
	<span class="n">u8</span>	<span class="n">db4_videocode</span><span class="p">;</span>
	<span class="cm">/* PR0..PR3 Pixel repetition factor */</span>
	<span class="n">u8</span>	<span class="n">db5_pixel_repeat</span><span class="p">;</span>
	<span class="cm">/* Line number end of top bar */</span>
	<span class="n">u16</span>	<span class="n">db6_7_line_eoftop</span><span class="p">;</span>
	<span class="cm">/* Line number start of bottom bar */</span>
	<span class="n">u16</span>	<span class="n">db8_9_line_sofbottom</span><span class="p">;</span>
	<span class="cm">/* Pixel number end of left bar */</span>
	<span class="n">u16</span>	<span class="n">db10_11_pixel_eofleft</span><span class="p">;</span>
	<span class="cm">/* Pixel number start of right bar */</span>
	<span class="n">u16</span>	<span class="n">db12_13_pixel_sofright</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="p">{</span>
	<span class="kt">void</span> <span class="n">__iomem</span>	<span class="o">*</span><span class="n">base_wp</span><span class="p">;</span>	<span class="cm">/* HDMI wrapper */</span>
	<span class="kt">unsigned</span> <span class="kt">long</span>	<span class="n">core_sys_offset</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span>	<span class="n">core_av_offset</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span>	<span class="n">pll_offset</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span>	<span class="n">phy_offset</span><span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">ti_hdmi_ip_ops</span> <span class="o">*</span><span class="n">ops</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hdmi_config</span> <span class="n">cfg</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hdmi_pll_info</span> <span class="n">pll_data</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hdmi_core_infoframe_avi</span> <span class="n">avi_cfg</span><span class="p">;</span>

	<span class="cm">/* ti_hdmi_4xxx_ip private data. These should be in a separate struct */</span>
	<span class="kt">int</span> <span class="n">hpd_gpio</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">phy_tx_enabled</span><span class="p">;</span>
<span class="p">};</span>
<span class="kt">int</span> <span class="n">ti_hdmi_4xxx_phy_enable</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ti_hdmi_4xxx_phy_disable</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ti_hdmi_4xxx_read_edid</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">edid</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">);</span>
<span class="n">bool</span> <span class="n">ti_hdmi_4xxx_detect</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ti_hdmi_4xxx_wp_video_start</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ti_hdmi_4xxx_wp_video_stop</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ti_hdmi_4xxx_pll_enable</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ti_hdmi_4xxx_pll_disable</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ti_hdmi_4xxx_basic_configure</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ti_hdmi_4xxx_wp_dump</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">,</span> <span class="k">struct</span> <span class="n">seq_file</span> <span class="o">*</span><span class="n">s</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ti_hdmi_4xxx_pll_dump</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">,</span> <span class="k">struct</span> <span class="n">seq_file</span> <span class="o">*</span><span class="n">s</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ti_hdmi_4xxx_core_dump</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">,</span> <span class="k">struct</span> <span class="n">seq_file</span> <span class="o">*</span><span class="n">s</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ti_hdmi_4xxx_phy_dump</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">,</span> <span class="k">struct</span> <span class="n">seq_file</span> <span class="o">*</span><span class="n">s</span><span class="p">);</span>
<span class="cp">#if defined(CONFIG_OMAP4_DSS_HDMI_AUDIO)</span>
<span class="kt">int</span> <span class="n">hdmi_compute_acr</span><span class="p">(</span><span class="n">u32</span> <span class="n">sample_freq</span><span class="p">,</span> <span class="n">u32</span> <span class="o">*</span><span class="n">n</span><span class="p">,</span> <span class="n">u32</span> <span class="o">*</span><span class="n">cts</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ti_hdmi_4xxx_wp_audio_enable</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ti_hdmi_4xxx_wp_audio_disable</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ti_hdmi_4xxx_audio_start</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ti_hdmi_4xxx_audio_stop</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ti_hdmi_4xxx_audio_config</span><span class="p">(</span><span class="k">struct</span> <span class="n">hdmi_ip_data</span> <span class="o">*</span><span class="n">ip_data</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">omap_dss_audio</span> <span class="o">*</span><span class="n">audio</span><span class="p">);</span>
<span class="cp">#endif</span>
<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
