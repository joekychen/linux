f | pxa.c | s | 21K | 771 | Linus Torvalds | torvalds@linux-foundation.org | 1332892055 |  | 
f | Makefile | g | 3.3K |  | Greg Kroah-Hartman | gregkh@linuxfoundation.org | 1328898327 |  | Merge tag 'tty-3.3-rc3' tty-next  This is needed to handle the 8250 file merge mess properly for future patches.  Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | kgdboc.c | s | 7.2K | 273 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103887 |  | tty: Add module.h to drivers/tty users who just expect it there.  We are cleaning up the issue that means module.h is omnipresent. These tty users are the people who implictly are relying on that. Fix up the real users to call out the include that they really need.  In the case of jsm_driver.c file, it had moduleparam.h but that isn't enough and it needs the full module.h  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | ar933x_uart.c | s | 15K | 540 | Gabor Juhos | juhosg@openwrt.org | 1323295366 |  | SERIAL: AR933X: Add driver for the built-in UART of the SoC  This patch adds the driver for the built-in UART of the Atheros AR933X SoCs.  Signed-off-by: Gabor Juhos <juhosg@openwrt.org> Cc: linux-mips@linux-mips.org Cc: Kathy Giori <kgiori@qca.qualcomm.com> Cc: "Luis R.  Rodriguez" <rodrigue@qca.qualcomm.com> Cc: Alan Cox <alan@lxorguk.ukuu.org.uk> Cc: linux-serial@vger.kernel.org Patchwork: https://patchwork.linux-mips.org/patch/2526/ Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Ralf Baechle <ralf@linux-mips.org>
f | ifx6x60.c | s | 36K | 1263 | Jiri Slaby | jslaby@suse.cz | 1331235478 |  | TTY: remove re-assignments to tty_driver members  All num, magic and owner are set by alloc_tty_driver. No need to re-set them on each allocation site.  pti driver sets something different to what it passes to alloc_tty_driver. It is not a bug, since we don't use the lines parameter in any way. Anyway this is fixed, and now we do the right thing.  Signed-off-by: Jiri Slaby <jslaby@suse.cz> Acked-by: Tilman Schmidt <tilman@imap.cc> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | altera_jtaguart.c | s | 13K | 424 | Linus Torvalds | torvalds@linux-foundation.org | 1319697341 |  | Merge branch 'devicetree/next' of git://git.secretlab.ca/git/linux-2.6  * 'devicetree/next' of git://git.secretlab.ca/git/linux-2.6:   of_mdio: Don't phy_scan_fixups() twice   Devicetree: Expand on ARM Primecell binding documentation   dt: Add empty of_match_node() macro   dt: add empty dt helpers for non-dt build   devicetree: fix build error on drivers/tty/serial/altera_jtaguart.c   devicetree: Add ARM pl022 spi controller binding doc   devicetree: Add ARM pl061 gpio controller binding doc   of/irq: of_irq_find_parent: check for parent equal to child   MAINTAINERS: update devicetree maintainers   dt: add helper to read 64-bit integers   tty: use of_match_ptr() for of_match_table entry   OF: Add of_match_ptr() macro   dt: add empty for_each_child_of_node, of_find_property   devicetree: Document Qualcomm and Atmel prefixes   serial/imx: add of_alias_get_id() reference back   dt: add of_alias_scan and of_alias_get_id   devicetree: Add a registry of vendor prefixes
f | max3107.h | s | 17K | 386 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | icom.h | s | 9.5K | 272 | Greg Kroah-Hartman | gregkh@suse.de | 1294949418 |  | tty: move drivers/serial/ to drivers/tty/serial/  The serial drivers are really just tty drivers, so move them to drivers/tty/ to make things a bit neater overall.  This is part of the tty/serial driver movement proceedure as proposed by Arnd Bergmann and approved by everyone involved a number of months ago.  Cc: Arnd Bergmann <arnd@arndb.de> Cc: Alan Cox <alan@lxorguk.ukuu.org.uk> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: Rogier Wolff <R.E.Wolff@bitwizard.nl> Cc: Michael H. Warfield <mhw@wittsend.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | omap-serial.c | s | 46K | 1482 | Greg Kroah-Hartman | gregkh@linuxfoundation.org | 1334789851 |  | Merge 3.4-rc3 into tty-next  This allows us to pick up some changes needed for other serial patches.  Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | bfin_uart.c | s | 39K | 1344 | Sonic Zhang | sonic.zhang@analog.com | 1337286356 |  | serial: bfin_uart: Make MMR access compatible with 32 bits bf609 style controller.  Simplify serial data width calculation and adapt to bf609 LCR bit mask.  Signed-off-by: Sonic Zhang <sonic.zhang@analog.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | lantiq.c | s | 18K | 663 | John Crispin | blogic@openwrt.org | 1337607114 |  | SERIAL: MIPS: lantiq: implement OF support  Add devicetree and handling for our new clkdev clocks. The patch is rather straightforward. .of_match_table is set and the 3 irqs are now loaded from the devicetree.  This series converts the lantiq target to clkdev amongst other things. The driver needs to handle two clocks now. The fpi bus clock used to derive the divider and the clock gate needed on some socs to make the secondary port work.  Signed-off-by: John Crispin <blogic@openwrt.org> Acked-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org> Cc: Alan Cox <alan@linux.intel.com> Cc: linux-serial@vger.kernel.org Cc: linux-mips@linux-mips.org Patchwork: https://patchwork.linux-mips.org/patch/3809/ Signed-off-by: Ralf Baechle <ralf@linux-mips.org>
f | sirfsoc_uart.c | s | 21K | 708 | Stephen Warren | swarren@nvidia.com | 1330942979 |  | pinctrl: API changes to support multiple states per device  The API model is changed from:  p = pinctrl_get(dev, "state1"); pinctrl_enable(p); ... pinctrl_disable(p); pinctrl_put(p); p = pinctrl_get(dev, "state2"); pinctrl_enable(p); ... pinctrl_disable(p); pinctrl_put(p);  to this:  p = pinctrl_get(dev); s1 = pinctrl_lookup_state(p, "state1"); s2 = pinctrl_lookup_state(p, "state2"); pinctrl_select_state(p, s1); ... pinctrl_select_state(p, s2); ... pinctrl_put(p);  This allows devices to directly transition between states without disabling the pin controller programming and put()/get()ing the configuration data each time. This model will also better suit pinconf programming, which doesn't have a concept of "disable".  The special-case hogging feature of pin controllers is re-written to use the regular APIs instead of special-case code. Hence, the pinmux-hogs debugfs file is removed; see the top-level pinctrl-handles files for equivalent data.  Signed-off-by: Stephen Warren <swarren@nvidia.com> Acked-by: Dong Aisheng <dong.aisheng@linaro.org> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | serial_core.c | s | 63K | 2187 | Greg Kroah-Hartman | gregkh@linuxfoundation.org | 1337100262 |  | Revert "serial_core: Update buffer overrun statistics."  This reverts commit 642180871bc91afebb6ccf40d1615a7dd33699a3.  Buffer overruns are for hardware reported overruns, not software ones, which will only happen if we run out of memory and you will get lots of -ENOMEM errors at the same time.  Thanks to Alan Cox for catching this.  Reported-by: Alan Cox <alan@linux.intel.com> Cc: Corbin Atkinson <corbinat@gmail.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | samsung.c | s | 41K | 1386 | Kukjin Kim | kgene.kim@samsung.com | 1333992639 |  | serial: samsung: fix omission initialize ulcon in reset port fn()  Fix omission initialize ulcon in s3c24xx_serial_resetport(), reset port function in drivers/tty/serial/samsung.c. It has been happened from commit 0dfb3b41("serial: samsung: merge all SoC specific port reset functions")  Signed-off-by: Kukjin Kim <kgene.kim@samsung.com> Cc: stable <stable@vger.kernel.org> [3.3] Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | mcf.c | s | 17K | 526 | Yong Zhang | yong.zhang0@gmail.com | 1316732937 |  | TTY: irq: Remove IRQF_DISABLED  Since commit [e58aa3d2: genirq: Run irq handlers with interrupts disabled], We run all interrupt handlers with interrupts disabled and we even check and yell when an interrupt handler returns with interrupts enabled (see commit [b738a50a: genirq: Warn when handler enables interrupts]).  So now this flag is a NOOP and can be removed.  Signed-off-by: Yong Zhang <yong.zhang0@gmail.com> Acked-by: Tobias Klauser <tklauser@distanz.ch> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | ioc3_serial.c | s | 57K | 1906 | Jiri Slaby | jslaby@suse.cz | 1316731766 |  | TTY: serial, fix includes in some drivers  linux/tty_flip.h is included in linux/serial_core.h. But this may (and will) change in the future. Then we would get build errors such as: .../tty/serial/max3107.c: In function ‘put_data_to_circ_buf’: .../tty/serial/max3107.c:149:2: error: implicit declaration of function ‘tty_insert_flip_string’  So fix all the drviers which call tty flip buffer helpers to really include linux/tty_flip.h. And also make sure that those include linux/tty.h when operating with struct tty_struct.  Signed-off-by: Jiri Slaby <jslaby@suse.cz> Cc: Alan Cox <alan@linux.intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | atmel_serial.c | s | 47K | 1600 | Siftar, Gabe | Gabe.Siftar@getingeusa.com | 1333992639 |  | tty/serial: atmel_serial: fix RS485 half-duplex problem  On our custom board, we are using RS485 in half-duplex mode on an AT91SAM9G45. SER_RS485_RX_DURING_TX is not set as we do not want to receive the data we transmit (our transceiver will receive transmitted data). Although the current driver attempts to disable and enable the receiver at the appropriate points, incoming data is still loaded into the receive register causing our code to receive the very last byte that was sent once the receiver is enabled.  I ran this by Atmel support and they wrote: "The issue comes from the fact that you disable the PDC/DMA Reception and not the USART Reception channel. In your case, the[n] you will still receive data into the USART_RHR register, and maybe you [h]ave the overrun flag set. So please disable the USART reception channel."  The following patch should force the driver to enable/disable the receiver via RXEN/RXDIS fields of the USART control register. It fixed the issue I was having.  Signed-off-by: Gabe Siftar <gabe.siftar@getingeusa.com> [nicolas.ferre@atmel.com: slightly modify commit message] Signed-off-by: Nicolas Ferre <nicolas.ferre@atmel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | of_serial.c | s | 5.8K | 208 | Dan Williams | dan.j.williams@intel.com | 1334786873 |  | tegra, serial8250: add ->handle_break() uart_port op  The "KT" serial port has another use case for a "received break" quirk, so before adding another special case to the 8250 core take this opportunity to push such quirks out of the core and into a uart_port op.  Stephen says: "If the callback function is to no longer live in 8250.c itself,  arch/arm/mach-tegra/devices.c isn't logically a good place to put it,  and that file will be going away once we get rid of all the board files  and move solely to device tree."  ...so since 8250_pci.c houses all the quirks for pci serial devices this quirk is similarly housed in of_serial.c.  Once the open firmware conversion completes the infrastructure details (include/linux/of_serial.h, and the export) can all be removed to make this self contained to of_serial.c.  Cc: Nhan H Mai <nhan.h.mai@intel.com> Cc: Colin Cross <ccross@android.com> Cc: Olof Johansson <olof@lixom.net> [stephen: kill CONFIG_SERIAL_TEGRA in favor just using CONFIG_ARCH_TEGRA] Cc: Grant Likely <grant.likely@secretlab.ca> Acked-by: Arnd Bergmann <arnd@arndb.de> Acked-by: Sudhakar Mamillapalli <sudhakar@fb.com> Reported-by: Alan Cox <alan@lxorguk.ukuu.org.uk> Acked-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dan Williams <dan.j.williams@intel.com> Acked-by: Stephen Warren <swarren@wwwdotorg.org> Tested-by: Stephen Warren <swarren@wwwdotorg.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | nwpserial.c | s | 11K | 393 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103888 |  | tty: Add export.h for EXPORT_SYMBOL/THIS_MODULE to exporters  With module.h being implicitly everywhere via device.h, the absence of explicitly including something for EXPORT_SYMBOL went unnoticed. Since we are heading to fix things up and clean module.h from the device.h file, we need to explicitly include these files now.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | efm32-uart.c | s | 20K | 674 | Uwe Kleine-König | u.kleine-koenig@pengutronix.de | 1327606187 |  | serial/efm32: add new driver  Signed-off-by: Uwe Kleine-König <u.kleine-koenig@pengutronix.de> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | sb1250-duart.c | s | 24K | 792 | Paul Gortmaker | paul.gortmaker@windriver.com | 1337096930 |  | SERIAL: MIPS Swarm sb1250-duart.c driver needs module.h  This driver is a module and needs module.h, otherwise it will break when we remove a bogus usage of module.h from one of the other MIPS headers.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com> Cc: linux-mips@linux-mips.org Patchwork: https://patchwork.linux-mips.org/patch/3447/ Signed-off-by: Ralf Baechle <ralf@linux-mips.org>
f | xilinx_uartps.c | s | 30K | 966 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103887 |  | tty: Add module.h to drivers/tty users who just expect it there.  We are cleaning up the issue that means module.h is omnipresent. These tty users are the people who implictly are relying on that. Fix up the real users to call out the include that they really need.  In the case of jsm_driver.c file, it had moduleparam.h but that isn't enough and it needs the full module.h  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | pmac_zilog.h | s | 12K | 320 | Benjamin Herrenschmidt | benh@kernel.crashing.org | 1323994201 |  | tty/serial/pmac_zilog: Fix suspend & resume  This patch reworks & simplifies pmac_zilog handling of suspend/resume, essentially removing all the specific code in there and using the generic uart helpers.  This required properly registering the tty as a child of the macio (or platform) device, so I had to delay the registration a bit (we used to register the ports very very early). We still register the kernel console early though.  I removed a couple of unused or useless flags as well, relying on the core to not call us when asleep. I also removed the essentially useless interrupt mutex, simplifying the locking a bit.  I removed some code for handling unexpected interrupt which should never be hit and could potentially be harmful (causing us to access a register on a powered off SCC). We diable port interrupts on close always so there should be no need to drain data on a closed port.  Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
f | sc26xx.c | s | 16K | 612 | Axel Lin | axel.lin@gmail.com | 1322651506 |  | TTY: serial: convert drivers/tty/serial/* to use module_platform_driver()  This patch converts the drivers in drivers/tty/serial/* to use the module_platform_driver() macro which makes the code smaller and a bit simpler.  Cc: Arnd Bergmann <arnd@arndb.de> Cc: Jamie Iles <jamie@jamieiles.com> Cc: Yoichi Yuasa <yuasa@linux-mips.org> Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | zs.c | s | 30K | 1096 | Paul Gortmaker | paul.gortmaker@windriver.com | 1337096930 |  | SERIAL: MIPS DECstation zs.c driver needs module.h  This driver is a module and needs module.h, otherwise it will break when we remove a bogus usage of module.h from one of the other MIPS headers.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com> Cc: linux-mips@linux-mips.org Patchwork: https://patchwork.linux-mips.org/patch/3446/ Signed-off-by: Ralf Baechle <ralf@linux-mips.org>
f | m32r_sio.c | s | 26K | 977 | Jiri Slaby | jslaby@suse.cz | 1331236022 |  | TTY: remove serialP.h inclusion from some files  All of them do not use the ugly interface defined in that header.  Signed-off-by: Jiri Slaby <jslaby@suse.cz> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
d | cpm_uart |  | 7 items |  | Jiri Slaby | jslaby@suse.cz | 1316731766 |  | TTY: serial, fix includes in some drivers  linux/tty_flip.h is included in linux/serial_core.h. But this may (and will) change in the future. Then we would get build errors such as: .../tty/serial/max3107.c: In function ‘put_data_to_circ_buf’: .../tty/serial/max3107.c:149:2: error: implicit declaration of function ‘tty_insert_flip_string’  So fix all the drviers which call tty flip buffer helpers to really include linux/tty_flip.h. And also make sure that those include linux/tty.h when operating with struct tty_struct.  Signed-off-by: Jiri Slaby <jslaby@suse.cz> Cc: Alan Cox <alan@linux.intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | suncore.c | s | 5.2K | 206 | Paul Gortmaker | paul.gortmaker@windriver.com | 1328899475 |  | tty: sparc: rename drivers/tty/serial/suncore.h -> include/linux/sunserialcore.h  There are multiple users of this file from different source paths now, and rather than have ../ paths in include statements, just move the file to the linux header dir.  Suggested-by: David S. Miller <davem@davemloft.net> Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com> Acked-by: David S. Miller <davem@davemloft.net> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | clps711x.c | s | 12K | 483 | Alexander Shiyan | shc_work@mail.ru | 1336745881 |  | ARM: clps711x: Using a single definition for the PHYS and VIRT registers offset  Using a single definition for the physical and virtual address register for all variants boards clps711x. This patch also includes the use of a single function clps_read/write in some units.  Signed-off-by: Alexander Shiyan <shc_work@mail.ru> Signed-off-by: Arnd Bergmann <arnd@arndb.de>
f | serial_txx9.c | s | 33K | 1154 | Randy Dunlap | rdunlap@xenotime.net | 1339540878 |  | serial: fix serial_txx9.c build warning/typo  Fix kconfig symbol test to use "defined":  drivers/tty/serial/serial_txx9.c: warning: "CONFIG_CONSOLE_POLL" is not defined [-Wundef]  Reported-by: Geert Uytterhoeven <geert@linux-m68k.org> Signed-off-by: Randy Dunlap <rdunlap@xenotime.net> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
d | jsm |  | 5 items |  | Lucas Kannebley Tavares | lucaskt@linux.vnet.ibm.com | 1327438536 |  | jsm: Fixed EEH recovery error  There was an error on the jsm driver that would cause it to be unable to recover after a second error is detected.  At the first error, the device recovers properly:  [72521.485691] EEH: Detected PCI bus error on device 0003:02:00.0 [72521.485695] EEH: This PCI device has failed 1 times in the last hour: ... [72532.035693] ttyn3 at MMIO 0x0 (irq = 49) is a jsm [72532.105689] jsm: Port 3 added  However, at the second error, it cascades until EEH disables the device:  [72631.229549] Call Trace: ... [72641.725687] jsm: Port 3 added [72641.725695] EEH: Detected PCI bus error on device 0003:02:00.0 [72641.725698] EEH: This PCI device has failed 3 times in the last hour:  It was caused because the PCI state was not being saved after the first restore. Therefore, at the second recovery the PCI state would not be restored.  Signed-off-by: Lucas Kannebley Tavares <lucaskt@linux.vnet.ibm.com> Signed-off-by: Breno Leitao <brenohl@br.ibm.com> Acked-by: Thadeu Lima de Souza Cascardo <cascardo@linux.vnet.ibm.com> Cc: stable <stable@vger.kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | apbuart.c | s | 16K | 552 | Sam Ravnborg | sam@ravnborg.org | 1325021593 |  | apbuart: fix section mismatch warning  Fix following warnings:  WARNING: drivers/tty/serial/built-in.o(.text+0x7370): Section mismatch in reference from the function grlib_apbuart_configure() to the variable .init.data:apbuart_match The function grlib_apbuart_configure() references the variable __initdata apbuart_match. This is often because grlib_apbuart_configure lacks a __initdata annotation or the annotation of apbuart_match is wrong.  + 3 more warnings like this.  There is no guarantee that grlib_apbuart_of_driver.of_match_table is only used at __init time - so drop the __initdata annotation.  grlib_apbuart_configure() is only used during __init so add __init to this method too.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Cc: Daniel Hellstrom <daniel@gaisler.com> Cc: Greg Kroah-Hartman <gregkh@suse.de> Signed-off-by: David S. Miller <davem@davemloft.net>
f | altera_uart.c | s | 17K | 542 | Yuriy Kozlov | ykozlov@ptcusa.com | 1333992639 |  | tty: serial: altera_uart: Check for NULL platform_data in probe.  Follow altera_jtag_uart.  This fixes a crash if there is a mistake in the DTS.  Signed-off-by: Yuriy Kozlov <ykozlov@ptcusa.com> Signed-off-by: Tobias Klauser <tklauser@distanz.ch> Cc: stable <stable@vger.kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | sunsab.c | s | 29K | 957 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | sn_console.c | s | 29K | 957 | Linus Torvalds | torvalds@linux-foundation.org | 1332548377 |  | 
f | amba-pl010.c | s | 19K | 694 | Dave Martin | dave.martin@linaro.org | 1321959512 |  | serial: pl010: Enable module alias autogeneration for AMBA drivers  Signed-off-by: Dave Martin <dave.martin@linaro.org>
f | mux.c | s | 15K | 545 | Danny Kukawka | danny.kukawka@bisect.de | 1330120245 |  | tty/serial/mux.c: linux/tty.h included twice  drivers/tty/serial/mux.c included 'linux/tty.h' twice, remove the duplicate.  Signed-off-by: Danny Kukawka <danny.kukawka@bisect.de> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | mpc52xx_uart.c | s | 39K | 1245 | Frank Benkert | frank.benkert@avat.de | 1331241350 |  | mpc5200b/uart: select more tolerant uart prescaler on low baudrates  In addition to the /32 prescaler, the MPC5200B supports a second baudrate prescaler /4 to reach higher baudrates.  The current calculation (introduced with commit 0d1f22e4) in the kernel preferes this low prescaler as often as possible, but with some imprecise counterparts the communication on low baudrates fails.  According a support-mail from freescale the low prescaler (/4) allows just 1% tolerance in bittiming in contrast to 4% of the high prescaler (/32).  The prescaler not only affects the baudrate-calculation, but also the sampling of the bits on the wire.  With this patch, we use the slightly less precise, but higher tolerant prescaler calculation on low baudrates up to (and including) 115200 baud and the more precise calculation above.  Tested on a custom MPC5200B board with "fsl,mpc5200b-psc-uart".  Calculation Examples with prescaler (PS) 4 and 32 and divisor (DIV) on various baudrates. Real stands for the real baudrate generated and Diff for the differences between:      50 Baud PS 32 DIV 0xa122 Real      50 Diff   0.00%      75 Baud PS 32 DIV 0x6b6c Real      75 Diff   0.00%     110 Baud PS 32 DIV 0x493e Real     110 Diff   0.00%     134 Baud PS 32 DIV 0x3c20 Real     133 Diff   0.75%     150 Baud PS 32 DIV 0x35b6 Real     150 Diff   0.00%     200 Baud PS 32 DIV 0x2849 Real     199 Diff   0.50%     300 Baud PS  4 DIV 0xd6d8 Real     300 Diff   0.00%              PS 32 DIV 0x1adb Real     300 Diff   0.00%     600 Baud PS  4 DIV 0x6b6c Real     600 Diff   0.00%              PS 32 DIV 0x0d6e Real     599 Diff   0.17%    1200 Baud PS  4 DIV 0x35b6 Real    1200 Diff   0.00%              PS 32 DIV 0x06b7 Real    1199 Diff   0.08%    1800 Baud PS  4 DIV 0x23cf Real    1799 Diff   0.06%              PS 32 DIV 0x047a Real    1799 Diff   0.06%    2400 Baud PS  4 DIV 0x1adb Real    2400 Diff   0.00%              PS 32 DIV 0x035b Real    2401 Diff - 0.04%    4800 Baud PS  4 DIV 0x0d6e Real    4799 Diff   0.02%              PS 32 DIV 0x01ae Real    4796 Diff   0.08%    9600 Baud PS  4 DIV 0x06b7 Real    9598 Diff   0.02%              PS 32 DIV 0x00d7 Real    9593 Diff   0.07%   19200 Baud PS  4 DIV 0x035b Real   19208 Diff - 0.04%              PS 32 DIV 0x006b Real   19275 Diff - 0.39%   38400 Baud PS  4 DIV 0x01ae Real   38372 Diff   0.07%              PS 32 DIV 0x0036 Real   38194 Diff   0.54%   57600 Baud PS  4 DIV 0x011e Real   57692 Diff - 0.16%              PS 32 DIV 0x0024 Real   57291 Diff   0.54%   76800 Baud PS  4 DIV 0x00d7 Real   76744 Diff   0.07%              PS 32 DIV 0x001b Real   76388 Diff   0.54%  115200 Baud PS  4 DIV 0x008f Real  115384 Diff - 0.16%              PS 32 DIV 0x0012 Real  114583 Diff   0.54%  153600 Baud PS  4 DIV 0x006b Real  154205 Diff - 0.39%              PS 32 DIV 0x000d Real  158653 Diff - 3.29%  230400 Baud PS  4 DIV 0x0048 Real  229166 Diff   0.54%              PS 32 DIV 0x0009 Real  229166 Diff   0.54%  307200 Baud PS  4 DIV 0x0036 Real  305555 Diff   0.54%              PS 32 DIV 0x0007 Real  294642 Diff   4.09%  460800 Baud PS  4 DIV 0x0024 Real  458333 Diff   0.54%              PS 32 DIV 0x0005 Real  412500 Diff  10.48%  500000 Baud PS  4 DIV 0x0021 Real  500000 Diff   0.00%              PS 32 DIV 0x0004 Real  515625 Diff - 3.13%  576000 Baud PS  4 DIV 0x001d Real  568965 Diff   1.22%              PS 32 DIV 0x0004 Real  515625 Diff  10.48%  614400 Baud PS  4 DIV 0x001b Real  611111 Diff   0.54%              PS 32 DIV 0x0003 Real  687500 Diff -11.90%  921600 Baud PS  4 DIV 0x0012 Real  916666 Diff   0.54%              PS 32 DIV 0x0002 Real 1031250 Diff -11.90% 1000000 Baud PS  4 DIV 0x0011 Real  970588 Diff   2.94%              PS 32 DIV 0x0002 Real 1031250 Diff - 3.13% 1152000 Baud PS  4 DIV 0x000e Real 1178571 Diff - 2.31%              PS 32 DIV 0x0002 Real 1031250 Diff  10.48% 1500000 Baud PS  4 DIV 0x000b Real 1500000 Diff   0.00%              PS 32 DIV 0x0001 Real 2062500 Diff -37.50% 2000000 Baud PS  4 DIV 0x0008 Real 2062500 Diff - 3.13%              PS 32 DIV 0x0001 Real 2062500 Diff - 3.13% 2500000 Baud PS  4 DIV 0x0007 Real 2357142 Diff   5.71%              PS 32 DIV 0x0001 Real 2062500 Diff  17.50% 3000000 Baud PS  4 DIV 0x0006 Real 2750000 Diff   8.33%              PS 32 DIV 0x0001 Real 2062500 Diff  31.25% 3500000 Baud PS  4 DIV 0x0005 Real 3300000 Diff   5.71%              PS 32 DIV 0x0001 Real 2062500 Diff  41.07% 4000000 Baud PS  4 DIV 0x0004 Real 4125000 Diff - 3.13%              PS 32 DIV 0x0001 Real 2062500 Diff  48.44%  Signed-off-by: Frank Benkert <frank.benkert@avat.de> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | bcm63xx_uart.c | s | 20K | 755 | Maxime Bizon | mbizon@freebox.fr | 1308250918 |  | serial: bcm63xx_uart: fix irq storm after rx fifo overrun.  RX fifo reset is required to clear irq.  Signed-off-by: Maxime Bizon <mbizon@freebox.fr> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | zs.h | s | 9.4K | 236 | Greg Kroah-Hartman | gregkh@suse.de | 1294949418 |  | tty: move drivers/serial/ to drivers/tty/serial/  The serial drivers are really just tty drivers, so move them to drivers/tty/ to make things a bit neater overall.  This is part of the tty/serial driver movement proceedure as proposed by Arnd Bergmann and approved by everyone involved a number of months ago.  Cc: Arnd Bergmann <arnd@arndb.de> Cc: Alan Cox <alan@lxorguk.ukuu.org.uk> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: Rogier Wolff <R.E.Wolff@bitwizard.nl> Cc: Michael H. Warfield <mhw@wittsend.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | imx.c | s | 41K | 1350 | Arnd Bergmann | arnd@arndb.de | 1337002252 |  | Merge branch 'imx/pinctrl' into imx/clock  Conflicts: 	drivers/mmc/host/sdhci-esdhc-imx.c 	drivers/net/ethernet/freescale/fec.c 	drivers/spi/spi-imx.c 	drivers/tty/serial/imx.c  This resolves dependencies between the pinctrl and clock changes in imx.  Signed-off-by: Arnd Bergmann <arnd@arndb.de>
f | vr41xx_siu.c | s | 20K | 769 | Alan Cox | alan@linux.intel.com | 1327626890 |  | serial: Kill off NO_IRQ  We transform the offenders into a test of irq <= 0 which will be ok while the ARM people get their platform sorted. Once that is done (or in a while if they don't do it anyway) then we will change them all to !irq checks.  For arch specific drivers that are already using NO_IRQ = 0 we just test against zero so we don't need to re-review them later.  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | m32r_sio_reg.h | s | 5.3K | 130 | Paul Gortmaker | paul.gortmaker@windriver.com | 1328742272 |  | m32r: relocate drivers back out of 8250 dir  Commit 9bef3d4197379a995fa80f81950bbbf8d32e9e8b  	"serial: group all the 8250 related code together"  inadvertently swept up the m32r driver in the move, because it had comments mentioning 8250 registers within it.  However these are only there by nature of the driver being based off the 8250 source code -- the hardware itself does not actually have any relation to the original 8250 style UARTs.  Reported-by: Jiri Slaby <jirislaby@gmail.com> Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | msm_smd_tty.c | s | 5.5K | 189 | Jiri Slaby | jslaby@suse.cz | 1331235478 |  | TTY: remove re-assignments to tty_driver members  All num, magic and owner are set by alloc_tty_driver. No need to re-set them on each allocation site.  pti driver sets something different to what it passes to alloc_tty_driver. It is not a bug, since we don't use the lines parameter in any way. Anyway this is fixed, and now we do the right thing.  Signed-off-by: Jiri Slaby <jslaby@suse.cz> Acked-by: Tilman Schmidt <tilman@imap.cc> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | 68328serial.c | s | 31K | 1116 | Jiri Slaby | jslaby@suse.cz | 1333998165 |  | TTY: 68328serial, use tty_port_block_til_ready  Since the code is identical, use the tty_port_block_til_ready helper instead of re-implemented variant.  The code does not perform rtsdts handling, hence we do not need to provide tty port hooks for them. The default ones will be used instead. The only necessary thing is to provide tty_port_operations. It is empty, but has to be there...  Signed-off-by: Jiri Slaby <jslaby@suse.cz> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: linux-m68k@lists.linux-m68k.org Acked-by: Greg Ungerer <gerg@uclinux.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | amba-pl011.c | s | 51K | 1742 | Linus Walleij | linus.walleij@linaro.org | 1339540904 |  | serial/amba-pl011: move custom pin control to driver  We had a boot regression in Ux500 in the merge window because two orthogonal pin control schemes for the PL011 were merged at the same time:  - One using the .init() and .exit() hooks into the platform   for Ux500 putting the pins into default vs sleep state   respectively as the port was started/stopped.   commit a09806607fd20bed2f8c41fe22793386790a14aa   "ARM: ux500: switch to using pinctrl for uart0"  - One hogging the default setting at PL011 probe()   commit 258e055111d3cde2607e0d04eb91da2f7a59b591   "serial: amba-pl011: adopt pinctrl support"  To get a solution that works for both let's scrap the stuff in the platform callbacks, instead have the driver itself select default and sleep states when the port is started/stopped. Hopefully this works for all clients. Platform callbacks are bad for device tree migration anyway, so this rids us of another problem in Ux500.  Cc: Shawn Guo <shawn.guo@linaro.org> Cc: Russell King <rmk+kernel@arm.linux.org.uk> Reported-by: Lee Jones <lee.jones@linaro.org> Signed-off-by: Linus Walleij <linus.walleij@linaro.org> Tested-by: Shawn Guo <shawn.guo@linaro.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | ucc_uart.c | s | 40K | 1335 | Alan Cox | alan@linux.intel.com | 1327626890 |  | serial: Kill off NO_IRQ  We transform the offenders into a test of irq <= 0 which will be ok while the ARM people get their platform sorted. Once that is done (or in a while if they don't do it anyway) then we will change them all to !irq checks.  For arch specific drivers that are already using NO_IRQ = 0 we just test against zero so we don't need to re-review them later.  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | pnx8xxx_uart.c | s | 20K | 702 | Greg Kroah-Hartman | gregkh@suse.de | 1294949418 |  | tty: move drivers/serial/ to drivers/tty/serial/  The serial drivers are really just tty drivers, so move them to drivers/tty/ to make things a bit neater overall.  This is part of the tty/serial driver movement proceedure as proposed by Arnd Bergmann and approved by everyone involved a number of months ago.  Cc: Arnd Bergmann <arnd@arndb.de> Cc: Alan Cox <alan@lxorguk.ukuu.org.uk> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: Rogier Wolff <R.E.Wolff@bitwizard.nl> Cc: Michael H. Warfield <mhw@wittsend.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | crisv10.c | s | 125K | 3923 | Linus Torvalds | torvalds@linux-foundation.org | 1338675703 |  | tty: Revert the tty locking series, it needs more work  This reverts the tty layer change to use per-tty locking, because it's not correct yet, and fixing it will require some more deep surgery.  The main revert is d29f3ef39be4 ("tty_lock: Localise the lock"), but there are several smaller commits that built upon it, they also get reverted here. The list of reverted commits is:    fde86d310886 - tty: add lockdep annotations   8f6576ad476b - tty: fix ldisc lock inversion trace   d3ca8b64b97e - pty: Fix lock inversion   b1d679afd766 - tty: drop the pty lock during hangup   abcefe5fc357 - tty/amiserial: Add missing argument for tty_unlock()   fd11b42e3598 - cris: fix missing tty arg in wait_event_interruptible_tty call   d29f3ef39be4 - tty_lock: Localise the lock  The revert had a trivial conflict in the 68360serial.c staging driver that got removed in the meantime.  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | bfin_sport_uart.c | s | 22K | 777 | Sonic Zhang | sonic.zhang@analog.com | 1323486333 |  | serial: bfin-sport-uart: Add tty ASYNC_CTS_FLOW flag to do CTS flow control.  Signed-off-by: Sonic Zhang <sonic.zhang@analog.com> Acked-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | ip22zilog.h | s | 8.8K | 233 | Greg Kroah-Hartman | gregkh@suse.de | 1294949418 |  | tty: move drivers/serial/ to drivers/tty/serial/  The serial drivers are really just tty drivers, so move them to drivers/tty/ to make things a bit neater overall.  This is part of the tty/serial driver movement proceedure as proposed by Arnd Bergmann and approved by everyone involved a number of months ago.  Cc: Arnd Bergmann <arnd@arndb.de> Cc: Alan Cox <alan@lxorguk.ukuu.org.uk> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: Rogier Wolff <R.E.Wolff@bitwizard.nl> Cc: Michael H. Warfield <mhw@wittsend.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | mpsc.c | s | 55K | 1800 | Greg Kroah-Hartman | gregkh@suse.de | 1294949418 |  | tty: move drivers/serial/ to drivers/tty/serial/  The serial drivers are really just tty drivers, so move them to drivers/tty/ to make things a bit neater overall.  This is part of the tty/serial driver movement proceedure as proposed by Arnd Bergmann and approved by everyone involved a number of months ago.  Cc: Arnd Bergmann <arnd@arndb.de> Cc: Alan Cox <alan@lxorguk.ukuu.org.uk> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: Rogier Wolff <R.E.Wolff@bitwizard.nl> Cc: Michael H. Warfield <mhw@wittsend.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | sunzilog.c | s | 40K | 1360 | Sam Ravnborg | sam@ravnborg.org | 1333525030 |  | serial/sunzilog: fix keyboard on SUN SPARCstation  The keyboard on my SUN SPARCstation 5 no longer worked.      The culprint was: d4e33fac2408d37f7b52e80ca2a89f9fb482914f     ("serial: Kill off NO_IRQ")  Fix up logic for no irq / irq so the keyboard works again.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Cc: Alan Cox <alan@linux.intel.com> Cc: Greg Kroah-Hartman <gregkh@linuxfoundation.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | pmac_zilog.c | s | 50K | 1749 | Larry Finger | Larry.Finger@lwfinger.net | 1335747598 |  | tty/serial/pmac_zilog: Fix "nobody cared" IRQ message  Following commit a79dd5a titled "tty/serial/pmac_zilog: Fix suspend & resume", my Powerbook G4 Titanium showed the following stack dump:  [   36.878225] irq 23: nobody cared (try booting with the "irqpoll" option) [   36.878251] Call Trace: [   36.878291] [dfff3f00] [c000984c] show_stack+0x7c/0x194 (unreliable) [   36.878322] [dfff3f40] [c00a6868] __report_bad_irq+0x44/0xf4 [   36.878339] [dfff3f60] [c00a6b04] note_interrupt+0x1ec/0x2ac [   36.878356] [dfff3f80] [c00a48d0] handle_irq_event_percpu+0x250/0x2b8 [   36.878372] [dfff3fd0] [c00a496c] handle_irq_event+0x34/0x54 [   36.878389] [dfff3fe0] [c00a753c] handle_fasteoi_irq+0xb4/0x124 [   36.878412] [dfff3ff0] [c000f5bc] call_handle_irq+0x18/0x28 [   36.878428] [deef1f10] [c000719c] do_IRQ+0x114/0x1cc [   36.878446] [deef1f40] [c0015868] ret_from_except+0x0/0x1c [   36.878484] --- Exception: 501 at 0xf497610 [   36.878489]     LR = 0xfdc3dd0 [   36.878497] handlers: [   36.878510] [<c02b7424>] pmz_interrupt [   36.878520] Disabling IRQ #23  From an E-mail exchange about this problem, Andreas Schwab noticed a typo that resulted in the wrong condition being tested.  The patch also corrects 2 typos that incorrectly report why an error branch is being taken.  Signed-off-by: Larry Finger <Larry.Finger@lwfinger.net> Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
f | serial_ks8695.c | s | 15K | 581 | Yong Zhang | yong.zhang0@gmail.com | 1316732937 |  | TTY: irq: Remove IRQF_DISABLED  Since commit [e58aa3d2: genirq: Run irq handlers with interrupts disabled], We run all interrupt handlers with interrupts disabled and we even check and yell when an interrupt handler returns with interrupts enabled (see commit [b738a50a: genirq: Warn when handler enables interrupts]).  So now this flag is a NOOP and can be removed.  Signed-off-by: Yong Zhang <yong.zhang0@gmail.com> Acked-by: Tobias Klauser <tklauser@distanz.ch> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | dz.h | s | 5.3K | 111 | Greg Kroah-Hartman | gregkh@suse.de | 1294949418 |  | tty: move drivers/serial/ to drivers/tty/serial/  The serial drivers are really just tty drivers, so move them to drivers/tty/ to make things a bit neater overall.  This is part of the tty/serial driver movement proceedure as proposed by Arnd Bergmann and approved by everyone involved a number of months ago.  Cc: Arnd Bergmann <arnd@arndb.de> Cc: Alan Cox <alan@lxorguk.ukuu.org.uk> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: Rogier Wolff <R.E.Wolff@bitwizard.nl> Cc: Michael H. Warfield <mhw@wittsend.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | sh-sci.h | s | 1.6K | 34 | Paul Mundt | lethal@linux-sh.org | 1333104615 |  | serial: sh-sci: use serial_port_in/out vs sci_in/out.  Follows the 8250 change for pretty much the same rationale.  See commit "serial: use serial_port_in/out vs serial_in/out in 8250".  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | msm_serial_hs.c | s | 51K | 1567 | David Howells | dhowells@redhat.com | 1332955803 |  | Remove all #inclusions of asm/system.h  Remove all #inclusions of asm/system.h preparatory to splitting and killing it.  Performed with the following command:  perl -p -i -e 's!^#\s*include\s*<asm/system[.]h>.*\n!!' `grep -Irl '^#\s*include\s*<asm/system[.]h>' *`  Signed-off-by: David Howells <dhowells@redhat.com>
f | samsung.h | s | 2.3K | 75 | Thomas Abraham | thomas.abraham@linaro.org | 1324602420 |  | serial: samsung: merge probe() function from all SoC specific extensions  With reset port, set clock and get clock functions in SoC specific extentions being removed, only the driver probe is left over in these extensions. The probe function itself can be merged into one and moved into the samsung common serial driver. With driver probe also moved, all the SoC specific extentions are no longer required and they are deleted.  Cc: Ben Dooks <ben-linux@fluff.org> Signed-off-by: Thomas Abraham <thomas.abraham@linaro.org> Signed-off-by: Kukjin Kim <kgene.kim@samsung.com>
f | sunsab.h | s | 8.5K | 288 | Greg Kroah-Hartman | gregkh@suse.de | 1294949418 |  | tty: move drivers/serial/ to drivers/tty/serial/  The serial drivers are really just tty drivers, so move them to drivers/tty/ to make things a bit neater overall.  This is part of the tty/serial driver movement proceedure as proposed by Arnd Bergmann and approved by everyone involved a number of months ago.  Cc: Arnd Bergmann <arnd@arndb.de> Cc: Alan Cox <alan@lxorguk.ukuu.org.uk> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: Rogier Wolff <R.E.Wolff@bitwizard.nl> Cc: Michael H. Warfield <mhw@wittsend.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | Kconfig | g | 41K |  | Arnd Bergmann | arnd@arndb.de | 1333992856 |  | tty/serial/omap: console can only be built-in  When the omap serial driver is built as a module, we must not allow the console driver to be selected, because consoles can not be loadable modules.  Signed-off-by: Arnd Bergmann <arnd@arndb.de> Signed-off-by: Mathieu Poirier <mathieu.poirier@linaro.org> Acked-by: Govindraj.R <govindraj.raja@ti.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | mrst_max3110.c | s | 19K | 747 | Lars-Peter Clausen | lars@metafoo.de | 1322367561 |  | TTY: Remove redundant spi driver bus initialization  In ancient times it was necessary to manually initialize the bus field of an spi_driver to spi_bus_type. These days this is done in spi_driver_register(), so we can drop the manual assignment.  The patch was generated using the following coccinelle semantic patch: // <smpl> @@ identifier _driver; @@ struct spi_driver _driver = { 	.driver = { -		.bus = &spi_bus_type, 	}, }; // </smpl>  Signed-off-by: Lars-Peter Clausen <lars@metafoo.de> Cc: Alan Cox <alan@linux.intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | uartlite.c | s | 15K | 526 | Linus Torvalds | torvalds@linux-foundation.org | 1319697341 |  | Merge branch 'devicetree/next' of git://git.secretlab.ca/git/linux-2.6  * 'devicetree/next' of git://git.secretlab.ca/git/linux-2.6:   of_mdio: Don't phy_scan_fixups() twice   Devicetree: Expand on ARM Primecell binding documentation   dt: Add empty of_match_node() macro   dt: add empty dt helpers for non-dt build   devicetree: fix build error on drivers/tty/serial/altera_jtaguart.c   devicetree: Add ARM pl022 spi controller binding doc   devicetree: Add ARM pl061 gpio controller binding doc   of/irq: of_irq_find_parent: check for parent equal to child   MAINTAINERS: update devicetree maintainers   dt: add helper to read 64-bit integers   tty: use of_match_ptr() for of_match_table entry   OF: Add of_match_ptr() macro   dt: add empty for_each_child_of_node, of_find_property   devicetree: Document Qualcomm and Atmel prefixes   serial/imx: add of_alias_get_id() reference back   dt: add of_alias_scan and of_alias_get_id   devicetree: Add a registry of vendor prefixes
f | crisv10.h | s | 4.2K | 120 | Greg Kroah-Hartman | gregkh@suse.de | 1294949418 |  | tty: move drivers/serial/ to drivers/tty/serial/  The serial drivers are really just tty drivers, so move them to drivers/tty/ to make things a bit neater overall.  This is part of the tty/serial driver movement proceedure as proposed by Arnd Bergmann and approved by everyone involved a number of months ago.  Cc: Arnd Bergmann <arnd@arndb.de> Cc: Alan Cox <alan@lxorguk.ukuu.org.uk> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: Rogier Wolff <R.E.Wolff@bitwizard.nl> Cc: Michael H. Warfield <mhw@wittsend.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | dz.c | s | 22K | 812 | David Howells | dhowells@redhat.com | 1332955803 |  | Remove all #inclusions of asm/system.h  Remove all #inclusions of asm/system.h preparatory to splitting and killing it.  Performed with the following command:  perl -p -i -e 's!^#\s*include\s*<asm/system[.]h>.*\n!!' `grep -Irl '^#\s*include\s*<asm/system[.]h>' *`  Signed-off-by: David Howells <dhowells@redhat.com>
f | icom.c | s | 43K | 1375 | David Howells | dhowells@redhat.com | 1332955803 |  | Remove all #inclusions of asm/system.h  Remove all #inclusions of asm/system.h preparatory to splitting and killing it.  Performed with the following command:  perl -p -i -e 's!^#\s*include\s*<asm/system[.]h>.*\n!!' `grep -Irl '^#\s*include\s*<asm/system[.]h>' *`  Signed-off-by: David Howells <dhowells@redhat.com>
f | ifx6x60.h | s | 3.3K | 108 | Russ Gorby | russ.gorby@intel.com | 1297970175 |  | serial: ifx6x60: minor cleanup  renamed spi_driver variable to not be h/w specific set driver name to use DRVNAME define removed commented-out define  Signed-off-by: Russ Gorby <russ.gorby@intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | sunzilog.h | s | 9.3K | 239 | Greg Kroah-Hartman | gregkh@suse.de | 1294949418 |  | tty: move drivers/serial/ to drivers/tty/serial/  The serial drivers are really just tty drivers, so move them to drivers/tty/ to make things a bit neater overall.  This is part of the tty/serial driver movement proceedure as proposed by Arnd Bergmann and approved by everyone involved a number of months ago.  Cc: Arnd Bergmann <arnd@arndb.de> Cc: Alan Cox <alan@lxorguk.ukuu.org.uk> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: Rogier Wolff <R.E.Wolff@bitwizard.nl> Cc: Michael H. Warfield <mhw@wittsend.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | sh-sci.c | s | 57K | 2048 | Laurent Pinchart | laurent.pinchart@ideasonboard.com | 1339550530 |  | serial: sh-sci: Make probe fail for ports that exceed the maximum count  The driver supports a maximum number of ports configurable at compile time. Make sure the probe() method fails when registering a port that exceeds the maximum instead of returning success without registering the port.  This fixes a crash at system suspend time, when the driver tried to suspend a non-registered port using the UART core.  Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | sunsu.c | s | 37K | 1353 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | ioc4_serial.c | s | 80K | 2553 | Jiri Slaby | jslaby@suse.cz | 1331236022 |  | TTY: remove serialP.h inclusion from some files  All of them do not use the ugly interface defined in that header.  Signed-off-by: Jiri Slaby <jslaby@suse.cz> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | bfin_sport_uart.h | s | 4.1K | 78 | Sonic Zhang | sonic.zhang@analog.com | 1323486333 |  | tty: bfin-sport-uart: Rx interrupt is not called always with irq disabled.  Replace local_irq_disable by local_irq_save.  Signed-off-by: Sonic Zhang <sonic.zhang@analog.com> Acked-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | mxs-auart.c | s | 18K | 661 | Linus Torvalds | torvalds@linux-foundation.org | 1337728344 |  | 
f | 21285.c | s | 11K | 429 | David Howells | dhowells@redhat.com | 1332955801 |  | Disintegrate asm/system.h for ARM  Disintegrate asm/system.h for ARM.  Signed-off-by: David Howells <dhowells@redhat.com> cc: Russell King <linux@arm.linux.org.uk> cc: linux-arm-kernel@lists.infradead.org
f | msm_serial.h | s | 5.3K | 164 | Jovi Zhang | bookjovi@gmail.com | 1303256016 |  | tty: remove invalid location line in file header  remove invalid location line in each file header after location moved from driver/char to driver/tty  Signed-off-by: Jovi Zhang <bookjovi@gmail.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | timbuart.h | s | 1.5K | 48 | Greg Kroah-Hartman | gregkh@suse.de | 1294949418 |  | tty: move drivers/serial/ to drivers/tty/serial/  The serial drivers are really just tty drivers, so move them to drivers/tty/ to make things a bit neater overall.  This is part of the tty/serial driver movement proceedure as proposed by Arnd Bergmann and approved by everyone involved a number of months ago.  Cc: Arnd Bergmann <arnd@arndb.de> Cc: Alan Cox <alan@lxorguk.ukuu.org.uk> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: Rogier Wolff <R.E.Wolff@bitwizard.nl> Cc: Michael H. Warfield <mhw@wittsend.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | pch_uart.c | s | 47K | 1592 | Greg Kroah-Hartman | gregkh@linuxfoundation.org | 1335199163 |  | Merge 3.4-rc4 into tty-next  This resolves the merge problem with: 	drivers/tty/serial/pch_uart.c  Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | m32r_sio.h | s | 1.3K | 42 | Jiri Slaby | jslaby@suse.cz | 1331236022 |  | TTY: serial, include pci.h in m32r_sio  It uses pointers to pci_dev, but compiler complains it doesn't know it: In file included from .../m32r_sio.c:53: .../m32r_sio.h:21: warning: "struct pci_dev" declared inside parameter list .../m32r_sio.h:21: warning: its scope is only this definition or declaration, which is probably not what you want .../m32r_sio.h:22: warning: "struct pci_dev" declared inside parameter list  Signed-off-by: Jiri Slaby <jslaby@suse.cz> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | timbuart.c | s | 12K | 420 | Axel Lin | axel.lin@gmail.com | 1322651506 |  | TTY: serial: convert drivers/tty/serial/* to use module_platform_driver()  This patch converts the drivers in drivers/tty/serial/* to use the module_platform_driver() macro which makes the code smaller and a bit simpler.  Cc: Arnd Bergmann <arnd@arndb.de> Cc: Jamie Iles <jamie@jamieiles.com> Cc: Yoichi Yuasa <yuasa@linux-mips.org> Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | mfd.c | s | 36K | 1254 | Stephen Boyd | sboyd@codeaurora.org | 1333664750 |  | simple_open: automatically convert to simple_open()  Many users of debugfs copy the implementation of default_open() when they want to support a custom read/write function op.  This leads to a proliferation of the default_open() implementation across the entire tree.  Now that the common implementation has been consolidated into libfs we can replace all the users of this function with simple_open().  This replacement was done with the following semantic patch:  <smpl> @ open @ identifier open_f != simple_open; identifier i, f; @@ -int open_f(struct inode *i, struct file *f) -{ ( -if (i->i_private) -f->private_data = i->i_private; || -f->private_data = i->i_private; ) -return 0; -}  @ has_open depends on open @ identifier fops; identifier open.open_f; @@ struct file_operations fops = { ... -.open = open_f, +.open = simple_open, ... }; </smpl>  [akpm@linux-foundation.org: checkpatch fixes] Signed-off-by: Stephen Boyd <sboyd@codeaurora.org> Cc: Greg Kroah-Hartman <gregkh@linuxfoundation.org> Cc: Al Viro <viro@zeniv.linux.org.uk> Cc: Julia Lawall <Julia.Lawall@lip6.fr> Acked-by: Ingo Molnar <mingo@elte.hu> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
d | 8250 |  | 19 items |  | Randy Dunlap | rdunlap@xenotime.net | 1339540878 |  | serial: fix kernel-doc warnings in 8250.c  Fix kernel-doc warnings in drivers/tty/serial/8250/8250.c:  Warning(drivers/tty/serial/8250/8250.c:3128): No description found for parameter 'up' Warning(drivers/tty/serial/8250/8250.c:3128): Excess function parameter 'port' description in 'serial8250_register_8250_port'  Signed-off-by: Randy Dunlap <rdunlap@xenotime.net> Acked-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | ip22zilog.c | s | 31K | 995 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | netx-serial.c | s | 16K | 618 | Jovi Zhang | bookjovi@gmail.com | 1303256016 |  | tty: remove invalid location line in file header  remove invalid location line in each file header after location moved from driver/char to driver/tty  Signed-off-by: Jovi Zhang <bookjovi@gmail.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | apbuart.h | s | 2.3K | 53 | Greg Kroah-Hartman | gregkh@suse.de | 1294949418 |  | tty: move drivers/serial/ to drivers/tty/serial/  The serial drivers are really just tty drivers, so move them to drivers/tty/ to make things a bit neater overall.  This is part of the tty/serial driver movement proceedure as proposed by Arnd Bergmann and approved by everyone involved a number of months ago.  Cc: Arnd Bergmann <arnd@arndb.de> Cc: Alan Cox <alan@lxorguk.ukuu.org.uk> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: Rogier Wolff <R.E.Wolff@bitwizard.nl> Cc: Michael H. Warfield <mhw@wittsend.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | max3100.c | s | 21K | 774 | Lars-Peter Clausen | lars@metafoo.de | 1322367561 |  | TTY: Remove redundant spi driver bus initialization  In ancient times it was necessary to manually initialize the bus field of an spi_driver to spi_bus_type. These days this is done in spi_driver_register(), so we can drop the manual assignment.  The patch was generated using the following coccinelle semantic patch: // <smpl> @@ identifier _driver; @@ struct spi_driver _driver = { 	.driver = { -		.bus = &spi_bus_type, 	}, }; // </smpl>  Signed-off-by: Lars-Peter Clausen <lars@metafoo.de> Cc: Alan Cox <alan@linux.intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | sirfsoc_uart.h | s | 6.1K | 167 | Linus Walleij | linus.walleij@linaro.org | 1329929952 |  | serial/sirf: fixup for changes to pin control  We changed the signature of the pin multiplexing functions to handle any pin business, so fix up the Sirf driver to call this new interface and rename some variables to make the semantics understandable.  Cc: linux-serial@vger.kernel.org Acked-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org> Acked-by: Barry Song <Baohua.Song@csr.com> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | msm_serial.c | s | 22K | 800 | Linus Torvalds | torvalds@linux-foundation.org | 1320206555 |  | Merge branch 'next/dt' of git://git.linaro.org/people/arnd/arm-soc  * 'next/dt' of git://git.linaro.org/people/arnd/arm-soc:   ARM: gic: use module.h instead of export.h   ARM: gic: fix irq_alloc_descs handling for sparse irq   ARM: gic: add OF based initialization   ARM: gic: add irq_domain support   irq: support domains with non-zero hwirq base   of/irq: introduce of_irq_init   ARM: at91: add at91sam9g20 and Calao USB A9G20 DT support   ARM: at91: dt: at91sam9g45 family and board device tree files   arm/mx5: add device tree support for imx51 babbage   arm/mx5: add device tree support for imx53 boards   ARM: msm: Add devicetree support for msm8660-surf   msm_serial: Add devicetree support   msm_serial: Use relative resources for iomem  Fix up conflicts in arch/arm/mach-at91/{at91sam9260.c,at91sam9g45.c}
f | sa1100.c | s | 22K | 762 | Rob Herring | rob.herring@calxeda.com | 1332716240 |  | ARM: 7342/2: sa1100: prepare for sparse irq conversion  In preparation to convert SA1100 to sparse irq, set .nr_irqs for each machine and explicitly include mach/irqs.h as needed.  Signed-off-by: Rob Herring <rob.herring@calxeda.com> Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
f | sunhv.c | s | 13K | 528 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | max3107.c | s | 30K | 1040 | Lars-Peter Clausen | lars@metafoo.de | 1322367561 |  | TTY: Remove redundant spi driver bus initialization  In ancient times it was necessary to manually initialize the bus field of an spi_driver to spi_bus_type. These days this is done in spi_driver_register(), so we can drop the manual assignment.  The patch was generated using the following coccinelle semantic patch: // <smpl> @@ identifier _driver; @@ struct spi_driver _driver = { 	.driver = { -		.bus = &spi_bus_type, 	}, }; // </smpl>  Signed-off-by: Lars-Peter Clausen <lars@metafoo.de> Cc: Alan Cox <alan@linux.intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | mrst_max3110.h | s | 1.6K | 49 | Alexander Shishkin | alexander.shishkin@linux.intel.com | 1314381675 |  | max3110: add sysrq support  This patch moves several occurences of similar code inside receive_chars(), which now also takes care of checking for break and calling sysrq handling code.  Signed-off-by: Alexander Shishkin <alexander.shishkin@linux.intel.com> Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | vt8500_serial.c | s | 15K | 523 | Wolfram Sang | w.sang@pengutronix.de | 1331572915 |  | tty: serial: vt8500: fix annotations for probe/remove  Fixes:  WARNING: drivers/tty/serial/built-in.o(.data+0x30): Section mismatch in reference from the variable vt8500_platform_driver to the function .init.text:vt8500_serial_probe() The variable vt8500_platform_driver references the function __init vt8500_serial_probe()  And mark the remove pointer while we are here.  Signed-off-by: Wolfram Sang <w.sang@pengutronix.de> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
