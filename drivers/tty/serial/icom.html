<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › tty › serial › icom.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>icom.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * icom.h</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 2001 Michael Anderson, IBM Corporation</span>
<span class="cm"> *</span>
<span class="cm"> * Serial device driver include file.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> * it under the terms of the GNU General Public License as published by</span>
<span class="cm"> * the Free Software Foundation; either version 2 of the License, or</span>
<span class="cm"> * (at your option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful,</span>
<span class="cm"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm"> * GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License</span>
<span class="cm"> * along with this program; if not, write to the Free Software</span>
<span class="cm"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA</span>
<span class="cm"> */</span>

<span class="cp">#include &lt;linux/serial_core.h&gt;</span>

<span class="cp">#define BAUD_TABLE_LIMIT	((sizeof(icom_acfg_baud)/sizeof(int)) - 1)</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">icom_acfg_baud</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mi">300</span><span class="p">,</span>
	<span class="mi">600</span><span class="p">,</span>
	<span class="mi">900</span><span class="p">,</span>
	<span class="mi">1200</span><span class="p">,</span>
	<span class="mi">1800</span><span class="p">,</span>
	<span class="mi">2400</span><span class="p">,</span>
	<span class="mi">3600</span><span class="p">,</span>
	<span class="mi">4800</span><span class="p">,</span>
	<span class="mi">7200</span><span class="p">,</span>
	<span class="mi">9600</span><span class="p">,</span>
	<span class="mi">14400</span><span class="p">,</span>
	<span class="mi">19200</span><span class="p">,</span>
	<span class="mi">28800</span><span class="p">,</span>
	<span class="mi">38400</span><span class="p">,</span>
	<span class="mi">57600</span><span class="p">,</span>
	<span class="mi">76800</span><span class="p">,</span>
	<span class="mi">115200</span><span class="p">,</span>
	<span class="mi">153600</span><span class="p">,</span>
	<span class="mi">230400</span><span class="p">,</span>
	<span class="mi">307200</span><span class="p">,</span>
	<span class="mi">460800</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">icom_regs</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">control</span><span class="p">;</span>		<span class="cm">/* Adapter Control Register     */</span>
	<span class="n">u32</span> <span class="n">interrupt</span><span class="p">;</span>		<span class="cm">/* Adapter Interrupt Register   */</span>
	<span class="n">u32</span> <span class="n">int_mask</span><span class="p">;</span>		<span class="cm">/* Adapter Interrupt Mask Reg   */</span>
	<span class="n">u32</span> <span class="n">int_pri</span><span class="p">;</span>		<span class="cm">/* Adapter Interrupt Priority r */</span>
	<span class="n">u32</span> <span class="n">int_reg_b</span><span class="p">;</span>		<span class="cm">/* Adapter non-masked Interrupt */</span>
	<span class="n">u32</span> <span class="n">resvd01</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">resvd02</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">resvd03</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">control_2</span><span class="p">;</span>		<span class="cm">/* Adapter Control Register 2   */</span>
	<span class="n">u32</span> <span class="n">interrupt_2</span><span class="p">;</span>	<span class="cm">/* Adapter Interrupt Register 2 */</span>
	<span class="n">u32</span> <span class="n">int_mask_2</span><span class="p">;</span>		<span class="cm">/* Adapter Interrupt Mask 2     */</span>
	<span class="n">u32</span> <span class="n">int_pri_2</span><span class="p">;</span>		<span class="cm">/* Adapter Interrupt Prior 2    */</span>
	<span class="n">u32</span> <span class="n">int_reg_2b</span><span class="p">;</span>		<span class="cm">/* Adapter non-masked 2         */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">func_dram</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">108</span><span class="p">];</span>	<span class="cm">/* 0-1B0   reserved by personality code */</span>
	<span class="n">u32</span> <span class="n">RcvStatusAddr</span><span class="p">;</span>	<span class="cm">/* 1B0-1B3 Status Address for Next rcv */</span>
	<span class="n">u8</span> <span class="n">RcvStnAddr</span><span class="p">;</span>		<span class="cm">/* 1B4     Receive Station Addr */</span>
	<span class="n">u8</span> <span class="n">IdleState</span><span class="p">;</span>		<span class="cm">/* 1B5     Idle State */</span>
	<span class="n">u8</span> <span class="n">IdleMonitor</span><span class="p">;</span>		<span class="cm">/* 1B6     Idle Monitor */</span>
	<span class="n">u8</span> <span class="n">FlagFillIdleTimer</span><span class="p">;</span>	<span class="cm">/* 1B7     Flag Fill Idle Timer */</span>
	<span class="n">u32</span> <span class="n">XmitStatusAddr</span><span class="p">;</span>	<span class="cm">/* 1B8-1BB Transmit Status Address */</span>
	<span class="n">u8</span> <span class="n">StartXmitCmd</span><span class="p">;</span>	<span class="cm">/* 1BC     Start Xmit Command */</span>
	<span class="n">u8</span> <span class="n">HDLCConfigReg</span><span class="p">;</span>	<span class="cm">/* 1BD     Reserved */</span>
	<span class="n">u8</span> <span class="n">CauseCode</span><span class="p">;</span>		<span class="cm">/* 1BE     Cause code for fatal error */</span>
	<span class="n">u8</span> <span class="n">xchar</span><span class="p">;</span>		<span class="cm">/* 1BF     High priority send */</span>
	<span class="n">u32</span> <span class="n">reserved3</span><span class="p">;</span>		<span class="cm">/* 1C0-1C3 Reserved */</span>
	<span class="n">u8</span> <span class="n">PrevCmdReg</span><span class="p">;</span>		<span class="cm">/* 1C4     Reserved */</span>
	<span class="n">u8</span> <span class="n">CmdReg</span><span class="p">;</span>		<span class="cm">/* 1C5     Command Register */</span>
	<span class="n">u8</span> <span class="n">async_config2</span><span class="p">;</span>	<span class="cm">/* 1C6     Async Config Byte 2 */</span>
	<span class="n">u8</span> <span class="n">async_config3</span><span class="p">;</span>	<span class="cm">/* 1C7     Async Config Byte 3 */</span>
	<span class="n">u8</span> <span class="n">dce_resvd</span><span class="p">[</span><span class="mi">20</span><span class="p">];</span>	<span class="cm">/* 1C8-1DB DCE Rsvd           */</span>
	<span class="n">u8</span> <span class="n">dce_resvd21</span><span class="p">;</span>		<span class="cm">/* 1DC     DCE Rsvd (21st byte */</span>
	<span class="n">u8</span> <span class="n">misc_flags</span><span class="p">;</span>		<span class="cm">/* 1DD     misc flags         */</span>
<span class="cp">#define V2_HARDWARE     0x40</span>
<span class="cp">#define ICOM_HDW_ACTIVE 0x01</span>
	<span class="n">u8</span> <span class="n">call_length</span><span class="p">;</span>		<span class="cm">/* 1DE     Phone #/CFI buff ln */</span>
	<span class="n">u8</span> <span class="n">call_length2</span><span class="p">;</span>	<span class="cm">/* 1DF     Upper byte (unused) */</span>
	<span class="n">u32</span> <span class="n">call_addr</span><span class="p">;</span>		<span class="cm">/* 1E0-1E3 Phn #/CFI buff addr */</span>
	<span class="n">u16</span> <span class="n">timer_value</span><span class="p">;</span>	<span class="cm">/* 1E4-1E5 general timer value */</span>
	<span class="n">u8</span> <span class="n">timer_command</span><span class="p">;</span>	<span class="cm">/* 1E6     general timer cmd  */</span>
	<span class="n">u8</span> <span class="n">dce_command</span><span class="p">;</span>		<span class="cm">/* 1E7     dce command reg    */</span>
	<span class="n">u8</span> <span class="n">dce_cmd_status</span><span class="p">;</span>	<span class="cm">/* 1E8     dce command stat   */</span>
	<span class="n">u8</span> <span class="n">x21_r1_ioff</span><span class="p">;</span>		<span class="cm">/* 1E9     dce ready counter  */</span>
	<span class="n">u8</span> <span class="n">x21_r0_ioff</span><span class="p">;</span>		<span class="cm">/* 1EA     dce not ready ctr  */</span>
	<span class="n">u8</span> <span class="n">x21_ralt_ioff</span><span class="p">;</span>	<span class="cm">/* 1EB     dce CNR counter    */</span>
	<span class="n">u8</span> <span class="n">x21_r1_ion</span><span class="p">;</span>		<span class="cm">/* 1EC     dce ready I on ctr */</span>
	<span class="n">u8</span> <span class="n">rsvd_ier</span><span class="p">;</span>		<span class="cm">/* 1ED     Rsvd for IER (if ne */</span>
	<span class="n">u8</span> <span class="n">ier</span><span class="p">;</span>			<span class="cm">/* 1EE     Interrupt Enable   */</span>
	<span class="n">u8</span> <span class="n">isr</span><span class="p">;</span>			<span class="cm">/* 1EF     Input Signal Reg   */</span>
	<span class="n">u8</span> <span class="n">osr</span><span class="p">;</span>			<span class="cm">/* 1F0     Output Signal Reg  */</span>
	<span class="n">u8</span> <span class="n">reset</span><span class="p">;</span>		<span class="cm">/* 1F1     Reset/Reload Reg   */</span>
	<span class="n">u8</span> <span class="n">disable</span><span class="p">;</span>		<span class="cm">/* 1F2     Disable Reg        */</span>
	<span class="n">u8</span> <span class="n">sync</span><span class="p">;</span>		<span class="cm">/* 1F3     Sync Reg           */</span>
	<span class="n">u8</span> <span class="n">error_stat</span><span class="p">;</span>		<span class="cm">/* 1F4     Error Status       */</span>
	<span class="n">u8</span> <span class="n">cable_id</span><span class="p">;</span>		<span class="cm">/* 1F5     Cable ID           */</span>
	<span class="n">u8</span> <span class="n">cs_length</span><span class="p">;</span>		<span class="cm">/* 1F6     CS Load Length     */</span>
	<span class="n">u8</span> <span class="n">mac_length</span><span class="p">;</span>		<span class="cm">/* 1F7     Mac Load Length    */</span>
	<span class="n">u32</span> <span class="n">cs_load_addr</span><span class="p">;</span>	<span class="cm">/* 1F8-1FB Call Load PCI Addr */</span>
	<span class="n">u32</span> <span class="n">mac_load_addr</span><span class="p">;</span>	<span class="cm">/* 1FC-1FF Mac Load PCI Addr  */</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * adapter defines and structures</span>
<span class="cm"> */</span>
<span class="cp">#define ICOM_CONTROL_START_A         0x00000008</span>
<span class="cp">#define ICOM_CONTROL_STOP_A          0x00000004</span>
<span class="cp">#define ICOM_CONTROL_START_B         0x00000002</span>
<span class="cp">#define ICOM_CONTROL_STOP_B          0x00000001</span>
<span class="cp">#define ICOM_CONTROL_START_C         0x00000008</span>
<span class="cp">#define ICOM_CONTROL_STOP_C          0x00000004</span>
<span class="cp">#define ICOM_CONTROL_START_D         0x00000002</span>
<span class="cp">#define ICOM_CONTROL_STOP_D          0x00000001</span>
<span class="cp">#define ICOM_IRAM_OFFSET             0x1000</span>
<span class="cp">#define ICOM_IRAM_SIZE               0x0C00</span>
<span class="cp">#define ICOM_DCE_IRAM_OFFSET         0x0A00</span>
<span class="cp">#define ICOM_CABLE_ID_VALID          0x01</span>
<span class="cp">#define ICOM_CABLE_ID_MASK           0xF0</span>
<span class="cp">#define ICOM_DISABLE                 0x80</span>
<span class="cp">#define CMD_XMIT_RCV_ENABLE          0xC0</span>
<span class="cp">#define CMD_XMIT_ENABLE              0x40</span>
<span class="cp">#define CMD_RCV_DISABLE              0x00</span>
<span class="cp">#define CMD_RCV_ENABLE               0x80</span>
<span class="cp">#define CMD_RESTART                  0x01</span>
<span class="cp">#define CMD_HOLD_XMIT                0x02</span>
<span class="cp">#define CMD_SND_BREAK                0x04</span>
<span class="cp">#define RS232_CABLE                  0x06</span>
<span class="cp">#define V24_CABLE                    0x0E</span>
<span class="cp">#define V35_CABLE                    0x0C</span>
<span class="cp">#define V36_CABLE                    0x02</span>
<span class="cp">#define NO_CABLE                     0x00</span>
<span class="cp">#define START_DOWNLOAD               0x80</span>
<span class="cp">#define ICOM_INT_MASK_PRC_A          0x00003FFF</span>
<span class="cp">#define ICOM_INT_MASK_PRC_B          0x3FFF0000</span>
<span class="cp">#define ICOM_INT_MASK_PRC_C          0x00003FFF</span>
<span class="cp">#define ICOM_INT_MASK_PRC_D          0x3FFF0000</span>
<span class="cp">#define INT_RCV_COMPLETED            0x1000</span>
<span class="cp">#define INT_XMIT_COMPLETED           0x2000</span>
<span class="cp">#define INT_IDLE_DETECT              0x0800</span>
<span class="cp">#define INT_RCV_DISABLED             0x0400</span>
<span class="cp">#define INT_XMIT_DISABLED            0x0200</span>
<span class="cp">#define INT_RCV_XMIT_SHUTDOWN        0x0100</span>
<span class="cp">#define INT_FATAL_ERROR              0x0080</span>
<span class="cp">#define INT_CABLE_PULL               0x0020</span>
<span class="cp">#define INT_SIGNAL_CHANGE            0x0010</span>
<span class="cp">#define HDLC_PPP_PURE_ASYNC          0x02</span>
<span class="cp">#define HDLC_FF_FILL                 0x00</span>
<span class="cp">#define HDLC_HDW_FLOW                0x01</span>
<span class="cp">#define START_XMIT                   0x80</span>
<span class="cp">#define ICOM_ACFG_DRIVE1             0x20</span>
<span class="cp">#define ICOM_ACFG_NO_PARITY          0x00</span>
<span class="cp">#define ICOM_ACFG_PARITY_ENAB        0x02</span>
<span class="cp">#define ICOM_ACFG_PARITY_ODD         0x01</span>
<span class="cp">#define ICOM_ACFG_8BPC               0x00</span>
<span class="cp">#define ICOM_ACFG_7BPC               0x04</span>
<span class="cp">#define ICOM_ACFG_6BPC               0x08</span>
<span class="cp">#define ICOM_ACFG_5BPC               0x0C</span>
<span class="cp">#define ICOM_ACFG_1STOP_BIT          0x00</span>
<span class="cp">#define ICOM_ACFG_2STOP_BIT          0x10</span>
<span class="cp">#define ICOM_DTR                     0x80</span>
<span class="cp">#define ICOM_RTS                     0x40</span>
<span class="cp">#define ICOM_RI                      0x08</span>
<span class="cp">#define ICOM_DSR                     0x80</span>
<span class="cp">#define ICOM_DCD                     0x20</span>
<span class="cp">#define ICOM_CTS                     0x40</span>

<span class="cp">#define NUM_XBUFFS 1</span>
<span class="cp">#define NUM_RBUFFS 2</span>
<span class="cp">#define RCV_BUFF_SZ 0x0200</span>
<span class="cp">#define XMIT_BUFF_SZ 0x1000</span>
<span class="k">struct</span> <span class="n">statusArea</span> <span class="p">{</span>
    <span class="cm">/**********************************************/</span>
	<span class="cm">/* Transmit Status Area                       */</span>
    <span class="cm">/**********************************************/</span>
	<span class="k">struct</span> <span class="n">xmit_status_area</span><span class="p">{</span>
		<span class="n">u32</span> <span class="n">leNext</span><span class="p">;</span>	<span class="cm">/* Next entry in Little Endian on Adapter */</span>
		<span class="n">u32</span> <span class="n">leNextASD</span><span class="p">;</span>
		<span class="n">u32</span> <span class="n">leBuffer</span><span class="p">;</span>	<span class="cm">/* Buffer for entry in LE for Adapter */</span>
		<span class="n">u16</span> <span class="n">leLengthASD</span><span class="p">;</span>
		<span class="n">u16</span> <span class="n">leOffsetASD</span><span class="p">;</span>
		<span class="n">u16</span> <span class="n">leLength</span><span class="p">;</span>	<span class="cm">/* Length of data in segment */</span>
		<span class="n">u16</span> <span class="n">flags</span><span class="p">;</span>
<span class="cp">#define SA_FLAGS_DONE           0x0080	</span><span class="cm">/* Done with Segment */</span><span class="cp"></span>
<span class="cp">#define SA_FLAGS_CONTINUED      0x8000	</span><span class="cm">/* More Segments */</span><span class="cp"></span>
<span class="cp">#define SA_FLAGS_IDLE           0x4000	</span><span class="cm">/* Mark IDLE after frm */</span><span class="cp"></span>
<span class="cp">#define SA_FLAGS_READY_TO_XMIT  0x0800</span>
<span class="cp">#define SA_FLAGS_STAT_MASK      0x007F</span>
	<span class="p">}</span> <span class="n">xmit</span><span class="p">[</span><span class="n">NUM_XBUFFS</span><span class="p">];</span>

    <span class="cm">/**********************************************/</span>
	<span class="cm">/* Receive Status Area                        */</span>
    <span class="cm">/**********************************************/</span>
	<span class="k">struct</span> <span class="p">{</span>
		<span class="n">u32</span> <span class="n">leNext</span><span class="p">;</span>	<span class="cm">/* Next entry in Little Endian on Adapter */</span>
		<span class="n">u32</span> <span class="n">leNextASD</span><span class="p">;</span>
		<span class="n">u32</span> <span class="n">leBuffer</span><span class="p">;</span>	<span class="cm">/* Buffer for entry in LE for Adapter */</span>
		<span class="n">u16</span> <span class="n">WorkingLength</span><span class="p">;</span>	<span class="cm">/* size of segment */</span>
		<span class="n">u16</span> <span class="n">reserv01</span><span class="p">;</span>
		<span class="n">u16</span> <span class="n">leLength</span><span class="p">;</span>	<span class="cm">/* Length of data in segment */</span>
		<span class="n">u16</span> <span class="n">flags</span><span class="p">;</span>
<span class="cp">#define SA_FL_RCV_DONE           0x0010	</span><span class="cm">/* Data ready */</span><span class="cp"></span>
<span class="cp">#define SA_FLAGS_OVERRUN         0x0040</span>
<span class="cp">#define SA_FLAGS_PARITY_ERROR    0x0080</span>
<span class="cp">#define SA_FLAGS_FRAME_ERROR     0x0001</span>
<span class="cp">#define SA_FLAGS_FRAME_TRUNC     0x0002</span>
<span class="cp">#define SA_FLAGS_BREAK_DET       0x0004	</span><span class="cm">/* set conditionally by device driver, not hardware */</span><span class="cp"></span>
<span class="cp">#define SA_FLAGS_RCV_MASK        0xFFE6</span>
	<span class="p">}</span> <span class="n">rcv</span><span class="p">[</span><span class="n">NUM_RBUFFS</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">icom_adapter</span><span class="p">;</span>


<span class="cp">#define ICOM_MAJOR       243</span>
<span class="cp">#define ICOM_MINOR_START 0</span>

<span class="k">struct</span> <span class="n">icom_port</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">uart_port</span> <span class="n">uart_port</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">imbed_modem</span><span class="p">;</span>
<span class="cp">#define ICOM_UNKNOWN		1</span>
<span class="cp">#define ICOM_RVX		2</span>
<span class="cp">#define ICOM_IMBED_MODEM	3</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">cable_id</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">read_status_mask</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">ignore_status_mask</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span> <span class="n">int_reg</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">icom_regs</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">global_reg</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">func_dram</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">dram</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">port</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">statusArea</span> <span class="o">*</span><span class="n">statStg</span><span class="p">;</span>
	<span class="n">dma_addr_t</span> <span class="n">statStg_pci</span><span class="p">;</span>
	<span class="n">u32</span> <span class="o">*</span><span class="n">xmitRestart</span><span class="p">;</span>
	<span class="n">dma_addr_t</span> <span class="n">xmitRestart_pci</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">xmit_buf</span><span class="p">;</span>
	<span class="n">dma_addr_t</span> <span class="n">xmit_buf_pci</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">recv_buf</span><span class="p">;</span>
	<span class="n">dma_addr_t</span> <span class="n">recv_buf_pci</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">next_rcv</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">put_length</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">status</span><span class="p">;</span>
<span class="cp">#define ICOM_PORT_ACTIVE	1	</span><span class="cm">/* Port exists. */</span><span class="cp"></span>
<span class="cp">#define ICOM_PORT_OFF		0	</span><span class="cm">/* Port does not exist. */</span><span class="cp"></span>
	<span class="kt">int</span> <span class="n">load_in_progress</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">icom_adapter</span> <span class="o">*</span><span class="n">adapter</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">icom_adapter</span> <span class="p">{</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span> <span class="n">base_addr</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">base_addr_pci</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">pci_dev</span> <span class="o">*</span><span class="n">pci_dev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">icom_port</span> <span class="n">port_info</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">index</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">version</span><span class="p">;</span>
<span class="cp">#define ADAPTER_V1	0x0001</span>
<span class="cp">#define ADAPTER_V2	0x0002</span>
	<span class="n">u32</span> <span class="n">subsystem_id</span><span class="p">;</span>
<span class="cp">#define FOUR_PORT_MODEL				0x0252</span>
<span class="cp">#define V2_TWO_PORTS_RVX			0x021A</span>
<span class="cp">#define V2_ONE_PORT_RVX_ONE_PORT_IMBED_MDM	0x0251</span>
	<span class="kt">int</span> <span class="n">numb_ports</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">icom_adapter_entry</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">kref</span> <span class="n">kref</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* prototype */</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">iCom_sercons_init</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">lookup_proc_table</span> <span class="p">{</span>
	<span class="n">u32</span>	<span class="n">__iomem</span> <span class="o">*</span><span class="n">global_control_reg</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span>	<span class="n">processor_id</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">lookup_int_table</span> <span class="p">{</span>
	<span class="n">u32</span>	<span class="n">__iomem</span> <span class="o">*</span><span class="n">global_int_mask</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span>	<span class="n">processor_id</span><span class="p">;</span>
<span class="p">};</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
