<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › watchdog › nv_tco.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>nv_tco.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> *	nv_tco:	TCO timer driver for nVidia chipsets.</span>
<span class="cm"> *</span>
<span class="cm"> *	(c) Copyright 2005 Google Inc., All Rights Reserved.</span>
<span class="cm"> *</span>
<span class="cm"> *	Supported Chipsets:</span>
<span class="cm"> *		- MCP51/MCP55</span>
<span class="cm"> *</span>
<span class="cm"> *	(c) Copyright 2000 kernel concepts &lt;nils@kernelconcepts.de&gt;, All Rights</span>
<span class="cm"> *	Reserved.</span>
<span class="cm"> *				http://www.kernelconcepts.de</span>
<span class="cm"> *</span>
<span class="cm"> *	This program is free software; you can redistribute it and/or</span>
<span class="cm"> *	modify it under the terms of the GNU General Public License</span>
<span class="cm"> *	as published by the Free Software Foundation; either version</span>
<span class="cm"> *	2 of the License, or (at your option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> *	Neither kernel concepts nor Nils Faerber admit liability nor provide</span>
<span class="cm"> *	warranty for any of this software. This material is provided</span>
<span class="cm"> *	&quot;AS-IS&quot; and at no charge.</span>
<span class="cm"> *</span>
<span class="cm"> *	(c) Copyright 2000	kernel concepts &lt;nils@kernelconcepts.de&gt;</span>
<span class="cm"> *				developed for</span>
<span class="cm"> *                              Jentro AG, Haar/Munich (Germany)</span>
<span class="cm"> *</span>
<span class="cm"> *	TCO timer driver for NV chipsets</span>
<span class="cm"> *	based on softdog.c by Alan Cox &lt;alan@redhat.com&gt;</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * Some address definitions for the TCO</span>
<span class="cm"> */</span>

<span class="cp">#define TCO_RLD(base)	((base) + 0x00)	</span><span class="cm">/* TCO Timer Reload and Current Value */</span><span class="cp"></span>
<span class="cp">#define TCO_TMR(base)	((base) + 0x01)	</span><span class="cm">/* TCO Timer Initial Value	*/</span><span class="cp"></span>

<span class="cp">#define TCO_STS(base)	((base) + 0x04)	</span><span class="cm">/* TCO Status Register		*/</span><span class="cp"></span>
<span class="cm">/*</span>
<span class="cm"> * TCO Boot Status bit: set on TCO reset, reset by software or standby</span>
<span class="cm"> * power-good (survives reboots), unfortunately this bit is never</span>
<span class="cm"> * set.</span>
<span class="cm"> */</span>
<span class="cp">#  define TCO_STS_BOOT_STS	(1 &lt;&lt; 9)</span>
<span class="cm">/*</span>
<span class="cm"> * first and 2nd timeout status bits, these also survive a warm boot,</span>
<span class="cm"> * and they work, so we use them.</span>
<span class="cm"> */</span>
<span class="cp">#  define TCO_STS_TCO_INT_STS	(1 &lt;&lt; 1)</span>
<span class="cp">#  define TCO_STS_TCO2TO_STS	(1 &lt;&lt; 10)</span>
<span class="cp">#  define TCO_STS_RESET		(TCO_STS_BOOT_STS | TCO_STS_TCO2TO_STS | \</span>
<span class="cp">				 TCO_STS_TCO_INT_STS)</span>

<span class="cp">#define TCO_CNT(base)	((base) + 0x08)	</span><span class="cm">/* TCO Control Register	*/</span><span class="cp"></span>
<span class="cp">#  define TCO_CNT_TCOHALT	(1 &lt;&lt; 12)</span>

<span class="cp">#define MCP51_SMBUS_SETUP_B 0xe8</span>
<span class="cp">#  define MCP51_SMBUS_SETUP_B_TCO_REBOOT (1 &lt;&lt; 25)</span>

<span class="cm">/*</span>
<span class="cm"> * The SMI_EN register is at the base io address + 0x04,</span>
<span class="cm"> * while TCOBASE is + 0x40.</span>
<span class="cm"> */</span>
<span class="cp">#define MCP51_SMI_EN(base)	((base) - 0x40 + 0x04)</span>
<span class="cp">#  define MCP51_SMI_EN_TCO	((1 &lt;&lt; 4) | (1 &lt;&lt; 5))</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
