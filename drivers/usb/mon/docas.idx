f | mon_bin.c | s | 32K | 1187 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103885 |  | usb: Add export.h for EXPORT_SYMBOL/THIS_MODULE where needed  With module.h being implicitly everywhere via device.h, the absence of explicitly including something for EXPORT_SYMBOL went unnoticed. Since we are heading to fix things up and clean module.h from the device.h file, we need to explicitly include these files now.  Use the lightweight version of the header that has just THIS_MODULE and EXPORT_SYMBOL variants.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | mon_stat.c | s | 1.5K | 56 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103885 |  | usb: Add export.h for EXPORT_SYMBOL/THIS_MODULE where needed  With module.h being implicitly everywhere via device.h, the absence of explicitly including something for EXPORT_SYMBOL went unnoticed. Since we are heading to fix things up and clean module.h from the device.h file, we need to explicitly include these files now.  Use the lightweight version of the header that has just THIS_MODULE and EXPORT_SYMBOL variants.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | mon_main.c | s | 9.1K | 363 | Joe Perches | joe@perches.com | 1281443142 |  | drivers/usb: Remove unnecessary return's from void functions  Greg prefers this to go through the trivial tree. http://lkml.org/lkml/2010/6/24/1  There are about 2500 void functions in drivers/usb Only a few used return; at end of function.  Standardize them a bit.  Moved a statement down a line in drivers/usb/host/u132-hcd.c  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | Makefile | g | 122B |  | matt mooney | mfm@muteddisk.com | 1287768127 |  | usb: makefile cleanup  For all modules, change <module>-objs to <module>-y; remove if-statements and replace with lists using the kbuild idiom; move flags to the top of the file; and fix alignment while trying to maintain the original scheme in each file.  None of the dependencies are modified.  Signed-off-by: matt mooney <mfm@muteddisk.com> Acked-by: Sam Ravnborg <sam@ravnborg.org> Acked-by: Felipe Balbi <balbi@ti.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | mon_text.c | s | 19K | 664 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103885 |  | usb: Add export.h for EXPORT_SYMBOL/THIS_MODULE where needed  With module.h being implicitly everywhere via device.h, the absence of explicitly including something for EXPORT_SYMBOL went unnoticed. Since we are heading to fix things up and clean module.h from the device.h file, we need to explicitly include these files now.  Use the lightweight version of the header that has just THIS_MODULE and EXPORT_SYMBOL variants.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | Kconfig | g | 349B |  | Pete Zaitcev | zaitcev@redhat.com | 1253713579 |  | USB: usbmon: drop Kconfig defaults  These statements seem to be unnecessary. No idea why, but I built all possible configurations and everything gets built just as before.  It's an old patch that popped from discussion with Paul in November 2008. Obviously not a very high priority but better late than never.  Signed-off-by: Pete Zaitcev <zaitcev@redhat.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | usb_mon.h | s | 1.9K | 58 | Pete Zaitcev | zaitcev@redhat.com | 1253713579 |  | USB: usbmon: end ugly tricks with DMA peeking  This patch fixes crashes when usbmon attempts to access GART aperture. The old code attempted to take a bus address and convert it into a virtual address, which clearly was impossible on systems with actual IOMMUs. Let us not persist in this foolishness, and use transfer_buffer in all cases instead.  I think downsides are negligible. The ones I see are:  - A driver may pass an address of one buffer down as transfer_buffer,    and entirely different entity mapped for DMA, resulting in misleading    output of usbmon. Note, however, that PIO based controllers would    do transfer the same data that usbmon sees here.  - Out of tree drivers may crash usbmon if they store garbage in    transfer_buffer. I inspected the in-tree drivers, and clarified    the documentation in comments.  - Drivers that use get_user_pages will not be possible to monitor.    I only found one driver with this problem (drivers/staging/rspiusb).  - Same happens with with usb_storage transferring from highmem, but    it works fine on 64-bit systems, so I think it's not a concern.    At least we don't crash anymore.  Why didn't we do this in 2.6.10? That's because back in those days it was popular not to fill in transfer_buffer, so almost all traffic would be invisible (e.g. all of HID was like that). But now, the tree is almost 100% PIO friendly, so we can do the right thing at last.  Signed-off-by: Pete Zaitcev <zaitcev@redhat.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
