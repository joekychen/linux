<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › usb › serial › io_16654.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>io_16654.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/************************************************************************</span>
<span class="cm"> *</span>
<span class="cm"> *	16654.H		Definitions for 16C654 UART used on EdgePorts</span>
<span class="cm"> *</span>
<span class="cm"> *	Copyright (C) 1998 Inside Out Networks, Inc.</span>
<span class="cm"> *	This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> *	it under the terms of the GNU General Public License as published by</span>
<span class="cm"> *	the Free Software Foundation; either version 2 of the License, or</span>
<span class="cm"> *	(at your option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> ************************************************************************/</span>

<span class="cp">#if !defined(_16654_H)</span>
<span class="cp">#define	_16654_H</span>

<span class="cm">/************************************************************************</span>
<span class="cm"> *</span>
<span class="cm"> *			D e f i n e s   /   T y p e d e f s</span>
<span class="cm"> *</span>
<span class="cm"> ************************************************************************/</span></pre></div></td></tr>


<tr id="section-2"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-2">&#182;</a></div><p>UART register numbers
Numbers 0-7 are passed to the Edgeport directly. Numbers 8 and
above are used internally to indicate that we must enable access
to them via LCR bit 0x80 or LCR = 0xBF.
The register number sent to the Edgeport is then (x &amp; 0x7).</p>

<p>Driver must not access registers that affect operation of the
the EdgePort firmware -- that includes THR, RHR, IER, FCR.</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define THR			0	</span><span class="c1">// ! Transmit Holding Register (Write)</span>
<span class="cp">#define RDR			0	</span><span class="c1">// ! Receive Holding Register (Read)</span>
<span class="cp">#define IER			1	</span><span class="c1">// ! Interrupt Enable Register</span>
<span class="cp">#define FCR			2	</span><span class="c1">// ! Fifo Control Register (Write)</span>
<span class="cp">#define ISR			2	</span><span class="c1">// Interrupt Status Register (Read)</span>
<span class="cp">#define LCR			3	</span><span class="c1">// Line Control Register</span>
<span class="cp">#define MCR			4	</span><span class="c1">// Modem Control Register</span>
<span class="cp">#define LSR			5	</span><span class="c1">// Line Status Register</span>
<span class="cp">#define MSR			6	</span><span class="c1">// Modem Status Register</span>
<span class="cp">#define SPR			7	</span><span class="c1">// ScratchPad Register</span>
<span class="cp">#define DLL			8	</span><span class="c1">// Bank2[ 0 ] Divisor Latch LSB</span>
<span class="cp">#define DLM			9	</span><span class="c1">// Bank2[ 1 ] Divisor Latch MSB</span>
<span class="cp">#define EFR			10	</span><span class="c1">// Bank2[ 2 ] Extended Function Register</span></pre></div></td></tr>


<tr id="section-3"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-3">&#182;</a></div><p>efine unused            11  // Bank2[ 3 ]</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define XON1			12	</span><span class="c1">// Bank2[ 4 ] Xon-1</span>
<span class="cp">#define XON2			13	</span><span class="c1">// Bank2[ 5 ] Xon-2</span>
<span class="cp">#define XOFF1			14	</span><span class="c1">// Bank2[ 6 ] Xoff-1</span>
<span class="cp">#define XOFF2			15	</span><span class="c1">// Bank2[ 7 ] Xoff-2</span>

<span class="cp">#define	NUM_16654_REGS		16</span>

<span class="cp">#define IS_REG_2ND_BANK(x)	((x) &gt;= 8)</span></pre></div></td></tr>


<tr id="section-4"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-4">&#182;</a></div><p>Bit definitions for each register</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define IER_RX			0x01	</span><span class="c1">// Enable receive interrupt</span>
<span class="cp">#define IER_TX			0x02	</span><span class="c1">// Enable transmit interrupt</span>
<span class="cp">#define IER_RXS			0x04	</span><span class="c1">// Enable receive status interrupt</span>
<span class="cp">#define IER_MDM			0x08	</span><span class="c1">// Enable modem status interrupt</span>
<span class="cp">#define IER_SLEEP		0x10	</span><span class="c1">// Enable sleep mode</span>
<span class="cp">#define IER_XOFF		0x20	</span><span class="c1">// Enable s/w flow control (XOFF) interrupt</span>
<span class="cp">#define IER_RTS			0x40	</span><span class="c1">// Enable RTS interrupt</span>
<span class="cp">#define IER_CTS			0x80	</span><span class="c1">// Enable CTS interrupt</span>
<span class="cp">#define IER_ENABLE_ALL		0xFF	</span><span class="c1">// Enable all ints</span>


<span class="cp">#define FCR_FIFO_EN		0x01	</span><span class="c1">// Enable FIFOs</span>
<span class="cp">#define FCR_RXCLR		0x02	</span><span class="c1">// Reset Rx FIFO</span>
<span class="cp">#define FCR_TXCLR		0x04	</span><span class="c1">// Reset Tx FIFO</span>
<span class="cp">#define FCR_DMA_BLK		0x08	</span><span class="c1">// Enable DMA block mode</span>
<span class="cp">#define FCR_TX_LEVEL_MASK	0x30	</span><span class="c1">// Mask for Tx FIFO Level</span>
<span class="cp">#define FCR_TX_LEVEL_8		0x00	</span><span class="c1">// Tx FIFO Level =  8 bytes</span>
<span class="cp">#define FCR_TX_LEVEL_16		0x10	</span><span class="c1">// Tx FIFO Level = 16 bytes</span>
<span class="cp">#define FCR_TX_LEVEL_32		0x20	</span><span class="c1">// Tx FIFO Level = 32 bytes</span>
<span class="cp">#define FCR_TX_LEVEL_56		0x30	</span><span class="c1">// Tx FIFO Level = 56 bytes</span>
<span class="cp">#define FCR_RX_LEVEL_MASK	0xC0	</span><span class="c1">// Mask for Rx FIFO Level</span>
<span class="cp">#define FCR_RX_LEVEL_8		0x00	</span><span class="c1">// Rx FIFO Level =  8 bytes</span>
<span class="cp">#define FCR_RX_LEVEL_16		0x40	</span><span class="c1">// Rx FIFO Level = 16 bytes</span>
<span class="cp">#define FCR_RX_LEVEL_56		0x80	</span><span class="c1">// Rx FIFO Level = 56 bytes</span>
<span class="cp">#define FCR_RX_LEVEL_60		0xC0	</span><span class="c1">// Rx FIFO Level = 60 bytes</span>


<span class="cp">#define ISR_INT_MDM_STATUS	0x00	</span><span class="c1">// Modem status int pending</span>
<span class="cp">#define ISR_INT_NONE		0x01	</span><span class="c1">// No interrupt pending</span>
<span class="cp">#define ISR_INT_TXRDY		0x02	</span><span class="c1">// Tx ready int pending</span>
<span class="cp">#define ISR_INT_RXRDY		0x04	</span><span class="c1">// Rx ready int pending</span>
<span class="cp">#define ISR_INT_LINE_STATUS	0x06	</span><span class="c1">// Line status int pending</span>
<span class="cp">#define ISR_INT_RX_TIMEOUT	0x0C	</span><span class="c1">// Rx timeout int pending</span>
<span class="cp">#define ISR_INT_RX_XOFF		0x10	</span><span class="c1">// Rx Xoff int pending</span>
<span class="cp">#define ISR_INT_RTS_CTS		0x20	</span><span class="c1">// RTS/CTS change int pending</span>
<span class="cp">#define ISR_FIFO_ENABLED	0xC0	</span><span class="c1">// Bits set if FIFOs enabled</span>
<span class="cp">#define ISR_INT_BITS_MASK	0x3E	</span><span class="c1">// Mask to isolate valid int causes</span>


<span class="cp">#define LCR_BITS_5		0x00	</span><span class="c1">// 5 bits/char</span>
<span class="cp">#define LCR_BITS_6		0x01	</span><span class="c1">// 6 bits/char</span>
<span class="cp">#define LCR_BITS_7		0x02	</span><span class="c1">// 7 bits/char</span>
<span class="cp">#define LCR_BITS_8		0x03	</span><span class="c1">// 8 bits/char</span>
<span class="cp">#define LCR_BITS_MASK		0x03	</span><span class="c1">// Mask for bits/char field</span>

<span class="cp">#define LCR_STOP_1		0x00	</span><span class="c1">// 1 stop bit</span>
<span class="cp">#define LCR_STOP_1_5		0x04	</span><span class="c1">// 1.5 stop bits (if 5   bits/char)</span>
<span class="cp">#define LCR_STOP_2		0x04	</span><span class="c1">// 2 stop bits   (if 6-8 bits/char)</span>
<span class="cp">#define LCR_STOP_MASK		0x04	</span><span class="c1">// Mask for stop bits field</span>

<span class="cp">#define LCR_PAR_NONE		0x00	</span><span class="c1">// No parity</span>
<span class="cp">#define LCR_PAR_ODD		0x08	</span><span class="c1">// Odd parity</span>
<span class="cp">#define LCR_PAR_EVEN		0x18	</span><span class="c1">// Even parity</span>
<span class="cp">#define LCR_PAR_MARK		0x28	</span><span class="c1">// Force parity bit to 1</span>
<span class="cp">#define LCR_PAR_SPACE		0x38	</span><span class="c1">// Force parity bit to 0</span>
<span class="cp">#define LCR_PAR_MASK		0x38	</span><span class="c1">// Mask for parity field</span>

<span class="cp">#define LCR_SET_BREAK		0x40	</span><span class="c1">// Set Break condition</span>
<span class="cp">#define LCR_DL_ENABLE		0x80	</span><span class="c1">// Enable access to divisor latch</span>

<span class="cp">#define LCR_ACCESS_EFR		0xBF	</span><span class="c1">// Load this value to access DLL,DLM,</span></pre></div></td></tr>


<tr id="section-5"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-5">&#182;</a></div><p>and also the '654-only registers
EFR, XON1, XON2, XOFF1, XOFF2</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define MCR_DTR			0x01	</span><span class="c1">// Assert DTR</span>
<span class="cp">#define MCR_RTS			0x02	</span><span class="c1">// Assert RTS</span>
<span class="cp">#define MCR_OUT1		0x04	</span><span class="c1">// Loopback only: Sets state of RI</span>
<span class="cp">#define MCR_MASTER_IE		0x08	</span><span class="c1">// Enable interrupt outputs</span>
<span class="cp">#define MCR_LOOPBACK		0x10	</span><span class="c1">// Set internal (digital) loopback mode</span>
<span class="cp">#define MCR_XON_ANY		0x20	</span><span class="c1">// Enable any char to exit XOFF mode</span>
<span class="cp">#define MCR_IR_ENABLE		0x40	</span><span class="c1">// Enable IrDA functions</span>
<span class="cp">#define MCR_BRG_DIV_4		0x80	</span><span class="c1">// Divide baud rate clk by /4 instead of /1</span>


<span class="cp">#define LSR_RX_AVAIL		0x01	</span><span class="c1">// Rx data available</span>
<span class="cp">#define LSR_OVER_ERR		0x02	</span><span class="c1">// Rx overrun</span>
<span class="cp">#define LSR_PAR_ERR		0x04	</span><span class="c1">// Rx parity error</span>
<span class="cp">#define LSR_FRM_ERR		0x08	</span><span class="c1">// Rx framing error</span>
<span class="cp">#define LSR_BREAK		0x10	</span><span class="c1">// Rx break condition detected</span>
<span class="cp">#define LSR_TX_EMPTY		0x20	</span><span class="c1">// Tx Fifo empty</span>
<span class="cp">#define LSR_TX_ALL_EMPTY	0x40	</span><span class="c1">// Tx Fifo and shift register empty</span>
<span class="cp">#define LSR_FIFO_ERR		0x80	</span><span class="c1">// Rx Fifo contains at least 1 erred char</span>


<span class="cp">#define EDGEPORT_MSR_DELTA_CTS	0x01	</span><span class="c1">// CTS changed from last read</span>
<span class="cp">#define EDGEPORT_MSR_DELTA_DSR	0x02	</span><span class="c1">// DSR changed from last read</span>
<span class="cp">#define EDGEPORT_MSR_DELTA_RI	0x04	</span><span class="c1">// RI  changed from 0 -&gt; 1</span>
<span class="cp">#define EDGEPORT_MSR_DELTA_CD	0x08	</span><span class="c1">// CD  changed from last read</span>
<span class="cp">#define EDGEPORT_MSR_CTS	0x10	</span><span class="c1">// Current state of CTS</span>
<span class="cp">#define EDGEPORT_MSR_DSR	0x20	</span><span class="c1">// Current state of DSR</span>
<span class="cp">#define EDGEPORT_MSR_RI		0x40	</span><span class="c1">// Current state of RI</span>
<span class="cp">#define EDGEPORT_MSR_CD		0x80	</span><span class="c1">// Current state of CD</span></pre></div></td></tr>


<tr id="section-6"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-6">&#182;</a></div><h2>Tx        Rx</h2></td><td class="code"><div class="highlight"><pre><span class="cp">#define EFR_SWFC_NONE		0x00	</span><span class="c1">//	None		None</span>
<span class="cp">#define EFR_SWFC_RX1		0x02 	</span><span class="c1">//	None		XOFF1</span>
<span class="cp">#define EFR_SWFC_RX2		0x01 	</span><span class="c1">//	None		XOFF2</span>
<span class="cp">#define EFR_SWFC_RX12		0x03 	</span><span class="c1">//	None		XOFF1 &amp; XOFF2</span>
<span class="cp">#define EFR_SWFC_TX1		0x08 	</span><span class="c1">//	XOFF1		None</span>
<span class="cp">#define EFR_SWFC_TX1_RX1	0x0a 	</span><span class="c1">//	XOFF1		XOFF1</span>
<span class="cp">#define EFR_SWFC_TX1_RX2	0x09 	</span><span class="c1">//	XOFF1		XOFF2</span>
<span class="cp">#define EFR_SWFC_TX1_RX12	0x0b 	</span><span class="c1">//	XOFF1		XOFF1 &amp; XOFF2</span>
<span class="cp">#define EFR_SWFC_TX2		0x04 	</span><span class="c1">//	XOFF2		None</span>
<span class="cp">#define EFR_SWFC_TX2_RX1	0x06 	</span><span class="c1">//	XOFF2		XOFF1</span>
<span class="cp">#define EFR_SWFC_TX2_RX2	0x05 	</span><span class="c1">//	XOFF2		XOFF2</span>
<span class="cp">#define EFR_SWFC_TX2_RX12	0x07 	</span><span class="c1">//	XOFF2		XOFF1 &amp; XOFF2</span>
<span class="cp">#define EFR_SWFC_TX12		0x0c 	</span><span class="c1">//	XOFF1 &amp; XOFF2	None</span>
<span class="cp">#define EFR_SWFC_TX12_RX1	0x0e 	</span><span class="c1">//	XOFF1 &amp; XOFF2	XOFF1</span>
<span class="cp">#define EFR_SWFC_TX12_RX2	0x0d 	</span><span class="c1">//	XOFF1 &amp; XOFF2	XOFF2</span>
<span class="cp">#define EFR_SWFC_TX12_RX12	0x0f 	</span><span class="c1">//	XOFF1 &amp; XOFF2	XOFF1 &amp; XOFF2</span>

<span class="cp">#define EFR_TX_FC_MASK		0x0c	</span><span class="c1">// Mask to isolate Rx flow control</span>
<span class="cp">#define EFR_TX_FC_NONE		0x00	</span><span class="c1">// No Tx Xon/Xoff flow control</span>
<span class="cp">#define EFR_TX_FC_X1		0x08	</span><span class="c1">// Transmit Xon1/Xoff1</span>
<span class="cp">#define EFR_TX_FC_X2		0x04	</span><span class="c1">// Transmit Xon2/Xoff2</span>
<span class="cp">#define EFR_TX_FC_X1_2		0x0c	</span><span class="c1">// Transmit Xon1&amp;2/Xoff1&amp;2</span>

<span class="cp">#define EFR_RX_FC_MASK		0x03	</span><span class="c1">// Mask to isolate Rx flow control</span>
<span class="cp">#define EFR_RX_FC_NONE		0x00	</span><span class="c1">// No Rx Xon/Xoff flow control</span>
<span class="cp">#define EFR_RX_FC_X1		0x02	</span><span class="c1">// Receiver compares Xon1/Xoff1</span>
<span class="cp">#define EFR_RX_FC_X2		0x01	</span><span class="c1">// Receiver compares Xon2/Xoff2</span>
<span class="cp">#define EFR_RX_FC_X1_2		0x03	</span><span class="c1">// Receiver compares Xon1&amp;2/Xoff1&amp;2</span>


<span class="cp">#define EFR_SWFC_MASK		0x0F	</span><span class="c1">// Mask for software flow control field</span>
<span class="cp">#define EFR_ENABLE_16654	0x10	</span><span class="c1">// Enable 16C654 features</span>
<span class="cp">#define EFR_SPEC_DETECT		0x20	</span><span class="c1">// Enable special character detect interrupt</span>
<span class="cp">#define EFR_AUTO_RTS		0x40	</span><span class="c1">// Use RTS for Rx flow control</span>
<span class="cp">#define EFR_AUTO_CTS		0x80	</span><span class="c1">// Use CTS for Tx flow control</span>

<span class="cp">#endif	</span><span class="c1">// if !defined(_16654_H)</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
