<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › usb › serial › ftdi_sio.c

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>ftdi_sio.c</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * USB FTDI SIO driver</span>
<span class="cm"> *</span>
<span class="cm"> *	Copyright (C) 2009 - 2010</span>
<span class="cm"> *	    Johan Hovold (jhovold@gmail.com)</span>
<span class="cm"> *	Copyright (C) 1999 - 2001</span>
<span class="cm"> *	    Greg Kroah-Hartman (greg@kroah.com)</span>
<span class="cm"> *          Bill Ryder (bryder@sgi.com)</span>
<span class="cm"> *	Copyright (C) 2002</span>
<span class="cm"> *	    Kuba Ober (kuba@mareimbrium.org)</span>
<span class="cm"> *</span>
<span class="cm"> *	This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> *	it under the terms of the GNU General Public License as published by</span>
<span class="cm"> *	the Free Software Foundation; either version 2 of the License, or</span>
<span class="cm"> *	(at your option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> * See Documentation/usb/usb-serial.txt for more information on using this</span>
<span class="cm"> * driver</span>
<span class="cm"> *</span>
<span class="cm"> * See http://ftdi-usb-sio.sourceforge.net for up to date testing info</span>
<span class="cm"> *	and extra documentation</span>
<span class="cm"> *</span>
<span class="cm"> * Change entries from 2004 and earlier can be found in versions of this</span>
<span class="cm"> * file in kernel versions prior to the 2.6.24 release.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cm">/* Bill Ryder - bryder@sgi.com - wrote the FTDI_SIO implementation */</span>
<span class="cm">/* Thanx to FTDI for so kindly providing details of the protocol required */</span>
<span class="cm">/*   to talk to the device */</span>
<span class="cm">/* Thanx to gkh and the rest of the usb dev group for all code I have</span>
<span class="cm">   assimilated :-) */</span>

<span class="cp">#include &lt;linux/kernel.h&gt;</span>
<span class="cp">#include &lt;linux/errno.h&gt;</span>
<span class="cp">#include &lt;linux/init.h&gt;</span>
<span class="cp">#include &lt;linux/slab.h&gt;</span>
<span class="cp">#include &lt;linux/tty.h&gt;</span>
<span class="cp">#include &lt;linux/tty_driver.h&gt;</span>
<span class="cp">#include &lt;linux/tty_flip.h&gt;</span>
<span class="cp">#include &lt;linux/module.h&gt;</span>
<span class="cp">#include &lt;linux/spinlock.h&gt;</span>
<span class="cp">#include &lt;linux/mutex.h&gt;</span>
<span class="cp">#include &lt;linux/uaccess.h&gt;</span>
<span class="cp">#include &lt;linux/usb.h&gt;</span>
<span class="cp">#include &lt;linux/serial.h&gt;</span>
<span class="cp">#include &lt;linux/usb/serial.h&gt;</span>
<span class="cp">#include &quot;ftdi_sio.h&quot;</span>
<span class="cp">#include &quot;ftdi_sio_ids.h&quot;</span>

<span class="cm">/*</span>
<span class="cm"> * Version Information</span>
<span class="cm"> */</span>
<span class="cp">#define DRIVER_VERSION &quot;v1.6.0&quot;</span>
<span class="cp">#define DRIVER_AUTHOR &quot;Greg Kroah-Hartman &lt;greg@kroah.com&gt;, Bill Ryder &lt;bryder@sgi.com&gt;, Kuba Ober &lt;kuba@mareimbrium.org&gt;, Andreas Mohr, Johan Hovold &lt;jhovold@gmail.com&gt;&quot;</span>
<span class="cp">#define DRIVER_DESC &quot;USB FTDI Serial Converters Driver&quot;</span>

<span class="k">static</span> <span class="n">bool</span> <span class="n">debug</span><span class="p">;</span>
<span class="k">static</span> <span class="n">__u16</span> <span class="n">vendor</span> <span class="o">=</span> <span class="n">FTDI_VID</span><span class="p">;</span>
<span class="k">static</span> <span class="n">__u16</span> <span class="n">product</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">kref</span> <span class="n">kref</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">ftdi_chip_type</span> <span class="n">chip_type</span><span class="p">;</span>
				<span class="cm">/* type of device, either SIO or FT8U232AM */</span>
	<span class="kt">int</span> <span class="n">baud_base</span><span class="p">;</span>		<span class="cm">/* baud base clock for divisor setting */</span>
	<span class="kt">int</span> <span class="n">custom_divisor</span><span class="p">;</span>	<span class="cm">/* custom_divisor kludge, this is for</span>
<span class="cm">				   baud_base (different from what goes to the</span>
<span class="cm">				   chip!) */</span>
	<span class="n">__u16</span> <span class="n">last_set_data_urb_value</span> <span class="p">;</span>
				<span class="cm">/* the last data state set - needed for doing</span>
<span class="cm">				 * a break</span>
<span class="cm">				 */</span>
	<span class="kt">int</span> <span class="n">flags</span><span class="p">;</span>		<span class="cm">/* some ASYNC_xxxx flags are supported */</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">last_dtr_rts</span><span class="p">;</span>	<span class="cm">/* saved modem control outputs */</span>
	<span class="k">struct</span> <span class="n">async_icount</span>	<span class="n">icount</span><span class="p">;</span>
	<span class="n">wait_queue_head_t</span> <span class="n">delta_msr_wait</span><span class="p">;</span> <span class="cm">/* Used for TIOCMIWAIT */</span>
	<span class="kt">char</span> <span class="n">prev_status</span><span class="p">;</span>        <span class="cm">/* Used for TIOCMIWAIT */</span>
	<span class="n">bool</span> <span class="n">dev_gone</span><span class="p">;</span>        <span class="cm">/* Used to abort TIOCMIWAIT */</span>
	<span class="kt">char</span> <span class="n">transmit_empty</span><span class="p">;</span>	<span class="cm">/* If transmitter is empty or not */</span>
	<span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">;</span>
	<span class="n">__u16</span> <span class="n">interface</span><span class="p">;</span>	<span class="cm">/* FT2232C, FT2232H or FT4232H port interface</span>
<span class="cm">				   (0 for FT232/245) */</span>

	<span class="n">speed_t</span> <span class="n">force_baud</span><span class="p">;</span>	<span class="cm">/* if non-zero, force the baud rate to</span>
<span class="cm">				   this value */</span>
	<span class="kt">int</span> <span class="n">force_rtscts</span><span class="p">;</span>	<span class="cm">/* if non-zero, force RTS-CTS to always</span>
<span class="cm">				   be enabled */</span>

	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">latency</span><span class="p">;</span>		<span class="cm">/* latency setting in use */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">max_packet_size</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">mutex</span> <span class="n">cfg_lock</span><span class="p">;</span> <span class="cm">/* Avoid mess by parallel calls of config ioctl() and change_speed() */</span>
<span class="p">};</span>

<span class="cm">/* struct ftdi_sio_quirk is used by devices requiring special attention. */</span>
<span class="k">struct</span> <span class="n">ftdi_sio_quirk</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">probe</span><span class="p">)(</span><span class="k">struct</span> <span class="n">usb_serial</span> <span class="o">*</span><span class="p">);</span>
	<span class="cm">/* Special settings for probed ports. */</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">port_probe</span><span class="p">)(</span><span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span>   <span class="n">ftdi_jtag_probe</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial</span> <span class="o">*</span><span class="n">serial</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span>   <span class="n">ftdi_mtxorb_hack_setup</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial</span> <span class="o">*</span><span class="n">serial</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span>   <span class="n">ftdi_NDI_device_setup</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial</span> <span class="o">*</span><span class="n">serial</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span>   <span class="n">ftdi_stmclite_probe</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial</span> <span class="o">*</span><span class="n">serial</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span>   <span class="n">ftdi_8u2232c_probe</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial</span> <span class="o">*</span><span class="n">serial</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span>  <span class="n">ftdi_USB_UIRT_setup</span><span class="p">(</span><span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span>  <span class="n">ftdi_HE_TIRA1_setup</span><span class="p">(</span><span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span><span class="p">);</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">ftdi_sio_quirk</span> <span class="n">ftdi_jtag_quirk</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">probe</span>	<span class="o">=</span> <span class="n">ftdi_jtag_probe</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">ftdi_sio_quirk</span> <span class="n">ftdi_mtxorb_hack_quirk</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">probe</span>  <span class="o">=</span> <span class="n">ftdi_mtxorb_hack_setup</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">ftdi_sio_quirk</span> <span class="n">ftdi_NDI_device_quirk</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">probe</span>	<span class="o">=</span> <span class="n">ftdi_NDI_device_setup</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">ftdi_sio_quirk</span> <span class="n">ftdi_USB_UIRT_quirk</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">port_probe</span> <span class="o">=</span> <span class="n">ftdi_USB_UIRT_setup</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">ftdi_sio_quirk</span> <span class="n">ftdi_HE_TIRA1_quirk</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">port_probe</span> <span class="o">=</span> <span class="n">ftdi_HE_TIRA1_setup</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">ftdi_sio_quirk</span> <span class="n">ftdi_stmclite_quirk</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">probe</span>	<span class="o">=</span> <span class="n">ftdi_stmclite_probe</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">ftdi_sio_quirk</span> <span class="n">ftdi_8u2232c_quirk</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">probe</span>	<span class="o">=</span> <span class="n">ftdi_8u2232c_probe</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * The 8U232AM has the same API as the sio except for:</span>
<span class="cm"> * - it can support MUCH higher baudrates; up to:</span>
<span class="cm"> *   o 921600 for RS232 and 2000000 for RS422/485 at 48MHz</span>
<span class="cm"> *   o 230400 at 12MHz</span>
<span class="cm"> *   so .. 8U232AM&#39;s baudrate setting codes are different</span>
<span class="cm"> * - it has a two byte status code.</span>
<span class="cm"> * - it returns characters every 16ms (the FTDI does it every 40ms)</span>
<span class="cm"> *</span>
<span class="cm"> * the bcdDevice value is used to differentiate FT232BM and FT245BM from</span>
<span class="cm"> * the earlier FT8U232AM and FT8U232BM.  For now, include all known VID/PID</span>
<span class="cm"> * combinations in both tables.</span>
<span class="cm"> * FIXME: perhaps bcdDevice can also identify 12MHz FT8U232AM devices,</span>
<span class="cm"> * but I don&#39;t know if those ever went into mass production. [Ian Abbott]</span>
<span class="cm"> */</span>



<span class="cm">/*</span>
<span class="cm"> * Device ID not listed? Test via module params product/vendor or</span>
<span class="cm"> * /sys/bus/usb/ftdi_sio/new_id, then send patch/report!</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">usb_device_id</span> <span class="n">id_table_combined</span> <span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ZEITCONTROL_TAGTRACE_MIFARE_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_CTI_MINI_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_CTI_NANO_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_AMC232_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_CANUSB_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_CANDAPTER_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_NXTCAM_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_SCS_DEVICE_0_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_SCS_DEVICE_1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_SCS_DEVICE_2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_SCS_DEVICE_3_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_SCS_DEVICE_4_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_SCS_DEVICE_5_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_SCS_DEVICE_6_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_SCS_DEVICE_7_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_USINT_CAT_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_USINT_WKEY_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_USINT_RS232_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ACTZWAVE_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_IRTRANS_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_IPLUS_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_IPLUS2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_DMX4ALL</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_SIO_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_8U232AM_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_8U232AM_ALT_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_232RL_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_8U2232C_PID</span><span class="p">)</span> <span class="p">,</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_8u2232c_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_4232H_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_232H_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_FTX_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_MICRO_CHAMELEON_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_RELAIS_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_OPENDCC_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_OPENDCC_SNIFFER_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_OPENDCC_THROTTLE_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_OPENDCC_GATEWAY_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_OPENDCC_GBM_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">INTERBIOMETRICS_VID</span><span class="p">,</span> <span class="n">INTERBIOMETRICS_IOBOARD_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">INTERBIOMETRICS_VID</span><span class="p">,</span> <span class="n">INTERBIOMETRICS_MINI_IOBOARD_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_SPROG_II</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_LENZ_LIUSB_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_XF_632_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_XF_634_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_XF_547_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_XF_633_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_XF_631_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_XF_635_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_XF_640_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_XF_642_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_DSS20_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_URBAN_0_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_URBAN_1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_NF_RIC_VID</span><span class="p">,</span> <span class="n">FTDI_NF_RIC_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_VNHCPCUSB_D_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_MTXORB_0_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_MTXORB_1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_MTXORB_2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_MTXORB_3_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_MTXORB_4_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_MTXORB_5_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_MTXORB_6_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_R2000KU_TRUE_RNG</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_VARDAAN_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0100_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0101_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0102_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0103_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0104_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0105_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0106_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0107_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0108_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0109_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_010A_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_010B_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_010C_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_010D_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_010E_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_010F_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0110_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0111_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0112_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0113_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0114_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0115_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0116_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0117_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0118_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0119_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_011A_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_011B_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_011C_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_011D_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_011E_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_011F_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0120_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0121_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0122_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0123_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0124_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0125_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0126_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0127_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_mtxorb_hack_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0128_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0129_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_012A_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_012B_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_012C_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_mtxorb_hack_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_012D_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_012E_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_012F_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0130_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0131_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0132_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0133_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0134_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0135_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0136_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0137_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0138_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0139_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_013A_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_013B_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_013C_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_013D_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_013E_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_013F_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0140_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0141_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0142_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0143_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0144_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0145_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0146_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0147_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0148_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0149_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_014A_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_014B_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_014C_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_014D_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_014E_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_014F_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0150_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0151_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0152_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0153_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_mtxorb_hack_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0154_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_mtxorb_hack_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0155_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_mtxorb_hack_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0156_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_mtxorb_hack_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0157_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_mtxorb_hack_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0158_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_mtxorb_hack_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0159_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_015A_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_015B_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_015C_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_015D_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_015E_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_015F_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0160_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0161_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0162_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0163_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0164_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0165_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0166_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0167_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0168_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0169_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_016A_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_016B_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_016C_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_016D_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_016E_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_016F_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0170_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0171_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0172_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0173_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0174_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0175_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0176_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0177_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0178_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0179_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_017A_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_017B_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_017C_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_017D_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_017E_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_017F_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0180_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0181_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0182_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0183_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0184_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0185_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0186_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0187_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0188_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0189_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_018A_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_018B_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_018C_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_018D_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_018E_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_018F_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0190_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0191_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0192_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0193_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0194_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0195_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0196_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0197_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0198_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_0199_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_019A_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_019B_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_019C_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_019D_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_019E_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_019F_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01A0_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01A1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01A2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01A3_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01A4_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01A5_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01A6_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01A7_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01A8_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01A9_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01AA_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01AB_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01AC_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01AD_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01AE_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01AF_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01B0_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01B1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01B2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01B3_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01B4_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01B5_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01B6_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01B7_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01B8_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01B9_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01BA_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01BB_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01BC_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01BD_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01BE_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01BF_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01C0_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01C1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01C2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01C3_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01C4_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01C5_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01C6_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01C7_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01C8_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01C9_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01CA_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01CB_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01CC_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01CD_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01CE_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01CF_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01D0_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01D1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01D2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01D3_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01D4_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01D5_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01D6_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01D7_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01D8_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01D9_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01DA_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01DB_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01DC_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01DD_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01DE_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01DF_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01E0_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01E1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01E2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01E3_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01E4_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01E5_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01E6_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01E7_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01E8_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01E9_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01EA_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01EB_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01EC_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01ED_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01EE_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01EF_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01F0_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01F1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01F2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01F3_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01F4_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01F5_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01F6_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01F7_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01F8_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01F9_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01FA_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01FB_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01FC_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01FD_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01FE_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MTXORB_VID</span><span class="p">,</span> <span class="n">MTXORB_FTDI_RANGE_01FF_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_PERLE_ULTRAPORT_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_PIEGROUP_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_TNC_X_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_USBX_707_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2101_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2102_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2103_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2104_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2106_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2201_1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2201_2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2202_1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2202_2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2203_1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2203_2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2401_1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2401_2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2401_3_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2401_4_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2402_1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2402_2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2402_3_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2402_4_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2403_1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2403_2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2403_3_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2403_4_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2801_1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2801_2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2801_3_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2801_4_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2801_5_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2801_6_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2801_7_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2801_8_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2802_1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2802_2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2802_3_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2802_4_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2802_5_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2802_6_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2802_7_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2802_8_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2803_1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2803_2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2803_3_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2803_4_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2803_5_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2803_6_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2803_7_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2803_8_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2803R_1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2803R_2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2803R_3_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">SEALEVEL_VID</span><span class="p">,</span> <span class="n">SEALEVEL_2803R_4_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">IDTECH_VID</span><span class="p">,</span> <span class="n">IDTECH_IDT1221U_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">OCT_VID</span><span class="p">,</span> <span class="n">OCT_US101_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">OCT_VID</span><span class="p">,</span> <span class="n">OCT_DK201_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_HE_TIRA1_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_HE_TIRA1_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_USB_UIRT_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_USB_UIRT_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">PROTEGO_SPECIAL_1</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">PROTEGO_R2X0</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">PROTEGO_SPECIAL_3</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">PROTEGO_SPECIAL_4</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_GUDEADS_E808_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_GUDEADS_E809_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_GUDEADS_E80A_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_GUDEADS_E80B_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_GUDEADS_E80C_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_GUDEADS_E80D_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_GUDEADS_E80E_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_GUDEADS_E80F_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_GUDEADS_E888_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_GUDEADS_E889_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_GUDEADS_E88A_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_GUDEADS_E88B_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_GUDEADS_E88C_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_GUDEADS_E88D_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_GUDEADS_E88E_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_GUDEADS_E88F_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_UO100_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_UM100_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_UR100_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_ALC8500_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_PYRAMID_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_FHZ1000PC_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_IBS_US485_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_IBS_PICPRO_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_IBS_PCMCIA_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_IBS_PK1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_IBS_RS232MON_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_IBS_APP70_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_IBS_PEDO_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_IBS_PROD_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_TAVIR_STK500_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="cm">/*</span>
<span class="cm">	 * ELV devices:</span>
<span class="cm">	 */</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_USR_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_MSM1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_KL100_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_WS550_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_EC3000_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_WS888_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_TWS550_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_FEM_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_CLI7000_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_PPS7330_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_TFM100_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_UDF77_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_UIO88_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_UAD8_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_UDA7_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_USI2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_T1100_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_PCD200_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_ULA200_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_CSI8_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_EM1000DL_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_PCK100_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_RFP500_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_FS20SIG_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_UTP8_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_WS300PC_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_WS444PC_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_FHZ1300PC_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_EM1010PC_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_WS500_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_HS485_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_UMS100_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_TFD128_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_FM3RX_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELV_WS777_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">LINX_SDMUSBQSS_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">LINX_MASTERDEVEL2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">LINX_FUTURE_0_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">LINX_FUTURE_1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">LINX_FUTURE_2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_CCSICDU20_0_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_CCSICDU40_1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_CCSMACHX_2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_CCSLOAD_N_GO_3_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_CCSICDU64_4_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_CCSPRIME8_5_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">INSIDE_ACCESSO</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">INTREPID_VID</span><span class="p">,</span> <span class="n">INTREPID_VALUECAN_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">INTREPID_VID</span><span class="p">,</span> <span class="n">INTREPID_NEOVI_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FALCOM_VID</span><span class="p">,</span> <span class="n">FALCOM_TWIST_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FALCOM_VID</span><span class="p">,</span> <span class="n">FALCOM_SAMBA_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_SUUNTO_SPORTS_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_OCEANIC_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">TTI_VID</span><span class="p">,</span> <span class="n">TTI_QL355P_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_RM_CANVIEW_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">ACTON_VID</span><span class="p">,</span> <span class="n">ACTON_SPECTRAPRO_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">CONTEC_VID</span><span class="p">,</span> <span class="n">CONTEC_COM1USBH_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">BANDB_VID</span><span class="p">,</span> <span class="n">BANDB_USOTL4_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">BANDB_VID</span><span class="p">,</span> <span class="n">BANDB_USTL4_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">BANDB_VID</span><span class="p">,</span> <span class="n">BANDB_USO9ML2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">BANDB_VID</span><span class="p">,</span> <span class="n">BANDB_USOPTL4_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">BANDB_VID</span><span class="p">,</span> <span class="n">BANDB_USPTL4_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">BANDB_VID</span><span class="p">,</span> <span class="n">BANDB_USO9ML2DR_2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">BANDB_VID</span><span class="p">,</span> <span class="n">BANDB_USO9ML2DR_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">BANDB_VID</span><span class="p">,</span> <span class="n">BANDB_USOPTL4DR2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">BANDB_VID</span><span class="p">,</span> <span class="n">BANDB_USOPTL4DR_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">BANDB_VID</span><span class="p">,</span> <span class="n">BANDB_485USB9F_2W_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">BANDB_VID</span><span class="p">,</span> <span class="n">BANDB_485USB9F_4W_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">BANDB_VID</span><span class="p">,</span> <span class="n">BANDB_232USB9M_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">BANDB_VID</span><span class="p">,</span> <span class="n">BANDB_485USBTB_2W_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">BANDB_VID</span><span class="p">,</span> <span class="n">BANDB_485USBTB_4W_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">BANDB_VID</span><span class="p">,</span> <span class="n">BANDB_TTL5USB9M_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">BANDB_VID</span><span class="p">,</span> <span class="n">BANDB_TTL3USB9M_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">BANDB_VID</span><span class="p">,</span> <span class="n">BANDB_ZZ_PROG1_USB_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">EVER_ECO_PRO_CDS</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_4N_GALAXY_DE_1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_4N_GALAXY_DE_2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_4N_GALAXY_DE_3_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">XSENS_CONVERTER_0_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">XSENS_CONVERTER_1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">XSENS_CONVERTER_2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">XSENS_CONVERTER_3_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">XSENS_CONVERTER_4_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">XSENS_CONVERTER_5_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">XSENS_CONVERTER_6_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">XSENS_CONVERTER_7_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MOBILITY_VID</span><span class="p">,</span> <span class="n">MOBILITY_USB_SERIAL_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ACTIVE_ROBOTS_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_MHAM_KW_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_MHAM_YS_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_MHAM_Y6_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_MHAM_Y8_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_MHAM_IC_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_MHAM_DB9_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_MHAM_RS232_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_MHAM_Y9_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_TERATRONIK_VCP_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_TERATRONIK_D2XX_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">EVOLUTION_VID</span><span class="p">,</span> <span class="n">EVOLUTION_ER1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">EVOLUTION_VID</span><span class="p">,</span> <span class="n">EVO_HYBRID_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">EVOLUTION_VID</span><span class="p">,</span> <span class="n">EVO_RCM4_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ARTEMIS_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ATIK_ATK16_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ATIK_ATK16C_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ATIK_ATK16HR_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ATIK_ATK16HRC_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ATIK_ATK16IC_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">KOBIL_VID</span><span class="p">,</span> <span class="n">KOBIL_CONV_B1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">KOBIL_VID</span><span class="p">,</span> <span class="n">KOBIL_CONV_KAAN_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">POSIFLEX_VID</span><span class="p">,</span> <span class="n">POSIFLEX_PP7000_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_TTUSB_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ECLO_COM_1WIRE_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_WESTREX_MODEL_777_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_WESTREX_MODEL_8900F_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_PCDJ_DAC2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_RRCIRKITS_LOCOBUFFER_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ASK_RDR400_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">ICOM_VID</span><span class="p">,</span> <span class="n">ICOM_ID_1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">ICOM_VID</span><span class="p">,</span> <span class="n">ICOM_OPC_U_UC_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">ICOM_VID</span><span class="p">,</span> <span class="n">ICOM_ID_RP2C1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">ICOM_VID</span><span class="p">,</span> <span class="n">ICOM_ID_RP2C2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">ICOM_VID</span><span class="p">,</span> <span class="n">ICOM_ID_RP2D_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">ICOM_VID</span><span class="p">,</span> <span class="n">ICOM_ID_RP2VT_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">ICOM_VID</span><span class="p">,</span> <span class="n">ICOM_ID_RP2VR_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">ICOM_VID</span><span class="p">,</span> <span class="n">ICOM_ID_RP4KVT_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">ICOM_VID</span><span class="p">,</span> <span class="n">ICOM_ID_RP4KVR_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">ICOM_VID</span><span class="p">,</span> <span class="n">ICOM_ID_RP2KVT_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">ICOM_VID</span><span class="p">,</span> <span class="n">ICOM_ID_RP2KVR_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ACG_HFDUAL_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_YEI_SERVOCENTER31_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_THORLABS_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">TESTO_VID</span><span class="p">,</span> <span class="n">TESTO_USB_INTERFACE_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_GAMMA_SCOUT_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_TACTRIX_OPENPORT_13M_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_TACTRIX_OPENPORT_13S_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_TACTRIX_OPENPORT_13U_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">ELEKTOR_VID</span><span class="p">,</span> <span class="n">ELEKTOR_FT323R_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_NDI_HUC_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_NDI_device_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_NDI_SPECTRA_SCU_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_NDI_device_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_NDI_FUTURE_2_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_NDI_device_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_NDI_FUTURE_3_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_NDI_device_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_NDI_AURORA_SCU_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_NDI_device_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">TELLDUS_VID</span><span class="p">,</span> <span class="n">TELLDUS_TELLSTICK_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">RTSYSTEMS_VID</span><span class="p">,</span> <span class="n">RTSYSTEMS_SERIAL_VX7_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">RTSYSTEMS_VID</span><span class="p">,</span> <span class="n">RTSYSTEMS_CT29B_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">RTSYSTEMS_VID</span><span class="p">,</span> <span class="n">RTSYSTEMS_RTS01_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_MAXSTREAM_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_PHI_FISCO_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">TML_VID</span><span class="p">,</span> <span class="n">TML_USB_SERIAL_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_ELSTER_UNICOM_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_PROPOX_JTAGCABLEII_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_PROPOX_ISPCABLEIII_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">OLIMEX_VID</span><span class="p">,</span> <span class="n">OLIMEX_ARM_USB_OCD_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_jtag_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">OLIMEX_VID</span><span class="p">,</span> <span class="n">OLIMEX_ARM_USB_OCD_H_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_jtag_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FIC_VID</span><span class="p">,</span> <span class="n">FIC_NEO1973_DEBUG_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_jtag_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_OOCDLINK_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_jtag_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">LMI_LM3S_DEVEL_BOARD_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_jtag_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">LMI_LM3S_EVAL_BOARD_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_jtag_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">LMI_LM3S_ICDI_BOARD_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_jtag_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_TURTELIZER_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_jtag_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">RATOC_VENDOR_ID</span><span class="p">,</span> <span class="n">RATOC_PRODUCT_ID_USB60F</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_REU_TINY_PID</span><span class="p">)</span> <span class="p">},</span>

	<span class="cm">/* Papouch devices based on FTDI chip */</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_SB485_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_AP485_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_SB422_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_SB485_2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_AP485_2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_SB422_2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_SB485S_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_SB485C_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_LEC_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_SB232_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_TMU_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_IRAMP_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_DRAK5_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_QUIDO8x8_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_QUIDO4x4_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_QUIDO2x2_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_QUIDO10x1_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_QUIDO30x3_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_QUIDO60x3_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_QUIDO2x16_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_QUIDO3x32_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_DRAK6_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_UPSUSB_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_MU_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_SIMUKEY_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_AD4USB_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_GMUX_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PAPOUCH_VID</span><span class="p">,</span> <span class="n">PAPOUCH_GMSR_PID</span><span class="p">)</span> <span class="p">},</span>

	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_DOMINTELL_DGQG_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_DOMINTELL_DUSB_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">ALTI2_VID</span><span class="p">,</span> <span class="n">ALTI2_N3_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">DIEBOLD_BCS_SE923_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">ATMEL_VID</span><span class="p">,</span> <span class="n">STK541_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">DE_VID</span><span class="p">,</span> <span class="n">STB_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">DE_VID</span><span class="p">,</span> <span class="n">WHT_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">ADI_VID</span><span class="p">,</span> <span class="n">ADI_GNICE_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_jtag_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">ADI_VID</span><span class="p">,</span> <span class="n">ADI_GNICEPLUS_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_jtag_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MICROCHIP_VID</span><span class="p">,</span> <span class="n">MICROCHIP_USB_BOARD_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">JETI_VID</span><span class="p">,</span> <span class="n">JETI_SPC1201_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">MARVELL_VID</span><span class="p">,</span> <span class="n">MARVELL_SHEEVAPLUG_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_jtag_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">LARSENBRUSGAARD_VID</span><span class="p">,</span> <span class="n">LB_ALTITRACK_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">GN_OTOMETRICS_VID</span><span class="p">,</span> <span class="n">AURICAL_USB_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">PI_VID</span><span class="p">,</span> <span class="n">PI_E861_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">BAYER_VID</span><span class="p">,</span> <span class="n">BAYER_CONTOUR_CABLE_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">MARVELL_OPENRD_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_jtag_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">TI_XDS100V2_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_jtag_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">HAMEG_HO820_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">HAMEG_HO720_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">HAMEG_HO730_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">HAMEG_HO870_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">MJSG_GENERIC_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">MJSG_SR_RADIO_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">MJSG_HD_RADIO_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">MJSG_XM_RADIO_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">XVERVE_SIGNALYZER_ST_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_jtag_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">XVERVE_SIGNALYZER_SLITE_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_jtag_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">XVERVE_SIGNALYZER_SH2_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_jtag_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">XVERVE_SIGNALYZER_SH4_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_jtag_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">SEGWAY_RMP200_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">ACCESIO_COM4SM_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">IONICS_VID</span><span class="p">,</span> <span class="n">IONICS_PLUGCOMPUTER_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_jtag_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_CHAMSYS_24_MASTER_WING_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_CHAMSYS_PC_WING_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_CHAMSYS_USB_DMX_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_CHAMSYS_MIDI_TIMECODE_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_CHAMSYS_MINI_WING_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_CHAMSYS_MAXI_WING_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_CHAMSYS_MEDIA_WING_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_CHAMSYS_WING_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_SCIENCESCOPE_LOGBOOKML_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_SCIENCESCOPE_LS_LOGBOOK_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_SCIENCESCOPE_HS_LOGBOOK_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_CINTERION_MC55I_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_DOTEC_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">QIHARDWARE_VID</span><span class="p">,</span> <span class="n">MILKYMISTONE_JTAGSERIAL_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_jtag_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">ST_VID</span><span class="p">,</span> <span class="n">ST_STMCLT1030_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_stmclite_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_RF_R106</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_DISTORTEC_JTAG_LOCK_PICK_PID</span><span class="p">),</span>
		<span class="p">.</span><span class="n">driver_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_ulong_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ftdi_jtag_quirk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">USB_DEVICE</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">,</span> <span class="n">FTDI_LUMEL_PD12_PID</span><span class="p">)</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">},</span>					<span class="cm">/* Optional parameter entry */</span>
	<span class="p">{</span> <span class="p">}</span>					<span class="cm">/* Terminating entry */</span>
<span class="p">};</span>

<span class="n">MODULE_DEVICE_TABLE</span><span class="p">(</span><span class="n">usb</span><span class="p">,</span> <span class="n">id_table_combined</span><span class="p">);</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">ftdi_chip_name</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">[</span><span class="n">SIO</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;SIO&quot;</span><span class="p">,</span>	<span class="cm">/* the serial part of FT8U100AX */</span>
	<span class="p">[</span><span class="n">FT8U232AM</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;FT8U232AM&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">FT232BM</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;FT232BM&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">FT2232C</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;FT2232C&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">FT232RL</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;FT232RL&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">FT2232H</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;FT2232H&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">FT4232H</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;FT4232H&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">FT232H</span><span class="p">]</span>  <span class="o">=</span> <span class="s">&quot;FT232H&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">FTX</span><span class="p">]</span>     <span class="o">=</span> <span class="s">&quot;FT-X&quot;</span>
<span class="p">};</span>


<span class="cm">/* Used for TIOCMIWAIT */</span>
<span class="cp">#define FTDI_STATUS_B0_MASK	(FTDI_RS0_CTS | FTDI_RS0_DSR | FTDI_RS0_RI | FTDI_RS0_RLSD)</span>
<span class="cp">#define FTDI_STATUS_B1_MASK	(FTDI_RS_BI)</span>
<span class="cm">/* End TIOCMIWAIT */</span>

<span class="cp">#define FTDI_IMPL_ASYNC_FLAGS = (ASYNC_SPD_HI | ASYNC_SPD_VHI \</span>
<span class="cp"> | ASYNC_SPD_CUST | ASYNC_SPD_SHI | ASYNC_SPD_WARP)</span>

<span class="cm">/* function prototypes for a FTDI serial converter */</span>
<span class="k">static</span> <span class="kt">int</span>  <span class="n">ftdi_sio_probe</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial</span> <span class="o">*</span><span class="n">serial</span><span class="p">,</span>
					<span class="k">const</span> <span class="k">struct</span> <span class="n">usb_device_id</span> <span class="o">*</span><span class="n">id</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span>  <span class="n">ftdi_sio_port_probe</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span>  <span class="n">ftdi_sio_port_remove</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span>  <span class="n">ftdi_open</span><span class="p">(</span><span class="k">struct</span> <span class="n">tty_struct</span> <span class="o">*</span><span class="n">tty</span><span class="p">,</span> <span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">ftdi_close</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">ftdi_dtr_rts</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">,</span> <span class="kt">int</span> <span class="n">on</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">ftdi_process_read_urb</span><span class="p">(</span><span class="k">struct</span> <span class="n">urb</span> <span class="o">*</span><span class="n">urb</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">ftdi_prepare_write_buffer</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">,</span>
						<span class="kt">void</span> <span class="o">*</span><span class="n">dest</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">size</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">ftdi_set_termios</span><span class="p">(</span><span class="k">struct</span> <span class="n">tty_struct</span> <span class="o">*</span><span class="n">tty</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ktermios</span> <span class="o">*</span><span class="n">old</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span>  <span class="n">ftdi_tiocmget</span><span class="p">(</span><span class="k">struct</span> <span class="n">tty_struct</span> <span class="o">*</span><span class="n">tty</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span>  <span class="n">ftdi_tiocmset</span><span class="p">(</span><span class="k">struct</span> <span class="n">tty_struct</span> <span class="o">*</span><span class="n">tty</span><span class="p">,</span>
			<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">set</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">clear</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">ftdi_get_icount</span><span class="p">(</span><span class="k">struct</span> <span class="n">tty_struct</span> <span class="o">*</span><span class="n">tty</span><span class="p">,</span>
			   <span class="k">struct</span> <span class="n">serial_icounter_struct</span> <span class="o">*</span><span class="n">icount</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span>  <span class="n">ftdi_ioctl</span><span class="p">(</span><span class="k">struct</span> <span class="n">tty_struct</span> <span class="o">*</span><span class="n">tty</span><span class="p">,</span>
			<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cmd</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">arg</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">ftdi_break_ctl</span><span class="p">(</span><span class="k">struct</span> <span class="n">tty_struct</span> <span class="o">*</span><span class="n">tty</span><span class="p">,</span> <span class="kt">int</span> <span class="n">break_state</span><span class="p">);</span>

<span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="kt">int</span> <span class="n">ftdi_232am_baud_base_to_divisor</span><span class="p">(</span><span class="kt">int</span> <span class="n">baud</span><span class="p">,</span> <span class="kt">int</span> <span class="n">base</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="kt">int</span> <span class="n">ftdi_232am_baud_to_divisor</span><span class="p">(</span><span class="kt">int</span> <span class="n">baud</span><span class="p">);</span>
<span class="k">static</span> <span class="n">__u32</span> <span class="n">ftdi_232bm_baud_base_to_divisor</span><span class="p">(</span><span class="kt">int</span> <span class="n">baud</span><span class="p">,</span> <span class="kt">int</span> <span class="n">base</span><span class="p">);</span>
<span class="k">static</span> <span class="n">__u32</span> <span class="n">ftdi_232bm_baud_to_divisor</span><span class="p">(</span><span class="kt">int</span> <span class="n">baud</span><span class="p">);</span>
<span class="k">static</span> <span class="n">__u32</span> <span class="n">ftdi_2232h_baud_base_to_divisor</span><span class="p">(</span><span class="kt">int</span> <span class="n">baud</span><span class="p">,</span> <span class="kt">int</span> <span class="n">base</span><span class="p">);</span>
<span class="k">static</span> <span class="n">__u32</span> <span class="n">ftdi_2232h_baud_to_divisor</span><span class="p">(</span><span class="kt">int</span> <span class="n">baud</span><span class="p">);</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">usb_serial_driver</span> <span class="n">ftdi_sio_device</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">driver</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">owner</span> <span class="o">=</span>	<span class="n">THIS_MODULE</span><span class="p">,</span>
		<span class="p">.</span><span class="n">name</span> <span class="o">=</span>		<span class="s">&quot;ftdi_sio&quot;</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">.</span><span class="n">description</span> <span class="o">=</span>		<span class="s">&quot;FTDI USB Serial Device&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">id_table</span> <span class="o">=</span>		<span class="n">id_table_combined</span><span class="p">,</span>
	<span class="p">.</span><span class="n">num_ports</span> <span class="o">=</span>		<span class="mi">1</span><span class="p">,</span>
	<span class="p">.</span><span class="n">bulk_in_size</span> <span class="o">=</span>		<span class="mi">512</span><span class="p">,</span>
	<span class="p">.</span><span class="n">bulk_out_size</span> <span class="o">=</span>	<span class="mi">256</span><span class="p">,</span>
	<span class="p">.</span><span class="n">probe</span> <span class="o">=</span>		<span class="n">ftdi_sio_probe</span><span class="p">,</span>
	<span class="p">.</span><span class="n">port_probe</span> <span class="o">=</span>		<span class="n">ftdi_sio_port_probe</span><span class="p">,</span>
	<span class="p">.</span><span class="n">port_remove</span> <span class="o">=</span>		<span class="n">ftdi_sio_port_remove</span><span class="p">,</span>
	<span class="p">.</span><span class="n">open</span> <span class="o">=</span>			<span class="n">ftdi_open</span><span class="p">,</span>
	<span class="p">.</span><span class="n">close</span> <span class="o">=</span>		<span class="n">ftdi_close</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dtr_rts</span> <span class="o">=</span>		<span class="n">ftdi_dtr_rts</span><span class="p">,</span>
	<span class="p">.</span><span class="n">throttle</span> <span class="o">=</span>		<span class="n">usb_serial_generic_throttle</span><span class="p">,</span>
	<span class="p">.</span><span class="n">unthrottle</span> <span class="o">=</span>		<span class="n">usb_serial_generic_unthrottle</span><span class="p">,</span>
	<span class="p">.</span><span class="n">process_read_urb</span> <span class="o">=</span>	<span class="n">ftdi_process_read_urb</span><span class="p">,</span>
	<span class="p">.</span><span class="n">prepare_write_buffer</span> <span class="o">=</span>	<span class="n">ftdi_prepare_write_buffer</span><span class="p">,</span>
	<span class="p">.</span><span class="n">tiocmget</span> <span class="o">=</span>		<span class="n">ftdi_tiocmget</span><span class="p">,</span>
	<span class="p">.</span><span class="n">tiocmset</span> <span class="o">=</span>		<span class="n">ftdi_tiocmset</span><span class="p">,</span>
	<span class="p">.</span><span class="n">get_icount</span> <span class="o">=</span>           <span class="n">ftdi_get_icount</span><span class="p">,</span>
	<span class="p">.</span><span class="n">ioctl</span> <span class="o">=</span>		<span class="n">ftdi_ioctl</span><span class="p">,</span>
	<span class="p">.</span><span class="n">set_termios</span> <span class="o">=</span>		<span class="n">ftdi_set_termios</span><span class="p">,</span>
	<span class="p">.</span><span class="n">break_ctl</span> <span class="o">=</span>		<span class="n">ftdi_break_ctl</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">usb_serial_driver</span> <span class="o">*</span> <span class="k">const</span> <span class="n">serial_drivers</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="o">&amp;</span><span class="n">ftdi_sio_device</span><span class="p">,</span> <span class="nb">NULL</span>
<span class="p">};</span>


<span class="cp">#define WDR_TIMEOUT 5000 </span><span class="cm">/* default urb timeout */</span><span class="cp"></span>
<span class="cp">#define WDR_SHORT_TIMEOUT 1000	</span><span class="cm">/* shorter urb timeout */</span><span class="cp"></span>

<span class="cm">/* High and low are for DTR, RTS etc etc */</span>
<span class="cp">#define HIGH 1</span>
<span class="cp">#define LOW 0</span>

<span class="cm">/*</span>
<span class="cm"> * ***************************************************************************</span>
<span class="cm"> * Utility functions</span>
<span class="cm"> * ***************************************************************************</span>
<span class="cm"> */</span>

<span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="kt">int</span> <span class="nf">ftdi_232am_baud_base_to_divisor</span><span class="p">(</span><span class="kt">int</span> <span class="n">baud</span><span class="p">,</span> <span class="kt">int</span> <span class="n">base</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="kt">int</span> <span class="n">divisor</span><span class="p">;</span>
	<span class="cm">/* divisor shifted 3 bits to the left */</span>
	<span class="kt">int</span> <span class="n">divisor3</span> <span class="o">=</span> <span class="n">base</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">baud</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">divisor3</span> <span class="o">&amp;</span> <span class="mh">0x7</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span><span class="p">)</span>
		<span class="n">divisor3</span><span class="o">++</span><span class="p">;</span> <span class="cm">/* round x.7/8 up to x+1 */</span>
	<span class="n">divisor</span> <span class="o">=</span> <span class="n">divisor3</span> <span class="o">&gt;&gt;</span> <span class="mi">3</span><span class="p">;</span>
	<span class="n">divisor3</span> <span class="o">&amp;=</span> <span class="mh">0x7</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">divisor3</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
		<span class="n">divisor</span> <span class="o">|=</span> <span class="mh">0xc000</span><span class="p">;</span>
	<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">divisor3</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">)</span>
		<span class="n">divisor</span> <span class="o">|=</span> <span class="mh">0x4000</span><span class="p">;</span>
	<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">divisor3</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">divisor</span> <span class="o">|=</span> <span class="mh">0x8000</span><span class="p">;</span>
	<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">divisor</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
		<span class="n">divisor</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>	<span class="cm">/* special case for maximum baud rate */</span>
	<span class="k">return</span> <span class="n">divisor</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="kt">int</span> <span class="nf">ftdi_232am_baud_to_divisor</span><span class="p">(</span><span class="kt">int</span> <span class="n">baud</span><span class="p">)</span>
<span class="p">{</span>
	 <span class="k">return</span> <span class="n">ftdi_232am_baud_base_to_divisor</span><span class="p">(</span><span class="n">baud</span><span class="p">,</span> <span class="mi">48000000</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">__u32</span> <span class="nf">ftdi_232bm_baud_base_to_divisor</span><span class="p">(</span><span class="kt">int</span> <span class="n">baud</span><span class="p">,</span> <span class="kt">int</span> <span class="n">base</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">divfrac</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span> <span class="p">};</span>
	<span class="n">__u32</span> <span class="n">divisor</span><span class="p">;</span>
	<span class="cm">/* divisor shifted 3 bits to the left */</span>
	<span class="kt">int</span> <span class="n">divisor3</span> <span class="o">=</span> <span class="n">base</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">baud</span><span class="p">;</span>
	<span class="n">divisor</span> <span class="o">=</span> <span class="n">divisor3</span> <span class="o">&gt;&gt;</span> <span class="mi">3</span><span class="p">;</span>
	<span class="n">divisor</span> <span class="o">|=</span> <span class="p">(</span><span class="n">__u32</span><span class="p">)</span><span class="n">divfrac</span><span class="p">[</span><span class="n">divisor3</span> <span class="o">&amp;</span> <span class="mh">0x7</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">14</span><span class="p">;</span>
	<span class="cm">/* Deal with special cases for highest baud rates. */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">divisor</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
		<span class="n">divisor</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">divisor</span> <span class="o">==</span> <span class="mh">0x4001</span><span class="p">)</span>
		<span class="n">divisor</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">divisor</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">__u32</span> <span class="nf">ftdi_232bm_baud_to_divisor</span><span class="p">(</span><span class="kt">int</span> <span class="n">baud</span><span class="p">)</span>
<span class="p">{</span>
	 <span class="k">return</span> <span class="n">ftdi_232bm_baud_base_to_divisor</span><span class="p">(</span><span class="n">baud</span><span class="p">,</span> <span class="mi">48000000</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">__u32</span> <span class="nf">ftdi_2232h_baud_base_to_divisor</span><span class="p">(</span><span class="kt">int</span> <span class="n">baud</span><span class="p">,</span> <span class="kt">int</span> <span class="n">base</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">divfrac</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span> <span class="p">};</span>
	<span class="n">__u32</span> <span class="n">divisor</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">divisor3</span><span class="p">;</span>

	<span class="cm">/* hi-speed baud rate is 10-bit sampling instead of 16-bit */</span>
	<span class="n">divisor3</span> <span class="o">=</span> <span class="n">base</span> <span class="o">*</span> <span class="mi">8</span> <span class="o">/</span> <span class="p">(</span><span class="n">baud</span> <span class="o">*</span> <span class="mi">10</span><span class="p">);</span>

	<span class="n">divisor</span> <span class="o">=</span> <span class="n">divisor3</span> <span class="o">&gt;&gt;</span> <span class="mi">3</span><span class="p">;</span>
	<span class="n">divisor</span> <span class="o">|=</span> <span class="p">(</span><span class="n">__u32</span><span class="p">)</span><span class="n">divfrac</span><span class="p">[</span><span class="n">divisor3</span> <span class="o">&amp;</span> <span class="mh">0x7</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">14</span><span class="p">;</span>
	<span class="cm">/* Deal with special cases for highest baud rates. */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">divisor</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
		<span class="n">divisor</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">divisor</span> <span class="o">==</span> <span class="mh">0x4001</span><span class="p">)</span>
		<span class="n">divisor</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="cm">/*</span>
<span class="cm">	 * Set this bit to turn off a divide by 2.5 on baud rate generator</span>
<span class="cm">	 * This enables baud rates up to 12Mbaud but cannot reach below 1200</span>
<span class="cm">	 * baud with this bit set</span>
<span class="cm">	 */</span>
	<span class="n">divisor</span> <span class="o">|=</span> <span class="mh">0x00020000</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">divisor</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">__u32</span> <span class="nf">ftdi_2232h_baud_to_divisor</span><span class="p">(</span><span class="kt">int</span> <span class="n">baud</span><span class="p">)</span>
<span class="p">{</span>
	 <span class="k">return</span> <span class="n">ftdi_2232h_baud_base_to_divisor</span><span class="p">(</span><span class="n">baud</span><span class="p">,</span> <span class="mi">120000000</span><span class="p">);</span>
<span class="p">}</span>

<span class="cp">#define set_mctrl(port, set)		update_mctrl((port), (set), 0)</span>
<span class="cp">#define clear_mctrl(port, clear)	update_mctrl((port), 0, (clear))</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">update_mctrl</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">set</span><span class="p">,</span>
							<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">clear</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span> <span class="o">=</span> <span class="n">usb_get_serial_port_data</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
	<span class="kt">unsigned</span> <span class="n">urb_value</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">rv</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(((</span><span class="n">set</span> <span class="o">|</span> <span class="n">clear</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">TIOCM_DTR</span> <span class="o">|</span> <span class="n">TIOCM_RTS</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">dbg</span><span class="p">(</span><span class="s">&quot;%s - DTR|RTS not being set|cleared&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>	<span class="cm">/* no change */</span>
	<span class="p">}</span>

	<span class="n">clear</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">set</span><span class="p">;</span>	<span class="cm">/* &#39;set&#39; takes precedence over &#39;clear&#39; */</span>
	<span class="n">urb_value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">clear</span> <span class="o">&amp;</span> <span class="n">TIOCM_DTR</span><span class="p">)</span>
		<span class="n">urb_value</span> <span class="o">|=</span> <span class="n">FTDI_SIO_SET_DTR_LOW</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">clear</span> <span class="o">&amp;</span> <span class="n">TIOCM_RTS</span><span class="p">)</span>
		<span class="n">urb_value</span> <span class="o">|=</span> <span class="n">FTDI_SIO_SET_RTS_LOW</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">set</span> <span class="o">&amp;</span> <span class="n">TIOCM_DTR</span><span class="p">)</span>
		<span class="n">urb_value</span> <span class="o">|=</span> <span class="n">FTDI_SIO_SET_DTR_HIGH</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">set</span> <span class="o">&amp;</span> <span class="n">TIOCM_RTS</span><span class="p">)</span>
		<span class="n">urb_value</span> <span class="o">|=</span> <span class="n">FTDI_SIO_SET_RTS_HIGH</span><span class="p">;</span>
	<span class="n">rv</span> <span class="o">=</span> <span class="n">usb_control_msg</span><span class="p">(</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">serial</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span>
			       <span class="n">usb_sndctrlpipe</span><span class="p">(</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">serial</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
			       <span class="n">FTDI_SIO_SET_MODEM_CTRL_REQUEST</span><span class="p">,</span>
			       <span class="n">FTDI_SIO_SET_MODEM_CTRL_REQUEST_TYPE</span><span class="p">,</span>
			       <span class="n">urb_value</span><span class="p">,</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">interface</span><span class="p">,</span>
			       <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">WDR_TIMEOUT</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">rv</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">dbg</span><span class="p">(</span><span class="s">&quot;%s Error from MODEM_CTRL urb: DTR %s, RTS %s&quot;</span><span class="p">,</span>
				<span class="n">__func__</span><span class="p">,</span>
				<span class="p">(</span><span class="n">set</span> <span class="o">&amp;</span> <span class="n">TIOCM_DTR</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;HIGH&quot;</span> <span class="o">:</span>
				<span class="p">(</span><span class="n">clear</span> <span class="o">&amp;</span> <span class="n">TIOCM_DTR</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;LOW&quot;</span> <span class="o">:</span> <span class="s">&quot;unchanged&quot;</span><span class="p">,</span>
				<span class="p">(</span><span class="n">set</span> <span class="o">&amp;</span> <span class="n">TIOCM_RTS</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;HIGH&quot;</span> <span class="o">:</span>
				<span class="p">(</span><span class="n">clear</span> <span class="o">&amp;</span> <span class="n">TIOCM_RTS</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;LOW&quot;</span> <span class="o">:</span> <span class="s">&quot;unchanged&quot;</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">dbg</span><span class="p">(</span><span class="s">&quot;%s - DTR %s, RTS %s&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">,</span>
				<span class="p">(</span><span class="n">set</span> <span class="o">&amp;</span> <span class="n">TIOCM_DTR</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;HIGH&quot;</span> <span class="o">:</span>
				<span class="p">(</span><span class="n">clear</span> <span class="o">&amp;</span> <span class="n">TIOCM_DTR</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;LOW&quot;</span> <span class="o">:</span> <span class="s">&quot;unchanged&quot;</span><span class="p">,</span>
				<span class="p">(</span><span class="n">set</span> <span class="o">&amp;</span> <span class="n">TIOCM_RTS</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;HIGH&quot;</span> <span class="o">:</span>
				<span class="p">(</span><span class="n">clear</span> <span class="o">&amp;</span> <span class="n">TIOCM_RTS</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;LOW&quot;</span> <span class="o">:</span> <span class="s">&quot;unchanged&quot;</span><span class="p">);</span>
		<span class="cm">/* FIXME: locking on last_dtr_rts */</span>
		<span class="n">priv</span><span class="o">-&gt;</span><span class="n">last_dtr_rts</span> <span class="o">=</span> <span class="p">(</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">last_dtr_rts</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">clear</span><span class="p">)</span> <span class="o">|</span> <span class="n">set</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">rv</span><span class="p">;</span>
<span class="p">}</span>


<span class="k">static</span> <span class="n">__u32</span> <span class="nf">get_ftdi_divisor</span><span class="p">(</span><span class="k">struct</span> <span class="n">tty_struct</span> <span class="o">*</span><span class="n">tty</span><span class="p">,</span>
						<span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span> <span class="o">=</span> <span class="n">usb_get_serial_port_data</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
	<span class="n">__u32</span> <span class="n">div_value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">div_okay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">baud</span><span class="p">;</span>

	<span class="cm">/*</span>
<span class="cm">	 * The logic involved in setting the baudrate can be cleanly split into</span>
<span class="cm">	 * 3 steps.</span>
<span class="cm">	 * 1. Standard baud rates are set in tty-&gt;termios-&gt;c_cflag</span>
<span class="cm">	 * 2. If these are not enough, you can set any speed using alt_speed as</span>
<span class="cm">	 * follows:</span>
<span class="cm">	 *    - set tty-&gt;termios-&gt;c_cflag speed to B38400</span>
<span class="cm">	 *    - set your real speed in tty-&gt;alt_speed; it gets ignored when</span>
<span class="cm">	 *      alt_speed==0, (or)</span>
<span class="cm">	 *    - call TIOCSSERIAL ioctl with (struct serial_struct) set as</span>
<span class="cm">	 *	follows:</span>
<span class="cm">	 *      flags &amp; ASYNC_SPD_MASK == ASYNC_SPD_[HI, VHI, SHI, WARP],</span>
<span class="cm">	 *	this just sets alt_speed to (HI: 57600, VHI: 115200,</span>
<span class="cm">	 *	SHI: 230400, WARP: 460800)</span>
<span class="cm">	 * ** Steps 1, 2 are done courtesy of tty_get_baud_rate</span>
<span class="cm">	 * 3. You can also set baud rate by setting custom divisor as follows</span>
<span class="cm">	 *    - set tty-&gt;termios-&gt;c_cflag speed to B38400</span>
<span class="cm">	 *    - call TIOCSSERIAL ioctl with (struct serial_struct) set as</span>
<span class="cm">	 *	follows:</span>
<span class="cm">	 *      o flags &amp; ASYNC_SPD_MASK == ASYNC_SPD_CUST</span>
<span class="cm">	 *      o custom_divisor set to baud_base / your_new_baudrate</span>
<span class="cm">	 * ** Step 3 is done courtesy of code borrowed from serial.c</span>
<span class="cm">	 *    I should really spend some time and separate + move this common</span>
<span class="cm">	 *    code to serial.c, it is replicated in nearly every serial driver</span>
<span class="cm">	 *    you see.</span>
<span class="cm">	 */</span>

	<span class="cm">/* 1. Get the baud rate from the tty settings, this observes</span>
<span class="cm">	      alt_speed hack */</span>

	<span class="n">baud</span> <span class="o">=</span> <span class="n">tty_get_baud_rate</span><span class="p">(</span><span class="n">tty</span><span class="p">);</span>
	<span class="n">dbg</span><span class="p">(</span><span class="s">&quot;%s - tty_get_baud_rate reports speed %d&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">,</span> <span class="n">baud</span><span class="p">);</span>

	<span class="cm">/* 2. Observe async-compatible custom_divisor hack, update baudrate</span>
<span class="cm">	   if needed */</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">baud</span> <span class="o">==</span> <span class="mi">38400</span> <span class="o">&amp;&amp;</span>
	    <span class="p">((</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">ASYNC_SPD_MASK</span><span class="p">)</span> <span class="o">==</span> <span class="n">ASYNC_SPD_CUST</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	     <span class="p">(</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">custom_divisor</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">baud</span> <span class="o">=</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">baud_base</span> <span class="o">/</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">custom_divisor</span><span class="p">;</span>
		<span class="n">dbg</span><span class="p">(</span><span class="s">&quot;%s - custom divisor %d sets baud rate to %d&quot;</span><span class="p">,</span>
				<span class="n">__func__</span><span class="p">,</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">custom_divisor</span><span class="p">,</span> <span class="n">baud</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="cm">/* 3. Convert baudrate to device-specific divisor */</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">baud</span><span class="p">)</span>
		<span class="n">baud</span> <span class="o">=</span> <span class="mi">9600</span><span class="p">;</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">SIO</span>: <span class="cm">/* SIO chip */</span>
		<span class="k">switch</span> <span class="p">(</span><span class="n">baud</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="mi">300</span>: <span class="n">div_value</span> <span class="o">=</span> <span class="n">ftdi_sio_b300</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mi">600</span>: <span class="n">div_value</span> <span class="o">=</span> <span class="n">ftdi_sio_b600</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mi">1200</span>: <span class="n">div_value</span> <span class="o">=</span> <span class="n">ftdi_sio_b1200</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mi">2400</span>: <span class="n">div_value</span> <span class="o">=</span> <span class="n">ftdi_sio_b2400</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mi">4800</span>: <span class="n">div_value</span> <span class="o">=</span> <span class="n">ftdi_sio_b4800</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mi">9600</span>: <span class="n">div_value</span> <span class="o">=</span> <span class="n">ftdi_sio_b9600</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mi">19200</span>: <span class="n">div_value</span> <span class="o">=</span> <span class="n">ftdi_sio_b19200</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mi">38400</span>: <span class="n">div_value</span> <span class="o">=</span> <span class="n">ftdi_sio_b38400</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mi">57600</span>: <span class="n">div_value</span> <span class="o">=</span> <span class="n">ftdi_sio_b57600</span><span class="p">;</span>  <span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mi">115200</span>: <span class="n">div_value</span> <span class="o">=</span> <span class="n">ftdi_sio_b115200</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
		<span class="p">}</span> <span class="cm">/* baud */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">div_value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">dbg</span><span class="p">(</span><span class="s">&quot;%s - Baudrate (%d) requested is not supported&quot;</span><span class="p">,</span>
							<span class="n">__func__</span><span class="p">,</span>  <span class="n">baud</span><span class="p">);</span>
			<span class="n">div_value</span> <span class="o">=</span> <span class="n">ftdi_sio_b9600</span><span class="p">;</span>
			<span class="n">baud</span> <span class="o">=</span> <span class="mi">9600</span><span class="p">;</span>
			<span class="n">div_okay</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">FT8U232AM</span>: <span class="cm">/* 8U232AM chip */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">baud</span> <span class="o">&lt;=</span> <span class="mi">3000000</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">div_value</span> <span class="o">=</span> <span class="n">ftdi_232am_baud_to_divisor</span><span class="p">(</span><span class="n">baud</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">dbg</span><span class="p">(</span><span class="s">&quot;%s - Baud rate too high!&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">);</span>
			<span class="n">baud</span> <span class="o">=</span> <span class="mi">9600</span><span class="p">;</span>
			<span class="n">div_value</span> <span class="o">=</span> <span class="n">ftdi_232am_baud_to_divisor</span><span class="p">(</span><span class="mi">9600</span><span class="p">);</span>
			<span class="n">div_okay</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">FT232BM</span>: <span class="cm">/* FT232BM chip */</span>
	<span class="k">case</span> <span class="n">FT2232C</span>: <span class="cm">/* FT2232C chip */</span>
	<span class="k">case</span> <span class="n">FT232RL</span>: <span class="cm">/* FT232RL chip */</span>
	<span class="k">case</span> <span class="n">FTX</span>:     <span class="cm">/* FT-X series */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">baud</span> <span class="o">&lt;=</span> <span class="mi">3000000</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">__u16</span> <span class="n">product_id</span> <span class="o">=</span> <span class="n">le16_to_cpu</span><span class="p">(</span>
				<span class="n">port</span><span class="o">-&gt;</span><span class="n">serial</span><span class="o">-&gt;</span><span class="n">dev</span><span class="o">-&gt;</span><span class="n">descriptor</span><span class="p">.</span><span class="n">idProduct</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(((</span><span class="n">FTDI_NDI_HUC_PID</span> <span class="o">==</span> <span class="n">product_id</span><span class="p">)</span> <span class="o">||</span>
			     <span class="p">(</span><span class="n">FTDI_NDI_SPECTRA_SCU_PID</span> <span class="o">==</span> <span class="n">product_id</span><span class="p">)</span> <span class="o">||</span>
			     <span class="p">(</span><span class="n">FTDI_NDI_FUTURE_2_PID</span> <span class="o">==</span> <span class="n">product_id</span><span class="p">)</span> <span class="o">||</span>
			     <span class="p">(</span><span class="n">FTDI_NDI_FUTURE_3_PID</span> <span class="o">==</span> <span class="n">product_id</span><span class="p">)</span> <span class="o">||</span>
			     <span class="p">(</span><span class="n">FTDI_NDI_AURORA_SCU_PID</span> <span class="o">==</span> <span class="n">product_id</span><span class="p">))</span> <span class="o">&amp;&amp;</span>
			    <span class="p">(</span><span class="n">baud</span> <span class="o">==</span> <span class="mi">19200</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">baud</span> <span class="o">=</span> <span class="mi">1200000</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">div_value</span> <span class="o">=</span> <span class="n">ftdi_232bm_baud_to_divisor</span><span class="p">(</span><span class="n">baud</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">dbg</span><span class="p">(</span><span class="s">&quot;%s - Baud rate too high!&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">);</span>
			<span class="n">div_value</span> <span class="o">=</span> <span class="n">ftdi_232bm_baud_to_divisor</span><span class="p">(</span><span class="mi">9600</span><span class="p">);</span>
			<span class="n">div_okay</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">baud</span> <span class="o">=</span> <span class="mi">9600</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">FT2232H</span>: <span class="cm">/* FT2232H chip */</span>
	<span class="k">case</span> <span class="n">FT4232H</span>: <span class="cm">/* FT4232H chip */</span>
	<span class="k">case</span> <span class="n">FT232H</span>:  <span class="cm">/* FT232H chip */</span>
		<span class="k">if</span> <span class="p">((</span><span class="n">baud</span> <span class="o">&lt;=</span> <span class="mi">12000000</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">baud</span> <span class="o">&gt;=</span> <span class="mi">1200</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">div_value</span> <span class="o">=</span> <span class="n">ftdi_2232h_baud_to_divisor</span><span class="p">(</span><span class="n">baud</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">baud</span> <span class="o">&lt;</span> <span class="mi">1200</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">div_value</span> <span class="o">=</span> <span class="n">ftdi_232bm_baud_to_divisor</span><span class="p">(</span><span class="n">baud</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">dbg</span><span class="p">(</span><span class="s">&quot;%s - Baud rate too high!&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">);</span>
			<span class="n">div_value</span> <span class="o">=</span> <span class="n">ftdi_232bm_baud_to_divisor</span><span class="p">(</span><span class="mi">9600</span><span class="p">);</span>
			<span class="n">div_okay</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">baud</span> <span class="o">=</span> <span class="mi">9600</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span> <span class="cm">/* priv-&gt;chip_type */</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">div_okay</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">dbg</span><span class="p">(</span><span class="s">&quot;%s - Baud rate set to %d (divisor 0x%lX) on chip %s&quot;</span><span class="p">,</span>
			<span class="n">__func__</span><span class="p">,</span> <span class="n">baud</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span><span class="n">div_value</span><span class="p">,</span>
			<span class="n">ftdi_chip_name</span><span class="p">[</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span><span class="p">]);</span>
	<span class="p">}</span>

	<span class="n">tty_encode_baud_rate</span><span class="p">(</span><span class="n">tty</span><span class="p">,</span> <span class="n">baud</span><span class="p">,</span> <span class="n">baud</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">div_value</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">change_speed</span><span class="p">(</span><span class="k">struct</span> <span class="n">tty_struct</span> <span class="o">*</span><span class="n">tty</span><span class="p">,</span> <span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span> <span class="o">=</span> <span class="n">usb_get_serial_port_data</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
	<span class="n">__u16</span> <span class="n">urb_value</span><span class="p">;</span>
	<span class="n">__u16</span> <span class="n">urb_index</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">urb_index_value</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">rv</span><span class="p">;</span>

	<span class="n">urb_index_value</span> <span class="o">=</span> <span class="n">get_ftdi_divisor</span><span class="p">(</span><span class="n">tty</span><span class="p">,</span> <span class="n">port</span><span class="p">);</span>
	<span class="n">urb_value</span> <span class="o">=</span> <span class="p">(</span><span class="n">__u16</span><span class="p">)</span><span class="n">urb_index_value</span><span class="p">;</span>
	<span class="n">urb_index</span> <span class="o">=</span> <span class="p">(</span><span class="n">__u16</span><span class="p">)(</span><span class="n">urb_index_value</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">==</span> <span class="n">FT2232C</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">==</span> <span class="n">FT2232H</span><span class="p">)</span> <span class="o">||</span>
		<span class="p">(</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">==</span> <span class="n">FT4232H</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">==</span> <span class="n">FT232H</span><span class="p">))</span> <span class="p">{</span>
		<span class="cm">/* Probably the BM type needs the MSB of the encoded fractional</span>
<span class="cm">		 * divider also moved like for the chips above. Any infos? */</span>
		<span class="n">urb_index</span> <span class="o">=</span> <span class="p">(</span><span class="n">__u16</span><span class="p">)((</span><span class="n">urb_index</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">interface</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">rv</span> <span class="o">=</span> <span class="n">usb_control_msg</span><span class="p">(</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">serial</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span>
			    <span class="n">usb_sndctrlpipe</span><span class="p">(</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">serial</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
			    <span class="n">FTDI_SIO_SET_BAUDRATE_REQUEST</span><span class="p">,</span>
			    <span class="n">FTDI_SIO_SET_BAUDRATE_REQUEST_TYPE</span><span class="p">,</span>
			    <span class="n">urb_value</span><span class="p">,</span> <span class="n">urb_index</span><span class="p">,</span>
			    <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">WDR_SHORT_TIMEOUT</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">rv</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">write_latency_timer</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span> <span class="o">=</span> <span class="n">usb_get_serial_port_data</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">usb_device</span> <span class="o">*</span><span class="n">udev</span> <span class="o">=</span> <span class="n">port</span><span class="o">-&gt;</span><span class="n">serial</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">rv</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">l</span> <span class="o">=</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">latency</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">ASYNC_LOW_LATENCY</span><span class="p">)</span>
		<span class="n">l</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

	<span class="n">dbg</span><span class="p">(</span><span class="s">&quot;%s: setting latency timer = %i&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">,</span> <span class="n">l</span><span class="p">);</span>

	<span class="n">rv</span> <span class="o">=</span> <span class="n">usb_control_msg</span><span class="p">(</span><span class="n">udev</span><span class="p">,</span>
			     <span class="n">usb_sndctrlpipe</span><span class="p">(</span><span class="n">udev</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
			     <span class="n">FTDI_SIO_SET_LATENCY_TIMER_REQUEST</span><span class="p">,</span>
			     <span class="n">FTDI_SIO_SET_LATENCY_TIMER_REQUEST_TYPE</span><span class="p">,</span>
			     <span class="n">l</span><span class="p">,</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">interface</span><span class="p">,</span>
			     <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">WDR_TIMEOUT</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">rv</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">dev_err</span><span class="p">(</span><span class="o">&amp;</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;Unable to write latency timer: %i</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">rv</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">rv</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">read_latency_timer</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span> <span class="o">=</span> <span class="n">usb_get_serial_port_data</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">usb_device</span> <span class="o">*</span><span class="n">udev</span> <span class="o">=</span> <span class="n">port</span><span class="o">-&gt;</span><span class="n">serial</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">buf</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">rv</span><span class="p">;</span>

	<span class="n">buf</span> <span class="o">=</span> <span class="n">kmalloc</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">GFP_KERNEL</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">buf</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>

	<span class="n">rv</span> <span class="o">=</span> <span class="n">usb_control_msg</span><span class="p">(</span><span class="n">udev</span><span class="p">,</span>
			     <span class="n">usb_rcvctrlpipe</span><span class="p">(</span><span class="n">udev</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
			     <span class="n">FTDI_SIO_GET_LATENCY_TIMER_REQUEST</span><span class="p">,</span>
			     <span class="n">FTDI_SIO_GET_LATENCY_TIMER_REQUEST_TYPE</span><span class="p">,</span>
			     <span class="mi">0</span><span class="p">,</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">interface</span><span class="p">,</span>
			     <span class="n">buf</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">WDR_TIMEOUT</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">rv</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">dev_err</span><span class="p">(</span><span class="o">&amp;</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;Unable to read latency timer: %i</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">rv</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="n">priv</span><span class="o">-&gt;</span><span class="n">latency</span> <span class="o">=</span> <span class="n">buf</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

	<span class="n">kfree</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">rv</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">get_serial_info</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">,</span>
				<span class="k">struct</span> <span class="n">serial_struct</span> <span class="n">__user</span> <span class="o">*</span><span class="n">retinfo</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span> <span class="o">=</span> <span class="n">usb_get_serial_port_data</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">serial_struct</span> <span class="n">tmp</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">retinfo</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
	<span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tmp</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">tmp</span><span class="p">));</span>
	<span class="n">tmp</span><span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">;</span>
	<span class="n">tmp</span><span class="p">.</span><span class="n">baud_base</span> <span class="o">=</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">baud_base</span><span class="p">;</span>
	<span class="n">tmp</span><span class="p">.</span><span class="n">custom_divisor</span> <span class="o">=</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">custom_divisor</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">copy_to_user</span><span class="p">(</span><span class="n">retinfo</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">tmp</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">retinfo</span><span class="p">)))</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">set_serial_info</span><span class="p">(</span><span class="k">struct</span> <span class="n">tty_struct</span> <span class="o">*</span><span class="n">tty</span><span class="p">,</span>
	<span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">,</span> <span class="k">struct</span> <span class="n">serial_struct</span> <span class="n">__user</span> <span class="o">*</span><span class="n">newinfo</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span> <span class="o">=</span> <span class="n">usb_get_serial_port_data</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">serial_struct</span> <span class="n">new_serial</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="n">old_priv</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">copy_from_user</span><span class="p">(</span><span class="o">&amp;</span><span class="n">new_serial</span><span class="p">,</span> <span class="n">newinfo</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">new_serial</span><span class="p">)))</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>

	<span class="n">mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">cfg_lock</span><span class="p">);</span>
	<span class="n">old_priv</span> <span class="o">=</span> <span class="o">*</span><span class="n">priv</span><span class="p">;</span>

	<span class="cm">/* Do error checking and permission checking */</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">capable</span><span class="p">(</span><span class="n">CAP_SYS_ADMIN</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(((</span><span class="n">new_serial</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">ASYNC_USR_MASK</span><span class="p">)</span> <span class="o">!=</span>
		     <span class="p">(</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">ASYNC_USR_MASK</span><span class="p">)))</span> <span class="p">{</span>
			<span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">cfg_lock</span><span class="p">);</span>
			<span class="k">return</span> <span class="o">-</span><span class="n">EPERM</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">priv</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">=</span> <span class="p">((</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">ASYNC_USR_MASK</span><span class="p">)</span> <span class="o">|</span>
			       <span class="p">(</span><span class="n">new_serial</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">ASYNC_USR_MASK</span><span class="p">));</span>
		<span class="n">priv</span><span class="o">-&gt;</span><span class="n">custom_divisor</span> <span class="o">=</span> <span class="n">new_serial</span><span class="p">.</span><span class="n">custom_divisor</span><span class="p">;</span>
		<span class="k">goto</span> <span class="n">check_and_exit</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">new_serial</span><span class="p">.</span><span class="n">baud_base</span> <span class="o">!=</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">baud_base</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">cfg_lock</span><span class="p">);</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="cm">/* Make the changes - these are privileged changes! */</span>

	<span class="n">priv</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">=</span> <span class="p">((</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">ASYNC_FLAGS</span><span class="p">)</span> <span class="o">|</span>
					<span class="p">(</span><span class="n">new_serial</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">ASYNC_FLAGS</span><span class="p">));</span>
	<span class="n">priv</span><span class="o">-&gt;</span><span class="n">custom_divisor</span> <span class="o">=</span> <span class="n">new_serial</span><span class="p">.</span><span class="n">custom_divisor</span><span class="p">;</span>

	<span class="n">write_latency_timer</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>

<span class="nl">check_and_exit:</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">old_priv</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">ASYNC_SPD_MASK</span><span class="p">)</span> <span class="o">!=</span>
	     <span class="p">(</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">ASYNC_SPD_MASK</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">((</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">ASYNC_SPD_MASK</span><span class="p">)</span> <span class="o">==</span> <span class="n">ASYNC_SPD_HI</span><span class="p">)</span>
			<span class="n">tty</span><span class="o">-&gt;</span><span class="n">alt_speed</span> <span class="o">=</span> <span class="mi">57600</span><span class="p">;</span>
		<span class="k">else</span> <span class="k">if</span> <span class="p">((</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">ASYNC_SPD_MASK</span><span class="p">)</span> <span class="o">==</span> <span class="n">ASYNC_SPD_VHI</span><span class="p">)</span>
			<span class="n">tty</span><span class="o">-&gt;</span><span class="n">alt_speed</span> <span class="o">=</span> <span class="mi">115200</span><span class="p">;</span>
		<span class="k">else</span> <span class="k">if</span> <span class="p">((</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">ASYNC_SPD_MASK</span><span class="p">)</span> <span class="o">==</span> <span class="n">ASYNC_SPD_SHI</span><span class="p">)</span>
			<span class="n">tty</span><span class="o">-&gt;</span><span class="n">alt_speed</span> <span class="o">=</span> <span class="mi">230400</span><span class="p">;</span>
		<span class="k">else</span> <span class="k">if</span> <span class="p">((</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">ASYNC_SPD_MASK</span><span class="p">)</span> <span class="o">==</span> <span class="n">ASYNC_SPD_WARP</span><span class="p">)</span>
			<span class="n">tty</span><span class="o">-&gt;</span><span class="n">alt_speed</span> <span class="o">=</span> <span class="mi">460800</span><span class="p">;</span>
		<span class="k">else</span>
			<span class="n">tty</span><span class="o">-&gt;</span><span class="n">alt_speed</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(((</span><span class="n">old_priv</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">ASYNC_SPD_MASK</span><span class="p">)</span> <span class="o">!=</span>
	     <span class="p">(</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">ASYNC_SPD_MASK</span><span class="p">))</span> <span class="o">||</span>
	    <span class="p">(((</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">ASYNC_SPD_MASK</span><span class="p">)</span> <span class="o">==</span> <span class="n">ASYNC_SPD_CUST</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	     <span class="p">(</span><span class="n">old_priv</span><span class="p">.</span><span class="n">custom_divisor</span> <span class="o">!=</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">custom_divisor</span><span class="p">)))</span> <span class="p">{</span>
		<span class="n">change_speed</span><span class="p">(</span><span class="n">tty</span><span class="p">,</span> <span class="n">port</span><span class="p">);</span>
		<span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">cfg_lock</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">else</span>
		<span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">cfg_lock</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">get_lsr_info</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">serial_struct</span> <span class="n">__user</span> <span class="o">*</span><span class="n">retinfo</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span> <span class="o">=</span> <span class="n">usb_get_serial_port_data</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">retinfo</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">transmit_empty</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">=</span> <span class="n">TIOCSER_TEMT</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">copy_to_user</span><span class="p">(</span><span class="n">retinfo</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">result</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)))</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>


<span class="cm">/* Determine type of FTDI chip based on USB config and descriptor. */</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">ftdi_determine_type</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span> <span class="o">=</span> <span class="n">usb_get_serial_port_data</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">usb_serial</span> <span class="o">*</span><span class="n">serial</span> <span class="o">=</span> <span class="n">port</span><span class="o">-&gt;</span><span class="n">serial</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">usb_device</span> <span class="o">*</span><span class="n">udev</span> <span class="o">=</span> <span class="n">serial</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="n">version</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="n">interfaces</span><span class="p">;</span>

	<span class="cm">/* Assume it is not the original SIO device for now. */</span>
	<span class="n">priv</span><span class="o">-&gt;</span><span class="n">baud_base</span> <span class="o">=</span> <span class="mi">48000000</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>

	<span class="n">version</span> <span class="o">=</span> <span class="n">le16_to_cpu</span><span class="p">(</span><span class="n">udev</span><span class="o">-&gt;</span><span class="n">descriptor</span><span class="p">.</span><span class="n">bcdDevice</span><span class="p">);</span>
	<span class="n">interfaces</span> <span class="o">=</span> <span class="n">udev</span><span class="o">-&gt;</span><span class="n">actconfig</span><span class="o">-&gt;</span><span class="n">desc</span><span class="p">.</span><span class="n">bNumInterfaces</span><span class="p">;</span>
	<span class="n">dbg</span><span class="p">(</span><span class="s">&quot;%s: bcdDevice = 0x%x, bNumInterfaces = %u&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">,</span>
			<span class="n">version</span><span class="p">,</span> <span class="n">interfaces</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">interfaces</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="kt">int</span> <span class="n">inter</span><span class="p">;</span>

		<span class="cm">/* Multiple interfaces.*/</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">version</span> <span class="o">==</span> <span class="mh">0x0800</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">=</span> <span class="n">FT4232H</span><span class="p">;</span>
			<span class="cm">/* Hi-speed - baud clock runs at 120MHz */</span>
			<span class="n">priv</span><span class="o">-&gt;</span><span class="n">baud_base</span> <span class="o">=</span> <span class="mi">120000000</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">version</span> <span class="o">==</span> <span class="mh">0x0700</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">=</span> <span class="n">FT2232H</span><span class="p">;</span>
			<span class="cm">/* Hi-speed - baud clock runs at 120MHz */</span>
			<span class="n">priv</span><span class="o">-&gt;</span><span class="n">baud_base</span> <span class="o">=</span> <span class="mi">120000000</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span>
			<span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">=</span> <span class="n">FT2232C</span><span class="p">;</span>

		<span class="cm">/* Determine interface code. */</span>
		<span class="n">inter</span> <span class="o">=</span> <span class="n">serial</span><span class="o">-&gt;</span><span class="n">interface</span><span class="o">-&gt;</span><span class="n">altsetting</span><span class="o">-&gt;</span><span class="n">desc</span><span class="p">.</span><span class="n">bInterfaceNumber</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">inter</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">priv</span><span class="o">-&gt;</span><span class="n">interface</span> <span class="o">=</span> <span class="n">INTERFACE_A</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span>  <span class="k">if</span> <span class="p">(</span><span class="n">inter</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">priv</span><span class="o">-&gt;</span><span class="n">interface</span> <span class="o">=</span> <span class="n">INTERFACE_B</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span>  <span class="k">if</span> <span class="p">(</span><span class="n">inter</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">priv</span><span class="o">-&gt;</span><span class="n">interface</span> <span class="o">=</span> <span class="n">INTERFACE_C</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span>  <span class="k">if</span> <span class="p">(</span><span class="n">inter</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">priv</span><span class="o">-&gt;</span><span class="n">interface</span> <span class="o">=</span> <span class="n">INTERFACE_D</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="cm">/* BM-type devices have a bug where bcdDevice gets set</span>
<span class="cm">		 * to 0x200 when iSerialNumber is 0.  */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">version</span> <span class="o">&lt;</span> <span class="mh">0x500</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">dbg</span><span class="p">(</span><span class="s">&quot;%s: something fishy - bcdDevice too low for multi-interface device&quot;</span><span class="p">,</span>
					<span class="n">__func__</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">version</span> <span class="o">&lt;</span> <span class="mh">0x200</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* Old device.  Assume it&#39;s the original SIO. */</span>
		<span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">=</span> <span class="n">SIO</span><span class="p">;</span>
		<span class="n">priv</span><span class="o">-&gt;</span><span class="n">baud_base</span> <span class="o">=</span> <span class="mi">12000000</span> <span class="o">/</span> <span class="mi">16</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">version</span> <span class="o">&lt;</span> <span class="mh">0x400</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* Assume it&#39;s an FT8U232AM (or FT8U245AM) */</span>
		<span class="cm">/* (It might be a BM because of the iSerialNumber bug,</span>
<span class="cm">		 * but it will still work as an AM device.) */</span>
		<span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">=</span> <span class="n">FT8U232AM</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">version</span> <span class="o">&lt;</span> <span class="mh">0x600</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* Assume it&#39;s an FT232BM (or FT245BM) */</span>
		<span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">=</span> <span class="n">FT232BM</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">version</span> <span class="o">&lt;</span> <span class="mh">0x900</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* Assume it&#39;s an FT232RL */</span>
		<span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">=</span> <span class="n">FT232RL</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">version</span> <span class="o">&lt;</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* Assume it&#39;s an FT232H */</span>
		<span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">=</span> <span class="n">FT232H</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="cm">/* Assume it&#39;s an FT-X series device */</span>
		<span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">=</span> <span class="n">FTX</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">dev_info</span><span class="p">(</span><span class="o">&amp;</span><span class="n">udev</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;Detected %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">ftdi_chip_name</span><span class="p">[</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span><span class="p">]);</span>
<span class="p">}</span>


<span class="cm">/* Determine the maximum packet size for the device.  This depends on the chip</span>
<span class="cm"> * type and the USB host capabilities.  The value should be obtained from the</span>
<span class="cm"> * device descriptor as the chip will use the appropriate values for the host.*/</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">ftdi_set_max_packet_size</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span> <span class="o">=</span> <span class="n">usb_get_serial_port_data</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">usb_serial</span> <span class="o">*</span><span class="n">serial</span> <span class="o">=</span> <span class="n">port</span><span class="o">-&gt;</span><span class="n">serial</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">usb_device</span> <span class="o">*</span><span class="n">udev</span> <span class="o">=</span> <span class="n">serial</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">usb_interface</span> <span class="o">*</span><span class="n">interface</span> <span class="o">=</span> <span class="n">serial</span><span class="o">-&gt;</span><span class="n">interface</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">usb_endpoint_descriptor</span> <span class="o">*</span><span class="n">ep_desc</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">interface</span><span class="o">-&gt;</span><span class="n">cur_altsetting</span><span class="o">-&gt;</span><span class="n">endpoint</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">desc</span><span class="p">;</span>

	<span class="kt">unsigned</span> <span class="n">num_endpoints</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="n">num_endpoints</span> <span class="o">=</span> <span class="n">interface</span><span class="o">-&gt;</span><span class="n">cur_altsetting</span><span class="o">-&gt;</span><span class="n">desc</span><span class="p">.</span><span class="n">bNumEndpoints</span><span class="p">;</span>
	<span class="n">dev_info</span><span class="p">(</span><span class="o">&amp;</span><span class="n">udev</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;Number of endpoints %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">num_endpoints</span><span class="p">);</span>

	<span class="cm">/* NOTE: some customers have programmed FT232R/FT245R devices</span>
<span class="cm">	 * with an endpoint size of 0 - not good.  In this case, we</span>
<span class="cm">	 * want to override the endpoint descriptor setting and use a</span>
<span class="cm">	 * value of 64 for wMaxPacketSize */</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num_endpoints</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">dev_info</span><span class="p">(</span><span class="o">&amp;</span><span class="n">udev</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;Endpoint %d MaxPacketSize %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
			<span class="n">interface</span><span class="o">-&gt;</span><span class="n">cur_altsetting</span><span class="o">-&gt;</span><span class="n">endpoint</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">desc</span><span class="p">.</span><span class="n">wMaxPacketSize</span><span class="p">);</span>
		<span class="n">ep_desc</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">interface</span><span class="o">-&gt;</span><span class="n">cur_altsetting</span><span class="o">-&gt;</span><span class="n">endpoint</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">desc</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ep_desc</span><span class="o">-&gt;</span><span class="n">wMaxPacketSize</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">ep_desc</span><span class="o">-&gt;</span><span class="n">wMaxPacketSize</span> <span class="o">=</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="mh">0x40</span><span class="p">);</span>
			<span class="n">dev_info</span><span class="p">(</span><span class="o">&amp;</span><span class="n">udev</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;Overriding wMaxPacketSize on endpoint %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="cm">/* set max packet size based on descriptor */</span>
	<span class="n">priv</span><span class="o">-&gt;</span><span class="n">max_packet_size</span> <span class="o">=</span> <span class="n">usb_endpoint_maxp</span><span class="p">(</span><span class="n">ep_desc</span><span class="p">);</span>

	<span class="n">dev_info</span><span class="p">(</span><span class="o">&amp;</span><span class="n">udev</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;Setting MaxPacketSize %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">max_packet_size</span><span class="p">);</span>
<span class="p">}</span>


<span class="cm">/*</span>
<span class="cm"> * ***************************************************************************</span>
<span class="cm"> * Sysfs Attribute</span>
<span class="cm"> * ***************************************************************************</span>
<span class="cm"> */</span>

<span class="k">static</span> <span class="kt">ssize_t</span> <span class="nf">show_latency_timer</span><span class="p">(</span><span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
				<span class="k">struct</span> <span class="n">device_attribute</span> <span class="o">*</span><span class="n">attr</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">buf</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span> <span class="o">=</span> <span class="n">to_usb_serial_port</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span> <span class="o">=</span> <span class="n">usb_get_serial_port_data</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">ASYNC_LOW_LATENCY</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="s">&quot;1</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="k">return</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="s">&quot;%i</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">latency</span><span class="p">);</span>
<span class="p">}</span>


<span class="cm">/* Write a new value of the latency timer, in units of milliseconds. */</span>
<span class="k">static</span> <span class="kt">ssize_t</span> <span class="nf">store_latency_timer</span><span class="p">(</span><span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">device_attribute</span> <span class="o">*</span><span class="n">attr</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">valbuf</span><span class="p">,</span>
			<span class="kt">size_t</span> <span class="n">count</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span> <span class="o">=</span> <span class="n">to_usb_serial_port</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span> <span class="o">=</span> <span class="n">usb_get_serial_port_data</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">v</span> <span class="o">=</span> <span class="n">simple_strtoul</span><span class="p">(</span><span class="n">valbuf</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">rv</span><span class="p">;</span>

	<span class="n">priv</span><span class="o">-&gt;</span><span class="n">latency</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span>
	<span class="n">rv</span> <span class="o">=</span> <span class="n">write_latency_timer</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">rv</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EIO</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">count</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* Write an event character directly to the FTDI register.  The ASCII</span>
<span class="cm">   value is in the low 8 bits, with the enable bit in the 9th bit. */</span>
<span class="k">static</span> <span class="kt">ssize_t</span> <span class="nf">store_event_char</span><span class="p">(</span><span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
	<span class="k">struct</span> <span class="n">device_attribute</span> <span class="o">*</span><span class="n">attr</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">valbuf</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">count</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span> <span class="o">=</span> <span class="n">to_usb_serial_port</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span> <span class="o">=</span> <span class="n">usb_get_serial_port_data</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">usb_device</span> <span class="o">*</span><span class="n">udev</span> <span class="o">=</span> <span class="n">port</span><span class="o">-&gt;</span><span class="n">serial</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">v</span> <span class="o">=</span> <span class="n">simple_strtoul</span><span class="p">(</span><span class="n">valbuf</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">rv</span><span class="p">;</span>

	<span class="n">dbg</span><span class="p">(</span><span class="s">&quot;%s: setting event char = %i&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>

	<span class="n">rv</span> <span class="o">=</span> <span class="n">usb_control_msg</span><span class="p">(</span><span class="n">udev</span><span class="p">,</span>
			     <span class="n">usb_sndctrlpipe</span><span class="p">(</span><span class="n">udev</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
			     <span class="n">FTDI_SIO_SET_EVENT_CHAR_REQUEST</span><span class="p">,</span>
			     <span class="n">FTDI_SIO_SET_EVENT_CHAR_REQUEST_TYPE</span><span class="p">,</span>
			     <span class="n">v</span><span class="p">,</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">interface</span><span class="p">,</span>
			     <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">WDR_TIMEOUT</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">rv</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">dbg</span><span class="p">(</span><span class="s">&quot;Unable to write event character: %i&quot;</span><span class="p">,</span> <span class="n">rv</span><span class="p">);</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EIO</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="n">count</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">DEVICE_ATTR</span><span class="p">(</span><span class="n">latency_timer</span><span class="p">,</span> <span class="n">S_IWUSR</span> <span class="o">|</span> <span class="n">S_IRUGO</span><span class="p">,</span> <span class="n">show_latency_timer</span><span class="p">,</span>
							<span class="n">store_latency_timer</span><span class="p">);</span>
<span class="k">static</span> <span class="n">DEVICE_ATTR</span><span class="p">(</span><span class="n">event_char</span><span class="p">,</span> <span class="n">S_IWUSR</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">store_event_char</span><span class="p">);</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">create_sysfs_attrs</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span> <span class="o">=</span> <span class="n">usb_get_serial_port_data</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">retval</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="cm">/* XXX I&#39;ve no idea if the original SIO supports the event_char</span>
<span class="cm">	 * sysfs parameter, so I&#39;m playing it safe.  */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">!=</span> <span class="n">SIO</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">dbg</span><span class="p">(</span><span class="s">&quot;sysfs attributes for %s&quot;</span><span class="p">,</span> <span class="n">ftdi_chip_name</span><span class="p">[</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span><span class="p">]);</span>
		<span class="n">retval</span> <span class="o">=</span> <span class="n">device_create_file</span><span class="p">(</span><span class="o">&amp;</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">dev_attr_event_char</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">((</span><span class="o">!</span><span class="n">retval</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
		    <span class="p">(</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">==</span> <span class="n">FT232BM</span> <span class="o">||</span>
		     <span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">==</span> <span class="n">FT2232C</span> <span class="o">||</span>
		     <span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">==</span> <span class="n">FT232RL</span> <span class="o">||</span>
		     <span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">==</span> <span class="n">FT2232H</span> <span class="o">||</span>
		     <span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">==</span> <span class="n">FT4232H</span> <span class="o">||</span>
		     <span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">==</span> <span class="n">FT232H</span> <span class="o">||</span>
		     <span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">==</span> <span class="n">FTX</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="n">device_create_file</span><span class="p">(</span><span class="o">&amp;</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span>
						    <span class="o">&amp;</span><span class="n">dev_attr_latency_timer</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">retval</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">remove_sysfs_attrs</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span> <span class="o">=</span> <span class="n">usb_get_serial_port_data</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>

	<span class="cm">/* XXX see create_sysfs_attrs */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">!=</span> <span class="n">SIO</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">device_remove_file</span><span class="p">(</span><span class="o">&amp;</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">dev_attr_event_char</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">==</span> <span class="n">FT232BM</span> <span class="o">||</span>
		    <span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">==</span> <span class="n">FT2232C</span> <span class="o">||</span>
		    <span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">==</span> <span class="n">FT232RL</span> <span class="o">||</span>
		    <span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">==</span> <span class="n">FT2232H</span> <span class="o">||</span>
		    <span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">==</span> <span class="n">FT4232H</span> <span class="o">||</span>
		    <span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">==</span> <span class="n">FT232H</span> <span class="o">||</span>
		    <span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">==</span> <span class="n">FTX</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">device_remove_file</span><span class="p">(</span><span class="o">&amp;</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">dev_attr_latency_timer</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>

<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * ***************************************************************************</span>
<span class="cm"> * FTDI driver specific functions</span>
<span class="cm"> * ***************************************************************************</span>
<span class="cm"> */</span>

<span class="cm">/* Probe function to check for special devices */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">ftdi_sio_probe</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial</span> <span class="o">*</span><span class="n">serial</span><span class="p">,</span>
					<span class="k">const</span> <span class="k">struct</span> <span class="n">usb_device_id</span> <span class="o">*</span><span class="n">id</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ftdi_sio_quirk</span> <span class="o">*</span><span class="n">quirk</span> <span class="o">=</span>
				<span class="p">(</span><span class="k">struct</span> <span class="n">ftdi_sio_quirk</span> <span class="o">*</span><span class="p">)</span><span class="n">id</span><span class="o">-&gt;</span><span class="n">driver_info</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">quirk</span> <span class="o">&amp;&amp;</span> <span class="n">quirk</span><span class="o">-&gt;</span><span class="n">probe</span><span class="p">)</span> <span class="p">{</span>
		<span class="kt">int</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">quirk</span><span class="o">-&gt;</span><span class="n">probe</span><span class="p">(</span><span class="n">serial</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">usb_set_serial_data</span><span class="p">(</span><span class="n">serial</span><span class="p">,</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="n">id</span><span class="o">-&gt;</span><span class="n">driver_info</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ftdi_sio_port_probe</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ftdi_sio_quirk</span> <span class="o">*</span><span class="n">quirk</span> <span class="o">=</span> <span class="n">usb_get_serial_data</span><span class="p">(</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">serial</span><span class="p">);</span>


	<span class="n">priv</span> <span class="o">=</span> <span class="n">kzalloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">ftdi_private</span><span class="p">),</span> <span class="n">GFP_KERNEL</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">priv</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">dev_err</span><span class="p">(</span><span class="o">&amp;</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;%s- kmalloc(%Zd) failed.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">,</span>
					<span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">ftdi_private</span><span class="p">));</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">kref_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">kref</span><span class="p">);</span>
	<span class="n">mutex_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">cfg_lock</span><span class="p">);</span>
	<span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">icount</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">icount</span><span class="p">));</span>
	<span class="n">init_waitqueue_head</span><span class="p">(</span><span class="o">&amp;</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">delta_msr_wait</span><span class="p">);</span>

	<span class="n">priv</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">=</span> <span class="n">ASYNC_LOW_LATENCY</span><span class="p">;</span>
	<span class="n">priv</span><span class="o">-&gt;</span><span class="n">dev_gone</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">quirk</span> <span class="o">&amp;&amp;</span> <span class="n">quirk</span><span class="o">-&gt;</span><span class="n">port_probe</span><span class="p">)</span>
		<span class="n">quirk</span><span class="o">-&gt;</span><span class="n">port_probe</span><span class="p">(</span><span class="n">priv</span><span class="p">);</span>

	<span class="n">priv</span><span class="o">-&gt;</span><span class="n">port</span> <span class="o">=</span> <span class="n">port</span><span class="p">;</span>
	<span class="n">usb_set_serial_port_data</span><span class="p">(</span><span class="n">port</span><span class="p">,</span> <span class="n">priv</span><span class="p">);</span>

	<span class="n">ftdi_determine_type</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
	<span class="n">ftdi_set_max_packet_size</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">read_latency_timer</span><span class="p">(</span><span class="n">port</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">priv</span><span class="o">-&gt;</span><span class="n">latency</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>
	<span class="n">write_latency_timer</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
	<span class="n">create_sysfs_attrs</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* Setup for the USB-UIRT device, which requires hardwired</span>
<span class="cm"> * baudrate (38400 gets mapped to 312500) */</span>
<span class="cm">/* Called from usbserial:serial_probe */</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">ftdi_USB_UIRT_setup</span><span class="p">(</span><span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">priv</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">|=</span> <span class="n">ASYNC_SPD_CUST</span><span class="p">;</span>
	<span class="n">priv</span><span class="o">-&gt;</span><span class="n">custom_divisor</span> <span class="o">=</span> <span class="mi">77</span><span class="p">;</span>
	<span class="n">priv</span><span class="o">-&gt;</span><span class="n">force_baud</span> <span class="o">=</span> <span class="mi">38400</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* Setup for the HE-TIRA1 device, which requires hardwired</span>
<span class="cm"> * baudrate (38400 gets mapped to 100000) and RTS-CTS enabled.  */</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ftdi_HE_TIRA1_setup</span><span class="p">(</span><span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">priv</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">|=</span> <span class="n">ASYNC_SPD_CUST</span><span class="p">;</span>
	<span class="n">priv</span><span class="o">-&gt;</span><span class="n">custom_divisor</span> <span class="o">=</span> <span class="mi">240</span><span class="p">;</span>
	<span class="n">priv</span><span class="o">-&gt;</span><span class="n">force_baud</span> <span class="o">=</span> <span class="mi">38400</span><span class="p">;</span>
	<span class="n">priv</span><span class="o">-&gt;</span><span class="n">force_rtscts</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * Module parameter to control latency timer for NDI FTDI-based USB devices.</span>
<span class="cm"> * If this value is not set in /etc/modprobe.d/ its value will be set</span>
<span class="cm"> * to 1ms.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">ndi_latency_timer</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="cm">/* Setup for the NDI FTDI-based USB devices, which requires hardwired</span>
<span class="cm"> * baudrate (19200 gets mapped to 1200000).</span>
<span class="cm"> *</span>
<span class="cm"> * Called from usbserial:serial_probe.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">ftdi_NDI_device_setup</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial</span> <span class="o">*</span><span class="n">serial</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">usb_device</span> <span class="o">*</span><span class="n">udev</span> <span class="o">=</span> <span class="n">serial</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">latency</span> <span class="o">=</span> <span class="n">ndi_latency_timer</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">latency</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">latency</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">latency</span> <span class="o">&gt;</span> <span class="mi">99</span><span class="p">)</span>
		<span class="n">latency</span> <span class="o">=</span> <span class="mi">99</span><span class="p">;</span>

	<span class="n">dbg</span><span class="p">(</span><span class="s">&quot;%s setting NDI device latency to %d&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">,</span> <span class="n">latency</span><span class="p">);</span>
	<span class="n">dev_info</span><span class="p">(</span><span class="o">&amp;</span><span class="n">udev</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;NDI device with a latency value of %d&quot;</span><span class="p">,</span> <span class="n">latency</span><span class="p">);</span>

	<span class="cm">/* FIXME: errors are not returned */</span>
	<span class="n">usb_control_msg</span><span class="p">(</span><span class="n">udev</span><span class="p">,</span> <span class="n">usb_sndctrlpipe</span><span class="p">(</span><span class="n">udev</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
				<span class="n">FTDI_SIO_SET_LATENCY_TIMER_REQUEST</span><span class="p">,</span>
				<span class="n">FTDI_SIO_SET_LATENCY_TIMER_REQUEST_TYPE</span><span class="p">,</span>
				<span class="n">latency</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">WDR_TIMEOUT</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * First port on JTAG adaptors such as Olimex arm-usb-ocd or the FIC/OpenMoko</span>
<span class="cm"> * Neo1973 Debug Board is reserved for JTAG interface and can be accessed from</span>
<span class="cm"> * userspace using openocd.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">ftdi_jtag_probe</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial</span> <span class="o">*</span><span class="n">serial</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">usb_device</span> <span class="o">*</span><span class="n">udev</span> <span class="o">=</span> <span class="n">serial</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">usb_interface</span> <span class="o">*</span><span class="n">interface</span> <span class="o">=</span> <span class="n">serial</span><span class="o">-&gt;</span><span class="n">interface</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">interface</span> <span class="o">==</span> <span class="n">udev</span><span class="o">-&gt;</span><span class="n">actconfig</span><span class="o">-&gt;</span><span class="n">interface</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
		<span class="n">dev_info</span><span class="p">(</span><span class="o">&amp;</span><span class="n">udev</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span>
			 <span class="s">&quot;Ignoring serial port reserved for JTAG</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENODEV</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ftdi_8u2232c_probe</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial</span> <span class="o">*</span><span class="n">serial</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">usb_device</span> <span class="o">*</span><span class="n">udev</span> <span class="o">=</span> <span class="n">serial</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">((</span><span class="n">udev</span><span class="o">-&gt;</span><span class="n">manufacturer</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">udev</span><span class="o">-&gt;</span><span class="n">manufacturer</span><span class="p">,</span> <span class="s">&quot;CALAO Systems&quot;</span><span class="p">))</span> <span class="o">||</span>
	    <span class="p">(</span><span class="n">udev</span><span class="o">-&gt;</span><span class="n">product</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">udev</span><span class="o">-&gt;</span><span class="n">product</span><span class="p">,</span> <span class="s">&quot;BeagleBone/XDS100&quot;</span><span class="p">)))</span>
		<span class="k">return</span> <span class="n">ftdi_jtag_probe</span><span class="p">(</span><span class="n">serial</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * First and second port on STMCLiteadaptors is reserved for JTAG interface</span>
<span class="cm"> * and the forth port for pio</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">ftdi_stmclite_probe</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial</span> <span class="o">*</span><span class="n">serial</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">usb_device</span> <span class="o">*</span><span class="n">udev</span> <span class="o">=</span> <span class="n">serial</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">usb_interface</span> <span class="o">*</span><span class="n">interface</span> <span class="o">=</span> <span class="n">serial</span><span class="o">-&gt;</span><span class="n">interface</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">interface</span> <span class="o">==</span> <span class="n">udev</span><span class="o">-&gt;</span><span class="n">actconfig</span><span class="o">-&gt;</span><span class="n">interface</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">dev_info</span><span class="p">(</span><span class="o">&amp;</span><span class="n">udev</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;Ignoring serial port reserved for JTAG</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

	<span class="k">return</span> <span class="o">-</span><span class="n">ENODEV</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * The Matrix Orbital VK204-25-USB has an invalid IN endpoint.</span>
<span class="cm"> * We have to correct it if we want to read from it.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">ftdi_mtxorb_hack_setup</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial</span> <span class="o">*</span><span class="n">serial</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">usb_host_endpoint</span> <span class="o">*</span><span class="n">ep</span> <span class="o">=</span> <span class="n">serial</span><span class="o">-&gt;</span><span class="n">dev</span><span class="o">-&gt;</span><span class="n">ep_in</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">usb_endpoint_descriptor</span> <span class="o">*</span><span class="n">ep_desc</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">ep</span><span class="o">-&gt;</span><span class="n">desc</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ep</span><span class="o">-&gt;</span><span class="n">enabled</span> <span class="o">&amp;&amp;</span> <span class="n">ep_desc</span><span class="o">-&gt;</span><span class="n">wMaxPacketSize</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ep_desc</span><span class="o">-&gt;</span><span class="n">wMaxPacketSize</span> <span class="o">=</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="mh">0x40</span><span class="p">);</span>
		<span class="n">dev_info</span><span class="p">(</span><span class="o">&amp;</span><span class="n">serial</span><span class="o">-&gt;</span><span class="n">dev</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span>
			 <span class="s">&quot;Fixing invalid wMaxPacketSize on read pipe</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ftdi_sio_priv_release</span><span class="p">(</span><span class="k">struct</span> <span class="n">kref</span> <span class="o">*</span><span class="n">k</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span> <span class="o">=</span> <span class="n">container_of</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ftdi_private</span><span class="p">,</span> <span class="n">kref</span><span class="p">);</span>

	<span class="n">kfree</span><span class="p">(</span><span class="n">priv</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ftdi_sio_port_remove</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span> <span class="o">=</span> <span class="n">usb_get_serial_port_data</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>

	<span class="n">priv</span><span class="o">-&gt;</span><span class="n">dev_gone</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
	<span class="n">wake_up_interruptible_all</span><span class="p">(</span><span class="o">&amp;</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">delta_msr_wait</span><span class="p">);</span>

	<span class="n">remove_sysfs_attrs</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>

	<span class="n">kref_put</span><span class="p">(</span><span class="o">&amp;</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">kref</span><span class="p">,</span> <span class="n">ftdi_sio_priv_release</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ftdi_open</span><span class="p">(</span><span class="k">struct</span> <span class="n">tty_struct</span> <span class="o">*</span><span class="n">tty</span><span class="p">,</span> <span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ktermios</span> <span class="n">dummy</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">usb_device</span> <span class="o">*</span><span class="n">dev</span> <span class="o">=</span> <span class="n">port</span><span class="o">-&gt;</span><span class="n">serial</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span> <span class="o">=</span> <span class="n">usb_get_serial_port_data</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">result</span><span class="p">;</span>

	<span class="cm">/* No error checking for this (will get errors later anyway) */</span>
	<span class="cm">/* See ftdi_sio.h for description of what is reset */</span>
	<span class="n">usb_control_msg</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">usb_sndctrlpipe</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
			<span class="n">FTDI_SIO_RESET_REQUEST</span><span class="p">,</span> <span class="n">FTDI_SIO_RESET_REQUEST_TYPE</span><span class="p">,</span>
			<span class="n">FTDI_SIO_RESET_SIO</span><span class="p">,</span>
			<span class="n">priv</span><span class="o">-&gt;</span><span class="n">interface</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">WDR_TIMEOUT</span><span class="p">);</span>

	<span class="cm">/* Termios defaults are set by usb_serial_init. We don&#39;t change</span>
<span class="cm">	   port-&gt;tty-&gt;termios - this would lose speed settings, etc.</span>
<span class="cm">	   This is same behaviour as serial.c/rs_open() - Kuba */</span>

	<span class="cm">/* ftdi_set_termios  will send usb control messages */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">tty</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">dummy</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">dummy</span><span class="p">));</span>
		<span class="n">ftdi_set_termios</span><span class="p">(</span><span class="n">tty</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">dummy</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="cm">/* Start reading from the device */</span>
	<span class="n">result</span> <span class="o">=</span> <span class="n">usb_serial_generic_open</span><span class="p">(</span><span class="n">tty</span><span class="p">,</span> <span class="n">port</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">result</span><span class="p">)</span>
		<span class="n">kref_get</span><span class="p">(</span><span class="o">&amp;</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">kref</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ftdi_dtr_rts</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">,</span> <span class="kt">int</span> <span class="n">on</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span> <span class="o">=</span> <span class="n">usb_get_serial_port_data</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>

	<span class="n">mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">serial</span><span class="o">-&gt;</span><span class="n">disc_mutex</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">serial</span><span class="o">-&gt;</span><span class="n">disconnected</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* Disable flow control */</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">on</span> <span class="o">&amp;&amp;</span> <span class="n">usb_control_msg</span><span class="p">(</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">serial</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span>
			    <span class="n">usb_sndctrlpipe</span><span class="p">(</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">serial</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
			    <span class="n">FTDI_SIO_SET_FLOW_CTRL_REQUEST</span><span class="p">,</span>
			    <span class="n">FTDI_SIO_SET_FLOW_CTRL_REQUEST_TYPE</span><span class="p">,</span>
			    <span class="mi">0</span><span class="p">,</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">interface</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
			    <span class="n">WDR_TIMEOUT</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			    <span class="n">dev_err</span><span class="p">(</span><span class="o">&amp;</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;error from flowcontrol urb</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="cm">/* drop RTS and DTR */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">on</span><span class="p">)</span>
			<span class="n">set_mctrl</span><span class="p">(</span><span class="n">port</span><span class="p">,</span> <span class="n">TIOCM_DTR</span> <span class="o">|</span> <span class="n">TIOCM_RTS</span><span class="p">);</span>
		<span class="k">else</span>
			<span class="n">clear_mctrl</span><span class="p">(</span><span class="n">port</span><span class="p">,</span> <span class="n">TIOCM_DTR</span> <span class="o">|</span> <span class="n">TIOCM_RTS</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">serial</span><span class="o">-&gt;</span><span class="n">disc_mutex</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * usbserial:__serial_close  only calls ftdi_close if the point is open</span>
<span class="cm"> *</span>
<span class="cm"> *   This only gets called when it is the last close</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">ftdi_close</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span> <span class="o">=</span> <span class="n">usb_get_serial_port_data</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>

	<span class="n">usb_serial_generic_close</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
	<span class="n">kref_put</span><span class="p">(</span><span class="o">&amp;</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">kref</span><span class="p">,</span> <span class="n">ftdi_sio_priv_release</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* The SIO requires the first byte to have:</span>
<span class="cm"> *  B0 1</span>
<span class="cm"> *  B1 0</span>
<span class="cm"> *  B2..7 length of message excluding byte 0</span>
<span class="cm"> *</span>
<span class="cm"> * The new devices do not require this byte</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">ftdi_prepare_write_buffer</span><span class="p">(</span><span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">,</span>
						<span class="kt">void</span> <span class="o">*</span><span class="n">dest</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">size</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">count</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">flags</span><span class="p">;</span>

	<span class="n">priv</span> <span class="o">=</span> <span class="n">usb_get_serial_port_data</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span> <span class="o">==</span> <span class="n">SIO</span><span class="p">)</span> <span class="p">{</span>
		<span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">buffer</span> <span class="o">=</span> <span class="n">dest</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">len</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>

		<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">spin_lock_irqsave</span><span class="p">(</span><span class="o">&amp;</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">lock</span><span class="p">,</span> <span class="n">flags</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">max_packet_size</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">len</span> <span class="o">=</span> <span class="n">min_t</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">size</span> <span class="o">-</span> <span class="n">i</span><span class="p">,</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">max_packet_size</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">c</span> <span class="o">=</span> <span class="n">kfifo_out</span><span class="p">(</span><span class="o">&amp;</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">write_fifo</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">buffer</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">len</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">c</span><span class="p">)</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="n">priv</span><span class="o">-&gt;</span><span class="n">icount</span><span class="p">.</span><span class="n">tx</span> <span class="o">+=</span> <span class="n">c</span><span class="p">;</span>
			<span class="n">buffer</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">count</span> <span class="o">+=</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">spin_unlock_irqrestore</span><span class="p">(</span><span class="o">&amp;</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">lock</span><span class="p">,</span> <span class="n">flags</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">count</span> <span class="o">=</span> <span class="n">kfifo_out_locked</span><span class="p">(</span><span class="o">&amp;</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">write_fifo</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span>
								<span class="o">&amp;</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">lock</span><span class="p">);</span>
		<span class="n">priv</span><span class="o">-&gt;</span><span class="n">icount</span><span class="p">.</span><span class="n">tx</span> <span class="o">+=</span> <span class="n">count</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="n">count</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#define FTDI_RS_ERR_MASK (FTDI_RS_BI | FTDI_RS_PE | FTDI_RS_FE | FTDI_RS_OE)</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ftdi_process_packet</span><span class="p">(</span><span class="k">struct</span> <span class="n">tty_struct</span> <span class="o">*</span><span class="n">tty</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span>
		<span class="kt">char</span> <span class="o">*</span><span class="n">packet</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	<span class="kt">char</span> <span class="n">status</span><span class="p">;</span>
	<span class="kt">char</span> <span class="n">flag</span><span class="p">;</span>
	<span class="kt">char</span> <span class="o">*</span><span class="n">ch</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">dbg</span><span class="p">(</span><span class="s">&quot;malformed packet&quot;</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="cm">/* Compare new line status to the old one, signal if different/</span>
<span class="cm">	   N.B. packet may be processed more than once, but differences</span>
<span class="cm">	   are only processed once.  */</span>
	<span class="n">status</span> <span class="o">=</span> <span class="n">packet</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">FTDI_STATUS_B0_MASK</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">!=</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">prev_status</span><span class="p">)</span> <span class="p">{</span>
		<span class="kt">char</span> <span class="n">diff_status</span> <span class="o">=</span> <span class="n">status</span> <span class="o">^</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">prev_status</span><span class="p">;</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">diff_status</span> <span class="o">&amp;</span> <span class="n">FTDI_RS0_CTS</span><span class="p">)</span>
			<span class="n">priv</span><span class="o">-&gt;</span><span class="n">icount</span><span class="p">.</span><span class="n">cts</span><span class="o">++</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">diff_status</span> <span class="o">&amp;</span> <span class="n">FTDI_RS0_DSR</span><span class="p">)</span>
			<span class="n">priv</span><span class="o">-&gt;</span><span class="n">icount</span><span class="p">.</span><span class="n">dsr</span><span class="o">++</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">diff_status</span> <span class="o">&amp;</span> <span class="n">FTDI_RS0_RI</span><span class="p">)</span>
			<span class="n">priv</span><span class="o">-&gt;</span><span class="n">icount</span><span class="p">.</span><span class="n">rng</span><span class="o">++</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">diff_status</span> <span class="o">&amp;</span> <span class="n">FTDI_RS0_RLSD</span><span class="p">)</span>
			<span class="n">priv</span><span class="o">-&gt;</span><span class="n">icount</span><span class="p">.</span><span class="n">dcd</span><span class="o">++</span><span class="p">;</span>

		<span class="n">wake_up_interruptible_all</span><span class="p">(</span><span class="o">&amp;</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">delta_msr_wait</span><span class="p">);</span>
		<span class="n">priv</span><span class="o">-&gt;</span><span class="n">prev_status</span> <span class="o">=</span> <span class="n">status</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">flag</span> <span class="o">=</span> <span class="n">TTY_NORMAL</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">packet</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">FTDI_RS_ERR_MASK</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* Break takes precedence over parity, which takes precedence</span>
<span class="cm">		 * over framing errors */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">packet</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">FTDI_RS_BI</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">flag</span> <span class="o">=</span> <span class="n">TTY_BREAK</span><span class="p">;</span>
			<span class="n">priv</span><span class="o">-&gt;</span><span class="n">icount</span><span class="p">.</span><span class="n">brk</span><span class="o">++</span><span class="p">;</span>
			<span class="n">usb_serial_handle_break</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">packet</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">FTDI_RS_PE</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">flag</span> <span class="o">=</span> <span class="n">TTY_PARITY</span><span class="p">;</span>
			<span class="n">priv</span><span class="o">-&gt;</span><span class="n">icount</span><span class="p">.</span><span class="n">parity</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">packet</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">FTDI_RS_FE</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">flag</span> <span class="o">=</span> <span class="n">TTY_FRAME</span><span class="p">;</span>
			<span class="n">priv</span><span class="o">-&gt;</span><span class="n">icount</span><span class="p">.</span><span class="n">frame</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="cm">/* Overrun is special, not associated with a char */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">packet</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">FTDI_RS_OE</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">priv</span><span class="o">-&gt;</span><span class="n">icount</span><span class="p">.</span><span class="n">overrun</span><span class="o">++</span><span class="p">;</span>
			<span class="n">tty_insert_flip_char</span><span class="p">(</span><span class="n">tty</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">TTY_OVERRUN</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="cm">/* save if the transmitter is empty or not */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">packet</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">FTDI_RS_TEMT</span><span class="p">)</span>
		<span class="n">priv</span><span class="o">-&gt;</span><span class="n">transmit_empty</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="n">priv</span><span class="o">-&gt;</span><span class="n">transmit_empty</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">len</span> <span class="o">-=</span> <span class="mi">2</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">len</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>	<span class="cm">/* status only */</span>
	<span class="n">priv</span><span class="o">-&gt;</span><span class="n">icount</span><span class="p">.</span><span class="n">rx</span> <span class="o">+=</span> <span class="n">len</span><span class="p">;</span>
	<span class="n">ch</span> <span class="o">=</span> <span class="n">packet</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">port</span><span class="p">.</span><span class="n">console</span> <span class="o">&amp;&amp;</span> <span class="n">port</span><span class="o">-&gt;</span><span class="n">sysrq</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">,</span> <span class="n">ch</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">usb_serial_handle_sysrq_char</span><span class="p">(</span><span class="n">port</span><span class="p">,</span> <span class="o">*</span><span class="n">ch</span><span class="p">))</span>
				<span class="n">tty_insert_flip_char</span><span class="p">(</span><span class="n">tty</span><span class="p">,</span> <span class="o">*</span><span class="n">ch</span><span class="p">,</span> <span class="n">flag</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">tty_insert_flip_string_fixed_flag</span><span class="p">(</span><span class="n">tty</span><span class="p">,</span> <span class="n">ch</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">len</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="n">len</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ftdi_process_read_urb</span><span class="p">(</span><span class="k">struct</span> <span class="n">urb</span> <span class="o">*</span><span class="n">urb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span> <span class="o">=</span> <span class="n">urb</span><span class="o">-&gt;</span><span class="n">context</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">tty_struct</span> <span class="o">*</span><span class="n">tty</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span> <span class="o">=</span> <span class="n">usb_get_serial_port_data</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
	<span class="kt">char</span> <span class="o">*</span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">urb</span><span class="o">-&gt;</span><span class="n">transfer_buffer</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">len</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">tty</span> <span class="o">=</span> <span class="n">tty_port_tty_get</span><span class="p">(</span><span class="o">&amp;</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">port</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">tty</span><span class="p">)</span>
		<span class="k">return</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">urb</span><span class="o">-&gt;</span><span class="n">actual_length</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">max_packet_size</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">len</span> <span class="o">=</span> <span class="n">min_t</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">urb</span><span class="o">-&gt;</span><span class="n">actual_length</span> <span class="o">-</span> <span class="n">i</span><span class="p">,</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">max_packet_size</span><span class="p">);</span>
		<span class="n">count</span> <span class="o">+=</span> <span class="n">ftdi_process_packet</span><span class="p">(</span><span class="n">tty</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">priv</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">len</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">count</span><span class="p">)</span>
		<span class="n">tty_flip_buffer_push</span><span class="p">(</span><span class="n">tty</span><span class="p">);</span>
	<span class="n">tty_kref_put</span><span class="p">(</span><span class="n">tty</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ftdi_break_ctl</span><span class="p">(</span><span class="k">struct</span> <span class="n">tty_struct</span> <span class="o">*</span><span class="n">tty</span><span class="p">,</span> <span class="kt">int</span> <span class="n">break_state</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span> <span class="o">=</span> <span class="n">tty</span><span class="o">-&gt;</span><span class="n">driver_data</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span> <span class="o">=</span> <span class="n">usb_get_serial_port_data</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
	<span class="n">__u16</span> <span class="n">urb_value</span><span class="p">;</span>

	<span class="cm">/* break_state = -1 to turn on break, and 0 to turn off break */</span>
	<span class="cm">/* see drivers/char/tty_io.c to see it used */</span>
	<span class="cm">/* last_set_data_urb_value NEVER has the break bit set in it */</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">break_state</span><span class="p">)</span>
		<span class="n">urb_value</span> <span class="o">=</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">last_set_data_urb_value</span> <span class="o">|</span> <span class="n">FTDI_SIO_SET_BREAK</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="n">urb_value</span> <span class="o">=</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">last_set_data_urb_value</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">usb_control_msg</span><span class="p">(</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">serial</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span>
			<span class="n">usb_sndctrlpipe</span><span class="p">(</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">serial</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
			<span class="n">FTDI_SIO_SET_DATA_REQUEST</span><span class="p">,</span>
			<span class="n">FTDI_SIO_SET_DATA_REQUEST_TYPE</span><span class="p">,</span>
			<span class="n">urb_value</span> <span class="p">,</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">interface</span><span class="p">,</span>
			<span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">WDR_TIMEOUT</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">dev_err</span><span class="p">(</span><span class="o">&amp;</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;%s FAILED to enable/disable break state &quot;</span>
			<span class="s">&quot;(state was %d)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">,</span> <span class="n">break_state</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">dbg</span><span class="p">(</span><span class="s">&quot;%s break state is %d - urb is %d&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">,</span>
						<span class="n">break_state</span><span class="p">,</span> <span class="n">urb_value</span><span class="p">);</span>

<span class="p">}</span>

<span class="cm">/* old_termios contains the original termios settings and tty-&gt;termios contains</span>
<span class="cm"> * the new setting to be used</span>
<span class="cm"> * WARNING: set_termios calls this with old_termios in kernel space</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">ftdi_set_termios</span><span class="p">(</span><span class="k">struct</span> <span class="n">tty_struct</span> <span class="o">*</span><span class="n">tty</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ktermios</span> <span class="o">*</span><span class="n">old_termios</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">usb_device</span> <span class="o">*</span><span class="n">dev</span> <span class="o">=</span> <span class="n">port</span><span class="o">-&gt;</span><span class="n">serial</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span> <span class="o">=</span> <span class="n">usb_get_serial_port_data</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">ktermios</span> <span class="o">*</span><span class="n">termios</span> <span class="o">=</span> <span class="n">tty</span><span class="o">-&gt;</span><span class="n">termios</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cflag</span> <span class="o">=</span> <span class="n">termios</span><span class="o">-&gt;</span><span class="n">c_cflag</span><span class="p">;</span>
	<span class="n">__u16</span> <span class="n">urb_value</span><span class="p">;</span> <span class="cm">/* will hold the new flags */</span>

	<span class="cm">/* Added for xon/xoff support */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">iflag</span> <span class="o">=</span> <span class="n">termios</span><span class="o">-&gt;</span><span class="n">c_iflag</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">vstop</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">vstart</span><span class="p">;</span>

	<span class="cm">/* Force baud rate if this device requires it, unless it is set to</span>
<span class="cm">	   B0. */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">force_baud</span> <span class="o">&amp;&amp;</span> <span class="p">((</span><span class="n">termios</span><span class="o">-&gt;</span><span class="n">c_cflag</span> <span class="o">&amp;</span> <span class="n">CBAUD</span><span class="p">)</span> <span class="o">!=</span> <span class="n">B0</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">dbg</span><span class="p">(</span><span class="s">&quot;%s: forcing baud rate for this device&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">);</span>
		<span class="n">tty_encode_baud_rate</span><span class="p">(</span><span class="n">tty</span><span class="p">,</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">force_baud</span><span class="p">,</span>
					<span class="n">priv</span><span class="o">-&gt;</span><span class="n">force_baud</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="cm">/* Force RTS-CTS if this device requires it. */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">force_rtscts</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">dbg</span><span class="p">(</span><span class="s">&quot;%s: forcing rtscts for this device&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">);</span>
		<span class="n">termios</span><span class="o">-&gt;</span><span class="n">c_cflag</span> <span class="o">|=</span> <span class="n">CRTSCTS</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">cflag</span> <span class="o">=</span> <span class="n">termios</span><span class="o">-&gt;</span><span class="n">c_cflag</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">old_termios</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">goto</span> <span class="n">no_skip</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">old_termios</span><span class="o">-&gt;</span><span class="n">c_cflag</span> <span class="o">==</span> <span class="n">termios</span><span class="o">-&gt;</span><span class="n">c_cflag</span>
	    <span class="o">&amp;&amp;</span> <span class="n">old_termios</span><span class="o">-&gt;</span><span class="n">c_ispeed</span> <span class="o">==</span> <span class="n">termios</span><span class="o">-&gt;</span><span class="n">c_ispeed</span>
	    <span class="o">&amp;&amp;</span> <span class="n">old_termios</span><span class="o">-&gt;</span><span class="n">c_ospeed</span> <span class="o">==</span> <span class="n">termios</span><span class="o">-&gt;</span><span class="n">c_ospeed</span><span class="p">)</span>
		<span class="k">goto</span> <span class="n">no_c_cflag_changes</span><span class="p">;</span>

	<span class="cm">/* NOTE These routines can get interrupted by</span>
<span class="cm">	   ftdi_sio_read_bulk_callback  - need to examine what this means -</span>
<span class="cm">	   don&#39;t see any problems yet */</span>

	<span class="k">if</span> <span class="p">((</span><span class="n">old_termios</span><span class="o">-&gt;</span><span class="n">c_cflag</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">CSIZE</span><span class="o">|</span><span class="n">PARODD</span><span class="o">|</span><span class="n">PARENB</span><span class="o">|</span><span class="n">CMSPAR</span><span class="o">|</span><span class="n">CSTOPB</span><span class="p">))</span> <span class="o">==</span>
	    <span class="p">(</span><span class="n">termios</span><span class="o">-&gt;</span><span class="n">c_cflag</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">CSIZE</span><span class="o">|</span><span class="n">PARODD</span><span class="o">|</span><span class="n">PARENB</span><span class="o">|</span><span class="n">CMSPAR</span><span class="o">|</span><span class="n">CSTOPB</span><span class="p">)))</span>
		<span class="k">goto</span> <span class="n">no_data_parity_stop_changes</span><span class="p">;</span>

<span class="nl">no_skip:</span>
	<span class="cm">/* Set number of data bits, parity, stop bits */</span>

	<span class="n">urb_value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">urb_value</span> <span class="o">|=</span> <span class="p">(</span><span class="n">cflag</span> <span class="o">&amp;</span> <span class="n">CSTOPB</span> <span class="o">?</span> <span class="n">FTDI_SIO_SET_DATA_STOP_BITS_2</span> <span class="o">:</span>
		      <span class="n">FTDI_SIO_SET_DATA_STOP_BITS_1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">cflag</span> <span class="o">&amp;</span> <span class="n">PARENB</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">cflag</span> <span class="o">&amp;</span> <span class="n">CMSPAR</span><span class="p">)</span>
			<span class="n">urb_value</span> <span class="o">|=</span> <span class="n">cflag</span> <span class="o">&amp;</span> <span class="n">PARODD</span> <span class="o">?</span>
				     <span class="n">FTDI_SIO_SET_DATA_PARITY_MARK</span> <span class="o">:</span>
				     <span class="n">FTDI_SIO_SET_DATA_PARITY_SPACE</span><span class="p">;</span>
		<span class="k">else</span>
			<span class="n">urb_value</span> <span class="o">|=</span> <span class="n">cflag</span> <span class="o">&amp;</span> <span class="n">PARODD</span> <span class="o">?</span>
				     <span class="n">FTDI_SIO_SET_DATA_PARITY_ODD</span> <span class="o">:</span>
				     <span class="n">FTDI_SIO_SET_DATA_PARITY_EVEN</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">urb_value</span> <span class="o">|=</span> <span class="n">FTDI_SIO_SET_DATA_PARITY_NONE</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">cflag</span> <span class="o">&amp;</span> <span class="n">CSIZE</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">switch</span> <span class="p">(</span><span class="n">cflag</span> <span class="o">&amp;</span> <span class="n">CSIZE</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="n">CS7</span>: <span class="n">urb_value</span> <span class="o">|=</span> <span class="mi">7</span><span class="p">;</span> <span class="n">dbg</span><span class="p">(</span><span class="s">&quot;Setting CS7&quot;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">CS8</span>: <span class="n">urb_value</span> <span class="o">|=</span> <span class="mi">8</span><span class="p">;</span> <span class="n">dbg</span><span class="p">(</span><span class="s">&quot;Setting CS8&quot;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
		<span class="nl">default:</span>
			<span class="n">dev_err</span><span class="p">(</span><span class="o">&amp;</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;CSIZE was set but not CS7-CS8</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="cm">/* This is needed by the break command since it uses the same command</span>
<span class="cm">	   - but is or&#39;ed with this value  */</span>
	<span class="n">priv</span><span class="o">-&gt;</span><span class="n">last_set_data_urb_value</span> <span class="o">=</span> <span class="n">urb_value</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">usb_control_msg</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">usb_sndctrlpipe</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
			    <span class="n">FTDI_SIO_SET_DATA_REQUEST</span><span class="p">,</span>
			    <span class="n">FTDI_SIO_SET_DATA_REQUEST_TYPE</span><span class="p">,</span>
			    <span class="n">urb_value</span> <span class="p">,</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">interface</span><span class="p">,</span>
			    <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">WDR_SHORT_TIMEOUT</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">dev_err</span><span class="p">(</span><span class="o">&amp;</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;%s FAILED to set &quot;</span>
			<span class="s">&quot;databits/stopbits/parity</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="cm">/* Now do the baudrate */</span>
<span class="nl">no_data_parity_stop_changes:</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">cflag</span> <span class="o">&amp;</span> <span class="n">CBAUD</span><span class="p">)</span> <span class="o">==</span> <span class="n">B0</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* Disable flow control */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">usb_control_msg</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">usb_sndctrlpipe</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
				    <span class="n">FTDI_SIO_SET_FLOW_CTRL_REQUEST</span><span class="p">,</span>
				    <span class="n">FTDI_SIO_SET_FLOW_CTRL_REQUEST_TYPE</span><span class="p">,</span>
				    <span class="mi">0</span><span class="p">,</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">interface</span><span class="p">,</span>
				    <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">WDR_TIMEOUT</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">dev_err</span><span class="p">(</span><span class="o">&amp;</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span>
				<span class="s">&quot;%s error from disable flowcontrol urb</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
				<span class="n">__func__</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="cm">/* Drop RTS and DTR */</span>
		<span class="n">clear_mctrl</span><span class="p">(</span><span class="n">port</span><span class="p">,</span> <span class="n">TIOCM_DTR</span> <span class="o">|</span> <span class="n">TIOCM_RTS</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="cm">/* set the baudrate determined before */</span>
		<span class="n">mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">cfg_lock</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">change_speed</span><span class="p">(</span><span class="n">tty</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
			<span class="n">dev_err</span><span class="p">(</span><span class="o">&amp;</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;%s urb failed to set baudrate</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
				<span class="n">__func__</span><span class="p">);</span>
		<span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">cfg_lock</span><span class="p">);</span>
		<span class="cm">/* Ensure RTS and DTR are raised when baudrate changed from 0 */</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">old_termios</span> <span class="o">||</span> <span class="p">(</span><span class="n">old_termios</span><span class="o">-&gt;</span><span class="n">c_cflag</span> <span class="o">&amp;</span> <span class="n">CBAUD</span><span class="p">)</span> <span class="o">==</span> <span class="n">B0</span><span class="p">)</span>
			<span class="n">set_mctrl</span><span class="p">(</span><span class="n">port</span><span class="p">,</span> <span class="n">TIOCM_DTR</span> <span class="o">|</span> <span class="n">TIOCM_RTS</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="cm">/* Set flow control */</span>
	<span class="cm">/* Note device also supports DTR/CD (ugh) and Xon/Xoff in hardware */</span>
<span class="nl">no_c_cflag_changes:</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">cflag</span> <span class="o">&amp;</span> <span class="n">CRTSCTS</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">dbg</span><span class="p">(</span><span class="s">&quot;%s Setting to CRTSCTS flow control&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">usb_control_msg</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span>
				    <span class="n">usb_sndctrlpipe</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
				    <span class="n">FTDI_SIO_SET_FLOW_CTRL_REQUEST</span><span class="p">,</span>
				    <span class="n">FTDI_SIO_SET_FLOW_CTRL_REQUEST_TYPE</span><span class="p">,</span>
				    <span class="mi">0</span> <span class="p">,</span> <span class="p">(</span><span class="n">FTDI_SIO_RTS_CTS_HS</span> <span class="o">|</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">interface</span><span class="p">),</span>
				    <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">WDR_TIMEOUT</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">dev_err</span><span class="p">(</span><span class="o">&amp;</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span>
				<span class="s">&quot;urb failed to set to rts/cts flow control</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="p">}</span>

	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="cm">/*</span>
<span class="cm">		 * Xon/Xoff code</span>
<span class="cm">		 *</span>
<span class="cm">		 * Check the IXOFF status in the iflag component of the</span>
<span class="cm">		 * termios structure. If IXOFF is not set, the pre-xon/xoff</span>
<span class="cm">		 * code is executed.</span>
<span class="cm">		 */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">iflag</span> <span class="o">&amp;</span> <span class="n">IXOFF</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">dbg</span><span class="p">(</span><span class="s">&quot;%s  request to enable xonxoff iflag=%04x&quot;</span><span class="p">,</span>
							<span class="n">__func__</span><span class="p">,</span> <span class="n">iflag</span><span class="p">);</span>
			<span class="cm">/* Try to enable the XON/XOFF on the ftdi_sio</span>
<span class="cm">			 * Set the vstart and vstop -- could have been done up</span>
<span class="cm">			 * above where a lot of other dereferencing is done but</span>
<span class="cm">			 * that would be very inefficient as vstart and vstop</span>
<span class="cm">			 * are not always needed.</span>
<span class="cm">			 */</span>
			<span class="n">vstart</span> <span class="o">=</span> <span class="n">termios</span><span class="o">-&gt;</span><span class="n">c_cc</span><span class="p">[</span><span class="n">VSTART</span><span class="p">];</span>
			<span class="n">vstop</span> <span class="o">=</span> <span class="n">termios</span><span class="o">-&gt;</span><span class="n">c_cc</span><span class="p">[</span><span class="n">VSTOP</span><span class="p">];</span>
			<span class="n">urb_value</span> <span class="o">=</span> <span class="p">(</span><span class="n">vstop</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">vstart</span><span class="p">);</span>

			<span class="k">if</span> <span class="p">(</span><span class="n">usb_control_msg</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span>
					    <span class="n">usb_sndctrlpipe</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
					    <span class="n">FTDI_SIO_SET_FLOW_CTRL_REQUEST</span><span class="p">,</span>
					    <span class="n">FTDI_SIO_SET_FLOW_CTRL_REQUEST_TYPE</span><span class="p">,</span>
					    <span class="n">urb_value</span> <span class="p">,</span> <span class="p">(</span><span class="n">FTDI_SIO_XON_XOFF_HS</span>
							 <span class="o">|</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">interface</span><span class="p">),</span>
					    <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">WDR_TIMEOUT</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">dev_err</span><span class="p">(</span><span class="o">&amp;</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;urb failed to set to &quot;</span>
					<span class="s">&quot;xon/xoff flow control</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="cm">/* else clause to only run if cflag ! CRTSCTS and iflag</span>
<span class="cm">			 * ! XOFF. CHECKME Assuming XON/XOFF handled by tty</span>
<span class="cm">			 * stack - not by device */</span>
			<span class="n">dbg</span><span class="p">(</span><span class="s">&quot;%s Turning off hardware flow control&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">usb_control_msg</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span>
					    <span class="n">usb_sndctrlpipe</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
					    <span class="n">FTDI_SIO_SET_FLOW_CTRL_REQUEST</span><span class="p">,</span>
					    <span class="n">FTDI_SIO_SET_FLOW_CTRL_REQUEST_TYPE</span><span class="p">,</span>
					    <span class="mi">0</span><span class="p">,</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">interface</span><span class="p">,</span>
					    <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">WDR_TIMEOUT</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">dev_err</span><span class="p">(</span><span class="o">&amp;</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span>
					<span class="s">&quot;urb failed to clear flow control</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>

	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ftdi_tiocmget</span><span class="p">(</span><span class="k">struct</span> <span class="n">tty_struct</span> <span class="o">*</span><span class="n">tty</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span> <span class="o">=</span> <span class="n">tty</span><span class="o">-&gt;</span><span class="n">driver_data</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span> <span class="o">=</span> <span class="n">usb_get_serial_port_data</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">buf</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">len</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">ret</span><span class="p">;</span>

	<span class="n">buf</span> <span class="o">=</span> <span class="n">kmalloc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">GFP_KERNEL</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">buf</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>
	<span class="cm">/*</span>
<span class="cm">	 * The 8U232AM returns a two byte value (the SIO a 1 byte value) in</span>
<span class="cm">	 * the same format as the data returned from the in point.</span>
<span class="cm">	 */</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">chip_type</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">SIO</span>:
		<span class="n">len</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">FT8U232AM</span>:
	<span class="k">case</span> <span class="n">FT232BM</span>:
	<span class="k">case</span> <span class="n">FT2232C</span>:
	<span class="k">case</span> <span class="n">FT232RL</span>:
	<span class="k">case</span> <span class="n">FT2232H</span>:
	<span class="k">case</span> <span class="n">FT4232H</span>:
	<span class="k">case</span> <span class="n">FT232H</span>:
	<span class="k">case</span> <span class="n">FTX</span>:
		<span class="n">len</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="n">ret</span> <span class="o">=</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
		<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">ret</span> <span class="o">=</span> <span class="n">usb_control_msg</span><span class="p">(</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">serial</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span>
			<span class="n">usb_rcvctrlpipe</span><span class="p">(</span><span class="n">port</span><span class="o">-&gt;</span><span class="n">serial</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
			<span class="n">FTDI_SIO_GET_MODEM_STATUS_REQUEST</span><span class="p">,</span>
			<span class="n">FTDI_SIO_GET_MODEM_STATUS_REQUEST_TYPE</span><span class="p">,</span>
			<span class="mi">0</span><span class="p">,</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">interface</span><span class="p">,</span>
			<span class="n">buf</span><span class="p">,</span> <span class="n">len</span><span class="p">,</span> <span class="n">WDR_TIMEOUT</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>

	<span class="n">ret</span> <span class="o">=</span> <span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">FTDI_SIO_DSR_MASK</span> <span class="o">?</span> <span class="n">TIOCM_DSR</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span>
		<span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">FTDI_SIO_CTS_MASK</span> <span class="o">?</span> <span class="n">TIOCM_CTS</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span>
		<span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="o">&amp;</span> <span class="n">FTDI_SIO_RI_MASK</span>  <span class="o">?</span> <span class="n">TIOCM_RI</span>  <span class="o">:</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span>
		<span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="o">&amp;</span> <span class="n">FTDI_SIO_RLSD_MASK</span> <span class="o">?</span> <span class="n">TIOCM_CD</span>  <span class="o">:</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span>
		<span class="n">priv</span><span class="o">-&gt;</span><span class="n">last_dtr_rts</span><span class="p">;</span>
<span class="nl">out:</span>
	<span class="n">kfree</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ftdi_tiocmset</span><span class="p">(</span><span class="k">struct</span> <span class="n">tty_struct</span> <span class="o">*</span><span class="n">tty</span><span class="p">,</span>
			<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">set</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">clear</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span> <span class="o">=</span> <span class="n">tty</span><span class="o">-&gt;</span><span class="n">driver_data</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">update_mctrl</span><span class="p">(</span><span class="n">port</span><span class="p">,</span> <span class="n">set</span><span class="p">,</span> <span class="n">clear</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ftdi_get_icount</span><span class="p">(</span><span class="k">struct</span> <span class="n">tty_struct</span> <span class="o">*</span><span class="n">tty</span><span class="p">,</span>
				<span class="k">struct</span> <span class="n">serial_icounter_struct</span> <span class="o">*</span><span class="n">icount</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span> <span class="o">=</span> <span class="n">tty</span><span class="o">-&gt;</span><span class="n">driver_data</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span> <span class="o">=</span> <span class="n">usb_get_serial_port_data</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">async_icount</span> <span class="o">*</span><span class="n">ic</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">icount</span><span class="p">;</span>

	<span class="n">icount</span><span class="o">-&gt;</span><span class="n">cts</span> <span class="o">=</span> <span class="n">ic</span><span class="o">-&gt;</span><span class="n">cts</span><span class="p">;</span>
	<span class="n">icount</span><span class="o">-&gt;</span><span class="n">dsr</span> <span class="o">=</span> <span class="n">ic</span><span class="o">-&gt;</span><span class="n">dsr</span><span class="p">;</span>
	<span class="n">icount</span><span class="o">-&gt;</span><span class="n">rng</span> <span class="o">=</span> <span class="n">ic</span><span class="o">-&gt;</span><span class="n">rng</span><span class="p">;</span>
	<span class="n">icount</span><span class="o">-&gt;</span><span class="n">dcd</span> <span class="o">=</span> <span class="n">ic</span><span class="o">-&gt;</span><span class="n">dcd</span><span class="p">;</span>
	<span class="n">icount</span><span class="o">-&gt;</span><span class="n">tx</span> <span class="o">=</span> <span class="n">ic</span><span class="o">-&gt;</span><span class="n">tx</span><span class="p">;</span>
	<span class="n">icount</span><span class="o">-&gt;</span><span class="n">rx</span> <span class="o">=</span> <span class="n">ic</span><span class="o">-&gt;</span><span class="n">rx</span><span class="p">;</span>
	<span class="n">icount</span><span class="o">-&gt;</span><span class="n">frame</span> <span class="o">=</span> <span class="n">ic</span><span class="o">-&gt;</span><span class="n">frame</span><span class="p">;</span>
	<span class="n">icount</span><span class="o">-&gt;</span><span class="n">parity</span> <span class="o">=</span> <span class="n">ic</span><span class="o">-&gt;</span><span class="n">parity</span><span class="p">;</span>
	<span class="n">icount</span><span class="o">-&gt;</span><span class="n">overrun</span> <span class="o">=</span> <span class="n">ic</span><span class="o">-&gt;</span><span class="n">overrun</span><span class="p">;</span>
	<span class="n">icount</span><span class="o">-&gt;</span><span class="n">brk</span> <span class="o">=</span> <span class="n">ic</span><span class="o">-&gt;</span><span class="n">brk</span><span class="p">;</span>
	<span class="n">icount</span><span class="o">-&gt;</span><span class="n">buf_overrun</span> <span class="o">=</span> <span class="n">ic</span><span class="o">-&gt;</span><span class="n">buf_overrun</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ftdi_ioctl</span><span class="p">(</span><span class="k">struct</span> <span class="n">tty_struct</span> <span class="o">*</span><span class="n">tty</span><span class="p">,</span>
					<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cmd</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">arg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">usb_serial_port</span> <span class="o">*</span><span class="n">port</span> <span class="o">=</span> <span class="n">tty</span><span class="o">-&gt;</span><span class="n">driver_data</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ftdi_private</span> <span class="o">*</span><span class="n">priv</span> <span class="o">=</span> <span class="n">usb_get_serial_port_data</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">async_icount</span> <span class="n">cnow</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">async_icount</span> <span class="n">cprev</span><span class="p">;</span>

	<span class="n">dbg</span><span class="p">(</span><span class="s">&quot;%s cmd 0x%04x&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">,</span> <span class="n">cmd</span><span class="p">);</span>

	<span class="cm">/* Based on code from acm.c and others */</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">cmd</span><span class="p">)</span> <span class="p">{</span>

	<span class="k">case</span> <span class="n">TIOCGSERIAL</span>: <span class="cm">/* gets serial port data */</span>
		<span class="k">return</span> <span class="n">get_serial_info</span><span class="p">(</span><span class="n">port</span><span class="p">,</span>
					<span class="p">(</span><span class="k">struct</span> <span class="n">serial_struct</span> <span class="n">__user</span> <span class="o">*</span><span class="p">)</span> <span class="n">arg</span><span class="p">);</span>

	<span class="k">case</span> <span class="n">TIOCSSERIAL</span>: <span class="cm">/* sets serial port data */</span>
		<span class="k">return</span> <span class="n">set_serial_info</span><span class="p">(</span><span class="n">tty</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span>
					<span class="p">(</span><span class="k">struct</span> <span class="n">serial_struct</span> <span class="n">__user</span> <span class="o">*</span><span class="p">)</span> <span class="n">arg</span><span class="p">);</span>

	<span class="cm">/*</span>
<span class="cm">	 * Wait for any of the 4 modem inputs (DCD,RI,DSR,CTS) to change</span>
<span class="cm">	 * - mask passed in arg for lines of interest</span>
<span class="cm">	 *   (use |&#39;ed TIOCM_RNG/DSR/CD/CTS for masking)</span>
<span class="cm">	 * Caller should use TIOCGICOUNT to see which one it was.</span>
<span class="cm">	 *</span>
<span class="cm">	 * This code is borrowed from linux/drivers/char/serial.c</span>
<span class="cm">	 */</span>
	<span class="k">case</span> <span class="n">TIOCMIWAIT</span>:
		<span class="n">cprev</span> <span class="o">=</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">icount</span><span class="p">;</span>
		<span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">dev_gone</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">interruptible_sleep_on</span><span class="p">(</span><span class="o">&amp;</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">delta_msr_wait</span><span class="p">);</span>
			<span class="cm">/* see if a signal did it */</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">signal_pending</span><span class="p">(</span><span class="n">current</span><span class="p">))</span>
				<span class="k">return</span> <span class="o">-</span><span class="n">ERESTARTSYS</span><span class="p">;</span>
			<span class="n">cnow</span> <span class="o">=</span> <span class="n">priv</span><span class="o">-&gt;</span><span class="n">icount</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(((</span><span class="n">arg</span> <span class="o">&amp;</span> <span class="n">TIOCM_RNG</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">cnow</span><span class="p">.</span><span class="n">rng</span> <span class="o">!=</span> <span class="n">cprev</span><span class="p">.</span><span class="n">rng</span><span class="p">))</span> <span class="o">||</span>
			    <span class="p">((</span><span class="n">arg</span> <span class="o">&amp;</span> <span class="n">TIOCM_DSR</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">cnow</span><span class="p">.</span><span class="n">dsr</span> <span class="o">!=</span> <span class="n">cprev</span><span class="p">.</span><span class="n">dsr</span><span class="p">))</span> <span class="o">||</span>
			    <span class="p">((</span><span class="n">arg</span> <span class="o">&amp;</span> <span class="n">TIOCM_CD</span><span class="p">)</span>  <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">cnow</span><span class="p">.</span><span class="n">dcd</span> <span class="o">!=</span> <span class="n">cprev</span><span class="p">.</span><span class="n">dcd</span><span class="p">))</span> <span class="o">||</span>
			    <span class="p">((</span><span class="n">arg</span> <span class="o">&amp;</span> <span class="n">TIOCM_CTS</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">cnow</span><span class="p">.</span><span class="n">cts</span> <span class="o">!=</span> <span class="n">cprev</span><span class="p">.</span><span class="n">cts</span><span class="p">)))</span> <span class="p">{</span>
				<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">cprev</span> <span class="o">=</span> <span class="n">cnow</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EIO</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">TIOCSERGETLSR</span>:
		<span class="k">return</span> <span class="n">get_lsr_info</span><span class="p">(</span><span class="n">port</span><span class="p">,</span> <span class="p">(</span><span class="k">struct</span> <span class="n">serial_struct</span> <span class="n">__user</span> <span class="o">*</span><span class="p">)</span><span class="n">arg</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="cm">/* This is not necessarily an error - turns out the higher layers</span>
<span class="cm">	 * will do some ioctls themselves (see comment above)</span>
<span class="cm">	 */</span>
	<span class="n">dbg</span><span class="p">(</span><span class="s">&quot;%s arg not supported - it was 0x%04x - check /usr/include/asm/ioctls.h&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">,</span> <span class="n">cmd</span><span class="p">);</span>
	<span class="k">return</span> <span class="o">-</span><span class="n">ENOIOCTLCMD</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="n">__init</span> <span class="nf">ftdi_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">retval</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">vendor</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">product</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* Add user specified VID/PID to reserved element of table. */</span>
		<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">id_table_combined</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">idVendor</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
			<span class="p">;</span>
		<span class="n">id_table_combined</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">match_flags</span> <span class="o">=</span> <span class="n">USB_DEVICE_ID_MATCH_DEVICE</span><span class="p">;</span>
		<span class="n">id_table_combined</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">idVendor</span> <span class="o">=</span> <span class="n">vendor</span><span class="p">;</span>
		<span class="n">id_table_combined</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">idProduct</span> <span class="o">=</span> <span class="n">product</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">retval</span> <span class="o">=</span> <span class="n">usb_serial_register_drivers</span><span class="p">(</span><span class="n">serial_drivers</span><span class="p">,</span> <span class="n">KBUILD_MODNAME</span><span class="p">,</span> <span class="n">id_table_combined</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">retval</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="n">KBUILD_MODNAME</span> <span class="s">&quot;: &quot;</span> <span class="n">DRIVER_VERSION</span> <span class="s">&quot;:&quot;</span>
			       <span class="n">DRIVER_DESC</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">retval</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="n">__exit</span> <span class="nf">ftdi_exit</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">usb_serial_deregister_drivers</span><span class="p">(</span><span class="n">serial_drivers</span><span class="p">);</span>
<span class="p">}</span>


<span class="n">module_init</span><span class="p">(</span><span class="n">ftdi_init</span><span class="p">);</span>
<span class="n">module_exit</span><span class="p">(</span><span class="n">ftdi_exit</span><span class="p">);</span>

<span class="n">MODULE_AUTHOR</span><span class="p">(</span><span class="n">DRIVER_AUTHOR</span><span class="p">);</span>
<span class="n">MODULE_DESCRIPTION</span><span class="p">(</span><span class="n">DRIVER_DESC</span><span class="p">);</span>
<span class="n">MODULE_LICENSE</span><span class="p">(</span><span class="s">&quot;GPL&quot;</span><span class="p">);</span>

<span class="n">module_param</span><span class="p">(</span><span class="n">debug</span><span class="p">,</span> <span class="n">bool</span><span class="p">,</span> <span class="n">S_IRUGO</span> <span class="o">|</span> <span class="n">S_IWUSR</span><span class="p">);</span>
<span class="n">MODULE_PARM_DESC</span><span class="p">(</span><span class="n">debug</span><span class="p">,</span> <span class="s">&quot;Debug enabled or not&quot;</span><span class="p">);</span>
<span class="n">module_param</span><span class="p">(</span><span class="n">vendor</span><span class="p">,</span> <span class="n">ushort</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="n">MODULE_PARM_DESC</span><span class="p">(</span><span class="n">vendor</span><span class="p">,</span> <span class="s">&quot;User specified vendor ID (default=&quot;</span>
		<span class="n">__MODULE_STRING</span><span class="p">(</span><span class="n">FTDI_VID</span><span class="p">)</span><span class="s">&quot;)&quot;</span><span class="p">);</span>
<span class="n">module_param</span><span class="p">(</span><span class="n">product</span><span class="p">,</span> <span class="n">ushort</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="n">MODULE_PARM_DESC</span><span class="p">(</span><span class="n">product</span><span class="p">,</span> <span class="s">&quot;User specified product ID&quot;</span><span class="p">);</span>

<span class="n">module_param</span><span class="p">(</span><span class="n">ndi_latency_timer</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="n">S_IRUGO</span> <span class="o">|</span> <span class="n">S_IWUSR</span><span class="p">);</span>
<span class="n">MODULE_PARM_DESC</span><span class="p">(</span><span class="n">ndi_latency_timer</span><span class="p">,</span> <span class="s">&quot;NDI device latency timer override&quot;</span><span class="p">);</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
