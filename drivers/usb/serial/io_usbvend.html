<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › usb › serial › io_usbvend.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>io_usbvend.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/************************************************************************</span>
<span class="cm"> *</span>
<span class="cm"> *	USBVEND.H		Vendor-specific USB definitions</span>
<span class="cm"> *</span>
<span class="cm"> *	NOTE: This must be kept in sync with the Edgeport firmware and</span>
<span class="cm"> *	must be kept backward-compatible with older firmware.</span>
<span class="cm"> *</span>
<span class="cm"> ************************************************************************</span>
<span class="cm"> *</span>
<span class="cm"> *	Copyright (C) 1998 Inside Out Networks, Inc.</span>
<span class="cm"> *	This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> *	it under the terms of the GNU General Public License as published by</span>
<span class="cm"> *	the Free Software Foundation; either version 2 of the License, or</span>
<span class="cm"> *	(at your option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> ************************************************************************/</span>

<span class="cp">#if !defined(_USBVEND_H)</span>
<span class="cp">#define	_USBVEND_H</span>

<span class="cm">/************************************************************************</span>
<span class="cm"> *</span>
<span class="cm"> *		D e f i n e s   /   T y p e d e f s</span>
<span class="cm"> *</span>
<span class="cm"> ************************************************************************/</span></pre></div></td></tr>


<tr id="section-2"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-2">&#182;</a></div><p>Definitions of USB product IDs</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define	USB_VENDOR_ID_ION	0x1608		</span><span class="c1">// Our VID</span>
<span class="cp">#define	USB_VENDOR_ID_TI	0x0451		</span><span class="c1">// TI VID</span>
<span class="cp">#define USB_VENDOR_ID_AXIOHM	0x05D9		</span><span class="cm">/* Axiohm VID */</span><span class="cp"></span></pre></div></td></tr>


<tr id="section-3"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-3">&#182;</a></div><p>Definitions of USB product IDs (PID)
We break the USB-defined PID into an OEM Id field (upper 6 bits)
and a Device Id (bottom 10 bits). The Device Id defines what
device this actually is regardless of what the OEM wants to
call it.</p></td><td class="code"><div class="highlight"><pre></pre></div></td></tr>


<tr id="section-4"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-4">&#182;</a></div><p>ION-device OEM IDs</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define	ION_OEM_ID_ION		0		</span><span class="c1">// 00h Inside Out Networks</span>
<span class="cp">#define	ION_OEM_ID_NLYNX	1		</span><span class="c1">// 01h NLynx Systems</span>
<span class="cp">#define	ION_OEM_ID_GENERIC	2		</span><span class="c1">// 02h Generic OEM</span>
<span class="cp">#define	ION_OEM_ID_MAC		3		</span><span class="c1">// 03h Mac Version</span>
<span class="cp">#define	ION_OEM_ID_MEGAWOLF	4		</span><span class="c1">// 04h Lupusb OEM Mac version (MegaWolf)</span>
<span class="cp">#define	ION_OEM_ID_MULTITECH	5		</span><span class="c1">// 05h Multitech Rapidports</span>
<span class="cp">#define	ION_OEM_ID_AGILENT	6		</span><span class="c1">// 06h AGILENT board</span></pre></div></td></tr>


<tr id="section-5"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-5">&#182;</a></div><p>ION-device Device IDs
Product IDs - assigned to match middle digit of serial number (No longer true)</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define ION_DEVICE_ID_80251_NETCHIP	0x020	</span><span class="c1">// This bit is set in the PID if this edgeport hardware$</span></pre></div></td></tr>


<tr id="section-6"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-6">&#182;</a></div><p>is based on the 80251+Netchip.</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define ION_DEVICE_ID_GENERATION_1	0x00	</span><span class="c1">// Value for 930 based edgeports</span>
<span class="cp">#define ION_DEVICE_ID_GENERATION_2	0x01	</span><span class="c1">// Value for 80251+Netchip.</span>
<span class="cp">#define ION_DEVICE_ID_GENERATION_3	0x02	</span><span class="c1">// Value for Texas Instruments TUSB5052 chip</span>
<span class="cp">#define ION_DEVICE_ID_GENERATION_4	0x03	</span><span class="c1">// Watchport Family of products</span>
<span class="cp">#define ION_GENERATION_MASK		0x03</span>

<span class="cp">#define ION_DEVICE_ID_HUB_MASK		0x0080	</span><span class="c1">// This bit in the PID designates a HUB device</span></pre></div></td></tr>


<tr id="section-7"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-7">&#182;</a></div><p>for example 8C would be a 421 4 port hub
and 8D would be a 2 port embedded hub</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define EDGEPORT_DEVICE_ID_MASK			0x0ff	</span><span class="c1">// Not including OEM or GENERATION fields</span>

<span class="cp">#define	ION_DEVICE_ID_UNCONFIGURED_EDGE_DEVICE	0x000	</span><span class="c1">// In manufacturing only</span>
<span class="cp">#define ION_DEVICE_ID_EDGEPORT_4		0x001	</span><span class="c1">// Edgeport/4 RS232</span>
<span class="cp">#define	ION_DEVICE_ID_EDGEPORT_8R		0x002	</span><span class="c1">// Edgeport with RJ45 no Ring</span>
<span class="cp">#define ION_DEVICE_ID_RAPIDPORT_4		0x003	</span><span class="c1">// Rapidport/4</span>
<span class="cp">#define ION_DEVICE_ID_EDGEPORT_4T		0x004	</span><span class="c1">// Edgeport/4 RS232 for Telxon (aka &quot;Fleetport&quot;)</span>
<span class="cp">#define ION_DEVICE_ID_EDGEPORT_2		0x005	</span><span class="c1">// Edgeport/2 RS232</span>
<span class="cp">#define ION_DEVICE_ID_EDGEPORT_4I		0x006	</span><span class="c1">// Edgeport/4 RS422</span>
<span class="cp">#define ION_DEVICE_ID_EDGEPORT_2I		0x007	</span><span class="c1">// Edgeport/2 RS422/RS485</span>
<span class="cp">#define	ION_DEVICE_ID_EDGEPORT_8RR		0x008	</span><span class="c1">// Edgeport with RJ45 with Data and RTS/CTS only</span></pre></div></td></tr>


<tr id="section-8"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-8">&#182;</a></div><p>ION<em>DEVICE</em>ID<em>EDGEPORT</em>8<em>HANDBUILT    0x009   // Hand-built Edgeport/8 (Placeholder, used in middle digit of serial number only!)
ION</em>DEVICE<em>ID</em>MULTIMODEM_4X56        0x00A   // MultiTech version of RP/4 (Placeholder, used in middle digit of serial number only!)</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define	ION_DEVICE_ID_EDGEPORT_PARALLEL_PORT	0x00B	</span><span class="c1">// Edgeport/(4)21 Parallel port (USS720)</span>
<span class="cp">#define	ION_DEVICE_ID_EDGEPORT_421		0x00C	</span><span class="c1">// Edgeport/421 Hub+RS232+Parallel</span>
<span class="cp">#define	ION_DEVICE_ID_EDGEPORT_21		0x00D	</span><span class="c1">// Edgeport/21  RS232+Parallel</span>
<span class="cp">#define ION_DEVICE_ID_EDGEPORT_8_DUAL_CPU	0x00E	</span><span class="c1">// Half of an Edgeport/8 (the kind with 2 EP/4s on 1 PCB)</span>
<span class="cp">#define ION_DEVICE_ID_EDGEPORT_8		0x00F	</span><span class="c1">// Edgeport/8 (single-CPU)</span>
<span class="cp">#define ION_DEVICE_ID_EDGEPORT_2_DIN		0x010	</span><span class="c1">// Edgeport/2 RS232 with Apple DIN connector</span>
<span class="cp">#define ION_DEVICE_ID_EDGEPORT_4_DIN		0x011	</span><span class="c1">// Edgeport/4 RS232 with Apple DIN connector</span>
<span class="cp">#define ION_DEVICE_ID_EDGEPORT_16_DUAL_CPU	0x012	</span><span class="c1">// Half of an Edgeport/16 (the kind with 2 EP/8s)</span>
<span class="cp">#define ION_DEVICE_ID_EDGEPORT_COMPATIBLE	0x013	</span><span class="c1">// Edgeport Compatible, for NCR, Axiohm etc. testing</span>
<span class="cp">#define ION_DEVICE_ID_EDGEPORT_8I		0x014	</span><span class="c1">// Edgeport/8 RS422 (single-CPU)</span>
<span class="cp">#define ION_DEVICE_ID_EDGEPORT_1		0x015	</span><span class="c1">// Edgeport/1 RS232</span>
<span class="cp">#define ION_DEVICE_ID_EPOS44			0x016	</span><span class="c1">// Half of an EPOS/44 (TIUMP BASED)</span>
<span class="cp">#define ION_DEVICE_ID_EDGEPORT_42		0x017	</span><span class="c1">// Edgeport/42</span>
<span class="cp">#define ION_DEVICE_ID_EDGEPORT_412_8		0x018	</span><span class="c1">// Edgeport/412 8 port part</span>
<span class="cp">#define ION_DEVICE_ID_EDGEPORT_412_4		0x019	</span><span class="c1">// Edgeport/412	4 port part</span>
<span class="cp">#define ION_DEVICE_ID_EDGEPORT_22I		0x01A	</span><span class="c1">// Edgeport/22I is an Edgeport/4 with ports 1&amp;2 RS422 and ports 3&amp;4 RS232</span></pre></div></td></tr>


<tr id="section-9"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-9">&#182;</a></div><p>Compact Form factor TI based devices  2c, 21c, 22c, 221c</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define ION_DEVICE_ID_EDGEPORT_2C		0x01B	</span><span class="c1">// Edgeport/2c is a TI based Edgeport/2 - Small I2c</span>
<span class="cp">#define ION_DEVICE_ID_EDGEPORT_221C		0x01C	</span><span class="c1">// Edgeport/221c is a TI based Edgeport/2 with lucent chip and</span></pre></div></td></tr>


<tr id="section-10"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-10">&#182;</a></div><p>2 external hub ports - Large I2C</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define ION_DEVICE_ID_EDGEPORT_22C		0x01D	</span><span class="c1">// Edgeport/22c is a TI based Edgeport/2 with</span></pre></div></td></tr>


<tr id="section-11"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-11">&#182;</a></div><p>2 external hub ports - Large I2C</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define ION_DEVICE_ID_EDGEPORT_21C		0x01E	</span><span class="c1">// Edgeport/21c is a TI based Edgeport/2 with lucent chip</span></pre></div></td></tr>


<tr id="section-12"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-12">&#182;</a></div><p>Small I2C</p></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> *  DANGER DANGER The 0x20 bit was used to indicate a 8251/netchip GEN 2 device.</span>
<span class="cm"> *  Since the MAC, Linux, and Optimal drivers still used the old code</span>
<span class="cm"> *  I suggest that you skip the 0x20 bit when creating new PIDs</span>
<span class="cm"> */</span></pre></div></td></tr>


<tr id="section-13"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-13">&#182;</a></div><p>Generation 3 devices -- 3410 based edgport/1 (256 byte I2C)</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define ION_DEVICE_ID_TI3410_EDGEPORT_1		0x040	</span><span class="c1">// Edgeport/1 RS232</span>
<span class="cp">#define ION_DEVICE_ID_TI3410_EDGEPORT_1I	0x041	</span><span class="c1">// Edgeport/1i- RS422 model</span></pre></div></td></tr>


<tr id="section-14"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-14">&#182;</a></div><p>Ti based software switchable RS232/RS422/RS485 devices</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define ION_DEVICE_ID_EDGEPORT_4S		0x042	</span><span class="c1">// Edgeport/4s - software switchable model</span>
<span class="cp">#define ION_DEVICE_ID_EDGEPORT_8S		0x043	</span><span class="c1">// Edgeport/8s - software switchable model</span></pre></div></td></tr>


<tr id="section-15"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-15">&#182;</a></div><p>Usb to Ethernet dongle</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define ION_DEVICE_ID_EDGEPORT_E		0x0E0	</span><span class="c1">// Edgeport/E Usb to Ethernet</span></pre></div></td></tr>


<tr id="section-16"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-16">&#182;</a></div><p>Edgeport TI based devices</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define ION_DEVICE_ID_TI_EDGEPORT_4		0x0201	</span><span class="c1">// Edgeport/4 RS232</span>
<span class="cp">#define ION_DEVICE_ID_TI_EDGEPORT_2		0x0205	</span><span class="c1">// Edgeport/2 RS232</span>
<span class="cp">#define ION_DEVICE_ID_TI_EDGEPORT_4I		0x0206	</span><span class="c1">// Edgeport/4i RS422</span>
<span class="cp">#define ION_DEVICE_ID_TI_EDGEPORT_2I		0x0207	</span><span class="c1">// Edgeport/2i RS422/RS485</span>
<span class="cp">#define ION_DEVICE_ID_TI_EDGEPORT_421		0x020C	</span><span class="c1">// Edgeport/421 4 hub 2 RS232 + Parallel (lucent on a different hub port)</span>
<span class="cp">#define ION_DEVICE_ID_TI_EDGEPORT_21		0x020D	</span><span class="c1">// Edgeport/21 2 RS232 + Parallel (lucent on a different hub port)</span>
<span class="cp">#define ION_DEVICE_ID_TI_EDGEPORT_416		0x0212  </span><span class="c1">// Edgeport/416</span>
<span class="cp">#define ION_DEVICE_ID_TI_EDGEPORT_1		0x0215	</span><span class="c1">// Edgeport/1 RS232</span>
<span class="cp">#define ION_DEVICE_ID_TI_EDGEPORT_42		0x0217	</span><span class="c1">// Edgeport/42 4 hub 2 RS232</span>
<span class="cp">#define ION_DEVICE_ID_TI_EDGEPORT_22I		0x021A	</span><span class="c1">// Edgeport/22I is an Edgeport/4 with ports 1&amp;2 RS422 and ports 3&amp;4 RS232</span>
<span class="cp">#define ION_DEVICE_ID_TI_EDGEPORT_2C		0x021B	</span><span class="c1">// Edgeport/2c RS232</span>
<span class="cp">#define ION_DEVICE_ID_TI_EDGEPORT_221C		0x021C	</span><span class="c1">// Edgeport/221c is a TI based Edgeport/2 with lucent chip and</span></pre></div></td></tr>


<tr id="section-17"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-17">&#182;</a></div><p>2 external hub ports - Large I2C</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define ION_DEVICE_ID_TI_EDGEPORT_22C		0x021D	</span><span class="c1">// Edgeport/22c is a TI based Edgeport/2 with</span></pre></div></td></tr>


<tr id="section-18"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-18">&#182;</a></div><p>2 external hub ports - Large I2C</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define ION_DEVICE_ID_TI_EDGEPORT_21C		0x021E	</span><span class="c1">// Edgeport/21c is a TI based Edgeport/2 with lucent chip</span></pre></div></td></tr>


<tr id="section-19"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-19">&#182;</a></div><p>Generation 3 devices -- 3410 based edgport/1 (256 byte I2C)</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define ION_DEVICE_ID_TI_TI3410_EDGEPORT_1	0x0240	</span><span class="c1">// Edgeport/1 RS232</span>
<span class="cp">#define ION_DEVICE_ID_TI_TI3410_EDGEPORT_1I	0x0241	</span><span class="c1">// Edgeport/1i- RS422 model</span></pre></div></td></tr>


<tr id="section-20"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-20">&#182;</a></div><p>Ti based software switchable RS232/RS422/RS485 devices</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define ION_DEVICE_ID_TI_EDGEPORT_4S		0x0242	</span><span class="c1">// Edgeport/4s - software switchable model</span>
<span class="cp">#define ION_DEVICE_ID_TI_EDGEPORT_8S		0x0243	</span><span class="c1">// Edgeport/8s - software switchable model</span>
<span class="cp">#define ION_DEVICE_ID_TI_EDGEPORT_8		0x0244	</span><span class="c1">// Edgeport/8 (single-CPU)</span>
<span class="cp">#define ION_DEVICE_ID_TI_EDGEPORT_416B		0x0247	</span><span class="c1">// Edgeport/416</span>


<span class="cm">/************************************************************************</span>
<span class="cm"> *</span>
<span class="cm"> *                        Generation 4 devices</span>
<span class="cm"> *</span>
<span class="cm"> ************************************************************************/</span></pre></div></td></tr>


<tr id="section-21"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-21">&#182;</a></div><p>Watchport based on 3410 both 1-wire and binary products (16K I2C)</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define ION_DEVICE_ID_WP_UNSERIALIZED		0x300	</span><span class="c1">// Watchport based on 3410 both 1-wire and binary products</span>
<span class="cp">#define ION_DEVICE_ID_WP_PROXIMITY		0x301	</span><span class="c1">// Watchport/P Discontinued</span>
<span class="cp">#define ION_DEVICE_ID_WP_MOTION			0x302	</span><span class="c1">// Watchport/M</span>
<span class="cp">#define ION_DEVICE_ID_WP_MOISTURE		0x303	</span><span class="c1">// Watchport/W</span>
<span class="cp">#define ION_DEVICE_ID_WP_TEMPERATURE		0x304	</span><span class="c1">// Watchport/T</span>
<span class="cp">#define ION_DEVICE_ID_WP_HUMIDITY		0x305	</span><span class="c1">// Watchport/H</span>

<span class="cp">#define ION_DEVICE_ID_WP_POWER			0x306	</span><span class="c1">// Watchport</span>
<span class="cp">#define ION_DEVICE_ID_WP_LIGHT			0x307	</span><span class="c1">// Watchport</span>
<span class="cp">#define ION_DEVICE_ID_WP_RADIATION		0x308	</span><span class="c1">// Watchport</span>
<span class="cp">#define ION_DEVICE_ID_WP_ACCELERATION		0x309	</span><span class="c1">// Watchport/A</span>
<span class="cp">#define ION_DEVICE_ID_WP_DISTANCE		0x30A	</span><span class="c1">// Watchport/D Discontinued</span>
<span class="cp">#define ION_DEVICE_ID_WP_PROX_DIST		0x30B	</span><span class="c1">// Watchport/D uses distance sensor</span></pre></div></td></tr>


<tr id="section-22"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-22">&#182;</a></div><p>Default to /P function</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define ION_DEVICE_ID_PLUS_PWR_HP4CD		0x30C	</span><span class="c1">// 5052 Plus Power HubPort/4CD+ (for Dell)</span>
<span class="cp">#define ION_DEVICE_ID_PLUS_PWR_HP4C		0x30D	</span><span class="c1">// 5052 Plus Power HubPort/4C+</span>
<span class="cp">#define ION_DEVICE_ID_PLUS_PWR_PCI		0x30E	</span><span class="c1">// 3410 Plus Power PCI Host Controller 4 port</span></pre></div></td></tr>


<tr id="section-23"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-23">&#182;</a></div><p>Definitions for AXIOHM USB product IDs</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define	USB_VENDOR_ID_AXIOHM			0x05D9	</span><span class="c1">// Axiohm VID</span>

<span class="cp">#define AXIOHM_DEVICE_ID_MASK			0xffff</span>
<span class="cp">#define AXIOHM_DEVICE_ID_EPIC_A758		0xA758</span>
<span class="cp">#define AXIOHM_DEVICE_ID_EPIC_A794		0xA794</span>
<span class="cp">#define AXIOHM_DEVICE_ID_EPIC_A225		0xA225</span></pre></div></td></tr>


<tr id="section-24"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-24">&#182;</a></div><p>Definitions for NCR USB product IDs</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define	USB_VENDOR_ID_NCR			0x0404	</span><span class="c1">// NCR VID</span>

<span class="cp">#define NCR_DEVICE_ID_MASK			0xffff</span>
<span class="cp">#define NCR_DEVICE_ID_EPIC_0202			0x0202</span>
<span class="cp">#define NCR_DEVICE_ID_EPIC_0203			0x0203</span>
<span class="cp">#define NCR_DEVICE_ID_EPIC_0310			0x0310</span>
<span class="cp">#define NCR_DEVICE_ID_EPIC_0311			0x0311</span>
<span class="cp">#define NCR_DEVICE_ID_EPIC_0312			0x0312</span></pre></div></td></tr>


<tr id="section-25"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-25">&#182;</a></div><p>Definitions for SYMBOL USB product IDs</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define USB_VENDOR_ID_SYMBOL			0x05E0	</span><span class="c1">// Symbol VID</span>
<span class="cp">#define SYMBOL_DEVICE_ID_MASK			0xffff</span>
<span class="cp">#define SYMBOL_DEVICE_ID_KEYFOB			0x0700</span></pre></div></td></tr>


<tr id="section-26"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-26">&#182;</a></div><p>Definitions for other product IDs</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define ION_DEVICE_ID_MT4X56USB			0x1403	</span><span class="c1">// OEM device</span>


<span class="cp">#define	GENERATION_ID_FROM_USB_PRODUCT_ID(ProductId)				\</span>
<span class="cp">			((__u16) ((ProductId &gt;&gt; 8) &amp; (ION_GENERATION_MASK)))</span>

<span class="cp">#define	MAKE_USB_PRODUCT_ID(OemId, DeviceId)					\</span>
<span class="cp">			((__u16) (((OemId) &lt;&lt; 10) || (DeviceId)))</span>

<span class="cp">#define	DEVICE_ID_FROM_USB_PRODUCT_ID(ProductId)				\</span>
<span class="cp">			((__u16) ((ProductId) &amp; (EDGEPORT_DEVICE_ID_MASK)))</span>

<span class="cp">#define	OEM_ID_FROM_USB_PRODUCT_ID(ProductId)					\</span>
<span class="cp">			((__u16) (((ProductId) &gt;&gt; 10) &amp; 0x3F))</span></pre></div></td></tr>


<tr id="section-27"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-27">&#182;</a></div><p>Definitions of parameters for download code. Note that these are
specific to a given version of download code and must change if the
corresponding download code changes.</p></td><td class="code"><div class="highlight"><pre></pre></div></td></tr>


<tr id="section-28"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-28">&#182;</a></div><p>TxCredits value below which driver won't bother sending (to prevent too many small writes).
Send only if above 25%</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define EDGE_FW_GET_TX_CREDITS_SEND_THRESHOLD(InitialCredit, MaxPacketSize) (max(((InitialCredit) / 4), (MaxPacketSize)))</span>

<span class="cp">#define	EDGE_FW_BULK_MAX_PACKET_SIZE		64	</span><span class="c1">// Max Packet Size for Bulk In Endpoint (EP1)</span>
<span class="cp">#define EDGE_FW_BULK_READ_BUFFER_SIZE		1024	</span><span class="c1">// Size to use for Bulk reads</span>

<span class="cp">#define	EDGE_FW_INT_MAX_PACKET_SIZE		32	</span><span class="c1">// Max Packet Size for Interrupt In Endpoint</span></pre></div></td></tr>


<tr id="section-29"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-29">&#182;</a></div><p>Note that many units were shipped with MPS=16, we
force an upgrade to this value).</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define EDGE_FW_INT_INTERVAL			2	</span><span class="c1">// 2ms polling on IntPipe</span></pre></div></td></tr>


<tr id="section-30"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-30">&#182;</a></div><p>Definitions of I/O Networks vendor-specific requests
for default endpoint</p>

<p>bmRequestType = 01000000    Set vendor-specific, to device
bmRequestType = 11000000    Get vendor-specific, to device</p>

<p>These are the definitions for the bRequest field for the
above bmRequestTypes.</p>

<p>For the read/write Edgeport memory commands, the parameters
are as follows:
    wValue = 16-bit address
    wIndex = unused (though we could put segment 00: or FF: here)
    wLength = # bytes to read/write (max 64)</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define USB_REQUEST_ION_RESET_DEVICE	0	</span><span class="c1">// Warm reboot Edgeport, retaining USB address</span>
<span class="cp">#define USB_REQUEST_ION_GET_EPIC_DESC	1	</span><span class="c1">// Get Edgeport Compatibility Descriptor</span></pre></div></td></tr>


<tr id="section-31"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-31">&#182;</a></div><p>unused                2   // Unused, available</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define USB_REQUEST_ION_READ_RAM	3	</span><span class="c1">// Read  EdgePort RAM at specified addr</span>
<span class="cp">#define USB_REQUEST_ION_WRITE_RAM	4	</span><span class="c1">// Write EdgePort RAM at specified addr</span>
<span class="cp">#define USB_REQUEST_ION_READ_ROM	5	</span><span class="c1">// Read  EdgePort ROM at specified addr</span>
<span class="cp">#define USB_REQUEST_ION_WRITE_ROM	6	</span><span class="c1">// Write EdgePort ROM at specified addr</span>
<span class="cp">#define USB_REQUEST_ION_EXEC_DL_CODE	7	</span><span class="c1">// Begin execution of RAM-based download</span></pre></div></td></tr>


<tr id="section-32"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-32">&#182;</a></div><p>code by jumping to address in wIndex:wValue
                8   // Unused, available</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define USB_REQUEST_ION_ENABLE_SUSPEND	9	</span><span class="c1">// Enable/Disable suspend feature</span></pre></div></td></tr>


<tr id="section-33"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-33">&#182;</a></div><p>(wValue != 0: Enable; wValue = 0: Disable)</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define USB_REQUEST_ION_SEND_IOSP	10	</span><span class="c1">// Send an IOSP command to the edgeport over the control pipe</span>
<span class="cp">#define USB_REQUEST_ION_RECV_IOSP	11	</span><span class="c1">// Receive an IOSP command from the edgeport over the control pipe</span>


<span class="cp">#define USB_REQUEST_ION_DIS_INT_TIMER	0x80	</span><span class="c1">// Sent to Axiohm to enable/ disable</span></pre></div></td></tr>


<tr id="section-34"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-34">&#182;</a></div><p>interrupt token timer
wValue = 1, enable (default)
wValue = 0, disable</p></td><td class="code"><div class="highlight"><pre></pre></div></td></tr>


<tr id="section-35"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-35">&#182;</a></div><p>Define parameter values for our vendor-specific commands</p></td><td class="code"><div class="highlight"><pre></pre></div></td></tr>


<tr id="section-36"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-36">&#182;</a></div><p>Edgeport Compatibility Descriptor</p>

<p>This descriptor is only returned by Edgeport-compatible devices
supporting the EPiC spec. True ION devices do not return this
descriptor, but instead return STALL on receipt of the
GET<em>EPIC</em>DESC command. The driver interprets a STALL to mean that
this is a "real" Edgeport.</p></td><td class="code"><div class="highlight"><pre><span class="k">struct</span> <span class="n">edge_compatibility_bits</span> <span class="p">{</span></pre></div></td></tr>


<tr id="section-37"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-37">&#182;</a></div><p>This __u32 defines which Vendor-specific commands/functionality
the device supports on the default EP0 pipe.</p></td><td class="code"><div class="highlight"><pre>	<span class="n">__u32</span>	<span class="n">VendEnableSuspend</span>	<span class="o">:</span>  <span class="mi">1</span><span class="p">;</span>	<span class="c1">// 0001 Set if device supports ION_ENABLE_SUSPEND</span>
	<span class="n">__u32</span>	<span class="n">VendUnused</span>		<span class="o">:</span> <span class="mi">31</span><span class="p">;</span>	<span class="c1">// Available for future expansion, must be 0</span></pre></div></td></tr>


<tr id="section-38"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-38">&#182;</a></div><p>This __u32 defines which IOSP commands are supported over the
bulk pipe EP1.</p></td><td class="code"><div class="highlight"><pre></pre></div></td></tr>


<tr id="section-39"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-39">&#182;</a></div><p>xxxx Set if device supports:</p></td><td class="code"><div class="highlight"><pre>	<span class="n">__u32</span>	<span class="n">IOSPOpen</span>		<span class="o">:</span>  <span class="mi">1</span><span class="p">;</span>	<span class="c1">// 0001	OPEN / OPEN_RSP (Currently must be 1)</span>
	<span class="n">__u32</span>	<span class="n">IOSPClose</span>		<span class="o">:</span>  <span class="mi">1</span><span class="p">;</span>	<span class="c1">// 0002	CLOSE</span>
	<span class="n">__u32</span>	<span class="n">IOSPChase</span>		<span class="o">:</span>  <span class="mi">1</span><span class="p">;</span>	<span class="c1">// 0004	CHASE / CHASE_RSP</span>
	<span class="n">__u32</span>	<span class="n">IOSPSetRxFlow</span>		<span class="o">:</span>  <span class="mi">1</span><span class="p">;</span>	<span class="c1">// 0008	SET_RX_FLOW</span>
	<span class="n">__u32</span>	<span class="n">IOSPSetTxFlow</span>		<span class="o">:</span>  <span class="mi">1</span><span class="p">;</span>	<span class="c1">// 0010	SET_TX_FLOW</span>
	<span class="n">__u32</span>	<span class="n">IOSPSetXChar</span>		<span class="o">:</span>  <span class="mi">1</span><span class="p">;</span>	<span class="c1">// 0020	SET_XON_CHAR/SET_XOFF_CHAR</span>
	<span class="n">__u32</span>	<span class="n">IOSPRxCheck</span>		<span class="o">:</span>  <span class="mi">1</span><span class="p">;</span>	<span class="c1">// 0040	RX_CHECK_REQ/RX_CHECK_RSP</span>
	<span class="n">__u32</span>	<span class="n">IOSPSetClrBreak</span>		<span class="o">:</span>  <span class="mi">1</span><span class="p">;</span>	<span class="c1">// 0080	SET_BREAK/CLEAR_BREAK</span>
	<span class="n">__u32</span>	<span class="n">IOSPWriteMCR</span>		<span class="o">:</span>  <span class="mi">1</span><span class="p">;</span>	<span class="c1">// 0100	MCR register writes (set/clr DTR/RTS)</span>
	<span class="n">__u32</span>	<span class="n">IOSPWriteLCR</span>		<span class="o">:</span>  <span class="mi">1</span><span class="p">;</span>	<span class="c1">// 0200	LCR register writes (wordlen/stop/parity)</span>
	<span class="n">__u32</span>	<span class="n">IOSPSetBaudRate</span>		<span class="o">:</span>  <span class="mi">1</span><span class="p">;</span>	<span class="c1">// 0400	setting Baud rate (writes to LCR.80h and DLL/DLM register)</span>
	<span class="n">__u32</span>	<span class="n">IOSPDisableIntPipe</span>	<span class="o">:</span>  <span class="mi">1</span><span class="p">;</span>	<span class="c1">// 0800 Do not use the interrupt pipe for TxCredits or RxButesAvailable</span>
	<span class="n">__u32</span>	<span class="n">IOSPRxDataAvail</span>		<span class="o">:</span>  <span class="mi">1</span><span class="p">;</span>   <span class="c1">// 1000 Return status of RX Fifo (Data available in Fifo)</span>
	<span class="n">__u32</span>	<span class="n">IOSPTxPurge</span>		<span class="o">:</span>  <span class="mi">1</span><span class="p">;</span>	<span class="c1">// 2000 Purge TXBuffer and/or Fifo in Edgeport hardware</span>
	<span class="n">__u32</span>	<span class="n">IOSPUnused</span>		<span class="o">:</span> <span class="mi">18</span><span class="p">;</span>	<span class="c1">// Available for future expansion, must be 0</span></pre></div></td></tr>


<tr id="section-40"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-40">&#182;</a></div><p>This __u32 defines which 'general' features are supported</p></td><td class="code"><div class="highlight"><pre>	<span class="n">__u32</span>	<span class="n">TrueEdgeport</span>		<span class="o">:</span>  <span class="mi">1</span><span class="p">;</span>	<span class="c1">// 0001	Set if device is a &#39;real&#39; Edgeport</span></pre></div></td></tr>


<tr id="section-41"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-41">&#182;</a></div><p>(Used only by driver, NEVER set by an EPiC device)</p></td><td class="code"><div class="highlight"><pre>	<span class="n">__u32</span>	<span class="n">GenUnused</span>		<span class="o">:</span> <span class="mi">31</span><span class="p">;</span>	<span class="c1">// Available for future expansion, must be 0</span>
<span class="p">};</span>

<span class="cp">#define EDGE_COMPATIBILITY_MASK0	0x0001</span>
<span class="cp">#define EDGE_COMPATIBILITY_MASK1	0x3FFF</span>
<span class="cp">#define EDGE_COMPATIBILITY_MASK2	0x0001</span>

<span class="k">struct</span> <span class="n">edge_compatibility_descriptor</span> <span class="p">{</span>
	<span class="n">__u8</span>	<span class="n">Length</span><span class="p">;</span>				<span class="c1">// Descriptor Length (per USB spec)</span>
	<span class="n">__u8</span>	<span class="n">DescType</span><span class="p">;</span>			<span class="c1">// Descriptor Type (per USB spec, =DEVICE type)</span>
	<span class="n">__u8</span>	<span class="n">EpicVer</span><span class="p">;</span>			<span class="c1">// Version of EPiC spec supported</span></pre></div></td></tr>


<tr id="section-42"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-42">&#182;</a></div><p>(Currently must be 1)</p></td><td class="code"><div class="highlight"><pre>	<span class="n">__u8</span>	<span class="n">NumPorts</span><span class="p">;</span>			<span class="c1">// Number of serial ports supported</span>
	<span class="n">__u8</span>	<span class="n">iDownloadFile</span><span class="p">;</span>			<span class="c1">// Index of string containing download code filename</span></pre></div></td></tr>


<tr id="section-43"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-43">&#182;</a></div><p>0=no download, FF=download compiled into driver.</p></td><td class="code"><div class="highlight"><pre>	<span class="n">__u8</span>	<span class="n">Unused</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>			<span class="c1">// Available for future expansion, must be 0</span></pre></div></td></tr>


<tr id="section-44"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-44">&#182;</a></div><p>(Currently must be 0).</p></td><td class="code"><div class="highlight"><pre>	<span class="n">__u8</span>	<span class="n">MajorVersion</span><span class="p">;</span>			<span class="c1">// Firmware version: xx.</span>
	<span class="n">__u8</span>	<span class="n">MinorVersion</span><span class="p">;</span>			<span class="c1">//  yy.</span>
	<span class="n">__le16</span>	<span class="n">BuildNumber</span><span class="p">;</span>			<span class="c1">//  zzzz (LE format)</span></pre></div></td></tr>


<tr id="section-45"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-45">&#182;</a></div><p>The following structure contains __u32s, with each bit
specifying whether the EPiC device supports the given
command or functionality.</p></td><td class="code"><div class="highlight"><pre>	<span class="k">struct</span> <span class="n">edge_compatibility_bits</span>	<span class="n">Supports</span><span class="p">;</span>
<span class="p">};</span></pre></div></td></tr>


<tr id="section-46"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-46">&#182;</a></div><p>Values for iDownloadFile</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define	EDGE_DOWNLOAD_FILE_NONE		0	</span><span class="c1">// No download requested</span>
<span class="cp">#define	EDGE_DOWNLOAD_FILE_INTERNAL	0xFF	</span><span class="c1">// Download the file compiled into driver (930 version)</span>
<span class="cp">#define	EDGE_DOWNLOAD_FILE_I930		0xFF	</span><span class="c1">// Download the file compiled into driver (930 version)</span>
<span class="cp">#define	EDGE_DOWNLOAD_FILE_80251	0xFE	</span><span class="c1">// Download the file compiled into driver (80251 version)</span>



<span class="cm">/*</span>
<span class="cm"> *	Special addresses for READ/WRITE_RAM/ROM</span>
<span class="cm"> */</span></pre></div></td></tr>


<tr id="section-47"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-47">&#182;</a></div><p>Version 1 (original) format of DeviceParams</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define	EDGE_MANUF_DESC_ADDR_V1		0x00FF7F00</span>
<span class="cp">#define	EDGE_MANUF_DESC_LEN_V1		sizeof(EDGE_MANUF_DESCRIPTOR_V1)</span></pre></div></td></tr>


<tr id="section-48"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-48">&#182;</a></div><p>Version 2 format of DeviceParams. This format is longer (3C0h)
and starts lower in memory, at the uppermost 1K in ROM.</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define	EDGE_MANUF_DESC_ADDR		0x00FF7C00</span>
<span class="cp">#define	EDGE_MANUF_DESC_LEN		sizeof(struct edge_manuf_descriptor)</span></pre></div></td></tr>


<tr id="section-49"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-49">&#182;</a></div><p>Boot params descriptor</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define	EDGE_BOOT_DESC_ADDR		0x00FF7FC0</span>
<span class="cp">#define	EDGE_BOOT_DESC_LEN		sizeof(struct edge_boot_descriptor)</span></pre></div></td></tr>


<tr id="section-50"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-50">&#182;</a></div><p>Define the max block size that may be read or written
in a read/write RAM/ROM command.</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define	MAX_SIZE_REQ_ION_READ_MEM	((__u16)64)</span>
<span class="cp">#define	MAX_SIZE_REQ_ION_WRITE_MEM	((__u16)64)</span></pre></div></td></tr>


<tr id="section-51"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-51">&#182;</a></div><p>Notes for the following two ION vendor-specific param descriptors:</p>

<ol>
<li>These have a standard USB descriptor header so they look like a
normal descriptor.</li>
<li>Any strings in the structures are in USB-defined string
descriptor format, so that they may be separately retrieved,
if necessary, with a minimum of work on the 930. This also
requires them to be in UNICODE format, which, for English at
least, simply means extending each <em>_u8 into a _</em>u16.</li>
<li>For all fields, 00 means 'uninitialized'.</li>
<li>All unused areas should be set to 00 for future expansion.</li>
</ol></td><td class="code"><div class="highlight"><pre></pre></div></td></tr>


<tr id="section-52"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-52">&#182;</a></div><p>This structure is ver 2 format. It contains ALL USB descriptors as
well as the configuration parameters that were in the original V1
structure. It is NOT modified when new boot code is downloaded; rather,
these values are set or modified by manufacturing. It is located at
xC00-xFBF (length 3C0h) in the ROM.
This structure is a superset of the v1 structure and is arranged so
that all of the v1 fields remain at the same address. We are just
adding more room to the front of the structure to hold the descriptors.</p>

<p>The actual contents of this structure are defined in a 930 assembly
file, converted to a binary image, and then written by the serialization
program. The C definition of this structure just defines a dummy
area for general USB descriptors and the descriptor tables (the root
descriptor starts at xC00). At the bottom of the structure are the
fields inherited from the v1 structure.</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define MAX_SERIALNUMBER_LEN	12</span>
<span class="cp">#define MAX_ASSEMBLYNUMBER_LEN	14</span>

<span class="k">struct</span> <span class="n">edge_manuf_descriptor</span> <span class="p">{</span>

	<span class="n">__u16</span>	<span class="n">RootDescTable</span><span class="p">[</span><span class="mh">0x10</span><span class="p">];</span>			<span class="c1">// C00 Root of descriptor tables (just a placeholder)</span>
	<span class="n">__u8</span>	<span class="n">DescriptorArea</span><span class="p">[</span><span class="mh">0x2E0</span><span class="p">];</span>			<span class="c1">// C20 Descriptors go here, up to 2E0h (just a placeholder)</span></pre></div></td></tr>


<tr id="section-53"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-53">&#182;</a></div><pre><code>Start of v1-compatible section
</code></pre></td><td class="code"><div class="highlight"><pre>	<span class="n">__u8</span>	<span class="n">Length</span><span class="p">;</span>					<span class="c1">// F00 Desc length for what follows, per USB (= C0h )</span>
	<span class="n">__u8</span>	<span class="n">DescType</span><span class="p">;</span>				<span class="c1">// F01 Desc type, per USB (=DEVICE type)</span>
	<span class="n">__u8</span>	<span class="n">DescVer</span><span class="p">;</span>				<span class="c1">// F02 Desc version/format (currently 2)</span>
	<span class="n">__u8</span>	<span class="n">NumRootDescEntries</span><span class="p">;</span>			<span class="c1">// F03 # entries in RootDescTable</span>

	<span class="n">__u8</span>	<span class="n">RomSize</span><span class="p">;</span>				<span class="c1">// F04 Size of ROM/E2PROM in K</span>
	<span class="n">__u8</span>	<span class="n">RamSize</span><span class="p">;</span>				<span class="c1">// F05 Size of external RAM in K</span>
	<span class="n">__u8</span>	<span class="n">CpuRev</span><span class="p">;</span>					<span class="c1">// F06 CPU revision level (chg only if s/w visible)</span>
	<span class="n">__u8</span>	<span class="n">BoardRev</span><span class="p">;</span>				<span class="c1">// F07 PCB revision level (chg only if s/w visible)</span>

	<span class="n">__u8</span>	<span class="n">NumPorts</span><span class="p">;</span>				<span class="c1">// F08 Number of ports</span>
	<span class="n">__u8</span>	<span class="n">DescDate</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>				<span class="c1">// F09 MM/DD/YY when descriptor template was compiler,</span></pre></div></td></tr>


<tr id="section-54"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-54">&#182;</a></div><pre><code>so host can track changes to USB-only descriptors.
</code></pre></td><td class="code"><div class="highlight"><pre>	<span class="n">__u8</span>	<span class="n">SerNumLength</span><span class="p">;</span>				<span class="c1">// F0C USB string descriptor len</span>
	<span class="n">__u8</span>	<span class="n">SerNumDescType</span><span class="p">;</span>				<span class="c1">// F0D USB descriptor type (=STRING type)</span>
	<span class="n">__le16</span>	<span class="n">SerialNumber</span><span class="p">[</span><span class="n">MAX_SERIALNUMBER_LEN</span><span class="p">];</span>	<span class="c1">// F0E &quot;01-01-000100&quot; Unicode Serial Number</span>

	<span class="n">__u8</span>	<span class="n">AssemblyNumLength</span><span class="p">;</span>			<span class="c1">// F26 USB string descriptor len</span>
	<span class="n">__u8</span>	<span class="n">AssemblyNumDescType</span><span class="p">;</span>			<span class="c1">// F27 USB descriptor type (=STRING type)</span>
	<span class="n">__le16</span>	<span class="n">AssemblyNumber</span><span class="p">[</span><span class="n">MAX_ASSEMBLYNUMBER_LEN</span><span class="p">];</span>	<span class="c1">// F28 &quot;350-1000-01-A &quot; assembly number</span>

	<span class="n">__u8</span>	<span class="n">OemAssyNumLength</span><span class="p">;</span>			<span class="c1">// F44 USB string descriptor len</span>
	<span class="n">__u8</span>	<span class="n">OemAssyNumDescType</span><span class="p">;</span>			<span class="c1">// F45 USB descriptor type (=STRING type)</span>
	<span class="n">__le16</span>	<span class="n">OemAssyNumber</span><span class="p">[</span><span class="n">MAX_ASSEMBLYNUMBER_LEN</span><span class="p">];</span>	<span class="c1">// F46 &quot;xxxxxxxxxxxxxx&quot; OEM assembly number</span>

	<span class="n">__u8</span>	<span class="n">ManufDateLength</span><span class="p">;</span>			<span class="c1">// F62 USB string descriptor len</span>
	<span class="n">__u8</span>	<span class="n">ManufDateDescType</span><span class="p">;</span>			<span class="c1">// F63 USB descriptor type (=STRING type)</span>
	<span class="n">__le16</span>	<span class="n">ManufDate</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>				<span class="c1">// F64 &quot;MMDDYY&quot; manufacturing date</span>

	<span class="n">__u8</span>	<span class="n">Reserved3</span><span class="p">[</span><span class="mh">0x4D</span><span class="p">];</span>			<span class="c1">// F70 -- unused, set to 0 --</span>

	<span class="n">__u8</span>	<span class="n">UartType</span><span class="p">;</span>				<span class="c1">// FBD Uart Type</span>
	<span class="n">__u8</span>	<span class="n">IonPid</span><span class="p">;</span>					<span class="c1">// FBE Product ID, == LSB of USB DevDesc.PID</span></pre></div></td></tr>


<tr id="section-55"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-55">&#182;</a></div><pre><code> (Note: Edgeport/4s before 11/98 will have
  00 here instead of 01)
</code></pre></td><td class="code"><div class="highlight"><pre>	<span class="n">__u8</span>	<span class="n">IonConfig</span><span class="p">;</span>				<span class="c1">// FBF Config byte for ION manufacturing use</span></pre></div></td></tr>


<tr id="section-56"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-56">&#182;</a></div><p>FBF end of structure, total len = 3C0h</p></td><td class="code"><div class="highlight"><pre><span class="p">};</span>


<span class="cp">#define MANUF_DESC_VER_1	1	</span><span class="c1">// Original definition of MANUF_DESC</span>
<span class="cp">#define MANUF_DESC_VER_2	2	</span><span class="c1">// Ver 2, starts at xC00h len 3C0h</span></pre></div></td></tr>


<tr id="section-57"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-57">&#182;</a></div><p>Uart Types
Note: Since this field was added only recently, all Edgeport/4 units
shipped before 11/98 will have 00 in this field. Therefore,
both 00 and 01 values mean '654.</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define MANUF_UART_EXAR_654_EARLY	0	</span><span class="c1">// Exar 16C654 in Edgeport/4s before 11/98</span>
<span class="cp">#define MANUF_UART_EXAR_654		1	</span><span class="c1">// Exar 16C654</span>
<span class="cp">#define MANUF_UART_EXAR_2852		2	</span><span class="c1">// Exar 16C2852</span></pre></div></td></tr>


<tr id="section-58"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-58">&#182;</a></div><p>Note: The CpuRev and BoardRev values do not conform to manufacturing
revisions; they are to be incremented only when the CPU or hardware
changes in a software-visible way, such that the 930 software or
the host driver needs to handle the hardware differently.</p></td><td class="code"><div class="highlight"><pre></pre></div></td></tr>


<tr id="section-59"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-59">&#182;</a></div><p>Values of bottom 5 bits of CpuRev &amp; BoardRev for
Implementation 0 (ie, 930-based)</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define	MANUF_CPU_REV_AD4		1	</span><span class="c1">// 930 AD4, with EP1 Rx bug (needs RXSPM)</span>
<span class="cp">#define	MANUF_CPU_REV_AD5		2	</span><span class="c1">// 930 AD5, with above bug (supposedly) fixed</span>
<span class="cp">#define	MANUF_CPU_80251			0x20	</span><span class="c1">// Intel 80251</span>


<span class="cp">#define MANUF_BOARD_REV_A		1	</span><span class="c1">// Original version, == Manuf Rev A</span>
<span class="cp">#define MANUF_BOARD_REV_B		2	</span><span class="c1">// Manuf Rev B, wakeup interrupt works</span>
<span class="cp">#define MANUF_BOARD_REV_C		3	</span><span class="c1">// Manuf Rev C, 2/4 ports, rs232/rs422</span>
<span class="cp">#define MANUF_BOARD_REV_GENERATION_2	0x20	</span><span class="c1">// Second generaiton edgeport</span></pre></div></td></tr>


<tr id="section-60"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-60">&#182;</a></div><p>Values of bottom 5 bits of CpuRev &amp; BoardRev for
Implementation 1 (ie, 251+Netchip-based)</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define	MANUF_CPU_REV_1			1	</span><span class="c1">// C251TB Rev 1 (Need actual Intel rev here)</span>

<span class="cp">#define MANUF_BOARD_REV_A		1	</span><span class="c1">// First rev of 251+Netchip design</span>

<span class="cp">#define	MANUF_SERNUM_LENGTH		sizeof(((struct edge_manuf_descriptor *)0)-&gt;SerialNumber)</span>
<span class="cp">#define	MANUF_ASSYNUM_LENGTH		sizeof(((struct edge_manuf_descriptor *)0)-&gt;AssemblyNumber)</span>
<span class="cp">#define	MANUF_OEMASSYNUM_LENGTH		sizeof(((struct edge_manuf_descriptor *)0)-&gt;OemAssyNumber)</span>
<span class="cp">#define	MANUF_MANUFDATE_LENGTH		sizeof(((struct edge_manuf_descriptor *)0)-&gt;ManufDate)</span>

<span class="cp">#define	MANUF_ION_CONFIG_DIAG_NO_LOOP	0x20	</span><span class="c1">// As below but no ext loopback test</span>
<span class="cp">#define	MANUF_ION_CONFIG_DIAG		0x40	</span><span class="c1">// 930 based device: 1=Run h/w diags, 0=norm</span></pre></div></td></tr>


<tr id="section-61"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-61">&#182;</a></div><p>TIUMP Device    : 1=IONSERIAL needs to run Final Test</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define	MANUF_ION_CONFIG_MASTER		0x80	</span><span class="c1">// 930 based device:  1=Master mode, 0=Normal</span></pre></div></td></tr>


<tr id="section-62"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-62">&#182;</a></div><p>TIUMP Device    :  1=First device on a multi TIUMP Device</p></td><td class="code"><div class="highlight"><pre></pre></div></td></tr>


<tr id="section-63"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-63">&#182;</a></div><p>This structure describes parameters for the boot code, and
is programmed along with new boot code. These are values
which are specific to a given build of the boot code. It
is exactly 64 bytes long and is fixed at address FF:xFC0
- FF:xFFF. Note that the 930-mandated UCONFIG bytes are
included in this structure.</p></td><td class="code"><div class="highlight"><pre><span class="k">struct</span> <span class="n">edge_boot_descriptor</span> <span class="p">{</span>
	<span class="n">__u8</span>		<span class="n">Length</span><span class="p">;</span>			<span class="c1">// C0 Desc length, per USB (= 40h)</span>
	<span class="n">__u8</span>		<span class="n">DescType</span><span class="p">;</span>		<span class="c1">// C1 Desc type, per USB (= DEVICE type)</span>
	<span class="n">__u8</span>		<span class="n">DescVer</span><span class="p">;</span>		<span class="c1">// C2 Desc version/format</span>
	<span class="n">__u8</span>		<span class="n">Reserved1</span><span class="p">;</span>		<span class="c1">// C3 -- unused, set to 0 --</span>

	<span class="n">__le16</span>		<span class="n">BootCodeLength</span><span class="p">;</span>		<span class="c1">// C4 Boot code goes from FF:0000 to FF:(len-1)</span></pre></div></td></tr>


<tr id="section-64"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-64">&#182;</a></div><p>(LE format)</p></td><td class="code"><div class="highlight"><pre>	<span class="n">__u8</span>		<span class="n">MajorVersion</span><span class="p">;</span>		<span class="c1">// C6 Firmware version: xx.</span>
	<span class="n">__u8</span>		<span class="n">MinorVersion</span><span class="p">;</span>		<span class="c1">// C7			yy.</span>
	<span class="n">__le16</span>		<span class="n">BuildNumber</span><span class="p">;</span>		<span class="c1">// C8			zzzz (LE format)</span>

	<span class="n">__u16</span>		<span class="n">EnumRootDescTable</span><span class="p">;</span>	<span class="c1">// CA Root of ROM-based descriptor table</span>
	<span class="n">__u8</span>		<span class="n">NumDescTypes</span><span class="p">;</span>		<span class="c1">// CC Number of supported descriptor types</span>

	<span class="n">__u8</span>		<span class="n">Reserved4</span><span class="p">;</span>		<span class="c1">// CD Fix Compiler Packing</span>

	<span class="n">__le16</span>		<span class="n">Capabilities</span><span class="p">;</span>		<span class="c1">// CE-CF Capabilities flags (LE format)</span>
	<span class="n">__u8</span>		<span class="n">Reserved2</span><span class="p">[</span><span class="mh">0x28</span><span class="p">];</span>	<span class="c1">// D0 -- unused, set to 0 --</span>
	<span class="n">__u8</span>		<span class="n">UConfig0</span><span class="p">;</span>		<span class="c1">// F8 930-defined CPU configuration byte 0</span>
	<span class="n">__u8</span>		<span class="n">UConfig1</span><span class="p">;</span>		<span class="c1">// F9 930-defined CPU configuration byte 1</span>
	<span class="n">__u8</span>		<span class="n">Reserved3</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>		<span class="c1">// FA -- unused, set to 0 --</span></pre></div></td></tr>


<tr id="section-65"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-65">&#182;</a></div><p>FF end of structure, total len = 80</p></td><td class="code"><div class="highlight"><pre><span class="p">};</span>


<span class="cp">#define BOOT_DESC_VER_1		1	</span><span class="c1">// Original definition of BOOT_PARAMS</span>
<span class="cp">#define BOOT_DESC_VER_2		2	</span><span class="c1">// 2nd definition, descriptors not included in boot</span></pre></div></td></tr>


<tr id="section-66"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-66">&#182;</a></div><p>Capabilities flags</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define	BOOT_CAP_RESET_CMD	0x0001	</span><span class="c1">// If set, boot correctly supports ION_RESET_DEVICE</span>


<span class="cm">/************************************************************************</span>
<span class="cm">                 T I   U M P   D E F I N I T I O N S</span>
<span class="cm"> ***********************************************************************/</span></pre></div></td></tr>


<tr id="section-67"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-67">&#182;</a></div><p>Chip definitions in I2C</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define UMP5152			0x52</span>
<span class="cp">#define UMP3410			0x10</span></pre></div></td></tr>


<tr id="section-68"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-68">&#182;</a></div><hr />

<p>TI I2C Format Definitions</p>

<hr /></td><td class="code"><div class="highlight"><pre><span class="cp">#define I2C_DESC_TYPE_INFO_BASIC	0x01</span>
<span class="cp">#define I2C_DESC_TYPE_FIRMWARE_BASIC	0x02</span>
<span class="cp">#define I2C_DESC_TYPE_DEVICE		0x03</span>
<span class="cp">#define I2C_DESC_TYPE_CONFIG		0x04</span>
<span class="cp">#define I2C_DESC_TYPE_STRING		0x05</span>
<span class="cp">#define I2C_DESC_TYPE_FIRMWARE_AUTO	0x07	</span><span class="c1">// for 3410 download</span>
<span class="cp">#define I2C_DESC_TYPE_CONFIG_KLUDGE	0x14	</span><span class="c1">// for 3410</span>
<span class="cp">#define I2C_DESC_TYPE_WATCHPORT_VERSION	0x15	</span><span class="c1">// firmware version number for watchport</span>
<span class="cp">#define I2C_DESC_TYPE_WATCHPORT_CALIBRATION_DATA 0x16	</span><span class="c1">// Watchport Calibration Data</span>

<span class="cp">#define I2C_DESC_TYPE_FIRMWARE_BLANK	0xf2</span></pre></div></td></tr>


<tr id="section-69"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-69">&#182;</a></div><p>Special section defined by ION</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define I2C_DESC_TYPE_ION		0	</span><span class="c1">// Not defined by TI</span>


<span class="k">struct</span> <span class="n">ti_i2c_desc</span> <span class="p">{</span>
	<span class="n">__u8</span>	<span class="n">Type</span><span class="p">;</span>			<span class="c1">// Type of descriptor</span>
	<span class="n">__u16</span>	<span class="n">Size</span><span class="p">;</span>			<span class="c1">// Size of data only not including header</span>
	<span class="n">__u8</span>	<span class="n">CheckSum</span><span class="p">;</span>		<span class="c1">// Checksum (8 bit sum of data only)</span>
	<span class="n">__u8</span>	<span class="n">Data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>		<span class="c1">// Data starts here</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span></pre></div></td></tr>


<tr id="section-70"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-70">&#182;</a></div><p>for 5152 devices only (type 2 record)
for 3410 the version is stored in the WATCHPORT<em>FIRMWARE</em>VERSION descriptor</p></td><td class="code"><div class="highlight"><pre><span class="k">struct</span> <span class="n">ti_i2c_firmware_rec</span> <span class="p">{</span>
	<span class="n">__u8</span>	<span class="n">Ver_Major</span><span class="p">;</span>		<span class="c1">// Firmware Major version number</span>
	<span class="n">__u8</span>	<span class="n">Ver_Minor</span><span class="p">;</span>		<span class="c1">// Firmware Minor version number</span>
	<span class="n">__u8</span>	<span class="n">Data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>		<span class="c1">// Download starts here</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>


<span class="k">struct</span> <span class="n">watchport_firmware_version</span> <span class="p">{</span></pre></div></td></tr>


<tr id="section-71"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-71">&#182;</a></div><p>Added 2 bytes for version number</p></td><td class="code"><div class="highlight"><pre>	<span class="n">__u8</span>	<span class="n">Version_Major</span><span class="p">;</span>		<span class="c1">//  Download Version (for Watchport)</span>
	<span class="n">__u8</span>	<span class="n">Version_Minor</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span></pre></div></td></tr>


<tr id="section-72"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-72">&#182;</a></div><p>Structure of header of download image in fw_down.h</p></td><td class="code"><div class="highlight"><pre><span class="k">struct</span> <span class="n">ti_i2c_image_header</span> <span class="p">{</span>
	<span class="n">__le16</span>	<span class="n">Length</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">CheckSum</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">ti_basic_descriptor</span> <span class="p">{</span>
	<span class="n">__u8</span>	<span class="n">Power</span><span class="p">;</span>		<span class="c1">// Self powered</span></pre></div></td></tr>


<tr id="section-73"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-73">&#182;</a></div><p>bit 7: 1 - power switching supported
       0 - power switching not supported</p>

<p>bit 0: 1 - self powered
       0 - bus powered</p></td><td class="code"><div class="highlight"><pre>	<span class="n">__u16</span>	<span class="n">HubVid</span><span class="p">;</span>		<span class="c1">// VID HUB</span>
	<span class="n">__u16</span>	<span class="n">HubPid</span><span class="p">;</span>		<span class="c1">// PID HUB</span>
	<span class="n">__u16</span>	<span class="n">DevPid</span><span class="p">;</span>		<span class="c1">// PID Edgeport</span>
	<span class="n">__u8</span>	<span class="n">HubTime</span><span class="p">;</span>	<span class="c1">// Time for power on to power good</span>
	<span class="n">__u8</span>	<span class="n">HubCurrent</span><span class="p">;</span>	<span class="c1">// HUB Current = 100ma</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span></pre></div></td></tr>


<tr id="section-74"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-74">&#182;</a></div><p>CPU / Board Rev Definitions</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define TI_CPU_REV_5052			2	</span><span class="c1">// 5052 based edgeports</span>
<span class="cp">#define TI_CPU_REV_3410			3	</span><span class="c1">// 3410 based edgeports</span>

<span class="cp">#define TI_BOARD_REV_TI_EP		0	</span><span class="c1">// Basic ti based edgeport</span>
<span class="cp">#define TI_BOARD_REV_COMPACT		1	</span><span class="c1">// Compact board</span>
<span class="cp">#define TI_BOARD_REV_WATCHPORT		2	</span><span class="c1">// Watchport</span>


<span class="cp">#define TI_GET_CPU_REVISION(x)		(__u8)((((x)&gt;&gt;4)&amp;0x0f))</span>
<span class="cp">#define TI_GET_BOARD_REVISION(x)	(__u8)(((x)&amp;0x0f))</span>

<span class="cp">#define TI_I2C_SIZE_MASK		0x1f  </span><span class="c1">// 5 bits</span>
<span class="cp">#define TI_GET_I2C_SIZE(x)		((((x) &amp; TI_I2C_SIZE_MASK)+1)*256)</span>

<span class="cp">#define TI_MAX_I2C_SIZE			(16 * 1024)</span>

<span class="cp">#define TI_MANUF_VERSION_0		0</span></pre></div></td></tr>


<tr id="section-75"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-75">&#182;</a></div><p>IonConig2 flags</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define TI_CONFIG2_RS232		0x01</span>
<span class="cp">#define TI_CONFIG2_RS422		0x02</span>
<span class="cp">#define TI_CONFIG2_RS485		0x04</span>
<span class="cp">#define TI_CONFIG2_SWITCHABLE		0x08</span>

<span class="cp">#define TI_CONFIG2_WATCHPORT		0x10</span>


<span class="k">struct</span> <span class="n">edge_ti_manuf_descriptor</span> <span class="p">{</span>
	<span class="n">__u8</span> <span class="n">IonConfig</span><span class="p">;</span>		<span class="c1">//  Config byte for ION manufacturing use</span>
	<span class="n">__u8</span> <span class="n">IonConfig2</span><span class="p">;</span>	<span class="c1">//  Expansion</span>
	<span class="n">__u8</span> <span class="n">Version</span><span class="p">;</span>		<span class="c1">//  Version</span>
	<span class="n">__u8</span> <span class="n">CpuRev_BoardRev</span><span class="p">;</span>	<span class="c1">//  CPU revision level (0xF0) and Board Rev Level (0x0F)</span>
	<span class="n">__u8</span> <span class="n">NumPorts</span><span class="p">;</span>		<span class="c1">//  Number of ports	for this UMP</span>
	<span class="n">__u8</span> <span class="n">NumVirtualPorts</span><span class="p">;</span>	<span class="c1">//  Number of Virtual ports</span>
	<span class="n">__u8</span> <span class="n">HubConfig1</span><span class="p">;</span>	<span class="c1">//  Used to configure the Hub</span>
	<span class="n">__u8</span> <span class="n">HubConfig2</span><span class="p">;</span>	<span class="c1">//  Used to configure the Hub</span>
	<span class="n">__u8</span> <span class="n">TotalPorts</span><span class="p">;</span>	<span class="c1">//  Total Number of Com Ports for the entire device (All UMPs)</span>
	<span class="n">__u8</span> <span class="n">Reserved</span><span class="p">;</span>		<span class="c1">//  Reserved</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>


<span class="cp">#endif		</span><span class="c1">// if !defined(_USBVEND_H)</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
