f | iscsi_iser.c | s | 20K | 676 | Or Gerlitz | ogerlitz@mellanox.com | 1337385931 |  | IB/iser: Fix error flow in iser ep connection establishment  The current error flow code was releasing the IB connection object and calling iscsi_destroy_endpoint() directly without going through the reference counting mechanism introduced in commit 39ff05d ("IB/iser: Enhance disconnection logic for multi-pathing"). This resulted in a double free of the iscsi endpoint object, which causes a kernel NULL pointer dereference.  Fix that by plugging into the IB conn reference counting correctly.  Signed-off-by: Or Gerlitz <ogerlitz@mellanox.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
f | iser_memory.c | s | 12K | 359 | Cong Wang | amwang@redhat.com | 1332251298 |  | infiniband: remove the second argument of k[un]map_atomic()  Acked-by: Roland Dreier <roland@purestorage.com> Signed-off-by: Cong Wang <amwang@redhat.com>
f | Kconfig | g | 494B |  | Justin P. Mattock | justinmattock@gmail.com | 1287392594 |  | Update broken web addresses in the kernel.  The patch below updates broken web addresses in the kernel  Signed-off-by: Justin P. Mattock <justinmattock@gmail.com> Cc: Maciej W. Rozycki <macro@linux-mips.org> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: Finn Thain <fthain@telegraphics.com.au> Cc: Randy Dunlap <rdunlap@xenotime.net> Cc: Matt Turner <mattst88@gmail.com> Cc: Dimitry Torokhov <dmitry.torokhov@gmail.com> Cc: Mike Frysinger <vapier.adi@gmail.com> Acked-by: Ben Pfaff <blp@cs.stanford.edu> Acked-by: Hans J. Koch <hjk@linutronix.de> Reviewed-by: Finn Thain <fthain@telegraphics.com.au> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | Makefile | g | 125B |  | Or Gerlitz | ogerlitz@voltaire.com | 1150987874 |  | IB/iser: iSER Kconfig and Makefile  Kconfig and Makefile for iSER.  Signed-off-by: Or Gerlitz <ogerlitz@voltaire.com> Signed-off-by: Roland Dreier <rolandd@cisco.com>
f | iser_verbs.c | s | 23K | 735 | Or Gerlitz | ogerlitz@mellanox.com | 1337385931 |  | IB/iser: Fix error flow in iser ep connection establishment  The current error flow code was releasing the IB connection object and calling iscsi_destroy_endpoint() directly without going through the reference counting mechanism introduced in commit 39ff05d ("IB/iser: Enhance disconnection logic for multi-pathing"). This resulted in a double free of the iscsi endpoint object, which causes a kernel NULL pointer dereference.  Fix that by plugging into the IB conn reference counting correctly.  Signed-off-by: Or Gerlitz <ogerlitz@mellanox.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
f | iser_initiator.c | s | 16K | 473 | Or Gerlitz | ogerlitz@mellanox.com | 1330966385 |  | IB/iser: Post initial receive buffers before sending the final login request  An iser target may send iscsi NO-OP PDUs as soon as it marks the iSER iSCSI session as fully operative.  This means that there is window where there are no posted receive buffers on the initiator side, so it's possible for the iSER RC connection to break because of RNR NAK / retry errors.  To fix this, rely on the flags bits in the login request to have FFP (0x3) in the lower nibble as a marker for the final login request, and post an initial chunk of receive buffers before sending that login request instead of after getting the login response.  Signed-off-by: Or Gerlitz <ogerlitz@mellanox.com> Cc: <stable@vger.kernel.org> Signed-off-by: Roland Dreier <roland@purestorage.com>
f | iscsi_iser.h | s | 12K | 307 | Or Gerlitz | ogerlitz@mellanox.com | 1330966385 |  | IB/iser: Post initial receive buffers before sending the final login request  An iser target may send iscsi NO-OP PDUs as soon as it marks the iSER iSCSI session as fully operative.  This means that there is window where there are no posted receive buffers on the initiator side, so it's possible for the iSER RC connection to break because of RNR NAK / retry errors.  To fix this, rely on the flags bits in the login request to have FFP (0x3) in the lower nibble as a marker for the final login request, and post an initial chunk of receive buffers before sending that login request instead of after getting the login response.  Signed-off-by: Or Gerlitz <ogerlitz@mellanox.com> Cc: <stable@vger.kernel.org> Signed-off-by: Roland Dreier <roland@purestorage.com>
