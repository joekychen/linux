f | ib_srpt.c | s | 104K | 3485 | Linus Torvalds | torvalds@linux-foundation.org | 1337647029 |  | Merge branch 'for-next' of git://git.kernel.org/pub/scm/linux/kernel/git/nab/target-pending  Pull scsi-target changes from Nicholas Bellinger:  "There has been lots of work in existing code in a number of areas this   past cycle.  The major highlights have been:     * Removal of transport_do_task_sg_chain() from core + fabrics      (Roland)    * target-core: Removal of se_task abstraction from target-core and      enforce hw_max_sectors for pSCSI backends (hch)    * Re-factoring of iscsi-target tx immediate/response queues (agrover)    * Conversion of iscsi-target back to using target core memory      allocation logic (agrover)    We've had one last minute iscsi-target patch go into for-next to   address a nasty regression bug related to the target core allocation   logic conversion from agrover that is not included in friday's   linux-next build, but has been included in this series.    On the new fabric module code front for-3.5, here is a brief status   update for the three currently in flight this round:     * usb-gadget target driver:    Sebastian Siewior's driver for supporting usb-gadget target mode   operation.  This will be going out as a separate PULL request from   target-pending/usb-target-merge with subsystem maintainer ACKs.  There   is one minor target-core patch in this series required to function.     * sbp ieee-1394/firewire target driver:    Chris Boot's driver for supportting the Serial Block Protocol (SBP)   across IEEE-1394 Firewire hardware.  This will be going out as a   separate PULL request from target-pending/sbp-target-merge with two   additional drivers/firewire/ patches w/ subsystem maintainer ACKs.     * qla2xxx LLD target mode infrastructure changes + tcm_qla2xxx:    The Qlogic >= 24xx series HW target mode LLD infrastructure patch-set   and tcm_qla2xxx fabric driver.  Support for FC target mode using   qla2xxx LLD code has been officially submitted by Qlogic to James   below, and is currently outstanding but not yet merged into   scsi.git/for-next..      [PATCH 00/22] qla2xxx: Updates for scsi "misc" branch     http://www.spinics.net/lists/linux-scsi/msg59350.html    Note there are *zero* direct dependencies upon this for-next series   for the qla2xxx LLD target + tcm_qla2xxx patches submitted above, and   over the last days the target mode team has been tracking down an   tcm_qla2xxx specific active I/O shutdown bug that appears to now be   almost squashed for 3.5-rc-fixes."  * 'for-next' of git://git.kernel.org/pub/scm/linux/kernel/git/nab/target-pending: (47 commits)   iscsi-target: Fix iov_count calculation bug in iscsit_allocate_iovecs   iscsi-target: remove dead code in iscsi_check_valuelist_for_support   target: Handle ATA_16 passthrough for pSCSI backend devices   target: Add MI_REPORT_TARGET_PGS ext. header + implict_trans_secs attribute   target: Fix MAINTENANCE_IN service action CDB checks to use lower 5 bits   target: add support for the WRITE_VERIFY command   target: make target_put_session void   target: cleanup transport_execute_tasks()   target: Remove max_sectors device attribute for modern se_task less code   target: lock => unlock typo in transport_lun_wait_for_tasks   target: Enforce hw_max_sectors for SCF_SCSI_DATA_SG_IO_CDB   target: remove the t_se_count field in struct se_cmd   target: remove the t_task_cdbs_ex_left field in struct se_cmd   target: remove the t_task_cdbs_left field in struct se_cmd   target: remove struct se_task   target: move the state and execute lists to the command   target: simplify command to task linkage   target: always allocate a single task   target: replace ->execute_task with ->execute_cmd   target: remove the task_sectors field in struct se_task   ...
f | ib_srpt.h | s | 14K | 408 | Jesper Juhl | jj@chaosbits.net | 1328216159 |  | IB/srpt: Remove unneeded <linux/version.h> include  Signed-off-by: Jesper Juhl <jj@chaosbits.net> Signed-off-by: Roland Dreier <roland@purestorage.com>
f | Makefile | g | 75B |  | Bart Van Assche | bvanassche@acm.org | 1324017236 |  | ib_srpt: Initial SRP Target merge for v3.3-rc1  This patch adds the kernel module ib_srpt SCSI RDMA Protocol (SRP) target implementation conforming to the SRP r16a specification for the mainline drivers/target infrastructure.  This driver was originally developed by Vu Pham and has been optimized by Bart Van Assche and merged into upstream LIO based on his srpt-lio-4.1 branch here:     https://github.com/bvanassche/srpt-lio/commits/srpt-lio-4.1/  This updated patch also contains the following two changes from lio-core-2.6.git/master.  One is to fix a bug with 1 >= task->task_sg[] chained mappings in ib_srpt, and the other to convert the configfs control plane to reference IB Port GUID and struct srpt_port directly following mainline v4.x target_core_fabric_configfs.c convertion for ib_srpt to work with rtslib/rtsadmin v2 code.  These seperate patches can be found here:  ib_srpt: Fix bug with chainged SGLs in srpt_map_sg_to_ib_sge http://www.risingtidesystems.com/git/?p=lio-core-2.6.git;a=commitdiff;h=ea485147563b6555a97dbf811825fbb586519252  ib_srpt: Convert se_wwn endpoint reference to struct srpt_port->port_wwn http://www.risingtidesystems.com/git/?p=lio-core-2.6.git;a=commitdiff;h=4e544a210acb227df1bb4ca5086e65bdf4e648ea  This also includes the following recent v1 -> v2 review changes:  ib_srpt: Fix potential out-of-bounds array access ib_srpt: Avoid failed multipart RDMA transfers ib_srpt: Fix srpt_alloc_fabric_acl failure case return value ib_srpt: Update comments to reference $driver/$port layout ib_srpt: Fix sport->port_guid formatting code ib_srpt: Remove legacy use_port_guid_in_session_name module parameter ib_srpt: Convert srp_max_rdma_size into per port configfs attribute ib_srpt: Convert srp_max_rsp_size into per port configfs attribute ib_srpt: Convert srpt_sq_size into per port configfs attribute  and v2 -> v3 review changes:  ib_srpt: Fix possible race with srp_sq_size in srpt_create_ch_ib ib_srpt: Fix possible race with srp_max_rsp_size in srpt_release_channel_work ib_srpt: Fix up MAX_SRPT_RDMA_SIZE define ib_srpt: Make srpt_map_sg_to_ib_sge() failure case return -EAGAIN ib_srpt: Convert port_guid to use subnet_prefix + interface_id formatting ib_srpt: Make srpt_check_stop_free return kref_put status ib_srpt: Make compilation with BUG=n proceed` ib_srpt: Use new target_core_fabric.h include ib_srpt: Check hex2bin() return code to silence build warning  Cc: Bart Van Assche <bvanassche@acm.org> Cc: Roland Dreier <roland@purestorage.com> Cc: Christoph Hellwig <hch@lst.de> Cc: Vu Pham <vu@mellanox.com> Cc: David Dillow <dillowda@ornl.gov> Signed-off-by: Nicholas A. Bellinger <nab@risingtidesystems.com>
f | Kconfig | g | 585B |  | Bart Van Assche | bvanassche@acm.org | 1324017236 |  | ib_srpt: Initial SRP Target merge for v3.3-rc1  This patch adds the kernel module ib_srpt SCSI RDMA Protocol (SRP) target implementation conforming to the SRP r16a specification for the mainline drivers/target infrastructure.  This driver was originally developed by Vu Pham and has been optimized by Bart Van Assche and merged into upstream LIO based on his srpt-lio-4.1 branch here:     https://github.com/bvanassche/srpt-lio/commits/srpt-lio-4.1/  This updated patch also contains the following two changes from lio-core-2.6.git/master.  One is to fix a bug with 1 >= task->task_sg[] chained mappings in ib_srpt, and the other to convert the configfs control plane to reference IB Port GUID and struct srpt_port directly following mainline v4.x target_core_fabric_configfs.c convertion for ib_srpt to work with rtslib/rtsadmin v2 code.  These seperate patches can be found here:  ib_srpt: Fix bug with chainged SGLs in srpt_map_sg_to_ib_sge http://www.risingtidesystems.com/git/?p=lio-core-2.6.git;a=commitdiff;h=ea485147563b6555a97dbf811825fbb586519252  ib_srpt: Convert se_wwn endpoint reference to struct srpt_port->port_wwn http://www.risingtidesystems.com/git/?p=lio-core-2.6.git;a=commitdiff;h=4e544a210acb227df1bb4ca5086e65bdf4e648ea  This also includes the following recent v1 -> v2 review changes:  ib_srpt: Fix potential out-of-bounds array access ib_srpt: Avoid failed multipart RDMA transfers ib_srpt: Fix srpt_alloc_fabric_acl failure case return value ib_srpt: Update comments to reference $driver/$port layout ib_srpt: Fix sport->port_guid formatting code ib_srpt: Remove legacy use_port_guid_in_session_name module parameter ib_srpt: Convert srp_max_rdma_size into per port configfs attribute ib_srpt: Convert srp_max_rsp_size into per port configfs attribute ib_srpt: Convert srpt_sq_size into per port configfs attribute  and v2 -> v3 review changes:  ib_srpt: Fix possible race with srp_sq_size in srpt_create_ch_ib ib_srpt: Fix possible race with srp_max_rsp_size in srpt_release_channel_work ib_srpt: Fix up MAX_SRPT_RDMA_SIZE define ib_srpt: Make srpt_map_sg_to_ib_sge() failure case return -EAGAIN ib_srpt: Convert port_guid to use subnet_prefix + interface_id formatting ib_srpt: Make srpt_check_stop_free return kref_put status ib_srpt: Make compilation with BUG=n proceed` ib_srpt: Use new target_core_fabric.h include ib_srpt: Check hex2bin() return code to silence build warning  Cc: Bart Van Assche <bvanassche@acm.org> Cc: Roland Dreier <roland@purestorage.com> Cc: Christoph Hellwig <hch@lst.de> Cc: Vu Pham <vu@mellanox.com> Cc: David Dillow <dillowda@ornl.gov> Signed-off-by: Nicholas A. Bellinger <nab@risingtidesystems.com>
f | ib_dm_mad.h | s | 4.0K | 127 | Bart Van Assche | bvanassche@acm.org | 1324017236 |  | ib_srpt: Initial SRP Target merge for v3.3-rc1  This patch adds the kernel module ib_srpt SCSI RDMA Protocol (SRP) target implementation conforming to the SRP r16a specification for the mainline drivers/target infrastructure.  This driver was originally developed by Vu Pham and has been optimized by Bart Van Assche and merged into upstream LIO based on his srpt-lio-4.1 branch here:     https://github.com/bvanassche/srpt-lio/commits/srpt-lio-4.1/  This updated patch also contains the following two changes from lio-core-2.6.git/master.  One is to fix a bug with 1 >= task->task_sg[] chained mappings in ib_srpt, and the other to convert the configfs control plane to reference IB Port GUID and struct srpt_port directly following mainline v4.x target_core_fabric_configfs.c convertion for ib_srpt to work with rtslib/rtsadmin v2 code.  These seperate patches can be found here:  ib_srpt: Fix bug with chainged SGLs in srpt_map_sg_to_ib_sge http://www.risingtidesystems.com/git/?p=lio-core-2.6.git;a=commitdiff;h=ea485147563b6555a97dbf811825fbb586519252  ib_srpt: Convert se_wwn endpoint reference to struct srpt_port->port_wwn http://www.risingtidesystems.com/git/?p=lio-core-2.6.git;a=commitdiff;h=4e544a210acb227df1bb4ca5086e65bdf4e648ea  This also includes the following recent v1 -> v2 review changes:  ib_srpt: Fix potential out-of-bounds array access ib_srpt: Avoid failed multipart RDMA transfers ib_srpt: Fix srpt_alloc_fabric_acl failure case return value ib_srpt: Update comments to reference $driver/$port layout ib_srpt: Fix sport->port_guid formatting code ib_srpt: Remove legacy use_port_guid_in_session_name module parameter ib_srpt: Convert srp_max_rdma_size into per port configfs attribute ib_srpt: Convert srp_max_rsp_size into per port configfs attribute ib_srpt: Convert srpt_sq_size into per port configfs attribute  and v2 -> v3 review changes:  ib_srpt: Fix possible race with srp_sq_size in srpt_create_ch_ib ib_srpt: Fix possible race with srp_max_rsp_size in srpt_release_channel_work ib_srpt: Fix up MAX_SRPT_RDMA_SIZE define ib_srpt: Make srpt_map_sg_to_ib_sge() failure case return -EAGAIN ib_srpt: Convert port_guid to use subnet_prefix + interface_id formatting ib_srpt: Make srpt_check_stop_free return kref_put status ib_srpt: Make compilation with BUG=n proceed` ib_srpt: Use new target_core_fabric.h include ib_srpt: Check hex2bin() return code to silence build warning  Cc: Bart Van Assche <bvanassche@acm.org> Cc: Roland Dreier <roland@purestorage.com> Cc: Christoph Hellwig <hch@lst.de> Cc: Vu Pham <vu@mellanox.com> Cc: David Dillow <dillowda@ornl.gov> Signed-off-by: Nicholas A. Bellinger <nab@risingtidesystems.com>
