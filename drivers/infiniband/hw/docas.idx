d | mlx4 |  | 12 items |  | Sagi Grimberg | sagig@mellanox.co.il | 1339002483 |  | IB/mlx4: Fix max_wqe capacity reported from query device  1. Limit the max number of WQEs per QP reported when querying the    device, so that ib_create_qp() will not fail for a QP size that the    device claimed to support due to additional headroom WQEs being    allocated.  2. Limit qp resources accepted for ib_create_qp() to the limits    reported in ib_query_device().  In kernel space, make sure that the    limits returned to the caller following qp creation also lie within    the reported device limits. For userspace, report as before, and do    adjustment in libmlx4 (so as not to break ABI).  Signed-off-by: Jack Morgenstein <jackm@dev.mellanox.co.il> Signed-off-by: Sagi Grimberg <sagig@mellanox.co.il> Signed-off-by: Or Gerlitz <ogerlitz@mellanox.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
d | qib |  | 48 items |  | Mike Marciniszyn | mike.marciniszyn@intel.com | 1337024614 |  | IB/qib: Add cache line awareness to qib_qp and qib_devdata structures  This patch reorganizes the QP and devdata files to be more cache line aware.  qib_qp fields in particular are split into read-mostly, send, and receive fields.  qib_devdata fields are split into read-mostly and read/write fields  Testing has show that bidirectional tests improve by as much as 100% with this patch.  Signed-off-by: Mike Marciniszyn <mike.marciniszyn@intel.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
d | ehca |  | 31 items |  | David Howells | dhowells@redhat.com | 1332955803 |  | Remove all #inclusions of asm/system.h  Remove all #inclusions of asm/system.h preparatory to splitting and killing it.  Performed with the following command:  perl -p -i -e 's!^#\s*include\s*<asm/system[.]h>.*\n!!' `grep -Irl '^#\s*include\s*<asm/system[.]h>' *`  Signed-off-by: David Howells <dhowells@redhat.com>
d | mthca |  | 29 items |  | Or Gerlitz | ogerlitz@mellanox.com | 1331238867 |  | IB: Change CQE "csum_ok" field to a bit flag  Use a bit in wc_flags rather then a whole integer to hold the "checksum OK" flag.  By itself, this change doesn't reduce the size of struct ib_wc on 64bit machines -- it stays on 56 bytes because of padding.  However, it will allow to add more fields in the future without enlarging the struct.  Also, it will let us have a unified approach with future libibverbs checksum offload reporting, because a bit flag doesn't break the library ABI.  This patch was suggested during conversation with Liran Liss <liranl@mellanox.com>.  Signed-off-by: Or Gerlitz <ogerlitz@mellanox.com> Reviewed-by: Sean Hefty <sean.hefty@intel.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
d | ocrdma |  | 12 items |  | Dan Carpenter | dan.carpenter@oracle.com | 1339705841 |  | RDMA/ocrdma: Fix off by one in ocrdma_query_gid()  The dev->sgid_tbl[] array is allocated in ocrdma_alloc_resources(). It has OCRDMA_MAX_SGID elements so the test here is off by one.  Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
d | cxgb3 |  | 20 items |  | Roland Dreier | roland@purestorage.com | 1332175833 |  | Merge branches 'cma', 'cxgb3', 'cxgb4', 'ehca', 'iser', 'mad', 'nes', 'qib', 'srp' and 'srpt' into for-next
d | ipath |  | 37 items |  | Mike Marciniszyn | mike.marciniszyn@qlogic.com | 1336501040 |  | IB/ipath: Replace open-coded ARRAY_SIZE with macro  Change sizeof(array)/sizeof(array[0]) to ARRAY_SIZE.  Signed-off-by: Mike Marciniszyn <mike.marciniszyn@qlogic.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
d | amso1100 |  | 23 items |  | Or Gerlitz | ogerlitz@mellanox.com | 1330968316 |  | IB: Use central enum for speed instead of hard-coded values  The kernel IB stack uses one enumeration for IB speed, which wasn't explicitly specified in the verbs header file.  Add that enum, and use it all over the code.  The IB speed/width notation is also used by iWARP and IBoE HW drivers, which use the convention of rate = speed * width to advertise their port link rate.  Signed-off-by: Or Gerlitz <ogerlitz@mellanox.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
d | cxgb4 |  | 15 items |  | Thadeu Lima de Souza Cascardo | cascardo@linux.vnet.ibm.com | 1338789555 |  | RDMA/cxgb4: Fix crash when peer address is 0.0.0.0  When using rping -c -a 0.0.0.0 with iw_cxgb4, the system crashes when rdma_connect() is called.  ip_dev_find() will return NULL, but pdev is accessed anyway.  Checking that pdev is NULL and returning -ENODEV prevents the system from crashing.  Signed-off-by: Thadeu Lima de Souza Cascardo <cascardo@linux.vnet.ibm.com> Acked-by: Steve Wise <swise@opengridcomputing.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
d | nes |  | 16 items |  | Tatyana Nikolova | Tatyana.E.Nikolova@intel.com | 1337024887 |  | RDMA/nes: Don't call event handler if pointer is NULL  Don't call the ibqp event_handler pointer in the case it wasn't initialized.  Signed-off-by: Tatyana Nikolova <Tatyana.E.Nikolova@intel.com> Signed-off-by: Donald Wood <Donald.E.Wood@intel.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
