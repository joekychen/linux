f | iw_cxgb4.h | s | 22K | 798 | Vipul Pandya | vipul@chelsio.com | 1337372557 |  | RDMA/cxgb4: Add query_qp support  This allows querying the QP state before flushing.  Signed-off-by: Vipul Pandya <vipul@chelsio.com> Signed-off-by: Steve Wise <swise@opengridcomputing.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
f | provider.c | s | 16K | 477 | Vipul Pandya | vipul@chelsio.com | 1337372557 |  | RDMA/cxgb4: Add query_qp support  This allows querying the QP state before flushing.  Signed-off-by: Vipul Pandya <vipul@chelsio.com> Signed-off-by: Steve Wise <swise@opengridcomputing.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
f | qp.c | s | 46K | 1575 | Vipul Pandya | vipul@chelsio.com | 1337372557 |  | RDMA/cxgb4: Add query_qp support  This allows querying the QP state before flushing.  Signed-off-by: Vipul Pandya <vipul@chelsio.com> Signed-off-by: Steve Wise <swise@opengridcomputing.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
f | Makefile | g | 180B |  | Vipul Pandya | vipul@chelsio.com | 1337372556 |  | RDMA/cxgb4: Remove kfifo usage  Using kfifos for ID management was limiting the number of QPs and preventing NP384 MPI jobs.  So replace it with a simple bitmap allocator.  Remove IDs from the IDR tables before deallocating them.  This bug was causing the BUG_ON() in insert_handle() to fire because the ID was getting reused before being removed from the IDR table.  Signed-off-by: Vipul Pandya <vipul@chelsio.com> Signed-off-by: Steve Wise <swise@opengridcomputing.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
f | mem.c | s | 20K | 691 | Vipul Pandya | vipul@chelsio.com | 1337372556 |  | RDMA/cxgb4: Remove kfifo usage  Using kfifos for ID management was limiting the number of QPs and preventing NP384 MPI jobs.  So replace it with a simple bitmap allocator.  Remove IDs from the IDR tables before deallocating them.  This bug was causing the BUG_ON() in insert_handle() to fire because the ID was getting reused before being removed from the IDR table.  Signed-off-by: Vipul Pandya <vipul@chelsio.com> Signed-off-by: Steve Wise <swise@opengridcomputing.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
f | device.c | s | 24K | 818 | Vipul Pandya | vipul@chelsio.com | 1337616034 |  | RDMA/cxgb4: Include vmalloc.h for vmalloc and vfree  Signed-off-by: Vipul Pandya <vipul@chelsio.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
f | t4.h | s | 15K | 527 | Vipul Pandya | vipul@chelsio.com | 1337372553 |  | RDMA/cxgb4: DB Drop Recovery for RDMA and LLD queues  Add module option db_fc_threshold which is the count of active QPs that trigger automatic db flow control mode.  Automatically transition to/from flow control mode when the active qp count crosses db_fc_theshold.  Add more db debugfs stats  On DB DROP event from the LLD, recover all the iwarp queues.  Signed-off-by: Vipul Pandya <vipul@chelsio.com> Signed-off-by: Steve Wise <swise@opengridcomputing.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
f | id_table.c | s | 3.2K | 98 | Vipul Pandya | vipul@chelsio.com | 1337372556 |  | RDMA/cxgb4: Remove kfifo usage  Using kfifos for ID management was limiting the number of QPs and preventing NP384 MPI jobs.  So replace it with a simple bitmap allocator.  Remove IDs from the IDR tables before deallocating them.  This bug was causing the BUG_ON() in insert_handle() to fire because the ID was getting reused before being removed from the IDR table.  Signed-off-by: Vipul Pandya <vipul@chelsio.com> Signed-off-by: Steve Wise <swise@opengridcomputing.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
f | cm.c | s | 71K | 2422 | Thadeu Lima de Souza Cascardo | cascardo@linux.vnet.ibm.com | 1338789555 |  | RDMA/cxgb4: Fix crash when peer address is 0.0.0.0  When using rping -c -a 0.0.0.0 with iw_cxgb4, the system crashes when rdma_connect() is called.  ip_dev_find() will return NULL, but pdev is accessed anyway.  Checking that pdev is NULL and returning -ENODEV prevents the system from crashing.  Signed-off-by: Thadeu Lima de Souza Cascardo <cascardo@linux.vnet.ibm.com> Acked-by: Steve Wise <swise@opengridcomputing.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
f | ev.c | s | 5.7K | 179 | Vipul Pandya | vipul@chelsio.com | 1337372552 |  | RDMA/cxgb4: Disable interrupts in c4iw_ev_dispatch()  Use GFP_ATOMIC in _insert_handle() if ints are disabled.  Don't panic if we get an abort with no endpoint found.  Just log a warning.  Signed-off-by: Vipul Pandya <vipul@chelsio.com> Signed-off-by: Steve Wise <swise@opengridcomputing.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
f | user.h | s | 2.2K | 68 | Vipul Pandya | vipul@chelsio.com | 1337372551 |  | RDMA/cxgb4: Add DB Overflow Avoidance  Get FULL/EMPTY/DROP events from LLD.  On FULL event, disable normal user mode DB rings.  Add modify_qp semantics to allow user processes to call into the kernel to ring doobells without overflowing.  Add DB Full/Empty/Drop stats.  Mark queues when created indicating the doorbell state.  If we're in the middle of db overflow avoidance, then newly created queues should start out in this mode.  Bump the C4IW_UVERBS_ABI_VERSION to 2 so the user mode library can know if the driver supports the kernel mode db ringing.  Signed-off-by: Vipul Pandya <vipul@chelsio.com> Signed-off-by: Steve Wise <swise@opengridcomputing.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
f | t4fw_ri_api.h | s | 24K | 737 | Steve Wise | swise@opengridcomputing.com | 1279734832 |  | RDMA/cxgb4: Add module option to tweak delayed ack  Signed-off-by: Steve Wise <swise@opengridcomputing.com> Signed-off-by: Roland Dreier <rolandd@cisco.com>
f | resource.c | s | 11K | 405 | Vipul Pandya | vipul@chelsio.com | 1337372556 |  | RDMA/cxgb4: Remove kfifo usage  Using kfifos for ID management was limiting the number of QPs and preventing NP384 MPI jobs.  So replace it with a simple bitmap allocator.  Remove IDs from the IDR tables before deallocating them.  This bug was causing the BUG_ON() in insert_handle() to fire because the ID was getting reused before being removed from the IDR table.  Signed-off-by: Vipul Pandya <vipul@chelsio.com> Signed-off-by: Steve Wise <swise@opengridcomputing.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
f | cq.c | s | 21K | 801 | Jonathan Lallinger | jonathan@ogc.us | 1322509985 |  | RDMA/cxgb4: Fix iw_cxgb4 count_rcqes() logic  Fix another place in the code where logic dealing with the t4_cqe was using the wrong QID.  This fixes the counting logic so that it tests against the SQ QID instead of the RQ QID when counting RCQES.  Signed-off by: Jonathan Lallinger <jonathan@ogc.us> Signed-off by: Steve Wise <swise@ogc.us> Signed-off-by: Roland Dreier <roland@purestorage.com>
f | Kconfig | g | 575B |  | Justin P. Mattock | justinmattock@gmail.com | 1287392594 |  | Update broken web addresses in the kernel.  The patch below updates broken web addresses in the kernel  Signed-off-by: Justin P. Mattock <justinmattock@gmail.com> Cc: Maciej W. Rozycki <macro@linux-mips.org> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: Finn Thain <fthain@telegraphics.com.au> Cc: Randy Dunlap <rdunlap@xenotime.net> Cc: Matt Turner <mattst88@gmail.com> Cc: Dimitry Torokhov <dmitry.torokhov@gmail.com> Cc: Mike Frysinger <vapier.adi@gmail.com> Acked-by: Ben Pfaff <blp@cs.stanford.edu> Acked-by: Hans J. Koch <hjk@linutronix.de> Reviewed-by: Finn Thain <fthain@telegraphics.com.au> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
