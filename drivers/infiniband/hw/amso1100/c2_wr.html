<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › infiniband › hw › amso1100 › c2_wr.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>c2_wr.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright (c) 2005 Ammasso, Inc. All rights reserved.</span>
<span class="cm"> * Copyright (c) 2005 Open Grid Computing, Inc. All rights reserved.</span>
<span class="cm"> *</span>
<span class="cm"> * This software is available to you under a choice of one of two</span>
<span class="cm"> * licenses.  You may choose to be licensed under the terms of the GNU</span>
<span class="cm"> * General Public License (GPL) Version 2, available from the file</span>
<span class="cm"> * COPYING in the main directory of this source tree, or the</span>
<span class="cm"> * OpenIB.org BSD license below:</span>
<span class="cm"> *</span>
<span class="cm"> *     Redistribution and use in source and binary forms, with or</span>
<span class="cm"> *     without modification, are permitted provided that the following</span>
<span class="cm"> *     conditions are met:</span>
<span class="cm"> *</span>
<span class="cm"> *      - Redistributions of source code must retain the above</span>
<span class="cm"> *        copyright notice, this list of conditions and the following</span>
<span class="cm"> *        disclaimer.</span>
<span class="cm"> *</span>
<span class="cm"> *      - Redistributions in binary form must reproduce the above</span>
<span class="cm"> *        copyright notice, this list of conditions and the following</span>
<span class="cm"> *        disclaimer in the documentation and/or other materials</span>
<span class="cm"> *        provided with the distribution.</span>
<span class="cm"> *</span>
<span class="cm"> * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,</span>
<span class="cm"> * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF</span>
<span class="cm"> * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND</span>
<span class="cm"> * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS</span>
<span class="cm"> * BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN</span>
<span class="cm"> * ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN</span>
<span class="cm"> * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span>
<span class="cm"> * SOFTWARE.</span>
<span class="cm"> */</span>
<span class="cp">#ifndef _C2_WR_H_</span>
<span class="cp">#define _C2_WR_H_</span>

<span class="cp">#ifdef CCDEBUG</span>
<span class="cp">#define CCWR_MAGIC		0xb07700b0</span>
<span class="cp">#endif</span>

<span class="cp">#define C2_QP_NO_ATTR_CHANGE 0xFFFFFFFF</span>

<span class="cm">/* Maximum allowed size in bytes of private_data exchange</span>
<span class="cm"> * on connect.</span>
<span class="cm"> */</span>
<span class="cp">#define C2_MAX_PRIVATE_DATA_SIZE 200</span>

<span class="cm">/*</span>
<span class="cm"> * These types are shared among the adapter, host, and CCIL consumer.</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">c2_cq_notification_type</span> <span class="p">{</span>
	<span class="n">C2_CQ_NOTIFICATION_TYPE_NONE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">C2_CQ_NOTIFICATION_TYPE_NEXT</span><span class="p">,</span>
	<span class="n">C2_CQ_NOTIFICATION_TYPE_NEXT_SE</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">c2_setconfig_cmd</span> <span class="p">{</span>
	<span class="n">C2_CFG_ADD_ADDR</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">C2_CFG_DEL_ADDR</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">C2_CFG_ADD_ROUTE</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">C2_CFG_DEL_ROUTE</span> <span class="o">=</span> <span class="mi">4</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">c2_getconfig_cmd</span> <span class="p">{</span>
	<span class="n">C2_GETCONFIG_ROUTES</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">C2_GETCONFIG_ADDRS</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> *  CCIL Work Request Identifiers</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">c2wr_ids</span> <span class="p">{</span>
	<span class="n">CCWR_RNIC_OPEN</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">CCWR_RNIC_QUERY</span><span class="p">,</span>
	<span class="n">CCWR_RNIC_SETCONFIG</span><span class="p">,</span>
	<span class="n">CCWR_RNIC_GETCONFIG</span><span class="p">,</span>
	<span class="n">CCWR_RNIC_CLOSE</span><span class="p">,</span>
	<span class="n">CCWR_CQ_CREATE</span><span class="p">,</span>
	<span class="n">CCWR_CQ_QUERY</span><span class="p">,</span>
	<span class="n">CCWR_CQ_MODIFY</span><span class="p">,</span>
	<span class="n">CCWR_CQ_DESTROY</span><span class="p">,</span>
	<span class="n">CCWR_QP_CONNECT</span><span class="p">,</span>
	<span class="n">CCWR_PD_ALLOC</span><span class="p">,</span>
	<span class="n">CCWR_PD_DEALLOC</span><span class="p">,</span>
	<span class="n">CCWR_SRQ_CREATE</span><span class="p">,</span>
	<span class="n">CCWR_SRQ_QUERY</span><span class="p">,</span>
	<span class="n">CCWR_SRQ_MODIFY</span><span class="p">,</span>
	<span class="n">CCWR_SRQ_DESTROY</span><span class="p">,</span>
	<span class="n">CCWR_QP_CREATE</span><span class="p">,</span>
	<span class="n">CCWR_QP_QUERY</span><span class="p">,</span>
	<span class="n">CCWR_QP_MODIFY</span><span class="p">,</span>
	<span class="n">CCWR_QP_DESTROY</span><span class="p">,</span>
	<span class="n">CCWR_NSMR_STAG_ALLOC</span><span class="p">,</span>
	<span class="n">CCWR_NSMR_REGISTER</span><span class="p">,</span>
	<span class="n">CCWR_NSMR_PBL</span><span class="p">,</span>
	<span class="n">CCWR_STAG_DEALLOC</span><span class="p">,</span>
	<span class="n">CCWR_NSMR_REREGISTER</span><span class="p">,</span>
	<span class="n">CCWR_SMR_REGISTER</span><span class="p">,</span>
	<span class="n">CCWR_MR_QUERY</span><span class="p">,</span>
	<span class="n">CCWR_MW_ALLOC</span><span class="p">,</span>
	<span class="n">CCWR_MW_QUERY</span><span class="p">,</span>
	<span class="n">CCWR_EP_CREATE</span><span class="p">,</span>
	<span class="n">CCWR_EP_GETOPT</span><span class="p">,</span>
	<span class="n">CCWR_EP_SETOPT</span><span class="p">,</span>
	<span class="n">CCWR_EP_DESTROY</span><span class="p">,</span>
	<span class="n">CCWR_EP_BIND</span><span class="p">,</span>
	<span class="n">CCWR_EP_CONNECT</span><span class="p">,</span>
	<span class="n">CCWR_EP_LISTEN</span><span class="p">,</span>
	<span class="n">CCWR_EP_SHUTDOWN</span><span class="p">,</span>
	<span class="n">CCWR_EP_LISTEN_CREATE</span><span class="p">,</span>
	<span class="n">CCWR_EP_LISTEN_DESTROY</span><span class="p">,</span>
	<span class="n">CCWR_EP_QUERY</span><span class="p">,</span>
	<span class="n">CCWR_CR_ACCEPT</span><span class="p">,</span>
	<span class="n">CCWR_CR_REJECT</span><span class="p">,</span>
	<span class="n">CCWR_CONSOLE</span><span class="p">,</span>
	<span class="n">CCWR_TERM</span><span class="p">,</span>
	<span class="n">CCWR_FLASH_INIT</span><span class="p">,</span>
	<span class="n">CCWR_FLASH</span><span class="p">,</span>
	<span class="n">CCWR_BUF_ALLOC</span><span class="p">,</span>
	<span class="n">CCWR_BUF_FREE</span><span class="p">,</span>
	<span class="n">CCWR_FLASH_WRITE</span><span class="p">,</span>
	<span class="n">CCWR_INIT</span><span class="p">,</span>		<span class="cm">/* WARNING: Don&#39;t move this ever again! */</span>



	<span class="cm">/* Add new IDs here */</span>



	<span class="cm">/*</span>
<span class="cm">	 * WARNING: CCWR_LAST must always be the last verbs id defined!</span>
<span class="cm">	 *          All the preceding IDs are fixed, and must not change.</span>
<span class="cm">	 *          You can add new IDs, but must not remove or reorder</span>
<span class="cm">	 *          any IDs. If you do, YOU will ruin any hope of</span>
<span class="cm">	 *          compatibility between versions.</span>
<span class="cm">	 */</span>
	<span class="n">CCWR_LAST</span><span class="p">,</span>

	<span class="cm">/*</span>
<span class="cm">	 * Start over at 1 so that arrays indexed by user wr id&#39;s</span>
<span class="cm">	 * begin at 1.  This is OK since the verbs and user wr id&#39;s</span>
<span class="cm">	 * are always used on disjoint sets of queues.</span>
<span class="cm">	 */</span>
	<span class="cm">/*</span>
<span class="cm">	 * The order of the CCWR_SEND_XX verbs must</span>
<span class="cm">	 * match the order of the RDMA_OPs</span>
<span class="cm">	 */</span>
	<span class="n">CCWR_SEND</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">CCWR_SEND_INV</span><span class="p">,</span>
	<span class="n">CCWR_SEND_SE</span><span class="p">,</span>
	<span class="n">CCWR_SEND_SE_INV</span><span class="p">,</span>
	<span class="n">CCWR_RDMA_WRITE</span><span class="p">,</span>
	<span class="n">CCWR_RDMA_READ</span><span class="p">,</span>
	<span class="n">CCWR_RDMA_READ_INV</span><span class="p">,</span>
	<span class="n">CCWR_MW_BIND</span><span class="p">,</span>
	<span class="n">CCWR_NSMR_FASTREG</span><span class="p">,</span>
	<span class="n">CCWR_STAG_INVALIDATE</span><span class="p">,</span>
	<span class="n">CCWR_RECV</span><span class="p">,</span>
	<span class="n">CCWR_NOP</span><span class="p">,</span>
	<span class="n">CCWR_UNIMPL</span><span class="p">,</span>
<span class="cm">/* WARNING: This must always be the last user wr id defined! */</span>
<span class="p">};</span>
<span class="cp">#define RDMA_SEND_OPCODE_FROM_WR_ID(x)   (x+2)</span>

<span class="cm">/*</span>
<span class="cm"> * SQ/RQ Work Request Types</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">c2_wr_type</span> <span class="p">{</span>
	<span class="n">C2_WR_TYPE_SEND</span> <span class="o">=</span> <span class="n">CCWR_SEND</span><span class="p">,</span>
	<span class="n">C2_WR_TYPE_SEND_SE</span> <span class="o">=</span> <span class="n">CCWR_SEND_SE</span><span class="p">,</span>
	<span class="n">C2_WR_TYPE_SEND_INV</span> <span class="o">=</span> <span class="n">CCWR_SEND_INV</span><span class="p">,</span>
	<span class="n">C2_WR_TYPE_SEND_SE_INV</span> <span class="o">=</span> <span class="n">CCWR_SEND_SE_INV</span><span class="p">,</span>
	<span class="n">C2_WR_TYPE_RDMA_WRITE</span> <span class="o">=</span> <span class="n">CCWR_RDMA_WRITE</span><span class="p">,</span>
	<span class="n">C2_WR_TYPE_RDMA_READ</span> <span class="o">=</span> <span class="n">CCWR_RDMA_READ</span><span class="p">,</span>
	<span class="n">C2_WR_TYPE_RDMA_READ_INV_STAG</span> <span class="o">=</span> <span class="n">CCWR_RDMA_READ_INV</span><span class="p">,</span>
	<span class="n">C2_WR_TYPE_BIND_MW</span> <span class="o">=</span> <span class="n">CCWR_MW_BIND</span><span class="p">,</span>
	<span class="n">C2_WR_TYPE_FASTREG_NSMR</span> <span class="o">=</span> <span class="n">CCWR_NSMR_FASTREG</span><span class="p">,</span>
	<span class="n">C2_WR_TYPE_INV_STAG</span> <span class="o">=</span> <span class="n">CCWR_STAG_INVALIDATE</span><span class="p">,</span>
	<span class="n">C2_WR_TYPE_RECV</span> <span class="o">=</span> <span class="n">CCWR_RECV</span><span class="p">,</span>
	<span class="n">C2_WR_TYPE_NOP</span> <span class="o">=</span> <span class="n">CCWR_NOP</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">c2_netaddr</span> <span class="p">{</span>
	<span class="n">__be32</span> <span class="n">ip_addr</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">netmask</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">mtu</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">c2_route</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">ip_addr</span><span class="p">;</span>		<span class="cm">/* 0 indicates the default route */</span>
	<span class="n">u32</span> <span class="n">netmask</span><span class="p">;</span>		<span class="cm">/* netmask associated with dst */</span>
	<span class="n">u32</span> <span class="n">flags</span><span class="p">;</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="n">u32</span> <span class="n">ipaddr</span><span class="p">;</span>	<span class="cm">/* address of the nexthop interface */</span>
		<span class="n">u8</span> <span class="n">enaddr</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="p">}</span> <span class="n">nexthop</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * A Scatter Gather Entry.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">c2_data_addr</span> <span class="p">{</span>
	<span class="n">__be32</span> <span class="n">stag</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">length</span><span class="p">;</span>
	<span class="n">__be64</span> <span class="n">to</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * MR and MW flags used by the consumer, RI, and RNIC.</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">c2_mm_flags</span> <span class="p">{</span>
	<span class="n">MEM_REMOTE</span> <span class="o">=</span> <span class="mh">0x0001</span><span class="p">,</span>	<span class="cm">/* allow mw binds with remote access. */</span>
	<span class="n">MEM_VA_BASED</span> <span class="o">=</span> <span class="mh">0x0002</span><span class="p">,</span>	<span class="cm">/* Not Zero-based */</span>
	<span class="n">MEM_PBL_COMPLETE</span> <span class="o">=</span> <span class="mh">0x0004</span><span class="p">,</span>	<span class="cm">/* PBL array is complete in this msg */</span>
	<span class="n">MEM_LOCAL_READ</span> <span class="o">=</span> <span class="mh">0x0008</span><span class="p">,</span>	<span class="cm">/* allow local reads */</span>
	<span class="n">MEM_LOCAL_WRITE</span> <span class="o">=</span> <span class="mh">0x0010</span><span class="p">,</span>	<span class="cm">/* allow local writes */</span>
	<span class="n">MEM_REMOTE_READ</span> <span class="o">=</span> <span class="mh">0x0020</span><span class="p">,</span>	<span class="cm">/* allow remote reads */</span>
	<span class="n">MEM_REMOTE_WRITE</span> <span class="o">=</span> <span class="mh">0x0040</span><span class="p">,</span>	<span class="cm">/* allow remote writes */</span>
	<span class="n">MEM_WINDOW_BIND</span> <span class="o">=</span> <span class="mh">0x0080</span><span class="p">,</span>	<span class="cm">/* binds allowed */</span>
	<span class="n">MEM_SHARED</span> <span class="o">=</span> <span class="mh">0x0100</span><span class="p">,</span>	<span class="cm">/* set if MR is shared */</span>
	<span class="n">MEM_STAG_VALID</span> <span class="o">=</span> <span class="mh">0x0200</span>	<span class="cm">/* set if STAG is in valid state */</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * CCIL API ACF flags defined in terms of the low level mem flags.</span>
<span class="cm"> * This minimizes translation needed in the user API</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">c2_acf</span> <span class="p">{</span>
	<span class="n">C2_ACF_LOCAL_READ</span> <span class="o">=</span> <span class="n">MEM_LOCAL_READ</span><span class="p">,</span>
	<span class="n">C2_ACF_LOCAL_WRITE</span> <span class="o">=</span> <span class="n">MEM_LOCAL_WRITE</span><span class="p">,</span>
	<span class="n">C2_ACF_REMOTE_READ</span> <span class="o">=</span> <span class="n">MEM_REMOTE_READ</span><span class="p">,</span>
	<span class="n">C2_ACF_REMOTE_WRITE</span> <span class="o">=</span> <span class="n">MEM_REMOTE_WRITE</span><span class="p">,</span>
	<span class="n">C2_ACF_WINDOW_BIND</span> <span class="o">=</span> <span class="n">MEM_WINDOW_BIND</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Image types of objects written to flash</span>
<span class="cm"> */</span>
<span class="cp">#define C2_FLASH_IMG_BITFILE 1</span>
<span class="cp">#define C2_FLASH_IMG_OPTION_ROM 2</span>
<span class="cp">#define C2_FLASH_IMG_VPD 3</span>

<span class="cm">/*</span>
<span class="cm"> *  to fix bug 1815 we define the max size allowable of the</span>
<span class="cm"> *  terminate message (per the IETF spec).Refer to the IETF</span>
<span class="cm"> *  protocol specification, section 12.1.6, page 64)</span>
<span class="cm"> *  The message is prefixed by 20 types of DDP info.</span>
<span class="cm"> *</span>
<span class="cm"> *  Then the message has 6 bytes for the terminate control</span>
<span class="cm"> *  and DDP segment length info plus a DDP header (either</span>
<span class="cm"> *  14 or 18 byts) plus 28 bytes for the RDMA header.</span>
<span class="cm"> *  Thus the max size in:</span>
<span class="cm"> *  20 + (6 + 18 + 28) = 72</span>
<span class="cm"> */</span>
<span class="cp">#define C2_MAX_TERMINATE_MESSAGE_SIZE (72)</span>

<span class="cm">/*</span>
<span class="cm"> * Build String Length.  It must be the same as C2_BUILD_STR_LEN in ccil_api.h</span>
<span class="cm"> */</span>
<span class="cp">#define WR_BUILD_STR_LEN 64</span>

<span class="cm">/*</span>
<span class="cm"> * WARNING:  All of these structs need to align any 64bit types on</span>
<span class="cm"> * 64 bit boundaries!  64bit types include u64 and u64.</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * Clustercore Work Request Header.  Be sensitive to field layout</span>
<span class="cm"> * and alignment.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="p">{</span>
	<span class="cm">/* wqe_count is part of the cqe.  It is put here so the</span>
<span class="cm">	 * adapter can write to it while the wr is pending without</span>
<span class="cm">	 * clobbering part of the wr.  This word need not be dma&#39;d</span>
<span class="cm">	 * from the host to adapter by libccil, but we copy it anyway</span>
<span class="cm">	 * to make the memcpy to the adapter better aligned.</span>
<span class="cm">	 */</span>
	<span class="n">__be32</span> <span class="n">wqe_count</span><span class="p">;</span>

	<span class="cm">/* Put these fields next so that later 32- and 64-bit</span>
<span class="cm">	 * quantities are naturally aligned.</span>
<span class="cm">	 */</span>
	<span class="n">u8</span> <span class="n">id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">result</span><span class="p">;</span>		<span class="cm">/* adapter -&gt; host */</span>
	<span class="n">u8</span> <span class="n">sge_count</span><span class="p">;</span>		<span class="cm">/* host -&gt; adapter */</span>
	<span class="n">u8</span> <span class="n">flags</span><span class="p">;</span>		<span class="cm">/* host -&gt; adapter */</span>

	<span class="n">u64</span> <span class="n">context</span><span class="p">;</span>
<span class="cp">#ifdef CCMSGMAGIC</span>
	<span class="n">u32</span> <span class="n">magic</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pad</span><span class="p">;</span>
<span class="cp">#endif</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/*</span>
<span class="cm"> *------------------------ RNIC ------------------------</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * WR_RNIC_OPEN</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * Flags for the RNIC WRs</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">c2_rnic_flags</span> <span class="p">{</span>
	<span class="n">RNIC_IRD_STATIC</span> <span class="o">=</span> <span class="mh">0x0001</span><span class="p">,</span>
	<span class="n">RNIC_ORD_STATIC</span> <span class="o">=</span> <span class="mh">0x0002</span><span class="p">,</span>
	<span class="n">RNIC_QP_STATIC</span> <span class="o">=</span> <span class="mh">0x0004</span><span class="p">,</span>
	<span class="n">RNIC_SRQ_SUPPORTED</span> <span class="o">=</span> <span class="mh">0x0008</span><span class="p">,</span>
	<span class="n">RNIC_PBL_BLOCK_MODE</span> <span class="o">=</span> <span class="mh">0x0010</span><span class="p">,</span>
	<span class="n">RNIC_SRQ_MODEL_ARRIVAL</span> <span class="o">=</span> <span class="mh">0x0020</span><span class="p">,</span>
	<span class="n">RNIC_CQ_OVF_DETECTED</span> <span class="o">=</span> <span class="mh">0x0040</span><span class="p">,</span>
	<span class="n">RNIC_PRIV_MODE</span> <span class="o">=</span> <span class="mh">0x0080</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">c2wr_rnic_open_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">user_context</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">flags</span><span class="p">;</span>		<span class="cm">/* See enum c2_rnic_flags */</span>
	<span class="n">__be16</span> <span class="n">port_num</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">c2wr_rnic_open_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">union</span> <span class="n">c2wr_rnic_open</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_rnic_open_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_rnic_open_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">c2wr_rnic_query_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/*</span>
<span class="cm"> * WR_RNIC_QUERY</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">c2wr_rnic_query_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">user_context</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">vendor_id</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">part_number</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">hw_version</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">fw_ver_major</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">fw_ver_minor</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">fw_ver_patch</span><span class="p">;</span>
	<span class="kt">char</span> <span class="n">fw_ver_build_str</span><span class="p">[</span><span class="n">WR_BUILD_STR_LEN</span><span class="p">];</span>
	<span class="n">__be32</span> <span class="n">max_qps</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">max_qp_depth</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">max_srq_depth</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">max_send_sgl_depth</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">max_rdma_sgl_depth</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">max_cqs</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">max_cq_depth</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">max_cq_event_handlers</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">max_mrs</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">max_pbl_depth</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">max_pds</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">max_global_ird</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">max_global_ord</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">max_qp_ird</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">max_qp_ord</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">flags</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">max_mws</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pbe_range_low</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pbe_range_high</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">max_srqs</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">page_size</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">union</span> <span class="n">c2wr_rnic_query</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_rnic_query_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_rnic_query_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/*</span>
<span class="cm"> * WR_RNIC_GETCONFIG</span>
<span class="cm"> */</span>

<span class="k">struct</span> <span class="n">c2wr_rnic_getconfig_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">option</span><span class="p">;</span>		<span class="cm">/* see c2_getconfig_cmd_t */</span>
	<span class="n">u64</span> <span class="n">reply_buf</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reply_buf_len</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_rnic_getconfig_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">option</span><span class="p">;</span>		<span class="cm">/* see c2_getconfig_cmd_t */</span>
	<span class="n">u32</span> <span class="n">count_len</span><span class="p">;</span>		<span class="cm">/* length of the number of addresses configured */</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">union</span> <span class="n">c2wr_rnic_getconfig</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_rnic_getconfig_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_rnic_getconfig_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * WR_RNIC_SETCONFIG</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">c2wr_rnic_setconfig_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">option</span><span class="p">;</span>		<span class="cm">/* See c2_setconfig_cmd_t */</span>
	<span class="cm">/* variable data and pad. See c2_netaddr and c2_route */</span>
	<span class="n">u8</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_rnic_setconfig_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">union</span> <span class="n">c2wr_rnic_setconfig</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_rnic_setconfig_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_rnic_setconfig_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * WR_RNIC_CLOSE</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">c2wr_rnic_close_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_rnic_close_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">union</span> <span class="n">c2wr_rnic_close</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_rnic_close_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_rnic_close_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> *------------------------ CQ ------------------------</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">c2wr_cq_create_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">__be64</span> <span class="n">shared_ht</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">user_context</span><span class="p">;</span>
	<span class="n">__be64</span> <span class="n">msg_pool</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">msg_size</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">depth</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_cq_create_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">mq_index</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">adapter_shared</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">cq_handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">union</span> <span class="n">c2wr_cq_create</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_cq_create_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_cq_create_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_cq_modify_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">cq_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">new_depth</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">new_msg_pool</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_cq_modify_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">union</span> <span class="n">c2wr_cq_modify</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_cq_modify_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_cq_modify_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_cq_destroy_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">cq_handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_cq_destroy_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">union</span> <span class="n">c2wr_cq_destroy</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_cq_destroy_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_cq_destroy_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> *------------------------ PD ------------------------</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">c2wr_pd_alloc_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pd_id</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_pd_alloc_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">union</span> <span class="n">c2wr_pd_alloc</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_pd_alloc_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_pd_alloc_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_pd_dealloc_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pd_id</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_pd_dealloc_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">union</span> <span class="n">c2wr_pd_dealloc</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_pd_dealloc_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_pd_dealloc_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> *------------------------ SRQ ------------------------</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">c2wr_srq_create_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">shared_ht</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">user_context</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">srq_depth</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">srq_limit</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">sgl_depth</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pd_id</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_srq_create_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">srq_depth</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">sgl_depth</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">msg_size</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">mq_index</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">mq_start</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">srq_handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">union</span> <span class="n">c2wr_srq_create</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_srq_create_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_srq_create_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_srq_destroy_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">srq_handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_srq_destroy_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">union</span> <span class="n">c2wr_srq_destroy</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_srq_destroy_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_srq_destroy_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> *------------------------ QP ------------------------</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">c2wr_qp_flags</span> <span class="p">{</span>
	<span class="n">QP_RDMA_READ</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>	<span class="cm">/* RDMA read enabled? */</span>
	<span class="n">QP_RDMA_WRITE</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>	<span class="cm">/* RDMA write enabled? */</span>
	<span class="n">QP_MW_BIND</span> <span class="o">=</span> <span class="mh">0x00000004</span><span class="p">,</span>	<span class="cm">/* MWs enabled */</span>
	<span class="n">QP_ZERO_STAG</span> <span class="o">=</span> <span class="mh">0x00000008</span><span class="p">,</span>	<span class="cm">/* enabled? */</span>
	<span class="n">QP_REMOTE_TERMINATION</span> <span class="o">=</span> <span class="mh">0x00000010</span><span class="p">,</span>	<span class="cm">/* remote end terminated */</span>
	<span class="n">QP_RDMA_READ_RESPONSE</span> <span class="o">=</span> <span class="mh">0x00000020</span>	<span class="cm">/* Remote RDMA read  */</span>
	    <span class="cm">/* enabled? */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">c2wr_qp_create_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">__be64</span> <span class="n">shared_sq_ht</span><span class="p">;</span>
	<span class="n">__be64</span> <span class="n">shared_rq_ht</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">user_context</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">sq_cq_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rq_cq_handle</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">sq_depth</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">rq_depth</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">srq_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">srq_limit</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">flags</span><span class="p">;</span>		<span class="cm">/* see enum c2wr_qp_flags */</span>
	<span class="n">__be32</span> <span class="n">send_sgl_depth</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">recv_sgl_depth</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">rdma_write_sgl_depth</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">ord</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">ird</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pd_id</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_qp_create_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">sq_depth</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">rq_depth</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">send_sgl_depth</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">recv_sgl_depth</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rdma_write_sgl_depth</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">ord</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">ird</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">sq_msg_size</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">sq_mq_index</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">sq_mq_start</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">rq_msg_size</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">rq_mq_index</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">rq_mq_start</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">qp_handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">union</span> <span class="n">c2wr_qp_create</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_qp_create_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_qp_create_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_qp_query_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">qp_handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_qp_query_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">user_context</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">sq_depth</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rq_depth</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">send_sgl_depth</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rdma_write_sgl_depth</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">recv_sgl_depth</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">ord</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">ird</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">qp_state</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">flags</span><span class="p">;</span>		<span class="cm">/* see c2wr_qp_flags_t */</span>
	<span class="n">u32</span> <span class="n">qp_id</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">local_addr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">remote_addr</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">local_port</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">remote_port</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">terminate_msg_length</span><span class="p">;</span>	<span class="cm">/* 0 if not present */</span>
	<span class="n">u8</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="cm">/* Terminate Message in-line here. */</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">union</span> <span class="n">c2wr_qp_query</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_qp_query_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_qp_query_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_qp_modify_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">stream_msg</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">stream_msg_length</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">qp_handle</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">next_qp_state</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">ord</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">ird</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">sq_depth</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">rq_depth</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">llp_ep_handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_qp_modify_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">ord</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">ird</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">sq_depth</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rq_depth</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">sq_msg_size</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">sq_mq_index</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">sq_mq_start</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rq_msg_size</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rq_mq_index</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rq_mq_start</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">union</span> <span class="n">c2wr_qp_modify</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_qp_modify_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_qp_modify_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_qp_destroy_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">qp_handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_qp_destroy_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">union</span> <span class="n">c2wr_qp_destroy</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_qp_destroy_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_qp_destroy_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * The CCWR_QP_CONNECT msg is posted on the verbs request queue.  It can</span>
<span class="cm"> * only be posted when a QP is in IDLE state.  After the connect request is</span>
<span class="cm"> * submitted to the LLP, the adapter moves the QP to CONNECT_PENDING state.</span>
<span class="cm"> * No synchronous reply from adapter to this WR.  The results of</span>
<span class="cm"> * connection are passed back in an async event CCAE_ACTIVE_CONNECT_RESULTS</span>
<span class="cm"> * See c2wr_ae_active_connect_results_t</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">c2wr_qp_connect_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">qp_handle</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">remote_addr</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">remote_port</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">pad</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">private_data_length</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">private_data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>	<span class="cm">/* Private data in-line. */</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_qp_connect</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_qp_connect_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="cm">/* no synchronous reply.         */</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>


<span class="cm">/*</span>
<span class="cm"> *------------------------ MM ------------------------</span>
<span class="cm"> */</span>

<span class="k">struct</span> <span class="n">c2wr_nsmr_stag_alloc_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pbl_depth</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pd_id</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">flags</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_nsmr_stag_alloc_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pbl_depth</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">stag_index</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">union</span> <span class="n">c2wr_nsmr_stag_alloc</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_nsmr_stag_alloc_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_nsmr_stag_alloc_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_nsmr_register_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">__be64</span> <span class="n">va</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">flags</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">stag_key</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">pad</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pd_id</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">pbl_depth</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">pbe_size</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">fbo</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">length</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">addrs_length</span><span class="p">;</span>
	<span class="cm">/* array of paddrs (must be aligned on a 64bit boundary) */</span>
	<span class="n">__be64</span> <span class="n">paddrs</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_nsmr_register_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pbl_depth</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">stag_index</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">union</span> <span class="n">c2wr_nsmr_register</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_nsmr_register_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_nsmr_register_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_nsmr_pbl_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">flags</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">stag_index</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">addrs_length</span><span class="p">;</span>
	<span class="cm">/* array of paddrs (must be aligned on a 64bit boundary) */</span>
	<span class="n">__be64</span> <span class="n">paddrs</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_nsmr_pbl_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">union</span> <span class="n">c2wr_nsmr_pbl</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_nsmr_pbl_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_nsmr_pbl_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_mr_query_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">stag_index</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_mr_query_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">stag_key</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">pad</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">pd_id</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">flags</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pbl_depth</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">union</span> <span class="n">c2wr_mr_query</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_mr_query_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_mr_query_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_mw_query_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">stag_index</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_mw_query_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">stag_key</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">pad</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">pd_id</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">flags</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">union</span> <span class="n">c2wr_mw_query</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_mw_query_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_mw_query_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>


<span class="k">struct</span> <span class="n">c2wr_stag_dealloc_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">stag_index</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_stag_dealloc_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">union</span> <span class="n">c2wr_stag_dealloc</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_stag_dealloc_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_stag_dealloc_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_nsmr_reregister_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">va</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">flags</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">stag_key</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">pad</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">stag_index</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pd_id</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pbl_depth</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pbe_size</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">fbo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">length</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">addrs_length</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pad1</span><span class="p">;</span>
	<span class="cm">/* array of paddrs (must be aligned on a 64bit boundary) */</span>
	<span class="n">u64</span> <span class="n">paddrs</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_nsmr_reregister_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pbl_depth</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">stag_index</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">union</span> <span class="n">c2wr_nsmr_reregister</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_nsmr_reregister_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_nsmr_reregister_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_smr_register_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">va</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">flags</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">stag_key</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">pad</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">stag_index</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pd_id</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_smr_register_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">stag_index</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">union</span> <span class="n">c2wr_smr_register</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_smr_register_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_smr_register_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_mw_alloc_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pd_id</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">c2wr_mw_alloc_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">stag_index</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">union</span> <span class="n">c2wr_mw_alloc</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_mw_alloc_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_mw_alloc_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> *------------------------ WRs -----------------------</span>
<span class="cm"> */</span>

<span class="k">struct</span> <span class="n">c2wr_user_hdr</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>		<span class="cm">/* Has status and WR Type */</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>

<span class="k">enum</span> <span class="n">c2_qp_state</span> <span class="p">{</span>
	<span class="n">C2_QP_STATE_IDLE</span> <span class="o">=</span> <span class="mh">0x01</span><span class="p">,</span>
	<span class="n">C2_QP_STATE_CONNECTING</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">,</span>
	<span class="n">C2_QP_STATE_RTS</span> <span class="o">=</span> <span class="mh">0x04</span><span class="p">,</span>
	<span class="n">C2_QP_STATE_CLOSING</span> <span class="o">=</span> <span class="mh">0x08</span><span class="p">,</span>
	<span class="n">C2_QP_STATE_TERMINATE</span> <span class="o">=</span> <span class="mh">0x10</span><span class="p">,</span>
	<span class="n">C2_QP_STATE_ERROR</span> <span class="o">=</span> <span class="mh">0x20</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* Completion queue entry. */</span>
<span class="k">struct</span> <span class="n">c2wr_ce</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>		<span class="cm">/* Has status and WR Type */</span>
	<span class="n">u64</span> <span class="n">qp_user_context</span><span class="p">;</span>	<span class="cm">/* c2_user_qp_t * */</span>
	<span class="n">u32</span> <span class="n">qp_state</span><span class="p">;</span>		<span class="cm">/* Current QP State */</span>
	<span class="n">u32</span> <span class="n">handle</span><span class="p">;</span>		<span class="cm">/* QPID or EP Handle */</span>
	<span class="n">__be32</span> <span class="n">bytes_rcvd</span><span class="p">;</span>		<span class="cm">/* valid for RECV WCs */</span>
	<span class="n">u32</span> <span class="n">stag</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="p">;</span>


<span class="cm">/*</span>
<span class="cm"> * Flags used for all post-sq WRs.  These must fit in the flags</span>
<span class="cm"> * field of the struct c2wr_hdr (eight bits).</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">SQ_SIGNALED</span> <span class="o">=</span> <span class="mh">0x01</span><span class="p">,</span>
	<span class="n">SQ_READ_FENCE</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">,</span>
	<span class="n">SQ_FENCE</span> <span class="o">=</span> <span class="mh">0x04</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Common fields for all post-sq WRs.  Namely the standard header and a</span>
<span class="cm"> * secondary header with fields common to all post-sq WRs.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">c2_sq_hdr</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_user_hdr</span> <span class="n">user_hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/*</span>
<span class="cm"> * Same as above but for post-rq WRs.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">c2_rq_hdr</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_user_hdr</span> <span class="n">user_hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/*</span>
<span class="cm"> * use the same struct for all sends.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">c2wr_send_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2_sq_hdr</span> <span class="n">sq_hdr</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">sge_len</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">remote_stag</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>		<span class="cm">/* SGE array */</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">union</span> <span class="n">c2wr_send</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_send_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_ce</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">c2wr_rdma_write_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2_sq_hdr</span> <span class="n">sq_hdr</span><span class="p">;</span>
	<span class="n">__be64</span> <span class="n">remote_to</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">remote_stag</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">sge_len</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>		<span class="cm">/* SGE array */</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">union</span> <span class="n">c2wr_rdma_write</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_rdma_write_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_ce</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">c2wr_rdma_read_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2_sq_hdr</span> <span class="n">sq_hdr</span><span class="p">;</span>
	<span class="n">__be64</span> <span class="n">local_to</span><span class="p">;</span>
	<span class="n">__be64</span> <span class="n">remote_to</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">local_stag</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">remote_stag</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">length</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">union</span> <span class="n">c2wr_rdma_read</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_rdma_read_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_ce</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">c2wr_mw_bind_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2_sq_hdr</span> <span class="n">sq_hdr</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">va</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">stag_key</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">pad</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">mw_stag_index</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">mr_stag_index</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">length</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">flags</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">union</span> <span class="n">c2wr_mw_bind</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_mw_bind_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_ce</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">c2wr_nsmr_fastreg_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2_sq_hdr</span> <span class="n">sq_hdr</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">va</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">stag_key</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">pad</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">stag_index</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pbe_size</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">fbo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">length</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">addrs_length</span><span class="p">;</span>
	<span class="cm">/* array of paddrs (must be aligned on a 64bit boundary) */</span>
	<span class="n">u64</span> <span class="n">paddrs</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">union</span> <span class="n">c2wr_nsmr_fastreg</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_nsmr_fastreg_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_ce</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">c2wr_stag_invalidate_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2_sq_hdr</span> <span class="n">sq_hdr</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">stag_key</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">pad</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">stag_index</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">union</span> <span class="n">c2wr_stag_invalidate</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_stag_invalidate_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_ce</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">union</span> <span class="n">c2wr_sqwr</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2_sq_hdr</span> <span class="n">sq_hdr</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_send_req</span> <span class="n">send</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_send_req</span> <span class="n">send_se</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_send_req</span> <span class="n">send_inv</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_send_req</span> <span class="n">send_se_inv</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_rdma_write_req</span> <span class="n">rdma_write</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_rdma_read_req</span> <span class="n">rdma_read</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_mw_bind_req</span> <span class="n">mw_bind</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_nsmr_fastreg_req</span> <span class="n">nsmr_fastreg</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_stag_invalidate_req</span> <span class="n">stag_inv</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>


<span class="cm">/*</span>
<span class="cm"> * RQ WRs</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">c2wr_rqwr</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2_rq_hdr</span> <span class="n">rq_hdr</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>		<span class="cm">/* array of SGEs */</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">union</span> <span class="n">c2wr_recv</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_rqwr</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_ce</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/*</span>
<span class="cm"> * All AEs start with this header.  Most AEs only need to convey the</span>
<span class="cm"> * information in the header.  Some, like LLP connection events, need</span>
<span class="cm"> * more info.  The union typdef c2wr_ae_t has all the possible AEs.</span>
<span class="cm"> *</span>
<span class="cm"> * hdr.context is the user_context from the rnic_open WR.  NULL If this</span>
<span class="cm"> * is not affiliated with an rnic</span>
<span class="cm"> *</span>
<span class="cm"> * hdr.id is the AE identifier (eg;  CCAE_REMOTE_SHUTDOWN,</span>
<span class="cm"> * CCAE_LLP_CLOSE_COMPLETE)</span>
<span class="cm"> *</span>
<span class="cm"> * resource_type is one of:  C2_RES_IND_QP, C2_RES_IND_CQ, C2_RES_IND_SRQ</span>
<span class="cm"> *</span>
<span class="cm"> * user_context is the context passed down when the host created the resource.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">c2wr_ae_hdr</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">user_context</span><span class="p">;</span>	<span class="cm">/* user context for this res. */</span>
	<span class="n">__be32</span> <span class="n">resource_type</span><span class="p">;</span>	<span class="cm">/* see enum c2_resource_indicator */</span>
	<span class="n">__be32</span> <span class="n">resource</span><span class="p">;</span>	<span class="cm">/* handle for resource */</span>
	<span class="n">__be32</span> <span class="n">qp_state</span><span class="p">;</span>	<span class="cm">/* current QP State */</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/*</span>
<span class="cm"> * After submitting the CCAE_ACTIVE_CONNECT_RESULTS message on the AEQ,</span>
<span class="cm"> * the adapter moves the QP into RTS state</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">c2wr_ae_active_connect_results</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_ae_hdr</span> <span class="n">ae_hdr</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">laddr</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">raddr</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">lport</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">rport</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">private_data_length</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">private_data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>	<span class="cm">/* data is in-line in the msg. */</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/*</span>
<span class="cm"> * When connections are established by the stack (and the private data</span>
<span class="cm"> * MPA frame is received), the adapter will generate an event to the host.</span>
<span class="cm"> * The details of the connection, any private data, and the new connection</span>
<span class="cm"> * request handle is passed up via the CCAE_CONNECTION_REQUEST msg on the</span>
<span class="cm"> * AE queue:</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">c2wr_ae_connection_request</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_ae_hdr</span> <span class="n">ae_hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">cr_handle</span><span class="p">;</span>		<span class="cm">/* connreq handle (sock ptr) */</span>
	<span class="n">__be32</span> <span class="n">laddr</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">raddr</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">lport</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">rport</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">private_data_length</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">private_data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>	<span class="cm">/* data is in-line in the msg. */</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">union</span> <span class="n">c2wr_ae</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_ae_hdr</span> <span class="n">ae_generic</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_ae_active_connect_results</span> <span class="n">ae_active_connect_results</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_ae_connection_request</span> <span class="n">ae_connection_request</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">c2wr_init_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">__be64</span> <span class="n">hint_count</span><span class="p">;</span>
	<span class="n">__be64</span> <span class="n">q0_host_shared</span><span class="p">;</span>
	<span class="n">__be64</span> <span class="n">q1_host_shared</span><span class="p">;</span>
	<span class="n">__be64</span> <span class="n">q1_host_msg_pool</span><span class="p">;</span>
	<span class="n">__be64</span> <span class="n">q2_host_shared</span><span class="p">;</span>
	<span class="n">__be64</span> <span class="n">q2_host_msg_pool</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">c2wr_init_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">union</span> <span class="n">c2wr_init</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_init_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_init_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/*</span>
<span class="cm"> * For upgrading flash.</span>
<span class="cm"> */</span>

<span class="k">struct</span> <span class="n">c2wr_flash_init_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">c2wr_flash_init_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">adapter_flash_buf_offset</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">adapter_flash_len</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">union</span> <span class="n">c2wr_flash_init</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_flash_init_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_flash_init_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">c2wr_flash_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">len</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">c2wr_flash_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">union</span> <span class="n">c2wr_flash</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_flash_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_flash_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">c2wr_buf_alloc_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">size</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">c2wr_buf_alloc_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">offset</span><span class="p">;</span>		<span class="cm">/* 0 if mem not available */</span>
	<span class="n">u32</span> <span class="n">size</span><span class="p">;</span>		<span class="cm">/* 0 if mem not available */</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">union</span> <span class="n">c2wr_buf_alloc</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_buf_alloc_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_buf_alloc_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">c2wr_buf_free_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">offset</span><span class="p">;</span>		<span class="cm">/* Must match value from alloc */</span>
	<span class="n">u32</span> <span class="n">size</span><span class="p">;</span>		<span class="cm">/* Must match value from alloc */</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">c2wr_buf_free_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">union</span> <span class="n">c2wr_buf_free</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_buf_free_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_ce</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">c2wr_flash_write_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">offset</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">size</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">type</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">flags</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">c2wr_flash_write_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">union</span> <span class="n">c2wr_flash_write</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_flash_write_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_flash_write_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/*</span>
<span class="cm"> * Messages for LLP connection setup.</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * Listen Request.  This allocates a listening endpoint to allow passive</span>
<span class="cm"> * connection setup.  Newly established LLP connections are passed up</span>
<span class="cm"> * via an AE.  See c2wr_ae_connection_request_t</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">c2wr_ep_listen_create_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">user_context</span><span class="p">;</span>	<span class="cm">/* returned in AEs. */</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">local_addr</span><span class="p">;</span>		<span class="cm">/* local addr, or 0  */</span>
	<span class="n">__be16</span> <span class="n">local_port</span><span class="p">;</span>		<span class="cm">/* 0 means &quot;pick one&quot; */</span>
	<span class="n">u16</span> <span class="n">pad</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">backlog</span><span class="p">;</span>		<span class="cm">/* tradional tcp listen bl */</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">c2wr_ep_listen_create_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">ep_handle</span><span class="p">;</span>		<span class="cm">/* handle to new listening ep */</span>
	<span class="n">u16</span> <span class="n">local_port</span><span class="p">;</span>		<span class="cm">/* resulting port... */</span>
	<span class="n">u16</span> <span class="n">pad</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">union</span> <span class="n">c2wr_ep_listen_create</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_ep_listen_create_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_ep_listen_create_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">c2wr_ep_listen_destroy_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">ep_handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">c2wr_ep_listen_destroy_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">union</span> <span class="n">c2wr_ep_listen_destroy</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_ep_listen_destroy_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_ep_listen_destroy_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">c2wr_ep_query_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">ep_handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">c2wr_ep_query_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">local_addr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">remote_addr</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">local_port</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">remote_port</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">union</span> <span class="n">c2wr_ep_query</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_ep_query_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_ep_query_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>


<span class="cm">/*</span>
<span class="cm"> * The host passes this down to indicate acceptance of a pending iWARP</span>
<span class="cm"> * connection.  The cr_handle was obtained from the CONNECTION_REQUEST</span>
<span class="cm"> * AE passed up by the adapter.  See c2wr_ae_connection_request_t.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">c2wr_cr_accept_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">qp_handle</span><span class="p">;</span>		<span class="cm">/* QP to bind to this LLP conn */</span>
	<span class="n">u32</span> <span class="n">ep_handle</span><span class="p">;</span>		<span class="cm">/* LLP  handle to accept */</span>
	<span class="n">__be32</span> <span class="n">private_data_length</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">private_data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>	<span class="cm">/* data in-line in msg. */</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/*</span>
<span class="cm"> * adapter sends reply when private data is successfully submitted to</span>
<span class="cm"> * the LLP.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">c2wr_cr_accept_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">union</span> <span class="n">c2wr_cr_accept</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_cr_accept_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_cr_accept_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/*</span>
<span class="cm"> * The host sends this down if a given iWARP connection request was</span>
<span class="cm"> * rejected by the consumer.  The cr_handle was obtained from a</span>
<span class="cm"> * previous c2wr_ae_connection_request_t AE sent by the adapter.</span>
<span class="cm"> */</span>
<span class="k">struct</span>  <span class="n">c2wr_cr_reject_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rnic_handle</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">ep_handle</span><span class="p">;</span>		<span class="cm">/* LLP handle to reject */</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/*</span>
<span class="cm"> * Dunno if this is needed, but we&#39;ll add it for now.  The adapter will</span>
<span class="cm"> * send the reject_reply after the LLP endpoint has been destroyed.</span>
<span class="cm"> */</span>
<span class="k">struct</span>  <span class="n">c2wr_cr_reject_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">union</span> <span class="n">c2wr_cr_reject</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_cr_reject_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_cr_reject_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/*</span>
<span class="cm"> * console command.  Used to implement a debug console over the verbs</span>
<span class="cm"> * request and reply queues.</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * Console request message.  It contains:</span>
<span class="cm"> *	- message hdr with id = CCWR_CONSOLE</span>
<span class="cm"> *	- the physaddr/len of host memory to be used for the reply.</span>
<span class="cm"> *	- the command string.  eg:  &quot;netstat -s&quot; or &quot;zoneinfo&quot;</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">c2wr_console_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>		<span class="cm">/* id = CCWR_CONSOLE */</span>
	<span class="n">u64</span> <span class="n">reply_buf</span><span class="p">;</span>		<span class="cm">/* pinned host buf for reply */</span>
	<span class="n">u32</span> <span class="n">reply_buf_len</span><span class="p">;</span>	<span class="cm">/* length of reply buffer */</span>
	<span class="n">u8</span> <span class="n">command</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>		<span class="cm">/* NUL terminated ascii string */</span>
	<span class="cm">/* containing the command req */</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/*</span>
<span class="cm"> * flags used in the console reply.</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">c2_console_flags</span> <span class="p">{</span>
	<span class="n">CONS_REPLY_TRUNCATED</span> <span class="o">=</span> <span class="mh">0x00000001</span>	<span class="cm">/* reply was truncated */</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/*</span>
<span class="cm"> * Console reply message.</span>
<span class="cm"> * hdr.result contains the c2_status_t error if the reply was _not_ generated,</span>
<span class="cm"> * or C2_OK if the reply was generated.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">c2wr_console_rep</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>		<span class="cm">/* id = CCWR_CONSOLE */</span>
	<span class="n">u32</span> <span class="n">flags</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">union</span> <span class="n">c2wr_console</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_console_req</span> <span class="n">req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_console_rep</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>


<span class="cm">/*</span>
<span class="cm"> * Giant union with all WRs.  Makes life easier...</span>
<span class="cm"> */</span>
<span class="k">union</span> <span class="n">c2wr</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_user_hdr</span> <span class="n">user_hdr</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_rnic_open</span> <span class="n">rnic_open</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_rnic_query</span> <span class="n">rnic_query</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_rnic_getconfig</span> <span class="n">rnic_getconfig</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_rnic_setconfig</span> <span class="n">rnic_setconfig</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_rnic_close</span> <span class="n">rnic_close</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_cq_create</span> <span class="n">cq_create</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_cq_modify</span> <span class="n">cq_modify</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_cq_destroy</span> <span class="n">cq_destroy</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_pd_alloc</span> <span class="n">pd_alloc</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_pd_dealloc</span> <span class="n">pd_dealloc</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_srq_create</span> <span class="n">srq_create</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_srq_destroy</span> <span class="n">srq_destroy</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_qp_create</span> <span class="n">qp_create</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_qp_query</span> <span class="n">qp_query</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_qp_modify</span> <span class="n">qp_modify</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_qp_destroy</span> <span class="n">qp_destroy</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_qp_connect</span> <span class="n">qp_connect</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_nsmr_stag_alloc</span> <span class="n">nsmr_stag_alloc</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_nsmr_register</span> <span class="n">nsmr_register</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_nsmr_pbl</span> <span class="n">nsmr_pbl</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_mr_query</span> <span class="n">mr_query</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_mw_query</span> <span class="n">mw_query</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_stag_dealloc</span> <span class="n">stag_dealloc</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_sqwr</span> <span class="n">sqwr</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_rqwr</span> <span class="n">rqwr</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">c2wr_ce</span> <span class="n">ce</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_ae</span> <span class="n">ae</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_init</span> <span class="n">init</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_ep_listen_create</span> <span class="n">ep_listen_create</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_ep_listen_destroy</span> <span class="n">ep_listen_destroy</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_cr_accept</span> <span class="n">cr_accept</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_cr_reject</span> <span class="n">cr_reject</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_console</span> <span class="n">console</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_flash_init</span> <span class="n">flash_init</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_flash</span> <span class="n">flash</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_buf_alloc</span> <span class="n">buf_alloc</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_buf_free</span> <span class="n">buf_free</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">c2wr_flash_write</span> <span class="n">flash_write</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>


<span class="cm">/*</span>
<span class="cm"> * Accessors for the wr fields that are packed together tightly to</span>
<span class="cm"> * reduce the wr message size.  The wr arguments are void* so that</span>
<span class="cm"> * either a struct c2wr*, a struct c2wr_hdr*, or a pointer to any of the types</span>
<span class="cm"> * in the struct c2wr union can be passed in.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="n">__inline__</span> <span class="n">u8</span> <span class="nf">c2_wr_get_id</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">wr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">((</span><span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="o">*</span><span class="p">)</span> <span class="n">wr</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">static</span> <span class="n">__inline__</span> <span class="kt">void</span> <span class="nf">c2_wr_set_id</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">wr</span><span class="p">,</span> <span class="n">u8</span> <span class="n">id</span><span class="p">)</span>
<span class="p">{</span>
	<span class="p">((</span><span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="o">*</span><span class="p">)</span> <span class="n">wr</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">id</span> <span class="o">=</span> <span class="n">id</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">static</span> <span class="n">__inline__</span> <span class="n">u8</span> <span class="nf">c2_wr_get_result</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">wr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">((</span><span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="o">*</span><span class="p">)</span> <span class="n">wr</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">static</span> <span class="n">__inline__</span> <span class="kt">void</span> <span class="nf">c2_wr_set_result</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">wr</span><span class="p">,</span> <span class="n">u8</span> <span class="n">result</span><span class="p">)</span>
<span class="p">{</span>
	<span class="p">((</span><span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="o">*</span><span class="p">)</span> <span class="n">wr</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">static</span> <span class="n">__inline__</span> <span class="n">u8</span> <span class="nf">c2_wr_get_flags</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">wr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">((</span><span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="o">*</span><span class="p">)</span> <span class="n">wr</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">static</span> <span class="n">__inline__</span> <span class="kt">void</span> <span class="nf">c2_wr_set_flags</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">wr</span><span class="p">,</span> <span class="n">u8</span> <span class="n">flags</span><span class="p">)</span>
<span class="p">{</span>
	<span class="p">((</span><span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="o">*</span><span class="p">)</span> <span class="n">wr</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">=</span> <span class="n">flags</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">static</span> <span class="n">__inline__</span> <span class="n">u8</span> <span class="nf">c2_wr_get_sge_count</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">wr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">((</span><span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="o">*</span><span class="p">)</span> <span class="n">wr</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">sge_count</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">static</span> <span class="n">__inline__</span> <span class="kt">void</span> <span class="nf">c2_wr_set_sge_count</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">wr</span><span class="p">,</span> <span class="n">u8</span> <span class="n">sge_count</span><span class="p">)</span>
<span class="p">{</span>
	<span class="p">((</span><span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="o">*</span><span class="p">)</span> <span class="n">wr</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">sge_count</span> <span class="o">=</span> <span class="n">sge_count</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">static</span> <span class="n">__inline__</span> <span class="n">__be32</span> <span class="nf">c2_wr_get_wqe_count</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">wr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">((</span><span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="o">*</span><span class="p">)</span> <span class="n">wr</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">wqe_count</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">static</span> <span class="n">__inline__</span> <span class="kt">void</span> <span class="nf">c2_wr_set_wqe_count</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">wr</span><span class="p">,</span> <span class="n">u32</span> <span class="n">wqe_count</span><span class="p">)</span>
<span class="p">{</span>
	<span class="p">((</span><span class="k">struct</span> <span class="n">c2wr_hdr</span> <span class="o">*</span><span class="p">)</span> <span class="n">wr</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">wqe_count</span> <span class="o">=</span> <span class="n">wqe_count</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#endif				</span><span class="cm">/* _C2_WR_H_ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
