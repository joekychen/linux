<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › atm › uPD98401.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>uPD98401.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/* drivers/atm/uPD98401.h - NEC uPD98401 (SAR) declarations */</span>
 
<span class="cm">/* Written 1995 by Werner Almesberger, EPFL LRC */</span>
 

<span class="cp">#ifndef DRIVERS_ATM_uPD98401_H</span>
<span class="cp">#define DRIVERS_ATM_uPD98401_H</span>


<span class="cp">#define MAX_CRAM_SIZE	(1 &lt;&lt; 18)	</span><span class="cm">/* 2^18 words */</span><span class="cp"></span>
<span class="cp">#define RAM_INCREMENT	1024		</span><span class="cm">/* check in 4 kB increments */</span><span class="cp"></span>

<span class="cp">#define uPD98401_PORTS	0x24		</span><span class="cm">/* probably more ? */</span><span class="cp"></span>


<span class="cm">/*</span>
<span class="cm"> * Commands</span>
<span class="cm"> */</span>

<span class="cp">#define uPD98401_OPEN_CHAN	0x20000000 </span><span class="cm">/* open channel */</span><span class="cp"></span>
<span class="cp">#define uPD98401_CHAN_ADDR	0x0003fff8 </span><span class="cm">/*	channel address */</span><span class="cp"></span>
<span class="cp">#define uPD98401_CHAN_ADDR_SHIFT 3</span>
<span class="cp">#define uPD98401_CLOSE_CHAN	0x24000000 </span><span class="cm">/* close channel */</span><span class="cp"></span>
<span class="cp">#define uPD98401_CHAN_RT	0x02000000 </span><span class="cm">/*	RX/TX (0 TX, 1 RX) */</span><span class="cp"></span>
<span class="cp">#define uPD98401_DEACT_CHAN	0x28000000 </span><span class="cm">/* deactivate channel */</span><span class="cp"></span>
<span class="cp">#define uPD98401_TX_READY	0x30000000 </span><span class="cm">/* TX ready */</span><span class="cp"></span>
<span class="cp">#define uPD98401_ADD_BAT	0x34000000 </span><span class="cm">/* add batches */</span><span class="cp"></span>
<span class="cp">#define uPD98401_POOL		0x000f0000 </span><span class="cm">/* pool number */</span><span class="cp"></span>
<span class="cp">#define uPD98401_POOL_SHIFT	16</span>
<span class="cp">#define uPD98401_POOL_NUMBAT	0x0000ffff </span><span class="cm">/* number of batches */</span><span class="cp"></span>
<span class="cp">#define uPD98401_NOP		0x3f000000 </span><span class="cm">/* NOP */</span><span class="cp"></span>
<span class="cp">#define uPD98401_IND_ACC	0x00000000 </span><span class="cm">/* Indirect Access */</span><span class="cp"></span>
<span class="cp">#define uPD98401_IA_RW		0x10000000 </span><span class="cm">/*	Read/Write (0 W, 1 R) */</span><span class="cp"></span>
<span class="cp">#define uPD98401_IA_B3		0x08000000 </span><span class="cm">/*	Byte select, 1 enable */</span><span class="cp"></span>
<span class="cp">#define uPD98401_IA_B2		0x04000000</span>
<span class="cp">#define uPD98401_IA_B1		0x02000000</span>
<span class="cp">#define uPD98401_IA_B0		0x01000000</span>
<span class="cp">#define uPD98401_IA_BALL	0x0f000000 </span><span class="cm">/*   whole longword */</span><span class="cp"></span>
<span class="cp">#define uPD98401_IA_TGT		0x000c0000 </span><span class="cm">/*	Target */</span><span class="cp"></span>
<span class="cp">#define uPD98401_IA_TGT_SHIFT	18</span>
<span class="cp">#define uPD98401_IA_TGT_CM	0	   </span><span class="cm">/*	- Control Memory */</span><span class="cp"></span>
<span class="cp">#define uPD98401_IA_TGT_SAR	1	   </span><span class="cm">/*	- uPD98401 registers */</span><span class="cp"></span>
<span class="cp">#define uPD98401_IA_TGT_PHY	3	   </span><span class="cm">/*   - PHY device */</span><span class="cp"></span>
<span class="cp">#define uPD98401_IA_ADDR	0x0003ffff</span>

<span class="cm">/*</span>
<span class="cm"> * Command Register Status</span>
<span class="cm"> */</span>

<span class="cp">#define uPD98401_BUSY		0x80000000 </span><span class="cm">/* SAR is busy */</span><span class="cp"></span>
<span class="cp">#define uPD98401_LOCKED		0x40000000 </span><span class="cm">/* SAR is locked by other CPU */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Indications</span>
<span class="cm"> */</span>

<span class="cm">/* Normal (AAL5) Receive Indication */</span>
<span class="cp">#define uPD98401_AAL5_UINFO	0xffff0000 </span><span class="cm">/* user-supplied information */</span><span class="cp"></span>
<span class="cp">#define uPD98401_AAL5_UINFO_SHIFT 16</span>
<span class="cp">#define uPD98401_AAL5_SIZE	0x0000ffff </span><span class="cm">/* PDU size (in _CELLS_ !!) */</span><span class="cp"></span>
<span class="cp">#define uPD98401_AAL5_CHAN	0x7fff0000 </span><span class="cm">/* Channel number */</span><span class="cp"></span>
<span class="cp">#define uPD98401_AAL5_CHAN_SHIFT	16</span>
<span class="cp">#define uPD98401_AAL5_ERR	0x00008000 </span><span class="cm">/* Error indication */</span><span class="cp"></span>
<span class="cp">#define uPD98401_AAL5_CI	0x00004000 </span><span class="cm">/* Congestion Indication */</span><span class="cp"></span>
<span class="cp">#define uPD98401_AAL5_CLP	0x00002000 </span><span class="cm">/* CLP (&gt;= 1 cell had CLP=1) */</span><span class="cp"></span>
<span class="cp">#define uPD98401_AAL5_ES	0x00000f00 </span><span class="cm">/* Error Status */</span><span class="cp"></span>
<span class="cp">#define uPD98401_AAL5_ES_SHIFT	8</span>
<span class="cp">#define uPD98401_AAL5_ES_NONE	0	   </span><span class="cm">/*	No error */</span><span class="cp"></span>
<span class="cp">#define uPD98401_AAL5_ES_FREE	1	   </span><span class="cm">/*	Receiver free buf underflow */</span><span class="cp"></span>
<span class="cp">#define uPD98401_AAL5_ES_FIFO	2	   </span><span class="cm">/*	Receiver FIFO overrun */</span><span class="cp"></span>
<span class="cp">#define uPD98401_AAL5_ES_TOOBIG	3	   </span><span class="cm">/*	Maximum length violation */</span><span class="cp"></span>
<span class="cp">#define uPD98401_AAL5_ES_CRC	4	   </span><span class="cm">/*	CRC error */</span><span class="cp"></span>
<span class="cp">#define uPD98401_AAL5_ES_ABORT	5	   </span><span class="cm">/*	User abort */</span><span class="cp"></span>
<span class="cp">#define uPD98401_AAL5_ES_LENGTH	6	   </span><span class="cm">/*   Length violation */</span><span class="cp"></span>
<span class="cp">#define uPD98401_AAL5_ES_T1	7	   </span><span class="cm">/*	T1 error (timeout) */</span><span class="cp"></span>
<span class="cp">#define uPD98401_AAL5_ES_DEACT	8	   </span><span class="cm">/*	Deactivated with DEACT_CHAN */</span><span class="cp"></span>
<span class="cp">#define uPD98401_AAL5_POOL	0x0000001f </span><span class="cm">/* Free buffer pool number */</span><span class="cp"></span>

<span class="cm">/* Raw Cell Indication */</span>
<span class="cp">#define uPD98401_RAW_UINFO	uPD98401_AAL5_UINFO</span>
<span class="cp">#define uPD98401_RAW_UINFO_SHIFT uPD98401_AAL5_UINFO_SHIFT</span>
<span class="cp">#define uPD98401_RAW_HEC	0x000000ff </span><span class="cm">/* HEC */</span><span class="cp"></span>
<span class="cp">#define uPD98401_RAW_CHAN	uPD98401_AAL5_CHAN</span>
<span class="cp">#define uPD98401_RAW_CHAN_SHIFT uPD98401_AAL5_CHAN_SHIFT</span>

<span class="cm">/* Transmit Indication */</span>
<span class="cp">#define uPD98401_TXI_CONN	0x7fff0000 </span><span class="cm">/* Connection Number */</span><span class="cp"></span>
<span class="cp">#define uPD98401_TXI_CONN_SHIFT	16</span>
<span class="cp">#define uPD98401_TXI_ACTIVE	0x00008000 </span><span class="cm">/* Channel remains active */</span><span class="cp"></span>
<span class="cp">#define uPD98401_TXI_PQP	0x00007fff </span><span class="cm">/* Packet Queue Pointer */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Directly Addressable Registers</span>
<span class="cm"> */</span>

<span class="cp">#define uPD98401_GMR	0x00	</span><span class="cm">/* General Mode Register */</span><span class="cp"></span>
<span class="cp">#define uPD98401_GSR	0x01	</span><span class="cm">/* General Status Register */</span><span class="cp"></span>
<span class="cp">#define uPD98401_IMR	0x02	</span><span class="cm">/* Interrupt Mask Register */</span><span class="cp"></span>
<span class="cp">#define uPD98401_RQU	0x03	</span><span class="cm">/* Receive Queue Underrun */</span><span class="cp"></span>
<span class="cp">#define uPD98401_RQA	0x04	</span><span class="cm">/* Receive Queue Alert */</span><span class="cp"></span>
<span class="cp">#define uPD98401_ADDR	0x05	</span><span class="cm">/* Last Burst Address */</span><span class="cp"></span>
<span class="cp">#define uPD98401_VER	0x06	</span><span class="cm">/* Version Number */</span><span class="cp"></span>
<span class="cp">#define uPD98401_SWR	0x07	</span><span class="cm">/* Software Reset */</span><span class="cp"></span>
<span class="cp">#define uPD98401_CMR	0x08	</span><span class="cm">/* Command Register */</span><span class="cp"></span>
<span class="cp">#define uPD98401_CMR_L	0x09	</span><span class="cm">/* Command Register and Lock/Unlock */</span><span class="cp"></span>
<span class="cp">#define uPD98401_CER	0x0a	</span><span class="cm">/* Command Extension Register */</span><span class="cp"></span>
<span class="cp">#define uPD98401_CER_L	0x0b	</span><span class="cm">/* Command Ext Reg and Lock/Unlock */</span><span class="cp"></span>

<span class="cp">#define uPD98401_MSH(n) (0x10+(n))	</span><span class="cm">/* Mailbox n Start Address High */</span><span class="cp"></span>
<span class="cp">#define uPD98401_MSL(n) (0x14+(n))	</span><span class="cm">/* Mailbox n Start Address High */</span><span class="cp"></span>
<span class="cp">#define uPD98401_MBA(n) (0x18+(n))	</span><span class="cm">/* Mailbox n Bottom Address */</span><span class="cp"></span>
<span class="cp">#define uPD98401_MTA(n) (0x1c+(n))	</span><span class="cm">/* Mailbox n Tail Address */</span><span class="cp"></span>
<span class="cp">#define uPD98401_MWA(n) (0x20+(n))	</span><span class="cm">/* Mailbox n Write Address */</span><span class="cp"></span>

<span class="cm">/* GMR is at 0x00 */</span>
<span class="cp">#define uPD98401_GMR_ONE	0x80000000 </span><span class="cm">/* Must be set to one */</span><span class="cp"></span>
<span class="cp">#define uPD98401_GMR_SLM	0x40000000 </span><span class="cm">/* Address mode (0 word, 1 byte) */</span><span class="cp"></span>
<span class="cp">#define uPD98401_GMR_CPE	0x00008000 </span><span class="cm">/* Control Memory Parity Enable */</span><span class="cp"></span>
<span class="cp">#define uPD98401_GMR_LP		0x00004000 </span><span class="cm">/* Loopback */</span><span class="cp"></span>
<span class="cp">#define uPD98401_GMR_WA		0x00002000 </span><span class="cm">/* Early Bus Write Abort/RDY */</span><span class="cp"></span>
<span class="cp">#define uPD98401_GMR_RA		0x00001000 </span><span class="cm">/* Early Read Abort/RDY */</span><span class="cp"></span>
<span class="cp">#define uPD98401_GMR_SZ		0x00000f00 </span><span class="cm">/* Burst Size Enable */</span><span class="cp"></span>
<span class="cp">#define uPD98401_BURST16	0x00000800 </span><span class="cm">/*	16-word burst */</span><span class="cp"></span>
<span class="cp">#define uPD98401_BURST8		0x00000400 </span><span class="cm">/*	 8-word burst */</span><span class="cp"></span>
<span class="cp">#define uPD98401_BURST4		0x00000200 </span><span class="cm">/*	 4-word burst */</span><span class="cp"></span>
<span class="cp">#define uPD98401_BURST2		0x00000100 </span><span class="cm">/*	 2-word burst */</span><span class="cp"></span>
<span class="cp">#define uPD98401_GMR_AD		0x00000080 </span><span class="cm">/* Address (burst resolution) Disable */</span><span class="cp"></span>
<span class="cp">#define uPD98401_GMR_BO		0x00000040 </span><span class="cm">/* Byte Order (0 little, 1 big) */</span><span class="cp"></span>
<span class="cp">#define uPD98401_GMR_PM		0x00000020 </span><span class="cm">/* Bus Parity Mode (0 byte, 1 word)*/</span><span class="cp"></span>
<span class="cp">#define uPD98401_GMR_PC		0x00000010 </span><span class="cm">/* Bus Parity Control (0even,1odd) */</span><span class="cp"></span>
<span class="cp">#define uPD98401_GMR_BPE	0x00000008 </span><span class="cm">/* Bus Parity Enable */</span><span class="cp"></span>
<span class="cp">#define uPD98401_GMR_DR		0x00000004 </span><span class="cm">/* Receive Drop Mode (0drop,1don&#39;t)*/</span><span class="cp"></span>
<span class="cp">#define uPD98401_GMR_SE		0x00000002 </span><span class="cm">/* Shapers Enable */</span><span class="cp"></span>
<span class="cp">#define uPD98401_GMR_RE		0x00000001 </span><span class="cm">/* Receiver Enable */</span><span class="cp"></span>

<span class="cm">/* GSR is at 0x01, IMR is at 0x02 */</span>
<span class="cp">#define uPD98401_INT_PI		0x80000000 </span><span class="cm">/* PHY interrupt */</span><span class="cp"></span>
<span class="cp">#define uPD98401_INT_RQA	0x40000000 </span><span class="cm">/* Receive Queue Alert */</span><span class="cp"></span>
<span class="cp">#define uPD98401_INT_RQU	0x20000000 </span><span class="cm">/* Receive Queue Underrun */</span><span class="cp"></span>
<span class="cp">#define uPD98401_INT_RD		0x10000000 </span><span class="cm">/* Receiver Deactivated */</span><span class="cp"></span>
<span class="cp">#define uPD98401_INT_SPE	0x08000000 </span><span class="cm">/* System Parity Error */</span><span class="cp"></span>
<span class="cp">#define uPD98401_INT_CPE	0x04000000 </span><span class="cm">/* Control Memory Parity Error */</span><span class="cp"></span>
<span class="cp">#define uPD98401_INT_SBE	0x02000000 </span><span class="cm">/* System Bus Error */</span><span class="cp"></span>
<span class="cp">#define uPD98401_INT_IND	0x01000000 </span><span class="cm">/* Initialization Done */</span><span class="cp"></span>
<span class="cp">#define uPD98401_INT_RCR	0x0000ff00 </span><span class="cm">/* Raw Cell Received */</span><span class="cp"></span>
<span class="cp">#define uPD98401_INT_RCR_SHIFT	8</span>
<span class="cp">#define uPD98401_INT_MF		0x000000f0 </span><span class="cm">/* Mailbox Full */</span><span class="cp"></span>
<span class="cp">#define uPD98401_INT_MF_SHIFT	4</span>
<span class="cp">#define uPD98401_INT_MM		0x0000000f </span><span class="cm">/* Mailbox Modified */</span><span class="cp"></span>

<span class="cm">/* VER is at 0x06 */</span>
<span class="cp">#define uPD98401_MAJOR		0x0000ff00 </span><span class="cm">/* Major revision */</span><span class="cp"></span>
<span class="cp">#define uPD98401_MAJOR_SHIFT	8</span>
<span class="cp">#define uPD98401_MINOR		0x000000ff </span><span class="cm">/* Minor revision */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Indirectly Addressable Registers</span>
<span class="cm"> */</span>

<span class="cp">#define uPD98401_IM(n)	(0x40000+(n))	</span><span class="cm">/* Scheduler n I and M */</span><span class="cp"></span>
<span class="cp">#define uPD98401_X(n)	(0x40010+(n))	</span><span class="cm">/* Scheduler n X */</span><span class="cp"></span>
<span class="cp">#define uPD98401_Y(n)	(0x40020+(n))	</span><span class="cm">/* Scheduler n Y */</span><span class="cp"></span>
<span class="cp">#define uPD98401_PC(n)	(0x40030+(n))	</span><span class="cm">/* Scheduler n P, C, p and c */</span><span class="cp"></span>
<span class="cp">#define uPD98401_PS(n)	(0x40040+(n))	</span><span class="cm">/* Scheduler n priority and status */</span><span class="cp"></span>

<span class="cm">/* IM contents */</span>
<span class="cp">#define uPD98401_IM_I		0xff000000 </span><span class="cm">/* I */</span><span class="cp"></span>
<span class="cp">#define uPD98401_IM_I_SHIFT	24</span>
<span class="cp">#define uPD98401_IM_M		0x00ffffff </span><span class="cm">/* M */</span><span class="cp"></span>

<span class="cm">/* PC contents */</span>
<span class="cp">#define uPD98401_PC_P		0xff000000 </span><span class="cm">/* P */</span><span class="cp"></span>
<span class="cp">#define uPD98401_PC_P_SHIFT	24</span>
<span class="cp">#define uPD98401_PC_C		0x00ff0000 </span><span class="cm">/* C */</span><span class="cp"></span>
<span class="cp">#define uPD98401_PC_C_SHIFT	16</span>
<span class="cp">#define uPD98401_PC_p		0x0000ff00 </span><span class="cm">/* p */</span><span class="cp"></span>
<span class="cp">#define uPD98401_PC_p_SHIFT	8</span>
<span class="cp">#define uPD98401_PC_c		0x000000ff </span><span class="cm">/* c */</span><span class="cp"></span>

<span class="cm">/* PS contents */</span>
<span class="cp">#define uPD98401_PS_PRIO	0xf0	</span><span class="cm">/* Priority level (0 high, 15 low) */</span><span class="cp"></span>
<span class="cp">#define uPD98401_PS_PRIO_SHIFT	4</span>
<span class="cp">#define uPD98401_PS_S		0x08	</span><span class="cm">/* Scan - must be 0 (internal) */</span><span class="cp"></span>
<span class="cp">#define uPD98401_PS_R		0x04	</span><span class="cm">/* Round Robin (internal) */</span><span class="cp"></span>
<span class="cp">#define uPD98401_PS_A		0x02	</span><span class="cm">/* Active (internal) */</span><span class="cp"></span>
<span class="cp">#define uPD98401_PS_E		0x01	</span><span class="cm">/* Enabled */</span><span class="cp"></span>

<span class="cp">#define uPD98401_TOS	0x40100	</span><span class="cm">/* Top of Stack Control Memory Address */</span><span class="cp"></span>
<span class="cp">#define uPD98401_SMA	0x40200	</span><span class="cm">/* Shapers Control Memory Start Address */</span><span class="cp"></span>
<span class="cp">#define uPD98401_PMA	0x40201	</span><span class="cm">/* Receive Pool Control Memory Start Address */</span><span class="cp"></span>
<span class="cp">#define uPD98401_T1R	0x40300	</span><span class="cm">/* T1 Register */</span><span class="cp"></span>
<span class="cp">#define uPD98401_VRR	0x40301	</span><span class="cm">/* VPI/VCI Reduction Register/Recv. Shutdown */</span><span class="cp"></span>
<span class="cp">#define uPD98401_TSR	0x40302	</span><span class="cm">/* Time-Stamp Register */</span><span class="cp"></span>

<span class="cm">/* VRR is at 0x40301 */</span>
<span class="cp">#define uPD98401_VRR_SDM	0x80000000 </span><span class="cm">/* Shutdown Mode */</span><span class="cp"></span>
<span class="cp">#define uPD98401_VRR_SHIFT	0x000f0000 </span><span class="cm">/* VPI/VCI Shift */</span><span class="cp"></span>
<span class="cp">#define uPD98401_VRR_SHIFT_SHIFT 16</span>
<span class="cp">#define uPD98401_VRR_MASK	0x0000ffff </span><span class="cm">/* VPI/VCI mask */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * TX packet descriptor</span>
<span class="cm"> */</span>

<span class="cp">#define uPD98401_TXPD_SIZE	16	   </span><span class="cm">/* descriptor size (in bytes) */</span><span class="cp"></span>

<span class="cp">#define uPD98401_TXPD_V		0x80000000 </span><span class="cm">/* Valid bit */</span><span class="cp"></span>
<span class="cp">#define uPD98401_TXPD_DP	0x40000000 </span><span class="cm">/* Descriptor (1) or Pointer (0) */</span><span class="cp"></span>
<span class="cp">#define uPD98401_TXPD_SM	0x20000000 </span><span class="cm">/* Single (1) or Multiple (0) */</span><span class="cp"></span>
<span class="cp">#define uPD98401_TXPD_CLPM	0x18000000 </span><span class="cm">/* CLP mode */</span><span class="cp"></span>
<span class="cp">#define uPD98401_CLPM_0		0	   </span><span class="cm">/*	00 CLP = 0 */</span><span class="cp"></span>
<span class="cp">#define uPD98401_CLPM_1		3	   </span><span class="cm">/*	11 CLP = 1 */</span><span class="cp"></span>
<span class="cp">#define uPD98401_CLPM_LAST	1	   </span><span class="cm">/*	01 CLP unless last cell */</span><span class="cp"></span>
<span class="cp">#define uPD98401_TXPD_CLPM_SHIFT 27</span>
<span class="cp">#define uPD98401_TXPD_PTI	0x07000000 </span><span class="cm">/* PTI pattern */</span><span class="cp"></span>
<span class="cp">#define uPD98401_TXPD_PTI_SHIFT	24</span>
<span class="cp">#define uPD98401_TXPD_GFC	0x00f00000 </span><span class="cm">/* GFC pattern */</span><span class="cp"></span>
<span class="cp">#define uPD98401_TXPD_GFC_SHIFT	20</span>
<span class="cp">#define uPD98401_TXPD_C10	0x00040000 </span><span class="cm">/* insert CRC-10 */</span><span class="cp"></span>
<span class="cp">#define uPD98401_TXPD_AAL5	0x00020000 </span><span class="cm">/* AAL5 processing */</span><span class="cp"></span>
<span class="cp">#define uPD98401_TXPD_MB	0x00010000 </span><span class="cm">/* TX mailbox number */</span><span class="cp"></span>
<span class="cp">#define uPD98401_TXPD_UU	0x0000ff00 </span><span class="cm">/* CPCS-UU */</span><span class="cp"></span>
<span class="cp">#define uPD98401_TXPD_UU_SHIFT	8</span>
<span class="cp">#define uPD98401_TXPD_CPI	0x000000ff </span><span class="cm">/* CPI */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * TX buffer descriptor</span>
<span class="cm"> */</span>

<span class="cp">#define uPD98401_TXBD_SIZE	8	   </span><span class="cm">/* descriptor size (in bytes) */</span><span class="cp"></span>

<span class="cp">#define uPD98401_TXBD_LAST	0x80000000 </span><span class="cm">/* last buffer in packet */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * TX VC table</span>
<span class="cm"> */</span>

<span class="cm">/* 1st word has the same structure as in a TX packet descriptor */</span>
<span class="cp">#define uPD98401_TXVC_L		0x80000000 </span><span class="cm">/* last buffer */</span><span class="cp"></span>
<span class="cp">#define uPD98401_TXVC_SHP	0x0f000000 </span><span class="cm">/* shaper number */</span><span class="cp"></span>
<span class="cp">#define uPD98401_TXVC_SHP_SHIFT	24</span>
<span class="cp">#define uPD98401_TXVC_VPI	0x00ff0000 </span><span class="cm">/* VPI */</span><span class="cp"></span>
<span class="cp">#define uPD98401_TXVC_VPI_SHIFT	16</span>
<span class="cp">#define uPD98401_TXVC_VCI	0x0000ffff </span><span class="cm">/* VCI */</span><span class="cp"></span>
<span class="cp">#define uPD98401_TXVC_QRP	6	   </span><span class="cm">/* Queue Read Pointer is in word 6 */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * RX free buffer pools descriptor</span>
<span class="cm"> */</span>

<span class="cp">#define uPD98401_RXFP_ALERT	0x70000000 </span><span class="cm">/* low water mark */</span><span class="cp"></span>
<span class="cp">#define uPD98401_RXFP_ALERT_SHIFT 28</span>
<span class="cp">#define uPD98401_RXFP_BFSZ	0x0f000000 </span><span class="cm">/* buffer size, 64*2^n */</span><span class="cp"></span>
<span class="cp">#define uPD98401_RXFP_BFSZ_SHIFT 24</span>
<span class="cp">#define uPD98401_RXFP_BTSZ	0x00ff0000 </span><span class="cm">/* batch size, n+1 */</span><span class="cp"></span>
<span class="cp">#define uPD98401_RXFP_BTSZ_SHIFT 16</span>
<span class="cp">#define uPD98401_RXFP_REMAIN	0x0000ffff </span><span class="cm">/* remaining batches in pool */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * RX VC table</span>
<span class="cm"> */</span>

<span class="cp">#define uPD98401_RXVC_BTSZ	0xff000000 </span><span class="cm">/* remaining free buffers in batch */</span><span class="cp"></span>
<span class="cp">#define uPD98401_RXVC_BTSZ_SHIFT 24</span>
<span class="cp">#define uPD98401_RXVC_MB	0x00200000 </span><span class="cm">/* RX mailbox number */</span><span class="cp"></span>
<span class="cp">#define uPD98401_RXVC_POOL	0x001f0000 </span><span class="cm">/* free buffer pool number */</span><span class="cp"></span>
<span class="cp">#define uPD98401_RXVC_POOL_SHIFT 16</span>
<span class="cp">#define uPD98401_RXVC_UINFO	0x0000ffff </span><span class="cm">/* user-supplied information */</span><span class="cp"></span>
<span class="cp">#define uPD98401_RXVC_T1	0xffff0000 </span><span class="cm">/* T1 timestamp */</span><span class="cp"></span>
<span class="cp">#define uPD98401_RXVC_T1_SHIFT	16</span>
<span class="cp">#define uPD98401_RXVC_PR	0x00008000 </span><span class="cm">/* Packet Reception, 1 if busy */</span><span class="cp"></span>
<span class="cp">#define uPD98401_RXVC_DR	0x00004000 </span><span class="cm">/* FIFO Drop */</span><span class="cp"></span>
<span class="cp">#define uPD98401_RXVC_OD	0x00001000 </span><span class="cm">/* Drop OAM cells */</span><span class="cp"></span>
<span class="cp">#define uPD98401_RXVC_AR	0x00000800 </span><span class="cm">/* AAL5 or raw cell; 1 if AAL5 */</span><span class="cp"></span>
<span class="cp">#define uPD98401_RXVC_MAXSEG	0x000007ff </span><span class="cm">/* max number of segments per PDU */</span><span class="cp"></span>
<span class="cp">#define uPD98401_RXVC_REM	0xfffe0000 </span><span class="cm">/* remaining words in curr buffer */</span><span class="cp"></span>
<span class="cp">#define uPD98401_RXVC_REM_SHIFT	17</span>
<span class="cp">#define uPD98401_RXVC_CLP	0x00010000 </span><span class="cm">/* CLP received */</span><span class="cp"></span>
<span class="cp">#define uPD98401_RXVC_BFA	0x00008000 </span><span class="cm">/* Buffer Assigned */</span><span class="cp"></span>
<span class="cp">#define uPD98401_RXVC_BTA	0x00004000 </span><span class="cm">/* Batch Assigned */</span><span class="cp"></span>
<span class="cp">#define uPD98401_RXVC_CI	0x00002000 </span><span class="cm">/* Congestion Indication */</span><span class="cp"></span>
<span class="cp">#define uPD98401_RXVC_DD	0x00001000 </span><span class="cm">/* Dropping incoming cells */</span><span class="cp"></span>
<span class="cp">#define uPD98401_RXVC_DP	0x00000800 </span><span class="cm">/* like PR ? */</span><span class="cp"></span>
<span class="cp">#define uPD98401_RXVC_CURSEG	0x000007ff </span><span class="cm">/* Current Segment count */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * RX lookup table</span>
<span class="cm"> */</span>

<span class="cp">#define uPD98401_RXLT_ENBL	0x8000	   </span><span class="cm">/* Enable */</span><span class="cp"></span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
