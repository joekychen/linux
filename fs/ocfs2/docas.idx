d | cluster |  | 19 items |  | Pavel Emelyanov | xemul@parallels.com | 1335037945 |  | sock: Introduce named constants for sk_reuse  Name them in a "backward compatible" manner, i.e. reuse or not are still 1 and 0 respectively. The reuse value of 2 means that the socket with it will forcibly reuse everyone else's port.  Signed-off-by: Pavel Emelyanov <xemul@openvz.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | dir.c | s | 115K | 3908 | Linus Torvalds | torvalds@linux-foundation.org | 1322780134 |  | Merge branch 'upstream-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/jlbec/ocfs2  * 'upstream-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/jlbec/ocfs2: (31 commits)   ocfs2: avoid unaligned access to dqc_bitmap   ocfs2: Use filemap_write_and_wait() instead of write_inode_now()   ocfs2: honor O_(D)SYNC flag in fallocate   ocfs2: Add a missing journal credit in ocfs2_link_credits() -v2   ocfs2: send correct UUID to cleancache initialization   ocfs2: Commit transactions in error cases -v2   ocfs2: make direntry invalid when deleting it   fs/ocfs2/dlm/dlmlock.c: free kmem_cache_zalloc'd data using kmem_cache_free   ocfs2: Avoid livelock in ocfs2_readpage()   ocfs2: serialize unaligned aio   ocfs2: Implement llseek()   ocfs2: Fix ocfs2_page_mkwrite()   ocfs2: Add comment about orphan scanning   ocfs2: Clean up messages in the fs   ocfs2/cluster: Cluster up now includes network connections too   ocfs2/cluster: Add new function o2net_fill_node_map()   ocfs2/cluster: Fix output in file elapsed_time_in_ms   ocfs2/dlm: dlmlock_remote() needs to account for remastery   ocfs2/dlm: Take inflight reference count for remotely mastered resources too   ocfs2/dlm: Cleanup dlm_wait_for_node_death() and dlm_wait_for_node_recovery()   ...
f | ocfs2_fs.h | s | 50K | 1429 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1303885871 |  | Revert wrong fixes for common misspellings  These changes were incorrectly fixed by codespell. They were now manually corrected.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | slot_map.c | s | 12K | 443 | Sunil Mushran | sunil.mushran@oracle.com | 1311528894 |  | ocfs2: Clean up messages in the fs  Convert useful messages from ML_NOTICE to KERN_NOTICE to improve readability.  Signed-off-by: Sunil Mushran <sunil.mushran@oracle.com>
d | dlm |  | 17 items |  | Al Viro | viro@zeniv.linux.org.uk | 1338348514 |  | ocfs2: trivial endianness misannotations  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | suballoc.c | s | 76K | 2506 | Al Viro | viro@zeniv.linux.org.uk | 1334334703 |  | ocfs2: ->e_leaf_clusters endianness breakage  le16, not le32...  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | Makefile | g | 1.0K |  | Tristan Ye | tristan.ye@oracle.com | 1306307828 |  | Ocfs2/move_extents: Add basic framework and source files for extent moving.  Adding new files move_extents.[c||h] and fill it with nothing but only a context structure.  Signed-off-by: Tristan Ye <tristan.ye@oracle.com>
f | uptodate.c | s | 17K | 530 | Tao Ma | boyu.mt@taobao.com | 1298535740 |  | ocfs2: Remove masklog ML_UPTODATE.  Remove mlog(0,...) and mlog(ML_UPTODATE,...) from fs/ocfs2/uptodate.c and fs/ocfs2/buffer_head_io.c.  The masklog UPTODATE is removed finally.  Signed-off-by: Tao Ma <boyu.mt@taobao.com>
f | dlmglue.c | s | 113K | 3406 | Linus Torvalds | torvalds@linux-foundation.org | 1322780134 |  | Merge branch 'upstream-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/jlbec/ocfs2  * 'upstream-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/jlbec/ocfs2: (31 commits)   ocfs2: avoid unaligned access to dqc_bitmap   ocfs2: Use filemap_write_and_wait() instead of write_inode_now()   ocfs2: honor O_(D)SYNC flag in fallocate   ocfs2: Add a missing journal credit in ocfs2_link_credits() -v2   ocfs2: send correct UUID to cleancache initialization   ocfs2: Commit transactions in error cases -v2   ocfs2: make direntry invalid when deleting it   fs/ocfs2/dlm/dlmlock.c: free kmem_cache_zalloc'd data using kmem_cache_free   ocfs2: Avoid livelock in ocfs2_readpage()   ocfs2: serialize unaligned aio   ocfs2: Implement llseek()   ocfs2: Fix ocfs2_page_mkwrite()   ocfs2: Add comment about orphan scanning   ocfs2: Clean up messages in the fs   ocfs2/cluster: Cluster up now includes network connections too   ocfs2/cluster: Add new function o2net_fill_node_map()   ocfs2/cluster: Fix output in file elapsed_time_in_ms   ocfs2/dlm: dlmlock_remote() needs to account for remastery   ocfs2/dlm: Take inflight reference count for remotely mastered resources too   ocfs2/dlm: Cleanup dlm_wait_for_node_death() and dlm_wait_for_node_recovery()   ...
f | resize.c | s | 15K | 499 | Tao Ma | boyu.mt@taobao.com | 1298332887 |  | ocfs2: Remove DISK_ALLOC from masklog.  Since all 4 files, localalloc.c, suballoc.c, alloc.c and resize.c, which use DISK_ALLOC are changed to trace events, Remove masklog DISK_ALLOC totally.  Signed-off-by: Tao Ma <boyu.mt@taobao.com>
f | reservations.h | s | 5.3K | 135 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | slot_map.h | s | 1.4K | 36 | Joel Becker | joel.becker@oracle.com | 1208534163 |  | ocfs2: De-magic the in-memory slot map.  The in-memory slot map uses the same magic as the on-disk one.  There is a special value to mark a slot as invalid.  It relies on the size of certain types and so on.  Write a new in-memory map that keeps validity as a separate field.  Outside of the I/O functions, OCFS2_INVALID_SLOT now means what it is supposed to. It also is no longer tied to the type size.  This also means that only the I/O functions refer to 16bit quantities.  Signed-off-by: Joel Becker <joel.becker@oracle.com> Signed-off-by: Mark Fasheh <mfasheh@suse.com>
d | dlmfs |  | 6 items |  | Jan Kara | jack@suse.cz | 1336283021 |  | vfs: Rename end_writeback() to clear_inode()  After we moved inode_sync_wait() from end_writeback() it doesn't make sense to call the function end_writeback() anymore. Rename it to clear_inode() which well says what the function really does - set I_CLEAR flag.  Signed-off-by: Jan Kara <jack@suse.cz> Signed-off-by: Fengguang Wu <fengguang.wu@intel.com>
f | aops.h | s | 3.8K | 94 | Mark Fasheh | mfasheh@suse.com | 1311844036 |  | ocfs2: serialize unaligned aio  Fix a corruption that can happen when we have (two or more) outstanding aio's to an overlapping unaligned region.  Ext4 (e9e3bcecf44c04b9e6b505fd8e2eb9cea58fb94d) and xfs recently had to fix similar issues.  In our case what happens is that we can have an outstanding aio on a region and if a write comes in with some bytes overlapping the original aio we may decide to read that region into a page before continuing (typically because of buffered-io fallback).  Since we have no ordering guarantees with the aio, we can read stale or bad data into the page and then write it back out.  If the i/o is page and block aligned, then we avoid this issue as there won't be any need to read data from disk.  I took the same approach as Eric in the ext4 patch and introduced some serialization of unaligned async direct i/o.  I don't expect this to have an effect on the most common cases of AIO.  Unaligned aio will be slower though, but that's far more acceptable than data corruption.  Signed-off-by: Mark Fasheh <mfasheh@suse.com> Signed-off-by: Joel Becker <jlbec@evilplan.org>
f | xattr.h | s | 3.6K | 92 | Al Viro | viro@zeniv.linux.org.uk | 1325649302 |  | ocfs2: propagate umode_t  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | alloc.h | s | 11K | 301 | Tao Ma | boyu.mt@taobao.com | 1306219038 |  | ocfs2: Add ocfs2_trim_fs for SSD trim support.  Add ocfs2_trim_fs to support trimming freed clusters in the volume. A range will be given and all the freed clusters greater than minlen will be discarded to the block layer.  Signed-off-by: Tao Ma <boyu.mt@taobao.com> Signed-off-by: Joel Becker <jlbec@evilplan.org>
f | journal.c | s | 57K | 1829 | Sunil Mushran | sunil.mushran@oracle.com | 1311528954 |  | ocfs2: Add comment about orphan scanning  Add a comment that explains the reason as to why orphan scan scans all the slots.  Signed-off-by: Sunil Mushran <sunil.mushran@oracle.com>
f | aops.c | s | 52K | 1792 | Cong Wang | amwang@redhat.com | 1332251305 |  | ocfs2: remove the second argument of k[un]map_atomic()  Acked-by: Joel Becker <jlbec@evilplan.org> Signed-off-by: Cong Wang <amwang@redhat.com>
f | locks.c | s | 3.4K | 112 | Tao Ma | boyu.mt@taobao.com | 1298258303 |  | ocfs2: remove INODE from unused files.  As there are no such debug information in fs/ocfs2/ioctl.c, fs/ocfs2/locks.c and fs/ocfs2/sysfile.c, ML_INODE are also removed.  Signed-off-by: Tao Ma <boyu.mt@taobao.com>
f | blockcheck.h | s | 3.8K | 96 | Joel Becker | joel.becker@oracle.com | 1244081736 |  | ocfs2: Add statistics for the checksum and ecc operations.  It would be nice to know how often we get checksum failures.  Even better, how many of them we can fix with the single bit ecc.  So, we add a statistics structure.  The structure can be installed into debugfs wherever the user wants.  For ocfs2, we'll put it in the superblock-specific debugfs directory and pass it down from our higher-level functions.  The stats are only registered with debugfs when the filesystem supports metadata ecc.  Signed-off-by: Joel Becker <joel.becker@oracle.com>
f | xattr.c | s | 193K | 6377 | Al Viro | viro@zeniv.linux.org.uk | 1325649302 |  | ocfs2: propagate umode_t  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | mmap.c | s | 5.0K | 166 | Wengang Wang | wen.gang.wang@oracle.com | 1311529014 |  | ocfs2: Fix ocfs2_page_mkwrite()  This patch address two shortcomings in ocfs2_page_mkwrite(): 1. Makes the function return better VM_FAULT_* errors. 2. It handles a error that is triggered when a page is dropped from the mapping due to memory pressure. This patch locks the page to prevent that.  [Patch was cleaned up by Sunil Mushran.]  Signed-off-by: Wengang Wang <wen.gang.wang@oracle.com> Signed-off-by: Sunil Mushran <sunil.mushran@oracle.com>
f | quota_global.c | s | 26K | 853 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | resize.h | s | 1.1K | 29 | Tao Ma | tao.ma@oracle.com | 1201302264 |  | [PATCH 2/2] ocfs2: Implement group add for online resize  This patch adds the ability for a userspace program to request that a properly formatted cluster group be added to the main allocation bitmap for an Ocfs2 file system. The request is made via an ioctl, OCFS2_IOC_GROUP_ADD. On a high level, this is similar to ext3, but we use a different ioctl as the structure which has to be passed through is different.  During an online resize, tunefs.ocfs2 will format any new cluster groups which must be added to complete the resize, and call OCFS2_IOC_GROUP_ADD on each one. Kernel verifies that the core cluster group information is valid and then does the work of linking it into the global allocation bitmap.  Signed-off-by: Tao Ma <tao.ma@oracle.com> Signed-off-by: Mark Fasheh <mark.fasheh@oracle.com>
f | buffer_head_io.c | s | 10K | 362 | Tao Ma | boyu.mt@taobao.com | 1298535740 |  | ocfs2: Remove masklog ML_UPTODATE.  Remove mlog(0,...) and mlog(ML_UPTODATE,...) from fs/ocfs2/uptodate.c and fs/ocfs2/buffer_head_io.c.  The masklog UPTODATE is removed finally.  Signed-off-by: Tao Ma <boyu.mt@taobao.com>
f | extent_map.h | s | 2.8K | 77 | Sunil Mushran | sunil.mushran@oracle.com | 1311631095 |  | ocfs2: Implement llseek()  ocfs2 implements its own llseek() to provide the SEEK_HOLE/SEEK_DATA functionality.  SEEK_HOLE sets the file pointer to the start of either a hole or an unwritten (preallocated) extent, that is greater than or equal to the supplied offset.  SEEK_DATA sets the file pointer to the start of an allocated extent (not unwritten) that is greater than or equal to the supplied offset.  If the supplied offset is on a desired region, then the file pointer is set to it. Offsets greater than or equal to the file size return -ENXIO.  Unwritten (preallocated) extents are considered holes because the file system treats reads to such regions in the same way as it does to holes.  Signed-off-by: Sunil Mushran <sunil.mushran@oracle.com>
f | locks.h | s | 1.1K | 29 | Mark Fasheh | mfasheh@suse.com | 1223931477 |  | ocfs2: POSIX file locks support  This is actually pretty easy since fs/dlm already handles the bulk of the work. The Ocfs2 userspace cluster stack module already uses fs/dlm as the underlying lock manager, so I only had to add the right calls.  Cluster-aware POSIX locks ("plocks") can be turned off by the same means at UNIX locks - mount with 'noflocks', or create a local-only Ocfs2 volume. Internally, the file system uses two sets of file_operations, depending on whether cluster aware plocks is required. This turns out to be easier than implementing local-only versions of ->lock.  Signed-off-by: Mark Fasheh <mfasheh@suse.com>
f | namei.h | s | 1.5K | 40 | Tao Ma | tao.ma@oracle.com | 1253675388 |  | ocfs2: Create reflinked file in orphan dir.  reflink is a very complicated process, so it can't be integrated into one transaction. So if the system panic in the operation, we may leave a unfinished inode in the destication directory.  So we will try to create an inode in orphan_dir first, reflink it to the src file and then move it to the destication file in the end. In that way we won't be afraid of any corruption during the reflink.  This patch adds 2 functions for orphan_dir operation: 1. Create a new inode in orphand dir. 2. Move an inode to a target dir.  Note: fsck.ocfs2 should work for us to remove the unfinished file in the orphan_dir.  Signed-off-by: Tao Ma <tao.ma@oracle.com>
f | super.c | s | 69K | 2296 | Al Viro | viro@zeniv.linux.org.uk | 1332293389 |  | ocfs2: fix leaks on failure exits in module_init  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | journal.h | s | 21K | 530 | Xiaowei.Hu | xiaowei.hu@oracle.com | 1321523208 |  | ocfs2: Add a missing journal credit in ocfs2_link_credits() -v2  With indexed_dir enabled, ocfs2 maintains a list of dirblocks having space.  The credit calculation in ocfs2_link_credits() did not correctly account for adding an entry that exactly fills a dirblock that triggers removing that dirblock by changing the pointer in the previous block in the list. The credit calculation did not account for that previous block.  To expose, do:  mkfs.ocfs2 -b 512 -M local /dev/sdX mount /dev/sdX /ocfs2 mkdir /ocfs2/linkdir touch /ocfs2/linkdir/file1 for i in `seq 1 29` ; do link /ocfs2/linkdir/file1 /ocfs2/linkdir/linklinklinklinklinklink$i; done rm -f /ocfs2/linkdir/linklinklinklinklinklink10 sleep 8 link /ocfs2/linkdir/file1 /ocfs2/linkdir/linklinklinklinklinklinkaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa  Note: The link names have been crafted for a 512 byte blocksize. Reproducing with a larger blocksize will require longer (or more) links. The sleep is important. We want jbd2 to commit the transaction so that the missing block does not piggy back on account of the previous transaction.  Signed-off-by: XiaoweiHu <xiaowei.hu at oracle.com> Reviewed-by: WengangWang <wen.gang.wang at oracle.com> Reviewed-by: Sunil.Mushran <sunil.mushran at oracle.com> Signed-off-by: Joel Becker <jlbec@evilplan.org>
f | dcache.c | s | 14K | 462 | Tao Ma | boyu.mt@taobao.com | 1298472709 |  | ocfs2: Remove masklog ML_DCACHE.  Remove mlog(0) from fs/ocfs2/dcache.c and the masklog DCACHE.  Signed-off-by: Tao Ma <boyu.mt@taobao.com>
f | ocfs1_fs_compat.h | s | 2.9K | 99 | Joe Perches | joe@perches.com | 1202052822 |  | fs/: Spelling fixes  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: Adrian Bunk <bunk@kernel.org>
f | refcounttree.h | s | 4.2K | 112 | Tristan Ye | tristan.ye@oracle.com | 1306307828 |  | Ocfs2/refcounttree: Publicize couple of funcs from refcounttree.c  The original goal of commonizing these funcs is to benefit defraging/extent_moving codes in the future,  based on the fact that reflink and defragmentation having the same Copy-On-Wrtie mechanism.  Signed-off-by: Tristan Ye <tristan.ye@oracle.com>
f | stackglue.h | s | 8.9K | 257 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | dir.h | s | 3.9K | 105 | Mark Fasheh | mfasheh@suse.com | 1238783956 |  | ocfs2: Introduce dir free space list  The only operation which doesn't get faster with directory indexing is insert, which still has to walk the entire unindexed directory portion to find a free block. This patch provides an improvement in directory insert performance by maintaining a singly linked list of directory leaf blocks which have space for additional dirents.  Signed-off-by: Mark Fasheh <mfasheh@suse.com> Acked-by: Joel Becker <joel.becker@oracle.com>
f | ocfs2_lockingver.h | s | 959B | 29 | Joel Becker | joel.becker@oracle.com | 1267227678 |  | ocfs2_dlmfs: Enable the use of user cluster stacks.  Unlike ocfs2, dlmfs has no permanent storage.  It can't store off a cluster stack it is supposed to be using.  So it can't specify the stack name in ocfs2_cluster_connect().  Instead, we create ocfs2_cluster_connect_agnostic(), which simply uses the stack that is currently enabled.  This is find for dlmfs, which will rely on the stack initialization.  We add the "stackglue" capability to dlmfs's capability list.  This lets userspace know dlmfs can be used with all cluster stacks.  Signed-off-by: Joel Becker <joel.becker@oracle.com>
f | inode.c | s | 39K | 1222 | Al Viro | viro@zeniv.linux.org.uk | 1338348520 |  | ocfs: simplify symlink handling  seeing that "fast" symlinks still get allocation + copy, we might as well simply switch them to pagecache-based variant of ->follow_link(); just need an appropriate ->readpage() for them...  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | ocfs2_ioctl.h | s | 6.9K | 213 | Tristan Ye | tristan.ye@oracle.com | 1306307828 |  | Ocfs2/move_extents: Adding new ioctl code 'OCFS2_IOC_MOVE_EXT' to ocfs2.  Patch also manages to add a manipulative struture for this ioctl.  Signed-off-by: Tristan Ye <tristan.ye@oracle.com>
f | export.c | s | 6.2K | 224 | Al Viro | viro@zeniv.linux.org.uk | 1338348513 |  | ->encode_fh() API change  pass inode + parent's inode or NULL instead of dentry + bool saying whether we want the parent or not.  NOTE: that needs ceph fix folded in.  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | quota.h | s | 4.3K | 102 | Tejun Heo | tj@kernel.org | 1296556962 |  | ocfs2: use system_wq instead of ocfs2_quota_wq  ocfs2_quota_wq is not depended upon during memory reclaim and, with cmwq, there's no reason to use a dedicated workqueue.  Drop ocfs2_quota_wq and use system_wq instead.  dqi_sync_work is already sync canceled on quota disable and no further synchronization is necessary.  This change makes ocfs2_quota_setup/shutdown() noops.  Both functions removed.  Signed-off-by: Tejun Heo <tj@kernel.org> Cc: Mark Fasheh <mfasheh@suse.com> Cc: Joel Becker <joel.becker@oracle.com>
f | extent_map.c | s | 23K | 843 | Sunil Mushran | sunil.mushran@oracle.com | 1311631095 |  | ocfs2: Implement llseek()  ocfs2 implements its own llseek() to provide the SEEK_HOLE/SEEK_DATA functionality.  SEEK_HOLE sets the file pointer to the start of either a hole or an unwritten (preallocated) extent, that is greater than or equal to the supplied offset.  SEEK_DATA sets the file pointer to the start of an allocated extent (not unwritten) that is greater than or equal to the supplied offset.  If the supplied offset is on a desired region, then the file pointer is set to it. Offsets greater than or equal to the file size return -ENXIO.  Unwritten (preallocated) extents are considered holes because the file system treats reads to such regions in the same way as it does to holes.  Signed-off-by: Sunil Mushran <sunil.mushran@oracle.com>
f | symlink.c | s | 2.7K | 89 | Al Viro | viro@zeniv.linux.org.uk | 1338348520 |  | ocfs: simplify symlink handling  seeing that "fast" symlinks still get allocation + copy, we might as well simply switch them to pagecache-based variant of ->follow_link(); just need an appropriate ->readpage() for them...  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | localalloc.h | s | 2.0K | 51 | Mark Fasheh | mfasheh@suse.com | 1273108687 |  | ocfs2: increase the default size of local alloc windows  I have observed that the current size of 8M gives us pretty poor fragmentation on multi-threaded workloads which do lots of writes.  Generally, I can increase the size of local alloc windows and observe a marked decrease in fragmentation, even up and beyond window sizes of 512 megabytes. This makes sense for a couple reasons - larger local alloc means more room for reservation windows. On multi-node workloads the larger local alloc helps as well because we don't have to do window slides as often.  Also, I removed the OCFS2_DEFAULT_LOCAL_ALLOC_SIZE constant as it is no longer used and the comment above it was out of date.  To test fragmentation, I used a workload which launched 4 threads that did 4k writes into a series of about 140 alternating files.  With resv_level=2, and a 4k/4k file system I observed the following average fragmentation for various localalloc= parameters:  localalloc=	avg. fragmentation 	8		48 	32		16 	64		10 	120		7  On larger cluster sizes, the difference is more dramatic.  The new default size top out at 256M, which we'll only get for cluster sizes of 32K and above.  Signed-off-by: Mark Fasheh <mfasheh@suse.com> Signed-off-by: Joel Becker <joel.becker@oracle.com>
f | heartbeat.h | s | 1.5K | 40 | Joel Becker | joel.becker@oracle.com | 1208534164 |  | ocfs2: Move o2hb functionality into the stack glue.  The last bit of classic stack used directly in ocfs2 code is o2hb. Specifically, the check for heartbeat during mount and the call to ocfs2_hb_ctl during unmount.  We create an extra API, ocfs2_cluster_hangup(), to encapsulate the call to ocfs2_hb_ctl.  Other stacks will just leave hangup() empty.  The check for heartbeat is moved into ocfs2_cluster_connect().  It will be matched by a similar check for other stacks.  With this change, only stackglue.c includes cluster/ headers.  Signed-off-by: Joel Becker <joel.becker@oracle.com> Signed-off-by: Mark Fasheh <mfasheh@suse.com>
f | move_extents.c | s | 27K | 967 | Al Viro | viro@zeniv.linux.org.uk | 1338348515 |  | ocfs2: deal with __user misannotations  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | alloc.c | s | 186K | 6278 | Al Viro | viro@zeniv.linux.org.uk | 1334334697 |  | ocfs2: ->l_next_free_req breakage on big-endian  It's le16, not le32...  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | localalloc.c | s | 33K | 1115 | Tao Ma | boyu.mt@taobao.com | 1298332887 |  | ocfs2: Remove DISK_ALLOC from masklog.  Since all 4 files, localalloc.c, suballoc.c, alloc.c and resize.c, which use DISK_ALLOC are changed to trace events, Remove masklog DISK_ALLOC totally.  Signed-off-by: Tao Ma <boyu.mt@taobao.com>
f | mmap.h | s | 134B | 4 | Mark Fasheh | mark.fasheh@oracle.com | 1136317547 |  | [PATCH] OCFS2: The Second Oracle Cluster Filesystem  The OCFS2 file system module.  Signed-off-by: Mark Fasheh <mark.fasheh@oracle.com> Signed-off-by: Kurt Hackel <kurt.hackel@oracle.com>
f | refcounttree.c | s | 113K | 3840 | Al Viro | viro@zeniv.linux.org.uk | 1334334701 |  | ocfs2: ->rl_count endianness breakage  le16, not le32...  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | acl.h | s | 1.0K | 31 | Christoph Hellwig | hch@lst.de | 1311618623 |  | fs: take the ACL checks to common code  Replace the ->check_acl method with a ->get_acl method that simply reads an ACL from disk after having a cache miss.  This means we can replace the ACL checking boilerplate code with a single implementation in namei.c.  Signed-off-by: Christoph Hellwig <hch@lst.de> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | stackglue.c | s | 16K | 607 | Joel Becker | joel.becker@oracle.com | 1267227678 |  | ocfs2_dlmfs: Enable the use of user cluster stacks.  Unlike ocfs2, dlmfs has no permanent storage.  It can't store off a cluster stack it is supposed to be using.  So it can't specify the stack name in ocfs2_cluster_connect().  Instead, we create ocfs2_cluster_connect_agnostic(), which simply uses the stack that is currently enabled.  This is find for dlmfs, which will rely on the stack initialization.  We add the "stackglue" capability to dlmfs's capability list.  This lets userspace know dlmfs can be used with all cluster stacks.  Signed-off-by: Joel Becker <joel.becker@oracle.com>
f | ioctl.h | s | 330B | 13 | Tristan Ye | tristan.ye@oracle.com | 1267567820 |  | Ocfs2: Move ocfs2 ioctl definitions from ocfs2_fs.h to newly added ocfs2_ioctl.h  Currently we were adding ioctl cmds/structures for ocfs2 into ocfs2_fs.h which was used for define ocfs2 on-disk layout. That sounds a little bit confusing, and it may be quickly polluted espcially when growing the ocfs2_info_request ioctls afterwards(it will grow i bet).  As a result, such OCFS2 IOCs do need to be placed somewhere other than ocfs2_fs.h, a separated ocfs2_ioctl.h will be added to store such ioctl structures and definitions which could also be used from userspace to invoke ioctls call.  Signed-off-by: Tristan Ye <tristan.ye@oracle.com> Signed-off-by: Joel Becker <joel.becker@oracle.com>
f | sysfile.c | s | 4.6K | 153 | Tao Ma | boyu.mt@taobao.com | 1298384081 |  | ocfs2: Remove mlog(0) from fs/ocfs2/file.c  This is the 2nd step to remove the debug info of INODE.  Signed-off-by: Tao Ma <boyu.mt@taobao.com>
f | dcache.h | s | 2.1K | 57 | Goldwyn Rodrigues | rgoldwyn@gmail.com | 1284135495 |  | Track negative entries v3  Track negative dentries by recording the generation number of the parent directory in d_fsdata. The generation number for the parent directory is recorded in the inode_info, which increments every time the lock on the directory is dropped.  If the generation number of the parent directory and the negative dentry matches, there is no need to perform the revalidate, else a revalidate is forced. This improves performance in situations where nodes look for the same non-existent file multiple times.  Thanks Mark for explaining the DLM sequence.  Signed-off-by: Goldwyn Rodrigues <rgoldwyn@suse.de> Signed-off-by: Joel Becker <joel.becker@oracle.com>
f | ver.c | s | 1.2K | 36 | Mark Fasheh | mark.fasheh@oracle.com | 1201302346 |  | ocfs2: bump version number  Bump the printed version to 1.5.0. This helps us quickly identify which version of Ocfs2 a bug filer is running.  Signed-off-by: Mark Fasheh <mark.fasheh@oracle.com>
f | sysfile.h | s | 1.1K | 30 | Mark Fasheh | mark.fasheh@oracle.com | 1136317547 |  | [PATCH] OCFS2: The Second Oracle Cluster Filesystem  The OCFS2 file system module.  Signed-off-by: Mark Fasheh <mark.fasheh@oracle.com> Signed-off-by: Kurt Hackel <kurt.hackel@oracle.com>
f | ioctl.c | s | 22K | 837 | Al Viro | viro@zeniv.linux.org.uk | 1338348515 |  | ocfs2: deal with __user misannotations  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | acl.c | s | 11K | 434 | Al Viro | viro@zeniv.linux.org.uk | 1312179006 |  | switch posix_acl_equiv_mode() to umode_t *  ... so that &inode->i_mode could be passed to it  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | blockcheck.c | s | 16K | 542 | Al Viro | viro@zeniv.linux.org.uk | 1338348515 |  | ocfs2: kill endianness abuses in blockcheck.c  ocfs2_block_check is for little-endian contents; if we just want to its fields converted to host-endian in a couple of functions, just put those values into local u32 and u16...  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | symlink.h | s | 1.3K | 37 | Al Viro | viro@zeniv.linux.org.uk | 1338348520 |  | ocfs: simplify symlink handling  seeing that "fast" symlinks still get allocation + copy, we might as well simply switch them to pagecache-based variant of ->follow_link(); just need an appropriate ->readpage() for them...  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | Kconfig | g | 2.4K |  | Nicholas Bellinger | nab@linux-iscsi.org | 1295212960 |  | ocfs2: Make OCFS2_FS depend on CONFIGFS_FS  This patch fixes the following kconfig error after changing CONFIGFS_FS -> select SYSFS:  fs/sysfs/Kconfig:1:error: recursive dependency detected! fs/sysfs/Kconfig:1:	symbol SYSFS is selected by CONFIGFS_FS fs/configfs/Kconfig:1:	symbol CONFIGFS_FS is selected by OCFS2_FS fs/ocfs2/Kconfig:1:	symbol OCFS2_FS depends on SYSFS  Signed-off-by: Nicholas A. Bellinger <nab@linux-iscsi.org> Cc: Joel Becker <jlbec@evilplan.org> Cc: Randy Dunlap <randy.dunlap@oracle.com> Cc: Stephen Rothwell <sfr@canb.auug.org.au> Cc: James Bottomley <James.Bottomley@suse.de>
f | reservations.c | s | 20K | 686 | Tao Ma | boyu.mt@taobao.com | 1298470256 |  | ocfs2: Remove masklog ML_RESERVATIONS.  Remove mlog(0) from fs/ocfs2/reservations.c and the masklog RESERVATIONS.  Signed-off-by: Tao Ma <boyu.mt@taobao.com>
f | uptodate.h | s | 3.0K | 75 | Joel Becker | joel.becker@oracle.com | 1252105670 |  | ocfs2: Pass struct ocfs2_caching_info to the journal functions.  The next step in divorcing metadata I/O management from struct inode is to pass struct ocfs2_caching_info to the journal functions.  Thus the journal locks a metadata cache with the cache io_lock function.  It also can compare ci_last_trans and ci_created_trans directly.  This is a large patch because of all the places we change ocfs2_journal_access..(handle, inode, ...) to ocfs2_journal_access..(handle, INODE_CACHE(inode), ...).  Signed-off-by: Joel Becker <joel.becker@oracle.com>
f | ver.h | s | 1000B | 28 | Mark Fasheh | mark.fasheh@oracle.com | 1136317547 |  | [PATCH] OCFS2: The Second Oracle Cluster Filesystem  The OCFS2 file system module.  Signed-off-by: Mark Fasheh <mark.fasheh@oracle.com> Signed-off-by: Kurt Hackel <kurt.hackel@oracle.com>
f | namei.c | s | 59K | 2143 | Al Viro | viro@zeniv.linux.org.uk | 1338348520 |  | ocfs: simplify symlink handling  seeing that "fast" symlinks still get allocation + copy, we might as well simply switch them to pagecache-based variant of ->follow_link(); just need an appropriate ->readpage() for them...  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | stack_o2cb.c | s | 11K | 385 | Sunil Mushran | sunil.mushran@oracle.com | 1311528834 |  | ocfs2/cluster: Cluster up now includes network connections too  The cluster up check only checks to see if the node is heartbeating or not. If yes it continues assuming that the node is connected to all the nodes. But if that is not the case, the cluster join aborts with a stack of errors that are not easy to comprehend.  This patch adds the network connect check upfront and prints the nodes that the node is not yet connected to, before aborting.  Signed-off-by: Sunil Mushran <sunil.mushran@oracle.com>
f | file.h | s | 2.6K | 69 | Al Viro | viro@zeniv.linux.org.uk | 1311140604 |  | ->permission() sanitizing: don't pass flags to ->permission()  not used by the instances anymore.  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | heartbeat.c | s | 3.4K | 115 | Tao Ma | boyu.mt@taobao.com | 1298467059 |  | ocfs2: Remove mlog(0) from fs/ocfs2/heartbeat.c  This is the 2nd step to remove the debug info of SUPER.  Signed-off-by: Tao Ma <boyu.mt@taobao.com>
f | file.c | s | 66K | 2375 | Linus Torvalds | torvalds@linux-foundation.org | 1326057682 |  | Merge branch 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/jikos/trivial  * 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/jikos/trivial: (53 commits)   Kconfig: acpi: Fix typo in comment.   misc latin1 to utf8 conversions   devres: Fix a typo in devm_kfree comment   btrfs: free-space-cache.c: remove extra semicolon.   fat: Spelling s/obsolate/obsolete/g   SCSI, pmcraid: Fix spelling error in a pmcraid_err() call   tools/power turbostat: update fields in manpage   mac80211: drop spelling fix   types.h: fix comment spelling for 'architectures'   typo fixes: aera -> area, exntension -> extension   devices.txt: Fix typo of 'VMware'.   sis900: Fix enum typo 'sis900_rx_bufer_status'   decompress_bunzip2: remove invalid vi modeline   treewide: Fix comment and string typo 'bufer'   hyper-v: Update MAINTAINERS   treewide: Fix typos in various parts of the kernel, and fix some comments.   clockevents: drop unknown Kconfig symbol GENERIC_CLOCKEVENTS_MIGR   gpio: Kconfig: drop unknown symbol 'CS5535_GPIO'   leds: Kconfig: Fix typo 'D2NET_V2'   sound: Kconfig: drop unknown symbol ARCH_CLPS7500   ...  Fix up trivial conflicts in arch/powerpc/platforms/40x/Kconfig (some new kconfig additions, close to removed commented-out old ones)
f | suballoc.h | s | 7.1K | 194 | Mark Fasheh | mfasheh@suse.com | 1283927159 |  | ocfs2: allow return of new inode block location before allocation of the inode  This allows code which needs to know the eventual block number of an inode but can't allocate it yet due to transaction or lock ordering. For example, ocfs2_create_inode_in_orphan() currently gives a junk blkno for preparation of the orphan dir because it can't yet know where the actual inode is placed - that code is actually in ocfs2_mknod_locked. This is a problem when the orphan dirs are indexed as the junk inode number will create an index entry which goes unused (and fails the later removal from the orphan dir).  Now with these interfaces, ocfs2_create_inode_in_orphan() can run the block group search (and get back the inode block number) *before* any actual allocation occurs.  Signed-off-by: Mark Fasheh <mfasheh@suse.com> Signed-off-by: Tao Ma <tao.ma@oracle.com>
f | stack_user.c | s | 23K | 755 | David Teigland | teigland@redhat.com | 1325688991 |  | dlm: add recovery callbacks  These new callbacks notify the dlm user about lock recovery. GFS2, and possibly others, need to be aware of when the dlm will be doing lock recovery for a failed lockspace member.  In the past, this coordination has been done between dlm and file system daemons in userspace, which then direct their kernel counterparts.  These callbacks allow the same coordination directly, and more simply.  Signed-off-by: David Teigland <teigland@redhat.com>
f | export.h | s | 1.0K | 29 | Christoph Hellwig | hch@lst.de | 1193066001 |  | exportfs: make struct export_operations const  Now that nfsd has stopped writing to the find_exported_dentry member we an mark the export_operations const  Signed-off-by: Christoph Hellwig <hch@lst.de> Cc: Neil Brown <neilb@suse.de> Cc: "J. Bruce Fields" <bfields@fieldses.org> Cc: <linux-ext4@vger.kernel.org> Cc: Dave Kleikamp <shaggy@austin.ibm.com> Cc: Anton Altaparmakov <aia21@cantab.net> Cc: David Chinner <dgc@sgi.com> Cc: Timothy Shimmin <tes@sgi.com> Cc: OGAWA Hirofumi <hirofumi@mail.parknet.co.jp> Cc: Hugh Dickins <hugh@veritas.com> Cc: Chris Mason <mason@suse.com> Cc: Jeff Mahoney <jeffm@suse.com> Cc: "Vladimir V. Saveliev" <vs@namesys.com> Cc: Steven Whitehouse <swhiteho@redhat.com> Cc: Mark Fasheh <mark.fasheh@oracle.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | quota_local.c | s | 35K | 1212 | Akinobu Mita | akinobu.mita@gmail.com | 1322779172 |  | ocfs2: avoid unaligned access to dqc_bitmap  The dqc_bitmap field of struct ocfs2_local_disk_chunk is 32-bit aligned, but not 64-bit aligned.  The dqc_bitmap is accessed by ocfs2_set_bit(), ocfs2_clear_bit(), ocfs2_test_bit(), or ocfs2_find_next_zero_bit().  These are wrapper macros for ext2_*_bit() which need to take an unsigned long aligned address (though some architectures are able to handle unaligned address correctly)  So some 64bit architectures may not be able to access the dqc_bitmap correctly.  This avoids such unaligned access by using another wrapper functions for ext2_*_bit().  The code is taken from fs/ext4/mballoc.c which also need to handle unaligned bitmap access.  Signed-off-by: Akinobu Mita <akinobu.mita@gmail.com> Acked-by: Joel Becker <jlbec@evilplan.org> Cc: Mark Fasheh <mfasheh@suse.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Joel Becker <jlbec@evilplan.org>
f | inode.h | s | 6.1K | 155 | Mark Fasheh | mfasheh@suse.com | 1311844036 |  | ocfs2: serialize unaligned aio  Fix a corruption that can happen when we have (two or more) outstanding aio's to an overlapping unaligned region.  Ext4 (e9e3bcecf44c04b9e6b505fd8e2eb9cea58fb94d) and xfs recently had to fix similar issues.  In our case what happens is that we can have an outstanding aio on a region and if a write comes in with some bytes overlapping the original aio we may decide to read that region into a page before continuing (typically because of buffered-io fallback).  Since we have no ordering guarantees with the aio, we can read stale or bad data into the page and then write it back out.  If the i/o is page and block aligned, then we avoid this issue as there won't be any need to read data from disk.  I took the same approach as Eric in the ext4 patch and introduced some serialization of unaligned async direct i/o.  I don't expect this to have an effect on the most common cases of AIO.  Unaligned aio will be slower though, but that's far more acceptable than data corruption.  Signed-off-by: Mark Fasheh <mfasheh@suse.com> Signed-off-by: Joel Becker <jlbec@evilplan.org>
f | move_extents.h | s | 758B | 20 | Tristan Ye | tristan.ye@oracle.com | 1306307832 |  | Ocfs2/move_extents: move/defrag extents within a certain range.  the basic logic of moving extents for a file is pretty like punching-hole sequence, walk the extents within the range as user specified, calculating an appropriate len to defrag/move, then let ocfs2_defrag/move_extent() to do the actual moving.  This func ends up setting 'OCFS2_MOVE_EXT_FL_COMPLETE' to userpace if operation gets done successfully.  Signed-off-by: Tristan Ye <tristan.ye@oracle.com>
f | dlmglue.h | s | 5.8K | 154 | Tao Ma | tao.ma@oracle.com | 1284135546 |  | ocfs2: Fix lockdep warning in reflink.  This patch change mutex_lock to a new subclass and add a new inode lock subclass for the target inode which caused this lockdep warning.  ============================================= [ INFO: possible recursive locking detected ] 2.6.35+ #5 --------------------------------------------- reflink/11086 is trying to acquire lock:  (Meta){+++++.}, at: [<ffffffffa06f9d65>] ocfs2_reflink_ioctl+0x898/0x1229 [ocfs2]  but task is already holding lock:  (Meta){+++++.}, at: [<ffffffffa06f9aa0>] ocfs2_reflink_ioctl+0x5d3/0x1229 [ocfs2]  other info that might help us debug this: 6 locks held by reflink/11086:  #0:  (&sb->s_type->i_mutex_key#15/1){+.+.+.}, at: [<ffffffff820e09ec>] lookup_create+0x26/0x97  #1:  (&sb->s_type->i_mutex_key#15){+.+.+.}, at: [<ffffffffa06f99a0>] ocfs2_reflink_ioctl+0x4d3/0x1229 [ocfs2]  #2:  (Meta){+++++.}, at: [<ffffffffa06f9aa0>] ocfs2_reflink_ioctl+0x5d3/0x1229 [ocfs2]  #3:  (&oi->ip_xattr_sem){+.+.+.}, at: [<ffffffffa06f9b58>] ocfs2_reflink_ioctl+0x68b/0x1229 [ocfs2]  #4:  (&oi->ip_alloc_sem){+.+.+.}, at: [<ffffffffa06f9b67>] ocfs2_reflink_ioctl+0x69a/0x1229 [ocfs2]  #5:  (&sb->s_type->i_mutex_key#15/2){+.+...}, at: [<ffffffffa06f9d4f>] ocfs2_reflink_ioctl+0x882/0x1229 [ocfs2]  stack backtrace: Pid: 11086, comm: reflink Not tainted 2.6.35+ #5 Call Trace:  [<ffffffff82063dd9>] validate_chain+0x56e/0xd68  [<ffffffff82062275>] ? mark_held_locks+0x49/0x69  [<ffffffff82064d6d>] __lock_acquire+0x79a/0x7f1  [<ffffffff82065a81>] lock_acquire+0xc6/0xed  [<ffffffffa06f9d65>] ? ocfs2_reflink_ioctl+0x898/0x1229 [ocfs2]  [<ffffffffa06c9ade>] __ocfs2_cluster_lock+0x975/0xa0d [ocfs2]  [<ffffffffa06f9d65>] ? ocfs2_reflink_ioctl+0x898/0x1229 [ocfs2]  [<ffffffffa06e107b>] ? ocfs2_wait_for_recovery+0x15/0x8a [ocfs2]  [<ffffffffa06cb6ea>] ocfs2_inode_lock_full_nested+0x1ac/0xdc5 [ocfs2]  [<ffffffffa06f9d65>] ? ocfs2_reflink_ioctl+0x898/0x1229 [ocfs2]  [<ffffffff820623a0>] ? trace_hardirqs_on_caller+0x10b/0x12f  [<ffffffff82060193>] ? debug_mutex_free_waiter+0x4f/0x53  [<ffffffffa06f9d65>] ocfs2_reflink_ioctl+0x898/0x1229 [ocfs2]  [<ffffffffa06ce24a>] ? ocfs2_file_lock_res_init+0x66/0x78 [ocfs2]  [<ffffffff820bb2d2>] ? might_fault+0x40/0x8d  [<ffffffffa06df9f6>] ocfs2_ioctl+0x61a/0x656 [ocfs2]  [<ffffffff820ee5d3>] ? mntput_no_expire+0x1d/0xb0  [<ffffffff820e07b3>] ? path_put+0x2c/0x31  [<ffffffff820e53ac>] vfs_ioctl+0x2a/0x9d  [<ffffffff820e5903>] do_vfs_ioctl+0x45d/0x4ae  [<ffffffff8233a7f6>] ? _raw_spin_unlock+0x26/0x2a  [<ffffffff8200299c>] ? sysret_check+0x27/0x62  [<ffffffff820e59ab>] sys_ioctl+0x57/0x7a  [<ffffffff8200296b>] system_call_fastpath+0x16/0x1b  Signed-off-by: Tao Ma <tao.ma@oracle.com> Signed-off-by: Joel Becker <joel.becker@oracle.com>
f | ocfs2.h | s | 23K | 736 | Akinobu Mita | akinobu.mita@gmail.com | 1322779172 |  | ocfs2: avoid unaligned access to dqc_bitmap  The dqc_bitmap field of struct ocfs2_local_disk_chunk is 32-bit aligned, but not 64-bit aligned.  The dqc_bitmap is accessed by ocfs2_set_bit(), ocfs2_clear_bit(), ocfs2_test_bit(), or ocfs2_find_next_zero_bit().  These are wrapper macros for ext2_*_bit() which need to take an unsigned long aligned address (though some architectures are able to handle unaligned address correctly)  So some 64bit architectures may not be able to access the dqc_bitmap correctly.  This avoids such unaligned access by using another wrapper functions for ext2_*_bit().  The code is taken from fs/ext4/mballoc.c which also need to handle unaligned bitmap access.  Signed-off-by: Akinobu Mita <akinobu.mita@gmail.com> Acked-by: Joel Becker <jlbec@evilplan.org> Cc: Mark Fasheh <mfasheh@suse.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Joel Becker <jlbec@evilplan.org>
f | ocfs2_trace.h | s | 75K | 2344 | Tao Ma | boyu.mt@taobao.com | 1306219040 |  | ocfs2: Add trace event for trim.  Add the corresponding trace event for trim.  Signed-off-by: Tao Ma <boyu.mt@taobao.com> Signed-off-by: Joel Becker <jlbec@evilplan.org>
f | super.h | s | 1.6K | 44 | Joe Perches | joe@perches.com | 1320107454 |  | treewide: use __printf not __attribute__((format(printf,...)))  Standardize the style for compiler based printf format verification. Standardized the location of __printf too.  Done via script and a little typing.  $ grep -rPl --include=*.[ch] -w "__attribute__" * || \   grep -vP "^(tools||scripts||include/linux/compiler-gcc.h)" || \   xargs perl -n -i -e 'local $/; while (<>) { s/\b__attribute__\s*\(\s*\(\s*format\s*\(\s*printf\s*,\s*(.+)\s*,\s*(.+)\s*\)\s*\)\s*\)/__printf($1, $2)/g ; print; }'  [akpm@linux-foundation.org: revert arch bits] Signed-off-by: Joe Perches <joe@perches.com> Cc: "Kirill A. Shutemov" <kirill@shutemov.name> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | ocfs2_lockid.h | s | 3.2K | 119 | Tao Ma | tao.ma@oracle.com | 1253675368 |  | ocfs2: Add new refcount tree lock resource in dlmglue.  refcount tree lock resource is used to protect refcount tree read/write among multiple nodes.  Signed-off-by: Tao Ma <tao.ma@oracle.com>
f | buffer_head_io.h | s | 2.4K | 65 | Joel Becker | joel.becker@oracle.com | 1252105668 |  | ocfs2: Take the inode out of the metadata read/write paths.  We are really passing the inode into the ocfs2_read/write_blocks() functions to get at the metadata cache.  This commit passes the cache directly into the metadata block functions, divorcing them from the inode.  Signed-off-by: Joel Becker <joel.becker@oracle.com>
