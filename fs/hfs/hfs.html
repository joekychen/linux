<!DOCTYPE html>
<html><head><title>joekychen/linux » fs › hfs › hfs.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>hfs.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> *  linux/fs/hfs/hfs.h</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 1995-1997  Paul H. Hargrove</span>
<span class="cm"> * (C) 2003 Ardis Technologies &lt;roman@ardistech.com&gt;</span>
<span class="cm"> * This file may be distributed under the terms of the GNU General Public License.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _HFS_H</span>
<span class="cp">#define _HFS_H</span>

<span class="cm">/* offsets to various blocks */</span>
<span class="cp">#define HFS_DD_BLK		0 </span><span class="cm">/* Driver Descriptor block */</span><span class="cp"></span>
<span class="cp">#define HFS_PMAP_BLK		1 </span><span class="cm">/* First block of partition map */</span><span class="cp"></span>
<span class="cp">#define HFS_MDB_BLK		2 </span><span class="cm">/* Block (w/i partition) of MDB */</span><span class="cp"></span>

<span class="cm">/* magic numbers for various disk blocks */</span>
<span class="cp">#define HFS_DRVR_DESC_MAGIC	0x4552 </span><span class="cm">/* &quot;ER&quot;: driver descriptor map */</span><span class="cp"></span>
<span class="cp">#define HFS_OLD_PMAP_MAGIC	0x5453 </span><span class="cm">/* &quot;TS&quot;: old-type partition map */</span><span class="cp"></span>
<span class="cp">#define HFS_NEW_PMAP_MAGIC	0x504D </span><span class="cm">/* &quot;PM&quot;: new-type partition map */</span><span class="cp"></span>
<span class="cp">#define HFS_SUPER_MAGIC		0x4244 </span><span class="cm">/* &quot;BD&quot;: HFS MDB (super block) */</span><span class="cp"></span>
<span class="cp">#define HFS_MFS_SUPER_MAGIC	0xD2D7 </span><span class="cm">/* MFS MDB (super block) */</span><span class="cp"></span>

<span class="cm">/* various FIXED size parameters */</span>
<span class="cp">#define HFS_SECTOR_SIZE		512    </span><span class="cm">/* size of an HFS sector */</span><span class="cp"></span>
<span class="cp">#define HFS_SECTOR_SIZE_BITS	9      </span><span class="cm">/* log_2(HFS_SECTOR_SIZE) */</span><span class="cp"></span>
<span class="cp">#define HFS_NAMELEN		31     </span><span class="cm">/* maximum length of an HFS filename */</span><span class="cp"></span>
<span class="cp">#define HFS_MAX_NAMELEN		128</span>
<span class="cp">#define HFS_MAX_VALENCE		32767U</span>

<span class="cm">/* Meanings of the drAtrb field of the MDB,</span>
<span class="cm"> * Reference: _Inside Macintosh: Files_ p. 2-61</span>
<span class="cm"> */</span>
<span class="cp">#define HFS_SB_ATTRIB_HLOCK	(1 &lt;&lt; 7)</span>
<span class="cp">#define HFS_SB_ATTRIB_UNMNT	(1 &lt;&lt; 8)</span>
<span class="cp">#define HFS_SB_ATTRIB_SPARED	(1 &lt;&lt; 9)</span>
<span class="cp">#define HFS_SB_ATTRIB_INCNSTNT	(1 &lt;&lt; 11)</span>
<span class="cp">#define HFS_SB_ATTRIB_SLOCK	(1 &lt;&lt; 15)</span>

<span class="cm">/* Some special File ID numbers */</span>
<span class="cp">#define HFS_POR_CNID		1	</span><span class="cm">/* Parent Of the Root */</span><span class="cp"></span>
<span class="cp">#define HFS_ROOT_CNID		2	</span><span class="cm">/* ROOT directory */</span><span class="cp"></span>
<span class="cp">#define HFS_EXT_CNID		3	</span><span class="cm">/* EXTents B-tree */</span><span class="cp"></span>
<span class="cp">#define HFS_CAT_CNID		4	</span><span class="cm">/* CATalog B-tree */</span><span class="cp"></span>
<span class="cp">#define HFS_BAD_CNID		5	</span><span class="cm">/* BAD blocks file */</span><span class="cp"></span>
<span class="cp">#define HFS_ALLOC_CNID		6	</span><span class="cm">/* ALLOCation file (HFS+) */</span><span class="cp"></span>
<span class="cp">#define HFS_START_CNID		7	</span><span class="cm">/* STARTup file (HFS+) */</span><span class="cp"></span>
<span class="cp">#define HFS_ATTR_CNID		8	</span><span class="cm">/* ATTRibutes file (HFS+) */</span><span class="cp"></span>
<span class="cp">#define HFS_EXCH_CNID		15	</span><span class="cm">/* ExchangeFiles temp id */</span><span class="cp"></span>
<span class="cp">#define HFS_FIRSTUSER_CNID	16</span>

<span class="cm">/* values for hfs_cat_rec.cdrType */</span>
<span class="cp">#define HFS_CDR_DIR    0x01    </span><span class="cm">/* folder (directory) */</span><span class="cp"></span>
<span class="cp">#define HFS_CDR_FIL    0x02    </span><span class="cm">/* file */</span><span class="cp"></span>
<span class="cp">#define HFS_CDR_THD    0x03    </span><span class="cm">/* folder (directory) thread */</span><span class="cp"></span>
<span class="cp">#define HFS_CDR_FTH    0x04    </span><span class="cm">/* file thread */</span><span class="cp"></span>

<span class="cm">/* legal values for hfs_ext_key.FkType and hfs_file.fork */</span>
<span class="cp">#define HFS_FK_DATA	0x00</span>
<span class="cp">#define HFS_FK_RSRC	0xFF</span>

<span class="cm">/* bits in hfs_fil_entry.Flags */</span>
<span class="cp">#define HFS_FIL_LOCK	0x01  </span><span class="cm">/* locked */</span><span class="cp"></span>
<span class="cp">#define HFS_FIL_THD	0x02  </span><span class="cm">/* file thread */</span><span class="cp"></span>
<span class="cp">#define HFS_FIL_DOPEN   0x04  </span><span class="cm">/* data fork open */</span><span class="cp"></span>
<span class="cp">#define HFS_FIL_ROPEN   0x08  </span><span class="cm">/* resource fork open */</span><span class="cp"></span>
<span class="cp">#define HFS_FIL_DIR     0x10  </span><span class="cm">/* directory (always clear) */</span><span class="cp"></span>
<span class="cp">#define HFS_FIL_NOCOPY  0x40  </span><span class="cm">/* copy-protected file */</span><span class="cp"></span>
<span class="cp">#define HFS_FIL_USED	0x80  </span><span class="cm">/* open */</span><span class="cp"></span>

<span class="cm">/* bits in hfs_dir_entry.Flags. dirflags is 16 bits. */</span>
<span class="cp">#define HFS_DIR_LOCK        0x01  </span><span class="cm">/* locked */</span><span class="cp"></span>
<span class="cp">#define HFS_DIR_THD         0x02  </span><span class="cm">/* directory thread */</span><span class="cp"></span>
<span class="cp">#define HFS_DIR_INEXPFOLDER 0x04  </span><span class="cm">/* in a shared area */</span><span class="cp"></span>
<span class="cp">#define HFS_DIR_MOUNTED     0x08  </span><span class="cm">/* mounted */</span><span class="cp"></span>
<span class="cp">#define HFS_DIR_DIR         0x10  </span><span class="cm">/* directory (always set) */</span><span class="cp"></span>
<span class="cp">#define HFS_DIR_EXPFOLDER   0x20  </span><span class="cm">/* share point */</span><span class="cp"></span>

<span class="cm">/* bits hfs_finfo.fdFlags */</span>
<span class="cp">#define HFS_FLG_INITED		0x0100</span>
<span class="cp">#define HFS_FLG_LOCKED		0x1000</span>
<span class="cp">#define HFS_FLG_INVISIBLE	0x4000</span>

<span class="cm">/*======== HFS structures as they appear on the disk ========*/</span>

<span class="cm">/* Pascal-style string of up to 31 characters */</span>
<span class="k">struct</span> <span class="n">hfs_name</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">len</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">name</span><span class="p">[</span><span class="n">HFS_NAMELEN</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">hfs_point</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">v</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">h</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">hfs_rect</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">top</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">left</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">bottom</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">right</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">hfs_finfo</span> <span class="p">{</span>
	<span class="n">__be32</span> <span class="n">fdType</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">fdCreator</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">fdFlags</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hfs_point</span> <span class="n">fdLocation</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">fdFldr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">hfs_fxinfo</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">fdIconID</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">fdUnused</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
	<span class="n">__be16</span> <span class="n">fdComment</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">fdPutAway</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">hfs_dinfo</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">hfs_rect</span> <span class="n">frRect</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">frFlags</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hfs_point</span> <span class="n">frLocation</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">frView</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">hfs_dxinfo</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">hfs_point</span> <span class="n">frScroll</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">frOpenChain</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">frUnused</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">frComment</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">frPutAway</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">union</span> <span class="n">hfs_finder_info</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="n">hfs_finfo</span> <span class="n">finfo</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">hfs_fxinfo</span> <span class="n">fxinfo</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">file</span><span class="p">;</span>
	<span class="k">struct</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="n">hfs_dinfo</span> <span class="n">dinfo</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">hfs_dxinfo</span> <span class="n">dxinfo</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">dir</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* Cast to a pointer to a generic bkey */</span>
<span class="cp">#define	HFS_BKEY(X)	(((void)((X)-&gt;KeyLen)), ((struct hfs_bkey *)(X)))</span>

<span class="cm">/* The key used in the catalog b-tree: */</span>
<span class="k">struct</span> <span class="n">hfs_cat_key</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">key_len</span><span class="p">;</span>		<span class="cm">/* number of bytes in the key */</span>
	<span class="n">u8</span> <span class="n">reserved</span><span class="p">;</span>		<span class="cm">/* padding */</span>
	<span class="n">__be32</span> <span class="n">ParID</span><span class="p">;</span>		<span class="cm">/* CNID of the parent dir */</span>
	<span class="k">struct</span> <span class="n">hfs_name</span>	<span class="n">CName</span><span class="p">;</span>	<span class="cm">/* The filename of the entry */</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* The key used in the extents b-tree: */</span>
<span class="k">struct</span> <span class="n">hfs_ext_key</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">key_len</span><span class="p">;</span>		<span class="cm">/* number of bytes in the key */</span>
	<span class="n">u8</span> <span class="n">FkType</span><span class="p">;</span>		<span class="cm">/* HFS_FK_{DATA,RSRC} */</span>
	<span class="n">__be32</span> <span class="n">FNum</span><span class="p">;</span>		<span class="cm">/* The File ID of the file */</span>
	<span class="n">__be16</span> <span class="n">FABN</span><span class="p">;</span>		<span class="cm">/* allocation blocks number*/</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">union</span> <span class="n">hfs_btree_key</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">key_len</span><span class="p">;</span>			<span class="cm">/* number of bytes in the key */</span>
	<span class="k">struct</span> <span class="n">hfs_cat_key</span> <span class="n">cat</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hfs_ext_key</span> <span class="n">ext</span><span class="p">;</span>
<span class="p">}</span> <span class="n">hfs_btree_key</span><span class="p">;</span>

<span class="cp">#define HFS_MAX_CAT_KEYLEN	(sizeof(struct hfs_cat_key) - sizeof(u8))</span>
<span class="cp">#define HFS_MAX_EXT_KEYLEN	(sizeof(struct hfs_ext_key) - sizeof(u8))</span>

<span class="k">typedef</span> <span class="k">union</span> <span class="n">hfs_btree_key</span> <span class="n">btree_key</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">hfs_extent</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">block</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">count</span><span class="p">;</span>
<span class="p">};</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">hfs_extent</span> <span class="n">hfs_extent_rec</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>

<span class="cm">/* The catalog record for a file */</span>
<span class="k">struct</span> <span class="n">hfs_cat_file</span> <span class="p">{</span>
	<span class="n">s8</span> <span class="n">type</span><span class="p">;</span>			<span class="cm">/* The type of entry */</span>
	<span class="n">u8</span> <span class="n">reserved</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">Flags</span><span class="p">;</span>			<span class="cm">/* Flags such as read-only */</span>
	<span class="n">s8</span> <span class="n">Typ</span><span class="p">;</span>				<span class="cm">/* file version number = 0 */</span>
	<span class="k">struct</span> <span class="n">hfs_finfo</span> <span class="n">UsrWds</span><span class="p">;</span>	<span class="cm">/* data used by the Finder */</span>
	<span class="n">__be32</span> <span class="n">FlNum</span><span class="p">;</span>			<span class="cm">/* The CNID */</span>
	<span class="n">__be16</span> <span class="n">StBlk</span><span class="p">;</span>			<span class="cm">/* obsolete */</span>
	<span class="n">__be32</span> <span class="n">LgLen</span><span class="p">;</span>			<span class="cm">/* The logical EOF of the data fork*/</span>
	<span class="n">__be32</span> <span class="n">PyLen</span><span class="p">;</span>			<span class="cm">/* The physical EOF of the data fork */</span>
	<span class="n">__be16</span> <span class="n">RStBlk</span><span class="p">;</span>			<span class="cm">/* obsolete */</span>
	<span class="n">__be32</span> <span class="n">RLgLen</span><span class="p">;</span>			<span class="cm">/* The logical EOF of the rsrc fork */</span>
	<span class="n">__be32</span> <span class="n">RPyLen</span><span class="p">;</span>			<span class="cm">/* The physical EOF of the rsrc fork */</span>
	<span class="n">__be32</span> <span class="n">CrDat</span><span class="p">;</span>			<span class="cm">/* The creation date */</span>
	<span class="n">__be32</span> <span class="n">MdDat</span><span class="p">;</span>			<span class="cm">/* The modified date */</span>
	<span class="n">__be32</span> <span class="n">BkDat</span><span class="p">;</span>			<span class="cm">/* The last backup date */</span>
	<span class="k">struct</span> <span class="n">hfs_fxinfo</span> <span class="n">FndrInfo</span><span class="p">;</span>	<span class="cm">/* more data for the Finder */</span>
	<span class="n">__be16</span> <span class="n">ClpSize</span><span class="p">;</span>			<span class="cm">/* number of bytes to allocate</span>
<span class="cm">					   when extending files */</span>
	<span class="n">hfs_extent_rec</span> <span class="n">ExtRec</span><span class="p">;</span>		<span class="cm">/* first extent record</span>
<span class="cm">					   for the data fork */</span>
	<span class="n">hfs_extent_rec</span> <span class="n">RExtRec</span><span class="p">;</span>		<span class="cm">/* first extent record</span>
<span class="cm">					   for the resource fork */</span>
	<span class="n">u32</span> <span class="n">Resrv</span><span class="p">;</span>			<span class="cm">/* reserved by Apple */</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* the catalog record for a directory */</span>
<span class="k">struct</span> <span class="n">hfs_cat_dir</span> <span class="p">{</span>
	<span class="n">s8</span> <span class="n">type</span><span class="p">;</span>			<span class="cm">/* The type of entry */</span>
	<span class="n">u8</span> <span class="n">reserved</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">Flags</span><span class="p">;</span>			<span class="cm">/* flags */</span>
	<span class="n">__be16</span> <span class="n">Val</span><span class="p">;</span>			<span class="cm">/* Valence: number of files and</span>
<span class="cm">					   dirs in the directory */</span>
	<span class="n">__be32</span> <span class="n">DirID</span><span class="p">;</span>			<span class="cm">/* The CNID */</span>
	<span class="n">__be32</span> <span class="n">CrDat</span><span class="p">;</span>			<span class="cm">/* The creation date */</span>
	<span class="n">__be32</span> <span class="n">MdDat</span><span class="p">;</span>			<span class="cm">/* The modification date */</span>
	<span class="n">__be32</span> <span class="n">BkDat</span><span class="p">;</span>			<span class="cm">/* The last backup date */</span>
	<span class="k">struct</span> <span class="n">hfs_dinfo</span> <span class="n">UsrInfo</span><span class="p">;</span>	<span class="cm">/* data used by the Finder */</span>
	<span class="k">struct</span> <span class="n">hfs_dxinfo</span> <span class="n">FndrInfo</span><span class="p">;</span>	<span class="cm">/* more data used by Finder */</span>
	<span class="n">u8</span> <span class="n">Resrv</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>			<span class="cm">/* reserved by Apple */</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* the catalog record for a thread */</span>
<span class="k">struct</span> <span class="n">hfs_cat_thread</span> <span class="p">{</span>
	<span class="n">s8</span> <span class="n">type</span><span class="p">;</span>			<span class="cm">/* The type of entry */</span>
	<span class="n">u8</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">9</span><span class="p">];</span>			<span class="cm">/* reserved by Apple */</span>
	<span class="n">__be32</span> <span class="n">ParID</span><span class="p">;</span>			<span class="cm">/* CNID of parent directory */</span>
	<span class="k">struct</span> <span class="n">hfs_name</span> <span class="n">CName</span><span class="p">;</span>		<span class="cm">/* The name of this entry */</span>
<span class="p">}</span>  <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* A catalog tree record */</span>
<span class="k">typedef</span> <span class="k">union</span> <span class="n">hfs_cat_rec</span> <span class="p">{</span>
	<span class="n">s8</span> <span class="n">type</span><span class="p">;</span>			<span class="cm">/* The type of entry */</span>
	<span class="k">struct</span> <span class="n">hfs_cat_file</span> <span class="n">file</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hfs_cat_dir</span> <span class="n">dir</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hfs_cat_thread</span> <span class="kr">thread</span><span class="p">;</span>
<span class="p">}</span> <span class="n">hfs_cat_rec</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">hfs_mdb</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">drSigWord</span><span class="p">;</span>		<span class="cm">/* Signature word indicating fs type */</span>
	<span class="n">__be32</span> <span class="n">drCrDate</span><span class="p">;</span>		<span class="cm">/* fs creation date/time */</span>
	<span class="n">__be32</span> <span class="n">drLsMod</span><span class="p">;</span>			<span class="cm">/* fs modification date/time */</span>
	<span class="n">__be16</span> <span class="n">drAtrb</span><span class="p">;</span>			<span class="cm">/* fs attributes */</span>
	<span class="n">__be16</span> <span class="n">drNmFls</span><span class="p">;</span>			<span class="cm">/* number of files in root directory */</span>
	<span class="n">__be16</span> <span class="n">drVBMSt</span><span class="p">;</span>			<span class="cm">/* location (in 512-byte blocks)</span>
<span class="cm">					   of the volume bitmap */</span>
	<span class="n">__be16</span> <span class="n">drAllocPtr</span><span class="p">;</span>		<span class="cm">/* location (in allocation blocks)</span>
<span class="cm">					   to begin next allocation search */</span>
	<span class="n">__be16</span> <span class="n">drNmAlBlks</span><span class="p">;</span>		<span class="cm">/* number of allocation blocks */</span>
	<span class="n">__be32</span> <span class="n">drAlBlkSiz</span><span class="p">;</span>		<span class="cm">/* bytes in an allocation block */</span>
	<span class="n">__be32</span> <span class="n">drClpSiz</span><span class="p">;</span>		<span class="cm">/* clumpsize, the number of bytes to</span>
<span class="cm">					   allocate when extending a file */</span>
	<span class="n">__be16</span> <span class="n">drAlBlSt</span><span class="p">;</span>		<span class="cm">/* location (in 512-byte blocks)</span>
<span class="cm">					   of the first allocation block */</span>
	<span class="n">__be32</span> <span class="n">drNxtCNID</span><span class="p">;</span>		<span class="cm">/* CNID to assign to the next</span>
<span class="cm">					   file or directory created */</span>
	<span class="n">__be16</span> <span class="n">drFreeBks</span><span class="p">;</span>		<span class="cm">/* number of free allocation blocks */</span>
	<span class="n">u8</span> <span class="n">drVN</span><span class="p">[</span><span class="mi">28</span><span class="p">];</span>			<span class="cm">/* the volume label */</span>
	<span class="n">__be32</span> <span class="n">drVolBkUp</span><span class="p">;</span>		<span class="cm">/* fs backup date/time */</span>
	<span class="n">__be16</span> <span class="n">drVSeqNum</span><span class="p">;</span>		<span class="cm">/* backup sequence number */</span>
	<span class="n">__be32</span> <span class="n">drWrCnt</span><span class="p">;</span>			<span class="cm">/* fs write count */</span>
	<span class="n">__be32</span> <span class="n">drXTClpSiz</span><span class="p">;</span>		<span class="cm">/* clumpsize for the extents B-tree */</span>
	<span class="n">__be32</span> <span class="n">drCTClpSiz</span><span class="p">;</span>		<span class="cm">/* clumpsize for the catalog B-tree */</span>
	<span class="n">__be16</span> <span class="n">drNmRtDirs</span><span class="p">;</span>		<span class="cm">/* number of directories in</span>
<span class="cm">					   the root directory */</span>
	<span class="n">__be32</span> <span class="n">drFilCnt</span><span class="p">;</span>		<span class="cm">/* number of files in the fs */</span>
	<span class="n">__be32</span> <span class="n">drDirCnt</span><span class="p">;</span>		<span class="cm">/* number of directories in the fs */</span>
	<span class="n">u8</span> <span class="n">drFndrInfo</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>		<span class="cm">/* data used by the Finder */</span>
	<span class="n">__be16</span> <span class="n">drEmbedSigWord</span><span class="p">;</span>		<span class="cm">/* embedded volume signature */</span>
	<span class="n">__be32</span> <span class="n">drEmbedExtent</span><span class="p">;</span>		<span class="cm">/* starting block number (xdrStABN)</span>
<span class="cm">					   and number of allocation blocks</span>
<span class="cm">					   (xdrNumABlks) occupied by embedded</span>
<span class="cm">					   volume */</span>
	<span class="n">__be32</span> <span class="n">drXTFlSize</span><span class="p">;</span>		<span class="cm">/* bytes in the extents B-tree */</span>
	<span class="n">hfs_extent_rec</span> <span class="n">drXTExtRec</span><span class="p">;</span>	<span class="cm">/* extents B-tree&#39;s first 3 extents */</span>
	<span class="n">__be32</span> <span class="n">drCTFlSize</span><span class="p">;</span>		<span class="cm">/* bytes in the catalog B-tree */</span>
	<span class="n">hfs_extent_rec</span> <span class="n">drCTExtRec</span><span class="p">;</span>	<span class="cm">/* catalog B-tree&#39;s first 3 extents */</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/*======== Data structures kept in memory ========*/</span>

<span class="k">struct</span> <span class="n">hfs_readdir_data</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">list</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="n">file</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hfs_cat_key</span> <span class="n">key</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
