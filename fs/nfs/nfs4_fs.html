<!DOCTYPE html>
<html><head><title>joekychen/linux » fs › nfs › nfs4_fs.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>nfs4_fs.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * linux/fs/nfs/nfs4_fs.h</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 2005 Trond Myklebust</span>
<span class="cm"> *</span>
<span class="cm"> * NFSv4-specific filesystem definitions and declarations</span>
<span class="cm"> */</span>

<span class="cp">#ifndef __LINUX_FS_NFS_NFS4_FS_H</span>
<span class="cp">#define __LINUX_FS_NFS_NFS4_FS_H</span>

<span class="cp">#ifdef CONFIG_NFS_V4</span>

<span class="k">struct</span> <span class="n">idmap</span><span class="p">;</span>

<span class="k">enum</span> <span class="n">nfs4_client_state</span> <span class="p">{</span>
	<span class="n">NFS4CLNT_MANAGER_RUNNING</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">NFS4CLNT_CHECK_LEASE</span><span class="p">,</span>
	<span class="n">NFS4CLNT_LEASE_EXPIRED</span><span class="p">,</span>
	<span class="n">NFS4CLNT_RECLAIM_REBOOT</span><span class="p">,</span>
	<span class="n">NFS4CLNT_RECLAIM_NOGRACE</span><span class="p">,</span>
	<span class="n">NFS4CLNT_DELEGRETURN</span><span class="p">,</span>
	<span class="n">NFS4CLNT_SESSION_RESET</span><span class="p">,</span>
	<span class="n">NFS4CLNT_RECALL_SLOT</span><span class="p">,</span>
	<span class="n">NFS4CLNT_LEASE_CONFIRM</span><span class="p">,</span>
	<span class="n">NFS4CLNT_SERVER_SCOPE_MISMATCH</span><span class="p">,</span>
	<span class="n">NFS4CLNT_PURGE_STATE</span><span class="p">,</span>
	<span class="n">NFS4CLNT_BIND_CONN_TO_SESSION</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">nfs4_session_state</span> <span class="p">{</span>
	<span class="n">NFS4_SESSION_INITING</span><span class="p">,</span>
	<span class="n">NFS4_SESSION_DRAINING</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define NFS4_RENEW_TIMEOUT		0x01</span>
<span class="cp">#define NFS4_RENEW_DELEGATION_CB	0x02</span>

<span class="k">struct</span> <span class="n">nfs4_minor_version_ops</span> <span class="p">{</span>
	<span class="n">u32</span>	<span class="n">minor_version</span><span class="p">;</span>

	<span class="kt">int</span>	<span class="p">(</span><span class="o">*</span><span class="n">call_sync</span><span class="p">)(</span><span class="k">struct</span> <span class="n">rpc_clnt</span> <span class="o">*</span><span class="n">clnt</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">nfs_server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">rpc_message</span> <span class="o">*</span><span class="n">msg</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">nfs4_sequence_args</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">nfs4_sequence_res</span> <span class="o">*</span><span class="n">res</span><span class="p">,</span>
			<span class="kt">int</span> <span class="n">cache_reply</span><span class="p">);</span>
	<span class="n">bool</span>	<span class="p">(</span><span class="o">*</span><span class="n">match_stateid</span><span class="p">)(</span><span class="k">const</span> <span class="n">nfs4_stateid</span> <span class="o">*</span><span class="p">,</span>
			<span class="k">const</span> <span class="n">nfs4_stateid</span> <span class="o">*</span><span class="p">);</span>
	<span class="kt">int</span>	<span class="p">(</span><span class="o">*</span><span class="n">find_root_sec</span><span class="p">)(</span><span class="k">struct</span> <span class="n">nfs_server</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">nfs_fh</span> <span class="o">*</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">nfs_fsinfo</span> <span class="o">*</span><span class="p">);</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">nfs4_state_recovery_ops</span> <span class="o">*</span><span class="n">reboot_recovery_ops</span><span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">nfs4_state_recovery_ops</span> <span class="o">*</span><span class="n">nograce_recovery_ops</span><span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">nfs4_state_maintenance_ops</span> <span class="o">*</span><span class="n">state_renewal_ops</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define NFS_SEQID_CONFIRMED 1</span>
<span class="k">struct</span> <span class="n">nfs_seqid_counter</span> <span class="p">{</span>
	<span class="n">ktime_t</span> <span class="n">create_time</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">owner_id</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">flags</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">counter</span><span class="p">;</span>
	<span class="n">spinlock_t</span> <span class="n">lock</span><span class="p">;</span>		<span class="cm">/* Protects the list */</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">list</span><span class="p">;</span>		<span class="cm">/* Defines sequence of RPC calls */</span>
	<span class="k">struct</span> <span class="n">rpc_wait_queue</span>	<span class="n">wait</span><span class="p">;</span>	<span class="cm">/* RPC call delay queue */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">nfs_seqid</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">nfs_seqid_counter</span> <span class="o">*</span><span class="n">sequence</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">list</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">rpc_task</span> <span class="o">*</span><span class="n">task</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">nfs_confirm_seqid</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_seqid_counter</span> <span class="o">*</span><span class="n">seqid</span><span class="p">,</span> <span class="kt">int</span> <span class="n">status</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">seqid_mutating_err</span><span class="p">(</span><span class="o">-</span><span class="n">status</span><span class="p">))</span>
		<span class="n">seqid</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">|=</span> <span class="n">NFS_SEQID_CONFIRMED</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * NFS4 state_owners and lock_owners are simply labels for ordered</span>
<span class="cm"> * sequences of RPC calls. Their sole purpose is to provide once-only</span>
<span class="cm"> * semantics by allowing the server to identify replayed requests.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">nfs4_state_owner</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">nfs_server</span>    <span class="o">*</span><span class="n">so_server</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span>     <span class="n">so_lru</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span>        <span class="n">so_expires</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">rb_node</span>	     <span class="n">so_server_node</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">rpc_cred</span>	     <span class="o">*</span><span class="n">so_cred</span><span class="p">;</span>	 <span class="cm">/* Associated cred */</span>

	<span class="n">spinlock_t</span>	     <span class="n">so_lock</span><span class="p">;</span>
	<span class="n">atomic_t</span>	     <span class="n">so_count</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span>	     <span class="n">so_flags</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span>     <span class="n">so_states</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">nfs_seqid_counter</span> <span class="n">so_seqid</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">NFS_OWNER_RECLAIM_REBOOT</span><span class="p">,</span>
	<span class="n">NFS_OWNER_RECLAIM_NOGRACE</span>
<span class="p">};</span>

<span class="cp">#define NFS_LOCK_NEW		0</span>
<span class="cp">#define NFS_LOCK_RECLAIM	1</span>
<span class="cp">#define NFS_LOCK_EXPIRED	2</span>

<span class="cm">/*</span>
<span class="cm"> * struct nfs4_state maintains the client-side state for a given</span>
<span class="cm"> * (state_owner,inode) tuple (OPEN) or state_owner (LOCK).</span>
<span class="cm"> *</span>
<span class="cm"> * OPEN:</span>
<span class="cm"> * In order to know when to OPEN_DOWNGRADE or CLOSE the state on the server,</span>
<span class="cm"> * we need to know how many files are open for reading or writing on a</span>
<span class="cm"> * given inode. This information too is stored here.</span>
<span class="cm"> *</span>
<span class="cm"> * LOCK: one nfs4_state (LOCK) to hold the lock stateid nfs4_state(OPEN)</span>
<span class="cm"> */</span>

<span class="k">struct</span> <span class="n">nfs4_lock_owner</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">lo_type</span><span class="p">;</span>
<span class="cp">#define NFS4_ANY_LOCK_TYPE	(0U)</span>
<span class="cp">#define NFS4_FLOCK_LOCK_TYPE	(1U &lt;&lt; 0)</span>
<span class="cp">#define NFS4_POSIX_LOCK_TYPE	(1U &lt;&lt; 1)</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="n">fl_owner_t</span> <span class="n">posix_owner</span><span class="p">;</span>
		<span class="n">pid_t</span> <span class="n">flock_owner</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">lo_u</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">nfs4_lock_state</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">list_head</span>	<span class="n">ls_locks</span><span class="p">;</span>	<span class="cm">/* Other lock stateids */</span>
	<span class="k">struct</span> <span class="n">nfs4_state</span> <span class="o">*</span>	<span class="n">ls_state</span><span class="p">;</span>	<span class="cm">/* Pointer to open state */</span>
<span class="cp">#define NFS_LOCK_INITIALIZED 1</span>
	<span class="kt">int</span>			<span class="n">ls_flags</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">nfs_seqid_counter</span>	<span class="n">ls_seqid</span><span class="p">;</span>
	<span class="n">nfs4_stateid</span>		<span class="n">ls_stateid</span><span class="p">;</span>
	<span class="n">atomic_t</span>		<span class="n">ls_count</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">nfs4_lock_owner</span>	<span class="n">ls_owner</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* bits for nfs4_state-&gt;flags */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">LK_STATE_IN_USE</span><span class="p">,</span>
	<span class="n">NFS_DELEGATED_STATE</span><span class="p">,</span>		<span class="cm">/* Current stateid is delegation */</span>
	<span class="n">NFS_O_RDONLY_STATE</span><span class="p">,</span>		<span class="cm">/* OPEN stateid has read-only state */</span>
	<span class="n">NFS_O_WRONLY_STATE</span><span class="p">,</span>		<span class="cm">/* OPEN stateid has write-only state */</span>
	<span class="n">NFS_O_RDWR_STATE</span><span class="p">,</span>		<span class="cm">/* OPEN stateid has read/write state */</span>
	<span class="n">NFS_STATE_RECLAIM_REBOOT</span><span class="p">,</span>	<span class="cm">/* OPEN stateid server rebooted */</span>
	<span class="n">NFS_STATE_RECLAIM_NOGRACE</span><span class="p">,</span>	<span class="cm">/* OPEN stateid needs to recover state */</span>
	<span class="n">NFS_STATE_POSIX_LOCKS</span><span class="p">,</span>		<span class="cm">/* Posix locks are supported */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">nfs4_state</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">open_states</span><span class="p">;</span>	<span class="cm">/* List of states for the same state_owner */</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">inode_states</span><span class="p">;</span>	<span class="cm">/* List of states for the same inode */</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">lock_states</span><span class="p">;</span>	<span class="cm">/* List of subservient lock stateids */</span>

	<span class="k">struct</span> <span class="n">nfs4_state_owner</span> <span class="o">*</span><span class="n">owner</span><span class="p">;</span>	<span class="cm">/* Pointer to the open owner */</span>
	<span class="k">struct</span> <span class="n">inode</span> <span class="o">*</span><span class="n">inode</span><span class="p">;</span>		<span class="cm">/* Pointer to the inode */</span>

	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">flags</span><span class="p">;</span>		<span class="cm">/* Do we hold any locks? */</span>
	<span class="n">spinlock_t</span> <span class="n">state_lock</span><span class="p">;</span>		<span class="cm">/* Protects the lock_states list */</span>

	<span class="n">seqlock_t</span> <span class="n">seqlock</span><span class="p">;</span>		<span class="cm">/* Protects the stateid/open_stateid */</span>
	<span class="n">nfs4_stateid</span> <span class="n">stateid</span><span class="p">;</span>		<span class="cm">/* Current stateid: may be delegation */</span>
	<span class="n">nfs4_stateid</span> <span class="n">open_stateid</span><span class="p">;</span>	<span class="cm">/* OPEN stateid */</span>

	<span class="cm">/* The following 3 fields are protected by owner-&gt;so_lock */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n_rdonly</span><span class="p">;</span>		<span class="cm">/* Number of read-only references */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n_wronly</span><span class="p">;</span>		<span class="cm">/* Number of write-only references */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n_rdwr</span><span class="p">;</span>		<span class="cm">/* Number of read/write references */</span>
	<span class="n">fmode_t</span> <span class="n">state</span><span class="p">;</span>			<span class="cm">/* State on the server (R,W, or RW) */</span>
	<span class="n">atomic_t</span> <span class="n">count</span><span class="p">;</span>
<span class="p">};</span>


<span class="k">struct</span> <span class="n">nfs4_exception</span> <span class="p">{</span>
	<span class="kt">long</span> <span class="n">timeout</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">retry</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">nfs4_state</span> <span class="o">*</span><span class="n">state</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">inode</span> <span class="o">*</span><span class="n">inode</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">nfs4_state_recovery_ops</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">owner_flag_bit</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">state_flag_bit</span><span class="p">;</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">recover_open</span><span class="p">)(</span><span class="k">struct</span> <span class="n">nfs4_state_owner</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">nfs4_state</span> <span class="o">*</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">recover_lock</span><span class="p">)(</span><span class="k">struct</span> <span class="n">nfs4_state</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">file_lock</span> <span class="o">*</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">establish_clid</span><span class="p">)(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">rpc_cred</span> <span class="o">*</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">rpc_cred</span> <span class="o">*</span> <span class="p">(</span><span class="o">*</span><span class="n">get_clid_cred</span><span class="p">)(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">reclaim_complete</span><span class="p">)(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">nfs4_state_maintenance_ops</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">sched_state_renewal</span><span class="p">)(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">rpc_cred</span> <span class="o">*</span><span class="p">,</span> <span class="kt">unsigned</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">rpc_cred</span> <span class="o">*</span> <span class="p">(</span><span class="o">*</span><span class="n">get_state_renewal_cred_locked</span><span class="p">)(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">renew_lease</span><span class="p">)(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">rpc_cred</span> <span class="o">*</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">extern</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">dentry_operations</span> <span class="n">nfs4_dentry_operations</span><span class="p">;</span>
<span class="k">extern</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">inode_operations</span> <span class="n">nfs4_dir_inode_operations</span><span class="p">;</span>

<span class="cm">/* nfs4namespace.c */</span>
<span class="n">rpc_authflavor_t</span> <span class="n">nfs_find_best_sec</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs4_secinfo_flavors</span> <span class="o">*</span><span class="p">);</span>
<span class="k">struct</span> <span class="n">rpc_clnt</span> <span class="o">*</span><span class="n">nfs4_create_sec_client</span><span class="p">(</span><span class="k">struct</span> <span class="n">rpc_clnt</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">inode</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">qstr</span> <span class="o">*</span><span class="p">);</span>
<span class="k">struct</span> <span class="n">vfsmount</span> <span class="o">*</span><span class="n">nfs4_submount</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_server</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">dentry</span> <span class="o">*</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">nfs_fh</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">nfs_fattr</span> <span class="o">*</span><span class="p">);</span>

<span class="cm">/* nfs4proc.c */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">nfs4_proc_setclientid</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="p">,</span> <span class="n">u32</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span><span class="p">,</span> <span class="k">struct</span> <span class="n">rpc_cred</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">nfs4_setclientid_res</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">nfs4_proc_setclientid_confirm</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">nfs4_setclientid_res</span> <span class="o">*</span><span class="n">arg</span><span class="p">,</span> <span class="k">struct</span> <span class="n">rpc_cred</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">nfs4_proc_get_rootfh</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_server</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">nfs_fh</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">nfs_fsinfo</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">nfs4_proc_bind_conn_to_session</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">rpc_cred</span> <span class="o">*</span><span class="n">cred</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">nfs4_proc_exchange_id</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="n">clp</span><span class="p">,</span> <span class="k">struct</span> <span class="n">rpc_cred</span> <span class="o">*</span><span class="n">cred</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">nfs4_destroy_clientid</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="n">clp</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">nfs4_init_clientid</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">rpc_cred</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">nfs41_init_clientid</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">rpc_cred</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">nfs4_do_close</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs4_state</span> <span class="o">*</span><span class="n">state</span><span class="p">,</span> <span class="n">gfp_t</span> <span class="n">gfp_mask</span><span class="p">,</span> <span class="kt">int</span> <span class="n">wait</span><span class="p">,</span> <span class="n">bool</span> <span class="n">roc</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">nfs4_server_capabilities</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">struct</span> <span class="n">nfs_fh</span> <span class="o">*</span><span class="n">fhandle</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">nfs4_proc_fs_locations</span><span class="p">(</span><span class="k">struct</span> <span class="n">rpc_clnt</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">inode</span> <span class="o">*</span><span class="p">,</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">qstr</span> <span class="o">*</span><span class="p">,</span>
				  <span class="k">struct</span> <span class="n">nfs4_fs_locations</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">page</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">rpc_clnt</span> <span class="o">*</span><span class="n">nfs4_proc_lookup_mountpoint</span><span class="p">(</span><span class="k">struct</span> <span class="n">inode</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">qstr</span> <span class="o">*</span><span class="p">,</span>
			    <span class="k">struct</span> <span class="n">nfs_fh</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">nfs_fattr</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">nfs4_proc_secinfo</span><span class="p">(</span><span class="k">struct</span> <span class="n">inode</span> <span class="o">*</span><span class="p">,</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">qstr</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">nfs4_secinfo_flavors</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">nfs4_release_lockowner</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs4_lock_state</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">xattr_handler</span> <span class="o">*</span><span class="n">nfs4_xattr_handlers</span><span class="p">[];</span>

<span class="cp">#if defined(CONFIG_NFS_V4_1)</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">nfs4_session</span> <span class="o">*</span><span class="nf">nfs4_get_session</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">nfs_server</span> <span class="o">*</span><span class="n">server</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">server</span><span class="o">-&gt;</span><span class="n">nfs_client</span><span class="o">-&gt;</span><span class="n">cl_session</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">extern</span> <span class="n">bool</span> <span class="n">nfs4_set_task_privileged</span><span class="p">(</span><span class="k">struct</span> <span class="n">rpc_task</span> <span class="o">*</span><span class="n">task</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">dummy</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">nfs4_setup_sequence</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">nfs_server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">nfs4_sequence_args</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="k">struct</span> <span class="n">nfs4_sequence_res</span> <span class="o">*</span><span class="n">res</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">rpc_task</span> <span class="o">*</span><span class="n">task</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">nfs41_setup_sequence</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs4_session</span> <span class="o">*</span><span class="n">session</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">nfs4_sequence_args</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="k">struct</span> <span class="n">nfs4_sequence_res</span> <span class="o">*</span><span class="n">res</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">rpc_task</span> <span class="o">*</span><span class="n">task</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nfs4_destroy_session</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs4_session</span> <span class="o">*</span><span class="n">session</span><span class="p">);</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">nfs4_session</span> <span class="o">*</span><span class="n">nfs4_alloc_session</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="n">clp</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">nfs4_proc_create_session</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">rpc_cred</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">nfs4_proc_destroy_session</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs4_session</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">rpc_cred</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">nfs4_init_session</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_server</span> <span class="o">*</span><span class="n">server</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">nfs4_proc_get_lease_time</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="n">clp</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">nfs_fsinfo</span> <span class="o">*</span><span class="n">fsinfo</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">nfs4_proc_layoutcommit</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs4_layoutcommit_data</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span>
				  <span class="n">bool</span> <span class="n">sync</span><span class="p">);</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">bool</span>
<span class="nf">is_ds_only_client</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="n">clp</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">clp</span><span class="o">-&gt;</span><span class="n">cl_exchange_flags</span> <span class="o">&amp;</span> <span class="n">EXCHGID4_FLAG_MASK_PNFS</span><span class="p">)</span> <span class="o">==</span>
		<span class="n">EXCHGID4_FLAG_USE_PNFS_DS</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">bool</span>
<span class="nf">is_ds_client</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="n">clp</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">clp</span><span class="o">-&gt;</span><span class="n">cl_exchange_flags</span> <span class="o">&amp;</span> <span class="n">EXCHGID4_FLAG_USE_PNFS_DS</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">#else </span><span class="cm">/* CONFIG_NFS_v4_1 */</span><span class="cp"></span>
<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">nfs4_session</span> <span class="o">*</span><span class="nf">nfs4_get_session</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">nfs_server</span> <span class="o">*</span><span class="n">server</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">nfs4_setup_sequence</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">nfs_server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">nfs4_sequence_args</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="k">struct</span> <span class="n">nfs4_sequence_res</span> <span class="o">*</span><span class="n">res</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">rpc_task</span> <span class="o">*</span><span class="n">task</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">nfs4_init_session</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_server</span> <span class="o">*</span><span class="n">server</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">bool</span>
<span class="nf">is_ds_only_client</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="n">clp</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">bool</span>
<span class="nf">is_ds_client</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="n">clp</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">#endif </span><span class="cm">/* CONFIG_NFS_V4_1 */</span><span class="cp"></span>

<span class="k">extern</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">nfs4_minor_version_ops</span> <span class="o">*</span><span class="n">nfs_v4_minor_ops</span><span class="p">[];</span>

<span class="k">extern</span> <span class="k">const</span> <span class="n">u32</span> <span class="n">nfs4_fattr_bitmap</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="k">extern</span> <span class="k">const</span> <span class="n">u32</span> <span class="n">nfs4_statfs_bitmap</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="k">extern</span> <span class="k">const</span> <span class="n">u32</span> <span class="n">nfs4_pathconf_bitmap</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="k">extern</span> <span class="k">const</span> <span class="n">u32</span> <span class="n">nfs4_fsinfo_bitmap</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="k">extern</span> <span class="k">const</span> <span class="n">u32</span> <span class="n">nfs4_fs_locations_bitmap</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>

<span class="cm">/* nfs4renewd.c */</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nfs4_schedule_state_renewal</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nfs4_renewd_prepare_shutdown</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_server</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nfs4_kill_renewd</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nfs4_renew_state</span><span class="p">(</span><span class="k">struct</span> <span class="n">work_struct</span> <span class="o">*</span><span class="p">);</span>

<span class="cm">/* nfs4state.c */</span>
<span class="k">struct</span> <span class="n">rpc_cred</span> <span class="o">*</span><span class="n">nfs4_get_setclientid_cred</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="n">clp</span><span class="p">);</span>
<span class="k">struct</span> <span class="n">rpc_cred</span> <span class="o">*</span><span class="n">nfs4_get_renew_cred_locked</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="n">clp</span><span class="p">);</span>
<span class="cp">#if defined(CONFIG_NFS_V4_1)</span>
<span class="k">struct</span> <span class="n">rpc_cred</span> <span class="o">*</span><span class="n">nfs4_get_machine_cred_locked</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="n">clp</span><span class="p">);</span>
<span class="k">struct</span> <span class="n">rpc_cred</span> <span class="o">*</span><span class="n">nfs4_get_exchange_id_cred</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="n">clp</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nfs4_schedule_session_recovery</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs4_session</span> <span class="o">*</span><span class="p">,</span> <span class="kt">int</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">nfs4_schedule_session_recovery</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs4_session</span> <span class="o">*</span><span class="n">session</span><span class="p">,</span> <span class="kt">int</span> <span class="n">err</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>
<span class="cp">#endif </span><span class="cm">/* CONFIG_NFS_V4_1 */</span><span class="cp"></span>

<span class="k">extern</span> <span class="k">struct</span> <span class="n">nfs4_state_owner</span> <span class="o">*</span><span class="n">nfs4_get_state_owner</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_server</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">rpc_cred</span> <span class="o">*</span><span class="p">,</span> <span class="n">gfp_t</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nfs4_put_state_owner</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs4_state_owner</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nfs4_purge_state_owners</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_server</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">nfs4_state</span> <span class="o">*</span> <span class="n">nfs4_get_open_state</span><span class="p">(</span><span class="k">struct</span> <span class="n">inode</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">nfs4_state_owner</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nfs4_put_open_state</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs4_state</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nfs4_close_state</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs4_state</span> <span class="o">*</span><span class="p">,</span> <span class="n">fmode_t</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nfs4_close_sync</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs4_state</span> <span class="o">*</span><span class="p">,</span> <span class="n">fmode_t</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nfs4_state_set_mode_locked</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs4_state</span> <span class="o">*</span><span class="p">,</span> <span class="n">fmode_t</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nfs_inode_find_state_and_recover</span><span class="p">(</span><span class="k">struct</span> <span class="n">inode</span> <span class="o">*</span><span class="n">inode</span><span class="p">,</span>
		<span class="k">const</span> <span class="n">nfs4_stateid</span> <span class="o">*</span><span class="n">stateid</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nfs4_schedule_lease_recovery</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nfs4_schedule_state_manager</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nfs4_schedule_path_down_recovery</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="n">clp</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nfs4_schedule_stateid_recovery</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">nfs_server</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">nfs4_state</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nfs41_handle_sequence_flag_errors</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="n">clp</span><span class="p">,</span> <span class="n">u32</span> <span class="n">flags</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nfs41_handle_recall_slot</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="n">clp</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nfs41_handle_server_scope</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_client</span> <span class="o">*</span><span class="p">,</span>
				      <span class="k">struct</span> <span class="n">nfs41_server_scope</span> <span class="o">**</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nfs4_put_lock_state</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs4_lock_state</span> <span class="o">*</span><span class="n">lsp</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">nfs4_set_lock_state</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs4_state</span> <span class="o">*</span><span class="n">state</span><span class="p">,</span> <span class="k">struct</span> <span class="n">file_lock</span> <span class="o">*</span><span class="n">fl</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nfs4_select_rw_stateid</span><span class="p">(</span><span class="n">nfs4_stateid</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">nfs4_state</span> <span class="o">*</span><span class="p">,</span>
		<span class="n">fmode_t</span><span class="p">,</span> <span class="n">fl_owner_t</span><span class="p">,</span> <span class="n">pid_t</span><span class="p">);</span>

<span class="k">extern</span> <span class="k">struct</span> <span class="n">nfs_seqid</span> <span class="o">*</span><span class="n">nfs_alloc_seqid</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_seqid_counter</span> <span class="o">*</span><span class="n">counter</span><span class="p">,</span> <span class="n">gfp_t</span> <span class="n">gfp_mask</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">nfs_wait_on_sequence</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_seqid</span> <span class="o">*</span><span class="n">seqid</span><span class="p">,</span> <span class="k">struct</span> <span class="n">rpc_task</span> <span class="o">*</span><span class="n">task</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nfs_increment_open_seqid</span><span class="p">(</span><span class="kt">int</span> <span class="n">status</span><span class="p">,</span> <span class="k">struct</span> <span class="n">nfs_seqid</span> <span class="o">*</span><span class="n">seqid</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nfs_increment_lock_seqid</span><span class="p">(</span><span class="kt">int</span> <span class="n">status</span><span class="p">,</span> <span class="k">struct</span> <span class="n">nfs_seqid</span> <span class="o">*</span><span class="n">seqid</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nfs_release_seqid</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_seqid</span> <span class="o">*</span><span class="n">seqid</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nfs_free_seqid</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_seqid</span> <span class="o">*</span><span class="n">seqid</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">nfs4_free_lock_state</span><span class="p">(</span><span class="k">struct</span> <span class="n">nfs_server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">struct</span> <span class="n">nfs4_lock_state</span> <span class="o">*</span><span class="n">lsp</span><span class="p">);</span>

<span class="k">extern</span> <span class="k">const</span> <span class="n">nfs4_stateid</span> <span class="n">zero_stateid</span><span class="p">;</span>

<span class="cm">/* nfs4xdr.c */</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">rpc_procinfo</span> <span class="n">nfs4_procedures</span><span class="p">[];</span>

<span class="k">struct</span> <span class="n">nfs4_mount_data</span><span class="p">;</span>

<span class="cm">/* callback_xdr.c */</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">svc_version</span> <span class="n">nfs4_callback_version1</span><span class="p">;</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">svc_version</span> <span class="n">nfs4_callback_version4</span><span class="p">;</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">nfs4_stateid_copy</span><span class="p">(</span><span class="n">nfs4_stateid</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span> <span class="k">const</span> <span class="n">nfs4_stateid</span> <span class="o">*</span><span class="n">src</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">memcpy</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">dst</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">bool</span> <span class="nf">nfs4_stateid_match</span><span class="p">(</span><span class="k">const</span> <span class="n">nfs4_stateid</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span> <span class="k">const</span> <span class="n">nfs4_stateid</span> <span class="o">*</span><span class="n">src</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">memcmp</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">dst</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#else</span>

<span class="cp">#define nfs4_close_state(a, b) do { } while (0)</span>
<span class="cp">#define nfs4_close_sync(a, b) do { } while (0)</span>

<span class="cp">#endif </span><span class="cm">/* CONFIG_NFS_V4 */</span><span class="cp"></span>
<span class="cp">#endif </span><span class="cm">/* __LINUX_FS_NFS_NFS4_FS.H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
