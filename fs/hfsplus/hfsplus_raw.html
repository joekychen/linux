<!DOCTYPE html>
<html><head><title>joekychen/linux » fs › hfsplus › hfsplus_raw.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>hfsplus_raw.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> *  linux/include/linux/hfsplus_raw.h</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 1999</span>
<span class="cm"> * Brad Boyer (flar@pants.nu)</span>
<span class="cm"> * (C) 2003 Ardis Technologies &lt;roman@ardistech.com&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * Format of structures on disk</span>
<span class="cm"> * Information taken from Apple Technote #1150 (HFS Plus Volume Format)</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _LINUX_HFSPLUS_RAW_H</span>
<span class="cp">#define _LINUX_HFSPLUS_RAW_H</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>

<span class="cm">/* Some constants */</span>
<span class="cp">#define HFSPLUS_SECTOR_SIZE        512</span>
<span class="cp">#define HFSPLUS_SECTOR_SHIFT         9</span>
<span class="cp">#define HFSPLUS_VOLHEAD_SECTOR       2</span>
<span class="cp">#define HFSPLUS_VOLHEAD_SIG     0x482b</span>
<span class="cp">#define HFSPLUS_VOLHEAD_SIGX    0x4858</span>
<span class="cp">#define HFSPLUS_SUPER_MAGIC     0x482b</span>
<span class="cp">#define HFSPLUS_MIN_VERSION          4</span>
<span class="cp">#define HFSPLUS_CURRENT_VERSION      5</span>

<span class="cp">#define HFSP_WRAP_MAGIC         0x4244</span>
<span class="cp">#define HFSP_WRAP_ATTRIB_SLOCK  0x8000</span>
<span class="cp">#define HFSP_WRAP_ATTRIB_SPARED 0x0200</span>

<span class="cp">#define HFSP_WRAPOFF_SIG          0x00</span>
<span class="cp">#define HFSP_WRAPOFF_ATTRIB       0x0A</span>
<span class="cp">#define HFSP_WRAPOFF_ABLKSIZE     0x14</span>
<span class="cp">#define HFSP_WRAPOFF_ABLKSTART    0x1C</span>
<span class="cp">#define HFSP_WRAPOFF_EMBEDSIG     0x7C</span>
<span class="cp">#define HFSP_WRAPOFF_EMBEDEXT     0x7E</span>

<span class="cp">#define HFSP_HIDDENDIR_NAME \</span>
<span class="cp">	&quot;\xe2\x90\x80\xe2\x90\x80\xe2\x90\x80\xe2\x90\x80HFS+ Private Data&quot;</span>

<span class="cp">#define HFSP_HARDLINK_TYPE	0x686c6e6b	</span><span class="cm">/* &#39;hlnk&#39; */</span><span class="cp"></span>
<span class="cp">#define HFSP_HFSPLUS_CREATOR	0x6866732b	</span><span class="cm">/* &#39;hfs+&#39; */</span><span class="cp"></span>

<span class="cp">#define HFSP_SYMLINK_TYPE	0x736c6e6b	</span><span class="cm">/* &#39;slnk&#39; */</span><span class="cp"></span>
<span class="cp">#define HFSP_SYMLINK_CREATOR	0x72686170	</span><span class="cm">/* &#39;rhap&#39; */</span><span class="cp"></span>

<span class="cp">#define HFSP_MOUNT_VERSION	0x482b4c78	</span><span class="cm">/* &#39;H+Lx&#39; */</span><span class="cp"></span>

<span class="cm">/* Structures used on disk */</span>

<span class="k">typedef</span> <span class="n">__be32</span> <span class="n">hfsplus_cnid</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">__be16</span> <span class="n">hfsplus_unichr</span><span class="p">;</span>

<span class="cm">/* A &quot;string&quot; as used in filenames, etc. */</span>
<span class="k">struct</span> <span class="n">hfsplus_unistr</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">length</span><span class="p">;</span>
	<span class="n">hfsplus_unichr</span> <span class="n">unicode</span><span class="p">[</span><span class="mi">255</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HFSPLUS_MAX_STRLEN 255</span>

<span class="cm">/* POSIX permissions */</span>
<span class="k">struct</span> <span class="n">hfsplus_perm</span> <span class="p">{</span>
	<span class="n">__be32</span> <span class="n">owner</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">group</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">rootflags</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">userflags</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">mode</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">dev</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HFSPLUS_FLG_NODUMP	0x01</span>
<span class="cp">#define HFSPLUS_FLG_IMMUTABLE	0x02</span>
<span class="cp">#define HFSPLUS_FLG_APPEND	0x04</span>

<span class="cm">/* A single contiguous area of a file */</span>
<span class="k">struct</span> <span class="n">hfsplus_extent</span> <span class="p">{</span>
	<span class="n">__be32</span> <span class="n">start_block</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">block_count</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">hfsplus_extent</span> <span class="n">hfsplus_extent_rec</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>

<span class="cm">/* Information for a &quot;Fork&quot; in a file */</span>
<span class="k">struct</span> <span class="n">hfsplus_fork_raw</span> <span class="p">{</span>
	<span class="n">__be64</span> <span class="n">total_size</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">clump_size</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">total_blocks</span><span class="p">;</span>
	<span class="n">hfsplus_extent_rec</span> <span class="n">extents</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* HFS+ Volume Header */</span>
<span class="k">struct</span> <span class="n">hfsplus_vh</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">signature</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">version</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">attributes</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">last_mount_vers</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserved</span><span class="p">;</span>

	<span class="n">__be32</span> <span class="n">create_date</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">modify_date</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">backup_date</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">checked_date</span><span class="p">;</span>

	<span class="n">__be32</span> <span class="n">file_count</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">folder_count</span><span class="p">;</span>

	<span class="n">__be32</span> <span class="n">blocksize</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">total_blocks</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">free_blocks</span><span class="p">;</span>

	<span class="n">__be32</span> <span class="n">next_alloc</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">rsrc_clump_sz</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">data_clump_sz</span><span class="p">;</span>
	<span class="n">hfsplus_cnid</span> <span class="n">next_cnid</span><span class="p">;</span>

	<span class="n">__be32</span> <span class="n">write_count</span><span class="p">;</span>
	<span class="n">__be64</span> <span class="n">encodings_bmp</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">finder_info</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>

	<span class="k">struct</span> <span class="n">hfsplus_fork_raw</span> <span class="n">alloc_file</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hfsplus_fork_raw</span> <span class="n">ext_file</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hfsplus_fork_raw</span> <span class="n">cat_file</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hfsplus_fork_raw</span> <span class="n">attr_file</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hfsplus_fork_raw</span> <span class="n">start_file</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* HFS+ volume attributes */</span>
<span class="cp">#define HFSPLUS_VOL_UNMNT		(1 &lt;&lt; 8)</span>
<span class="cp">#define HFSPLUS_VOL_SPARE_BLK		(1 &lt;&lt; 9)</span>
<span class="cp">#define HFSPLUS_VOL_NOCACHE		(1 &lt;&lt; 10)</span>
<span class="cp">#define HFSPLUS_VOL_INCNSTNT		(1 &lt;&lt; 11)</span>
<span class="cp">#define HFSPLUS_VOL_NODEID_REUSED	(1 &lt;&lt; 12)</span>
<span class="cp">#define HFSPLUS_VOL_JOURNALED		(1 &lt;&lt; 13)</span>
<span class="cp">#define HFSPLUS_VOL_SOFTLOCK		(1 &lt;&lt; 15)</span>

<span class="cm">/* HFS+ BTree node descriptor */</span>
<span class="k">struct</span> <span class="n">hfs_bnode_desc</span> <span class="p">{</span>
	<span class="n">__be32</span> <span class="n">next</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">prev</span><span class="p">;</span>
	<span class="n">s8</span> <span class="n">type</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">height</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">num_recs</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">reserved</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* HFS+ BTree node types */</span>
<span class="cp">#define HFS_NODE_INDEX	0x00</span>
<span class="cp">#define HFS_NODE_HEADER	0x01</span>
<span class="cp">#define HFS_NODE_MAP	0x02</span>
<span class="cp">#define HFS_NODE_LEAF	0xFF</span>

<span class="cm">/* HFS+ BTree header */</span>
<span class="k">struct</span> <span class="n">hfs_btree_header_rec</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">depth</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">root</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">leaf_count</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">leaf_head</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">leaf_tail</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">node_size</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">max_key_len</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">node_count</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">free_nodes</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">reserved1</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">clump_size</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">btree_type</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">key_type</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">attributes</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserved3</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* BTree attributes */</span>
<span class="cp">#define HFS_TREE_BIGKEYS	2</span>
<span class="cp">#define HFS_TREE_VARIDXKEYS	4</span>

<span class="cm">/* HFS+ BTree misc info */</span>
<span class="cp">#define HFSPLUS_TREE_HEAD 0</span>
<span class="cp">#define HFSPLUS_NODE_MXSZ 32768</span>

<span class="cm">/* Some special File ID numbers (stolen from hfs.h) */</span>
<span class="cp">#define HFSPLUS_POR_CNID		1	</span><span class="cm">/* Parent Of the Root */</span><span class="cp"></span>
<span class="cp">#define HFSPLUS_ROOT_CNID		2	</span><span class="cm">/* ROOT directory */</span><span class="cp"></span>
<span class="cp">#define HFSPLUS_EXT_CNID		3	</span><span class="cm">/* EXTents B-tree */</span><span class="cp"></span>
<span class="cp">#define HFSPLUS_CAT_CNID		4	</span><span class="cm">/* CATalog B-tree */</span><span class="cp"></span>
<span class="cp">#define HFSPLUS_BAD_CNID		5	</span><span class="cm">/* BAD blocks file */</span><span class="cp"></span>
<span class="cp">#define HFSPLUS_ALLOC_CNID		6	</span><span class="cm">/* ALLOCation file */</span><span class="cp"></span>
<span class="cp">#define HFSPLUS_START_CNID		7	</span><span class="cm">/* STARTup file */</span><span class="cp"></span>
<span class="cp">#define HFSPLUS_ATTR_CNID		8	</span><span class="cm">/* ATTRibutes file */</span><span class="cp"></span>
<span class="cp">#define HFSPLUS_EXCH_CNID		15	</span><span class="cm">/* ExchangeFiles temp id */</span><span class="cp"></span>
<span class="cp">#define HFSPLUS_FIRSTUSER_CNID		16	</span><span class="cm">/* first available user id */</span><span class="cp"></span>

<span class="cm">/* btree key type */</span>
<span class="cp">#define HFSPLUS_KEY_CASEFOLDING		0xCF	</span><span class="cm">/* case-insensitive */</span><span class="cp"></span>
<span class="cp">#define HFSPLUS_KEY_BINARY		0xBC	</span><span class="cm">/* case-sensitive */</span><span class="cp"></span>

<span class="cm">/* HFS+ catalog entry key */</span>
<span class="k">struct</span> <span class="n">hfsplus_cat_key</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">key_len</span><span class="p">;</span>
	<span class="n">hfsplus_cnid</span> <span class="n">parent</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hfsplus_unistr</span> <span class="n">name</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HFSPLUS_CAT_KEYLEN	(sizeof(struct hfsplus_cat_key))</span>

<span class="cm">/* Structs from hfs.h */</span>
<span class="k">struct</span> <span class="n">hfsp_point</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">v</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">h</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">hfsp_rect</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">top</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">left</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">bottom</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">right</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>


<span class="cm">/* HFS directory info (stolen from hfs.h */</span>
<span class="k">struct</span> <span class="n">DInfo</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">hfsp_rect</span> <span class="n">frRect</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">frFlags</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hfsp_point</span> <span class="n">frLocation</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">frView</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">DXInfo</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">hfsp_point</span> <span class="n">frScroll</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">frOpenChain</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">frUnused</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">frComment</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">frPutAway</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* HFS+ folder data (part of an hfsplus_cat_entry) */</span>
<span class="k">struct</span> <span class="n">hfsplus_cat_folder</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">type</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">flags</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">valence</span><span class="p">;</span>
	<span class="n">hfsplus_cnid</span> <span class="n">id</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">create_date</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">content_mod_date</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">attribute_mod_date</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">access_date</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">backup_date</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hfsplus_perm</span> <span class="n">permissions</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">DInfo</span> <span class="n">user_info</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">DXInfo</span> <span class="n">finder_info</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">text_encoding</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserved</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* HFS file info (stolen from hfs.h) */</span>
<span class="k">struct</span> <span class="n">FInfo</span> <span class="p">{</span>
	<span class="n">__be32</span> <span class="n">fdType</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">fdCreator</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">fdFlags</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hfsp_point</span> <span class="n">fdLocation</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">fdFldr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">FXInfo</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">fdIconID</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">fdUnused</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
	<span class="n">__be16</span> <span class="n">fdComment</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">fdPutAway</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* HFS+ file data (part of a cat_entry) */</span>
<span class="k">struct</span> <span class="n">hfsplus_cat_file</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">type</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">flags</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserved1</span><span class="p">;</span>
	<span class="n">hfsplus_cnid</span> <span class="n">id</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">create_date</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">content_mod_date</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">attribute_mod_date</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">access_date</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">backup_date</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hfsplus_perm</span> <span class="n">permissions</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">FInfo</span> <span class="n">user_info</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">FXInfo</span> <span class="n">finder_info</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">text_encoding</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserved2</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">hfsplus_fork_raw</span> <span class="n">data_fork</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hfsplus_fork_raw</span> <span class="n">rsrc_fork</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* File attribute bits */</span>
<span class="cp">#define HFSPLUS_FILE_LOCKED		0x0001</span>
<span class="cp">#define HFSPLUS_FILE_THREAD_EXISTS	0x0002</span>

<span class="cm">/* HFS+ catalog thread (part of a cat_entry) */</span>
<span class="k">struct</span> <span class="n">hfsplus_cat_thread</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">type</span><span class="p">;</span>
	<span class="n">s16</span> <span class="n">reserved</span><span class="p">;</span>
	<span class="n">hfsplus_cnid</span> <span class="n">parentID</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hfsplus_unistr</span> <span class="n">nodeName</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HFSPLUS_MIN_THREAD_SZ 10</span>

<span class="cm">/* A data record in the catalog tree */</span>
<span class="k">typedef</span> <span class="k">union</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">type</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hfsplus_cat_folder</span> <span class="n">folder</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hfsplus_cat_file</span> <span class="n">file</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hfsplus_cat_thread</span> <span class="kr">thread</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">hfsplus_cat_entry</span><span class="p">;</span>

<span class="cm">/* HFS+ catalog entry type */</span>
<span class="cp">#define HFSPLUS_FOLDER         0x0001</span>
<span class="cp">#define HFSPLUS_FILE           0x0002</span>
<span class="cp">#define HFSPLUS_FOLDER_THREAD  0x0003</span>
<span class="cp">#define HFSPLUS_FILE_THREAD    0x0004</span>

<span class="cm">/* HFS+ extents tree key */</span>
<span class="k">struct</span> <span class="n">hfsplus_ext_key</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">key_len</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">fork_type</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">pad</span><span class="p">;</span>
	<span class="n">hfsplus_cnid</span> <span class="n">cnid</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">start_block</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HFSPLUS_EXT_KEYLEN	sizeof(struct hfsplus_ext_key)</span>

<span class="cm">/* HFS+ generic BTree key */</span>
<span class="k">typedef</span> <span class="k">union</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">key_len</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hfsplus_cat_key</span> <span class="n">cat</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hfsplus_ext_key</span> <span class="n">ext</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">hfsplus_btree_key</span><span class="p">;</span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
