f | hfsplus_fs.h | s | 13K | 395 | Matthew Garrett | mjg@redhat.com | 1332293393 |  | hfsplus: add an ioctl to bless files  Making an hfsplus partition bootable requires the ability to "bless" a file by putting its inode number in the volume header. Doing this from userspace on a mounted filesystem is impractical since the kernel will write back the original values on unmount. Add an ioctl to allow userspace to update the volume header information based on the target file.  Signed-off-by: Matthew Garrett <mjg@redhat.com> Signed-off-by: Christoph Hellwig <hch@lst.de> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | dir.c | s | 12K | 475 | Greg Kroah-Hartman | gregkh@linuxfoundation.org | 1336176684 |  | hfsplus: Fix potential buffer overflows  Commit ec81aecb2966 ("hfs: fix a potential buffer overflow") fixed a few potential buffer overflows in the hfs filesystem.  But as Timo Warns pointed out, these changes also need to be made on the hfsplus filesystem as well.  Reported-by: Timo Warns <warns@pre-sense.de> Acked-by: WANG Cong <amwang@redhat.com> Cc: Alexey Khoroshilov <khoroshilov@ispras.ru> Cc: Miklos Szeredi <mszeredi@suse.cz> Cc: Sage Weil <sage@newdream.net> Cc: Eugene Teo <eteo@redhat.com> Cc: Roman Zippel <zippel@linux-m68k.org> Cc: Al Viro <viro@zeniv.linux.org.uk> Cc: Christoph Hellwig <hch@lst.de> Cc: Alexey Dobriyan <adobriyan@gmail.com> Cc: Dave Anderson <anderson@redhat.com> Cc: stable <stable@vger.kernel.org> Cc: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | options.c | s | 5.1K | 211 | Al Viro | viro@zeniv.linux.org.uk | 1325909994 |  | vfs: switch ->show_options() to struct dentry *  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | Makefile | g | 260B |  | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | super.c | s | 15K | 538 | Jan Kara | jack@suse.cz | 1336283021 |  | vfs: Rename end_writeback() to clear_inode()  After we moved inode_sync_wait() from end_writeback() it doesn't make sense to call the function end_writeback() anymore. Rename it to clear_inode() which well says what the function really does - set I_CLEAR flag.  Signed-off-by: Jan Kara <jack@suse.cz> Signed-off-by: Fengguang Wu <fengguang.wu@intel.com>
f | bnode.c | s | 15K | 587 | Anton Salikhmetov | alexo@tuxera.com | 1292519326 |  | hfsplus: %L-to-%ll, macro correction, and remove unneeded braces  Clean-up based on checkpatch.pl report against unnecessary braces (`{' and `}'), non-standard format option %Lu (%llu recommended) as well as one trailing statement in a macro definition which should have been on the next line.  Signed-off-by: Anton Salikhmetov <alexo@tuxera.com> Signed-off-by: Christoph Hellwig <hch@tuxera.com>
f | unicode.c | s | 9.3K | 428 | Anton Salikhmetov | alexo@tuxera.com | 1309434058 |  | hfsplus: assignments inside `if' condition clean-up  Make assignments outside `if' conditions for unicode.c module where the checkpatch.pl script reported this coding style error.  Signed-off-by: Anton Salikhmetov <alexo@tuxera.com> Signed-off-by: Christoph Hellwig <hch@tuxera.com>
f | bitmap.c | s | 4.8K | 219 | Anton Salikhmetov | alexo@tuxera.com | 1292519325 |  | hfsplus: over 80 character lines clean-up  Match coding style line length limitation where checkpatch.pl reported over-80-character-line warnings.  Signed-off-by: Anton Salikhmetov <alexo@tuxera.com> Signed-off-by: Christoph Hellwig <hch@tuxera.com>
f | inode.c | s | 16K | 553 | Matthew Garrett | mjg@redhat.com | 1332293392 |  | hfsplus: initialise userflags  The userflags field was being written to the filesystem without being initialised. Make sure it's clear, since otherwise files end up with garbage attributes.  Signed-off-by: Matthew Garrett <mjg@redhat.com> Signed-off-by: Christoph Hellwig <hch@lst.de> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | brec.c | s | 13K | 456 | Naohiro Aota | naota@elisp.net | 1311345416 |  | hfsplus: Add additional range check to handle on-disk corruptions  'recoff' is read from disk and used for an argument to memcpy, so if the value read from disk is larger than the page size, it result to "general protection fault". This patch add additional range check for the value, so that disk fuzz won't cause such fault.  Signed-off-by: Naohiro Aota <naota@elisp.net> Signed-off-by: Christoph Hellwig <hch@lst.de>
f | hfsplus_raw.h | s | 7.4K | 283 | Matthew Garrett | mjg@redhat.com | 1332293392 |  | hfsplus: change finder_info to u32  The finder_info block in the hfsplus volume header is currently defined as an array of 8 bit values, but TN1150 defines it as being an array of 32 bit values. Fix for convenience.  Signed-off-by: Matthew Garrett <mjg@redhat.com> Signed-off-by: Christoph Hellwig <hch@lst.de> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | part_tbl.c | s | 4.2K | 139 | Seth Forshee | seth.forshee@canonical.com | 1311345464 |  | hfsplus: ensure bio requests are not smaller than the hardware sectors  Currently all bio requests are 512 bytes, which may fail for media whose physical sector size is larger than this. Ensure these requests are not smaller than the block device logical block size.  BugLink: http://bugs.launchpad.net/bugs/734883 Signed-off-by: Seth Forshee <seth.forshee@canonical.com> Signed-off-by: Christoph Hellwig <hch@lst.de>
f | catalog.c | s | 11K | 375 | Greg Kroah-Hartman | gregkh@linuxfoundation.org | 1336176684 |  | hfsplus: Fix potential buffer overflows  Commit ec81aecb2966 ("hfs: fix a potential buffer overflow") fixed a few potential buffer overflows in the hfs filesystem.  But as Timo Warns pointed out, these changes also need to be made on the hfsplus filesystem as well.  Reported-by: Timo Warns <warns@pre-sense.de> Acked-by: WANG Cong <amwang@redhat.com> Cc: Alexey Khoroshilov <khoroshilov@ispras.ru> Cc: Miklos Szeredi <mszeredi@suse.cz> Cc: Sage Weil <sage@newdream.net> Cc: Eugene Teo <eteo@redhat.com> Cc: Roman Zippel <zippel@linux-m68k.org> Cc: Al Viro <viro@zeniv.linux.org.uk> Cc: Christoph Hellwig <hch@lst.de> Cc: Alexey Dobriyan <adobriyan@gmail.com> Cc: Dave Anderson <anderson@redhat.com> Cc: stable <stable@vger.kernel.org> Cc: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | btree.c | s | 8.8K | 337 | Anton Salikhmetov | alexo@tuxera.com | 1292519325 |  | hfsplus: over 80 character lines clean-up  Match coding style line length limitation where checkpatch.pl reported over-80-character-line warnings.  Signed-off-by: Anton Salikhmetov <alexo@tuxera.com> Signed-off-by: Christoph Hellwig <hch@tuxera.com>
f | bfind.c | s | 4.6K | 207 | Anton Salikhmetov | alexo@tuxera.com | 1292519325 |  | hfsplus: over 80 character lines clean-up  Match coding style line length limitation where checkpatch.pl reported over-80-character-line warnings.  Signed-off-by: Anton Salikhmetov <alexo@tuxera.com> Signed-off-by: Christoph Hellwig <hch@tuxera.com>
f | tables.c | s | 119K | 3217 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | ioctl.c | s | 6.2K | 222 | Matthew Garrett | mjg@redhat.com | 1339969199 |  | hfsplus: fix bless ioctl when used with hardlinks  HFS+ doesn't really implement hard links - instead, hardlinks are indicated by a magic file type which refers to an indirect node in a hidden directory. The spec indicates that stat() should return the inode number of the indirect node, but it turns out that this doesn't satisfy the firmware when it's looking for a bootloader - it wants the catalog ID of the hardlink file instead. Fix up this case.  Signed-off-by: Matthew Garrett <mjg@redhat.com> Signed-off-by: Christoph Hellwig <hch@lst.de> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | extents.c | s | 14K | 512 | Alexey Khoroshilov | khoroshilov@ispras.ru | 1310053546 |  | hfsplus: Add error propagation for hfsplus_ext_write_extent_locked  Implement error propagation through the callers of hfsplus_ext_write_extent_locked().  Signed-off-by: Alexey Khoroshilov <khoroshilov@ispras.ru> Signed-off-by: Christoph Hellwig <hch@lst.de>
f | wrapper.c | s | 7.2K | 244 | Janne Kalliomäki | janne@tuxera.com | 1339969185 |  | hfsplus: fix overflow in sector calculations in hfsplus_submit_bio  The variable io_size was unsigned int, which caused the wrong sector number to be calculated after aligning it. This then caused mount to fail with big volumes, as backup volume header information was searched from a wrong sector.  Signed-off-by: Janne Kalliomäki <janne@tuxera.com> Signed-off-by: Christoph Hellwig <hch@lst.de> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | Kconfig | g | 511B |  | Alexey Dobriyan | adobriyan@gmail.com | 1232619357 |  | fs/Kconfig: move hfs, hfsplus out  Signed-off-by: Alexey Dobriyan <adobriyan@gmail.com>
