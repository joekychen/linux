f | partition.c | s | 8.6K | 297 | Jan Kara | jack@suse.cz | 1320101388 |  | udf: Cleanup metadata flags handling  Use simple ->s_flags variable instead of u8 variable for each flag.  Signed-off-by: Jan Kara <jack@suse.cz>
f | udf_i.h | s | 1.3K | 42 | Steve Nickel | snickel58@gmail.com | 1330548826 |  | udf: Init/maintain file entry checkpoint field  In accordance with ECMA 1.67 Part 4, 14.9.15, the checkpoint field should be initialized to 1 at creation. (Zero is *not* a valid value.)  Signed-off-by: Steven P. Nickel <snickel@focusinfo.com> Signed-off-by: Jan Kara <jack@suse.cz>
f | dir.c | s | 5.4K | 182 | Alessio Igor Bogani | abogani@texware.it | 1294329837 |  | udf: Remove unnecessary bkl usages  The udf_readdir(), udf_lookup(), udf_create(), udf_mknod(), udf_mkdir(), udf_rmdir(), udf_link(), udf_get_parent() and udf_unlink() seems already adequately protected by i_mutex held by VFS invoking calls. The udf_rename() instead should be already protected by lock_rename again by VFS. The udf_ioctl(), udf_fill_super() and udf_evict_inode() don't requires any further protection.  This work was supported by a hardware donation from the CE Linux Forum.  Signed-off-by: Alessio Igor Bogani <abogani@texware.it> Signed-off-by: Jan Kara <jack@suse.cz>
f | Makefile | g | 248B |  | Al Viro | viro@zeniv.linux.org.uk | 1244770573 |  | switch udf to simple_fsync()  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | balloc.c | s | 21K | 723 | Jan Kara | jack@suse.cz | 1330548827 |  | udf: Fix handling of i_blocks  Commit 36350462 removed unused quota support from UDF. As an unfortunate sideeffect it also removed updates of i_blocks so all files had i_block == 0. Fix the problem by returning updates of file space back to UDF allocation and freeing functions.  Signed-off-by: Jan Kara <jack@suse.cz>
f | udfdecl.h | s | 8.2K | 211 | Al Viro | viro@zeniv.linux.org.uk | 1325649308 |  | udf: propagate umode_t  note re mount options: fmask and dmask are explicitly truncated to 12bit, UDF_INVALID_MODE just needs to be guaranteed to differ from any such value. And umask is used only in &= with umode_t, so we ignore other bits anyway.  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | udf_sb.h | s | 4.3K | 150 | Al Viro | viro@zeniv.linux.org.uk | 1325649308 |  | udf: propagate umode_t  note re mount options: fmask and dmask are explicitly truncated to 12bit, UDF_INVALID_MODE just needs to be guaranteed to differ from any such value. And umask is used only in &= with umode_t, so we ignore other bits anyway.  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | ecma_167.h | s | 22K | 710 | Pekka Enberg | penberg@cs.helsinki.fi | 1238668187 |  | Remove struct typedefs from fs/udf/ecma_167.h et al.  Signed-off-by: Pekka Enberg <penberg@cs.helsinki.fi> Signed-off-by: Jan Kara <jack@suse.cz>
f | directory.c | s | 5.7K | 198 | Joe Perches | joe@perches.com | 1320101038 |  | udf: Neaten udf_debug uses  Just whitespace and argument alignment. Introduce some checkpatch warnings that deserve to be ignored.  Reviewed-by: NamJae Jeon <linkinjeon@gmail.com> Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: Jan Kara <jack@suse.cz>
f | misc.c | s | 7.8K | 262 | Joe Perches | joe@perches.com | 1318267741 |  | udf: Rename udf_error to udf_err  Rename udf_error to udf_err for consistency with normal logging uses of pr_err.  Rename function udf_err to _udf_err. Remove __func__ from uses and move __func__ to a new udf_err macro that calls _udf_err. Some of the udf_error uses had \n terminations, some did not so standardize \n's to udf_err uses, remove \n from _udf_err function. Coalesce udf_err formats. One message prefixed with udf_read_super is now prefixed with udf_fill_super.  Reviewed-by: NamJae Jeon <linkinjeon@gmail.com> Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: Jan Kara <jack@suse.cz>
f | unicode.c | s | 11K | 433 | Joe Perches | joe@perches.com | 1320101032 |  | udf: Convert printks to pr_<level>  Use the current logging styles.  Convert a few printks that should have been udf_warn and udf_err. Coalesce formats.  Add #define pr_fmt. Move an #include "udfdecls.h" above other includes in udftime.c so pr_fmt works correctly.  Strip prefixes from conversions as appropriate. Reorder logging definitions in udfdecl.h  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: Jan Kara <jack@suse.cz>
f | udftime.c | s | 5.8K | 144 | Joe Perches | joe@perches.com | 1320101032 |  | udf: Convert printks to pr_<level>  Use the current logging styles.  Convert a few printks that should have been udf_warn and udf_err. Coalesce formats.  Add #define pr_fmt. Move an #include "udfdecls.h" above other includes in udftime.c so pr_fmt works correctly.  Strip prefixes from conversions as appropriate. Reorder logging definitions in udfdecl.h  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: Jan Kara <jack@suse.cz>
f | super.c | s | 61K | 2044 | Jan Kara | jack@suse.cz | 1340904669 |  | udf: Fortify loading of sparing table  Add sanity checks when loading sparing table from disk to avoid accessing unallocated memory or writing to it.  Signed-off-by: Jan Kara <jack@suse.cz>
f | inode.c | s | 61K | 1939 | Jan Kara | jack@suse.cz | 1336283021 |  | vfs: Rename end_writeback() to clear_inode()  After we moved inode_sync_wait() from end_writeback() it doesn't make sense to call the function end_writeback() anymore. Rename it to clear_inode() which well says what the function really does - set I_CLEAR flag.  Signed-off-by: Jan Kara <jack@suse.cz> Signed-off-by: Fengguang Wu <fengguang.wu@intel.com>
f | truncate.c | s | 7.9K | 261 | Joe Perches | joe@perches.com | 1320101032 |  | udf: Convert printks to pr_<level>  Use the current logging styles.  Convert a few printks that should have been udf_warn and udf_err. Coalesce formats.  Add #define pr_fmt. Move an #include "udfdecls.h" above other includes in udftime.c so pr_fmt works correctly.  Strip prefixes from conversions as appropriate. Reorder logging definitions in udfdecl.h  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: Jan Kara <jack@suse.cz>
f | symlink.c | s | 2.6K | 113 | Jan Kara | jack@suse.cz | 1326113528 |  | udf: Treat symlink component of type 2 as /  Currently, we ignore symlink component of type 2. But mkisofs and other OS' seem to treat it as / so do the same for compatibility.  Reported-by: "GÃ¡bor S." <otnaccess@hotmail.com> Signed-off-by: Jan Kara <jack@suse.cz>
f | ialloc.c | s | 3.3K | 118 | Steve Nickel | snickel58@gmail.com | 1330548826 |  | udf: Init/maintain file entry checkpoint field  In accordance with ECMA 1.67 Part 4, 14.9.15, the checkpoint field should be initialized to 1 at creation. (Zero is *not* a valid value.)  Signed-off-by: Steven P. Nickel <snickel@focusinfo.com> Signed-off-by: Jan Kara <jack@suse.cz>
f | lowlevel.c | s | 1.5K | 58 | Joe Perches | joe@perches.com | 1320101038 |  | udf: Neaten udf_debug uses  Just whitespace and argument alignment. Introduce some checkpatch warnings that deserve to be ignored.  Reviewed-by: NamJae Jeon <linkinjeon@gmail.com> Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: Jan Kara <jack@suse.cz>
f | udfend.h | s | 1.6K | 54 | Pekka Enberg | penberg@cs.helsinki.fi | 1238668187 |  | Remove struct typedefs from fs/udf/ecma_167.h et al.  Signed-off-by: Pekka Enberg <penberg@cs.helsinki.fi> Signed-off-by: Jan Kara <jack@suse.cz>
f | osta_udf.h | s | 8.2K | 248 | Pekka Enberg | penberg@cs.helsinki.fi | 1238668187 |  | Remove struct typedefs from fs/udf/ecma_167.h et al.  Signed-off-by: Pekka Enberg <penberg@cs.helsinki.fi> Signed-off-by: Jan Kara <jack@suse.cz>
f | namei.c | s | 33K | 1153 | Al Viro | viro@zeniv.linux.org.uk | 1338348513 |  | ->encode_fh() API change  pass inode + parent's inode or NULL instead of dentry + bool saying whether we want the parent or not.  NOTE: that needs ceph fix folded in.  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | file.c | s | 6.1K | 218 | Cong Wang | amwang@redhat.com | 1332251306 |  | udf: remove the second argument of k[un]map_atomic()  Acked-by: Jan Kara <jack@suse.cz> Signed-off-by: Cong Wang <amwang@redhat.com>
f | Kconfig | g | 541B |  | Linus Torvalds | torvalds@linux-foundation.org | 1294785952 |  | Merge branch 'for_linus' of git://git.kernel.org/pub/scm/linux/kernel/git/jack/linux-udf-2.6  * 'for_linus' of git://git.kernel.org/pub/scm/linux/kernel/git/jack/linux-udf-2.6:   UDF: Close small mem leak in udf_find_entry()   udf: Fix directory corruption after extent merging   udf: Protect udf_file_aio_write from possible races   udf: Remove unnecessary bkl usages   udf: Use of s_alloc_mutex to serialize udf_relocate_blocks() execution   udf: Replace bkl with the UDF_I(inode)->i_data_sem for protect udf_inode_info struct   udf: Remove BKL from free space counting functions   udf: Call udf_add_free_space() for more blocks at once in udf_free_blocks()   udf: Remove BKL from udf_put_super() and udf_remount_fs()   udf: Protect default inode credentials by rwlock   udf: Protect all modifications of LVID with s_alloc_mutex   udf: Move handling of uniqueID into a helper function and protect it by a s_alloc_mutex   udf: Remove BKL from udf_update_inode   udf: Convert UDF_SB(sb)->s_flags to use bitops   fs/udf: Add printf format/argument verification   fs/udf: Use vzalloc  (Evil merge: this also removes the BKL dependency from the Kconfig file)
