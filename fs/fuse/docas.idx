f | dir.c | s | 41K | 1494 | Miklos Szeredi | mszeredi@suse.cz | 1337008376 |  | fuse: fix blksize calculation  Don't use inode->i_blkbits which might be stale, instead calculate the blksize information from the freshly obtained attributes.  Signed-off-by: Miklos Szeredi <mszeredi@suse.cz>
f | control.c | s | 7.8K | 292 | Peter Huewe | peterhuewe@gmx.de | 1335349505 |  | fuse: Convert to kstrtoul_from_user  This patch replaces the code for getting an number from a userspace buffer by a simple call to kstroul_from_user. This makes it easier to read and less error prone.  Signed-off-by: Peter Huewe <peterhuewe@gmx.de> Signed-off-by: Miklos Szeredi <mszeredi@suse.cz>
f | cuse.c | s | 14K | 523 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103831 |  | fs: add module.h to files that were implicitly using it  Some files were using the complete module.h infrastructure without actually including the header at all.  Fix them up in advance so once the implicit presence is removed, we won't get failures like this:    CC [M]  fs/nfsd/nfssvc.o fs/nfsd/nfssvc.c: In function 'nfsd_create_serv': fs/nfsd/nfssvc.c:335: error: 'THIS_MODULE' undeclared (first use in this function) fs/nfsd/nfssvc.c:335: error: (Each undeclared identifier is reported only once fs/nfsd/nfssvc.c:335: error: for each function it appears in.) fs/nfsd/nfssvc.c: In function 'nfsd': fs/nfsd/nfssvc.c:555: error: implicit declaration of function 'module_put_and_exit' make[3]: *** [fs/nfsd/nfssvc.o] Error 1  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | Makefile | g | 153B |  | Tejun Heo | tj@kernel.org | 1244539451 |  | CUSE: implement CUSE - Character device in Userspace  CUSE enables implementing character devices in userspace.  With recent additions of ioctl and poll support, FUSE already has most of what's necessary to implement character devices.  All CUSE has to do is bonding all those components - FUSE, chardev and the driver model - nicely.  When client opens /dev/cuse, kernel starts conversation with CUSE_INIT.  The client tells CUSE which device it wants to create.  As the previous patch made fuse_file usable without associated fuse_inode, CUSE doesn't create super block or inodes.  It attaches fuse_file to cdev file->private_data during open and set ff->fi to NULL.  The rest of the operation is almost identical to FUSE direct IO case.  Each CUSE device has a corresponding directory /sys/class/cuse/DEVNAME (which is symlink to /sys/devices/virtual/class/DEVNAME if SYSFS_DEPRECATED is turned off) which hosts "waiting" and "abort" among other things.  Those two files have the same meaning as the FUSE control files.  The only notable lacking feature compared to in-kernel implementation is mmap support.  Signed-off-by: Tejun Heo <tj@kernel.org> Signed-off-by: Miklos Szeredi <mszeredi@suse.cz>
f | fuse_i.h | s | 18K | 587 | Pavel Shilovsky | piastry@etersoft.ru | 1337008002 |  | fuse: fix stat call on 32 bit platforms  Now we store attr->ino at inode->i_ino, return attr->ino at the first time and then return inode->i_ino if the attribute timeout isn't expired. That's wrong on 32 bit platforms because attr->ino is 64 bit and inode->i_ino is 32 bit in this case.  Fix this by saving 64 bit ino in fuse_inode structure and returning it every time we call getattr. Also squash attr->ino into inode->i_ino explicitly.  Signed-off-by: Pavel Shilovsky <piastry@etersoft.ru> Signed-off-by: Miklos Szeredi <mszeredi@suse.cz>
f | inode.c | s | 28K | 1060 | Linus Torvalds | torvalds@linux-foundation.org | 1338916271 |  | Merge branch 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/mszeredi/fuse  Pull fuse updates from Miklos Szeredi.  * 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/mszeredi/fuse:   fuse: fix blksize calculation   fuse: fix stat call on 32 bit platforms   fuse: optimize fallocate on permanent failure   fuse: add FALLOCATE operation   fuse: Convert to kstrtoul_from_user
f | dev.c | s | 46K | 1790 | Cong Wang | amwang@redhat.com | 1332251302 |  | fuse: remove the second argument of k[un]map_atomic()  Signed-off-by: Cong Wang <amwang@redhat.com>
f | Kconfig | g | 579B |  | Alexey Dobriyan | adobriyan@gmail.com | 1232619355 |  | fs/Kconfig: move fuse out  Signed-off-by: Alexey Dobriyan <adobriyan@gmail.com>
f | file.c | s | 53K | 1910 | Linus Torvalds | torvalds@linux-foundation.org | 1338916271 |  | Merge branch 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/mszeredi/fuse  Pull fuse updates from Miklos Szeredi.  * 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/mszeredi/fuse:   fuse: fix blksize calculation   fuse: fix stat call on 32 bit platforms   fuse: optimize fallocate on permanent failure   fuse: add FALLOCATE operation   fuse: Convert to kstrtoul_from_user
