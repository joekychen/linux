<!DOCTYPE html>
<html><head><title>joekychen/linux » fs › reiserfs › procfs.c

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>procfs.c</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/* -*- linux-c -*- */</span>

<span class="cm">/* fs/reiserfs/procfs.c */</span>

<span class="cm">/*</span>
<span class="cm"> * Copyright 2000 by Hans Reiser, licensing governed by reiserfs/README</span>
<span class="cm"> */</span>

<span class="cm">/* proc info support a la one created by Sizif@Botik.RU for PGC */</span>

<span class="cp">#include &lt;linux/module.h&gt;</span>
<span class="cp">#include &lt;linux/time.h&gt;</span>
<span class="cp">#include &lt;linux/seq_file.h&gt;</span>
<span class="cp">#include &lt;asm/uaccess.h&gt;</span>
<span class="cp">#include &quot;reiserfs.h&quot;</span>
<span class="cp">#include &lt;linux/init.h&gt;</span>
<span class="cp">#include &lt;linux/proc_fs.h&gt;</span>

<span class="cm">/*</span>
<span class="cm"> * LOCKING:</span>
<span class="cm"> *</span>
<span class="cm"> * We rely on new Alexander Viro&#39;s super-block locking.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">show_version</span><span class="p">(</span><span class="k">struct</span> <span class="n">seq_file</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="k">struct</span> <span class="n">super_block</span> <span class="o">*</span><span class="n">sb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">char</span> <span class="o">*</span><span class="n">format</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">REISERFS_SB</span><span class="p">(</span><span class="n">sb</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">s_properties</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">REISERFS_3_6</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">format</span> <span class="o">=</span> <span class="s">&quot;3.6&quot;</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">REISERFS_SB</span><span class="p">(</span><span class="n">sb</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">s_properties</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">REISERFS_3_5</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">format</span> <span class="o">=</span> <span class="s">&quot;3.5&quot;</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">format</span> <span class="o">=</span> <span class="s">&quot;unknown&quot;</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">seq_printf</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;%s format</span><span class="se">\t</span><span class="s">with checks %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">format</span><span class="p">,</span>
<span class="cp">#if defined( CONFIG_REISERFS_CHECK )</span>
		   <span class="s">&quot;on&quot;</span>
<span class="cp">#else</span>
		   <span class="s">&quot;off&quot;</span>
<span class="cp">#endif</span>
	    <span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#define SF( x ) ( r -&gt; x )</span>
<span class="cp">#define SFP( x ) SF( s_proc_info_data.x )</span>
<span class="cp">#define SFPL( x ) SFP( x[ level ] )</span>
<span class="cp">#define SFPF( x ) SFP( scan_bitmap.x )</span>
<span class="cp">#define SFPJ( x ) SFP( journal.x )</span>

<span class="cp">#define D2C( x ) le16_to_cpu( x )</span>
<span class="cp">#define D4C( x ) le32_to_cpu( x )</span>
<span class="cp">#define DF( x ) D2C( rs -&gt; s_v1.x )</span>
<span class="cp">#define DFL( x ) D4C( rs -&gt; s_v1.x )</span>

<span class="cp">#define objectid_map( s, rs ) (old_format_only (s) ?				\</span>
<span class="cp">                         (__le32 *)((struct reiserfs_super_block_v1 *)rs + 1) :	\</span>
<span class="cp">			 (__le32 *)(rs + 1))</span>
<span class="cp">#define MAP( i ) D4C( objectid_map( sb, rs )[ i ] )</span>

<span class="cp">#define DJF( x ) le32_to_cpu( rs -&gt; x )</span>
<span class="cp">#define DJV( x ) le32_to_cpu( s_v1 -&gt; x )</span>
<span class="cp">#define DJP( x ) le32_to_cpu( jp -&gt; x )</span>
<span class="cp">#define JF( x ) ( r -&gt; s_journal -&gt; x )</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">show_super</span><span class="p">(</span><span class="k">struct</span> <span class="n">seq_file</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="k">struct</span> <span class="n">super_block</span> <span class="o">*</span><span class="n">sb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">reiserfs_sb_info</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="n">REISERFS_SB</span><span class="p">(</span><span class="n">sb</span><span class="p">);</span>

	<span class="n">seq_printf</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;state: </span><span class="se">\t</span><span class="s">%s</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;mount options: </span><span class="se">\t</span><span class="s">%s%s%s%s%s%s%s%s%s%s%s</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;gen. counter: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;s_disk_reads: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;s_disk_writes: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;s_fix_nodes: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;s_do_balance: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;s_unneeded_left_neighbor: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;s_good_search_by_key_reada: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;s_bmaps: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;s_bmaps_without_search: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;s_direct2indirect: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;s_indirect2direct: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;max_hash_collisions: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;breads: </span><span class="se">\t</span><span class="s">%lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;bread_misses: </span><span class="se">\t</span><span class="s">%lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;search_by_key: </span><span class="se">\t</span><span class="s">%lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;search_by_key_fs_changed: </span><span class="se">\t</span><span class="s">%lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;search_by_key_restarted: </span><span class="se">\t</span><span class="s">%lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;insert_item_restarted: </span><span class="se">\t</span><span class="s">%lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;paste_into_item_restarted: </span><span class="se">\t</span><span class="s">%lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;cut_from_item_restarted: </span><span class="se">\t</span><span class="s">%lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;delete_solid_item_restarted: </span><span class="se">\t</span><span class="s">%lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;delete_item_restarted: </span><span class="se">\t</span><span class="s">%lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;leaked_oid: </span><span class="se">\t</span><span class="s">%lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;leaves_removable: </span><span class="se">\t</span><span class="s">%lu</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
		   <span class="n">SF</span><span class="p">(</span><span class="n">s_mount_state</span><span class="p">)</span> <span class="o">==</span> <span class="n">REISERFS_VALID_FS</span> <span class="o">?</span>
		   <span class="s">&quot;REISERFS_VALID_FS&quot;</span> <span class="o">:</span> <span class="s">&quot;REISERFS_ERROR_FS&quot;</span><span class="p">,</span>
		   <span class="n">reiserfs_r5_hash</span><span class="p">(</span><span class="n">sb</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;FORCE_R5 &quot;</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
		   <span class="n">reiserfs_rupasov_hash</span><span class="p">(</span><span class="n">sb</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;FORCE_RUPASOV &quot;</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
		   <span class="n">reiserfs_tea_hash</span><span class="p">(</span><span class="n">sb</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;FORCE_TEA &quot;</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
		   <span class="n">reiserfs_hash_detect</span><span class="p">(</span><span class="n">sb</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;DETECT_HASH &quot;</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
		   <span class="n">reiserfs_no_border</span><span class="p">(</span><span class="n">sb</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;NO_BORDER &quot;</span> <span class="o">:</span> <span class="s">&quot;BORDER &quot;</span><span class="p">,</span>
		   <span class="n">reiserfs_no_unhashed_relocation</span><span class="p">(</span><span class="n">sb</span><span class="p">)</span> <span class="o">?</span>
		   <span class="s">&quot;NO_UNHASHED_RELOCATION &quot;</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
		   <span class="n">reiserfs_hashed_relocation</span><span class="p">(</span><span class="n">sb</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;UNHASHED_RELOCATION &quot;</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
		   <span class="n">reiserfs_test4</span><span class="p">(</span><span class="n">sb</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;TEST4 &quot;</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
		   <span class="n">have_large_tails</span><span class="p">(</span><span class="n">sb</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;TAILS &quot;</span> <span class="o">:</span> <span class="n">have_small_tails</span><span class="p">(</span><span class="n">sb</span><span class="p">)</span> <span class="o">?</span>
		   <span class="s">&quot;SMALL_TAILS &quot;</span> <span class="o">:</span> <span class="s">&quot;NO_TAILS &quot;</span><span class="p">,</span>
		   <span class="n">replay_only</span><span class="p">(</span><span class="n">sb</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;REPLAY_ONLY &quot;</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
		   <span class="n">convert_reiserfs</span><span class="p">(</span><span class="n">sb</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;CONV &quot;</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
		   <span class="n">atomic_read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">r</span><span class="o">-&gt;</span><span class="n">s_generation_counter</span><span class="p">),</span>
		   <span class="n">SF</span><span class="p">(</span><span class="n">s_disk_reads</span><span class="p">),</span> <span class="n">SF</span><span class="p">(</span><span class="n">s_disk_writes</span><span class="p">),</span> <span class="n">SF</span><span class="p">(</span><span class="n">s_fix_nodes</span><span class="p">),</span>
		   <span class="n">SF</span><span class="p">(</span><span class="n">s_do_balance</span><span class="p">),</span> <span class="n">SF</span><span class="p">(</span><span class="n">s_unneeded_left_neighbor</span><span class="p">),</span>
		   <span class="n">SF</span><span class="p">(</span><span class="n">s_good_search_by_key_reada</span><span class="p">),</span> <span class="n">SF</span><span class="p">(</span><span class="n">s_bmaps</span><span class="p">),</span>
		   <span class="n">SF</span><span class="p">(</span><span class="n">s_bmaps_without_search</span><span class="p">),</span> <span class="n">SF</span><span class="p">(</span><span class="n">s_direct2indirect</span><span class="p">),</span>
		   <span class="n">SF</span><span class="p">(</span><span class="n">s_indirect2direct</span><span class="p">),</span> <span class="n">SFP</span><span class="p">(</span><span class="n">max_hash_collisions</span><span class="p">),</span> <span class="n">SFP</span><span class="p">(</span><span class="n">breads</span><span class="p">),</span>
		   <span class="n">SFP</span><span class="p">(</span><span class="n">bread_miss</span><span class="p">),</span> <span class="n">SFP</span><span class="p">(</span><span class="n">search_by_key</span><span class="p">),</span>
		   <span class="n">SFP</span><span class="p">(</span><span class="n">search_by_key_fs_changed</span><span class="p">),</span> <span class="n">SFP</span><span class="p">(</span><span class="n">search_by_key_restarted</span><span class="p">),</span>
		   <span class="n">SFP</span><span class="p">(</span><span class="n">insert_item_restarted</span><span class="p">),</span> <span class="n">SFP</span><span class="p">(</span><span class="n">paste_into_item_restarted</span><span class="p">),</span>
		   <span class="n">SFP</span><span class="p">(</span><span class="n">cut_from_item_restarted</span><span class="p">),</span>
		   <span class="n">SFP</span><span class="p">(</span><span class="n">delete_solid_item_restarted</span><span class="p">),</span> <span class="n">SFP</span><span class="p">(</span><span class="n">delete_item_restarted</span><span class="p">),</span>
		   <span class="n">SFP</span><span class="p">(</span><span class="n">leaked_oid</span><span class="p">),</span> <span class="n">SFP</span><span class="p">(</span><span class="n">leaves_removable</span><span class="p">));</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">show_per_level</span><span class="p">(</span><span class="k">struct</span> <span class="n">seq_file</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="k">struct</span> <span class="n">super_block</span> <span class="o">*</span><span class="n">sb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">reiserfs_sb_info</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="n">REISERFS_SB</span><span class="p">(</span><span class="n">sb</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">level</span><span class="p">;</span>

	<span class="n">seq_printf</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;level</span><span class="se">\t</span><span class="s">&quot;</span>
		   <span class="s">&quot;     balances&quot;</span>
		   <span class="s">&quot; [sbk:  reads&quot;</span>
		   <span class="s">&quot;   fs_changed&quot;</span>
		   <span class="s">&quot;   restarted]&quot;</span>
		   <span class="s">&quot;   free space&quot;</span>
		   <span class="s">&quot;        items&quot;</span>
		   <span class="s">&quot;   can_remove&quot;</span>
		   <span class="s">&quot;         lnum&quot;</span>
		   <span class="s">&quot;         rnum&quot;</span>
		   <span class="s">&quot;       lbytes&quot;</span>
		   <span class="s">&quot;       rbytes&quot;</span>
		   <span class="s">&quot;     get_neig&quot;</span>
		   <span class="s">&quot; get_neig_res&quot;</span> <span class="s">&quot;  need_l_neig&quot;</span> <span class="s">&quot;  need_r_neig&quot;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">level</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">level</span> <span class="o">&lt;</span> <span class="n">MAX_HEIGHT</span><span class="p">;</span> <span class="o">++</span><span class="n">level</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">seq_printf</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;%i</span><span class="se">\t</span><span class="s">&quot;</span>
			   <span class="s">&quot; %12lu&quot;</span>
			   <span class="s">&quot; %12lu&quot;</span>
			   <span class="s">&quot; %12lu&quot;</span>
			   <span class="s">&quot; %12lu&quot;</span>
			   <span class="s">&quot; %12lu&quot;</span>
			   <span class="s">&quot; %12lu&quot;</span>
			   <span class="s">&quot; %12lu&quot;</span>
			   <span class="s">&quot; %12li&quot;</span>
			   <span class="s">&quot; %12li&quot;</span>
			   <span class="s">&quot; %12li&quot;</span>
			   <span class="s">&quot; %12li&quot;</span>
			   <span class="s">&quot; %12lu&quot;</span>
			   <span class="s">&quot; %12lu&quot;</span>
			   <span class="s">&quot; %12lu&quot;</span>
			   <span class="s">&quot; %12lu&quot;</span>
			   <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
			   <span class="n">level</span><span class="p">,</span>
			   <span class="n">SFPL</span><span class="p">(</span><span class="n">balance_at</span><span class="p">),</span>
			   <span class="n">SFPL</span><span class="p">(</span><span class="n">sbk_read_at</span><span class="p">),</span>
			   <span class="n">SFPL</span><span class="p">(</span><span class="n">sbk_fs_changed</span><span class="p">),</span>
			   <span class="n">SFPL</span><span class="p">(</span><span class="n">sbk_restarted</span><span class="p">),</span>
			   <span class="n">SFPL</span><span class="p">(</span><span class="n">free_at</span><span class="p">),</span>
			   <span class="n">SFPL</span><span class="p">(</span><span class="n">items_at</span><span class="p">),</span>
			   <span class="n">SFPL</span><span class="p">(</span><span class="n">can_node_be_removed</span><span class="p">),</span>
			   <span class="n">SFPL</span><span class="p">(</span><span class="n">lnum</span><span class="p">),</span>
			   <span class="n">SFPL</span><span class="p">(</span><span class="n">rnum</span><span class="p">),</span>
			   <span class="n">SFPL</span><span class="p">(</span><span class="n">lbytes</span><span class="p">),</span>
			   <span class="n">SFPL</span><span class="p">(</span><span class="n">rbytes</span><span class="p">),</span>
			   <span class="n">SFPL</span><span class="p">(</span><span class="n">get_neighbors</span><span class="p">),</span>
			   <span class="n">SFPL</span><span class="p">(</span><span class="n">get_neighbors_restart</span><span class="p">),</span>
			   <span class="n">SFPL</span><span class="p">(</span><span class="n">need_l_neighbor</span><span class="p">),</span> <span class="n">SFPL</span><span class="p">(</span><span class="n">need_r_neighbor</span><span class="p">)</span>
		    <span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">show_bitmap</span><span class="p">(</span><span class="k">struct</span> <span class="n">seq_file</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="k">struct</span> <span class="n">super_block</span> <span class="o">*</span><span class="n">sb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">reiserfs_sb_info</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="n">REISERFS_SB</span><span class="p">(</span><span class="n">sb</span><span class="p">);</span>

	<span class="n">seq_printf</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;free_block: %lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;  scan_bitmap:&quot;</span>
		   <span class="s">&quot;          wait&quot;</span>
		   <span class="s">&quot;          bmap&quot;</span>
		   <span class="s">&quot;         retry&quot;</span>
		   <span class="s">&quot;        stolen&quot;</span>
		   <span class="s">&quot;  journal_hint&quot;</span>
		   <span class="s">&quot;journal_nohint&quot;</span>
		   <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot; %14lu&quot;</span>
		   <span class="s">&quot; %14lu&quot;</span>
		   <span class="s">&quot; %14lu&quot;</span>
		   <span class="s">&quot; %14lu&quot;</span>
		   <span class="s">&quot; %14lu&quot;</span>
		   <span class="s">&quot; %14lu&quot;</span>
		   <span class="s">&quot; %14lu&quot;</span>
		   <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
		   <span class="n">SFP</span><span class="p">(</span><span class="n">free_block</span><span class="p">),</span>
		   <span class="n">SFPF</span><span class="p">(</span><span class="n">call</span><span class="p">),</span>
		   <span class="n">SFPF</span><span class="p">(</span><span class="n">wait</span><span class="p">),</span>
		   <span class="n">SFPF</span><span class="p">(</span><span class="n">bmap</span><span class="p">),</span>
		   <span class="n">SFPF</span><span class="p">(</span><span class="n">retry</span><span class="p">),</span>
		   <span class="n">SFPF</span><span class="p">(</span><span class="n">stolen</span><span class="p">),</span>
		   <span class="n">SFPF</span><span class="p">(</span><span class="n">in_journal_hint</span><span class="p">),</span> <span class="n">SFPF</span><span class="p">(</span><span class="n">in_journal_nohint</span><span class="p">));</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">show_on_disk_super</span><span class="p">(</span><span class="k">struct</span> <span class="n">seq_file</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="k">struct</span> <span class="n">super_block</span> <span class="o">*</span><span class="n">sb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">reiserfs_sb_info</span> <span class="o">*</span><span class="n">sb_info</span> <span class="o">=</span> <span class="n">REISERFS_SB</span><span class="p">(</span><span class="n">sb</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">reiserfs_super_block</span> <span class="o">*</span><span class="n">rs</span> <span class="o">=</span> <span class="n">sb_info</span><span class="o">-&gt;</span><span class="n">s_rs</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">hash_code</span> <span class="o">=</span> <span class="n">DFL</span><span class="p">(</span><span class="n">s_hash_function_code</span><span class="p">);</span>
	<span class="n">__u32</span> <span class="n">flags</span> <span class="o">=</span> <span class="n">DJF</span><span class="p">(</span><span class="n">s_flags</span><span class="p">);</span>

	<span class="n">seq_printf</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;block_count: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;free_blocks: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;root_block: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;blocksize: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;oid_maxsize: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;oid_cursize: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;umount_state: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;magic: </span><span class="se">\t</span><span class="s">%10.10s</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;fs_state: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;hash: </span><span class="se">\t</span><span class="s">%s</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;tree_height: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;bmap_nr: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;version: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;flags: </span><span class="se">\t</span><span class="s">%x[%s]</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;reserved_for_journal: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
		   <span class="n">DFL</span><span class="p">(</span><span class="n">s_block_count</span><span class="p">),</span>
		   <span class="n">DFL</span><span class="p">(</span><span class="n">s_free_blocks</span><span class="p">),</span>
		   <span class="n">DFL</span><span class="p">(</span><span class="n">s_root_block</span><span class="p">),</span>
		   <span class="n">DF</span><span class="p">(</span><span class="n">s_blocksize</span><span class="p">),</span>
		   <span class="n">DF</span><span class="p">(</span><span class="n">s_oid_maxsize</span><span class="p">),</span>
		   <span class="n">DF</span><span class="p">(</span><span class="n">s_oid_cursize</span><span class="p">),</span>
		   <span class="n">DF</span><span class="p">(</span><span class="n">s_umount_state</span><span class="p">),</span>
		   <span class="n">rs</span><span class="o">-&gt;</span><span class="n">s_v1</span><span class="p">.</span><span class="n">s_magic</span><span class="p">,</span>
		   <span class="n">DF</span><span class="p">(</span><span class="n">s_fs_state</span><span class="p">),</span>
		   <span class="n">hash_code</span> <span class="o">==</span> <span class="n">TEA_HASH</span> <span class="o">?</span> <span class="s">&quot;tea&quot;</span> <span class="o">:</span>
		   <span class="p">(</span><span class="n">hash_code</span> <span class="o">==</span> <span class="n">YURA_HASH</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;rupasov&quot;</span> <span class="o">:</span>
		   <span class="p">(</span><span class="n">hash_code</span> <span class="o">==</span> <span class="n">R5_HASH</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;r5&quot;</span> <span class="o">:</span>
		   <span class="p">(</span><span class="n">hash_code</span> <span class="o">==</span> <span class="n">UNSET_HASH</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;unset&quot;</span> <span class="o">:</span> <span class="s">&quot;unknown&quot;</span><span class="p">,</span>
		   <span class="n">DF</span><span class="p">(</span><span class="n">s_tree_height</span><span class="p">),</span>
		   <span class="n">DF</span><span class="p">(</span><span class="n">s_bmap_nr</span><span class="p">),</span>
		   <span class="n">DF</span><span class="p">(</span><span class="n">s_version</span><span class="p">),</span> <span class="n">flags</span><span class="p">,</span> <span class="p">(</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">reiserfs_attrs_cleared</span><span class="p">)</span>
		   <span class="o">?</span> <span class="s">&quot;attrs_cleared&quot;</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">DF</span><span class="p">(</span><span class="n">s_reserved_for_journal</span><span class="p">));</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">show_oidmap</span><span class="p">(</span><span class="k">struct</span> <span class="n">seq_file</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="k">struct</span> <span class="n">super_block</span> <span class="o">*</span><span class="n">sb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">reiserfs_sb_info</span> <span class="o">*</span><span class="n">sb_info</span> <span class="o">=</span> <span class="n">REISERFS_SB</span><span class="p">(</span><span class="n">sb</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">reiserfs_super_block</span> <span class="o">*</span><span class="n">rs</span> <span class="o">=</span> <span class="n">sb_info</span><span class="o">-&gt;</span><span class="n">s_rs</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mapsize</span> <span class="o">=</span> <span class="n">le16_to_cpu</span><span class="p">(</span><span class="n">rs</span><span class="o">-&gt;</span><span class="n">s_v1</span><span class="p">.</span><span class="n">s_oid_cursize</span><span class="p">);</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">total_used</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">mapsize</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">__u32</span> <span class="n">right</span><span class="p">;</span>

		<span class="n">right</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">mapsize</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">?</span> <span class="n">MAX_KEY_OBJECTID</span> <span class="o">:</span> <span class="n">MAP</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="n">seq_printf</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;%s: [ %x .. %x )</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
			   <span class="p">(</span><span class="n">i</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;free&quot;</span> <span class="o">:</span> <span class="s">&quot;used&quot;</span><span class="p">,</span> <span class="n">MAP</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">right</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">i</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">total_used</span> <span class="o">+=</span> <span class="n">right</span> <span class="o">-</span> <span class="n">MAP</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="cp">#if defined( REISERFS_USE_OIDMAPF )</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">sb_info</span><span class="o">-&gt;</span><span class="n">oidmap</span><span class="p">.</span><span class="n">use_file</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">sb_info</span><span class="o">-&gt;</span><span class="n">oidmap</span><span class="p">.</span><span class="n">mapf</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">loff_t</span> <span class="n">size</span> <span class="o">=</span> <span class="n">sb_info</span><span class="o">-&gt;</span><span class="n">oidmap</span><span class="p">.</span><span class="n">mapf</span><span class="o">-&gt;</span><span class="n">f_path</span><span class="p">.</span><span class="n">dentry</span><span class="o">-&gt;</span><span class="n">d_inode</span><span class="o">-&gt;</span><span class="n">i_size</span><span class="p">;</span>
		<span class="n">total_used</span> <span class="o">+=</span> <span class="n">size</span> <span class="o">/</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">reiserfs_oidinterval_d_t</span><span class="p">);</span>
	<span class="p">}</span>
<span class="cp">#endif</span>
	<span class="n">seq_printf</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;total: </span><span class="se">\t</span><span class="s">%i [%i/%i] used: %lu [exact]</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
		   <span class="n">mapsize</span><span class="p">,</span>
		   <span class="n">mapsize</span><span class="p">,</span> <span class="n">le16_to_cpu</span><span class="p">(</span><span class="n">rs</span><span class="o">-&gt;</span><span class="n">s_v1</span><span class="p">.</span><span class="n">s_oid_maxsize</span><span class="p">),</span> <span class="n">total_used</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">show_journal</span><span class="p">(</span><span class="k">struct</span> <span class="n">seq_file</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="k">struct</span> <span class="n">super_block</span> <span class="o">*</span><span class="n">sb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">reiserfs_sb_info</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="n">REISERFS_SB</span><span class="p">(</span><span class="n">sb</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">reiserfs_super_block</span> <span class="o">*</span><span class="n">rs</span> <span class="o">=</span> <span class="n">r</span><span class="o">-&gt;</span><span class="n">s_rs</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">journal_params</span> <span class="o">*</span><span class="n">jp</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">rs</span><span class="o">-&gt;</span><span class="n">s_v1</span><span class="p">.</span><span class="n">s_journal</span><span class="p">;</span>
	<span class="kt">char</span> <span class="n">b</span><span class="p">[</span><span class="n">BDEVNAME_SIZE</span><span class="p">];</span>

	<span class="n">seq_printf</span><span class="p">(</span><span class="n">m</span><span class="p">,</span>		<span class="cm">/* on-disk fields */</span>
		   <span class="s">&quot;jp_journal_1st_block: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;jp_journal_dev: </span><span class="se">\t</span><span class="s">%s[%x]</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;jp_journal_size: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;jp_journal_trans_max: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;jp_journal_magic: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;jp_journal_max_batch: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;jp_journal_max_commit_age: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;jp_journal_max_trans_age: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="cm">/* incore fields */</span>
		   <span class="s">&quot;j_1st_reserved_block: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;j_state: </span><span class="se">\t</span><span class="s">%li</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;j_trans_id: </span><span class="se">\t</span><span class="s">%u</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;j_mount_id: </span><span class="se">\t</span><span class="s">%lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;j_start: </span><span class="se">\t</span><span class="s">%lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;j_len: </span><span class="se">\t</span><span class="s">%lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;j_len_alloc: </span><span class="se">\t</span><span class="s">%lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;j_wcount: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;j_bcount: </span><span class="se">\t</span><span class="s">%lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;j_first_unflushed_offset: </span><span class="se">\t</span><span class="s">%lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;j_last_flush_trans_id: </span><span class="se">\t</span><span class="s">%u</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;j_trans_start_time: </span><span class="se">\t</span><span class="s">%li</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;j_list_bitmap_index: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;j_must_wait: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;j_next_full_flush: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;j_next_async_flush: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;j_cnode_used: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span> <span class="s">&quot;j_cnode_free: </span><span class="se">\t</span><span class="s">%i</span><span class="se">\n</span><span class="s">&quot;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="cm">/* reiserfs_proc_info_data_t.journal fields */</span>
		   <span class="s">&quot;in_journal: </span><span class="se">\t</span><span class="s">%12lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;in_journal_bitmap: </span><span class="se">\t</span><span class="s">%12lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;in_journal_reusable: </span><span class="se">\t</span><span class="s">%12lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;lock_journal: </span><span class="se">\t</span><span class="s">%12lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;lock_journal_wait: </span><span class="se">\t</span><span class="s">%12lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;journal_begin: </span><span class="se">\t</span><span class="s">%12lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;journal_relock_writers: </span><span class="se">\t</span><span class="s">%12lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;journal_relock_wcount: </span><span class="se">\t</span><span class="s">%12lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;mark_dirty: </span><span class="se">\t</span><span class="s">%12lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;mark_dirty_already: </span><span class="se">\t</span><span class="s">%12lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;mark_dirty_notjournal: </span><span class="se">\t</span><span class="s">%12lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;restore_prepared: </span><span class="se">\t</span><span class="s">%12lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;prepare: </span><span class="se">\t</span><span class="s">%12lu</span><span class="se">\n</span><span class="s">&quot;</span>
		   <span class="s">&quot;prepare_retry: </span><span class="se">\t</span><span class="s">%12lu</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
		   <span class="n">DJP</span><span class="p">(</span><span class="n">jp_journal_1st_block</span><span class="p">),</span>
		   <span class="n">bdevname</span><span class="p">(</span><span class="n">SB_JOURNAL</span><span class="p">(</span><span class="n">sb</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">j_dev_bd</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span>
		   <span class="n">DJP</span><span class="p">(</span><span class="n">jp_journal_dev</span><span class="p">),</span>
		   <span class="n">DJP</span><span class="p">(</span><span class="n">jp_journal_size</span><span class="p">),</span>
		   <span class="n">DJP</span><span class="p">(</span><span class="n">jp_journal_trans_max</span><span class="p">),</span>
		   <span class="n">DJP</span><span class="p">(</span><span class="n">jp_journal_magic</span><span class="p">),</span>
		   <span class="n">DJP</span><span class="p">(</span><span class="n">jp_journal_max_batch</span><span class="p">),</span>
		   <span class="n">SB_JOURNAL</span><span class="p">(</span><span class="n">sb</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">j_max_commit_age</span><span class="p">,</span>
		   <span class="n">DJP</span><span class="p">(</span><span class="n">jp_journal_max_trans_age</span><span class="p">),</span>
		   <span class="n">JF</span><span class="p">(</span><span class="n">j_1st_reserved_block</span><span class="p">),</span>
		   <span class="n">JF</span><span class="p">(</span><span class="n">j_state</span><span class="p">),</span>
		   <span class="n">JF</span><span class="p">(</span><span class="n">j_trans_id</span><span class="p">),</span>
		   <span class="n">JF</span><span class="p">(</span><span class="n">j_mount_id</span><span class="p">),</span>
		   <span class="n">JF</span><span class="p">(</span><span class="n">j_start</span><span class="p">),</span>
		   <span class="n">JF</span><span class="p">(</span><span class="n">j_len</span><span class="p">),</span>
		   <span class="n">JF</span><span class="p">(</span><span class="n">j_len_alloc</span><span class="p">),</span>
		   <span class="n">atomic_read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">r</span><span class="o">-&gt;</span><span class="n">s_journal</span><span class="o">-&gt;</span><span class="n">j_wcount</span><span class="p">),</span>
		   <span class="n">JF</span><span class="p">(</span><span class="n">j_bcount</span><span class="p">),</span>
		   <span class="n">JF</span><span class="p">(</span><span class="n">j_first_unflushed_offset</span><span class="p">),</span>
		   <span class="n">JF</span><span class="p">(</span><span class="n">j_last_flush_trans_id</span><span class="p">),</span>
		   <span class="n">JF</span><span class="p">(</span><span class="n">j_trans_start_time</span><span class="p">),</span>
		   <span class="n">JF</span><span class="p">(</span><span class="n">j_list_bitmap_index</span><span class="p">),</span>
		   <span class="n">JF</span><span class="p">(</span><span class="n">j_must_wait</span><span class="p">),</span>
		   <span class="n">JF</span><span class="p">(</span><span class="n">j_next_full_flush</span><span class="p">),</span>
		   <span class="n">JF</span><span class="p">(</span><span class="n">j_next_async_flush</span><span class="p">),</span>
		   <span class="n">JF</span><span class="p">(</span><span class="n">j_cnode_used</span><span class="p">),</span>
		   <span class="n">JF</span><span class="p">(</span><span class="n">j_cnode_free</span><span class="p">),</span>
		   <span class="n">SFPJ</span><span class="p">(</span><span class="n">in_journal</span><span class="p">),</span>
		   <span class="n">SFPJ</span><span class="p">(</span><span class="n">in_journal_bitmap</span><span class="p">),</span>
		   <span class="n">SFPJ</span><span class="p">(</span><span class="n">in_journal_reusable</span><span class="p">),</span>
		   <span class="n">SFPJ</span><span class="p">(</span><span class="n">lock_journal</span><span class="p">),</span>
		   <span class="n">SFPJ</span><span class="p">(</span><span class="n">lock_journal_wait</span><span class="p">),</span>
		   <span class="n">SFPJ</span><span class="p">(</span><span class="n">journal_being</span><span class="p">),</span>
		   <span class="n">SFPJ</span><span class="p">(</span><span class="n">journal_relock_writers</span><span class="p">),</span>
		   <span class="n">SFPJ</span><span class="p">(</span><span class="n">journal_relock_wcount</span><span class="p">),</span>
		   <span class="n">SFPJ</span><span class="p">(</span><span class="n">mark_dirty</span><span class="p">),</span>
		   <span class="n">SFPJ</span><span class="p">(</span><span class="n">mark_dirty_already</span><span class="p">),</span>
		   <span class="n">SFPJ</span><span class="p">(</span><span class="n">mark_dirty_notjournal</span><span class="p">),</span>
		   <span class="n">SFPJ</span><span class="p">(</span><span class="n">restore_prepared</span><span class="p">),</span> <span class="n">SFPJ</span><span class="p">(</span><span class="n">prepare</span><span class="p">),</span> <span class="n">SFPJ</span><span class="p">(</span><span class="n">prepare_retry</span><span class="p">)</span>
	    <span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* iterator */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">test_sb</span><span class="p">(</span><span class="k">struct</span> <span class="n">super_block</span> <span class="o">*</span><span class="n">sb</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">data</span> <span class="o">==</span> <span class="n">sb</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">set_sb</span><span class="p">(</span><span class="k">struct</span> <span class="n">super_block</span> <span class="o">*</span><span class="n">sb</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="o">-</span><span class="n">ENOENT</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="o">*</span><span class="nf">r_start</span><span class="p">(</span><span class="k">struct</span> <span class="n">seq_file</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="n">loff_t</span> <span class="o">*</span> <span class="n">pos</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">proc_dir_entry</span> <span class="o">*</span><span class="n">de</span> <span class="o">=</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">private</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">super_block</span> <span class="o">*</span><span class="n">s</span> <span class="o">=</span> <span class="n">de</span><span class="o">-&gt;</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
	<span class="n">loff_t</span> <span class="n">l</span> <span class="o">=</span> <span class="o">*</span><span class="n">pos</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">l</span><span class="p">)</span>
		<span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">IS_ERR</span><span class="p">(</span><span class="n">sget</span><span class="p">(</span><span class="o">&amp;</span><span class="n">reiserfs_fs_type</span><span class="p">,</span> <span class="n">test_sb</span><span class="p">,</span> <span class="n">set_sb</span><span class="p">,</span> <span class="n">s</span><span class="p">)))</span>
		<span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>

	<span class="n">up_write</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s</span><span class="o">-&gt;</span><span class="n">s_umount</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">s</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="o">*</span><span class="nf">r_next</span><span class="p">(</span><span class="k">struct</span> <span class="n">seq_file</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">v</span><span class="p">,</span> <span class="n">loff_t</span> <span class="o">*</span> <span class="n">pos</span><span class="p">)</span>
<span class="p">{</span>
	<span class="o">++*</span><span class="n">pos</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">v</span><span class="p">)</span>
		<span class="n">deactivate_super</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
	<span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">r_stop</span><span class="p">(</span><span class="k">struct</span> <span class="n">seq_file</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">v</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">v</span><span class="p">)</span>
		<span class="n">deactivate_super</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">r_show</span><span class="p">(</span><span class="k">struct</span> <span class="n">seq_file</span> <span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">v</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">proc_dir_entry</span> <span class="o">*</span><span class="n">de</span> <span class="o">=</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">private</span><span class="p">;</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">show</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">seq_file</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">super_block</span> <span class="o">*</span><span class="p">)</span> <span class="o">=</span> <span class="n">de</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">show</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">seq_operations</span> <span class="n">r_ops</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">r_start</span><span class="p">,</span>
	<span class="p">.</span><span class="n">next</span> <span class="o">=</span> <span class="n">r_next</span><span class="p">,</span>
	<span class="p">.</span><span class="n">stop</span> <span class="o">=</span> <span class="n">r_stop</span><span class="p">,</span>
	<span class="p">.</span><span class="n">show</span> <span class="o">=</span> <span class="n">r_show</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">r_open</span><span class="p">(</span><span class="k">struct</span> <span class="n">inode</span> <span class="o">*</span><span class="n">inode</span><span class="p">,</span> <span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="n">file</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">seq_open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">r_ops</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ret</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="n">seq_file</span> <span class="o">*</span><span class="n">m</span> <span class="o">=</span> <span class="n">file</span><span class="o">-&gt;</span><span class="n">private_data</span><span class="p">;</span>
		<span class="n">m</span><span class="o">-&gt;</span><span class="n">private</span> <span class="o">=</span> <span class="n">PDE</span><span class="p">(</span><span class="n">inode</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">file_operations</span> <span class="n">r_file_operations</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">open</span> <span class="o">=</span> <span class="n">r_open</span><span class="p">,</span>
	<span class="p">.</span><span class="n">read</span> <span class="o">=</span> <span class="n">seq_read</span><span class="p">,</span>
	<span class="p">.</span><span class="n">llseek</span> <span class="o">=</span> <span class="n">seq_lseek</span><span class="p">,</span>
	<span class="p">.</span><span class="n">release</span> <span class="o">=</span> <span class="n">seq_release</span><span class="p">,</span>
	<span class="p">.</span><span class="n">owner</span> <span class="o">=</span> <span class="n">THIS_MODULE</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">proc_dir_entry</span> <span class="o">*</span><span class="n">proc_info_root</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="n">proc_info_root_name</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&quot;fs/reiserfs&quot;</span><span class="p">;</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">add_file</span><span class="p">(</span><span class="k">struct</span> <span class="n">super_block</span> <span class="o">*</span><span class="n">sb</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span>
		     <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">func</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">seq_file</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">super_block</span> <span class="o">*</span><span class="p">))</span>
<span class="p">{</span>
	<span class="n">proc_create_data</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">REISERFS_SB</span><span class="p">(</span><span class="n">sb</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">procdir</span><span class="p">,</span>
			 <span class="o">&amp;</span><span class="n">r_file_operations</span><span class="p">,</span> <span class="n">func</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">reiserfs_proc_info_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">super_block</span> <span class="o">*</span><span class="n">sb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">char</span> <span class="n">b</span><span class="p">[</span><span class="n">BDEVNAME_SIZE</span><span class="p">];</span>
	<span class="kt">char</span> <span class="o">*</span><span class="n">s</span><span class="p">;</span>

	<span class="cm">/* Some block devices use /&#39;s */</span>
	<span class="n">strlcpy</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">reiserfs_bdevname</span><span class="p">(</span><span class="n">sb</span><span class="p">),</span> <span class="n">BDEVNAME_SIZE</span><span class="p">);</span>
	<span class="n">s</span> <span class="o">=</span> <span class="n">strchr</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="sc">&#39;/&#39;</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">)</span>
		<span class="o">*</span><span class="n">s</span> <span class="o">=</span> <span class="sc">&#39;!&#39;</span><span class="p">;</span>

	<span class="n">spin_lock_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">__PINFO</span><span class="p">(</span><span class="n">sb</span><span class="p">).</span><span class="n">lock</span><span class="p">);</span>
	<span class="n">REISERFS_SB</span><span class="p">(</span><span class="n">sb</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">procdir</span> <span class="o">=</span> <span class="n">proc_mkdir</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">proc_info_root</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">REISERFS_SB</span><span class="p">(</span><span class="n">sb</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">procdir</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">REISERFS_SB</span><span class="p">(</span><span class="n">sb</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">procdir</span><span class="o">-&gt;</span><span class="n">data</span> <span class="o">=</span> <span class="n">sb</span><span class="p">;</span>
		<span class="n">add_file</span><span class="p">(</span><span class="n">sb</span><span class="p">,</span> <span class="s">&quot;version&quot;</span><span class="p">,</span> <span class="n">show_version</span><span class="p">);</span>
		<span class="n">add_file</span><span class="p">(</span><span class="n">sb</span><span class="p">,</span> <span class="s">&quot;super&quot;</span><span class="p">,</span> <span class="n">show_super</span><span class="p">);</span>
		<span class="n">add_file</span><span class="p">(</span><span class="n">sb</span><span class="p">,</span> <span class="s">&quot;per-level&quot;</span><span class="p">,</span> <span class="n">show_per_level</span><span class="p">);</span>
		<span class="n">add_file</span><span class="p">(</span><span class="n">sb</span><span class="p">,</span> <span class="s">&quot;bitmap&quot;</span><span class="p">,</span> <span class="n">show_bitmap</span><span class="p">);</span>
		<span class="n">add_file</span><span class="p">(</span><span class="n">sb</span><span class="p">,</span> <span class="s">&quot;on-disk-super&quot;</span><span class="p">,</span> <span class="n">show_on_disk_super</span><span class="p">);</span>
		<span class="n">add_file</span><span class="p">(</span><span class="n">sb</span><span class="p">,</span> <span class="s">&quot;oidmap&quot;</span><span class="p">,</span> <span class="n">show_oidmap</span><span class="p">);</span>
		<span class="n">add_file</span><span class="p">(</span><span class="n">sb</span><span class="p">,</span> <span class="s">&quot;journal&quot;</span><span class="p">,</span> <span class="n">show_journal</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">reiserfs_warning</span><span class="p">(</span><span class="n">sb</span><span class="p">,</span> <span class="s">&quot;cannot create /proc/%s/%s&quot;</span><span class="p">,</span>
			 <span class="n">proc_info_root_name</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">reiserfs_proc_info_done</span><span class="p">(</span><span class="k">struct</span> <span class="n">super_block</span> <span class="o">*</span><span class="n">sb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">proc_dir_entry</span> <span class="o">*</span><span class="n">de</span> <span class="o">=</span> <span class="n">REISERFS_SB</span><span class="p">(</span><span class="n">sb</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">procdir</span><span class="p">;</span>
	<span class="kt">char</span> <span class="n">b</span><span class="p">[</span><span class="n">BDEVNAME_SIZE</span><span class="p">];</span>
	<span class="kt">char</span> <span class="o">*</span><span class="n">s</span><span class="p">;</span>

	<span class="cm">/* Some block devices use /&#39;s */</span>
	<span class="n">strlcpy</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">reiserfs_bdevname</span><span class="p">(</span><span class="n">sb</span><span class="p">),</span> <span class="n">BDEVNAME_SIZE</span><span class="p">);</span>
	<span class="n">s</span> <span class="o">=</span> <span class="n">strchr</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="sc">&#39;/&#39;</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">)</span>
		<span class="o">*</span><span class="n">s</span> <span class="o">=</span> <span class="sc">&#39;!&#39;</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">de</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">remove_proc_entry</span><span class="p">(</span><span class="s">&quot;journal&quot;</span><span class="p">,</span> <span class="n">de</span><span class="p">);</span>
		<span class="n">remove_proc_entry</span><span class="p">(</span><span class="s">&quot;oidmap&quot;</span><span class="p">,</span> <span class="n">de</span><span class="p">);</span>
		<span class="n">remove_proc_entry</span><span class="p">(</span><span class="s">&quot;on-disk-super&quot;</span><span class="p">,</span> <span class="n">de</span><span class="p">);</span>
		<span class="n">remove_proc_entry</span><span class="p">(</span><span class="s">&quot;bitmap&quot;</span><span class="p">,</span> <span class="n">de</span><span class="p">);</span>
		<span class="n">remove_proc_entry</span><span class="p">(</span><span class="s">&quot;per-level&quot;</span><span class="p">,</span> <span class="n">de</span><span class="p">);</span>
		<span class="n">remove_proc_entry</span><span class="p">(</span><span class="s">&quot;super&quot;</span><span class="p">,</span> <span class="n">de</span><span class="p">);</span>
		<span class="n">remove_proc_entry</span><span class="p">(</span><span class="s">&quot;version&quot;</span><span class="p">,</span> <span class="n">de</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">spin_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">__PINFO</span><span class="p">(</span><span class="n">sb</span><span class="p">).</span><span class="n">lock</span><span class="p">);</span>
	<span class="n">__PINFO</span><span class="p">(</span><span class="n">sb</span><span class="p">).</span><span class="n">exiting</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">spin_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">__PINFO</span><span class="p">(</span><span class="n">sb</span><span class="p">).</span><span class="n">lock</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">proc_info_root</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">remove_proc_entry</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">proc_info_root</span><span class="p">);</span>
		<span class="n">REISERFS_SB</span><span class="p">(</span><span class="n">sb</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">procdir</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">reiserfs_proc_info_global_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">proc_info_root</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">proc_info_root</span> <span class="o">=</span> <span class="n">proc_mkdir</span><span class="p">(</span><span class="n">proc_info_root_name</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">proc_info_root</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">reiserfs_warning</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;cannot create /proc/%s&quot;</span><span class="p">,</span>
					 <span class="n">proc_info_root_name</span><span class="p">);</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">reiserfs_proc_info_global_done</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">proc_info_root</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">proc_info_root</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
		<span class="n">remove_proc_entry</span><span class="p">(</span><span class="n">proc_info_root_name</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="cm">/*</span>
<span class="cm"> * Revision 1.1.8.2  2001/07/15 17:08:42  god</span>
<span class="cm"> *  . use get_super() in procfs.c</span>
<span class="cm"> *  . remove remove_save_link() from reiserfs_do_truncate()</span>
<span class="cm"> *</span>
<span class="cm"> * I accept terms and conditions stated in the Legal Agreement</span>
<span class="cm"> * (available at http://www.namesys.com/legalese.html)</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 1.1.8.1  2001/07/11 16:48:50  god</span>
<span class="cm"> * proc info support</span>
<span class="cm"> *</span>
<span class="cm"> * I accept terms and conditions stated in the Legal Agreement</span>
<span class="cm"> * (available at http://www.namesys.com/legalese.html)</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * Make Linus happy.</span>
<span class="cm"> * Local variables:</span>
<span class="cm"> * c-indentation-style: &quot;K&amp;R&quot;</span>
<span class="cm"> * mode-name: &quot;LC&quot;</span>
<span class="cm"> * c-basic-offset: 8</span>
<span class="cm"> * tab-width: 8</span>
<span class="cm"> * End:</span>
<span class="cm"> */</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
