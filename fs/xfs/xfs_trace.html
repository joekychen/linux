<!DOCTYPE html>
<html><head><title>joekychen/linux » fs › xfs › xfs_trace.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>xfs_trace.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright (c) 2009, Christoph Hellwig</span>
<span class="cm"> * All Rights Reserved.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or</span>
<span class="cm"> * modify it under the terms of the GNU General Public License as</span>
<span class="cm"> * published by the Free Software Foundation.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it would be useful,</span>
<span class="cm"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm"> * GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License</span>
<span class="cm"> * along with this program; if not, write the Free Software Foundation,</span>
<span class="cm"> * Inc.,  51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA</span>
<span class="cm"> */</span>
<span class="cp">#undef TRACE_SYSTEM</span>
<span class="cp">#define TRACE_SYSTEM xfs</span>

<span class="cp">#if !defined(_TRACE_XFS_H) || defined(TRACE_HEADER_MULTI_READ)</span>
<span class="cp">#define _TRACE_XFS_H</span>

<span class="cp">#include &lt;linux/tracepoint.h&gt;</span>

<span class="k">struct</span> <span class="n">xfs_agf</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">xfs_alloc_arg</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">xfs_attr_list_context</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">xfs_buf_log_item</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">xfs_da_args</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">xfs_da_node_entry</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">xfs_dquot</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">xfs_log_item</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">xlog_ticket</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">xlog</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">xlog_recover</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">xlog_recover_item</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">xfs_buf_log_format</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">xfs_inode_log_format</span><span class="p">;</span>

<span class="n">DECLARE_EVENT_CLASS</span><span class="p">(</span><span class="n">xfs_attr_list_class</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_attr_list_context</span> <span class="o">*</span><span class="n">ctx</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">ctx</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_ino_t</span><span class="p">,</span> <span class="n">ino</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">u32</span><span class="p">,</span> <span class="n">hashval</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">u32</span><span class="p">,</span> <span class="n">blkno</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">u32</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">,</span> <span class="n">alist</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">bufsize</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">firstu</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">dupcnt</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">VFS_I</span><span class="p">(</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">dp</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">i_sb</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">dp</span><span class="o">-&gt;</span><span class="n">i_ino</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">hashval</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">cursor</span><span class="o">-&gt;</span><span class="n">hashval</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">blkno</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">cursor</span><span class="o">-&gt;</span><span class="n">blkno</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">offset</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">cursor</span><span class="o">-&gt;</span><span class="n">offset</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">alist</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">alist</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bufsize</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">bufsize</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">count</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">count</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">firstu</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">firstu</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d ino 0x%llx cursor h/b/o 0x%x/0x%x/%u dupcnt %u &quot;</span>
		  <span class="s">&quot;alist 0x%p size %u count %u firstu %u flags %d %s&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		   <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span><span class="p">,</span>
		   <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">hashval</span><span class="p">,</span>
		   <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">blkno</span><span class="p">,</span>
		   <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">offset</span><span class="p">,</span>
		   <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dupcnt</span><span class="p">,</span>
		   <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">alist</span><span class="p">,</span>
		   <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bufsize</span><span class="p">,</span>
		   <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">count</span><span class="p">,</span>
		   <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">firstu</span><span class="p">,</span>
		   <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">,</span>
		   <span class="n">__print_flags</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">,</span> <span class="s">&quot;|&quot;</span><span class="p">,</span> <span class="n">XFS_ATTR_FLAGS</span><span class="p">)</span>
	<span class="p">)</span>
<span class="p">)</span>

<span class="cp">#define DEFINE_ATTR_LIST_EVENT(name) \</span>
<span class="cp">DEFINE_EVENT(xfs_attr_list_class, name, \</span>
<span class="cp">	TP_PROTO(struct xfs_attr_list_context *ctx), \</span>
<span class="cp">	TP_ARGS(ctx))</span>
<span class="n">DEFINE_ATTR_LIST_EVENT</span><span class="p">(</span><span class="n">xfs_attr_list_sf</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_LIST_EVENT</span><span class="p">(</span><span class="n">xfs_attr_list_sf_all</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_LIST_EVENT</span><span class="p">(</span><span class="n">xfs_attr_list_leaf</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_LIST_EVENT</span><span class="p">(</span><span class="n">xfs_attr_list_leaf_end</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_LIST_EVENT</span><span class="p">(</span><span class="n">xfs_attr_list_full</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_LIST_EVENT</span><span class="p">(</span><span class="n">xfs_attr_list_add</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_LIST_EVENT</span><span class="p">(</span><span class="n">xfs_attr_list_wrong_blk</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_LIST_EVENT</span><span class="p">(</span><span class="n">xfs_attr_list_notfound</span><span class="p">);</span>

<span class="n">DECLARE_EVENT_CLASS</span><span class="p">(</span><span class="n">xfs_perag_class</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_mount</span> <span class="o">*</span><span class="n">mp</span><span class="p">,</span> <span class="n">xfs_agnumber_t</span> <span class="n">agno</span><span class="p">,</span> <span class="kt">int</span> <span class="n">refcount</span><span class="p">,</span>
		 <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">caller_ip</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">mp</span><span class="p">,</span> <span class="n">agno</span><span class="p">,</span> <span class="n">refcount</span><span class="p">,</span> <span class="n">caller_ip</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_agnumber_t</span><span class="p">,</span> <span class="n">agno</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">refcount</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span> <span class="n">caller_ip</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">mp</span><span class="o">-&gt;</span><span class="n">m_super</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">agno</span> <span class="o">=</span> <span class="n">agno</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">refcount</span> <span class="o">=</span> <span class="n">refcount</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">caller_ip</span> <span class="o">=</span> <span class="n">caller_ip</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d agno %u refcount %d caller %pf&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">agno</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="p">,</span>
		  <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">caller_ip</span><span class="p">)</span>
<span class="p">);</span>

<span class="cp">#define DEFINE_PERAG_REF_EVENT(name)	\</span>
<span class="cp">DEFINE_EVENT(xfs_perag_class, name,	\</span>
<span class="cp">	TP_PROTO(struct xfs_mount *mp, xfs_agnumber_t agno, int refcount,	\</span>
<span class="cp">		 unsigned long caller_ip),					\</span>
<span class="cp">	TP_ARGS(mp, agno, refcount, caller_ip))</span>
<span class="n">DEFINE_PERAG_REF_EVENT</span><span class="p">(</span><span class="n">xfs_perag_get</span><span class="p">);</span>
<span class="n">DEFINE_PERAG_REF_EVENT</span><span class="p">(</span><span class="n">xfs_perag_get_tag</span><span class="p">);</span>
<span class="n">DEFINE_PERAG_REF_EVENT</span><span class="p">(</span><span class="n">xfs_perag_put</span><span class="p">);</span>
<span class="n">DEFINE_PERAG_REF_EVENT</span><span class="p">(</span><span class="n">xfs_perag_set_reclaim</span><span class="p">);</span>
<span class="n">DEFINE_PERAG_REF_EVENT</span><span class="p">(</span><span class="n">xfs_perag_clear_reclaim</span><span class="p">);</span>

<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">xfs_attr_list_node_descend</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_attr_list_context</span> <span class="o">*</span><span class="n">ctx</span><span class="p">,</span>
		 <span class="k">struct</span> <span class="n">xfs_da_node_entry</span> <span class="o">*</span><span class="n">btree</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">btree</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_ino_t</span><span class="p">,</span> <span class="n">ino</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">u32</span><span class="p">,</span> <span class="n">hashval</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">u32</span><span class="p">,</span> <span class="n">blkno</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">u32</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">,</span> <span class="n">alist</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">bufsize</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">firstu</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">dupcnt</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">u32</span><span class="p">,</span> <span class="n">bt_hashval</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">u32</span><span class="p">,</span> <span class="n">bt_before</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">VFS_I</span><span class="p">(</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">dp</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">i_sb</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">dp</span><span class="o">-&gt;</span><span class="n">i_ino</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">hashval</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">cursor</span><span class="o">-&gt;</span><span class="n">hashval</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">blkno</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">cursor</span><span class="o">-&gt;</span><span class="n">blkno</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">offset</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">cursor</span><span class="o">-&gt;</span><span class="n">offset</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">alist</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">alist</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bufsize</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">bufsize</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">count</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">count</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">firstu</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">firstu</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bt_hashval</span> <span class="o">=</span> <span class="n">be32_to_cpu</span><span class="p">(</span><span class="n">btree</span><span class="o">-&gt;</span><span class="n">hashval</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bt_before</span> <span class="o">=</span> <span class="n">be32_to_cpu</span><span class="p">(</span><span class="n">btree</span><span class="o">-&gt;</span><span class="n">before</span><span class="p">);</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d ino 0x%llx cursor h/b/o 0x%x/0x%x/%u dupcnt %u &quot;</span>
		  <span class="s">&quot;alist 0x%p size %u count %u firstu %u flags %d %s &quot;</span>
		  <span class="s">&quot;node hashval %u, node before %u&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		   <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span><span class="p">,</span>
		   <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">hashval</span><span class="p">,</span>
		   <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">blkno</span><span class="p">,</span>
		   <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">offset</span><span class="p">,</span>
		   <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dupcnt</span><span class="p">,</span>
		   <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">alist</span><span class="p">,</span>
		   <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bufsize</span><span class="p">,</span>
		   <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">count</span><span class="p">,</span>
		   <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">firstu</span><span class="p">,</span>
		   <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">,</span>
		   <span class="n">__print_flags</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">,</span> <span class="s">&quot;|&quot;</span><span class="p">,</span> <span class="n">XFS_ATTR_FLAGS</span><span class="p">),</span>
		   <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bt_hashval</span><span class="p">,</span>
		   <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bt_before</span><span class="p">)</span>
<span class="p">);</span>

<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">xfs_iext_insert</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_inode</span> <span class="o">*</span><span class="n">ip</span><span class="p">,</span> <span class="n">xfs_extnum_t</span> <span class="n">idx</span><span class="p">,</span>
		 <span class="k">struct</span> <span class="n">xfs_bmbt_irec</span> <span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="kt">int</span> <span class="n">state</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">caller_ip</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">caller_ip</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_ino_t</span><span class="p">,</span> <span class="n">ino</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_extnum_t</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_fileoff_t</span><span class="p">,</span> <span class="n">startoff</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_fsblock_t</span><span class="p">,</span> <span class="n">startblock</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_filblks_t</span><span class="p">,</span> <span class="n">blockcount</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_exntst_t</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">bmap_state</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span> <span class="n">caller_ip</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">VFS_I</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">i_sb</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span> <span class="o">=</span> <span class="n">ip</span><span class="o">-&gt;</span><span class="n">i_ino</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">startoff</span> <span class="o">=</span> <span class="n">r</span><span class="o">-&gt;</span><span class="n">br_startoff</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">startblock</span> <span class="o">=</span> <span class="n">r</span><span class="o">-&gt;</span><span class="n">br_startblock</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">blockcount</span> <span class="o">=</span> <span class="n">r</span><span class="o">-&gt;</span><span class="n">br_blockcount</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">state</span> <span class="o">=</span> <span class="n">r</span><span class="o">-&gt;</span><span class="n">br_state</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bmap_state</span> <span class="o">=</span> <span class="n">state</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">caller_ip</span> <span class="o">=</span> <span class="n">caller_ip</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d ino 0x%llx state %s idx %ld &quot;</span>
		  <span class="s">&quot;offset %lld block %lld count %lld flag %d caller %pf&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span><span class="p">,</span>
		  <span class="n">__print_flags</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bmap_state</span><span class="p">,</span> <span class="s">&quot;|&quot;</span><span class="p">,</span> <span class="n">XFS_BMAP_EXT_FLAGS</span><span class="p">),</span>
		  <span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">idx</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">startoff</span><span class="p">,</span>
		  <span class="p">(</span><span class="n">__int64_t</span><span class="p">)</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">startblock</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">blockcount</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">state</span><span class="p">,</span>
		  <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">caller_ip</span><span class="p">)</span>
<span class="p">);</span>

<span class="n">DECLARE_EVENT_CLASS</span><span class="p">(</span><span class="n">xfs_bmap_class</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_inode</span> <span class="o">*</span><span class="n">ip</span><span class="p">,</span> <span class="n">xfs_extnum_t</span> <span class="n">idx</span><span class="p">,</span> <span class="kt">int</span> <span class="n">state</span><span class="p">,</span>
		 <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">caller_ip</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">caller_ip</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_ino_t</span><span class="p">,</span> <span class="n">ino</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_extnum_t</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_fileoff_t</span><span class="p">,</span> <span class="n">startoff</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_fsblock_t</span><span class="p">,</span> <span class="n">startblock</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_filblks_t</span><span class="p">,</span> <span class="n">blockcount</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_exntst_t</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">bmap_state</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span> <span class="n">caller_ip</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="k">struct</span> <span class="n">xfs_ifork</span>	<span class="o">*</span><span class="n">ifp</span> <span class="o">=</span> <span class="p">(</span><span class="n">state</span> <span class="o">&amp;</span> <span class="n">BMAP_ATTRFORK</span><span class="p">)</span> <span class="o">?</span>
						<span class="n">ip</span><span class="o">-&gt;</span><span class="n">i_afp</span> <span class="o">:</span> <span class="o">&amp;</span><span class="n">ip</span><span class="o">-&gt;</span><span class="n">i_df</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">xfs_bmbt_irec</span>	<span class="n">r</span><span class="p">;</span>

		<span class="n">xfs_bmbt_get_all</span><span class="p">(</span><span class="n">xfs_iext_get_ext</span><span class="p">(</span><span class="n">ifp</span><span class="p">,</span> <span class="n">idx</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">r</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">VFS_I</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">i_sb</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span> <span class="o">=</span> <span class="n">ip</span><span class="o">-&gt;</span><span class="n">i_ino</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">startoff</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">br_startoff</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">startblock</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">br_startblock</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">blockcount</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">br_blockcount</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">state</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">br_state</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bmap_state</span> <span class="o">=</span> <span class="n">state</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">caller_ip</span> <span class="o">=</span> <span class="n">caller_ip</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d ino 0x%llx state %s idx %ld &quot;</span>
		  <span class="s">&quot;offset %lld block %lld count %lld flag %d caller %pf&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span><span class="p">,</span>
		  <span class="n">__print_flags</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bmap_state</span><span class="p">,</span> <span class="s">&quot;|&quot;</span><span class="p">,</span> <span class="n">XFS_BMAP_EXT_FLAGS</span><span class="p">),</span>
		  <span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">idx</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">startoff</span><span class="p">,</span>
		  <span class="p">(</span><span class="n">__int64_t</span><span class="p">)</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">startblock</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">blockcount</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">state</span><span class="p">,</span>
		  <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">caller_ip</span><span class="p">)</span>
<span class="p">)</span>

<span class="cp">#define DEFINE_BMAP_EVENT(name) \</span>
<span class="cp">DEFINE_EVENT(xfs_bmap_class, name, \</span>
<span class="cp">	TP_PROTO(struct xfs_inode *ip, xfs_extnum_t idx, int state, \</span>
<span class="cp">		 unsigned long caller_ip), \</span>
<span class="cp">	TP_ARGS(ip, idx, state, caller_ip))</span>
<span class="n">DEFINE_BMAP_EVENT</span><span class="p">(</span><span class="n">xfs_iext_remove</span><span class="p">);</span>
<span class="n">DEFINE_BMAP_EVENT</span><span class="p">(</span><span class="n">xfs_bmap_pre_update</span><span class="p">);</span>
<span class="n">DEFINE_BMAP_EVENT</span><span class="p">(</span><span class="n">xfs_bmap_post_update</span><span class="p">);</span>
<span class="n">DEFINE_BMAP_EVENT</span><span class="p">(</span><span class="n">xfs_extlist</span><span class="p">);</span>

<span class="n">DECLARE_EVENT_CLASS</span><span class="p">(</span><span class="n">xfs_buf_class</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_buf</span> <span class="o">*</span><span class="n">bp</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">caller_ip</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">bp</span><span class="p">,</span> <span class="n">caller_ip</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_daddr_t</span><span class="p">,</span> <span class="n">bno</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">nblks</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">hold</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">pincount</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span><span class="p">,</span> <span class="n">lockval</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span> <span class="n">caller_ip</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">bp</span><span class="o">-&gt;</span><span class="n">b_target</span><span class="o">-&gt;</span><span class="n">bt_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bno</span> <span class="o">=</span> <span class="n">bp</span><span class="o">-&gt;</span><span class="n">b_bn</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">nblks</span> <span class="o">=</span> <span class="n">bp</span><span class="o">-&gt;</span><span class="n">b_length</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">hold</span> <span class="o">=</span> <span class="n">atomic_read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bp</span><span class="o">-&gt;</span><span class="n">b_hold</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">pincount</span> <span class="o">=</span> <span class="n">atomic_read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bp</span><span class="o">-&gt;</span><span class="n">b_pin_count</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">lockval</span> <span class="o">=</span> <span class="n">bp</span><span class="o">-&gt;</span><span class="n">b_sema</span><span class="p">.</span><span class="n">count</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">=</span> <span class="n">bp</span><span class="o">-&gt;</span><span class="n">b_flags</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">caller_ip</span> <span class="o">=</span> <span class="n">caller_ip</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d bno 0x%llx nblks 0x%x hold %d pincount %d &quot;</span>
		  <span class="s">&quot;lock %d flags %s caller %pf&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">)</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bno</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">nblks</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">hold</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">pincount</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">lockval</span><span class="p">,</span>
		  <span class="n">__print_flags</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">,</span> <span class="s">&quot;|&quot;</span><span class="p">,</span> <span class="n">XFS_BUF_FLAGS</span><span class="p">),</span>
		  <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">caller_ip</span><span class="p">)</span>
<span class="p">)</span>

<span class="cp">#define DEFINE_BUF_EVENT(name) \</span>
<span class="cp">DEFINE_EVENT(xfs_buf_class, name, \</span>
<span class="cp">	TP_PROTO(struct xfs_buf *bp, unsigned long caller_ip), \</span>
<span class="cp">	TP_ARGS(bp, caller_ip))</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_buf_init</span><span class="p">);</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_buf_free</span><span class="p">);</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_buf_hold</span><span class="p">);</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_buf_rele</span><span class="p">);</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_buf_iodone</span><span class="p">);</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_buf_iorequest</span><span class="p">);</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_buf_bawrite</span><span class="p">);</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_buf_lock</span><span class="p">);</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_buf_lock_done</span><span class="p">);</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_buf_trylock</span><span class="p">);</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_buf_unlock</span><span class="p">);</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_buf_iowait</span><span class="p">);</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_buf_iowait_done</span><span class="p">);</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_buf_delwri_queue</span><span class="p">);</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_buf_delwri_queued</span><span class="p">);</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_buf_delwri_split</span><span class="p">);</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_buf_get_uncached</span><span class="p">);</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_bdstrat_shut</span><span class="p">);</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_buf_item_relse</span><span class="p">);</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_buf_item_iodone</span><span class="p">);</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_buf_item_iodone_async</span><span class="p">);</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_buf_error_relse</span><span class="p">);</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_trans_read_buf_io</span><span class="p">);</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_trans_read_buf_shut</span><span class="p">);</span>

<span class="cm">/* not really buffer traces, but the buf provides useful information */</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_btree_corrupt</span><span class="p">);</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_da_btree_corrupt</span><span class="p">);</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_reset_dqcounts</span><span class="p">);</span>
<span class="n">DEFINE_BUF_EVENT</span><span class="p">(</span><span class="n">xfs_inode_item_push</span><span class="p">);</span>

<span class="cm">/* pass flags explicitly */</span>
<span class="n">DECLARE_EVENT_CLASS</span><span class="p">(</span><span class="n">xfs_buf_flags_class</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_buf</span> <span class="o">*</span><span class="n">bp</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">flags</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">caller_ip</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">bp</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">caller_ip</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_daddr_t</span><span class="p">,</span> <span class="n">bno</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">buffer_length</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">hold</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">pincount</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span><span class="p">,</span> <span class="n">lockval</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span> <span class="n">caller_ip</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">bp</span><span class="o">-&gt;</span><span class="n">b_target</span><span class="o">-&gt;</span><span class="n">bt_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bno</span> <span class="o">=</span> <span class="n">bp</span><span class="o">-&gt;</span><span class="n">b_bn</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">buffer_length</span> <span class="o">=</span> <span class="n">BBTOB</span><span class="p">(</span><span class="n">bp</span><span class="o">-&gt;</span><span class="n">b_length</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">=</span> <span class="n">flags</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">hold</span> <span class="o">=</span> <span class="n">atomic_read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bp</span><span class="o">-&gt;</span><span class="n">b_hold</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">pincount</span> <span class="o">=</span> <span class="n">atomic_read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bp</span><span class="o">-&gt;</span><span class="n">b_pin_count</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">lockval</span> <span class="o">=</span> <span class="n">bp</span><span class="o">-&gt;</span><span class="n">b_sema</span><span class="p">.</span><span class="n">count</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">caller_ip</span> <span class="o">=</span> <span class="n">caller_ip</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d bno 0x%llx len 0x%zx hold %d pincount %d &quot;</span>
		  <span class="s">&quot;lock %d flags %s caller %pf&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">)</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bno</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">buffer_length</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">hold</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">pincount</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">lockval</span><span class="p">,</span>
		  <span class="n">__print_flags</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">,</span> <span class="s">&quot;|&quot;</span><span class="p">,</span> <span class="n">XFS_BUF_FLAGS</span><span class="p">),</span>
		  <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">caller_ip</span><span class="p">)</span>
<span class="p">)</span>

<span class="cp">#define DEFINE_BUF_FLAGS_EVENT(name) \</span>
<span class="cp">DEFINE_EVENT(xfs_buf_flags_class, name, \</span>
<span class="cp">	TP_PROTO(struct xfs_buf *bp, unsigned flags, unsigned long caller_ip), \</span>
<span class="cp">	TP_ARGS(bp, flags, caller_ip))</span>
<span class="n">DEFINE_BUF_FLAGS_EVENT</span><span class="p">(</span><span class="n">xfs_buf_find</span><span class="p">);</span>
<span class="n">DEFINE_BUF_FLAGS_EVENT</span><span class="p">(</span><span class="n">xfs_buf_get</span><span class="p">);</span>
<span class="n">DEFINE_BUF_FLAGS_EVENT</span><span class="p">(</span><span class="n">xfs_buf_read</span><span class="p">);</span>

<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">xfs_buf_ioerror</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_buf</span> <span class="o">*</span><span class="n">bp</span><span class="p">,</span> <span class="kt">int</span> <span class="n">error</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">caller_ip</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">bp</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">caller_ip</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_daddr_t</span><span class="p">,</span> <span class="n">bno</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">buffer_length</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">hold</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">pincount</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span><span class="p">,</span> <span class="n">lockval</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span> <span class="n">caller_ip</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">bp</span><span class="o">-&gt;</span><span class="n">b_target</span><span class="o">-&gt;</span><span class="n">bt_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bno</span> <span class="o">=</span> <span class="n">bp</span><span class="o">-&gt;</span><span class="n">b_bn</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">buffer_length</span> <span class="o">=</span> <span class="n">BBTOB</span><span class="p">(</span><span class="n">bp</span><span class="o">-&gt;</span><span class="n">b_length</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">hold</span> <span class="o">=</span> <span class="n">atomic_read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bp</span><span class="o">-&gt;</span><span class="n">b_hold</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">pincount</span> <span class="o">=</span> <span class="n">atomic_read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bp</span><span class="o">-&gt;</span><span class="n">b_pin_count</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">lockval</span> <span class="o">=</span> <span class="n">bp</span><span class="o">-&gt;</span><span class="n">b_sema</span><span class="p">.</span><span class="n">count</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">error</span> <span class="o">=</span> <span class="n">error</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">=</span> <span class="n">bp</span><span class="o">-&gt;</span><span class="n">b_flags</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">caller_ip</span> <span class="o">=</span> <span class="n">caller_ip</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d bno 0x%llx len 0x%zx hold %d pincount %d &quot;</span>
		  <span class="s">&quot;lock %d error %d flags %s caller %pf&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">)</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bno</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">buffer_length</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">hold</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">pincount</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">lockval</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">error</span><span class="p">,</span>
		  <span class="n">__print_flags</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">,</span> <span class="s">&quot;|&quot;</span><span class="p">,</span> <span class="n">XFS_BUF_FLAGS</span><span class="p">),</span>
		  <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">caller_ip</span><span class="p">)</span>
<span class="p">);</span>

<span class="n">DECLARE_EVENT_CLASS</span><span class="p">(</span><span class="n">xfs_buf_item_class</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_buf_log_item</span> <span class="o">*</span><span class="n">bip</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">bip</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_daddr_t</span><span class="p">,</span> <span class="n">buf_bno</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">buf_len</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">buf_hold</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">buf_pincount</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">buf_lockval</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span><span class="p">,</span> <span class="n">buf_flags</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span><span class="p">,</span> <span class="n">bli_recur</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">bli_refcount</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span><span class="p">,</span> <span class="n">bli_flags</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">,</span> <span class="n">li_desc</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span><span class="p">,</span> <span class="n">li_flags</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">bip</span><span class="o">-&gt;</span><span class="n">bli_buf</span><span class="o">-&gt;</span><span class="n">b_target</span><span class="o">-&gt;</span><span class="n">bt_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bli_flags</span> <span class="o">=</span> <span class="n">bip</span><span class="o">-&gt;</span><span class="n">bli_flags</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bli_recur</span> <span class="o">=</span> <span class="n">bip</span><span class="o">-&gt;</span><span class="n">bli_recur</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bli_refcount</span> <span class="o">=</span> <span class="n">atomic_read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bip</span><span class="o">-&gt;</span><span class="n">bli_refcount</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">buf_bno</span> <span class="o">=</span> <span class="n">bip</span><span class="o">-&gt;</span><span class="n">bli_buf</span><span class="o">-&gt;</span><span class="n">b_bn</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">buf_len</span> <span class="o">=</span> <span class="n">BBTOB</span><span class="p">(</span><span class="n">bip</span><span class="o">-&gt;</span><span class="n">bli_buf</span><span class="o">-&gt;</span><span class="n">b_length</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">buf_flags</span> <span class="o">=</span> <span class="n">bip</span><span class="o">-&gt;</span><span class="n">bli_buf</span><span class="o">-&gt;</span><span class="n">b_flags</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">buf_hold</span> <span class="o">=</span> <span class="n">atomic_read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bip</span><span class="o">-&gt;</span><span class="n">bli_buf</span><span class="o">-&gt;</span><span class="n">b_hold</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">buf_pincount</span> <span class="o">=</span> <span class="n">atomic_read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bip</span><span class="o">-&gt;</span><span class="n">bli_buf</span><span class="o">-&gt;</span><span class="n">b_pin_count</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">buf_lockval</span> <span class="o">=</span> <span class="n">bip</span><span class="o">-&gt;</span><span class="n">bli_buf</span><span class="o">-&gt;</span><span class="n">b_sema</span><span class="p">.</span><span class="n">count</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">li_desc</span> <span class="o">=</span> <span class="n">bip</span><span class="o">-&gt;</span><span class="n">bli_item</span><span class="p">.</span><span class="n">li_desc</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">li_flags</span> <span class="o">=</span> <span class="n">bip</span><span class="o">-&gt;</span><span class="n">bli_item</span><span class="p">.</span><span class="n">li_flags</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d bno 0x%llx len 0x%zx hold %d pincount %d &quot;</span>
		  <span class="s">&quot;lock %d flags %s recur %d refcount %d bliflags %s &quot;</span>
		  <span class="s">&quot;lidesc 0x%p liflags %s&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">)</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">buf_bno</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">buf_len</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">buf_hold</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">buf_pincount</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">buf_lockval</span><span class="p">,</span>
		  <span class="n">__print_flags</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">buf_flags</span><span class="p">,</span> <span class="s">&quot;|&quot;</span><span class="p">,</span> <span class="n">XFS_BUF_FLAGS</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bli_recur</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bli_refcount</span><span class="p">,</span>
		  <span class="n">__print_flags</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bli_flags</span><span class="p">,</span> <span class="s">&quot;|&quot;</span><span class="p">,</span> <span class="n">XFS_BLI_FLAGS</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">li_desc</span><span class="p">,</span>
		  <span class="n">__print_flags</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">li_flags</span><span class="p">,</span> <span class="s">&quot;|&quot;</span><span class="p">,</span> <span class="n">XFS_LI_FLAGS</span><span class="p">))</span>
<span class="p">)</span>

<span class="cp">#define DEFINE_BUF_ITEM_EVENT(name) \</span>
<span class="cp">DEFINE_EVENT(xfs_buf_item_class, name, \</span>
<span class="cp">	TP_PROTO(struct xfs_buf_log_item *bip), \</span>
<span class="cp">	TP_ARGS(bip))</span>
<span class="n">DEFINE_BUF_ITEM_EVENT</span><span class="p">(</span><span class="n">xfs_buf_item_size</span><span class="p">);</span>
<span class="n">DEFINE_BUF_ITEM_EVENT</span><span class="p">(</span><span class="n">xfs_buf_item_size_stale</span><span class="p">);</span>
<span class="n">DEFINE_BUF_ITEM_EVENT</span><span class="p">(</span><span class="n">xfs_buf_item_format</span><span class="p">);</span>
<span class="n">DEFINE_BUF_ITEM_EVENT</span><span class="p">(</span><span class="n">xfs_buf_item_format_stale</span><span class="p">);</span>
<span class="n">DEFINE_BUF_ITEM_EVENT</span><span class="p">(</span><span class="n">xfs_buf_item_pin</span><span class="p">);</span>
<span class="n">DEFINE_BUF_ITEM_EVENT</span><span class="p">(</span><span class="n">xfs_buf_item_unpin</span><span class="p">);</span>
<span class="n">DEFINE_BUF_ITEM_EVENT</span><span class="p">(</span><span class="n">xfs_buf_item_unpin_stale</span><span class="p">);</span>
<span class="n">DEFINE_BUF_ITEM_EVENT</span><span class="p">(</span><span class="n">xfs_buf_item_unlock</span><span class="p">);</span>
<span class="n">DEFINE_BUF_ITEM_EVENT</span><span class="p">(</span><span class="n">xfs_buf_item_unlock_stale</span><span class="p">);</span>
<span class="n">DEFINE_BUF_ITEM_EVENT</span><span class="p">(</span><span class="n">xfs_buf_item_committed</span><span class="p">);</span>
<span class="n">DEFINE_BUF_ITEM_EVENT</span><span class="p">(</span><span class="n">xfs_buf_item_push</span><span class="p">);</span>
<span class="n">DEFINE_BUF_ITEM_EVENT</span><span class="p">(</span><span class="n">xfs_trans_get_buf</span><span class="p">);</span>
<span class="n">DEFINE_BUF_ITEM_EVENT</span><span class="p">(</span><span class="n">xfs_trans_get_buf_recur</span><span class="p">);</span>
<span class="n">DEFINE_BUF_ITEM_EVENT</span><span class="p">(</span><span class="n">xfs_trans_getsb</span><span class="p">);</span>
<span class="n">DEFINE_BUF_ITEM_EVENT</span><span class="p">(</span><span class="n">xfs_trans_getsb_recur</span><span class="p">);</span>
<span class="n">DEFINE_BUF_ITEM_EVENT</span><span class="p">(</span><span class="n">xfs_trans_read_buf</span><span class="p">);</span>
<span class="n">DEFINE_BUF_ITEM_EVENT</span><span class="p">(</span><span class="n">xfs_trans_read_buf_recur</span><span class="p">);</span>
<span class="n">DEFINE_BUF_ITEM_EVENT</span><span class="p">(</span><span class="n">xfs_trans_log_buf</span><span class="p">);</span>
<span class="n">DEFINE_BUF_ITEM_EVENT</span><span class="p">(</span><span class="n">xfs_trans_brelse</span><span class="p">);</span>
<span class="n">DEFINE_BUF_ITEM_EVENT</span><span class="p">(</span><span class="n">xfs_trans_bjoin</span><span class="p">);</span>
<span class="n">DEFINE_BUF_ITEM_EVENT</span><span class="p">(</span><span class="n">xfs_trans_bhold</span><span class="p">);</span>
<span class="n">DEFINE_BUF_ITEM_EVENT</span><span class="p">(</span><span class="n">xfs_trans_bhold_release</span><span class="p">);</span>
<span class="n">DEFINE_BUF_ITEM_EVENT</span><span class="p">(</span><span class="n">xfs_trans_binval</span><span class="p">);</span>

<span class="n">DECLARE_EVENT_CLASS</span><span class="p">(</span><span class="n">xfs_lock_class</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_inode</span> <span class="o">*</span><span class="n">ip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">lock_flags</span><span class="p">,</span>
		 <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">caller_ip</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span>  <span class="n">lock_flags</span><span class="p">,</span> <span class="n">caller_ip</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_ino_t</span><span class="p">,</span> <span class="n">ino</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">lock_flags</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span> <span class="n">caller_ip</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">VFS_I</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">i_sb</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span> <span class="o">=</span> <span class="n">ip</span><span class="o">-&gt;</span><span class="n">i_ino</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">lock_flags</span> <span class="o">=</span> <span class="n">lock_flags</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">caller_ip</span> <span class="o">=</span> <span class="n">caller_ip</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d ino 0x%llx flags %s caller %pf&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span><span class="p">,</span>
		  <span class="n">__print_flags</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">lock_flags</span><span class="p">,</span> <span class="s">&quot;|&quot;</span><span class="p">,</span> <span class="n">XFS_LOCK_FLAGS</span><span class="p">),</span>
		  <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">caller_ip</span><span class="p">)</span>
<span class="p">)</span>

<span class="cp">#define DEFINE_LOCK_EVENT(name) \</span>
<span class="cp">DEFINE_EVENT(xfs_lock_class, name, \</span>
<span class="cp">	TP_PROTO(struct xfs_inode *ip, unsigned lock_flags, \</span>
<span class="cp">		 unsigned long caller_ip), \</span>
<span class="cp">	TP_ARGS(ip,  lock_flags, caller_ip))</span>
<span class="n">DEFINE_LOCK_EVENT</span><span class="p">(</span><span class="n">xfs_ilock</span><span class="p">);</span>
<span class="n">DEFINE_LOCK_EVENT</span><span class="p">(</span><span class="n">xfs_ilock_nowait</span><span class="p">);</span>
<span class="n">DEFINE_LOCK_EVENT</span><span class="p">(</span><span class="n">xfs_ilock_demote</span><span class="p">);</span>
<span class="n">DEFINE_LOCK_EVENT</span><span class="p">(</span><span class="n">xfs_iunlock</span><span class="p">);</span>

<span class="n">DECLARE_EVENT_CLASS</span><span class="p">(</span><span class="n">xfs_inode_class</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_inode</span> <span class="o">*</span><span class="n">ip</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">ip</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_ino_t</span><span class="p">,</span> <span class="n">ino</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">VFS_I</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">i_sb</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span> <span class="o">=</span> <span class="n">ip</span><span class="o">-&gt;</span><span class="n">i_ino</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d ino 0x%llx&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span><span class="p">)</span>
<span class="p">)</span>

<span class="cp">#define DEFINE_INODE_EVENT(name) \</span>
<span class="cp">DEFINE_EVENT(xfs_inode_class, name, \</span>
<span class="cp">	TP_PROTO(struct xfs_inode *ip), \</span>
<span class="cp">	TP_ARGS(ip))</span>
<span class="n">DEFINE_INODE_EVENT</span><span class="p">(</span><span class="n">xfs_iget_skip</span><span class="p">);</span>
<span class="n">DEFINE_INODE_EVENT</span><span class="p">(</span><span class="n">xfs_iget_reclaim</span><span class="p">);</span>
<span class="n">DEFINE_INODE_EVENT</span><span class="p">(</span><span class="n">xfs_iget_reclaim_fail</span><span class="p">);</span>
<span class="n">DEFINE_INODE_EVENT</span><span class="p">(</span><span class="n">xfs_iget_hit</span><span class="p">);</span>
<span class="n">DEFINE_INODE_EVENT</span><span class="p">(</span><span class="n">xfs_iget_miss</span><span class="p">);</span>

<span class="n">DEFINE_INODE_EVENT</span><span class="p">(</span><span class="n">xfs_getattr</span><span class="p">);</span>
<span class="n">DEFINE_INODE_EVENT</span><span class="p">(</span><span class="n">xfs_setattr</span><span class="p">);</span>
<span class="n">DEFINE_INODE_EVENT</span><span class="p">(</span><span class="n">xfs_readlink</span><span class="p">);</span>
<span class="n">DEFINE_INODE_EVENT</span><span class="p">(</span><span class="n">xfs_alloc_file_space</span><span class="p">);</span>
<span class="n">DEFINE_INODE_EVENT</span><span class="p">(</span><span class="n">xfs_free_file_space</span><span class="p">);</span>
<span class="n">DEFINE_INODE_EVENT</span><span class="p">(</span><span class="n">xfs_readdir</span><span class="p">);</span>
<span class="cp">#ifdef CONFIG_XFS_POSIX_ACL</span>
<span class="n">DEFINE_INODE_EVENT</span><span class="p">(</span><span class="n">xfs_get_acl</span><span class="p">);</span>
<span class="cp">#endif</span>
<span class="n">DEFINE_INODE_EVENT</span><span class="p">(</span><span class="n">xfs_vm_bmap</span><span class="p">);</span>
<span class="n">DEFINE_INODE_EVENT</span><span class="p">(</span><span class="n">xfs_file_ioctl</span><span class="p">);</span>
<span class="n">DEFINE_INODE_EVENT</span><span class="p">(</span><span class="n">xfs_file_compat_ioctl</span><span class="p">);</span>
<span class="n">DEFINE_INODE_EVENT</span><span class="p">(</span><span class="n">xfs_ioctl_setattr</span><span class="p">);</span>
<span class="n">DEFINE_INODE_EVENT</span><span class="p">(</span><span class="n">xfs_dir_fsync</span><span class="p">);</span>
<span class="n">DEFINE_INODE_EVENT</span><span class="p">(</span><span class="n">xfs_file_fsync</span><span class="p">);</span>
<span class="n">DEFINE_INODE_EVENT</span><span class="p">(</span><span class="n">xfs_destroy_inode</span><span class="p">);</span>
<span class="n">DEFINE_INODE_EVENT</span><span class="p">(</span><span class="n">xfs_dirty_inode</span><span class="p">);</span>
<span class="n">DEFINE_INODE_EVENT</span><span class="p">(</span><span class="n">xfs_evict_inode</span><span class="p">);</span>

<span class="n">DEFINE_INODE_EVENT</span><span class="p">(</span><span class="n">xfs_dquot_dqalloc</span><span class="p">);</span>
<span class="n">DEFINE_INODE_EVENT</span><span class="p">(</span><span class="n">xfs_dquot_dqdetach</span><span class="p">);</span>

<span class="n">DECLARE_EVENT_CLASS</span><span class="p">(</span><span class="n">xfs_iref_class</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_inode</span> <span class="o">*</span><span class="n">ip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">caller_ip</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">caller_ip</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_ino_t</span><span class="p">,</span> <span class="n">ino</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">pincount</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span> <span class="n">caller_ip</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">VFS_I</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">i_sb</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span> <span class="o">=</span> <span class="n">ip</span><span class="o">-&gt;</span><span class="n">i_ino</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">count</span> <span class="o">=</span> <span class="n">atomic_read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">VFS_I</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">i_count</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">pincount</span> <span class="o">=</span> <span class="n">atomic_read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ip</span><span class="o">-&gt;</span><span class="n">i_pincount</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">caller_ip</span> <span class="o">=</span> <span class="n">caller_ip</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d ino 0x%llx count %d pincount %d caller %pf&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">count</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">pincount</span><span class="p">,</span>
		  <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">caller_ip</span><span class="p">)</span>
<span class="p">)</span>

<span class="cp">#define DEFINE_IREF_EVENT(name) \</span>
<span class="cp">DEFINE_EVENT(xfs_iref_class, name, \</span>
<span class="cp">	TP_PROTO(struct xfs_inode *ip, unsigned long caller_ip), \</span>
<span class="cp">	TP_ARGS(ip, caller_ip))</span>
<span class="n">DEFINE_IREF_EVENT</span><span class="p">(</span><span class="n">xfs_ihold</span><span class="p">);</span>
<span class="n">DEFINE_IREF_EVENT</span><span class="p">(</span><span class="n">xfs_irele</span><span class="p">);</span>
<span class="n">DEFINE_IREF_EVENT</span><span class="p">(</span><span class="n">xfs_inode_pin</span><span class="p">);</span>
<span class="n">DEFINE_IREF_EVENT</span><span class="p">(</span><span class="n">xfs_inode_unpin</span><span class="p">);</span>
<span class="n">DEFINE_IREF_EVENT</span><span class="p">(</span><span class="n">xfs_inode_unpin_nowait</span><span class="p">);</span>

<span class="n">DECLARE_EVENT_CLASS</span><span class="p">(</span><span class="n">xfs_namespace_class</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_inode</span> <span class="o">*</span><span class="n">dp</span><span class="p">,</span> <span class="k">struct</span> <span class="n">xfs_name</span> <span class="o">*</span><span class="n">name</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">dp</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_ino_t</span><span class="p">,</span> <span class="n">dp_ino</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">namelen</span><span class="p">)</span>
		<span class="n">__dynamic_array</span><span class="p">(</span><span class="kt">char</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">name</span><span class="o">-&gt;</span><span class="n">len</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">VFS_I</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">i_sb</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dp_ino</span> <span class="o">=</span> <span class="n">dp</span><span class="o">-&gt;</span><span class="n">i_ino</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">namelen</span> <span class="o">=</span> <span class="n">name</span><span class="o">-&gt;</span><span class="n">len</span><span class="p">;</span>
		<span class="n">memcpy</span><span class="p">(</span><span class="n">__get_str</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">name</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="n">name</span><span class="o">-&gt;</span><span class="n">len</span><span class="p">);</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d dp ino 0x%llx name %.*s&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dp_ino</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">namelen</span><span class="p">,</span>
		  <span class="n">__get_str</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
<span class="p">)</span>

<span class="cp">#define DEFINE_NAMESPACE_EVENT(name) \</span>
<span class="cp">DEFINE_EVENT(xfs_namespace_class, name, \</span>
<span class="cp">	TP_PROTO(struct xfs_inode *dp, struct xfs_name *name), \</span>
<span class="cp">	TP_ARGS(dp, name))</span>
<span class="n">DEFINE_NAMESPACE_EVENT</span><span class="p">(</span><span class="n">xfs_remove</span><span class="p">);</span>
<span class="n">DEFINE_NAMESPACE_EVENT</span><span class="p">(</span><span class="n">xfs_link</span><span class="p">);</span>
<span class="n">DEFINE_NAMESPACE_EVENT</span><span class="p">(</span><span class="n">xfs_lookup</span><span class="p">);</span>
<span class="n">DEFINE_NAMESPACE_EVENT</span><span class="p">(</span><span class="n">xfs_create</span><span class="p">);</span>
<span class="n">DEFINE_NAMESPACE_EVENT</span><span class="p">(</span><span class="n">xfs_symlink</span><span class="p">);</span>

<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">xfs_rename</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_inode</span> <span class="o">*</span><span class="n">src_dp</span><span class="p">,</span> <span class="k">struct</span> <span class="n">xfs_inode</span> <span class="o">*</span><span class="n">target_dp</span><span class="p">,</span>
		 <span class="k">struct</span> <span class="n">xfs_name</span> <span class="o">*</span><span class="n">src_name</span><span class="p">,</span> <span class="k">struct</span> <span class="n">xfs_name</span> <span class="o">*</span><span class="n">target_name</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">src_dp</span><span class="p">,</span> <span class="n">target_dp</span><span class="p">,</span> <span class="n">src_name</span><span class="p">,</span> <span class="n">target_name</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_ino_t</span><span class="p">,</span> <span class="n">src_dp_ino</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_ino_t</span><span class="p">,</span> <span class="n">target_dp_ino</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">src_namelen</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">target_namelen</span><span class="p">)</span>
		<span class="n">__dynamic_array</span><span class="p">(</span><span class="kt">char</span><span class="p">,</span> <span class="n">src_name</span><span class="p">,</span> <span class="n">src_name</span><span class="o">-&gt;</span><span class="n">len</span><span class="p">)</span>
		<span class="n">__dynamic_array</span><span class="p">(</span><span class="kt">char</span><span class="p">,</span> <span class="n">target_name</span><span class="p">,</span> <span class="n">target_name</span><span class="o">-&gt;</span><span class="n">len</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">VFS_I</span><span class="p">(</span><span class="n">src_dp</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">i_sb</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">src_dp_ino</span> <span class="o">=</span> <span class="n">src_dp</span><span class="o">-&gt;</span><span class="n">i_ino</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">target_dp_ino</span> <span class="o">=</span> <span class="n">target_dp</span><span class="o">-&gt;</span><span class="n">i_ino</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">src_namelen</span> <span class="o">=</span> <span class="n">src_name</span><span class="o">-&gt;</span><span class="n">len</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">target_namelen</span> <span class="o">=</span> <span class="n">target_name</span><span class="o">-&gt;</span><span class="n">len</span><span class="p">;</span>
		<span class="n">memcpy</span><span class="p">(</span><span class="n">__get_str</span><span class="p">(</span><span class="n">src_name</span><span class="p">),</span> <span class="n">src_name</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="n">src_name</span><span class="o">-&gt;</span><span class="n">len</span><span class="p">);</span>
		<span class="n">memcpy</span><span class="p">(</span><span class="n">__get_str</span><span class="p">(</span><span class="n">target_name</span><span class="p">),</span> <span class="n">target_name</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span>
			<span class="n">target_name</span><span class="o">-&gt;</span><span class="n">len</span><span class="p">);</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d src dp ino 0x%llx target dp ino 0x%llx&quot;</span>
		  <span class="s">&quot; src name %.*s target name %.*s&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">src_dp_ino</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">target_dp_ino</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">src_namelen</span><span class="p">,</span>
		  <span class="n">__get_str</span><span class="p">(</span><span class="n">src_name</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">target_namelen</span><span class="p">,</span>
		  <span class="n">__get_str</span><span class="p">(</span><span class="n">target_name</span><span class="p">))</span>
<span class="p">)</span>

<span class="n">DECLARE_EVENT_CLASS</span><span class="p">(</span><span class="n">xfs_dquot_class</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_dquot</span> <span class="o">*</span><span class="n">dqp</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">dqp</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">u32</span><span class="p">,</span> <span class="n">id</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span><span class="p">,</span> <span class="n">nrefs</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">,</span> <span class="n">res_bcount</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">,</span> <span class="n">bcount</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">,</span> <span class="n">icount</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">,</span> <span class="n">blk_hardlimit</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">,</span> <span class="n">blk_softlimit</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">,</span> <span class="n">ino_hardlimit</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">,</span> <span class="n">ino_softlimit</span><span class="p">)</span>
	<span class="p">),</span> \
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">dqp</span><span class="o">-&gt;</span><span class="n">q_mount</span><span class="o">-&gt;</span><span class="n">m_super</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">id</span> <span class="o">=</span> <span class="n">be32_to_cpu</span><span class="p">(</span><span class="n">dqp</span><span class="o">-&gt;</span><span class="n">q_core</span><span class="p">.</span><span class="n">d_id</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">=</span> <span class="n">dqp</span><span class="o">-&gt;</span><span class="n">dq_flags</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">nrefs</span> <span class="o">=</span> <span class="n">dqp</span><span class="o">-&gt;</span><span class="n">q_nrefs</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">res_bcount</span> <span class="o">=</span> <span class="n">dqp</span><span class="o">-&gt;</span><span class="n">q_res_bcount</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bcount</span> <span class="o">=</span> <span class="n">be64_to_cpu</span><span class="p">(</span><span class="n">dqp</span><span class="o">-&gt;</span><span class="n">q_core</span><span class="p">.</span><span class="n">d_bcount</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">icount</span> <span class="o">=</span> <span class="n">be64_to_cpu</span><span class="p">(</span><span class="n">dqp</span><span class="o">-&gt;</span><span class="n">q_core</span><span class="p">.</span><span class="n">d_icount</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">blk_hardlimit</span> <span class="o">=</span>
			<span class="n">be64_to_cpu</span><span class="p">(</span><span class="n">dqp</span><span class="o">-&gt;</span><span class="n">q_core</span><span class="p">.</span><span class="n">d_blk_hardlimit</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">blk_softlimit</span> <span class="o">=</span>
			<span class="n">be64_to_cpu</span><span class="p">(</span><span class="n">dqp</span><span class="o">-&gt;</span><span class="n">q_core</span><span class="p">.</span><span class="n">d_blk_softlimit</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino_hardlimit</span> <span class="o">=</span>
			<span class="n">be64_to_cpu</span><span class="p">(</span><span class="n">dqp</span><span class="o">-&gt;</span><span class="n">q_core</span><span class="p">.</span><span class="n">d_ino_hardlimit</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino_softlimit</span> <span class="o">=</span>
			<span class="n">be64_to_cpu</span><span class="p">(</span><span class="n">dqp</span><span class="o">-&gt;</span><span class="n">q_core</span><span class="p">.</span><span class="n">d_ino_softlimit</span><span class="p">);</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d id 0x%x flags %s nrefs %u res_bc 0x%llx &quot;</span>
		  <span class="s">&quot;bcnt 0x%llx bhardlimit 0x%llx bsoftlimit 0x%llx &quot;</span>
		  <span class="s">&quot;icnt 0x%llx ihardlimit 0x%llx isoftlimit 0x%llx]&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">,</span>
		  <span class="n">__print_flags</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">,</span> <span class="s">&quot;|&quot;</span><span class="p">,</span> <span class="n">XFS_DQ_FLAGS</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">nrefs</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">res_bcount</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bcount</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">blk_hardlimit</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">blk_softlimit</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">icount</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino_hardlimit</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino_softlimit</span><span class="p">)</span>
<span class="p">)</span>

<span class="cp">#define DEFINE_DQUOT_EVENT(name) \</span>
<span class="cp">DEFINE_EVENT(xfs_dquot_class, name, \</span>
<span class="cp">	TP_PROTO(struct xfs_dquot *dqp), \</span>
<span class="cp">	TP_ARGS(dqp))</span>
<span class="n">DEFINE_DQUOT_EVENT</span><span class="p">(</span><span class="n">xfs_dqadjust</span><span class="p">);</span>
<span class="n">DEFINE_DQUOT_EVENT</span><span class="p">(</span><span class="n">xfs_dqreclaim_want</span><span class="p">);</span>
<span class="n">DEFINE_DQUOT_EVENT</span><span class="p">(</span><span class="n">xfs_dqreclaim_dirty</span><span class="p">);</span>
<span class="n">DEFINE_DQUOT_EVENT</span><span class="p">(</span><span class="n">xfs_dqreclaim_busy</span><span class="p">);</span>
<span class="n">DEFINE_DQUOT_EVENT</span><span class="p">(</span><span class="n">xfs_dqreclaim_done</span><span class="p">);</span>
<span class="n">DEFINE_DQUOT_EVENT</span><span class="p">(</span><span class="n">xfs_dqattach_found</span><span class="p">);</span>
<span class="n">DEFINE_DQUOT_EVENT</span><span class="p">(</span><span class="n">xfs_dqattach_get</span><span class="p">);</span>
<span class="n">DEFINE_DQUOT_EVENT</span><span class="p">(</span><span class="n">xfs_dqalloc</span><span class="p">);</span>
<span class="n">DEFINE_DQUOT_EVENT</span><span class="p">(</span><span class="n">xfs_dqtobp_read</span><span class="p">);</span>
<span class="n">DEFINE_DQUOT_EVENT</span><span class="p">(</span><span class="n">xfs_dqread</span><span class="p">);</span>
<span class="n">DEFINE_DQUOT_EVENT</span><span class="p">(</span><span class="n">xfs_dqread_fail</span><span class="p">);</span>
<span class="n">DEFINE_DQUOT_EVENT</span><span class="p">(</span><span class="n">xfs_dqget_hit</span><span class="p">);</span>
<span class="n">DEFINE_DQUOT_EVENT</span><span class="p">(</span><span class="n">xfs_dqget_miss</span><span class="p">);</span>
<span class="n">DEFINE_DQUOT_EVENT</span><span class="p">(</span><span class="n">xfs_dqget_freeing</span><span class="p">);</span>
<span class="n">DEFINE_DQUOT_EVENT</span><span class="p">(</span><span class="n">xfs_dqget_dup</span><span class="p">);</span>
<span class="n">DEFINE_DQUOT_EVENT</span><span class="p">(</span><span class="n">xfs_dqput</span><span class="p">);</span>
<span class="n">DEFINE_DQUOT_EVENT</span><span class="p">(</span><span class="n">xfs_dqput_wait</span><span class="p">);</span>
<span class="n">DEFINE_DQUOT_EVENT</span><span class="p">(</span><span class="n">xfs_dqput_free</span><span class="p">);</span>
<span class="n">DEFINE_DQUOT_EVENT</span><span class="p">(</span><span class="n">xfs_dqrele</span><span class="p">);</span>
<span class="n">DEFINE_DQUOT_EVENT</span><span class="p">(</span><span class="n">xfs_dqflush</span><span class="p">);</span>
<span class="n">DEFINE_DQUOT_EVENT</span><span class="p">(</span><span class="n">xfs_dqflush_force</span><span class="p">);</span>
<span class="n">DEFINE_DQUOT_EVENT</span><span class="p">(</span><span class="n">xfs_dqflush_done</span><span class="p">);</span>

<span class="n">DECLARE_EVENT_CLASS</span><span class="p">(</span><span class="n">xfs_loggrant_class</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xlog</span> <span class="o">*</span><span class="n">log</span><span class="p">,</span> <span class="k">struct</span> <span class="n">xlog_ticket</span> <span class="o">*</span><span class="n">tic</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">log</span><span class="p">,</span> <span class="n">tic</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span><span class="p">,</span> <span class="n">trans_type</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">char</span><span class="p">,</span> <span class="n">ocnt</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">char</span><span class="p">,</span> <span class="n">cnt</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">curr_res</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">unit_res</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">reserveq</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">writeq</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">grant_reserve_cycle</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">grant_reserve_bytes</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">grant_write_cycle</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">grant_write_bytes</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">curr_cycle</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">curr_block</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_lsn_t</span><span class="p">,</span> <span class="n">tail_lsn</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">log</span><span class="o">-&gt;</span><span class="n">l_mp</span><span class="o">-&gt;</span><span class="n">m_super</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">trans_type</span> <span class="o">=</span> <span class="n">tic</span><span class="o">-&gt;</span><span class="n">t_trans_type</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ocnt</span> <span class="o">=</span> <span class="n">tic</span><span class="o">-&gt;</span><span class="n">t_ocnt</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">cnt</span> <span class="o">=</span> <span class="n">tic</span><span class="o">-&gt;</span><span class="n">t_cnt</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">curr_res</span> <span class="o">=</span> <span class="n">tic</span><span class="o">-&gt;</span><span class="n">t_curr_res</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">unit_res</span> <span class="o">=</span> <span class="n">tic</span><span class="o">-&gt;</span><span class="n">t_unit_res</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">=</span> <span class="n">tic</span><span class="o">-&gt;</span><span class="n">t_flags</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">reserveq</span> <span class="o">=</span> <span class="n">list_empty</span><span class="p">(</span><span class="o">&amp;</span><span class="n">log</span><span class="o">-&gt;</span><span class="n">l_reserve_head</span><span class="p">.</span><span class="n">waiters</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">writeq</span> <span class="o">=</span> <span class="n">list_empty</span><span class="p">(</span><span class="o">&amp;</span><span class="n">log</span><span class="o">-&gt;</span><span class="n">l_write_head</span><span class="p">.</span><span class="n">waiters</span><span class="p">);</span>
		<span class="n">xlog_crack_grant_head</span><span class="p">(</span><span class="o">&amp;</span><span class="n">log</span><span class="o">-&gt;</span><span class="n">l_reserve_head</span><span class="p">.</span><span class="n">grant</span><span class="p">,</span>
				<span class="o">&amp;</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">grant_reserve_cycle</span><span class="p">,</span>
				<span class="o">&amp;</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">grant_reserve_bytes</span><span class="p">);</span>
		<span class="n">xlog_crack_grant_head</span><span class="p">(</span><span class="o">&amp;</span><span class="n">log</span><span class="o">-&gt;</span><span class="n">l_write_head</span><span class="p">.</span><span class="n">grant</span><span class="p">,</span>
				<span class="o">&amp;</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">grant_write_cycle</span><span class="p">,</span>
				<span class="o">&amp;</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">grant_write_bytes</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">curr_cycle</span> <span class="o">=</span> <span class="n">log</span><span class="o">-&gt;</span><span class="n">l_curr_cycle</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">curr_block</span> <span class="o">=</span> <span class="n">log</span><span class="o">-&gt;</span><span class="n">l_curr_block</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">tail_lsn</span> <span class="o">=</span> <span class="n">atomic64_read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">log</span><span class="o">-&gt;</span><span class="n">l_tail_lsn</span><span class="p">);</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d type %s t_ocnt %u t_cnt %u t_curr_res %u &quot;</span>
		  <span class="s">&quot;t_unit_res %u t_flags %s reserveq %s &quot;</span>
		  <span class="s">&quot;writeq %s grant_reserve_cycle %d &quot;</span>
		  <span class="s">&quot;grant_reserve_bytes %d grant_write_cycle %d &quot;</span>
		  <span class="s">&quot;grant_write_bytes %d curr_cycle %d curr_block %d &quot;</span>
		  <span class="s">&quot;tail_cycle %d tail_block %d&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__print_symbolic</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">trans_type</span><span class="p">,</span> <span class="n">XFS_TRANS_TYPES</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ocnt</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">cnt</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">curr_res</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">unit_res</span><span class="p">,</span>
		  <span class="n">__print_flags</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">,</span> <span class="s">&quot;|&quot;</span><span class="p">,</span> <span class="n">XLOG_TIC_FLAGS</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">reserveq</span> <span class="o">?</span> <span class="s">&quot;empty&quot;</span> <span class="o">:</span> <span class="s">&quot;active&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">writeq</span> <span class="o">?</span> <span class="s">&quot;empty&quot;</span> <span class="o">:</span> <span class="s">&quot;active&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">grant_reserve_cycle</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">grant_reserve_bytes</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">grant_write_cycle</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">grant_write_bytes</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">curr_cycle</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">curr_block</span><span class="p">,</span>
		  <span class="n">CYCLE_LSN</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">tail_lsn</span><span class="p">),</span>
		  <span class="n">BLOCK_LSN</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">tail_lsn</span><span class="p">)</span>
	<span class="p">)</span>
<span class="p">)</span>

<span class="cp">#define DEFINE_LOGGRANT_EVENT(name) \</span>
<span class="cp">DEFINE_EVENT(xfs_loggrant_class, name, \</span>
<span class="cp">	TP_PROTO(struct xlog *log, struct xlog_ticket *tic), \</span>
<span class="cp">	TP_ARGS(log, tic))</span>
<span class="n">DEFINE_LOGGRANT_EVENT</span><span class="p">(</span><span class="n">xfs_log_done_nonperm</span><span class="p">);</span>
<span class="n">DEFINE_LOGGRANT_EVENT</span><span class="p">(</span><span class="n">xfs_log_done_perm</span><span class="p">);</span>
<span class="n">DEFINE_LOGGRANT_EVENT</span><span class="p">(</span><span class="n">xfs_log_umount_write</span><span class="p">);</span>
<span class="n">DEFINE_LOGGRANT_EVENT</span><span class="p">(</span><span class="n">xfs_log_grant_sleep</span><span class="p">);</span>
<span class="n">DEFINE_LOGGRANT_EVENT</span><span class="p">(</span><span class="n">xfs_log_grant_wake</span><span class="p">);</span>
<span class="n">DEFINE_LOGGRANT_EVENT</span><span class="p">(</span><span class="n">xfs_log_grant_wake_up</span><span class="p">);</span>
<span class="n">DEFINE_LOGGRANT_EVENT</span><span class="p">(</span><span class="n">xfs_log_reserve</span><span class="p">);</span>
<span class="n">DEFINE_LOGGRANT_EVENT</span><span class="p">(</span><span class="n">xfs_log_reserve_exit</span><span class="p">);</span>
<span class="n">DEFINE_LOGGRANT_EVENT</span><span class="p">(</span><span class="n">xfs_log_regrant</span><span class="p">);</span>
<span class="n">DEFINE_LOGGRANT_EVENT</span><span class="p">(</span><span class="n">xfs_log_regrant_exit</span><span class="p">);</span>
<span class="n">DEFINE_LOGGRANT_EVENT</span><span class="p">(</span><span class="n">xfs_log_regrant_reserve_enter</span><span class="p">);</span>
<span class="n">DEFINE_LOGGRANT_EVENT</span><span class="p">(</span><span class="n">xfs_log_regrant_reserve_exit</span><span class="p">);</span>
<span class="n">DEFINE_LOGGRANT_EVENT</span><span class="p">(</span><span class="n">xfs_log_regrant_reserve_sub</span><span class="p">);</span>
<span class="n">DEFINE_LOGGRANT_EVENT</span><span class="p">(</span><span class="n">xfs_log_ungrant_enter</span><span class="p">);</span>
<span class="n">DEFINE_LOGGRANT_EVENT</span><span class="p">(</span><span class="n">xfs_log_ungrant_exit</span><span class="p">);</span>
<span class="n">DEFINE_LOGGRANT_EVENT</span><span class="p">(</span><span class="n">xfs_log_ungrant_sub</span><span class="p">);</span>

<span class="n">DECLARE_EVENT_CLASS</span><span class="p">(</span><span class="n">xfs_log_item_class</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_log_item</span> <span class="o">*</span><span class="n">lip</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">lip</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">,</span> <span class="n">lip</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">uint</span><span class="p">,</span> <span class="n">type</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">uint</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_lsn_t</span><span class="p">,</span> <span class="n">lsn</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">lip</span><span class="o">-&gt;</span><span class="n">li_mountp</span><span class="o">-&gt;</span><span class="n">m_super</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">lip</span> <span class="o">=</span> <span class="n">lip</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">type</span> <span class="o">=</span> <span class="n">lip</span><span class="o">-&gt;</span><span class="n">li_type</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">=</span> <span class="n">lip</span><span class="o">-&gt;</span><span class="n">li_flags</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">lsn</span> <span class="o">=</span> <span class="n">lip</span><span class="o">-&gt;</span><span class="n">li_lsn</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d lip 0x%p lsn %d/%d type %s flags %s&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">lip</span><span class="p">,</span>
		  <span class="n">CYCLE_LSN</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">lsn</span><span class="p">),</span> <span class="n">BLOCK_LSN</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">lsn</span><span class="p">),</span>
		  <span class="n">__print_symbolic</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">type</span><span class="p">,</span> <span class="n">XFS_LI_TYPE_DESC</span><span class="p">),</span>
		  <span class="n">__print_flags</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">,</span> <span class="s">&quot;|&quot;</span><span class="p">,</span> <span class="n">XFS_LI_FLAGS</span><span class="p">))</span>
<span class="p">)</span>

<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">xfs_log_force</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_mount</span> <span class="o">*</span><span class="n">mp</span><span class="p">,</span> <span class="n">xfs_lsn_t</span> <span class="n">lsn</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">mp</span><span class="p">,</span> <span class="n">lsn</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_lsn_t</span><span class="p">,</span> <span class="n">lsn</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">mp</span><span class="o">-&gt;</span><span class="n">m_super</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">lsn</span> <span class="o">=</span> <span class="n">lsn</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d lsn 0x%llx&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">lsn</span><span class="p">)</span>
<span class="p">)</span>

<span class="cp">#define DEFINE_LOG_ITEM_EVENT(name) \</span>
<span class="cp">DEFINE_EVENT(xfs_log_item_class, name, \</span>
<span class="cp">	TP_PROTO(struct xfs_log_item *lip), \</span>
<span class="cp">	TP_ARGS(lip))</span>
<span class="n">DEFINE_LOG_ITEM_EVENT</span><span class="p">(</span><span class="n">xfs_ail_push</span><span class="p">);</span>
<span class="n">DEFINE_LOG_ITEM_EVENT</span><span class="p">(</span><span class="n">xfs_ail_pinned</span><span class="p">);</span>
<span class="n">DEFINE_LOG_ITEM_EVENT</span><span class="p">(</span><span class="n">xfs_ail_locked</span><span class="p">);</span>
<span class="n">DEFINE_LOG_ITEM_EVENT</span><span class="p">(</span><span class="n">xfs_ail_flushing</span><span class="p">);</span>


<span class="n">DECLARE_EVENT_CLASS</span><span class="p">(</span><span class="n">xfs_file_class</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_inode</span> <span class="o">*</span><span class="n">ip</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">count</span><span class="p">,</span> <span class="n">loff_t</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">flags</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_ino_t</span><span class="p">,</span> <span class="n">ino</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_fsize_t</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">loff_t</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">VFS_I</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">i_sb</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span> <span class="o">=</span> <span class="n">ip</span><span class="o">-&gt;</span><span class="n">i_ino</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">size</span> <span class="o">=</span> <span class="n">ip</span><span class="o">-&gt;</span><span class="n">i_d</span><span class="p">.</span><span class="n">di_size</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">offset</span> <span class="o">=</span> <span class="n">offset</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">count</span> <span class="o">=</span> <span class="n">count</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">=</span> <span class="n">flags</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d ino 0x%llx size 0x%llx &quot;</span>
		  <span class="s">&quot;offset 0x%llx count 0x%zx ioflags %s&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">offset</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">count</span><span class="p">,</span>
		  <span class="n">__print_flags</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">,</span> <span class="s">&quot;|&quot;</span><span class="p">,</span> <span class="n">XFS_IO_FLAGS</span><span class="p">))</span>
<span class="p">)</span>

<span class="cp">#define DEFINE_RW_EVENT(name)		\</span>
<span class="cp">DEFINE_EVENT(xfs_file_class, name,	\</span>
<span class="cp">	TP_PROTO(struct xfs_inode *ip, size_t count, loff_t offset, int flags),	\</span>
<span class="cp">	TP_ARGS(ip, count, offset, flags))</span>
<span class="n">DEFINE_RW_EVENT</span><span class="p">(</span><span class="n">xfs_file_read</span><span class="p">);</span>
<span class="n">DEFINE_RW_EVENT</span><span class="p">(</span><span class="n">xfs_file_buffered_write</span><span class="p">);</span>
<span class="n">DEFINE_RW_EVENT</span><span class="p">(</span><span class="n">xfs_file_direct_write</span><span class="p">);</span>
<span class="n">DEFINE_RW_EVENT</span><span class="p">(</span><span class="n">xfs_file_splice_read</span><span class="p">);</span>
<span class="n">DEFINE_RW_EVENT</span><span class="p">(</span><span class="n">xfs_file_splice_write</span><span class="p">);</span>

<span class="n">DECLARE_EVENT_CLASS</span><span class="p">(</span><span class="n">xfs_page_class</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">inode</span> <span class="o">*</span><span class="n">inode</span><span class="p">,</span> <span class="k">struct</span> <span class="n">page</span> <span class="o">*</span><span class="n">page</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">off</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">inode</span><span class="p">,</span> <span class="n">page</span><span class="p">,</span> <span class="n">off</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_ino_t</span><span class="p">,</span> <span class="n">ino</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">pgoff_t</span><span class="p">,</span> <span class="n">pgoff</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">loff_t</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">delalloc</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">unwritten</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="kt">int</span> <span class="n">delalloc</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">unwritten</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">page_has_buffers</span><span class="p">(</span><span class="n">page</span><span class="p">))</span>
			<span class="n">xfs_count_page_state</span><span class="p">(</span><span class="n">page</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">delalloc</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">unwritten</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">inode</span><span class="o">-&gt;</span><span class="n">i_sb</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span> <span class="o">=</span> <span class="n">XFS_I</span><span class="p">(</span><span class="n">inode</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">i_ino</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">pgoff</span> <span class="o">=</span> <span class="n">page_offset</span><span class="p">(</span><span class="n">page</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">size</span> <span class="o">=</span> <span class="n">i_size_read</span><span class="p">(</span><span class="n">inode</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">offset</span> <span class="o">=</span> <span class="n">off</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">delalloc</span> <span class="o">=</span> <span class="n">delalloc</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">unwritten</span> <span class="o">=</span> <span class="n">unwritten</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d ino 0x%llx pgoff 0x%lx size 0x%llx offset %lx &quot;</span>
		  <span class="s">&quot;delalloc %d unwritten %d&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">pgoff</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">offset</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">delalloc</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">unwritten</span><span class="p">)</span>
<span class="p">)</span>

<span class="cp">#define DEFINE_PAGE_EVENT(name)		\</span>
<span class="cp">DEFINE_EVENT(xfs_page_class, name,	\</span>
<span class="cp">	TP_PROTO(struct inode *inode, struct page *page, unsigned long off),	\</span>
<span class="cp">	TP_ARGS(inode, page, off))</span>
<span class="n">DEFINE_PAGE_EVENT</span><span class="p">(</span><span class="n">xfs_writepage</span><span class="p">);</span>
<span class="n">DEFINE_PAGE_EVENT</span><span class="p">(</span><span class="n">xfs_releasepage</span><span class="p">);</span>
<span class="n">DEFINE_PAGE_EVENT</span><span class="p">(</span><span class="n">xfs_invalidatepage</span><span class="p">);</span>

<span class="n">DECLARE_EVENT_CLASS</span><span class="p">(</span><span class="n">xfs_imap_class</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_inode</span> <span class="o">*</span><span class="n">ip</span><span class="p">,</span> <span class="n">xfs_off_t</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">ssize_t</span> <span class="n">count</span><span class="p">,</span>
		 <span class="kt">int</span> <span class="n">type</span><span class="p">,</span> <span class="k">struct</span> <span class="n">xfs_bmbt_irec</span> <span class="o">*</span><span class="n">irec</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">type</span><span class="p">,</span> <span class="n">irec</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_ino_t</span><span class="p">,</span> <span class="n">ino</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">loff_t</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">loff_t</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">type</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_fileoff_t</span><span class="p">,</span> <span class="n">startoff</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_fsblock_t</span><span class="p">,</span> <span class="n">startblock</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_filblks_t</span><span class="p">,</span> <span class="n">blockcount</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">VFS_I</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">i_sb</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span> <span class="o">=</span> <span class="n">ip</span><span class="o">-&gt;</span><span class="n">i_ino</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">size</span> <span class="o">=</span> <span class="n">ip</span><span class="o">-&gt;</span><span class="n">i_d</span><span class="p">.</span><span class="n">di_size</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">offset</span> <span class="o">=</span> <span class="n">offset</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">count</span> <span class="o">=</span> <span class="n">count</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">type</span> <span class="o">=</span> <span class="n">type</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">startoff</span> <span class="o">=</span> <span class="n">irec</span> <span class="o">?</span> <span class="n">irec</span><span class="o">-&gt;</span><span class="n">br_startoff</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">startblock</span> <span class="o">=</span> <span class="n">irec</span> <span class="o">?</span> <span class="n">irec</span><span class="o">-&gt;</span><span class="n">br_startblock</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">blockcount</span> <span class="o">=</span> <span class="n">irec</span> <span class="o">?</span> <span class="n">irec</span><span class="o">-&gt;</span><span class="n">br_blockcount</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d ino 0x%llx size 0x%llx offset 0x%llx count %zd &quot;</span>
		  <span class="s">&quot;type %s startoff 0x%llx startblock %lld blockcount 0x%llx&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">offset</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">count</span><span class="p">,</span>
		  <span class="n">__print_symbolic</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">type</span><span class="p">,</span> <span class="n">XFS_IO_TYPES</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">startoff</span><span class="p">,</span>
		  <span class="p">(</span><span class="n">__int64_t</span><span class="p">)</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">startblock</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">blockcount</span><span class="p">)</span>
<span class="p">)</span>

<span class="cp">#define DEFINE_IOMAP_EVENT(name)	\</span>
<span class="cp">DEFINE_EVENT(xfs_imap_class, name,	\</span>
<span class="cp">	TP_PROTO(struct xfs_inode *ip, xfs_off_t offset, ssize_t count,	\</span>
<span class="cp">		 int type, struct xfs_bmbt_irec *irec),		\</span>
<span class="cp">	TP_ARGS(ip, offset, count, type, irec))</span>
<span class="n">DEFINE_IOMAP_EVENT</span><span class="p">(</span><span class="n">xfs_map_blocks_found</span><span class="p">);</span>
<span class="n">DEFINE_IOMAP_EVENT</span><span class="p">(</span><span class="n">xfs_map_blocks_alloc</span><span class="p">);</span>
<span class="n">DEFINE_IOMAP_EVENT</span><span class="p">(</span><span class="n">xfs_get_blocks_found</span><span class="p">);</span>
<span class="n">DEFINE_IOMAP_EVENT</span><span class="p">(</span><span class="n">xfs_get_blocks_alloc</span><span class="p">);</span>

<span class="n">DECLARE_EVENT_CLASS</span><span class="p">(</span><span class="n">xfs_simple_io_class</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_inode</span> <span class="o">*</span><span class="n">ip</span><span class="p">,</span> <span class="n">xfs_off_t</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">ssize_t</span> <span class="n">count</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">count</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_ino_t</span><span class="p">,</span> <span class="n">ino</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">loff_t</span><span class="p">,</span> <span class="n">isize</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">loff_t</span><span class="p">,</span> <span class="n">disize</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">loff_t</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">VFS_I</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">i_sb</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span> <span class="o">=</span> <span class="n">ip</span><span class="o">-&gt;</span><span class="n">i_ino</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">isize</span> <span class="o">=</span> <span class="n">VFS_I</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">i_size</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">disize</span> <span class="o">=</span> <span class="n">ip</span><span class="o">-&gt;</span><span class="n">i_d</span><span class="p">.</span><span class="n">di_size</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">offset</span> <span class="o">=</span> <span class="n">offset</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">count</span> <span class="o">=</span> <span class="n">count</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d ino 0x%llx isize 0x%llx disize 0x%llx &quot;</span>
		  <span class="s">&quot;offset 0x%llx count %zd&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">isize</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">disize</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">offset</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">count</span><span class="p">)</span>
<span class="p">);</span>

<span class="cp">#define DEFINE_SIMPLE_IO_EVENT(name)	\</span>
<span class="cp">DEFINE_EVENT(xfs_simple_io_class, name,	\</span>
<span class="cp">	TP_PROTO(struct xfs_inode *ip, xfs_off_t offset, ssize_t count),	\</span>
<span class="cp">	TP_ARGS(ip, offset, count))</span>
<span class="n">DEFINE_SIMPLE_IO_EVENT</span><span class="p">(</span><span class="n">xfs_delalloc_enospc</span><span class="p">);</span>
<span class="n">DEFINE_SIMPLE_IO_EVENT</span><span class="p">(</span><span class="n">xfs_unwritten_convert</span><span class="p">);</span>
<span class="n">DEFINE_SIMPLE_IO_EVENT</span><span class="p">(</span><span class="n">xfs_get_blocks_notfound</span><span class="p">);</span>
<span class="n">DEFINE_SIMPLE_IO_EVENT</span><span class="p">(</span><span class="n">xfs_setfilesize</span><span class="p">);</span>

<span class="n">DECLARE_EVENT_CLASS</span><span class="p">(</span><span class="n">xfs_itrunc_class</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_inode</span> <span class="o">*</span><span class="n">ip</span><span class="p">,</span> <span class="n">xfs_fsize_t</span> <span class="n">new_size</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">new_size</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_ino_t</span><span class="p">,</span> <span class="n">ino</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_fsize_t</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_fsize_t</span><span class="p">,</span> <span class="n">new_size</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">VFS_I</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">i_sb</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span> <span class="o">=</span> <span class="n">ip</span><span class="o">-&gt;</span><span class="n">i_ino</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">size</span> <span class="o">=</span> <span class="n">ip</span><span class="o">-&gt;</span><span class="n">i_d</span><span class="p">.</span><span class="n">di_size</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">new_size</span> <span class="o">=</span> <span class="n">new_size</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d ino 0x%llx size 0x%llx new_size 0x%llx&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">new_size</span><span class="p">)</span>
<span class="p">)</span>

<span class="cp">#define DEFINE_ITRUNC_EVENT(name) \</span>
<span class="cp">DEFINE_EVENT(xfs_itrunc_class, name, \</span>
<span class="cp">	TP_PROTO(struct xfs_inode *ip, xfs_fsize_t new_size), \</span>
<span class="cp">	TP_ARGS(ip, new_size))</span>
<span class="n">DEFINE_ITRUNC_EVENT</span><span class="p">(</span><span class="n">xfs_itruncate_extents_start</span><span class="p">);</span>
<span class="n">DEFINE_ITRUNC_EVENT</span><span class="p">(</span><span class="n">xfs_itruncate_extents_end</span><span class="p">);</span>

<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">xfs_pagecache_inval</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_inode</span> <span class="o">*</span><span class="n">ip</span><span class="p">,</span> <span class="n">xfs_off_t</span> <span class="n">start</span><span class="p">,</span> <span class="n">xfs_off_t</span> <span class="n">finish</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">finish</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_ino_t</span><span class="p">,</span> <span class="n">ino</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_fsize_t</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_off_t</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_off_t</span><span class="p">,</span> <span class="n">finish</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">VFS_I</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">i_sb</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span> <span class="o">=</span> <span class="n">ip</span><span class="o">-&gt;</span><span class="n">i_ino</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">size</span> <span class="o">=</span> <span class="n">ip</span><span class="o">-&gt;</span><span class="n">i_d</span><span class="p">.</span><span class="n">di_size</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">start</span> <span class="o">=</span> <span class="n">start</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">finish</span> <span class="o">=</span> <span class="n">finish</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d ino 0x%llx size 0x%llx start 0x%llx finish 0x%llx&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">finish</span><span class="p">)</span>
<span class="p">);</span>

<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">xfs_bunmap</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_inode</span> <span class="o">*</span><span class="n">ip</span><span class="p">,</span> <span class="n">xfs_fileoff_t</span> <span class="n">bno</span><span class="p">,</span> <span class="n">xfs_filblks_t</span> <span class="n">len</span><span class="p">,</span>
		 <span class="kt">int</span> <span class="n">flags</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">caller_ip</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">bno</span><span class="p">,</span> <span class="n">len</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">caller_ip</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_ino_t</span><span class="p">,</span> <span class="n">ino</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_fsize_t</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_fileoff_t</span><span class="p">,</span> <span class="n">bno</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_filblks_t</span><span class="p">,</span> <span class="n">len</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span> <span class="n">caller_ip</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">VFS_I</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">i_sb</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span> <span class="o">=</span> <span class="n">ip</span><span class="o">-&gt;</span><span class="n">i_ino</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">size</span> <span class="o">=</span> <span class="n">ip</span><span class="o">-&gt;</span><span class="n">i_d</span><span class="p">.</span><span class="n">di_size</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bno</span> <span class="o">=</span> <span class="n">bno</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">len</span> <span class="o">=</span> <span class="n">len</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">caller_ip</span> <span class="o">=</span> <span class="n">caller_ip</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">=</span> <span class="n">flags</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d ino 0x%llx size 0x%llx bno 0x%llx len 0x%llx&quot;</span>
		  <span class="s">&quot;flags %s caller %pf&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bno</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">len</span><span class="p">,</span>
		  <span class="n">__print_flags</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">,</span> <span class="s">&quot;|&quot;</span><span class="p">,</span> <span class="n">XFS_BMAPI_FLAGS</span><span class="p">),</span>
		  <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">caller_ip</span><span class="p">)</span>

<span class="p">);</span>

<span class="n">DECLARE_EVENT_CLASS</span><span class="p">(</span><span class="n">xfs_extent_busy_class</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_mount</span> <span class="o">*</span><span class="n">mp</span><span class="p">,</span> <span class="n">xfs_agnumber_t</span> <span class="n">agno</span><span class="p">,</span>
		 <span class="n">xfs_agblock_t</span> <span class="n">agbno</span><span class="p">,</span> <span class="n">xfs_extlen_t</span> <span class="n">len</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">mp</span><span class="p">,</span> <span class="n">agno</span><span class="p">,</span> <span class="n">agbno</span><span class="p">,</span> <span class="n">len</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_agnumber_t</span><span class="p">,</span> <span class="n">agno</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_agblock_t</span><span class="p">,</span> <span class="n">agbno</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_extlen_t</span><span class="p">,</span> <span class="n">len</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">mp</span><span class="o">-&gt;</span><span class="n">m_super</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">agno</span> <span class="o">=</span> <span class="n">agno</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">agbno</span> <span class="o">=</span> <span class="n">agbno</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">len</span> <span class="o">=</span> <span class="n">len</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d agno %u agbno %u len %u&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">agno</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">agbno</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">len</span><span class="p">)</span>
<span class="p">);</span>
<span class="cp">#define DEFINE_BUSY_EVENT(name) \</span>
<span class="cp">DEFINE_EVENT(xfs_extent_busy_class, name, \</span>
<span class="cp">	TP_PROTO(struct xfs_mount *mp, xfs_agnumber_t agno, \</span>
<span class="cp">		 xfs_agblock_t agbno, xfs_extlen_t len), \</span>
<span class="cp">	TP_ARGS(mp, agno, agbno, len))</span>
<span class="n">DEFINE_BUSY_EVENT</span><span class="p">(</span><span class="n">xfs_extent_busy</span><span class="p">);</span>
<span class="n">DEFINE_BUSY_EVENT</span><span class="p">(</span><span class="n">xfs_extent_busy_enomem</span><span class="p">);</span>
<span class="n">DEFINE_BUSY_EVENT</span><span class="p">(</span><span class="n">xfs_extent_busy_force</span><span class="p">);</span>
<span class="n">DEFINE_BUSY_EVENT</span><span class="p">(</span><span class="n">xfs_extent_busy_reuse</span><span class="p">);</span>
<span class="n">DEFINE_BUSY_EVENT</span><span class="p">(</span><span class="n">xfs_extent_busy_clear</span><span class="p">);</span>

<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">xfs_extent_busy_trim</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_mount</span> <span class="o">*</span><span class="n">mp</span><span class="p">,</span> <span class="n">xfs_agnumber_t</span> <span class="n">agno</span><span class="p">,</span>
		 <span class="n">xfs_agblock_t</span> <span class="n">agbno</span><span class="p">,</span> <span class="n">xfs_extlen_t</span> <span class="n">len</span><span class="p">,</span>
		 <span class="n">xfs_agblock_t</span> <span class="n">tbno</span><span class="p">,</span> <span class="n">xfs_extlen_t</span> <span class="n">tlen</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">mp</span><span class="p">,</span> <span class="n">agno</span><span class="p">,</span> <span class="n">agbno</span><span class="p">,</span> <span class="n">len</span><span class="p">,</span> <span class="n">tbno</span><span class="p">,</span> <span class="n">tlen</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_agnumber_t</span><span class="p">,</span> <span class="n">agno</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_agblock_t</span><span class="p">,</span> <span class="n">agbno</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_extlen_t</span><span class="p">,</span> <span class="n">len</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_agblock_t</span><span class="p">,</span> <span class="n">tbno</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_extlen_t</span><span class="p">,</span> <span class="n">tlen</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">mp</span><span class="o">-&gt;</span><span class="n">m_super</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">agno</span> <span class="o">=</span> <span class="n">agno</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">agbno</span> <span class="o">=</span> <span class="n">agbno</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">len</span> <span class="o">=</span> <span class="n">len</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">tbno</span> <span class="o">=</span> <span class="n">tbno</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">tlen</span> <span class="o">=</span> <span class="n">tlen</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d agno %u agbno %u len %u tbno %u tlen %u&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">agno</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">agbno</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">len</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">tbno</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">tlen</span><span class="p">)</span>
<span class="p">);</span>

<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">xfs_trans_commit_lsn</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_trans</span> <span class="o">*</span><span class="n">trans</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">trans</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_trans</span> <span class="o">*</span><span class="p">,</span> <span class="n">tp</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_lsn_t</span><span class="p">,</span> <span class="n">lsn</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">trans</span><span class="o">-&gt;</span><span class="n">t_mountp</span><span class="o">-&gt;</span><span class="n">m_super</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">tp</span> <span class="o">=</span> <span class="n">trans</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">lsn</span> <span class="o">=</span> <span class="n">trans</span><span class="o">-&gt;</span><span class="n">t_commit_lsn</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d trans 0x%p commit_lsn 0x%llx&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">tp</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">lsn</span><span class="p">)</span>
<span class="p">);</span>

<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">xfs_agf</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_mount</span> <span class="o">*</span><span class="n">mp</span><span class="p">,</span> <span class="k">struct</span> <span class="n">xfs_agf</span> <span class="o">*</span><span class="n">agf</span><span class="p">,</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">,</span>
		 <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">caller_ip</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">mp</span><span class="p">,</span> <span class="n">agf</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">caller_ip</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_agnumber_t</span><span class="p">,</span> <span class="n">agno</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">__u32</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">__u32</span><span class="p">,</span> <span class="n">bno_root</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">__u32</span><span class="p">,</span> <span class="n">cnt_root</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">__u32</span><span class="p">,</span> <span class="n">bno_level</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">__u32</span><span class="p">,</span> <span class="n">cnt_level</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">__u32</span><span class="p">,</span> <span class="n">flfirst</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">__u32</span><span class="p">,</span> <span class="n">fllast</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">__u32</span><span class="p">,</span> <span class="n">flcount</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">__u32</span><span class="p">,</span> <span class="n">freeblks</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">__u32</span><span class="p">,</span> <span class="n">longest</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span> <span class="n">caller_ip</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">mp</span><span class="o">-&gt;</span><span class="n">m_super</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">agno</span> <span class="o">=</span> <span class="n">be32_to_cpu</span><span class="p">(</span><span class="n">agf</span><span class="o">-&gt;</span><span class="n">agf_seqno</span><span class="p">),</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">=</span> <span class="n">flags</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">length</span> <span class="o">=</span> <span class="n">be32_to_cpu</span><span class="p">(</span><span class="n">agf</span><span class="o">-&gt;</span><span class="n">agf_length</span><span class="p">),</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bno_root</span> <span class="o">=</span> <span class="n">be32_to_cpu</span><span class="p">(</span><span class="n">agf</span><span class="o">-&gt;</span><span class="n">agf_roots</span><span class="p">[</span><span class="n">XFS_BTNUM_BNO</span><span class="p">]),</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">cnt_root</span> <span class="o">=</span> <span class="n">be32_to_cpu</span><span class="p">(</span><span class="n">agf</span><span class="o">-&gt;</span><span class="n">agf_roots</span><span class="p">[</span><span class="n">XFS_BTNUM_CNT</span><span class="p">]),</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bno_level</span> <span class="o">=</span>
				<span class="n">be32_to_cpu</span><span class="p">(</span><span class="n">agf</span><span class="o">-&gt;</span><span class="n">agf_levels</span><span class="p">[</span><span class="n">XFS_BTNUM_BNO</span><span class="p">]),</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">cnt_level</span> <span class="o">=</span>
				<span class="n">be32_to_cpu</span><span class="p">(</span><span class="n">agf</span><span class="o">-&gt;</span><span class="n">agf_levels</span><span class="p">[</span><span class="n">XFS_BTNUM_CNT</span><span class="p">]),</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flfirst</span> <span class="o">=</span> <span class="n">be32_to_cpu</span><span class="p">(</span><span class="n">agf</span><span class="o">-&gt;</span><span class="n">agf_flfirst</span><span class="p">),</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">fllast</span> <span class="o">=</span> <span class="n">be32_to_cpu</span><span class="p">(</span><span class="n">agf</span><span class="o">-&gt;</span><span class="n">agf_fllast</span><span class="p">),</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flcount</span> <span class="o">=</span> <span class="n">be32_to_cpu</span><span class="p">(</span><span class="n">agf</span><span class="o">-&gt;</span><span class="n">agf_flcount</span><span class="p">),</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">freeblks</span> <span class="o">=</span> <span class="n">be32_to_cpu</span><span class="p">(</span><span class="n">agf</span><span class="o">-&gt;</span><span class="n">agf_freeblks</span><span class="p">),</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">longest</span> <span class="o">=</span> <span class="n">be32_to_cpu</span><span class="p">(</span><span class="n">agf</span><span class="o">-&gt;</span><span class="n">agf_longest</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">caller_ip</span> <span class="o">=</span> <span class="n">caller_ip</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d agno %u flags %s length %u roots b %u c %u &quot;</span>
		  <span class="s">&quot;levels b %u c %u flfirst %u fllast %u flcount %u &quot;</span>
		  <span class="s">&quot;freeblks %u longest %u caller %pf&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">agno</span><span class="p">,</span>
		  <span class="n">__print_flags</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">,</span> <span class="s">&quot;|&quot;</span><span class="p">,</span> <span class="n">XFS_AGF_FLAGS</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">length</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bno_root</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">cnt_root</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">bno_level</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">cnt_level</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flfirst</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">fllast</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flcount</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">freeblks</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">longest</span><span class="p">,</span>
		  <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">caller_ip</span><span class="p">)</span>
<span class="p">);</span>

<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">xfs_free_extent</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_mount</span> <span class="o">*</span><span class="n">mp</span><span class="p">,</span> <span class="n">xfs_agnumber_t</span> <span class="n">agno</span><span class="p">,</span> <span class="n">xfs_agblock_t</span> <span class="n">agbno</span><span class="p">,</span>
		 <span class="n">xfs_extlen_t</span> <span class="n">len</span><span class="p">,</span> <span class="n">bool</span> <span class="n">isfl</span><span class="p">,</span> <span class="kt">int</span> <span class="n">haveleft</span><span class="p">,</span> <span class="kt">int</span> <span class="n">haveright</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">mp</span><span class="p">,</span> <span class="n">agno</span><span class="p">,</span> <span class="n">agbno</span><span class="p">,</span> <span class="n">len</span><span class="p">,</span> <span class="n">isfl</span><span class="p">,</span> <span class="n">haveleft</span><span class="p">,</span> <span class="n">haveright</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_agnumber_t</span><span class="p">,</span> <span class="n">agno</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_agblock_t</span><span class="p">,</span> <span class="n">agbno</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_extlen_t</span><span class="p">,</span> <span class="n">len</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">isfl</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">haveleft</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">haveright</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">mp</span><span class="o">-&gt;</span><span class="n">m_super</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">agno</span> <span class="o">=</span> <span class="n">agno</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">agbno</span> <span class="o">=</span> <span class="n">agbno</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">len</span> <span class="o">=</span> <span class="n">len</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">isfl</span> <span class="o">=</span> <span class="n">isfl</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">haveleft</span> <span class="o">=</span> <span class="n">haveleft</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">haveright</span> <span class="o">=</span> <span class="n">haveright</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d agno %u agbno %u len %u isfl %d %s&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">agno</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">agbno</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">len</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">isfl</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">haveleft</span> <span class="o">?</span>
			<span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">haveright</span> <span class="o">?</span> <span class="s">&quot;both&quot;</span> <span class="o">:</span> <span class="s">&quot;left&quot;</span><span class="p">)</span> <span class="o">:</span>
			<span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">haveright</span> <span class="o">?</span> <span class="s">&quot;right&quot;</span> <span class="o">:</span> <span class="s">&quot;none&quot;</span><span class="p">))</span>

<span class="p">);</span>

<span class="n">DECLARE_EVENT_CLASS</span><span class="p">(</span><span class="n">xfs_alloc_class</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_alloc_arg</span> <span class="o">*</span><span class="n">args</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">args</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_agnumber_t</span><span class="p">,</span> <span class="n">agno</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_agblock_t</span><span class="p">,</span> <span class="n">agbno</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_extlen_t</span><span class="p">,</span> <span class="n">minlen</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_extlen_t</span><span class="p">,</span> <span class="n">maxlen</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_extlen_t</span><span class="p">,</span> <span class="n">mod</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_extlen_t</span><span class="p">,</span> <span class="n">prod</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_extlen_t</span><span class="p">,</span> <span class="n">minleft</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_extlen_t</span><span class="p">,</span> <span class="n">total</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_extlen_t</span><span class="p">,</span> <span class="n">alignment</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_extlen_t</span><span class="p">,</span> <span class="n">minalignslop</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_extlen_t</span><span class="p">,</span> <span class="n">len</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">short</span><span class="p">,</span> <span class="n">type</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">short</span><span class="p">,</span> <span class="n">otype</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">char</span><span class="p">,</span> <span class="n">wasdel</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">char</span><span class="p">,</span> <span class="n">wasfromfl</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">char</span><span class="p">,</span> <span class="n">isfl</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">char</span><span class="p">,</span> <span class="n">userdata</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_fsblock_t</span><span class="p">,</span> <span class="n">firstblock</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">mp</span><span class="o">-&gt;</span><span class="n">m_super</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">agno</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">agno</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">agbno</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">agbno</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">minlen</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">minlen</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">maxlen</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">maxlen</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">mod</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">mod</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">prod</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">prod</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">minleft</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">minleft</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">total</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">total</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">alignment</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">minalignslop</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">minalignslop</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">len</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">len</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">type</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">type</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">otype</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">otype</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">wasdel</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">wasdel</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">wasfromfl</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">wasfromfl</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">isfl</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">isfl</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">userdata</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">userdata</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">firstblock</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">firstblock</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d agno %u agbno %u minlen %u maxlen %u mod %u &quot;</span>
		  <span class="s">&quot;prod %u minleft %u total %u alignment %u minalignslop %u &quot;</span>
		  <span class="s">&quot;len %u type %s otype %s wasdel %d wasfromfl %d isfl %d &quot;</span>
		  <span class="s">&quot;userdata %d firstblock 0x%llx&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">agno</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">agbno</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">minlen</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">maxlen</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">mod</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">prod</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">minleft</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">total</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">alignment</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">minalignslop</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">len</span><span class="p">,</span>
		  <span class="n">__print_symbolic</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">type</span><span class="p">,</span> <span class="n">XFS_ALLOC_TYPES</span><span class="p">),</span>
		  <span class="n">__print_symbolic</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">otype</span><span class="p">,</span> <span class="n">XFS_ALLOC_TYPES</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">wasdel</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">wasfromfl</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">isfl</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">userdata</span><span class="p">,</span>
		  <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">)</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">firstblock</span><span class="p">)</span>
<span class="p">)</span>

<span class="cp">#define DEFINE_ALLOC_EVENT(name) \</span>
<span class="cp">DEFINE_EVENT(xfs_alloc_class, name, \</span>
<span class="cp">	TP_PROTO(struct xfs_alloc_arg *args), \</span>
<span class="cp">	TP_ARGS(args))</span>
<span class="n">DEFINE_ALLOC_EVENT</span><span class="p">(</span><span class="n">xfs_alloc_exact_done</span><span class="p">);</span>
<span class="n">DEFINE_ALLOC_EVENT</span><span class="p">(</span><span class="n">xfs_alloc_exact_notfound</span><span class="p">);</span>
<span class="n">DEFINE_ALLOC_EVENT</span><span class="p">(</span><span class="n">xfs_alloc_exact_error</span><span class="p">);</span>
<span class="n">DEFINE_ALLOC_EVENT</span><span class="p">(</span><span class="n">xfs_alloc_near_nominleft</span><span class="p">);</span>
<span class="n">DEFINE_ALLOC_EVENT</span><span class="p">(</span><span class="n">xfs_alloc_near_first</span><span class="p">);</span>
<span class="n">DEFINE_ALLOC_EVENT</span><span class="p">(</span><span class="n">xfs_alloc_near_greater</span><span class="p">);</span>
<span class="n">DEFINE_ALLOC_EVENT</span><span class="p">(</span><span class="n">xfs_alloc_near_lesser</span><span class="p">);</span>
<span class="n">DEFINE_ALLOC_EVENT</span><span class="p">(</span><span class="n">xfs_alloc_near_error</span><span class="p">);</span>
<span class="n">DEFINE_ALLOC_EVENT</span><span class="p">(</span><span class="n">xfs_alloc_near_noentry</span><span class="p">);</span>
<span class="n">DEFINE_ALLOC_EVENT</span><span class="p">(</span><span class="n">xfs_alloc_near_busy</span><span class="p">);</span>
<span class="n">DEFINE_ALLOC_EVENT</span><span class="p">(</span><span class="n">xfs_alloc_size_neither</span><span class="p">);</span>
<span class="n">DEFINE_ALLOC_EVENT</span><span class="p">(</span><span class="n">xfs_alloc_size_noentry</span><span class="p">);</span>
<span class="n">DEFINE_ALLOC_EVENT</span><span class="p">(</span><span class="n">xfs_alloc_size_nominleft</span><span class="p">);</span>
<span class="n">DEFINE_ALLOC_EVENT</span><span class="p">(</span><span class="n">xfs_alloc_size_done</span><span class="p">);</span>
<span class="n">DEFINE_ALLOC_EVENT</span><span class="p">(</span><span class="n">xfs_alloc_size_error</span><span class="p">);</span>
<span class="n">DEFINE_ALLOC_EVENT</span><span class="p">(</span><span class="n">xfs_alloc_size_busy</span><span class="p">);</span>
<span class="n">DEFINE_ALLOC_EVENT</span><span class="p">(</span><span class="n">xfs_alloc_small_freelist</span><span class="p">);</span>
<span class="n">DEFINE_ALLOC_EVENT</span><span class="p">(</span><span class="n">xfs_alloc_small_notenough</span><span class="p">);</span>
<span class="n">DEFINE_ALLOC_EVENT</span><span class="p">(</span><span class="n">xfs_alloc_small_done</span><span class="p">);</span>
<span class="n">DEFINE_ALLOC_EVENT</span><span class="p">(</span><span class="n">xfs_alloc_small_error</span><span class="p">);</span>
<span class="n">DEFINE_ALLOC_EVENT</span><span class="p">(</span><span class="n">xfs_alloc_vextent_badargs</span><span class="p">);</span>
<span class="n">DEFINE_ALLOC_EVENT</span><span class="p">(</span><span class="n">xfs_alloc_vextent_nofix</span><span class="p">);</span>
<span class="n">DEFINE_ALLOC_EVENT</span><span class="p">(</span><span class="n">xfs_alloc_vextent_noagbp</span><span class="p">);</span>
<span class="n">DEFINE_ALLOC_EVENT</span><span class="p">(</span><span class="n">xfs_alloc_vextent_loopfailed</span><span class="p">);</span>
<span class="n">DEFINE_ALLOC_EVENT</span><span class="p">(</span><span class="n">xfs_alloc_vextent_allfailed</span><span class="p">);</span>

<span class="n">DECLARE_EVENT_CLASS</span><span class="p">(</span><span class="n">xfs_da_class</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_da_args</span> <span class="o">*</span><span class="n">args</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">args</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_ino_t</span><span class="p">,</span> <span class="n">ino</span><span class="p">)</span>
		<span class="n">__dynamic_array</span><span class="p">(</span><span class="kt">char</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">namelen</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">namelen</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_dahash_t</span><span class="p">,</span> <span class="n">hashval</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_ino_t</span><span class="p">,</span> <span class="n">inumber</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">op_flags</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">VFS_I</span><span class="p">(</span><span class="n">args</span><span class="o">-&gt;</span><span class="n">dp</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">i_sb</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">dp</span><span class="o">-&gt;</span><span class="n">i_ino</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">args</span><span class="o">-&gt;</span><span class="n">namelen</span><span class="p">)</span>
			<span class="n">memcpy</span><span class="p">(</span><span class="n">__get_str</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">namelen</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">namelen</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">namelen</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">hashval</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">hashval</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">inumber</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">inumber</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">op_flags</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">op_flags</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d ino 0x%llx name %.*s namelen %d hashval 0x%x &quot;</span>
		  <span class="s">&quot;inumber 0x%llx op_flags %s&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">namelen</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">namelen</span> <span class="o">?</span> <span class="n">__get_str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">:</span> <span class="nb">NULL</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">namelen</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">hashval</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">inumber</span><span class="p">,</span>
		  <span class="n">__print_flags</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">op_flags</span><span class="p">,</span> <span class="s">&quot;|&quot;</span><span class="p">,</span> <span class="n">XFS_DA_OP_FLAGS</span><span class="p">))</span>
<span class="p">)</span>

<span class="cp">#define DEFINE_DIR2_EVENT(name) \</span>
<span class="cp">DEFINE_EVENT(xfs_da_class, name, \</span>
<span class="cp">	TP_PROTO(struct xfs_da_args *args), \</span>
<span class="cp">	TP_ARGS(args))</span>
<span class="n">DEFINE_DIR2_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_sf_addname</span><span class="p">);</span>
<span class="n">DEFINE_DIR2_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_sf_create</span><span class="p">);</span>
<span class="n">DEFINE_DIR2_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_sf_lookup</span><span class="p">);</span>
<span class="n">DEFINE_DIR2_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_sf_replace</span><span class="p">);</span>
<span class="n">DEFINE_DIR2_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_sf_removename</span><span class="p">);</span>
<span class="n">DEFINE_DIR2_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_sf_toino4</span><span class="p">);</span>
<span class="n">DEFINE_DIR2_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_sf_toino8</span><span class="p">);</span>
<span class="n">DEFINE_DIR2_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_sf_to_block</span><span class="p">);</span>
<span class="n">DEFINE_DIR2_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_block_addname</span><span class="p">);</span>
<span class="n">DEFINE_DIR2_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_block_lookup</span><span class="p">);</span>
<span class="n">DEFINE_DIR2_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_block_replace</span><span class="p">);</span>
<span class="n">DEFINE_DIR2_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_block_removename</span><span class="p">);</span>
<span class="n">DEFINE_DIR2_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_block_to_sf</span><span class="p">);</span>
<span class="n">DEFINE_DIR2_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_block_to_leaf</span><span class="p">);</span>
<span class="n">DEFINE_DIR2_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_leaf_addname</span><span class="p">);</span>
<span class="n">DEFINE_DIR2_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_leaf_lookup</span><span class="p">);</span>
<span class="n">DEFINE_DIR2_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_leaf_replace</span><span class="p">);</span>
<span class="n">DEFINE_DIR2_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_leaf_removename</span><span class="p">);</span>
<span class="n">DEFINE_DIR2_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_leaf_to_block</span><span class="p">);</span>
<span class="n">DEFINE_DIR2_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_leaf_to_node</span><span class="p">);</span>
<span class="n">DEFINE_DIR2_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_node_addname</span><span class="p">);</span>
<span class="n">DEFINE_DIR2_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_node_lookup</span><span class="p">);</span>
<span class="n">DEFINE_DIR2_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_node_replace</span><span class="p">);</span>
<span class="n">DEFINE_DIR2_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_node_removename</span><span class="p">);</span>
<span class="n">DEFINE_DIR2_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_node_to_leaf</span><span class="p">);</span>

<span class="cp">#define DEFINE_ATTR_EVENT(name) \</span>
<span class="cp">DEFINE_EVENT(xfs_da_class, name, \</span>
<span class="cp">	TP_PROTO(struct xfs_da_args *args), \</span>
<span class="cp">	TP_ARGS(args))</span>
<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_sf_add</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_sf_addname</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_sf_create</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_sf_lookup</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_sf_remove</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_sf_removename</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_sf_to_leaf</span><span class="p">);</span>

<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_leaf_add</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_leaf_add_old</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_leaf_add_new</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_leaf_addname</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_leaf_create</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_leaf_lookup</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_leaf_replace</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_leaf_removename</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_leaf_split</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_leaf_split_before</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_leaf_split_after</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_leaf_clearflag</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_leaf_setflag</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_leaf_flipflags</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_leaf_to_sf</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_leaf_to_node</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_leaf_rebalance</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_leaf_unbalance</span><span class="p">);</span>

<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_node_addname</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_node_lookup</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_node_replace</span><span class="p">);</span>
<span class="n">DEFINE_ATTR_EVENT</span><span class="p">(</span><span class="n">xfs_attr_node_removename</span><span class="p">);</span>

<span class="cp">#define DEFINE_DA_EVENT(name) \</span>
<span class="cp">DEFINE_EVENT(xfs_da_class, name, \</span>
<span class="cp">	TP_PROTO(struct xfs_da_args *args), \</span>
<span class="cp">	TP_ARGS(args))</span>
<span class="n">DEFINE_DA_EVENT</span><span class="p">(</span><span class="n">xfs_da_split</span><span class="p">);</span>
<span class="n">DEFINE_DA_EVENT</span><span class="p">(</span><span class="n">xfs_da_join</span><span class="p">);</span>
<span class="n">DEFINE_DA_EVENT</span><span class="p">(</span><span class="n">xfs_da_link_before</span><span class="p">);</span>
<span class="n">DEFINE_DA_EVENT</span><span class="p">(</span><span class="n">xfs_da_link_after</span><span class="p">);</span>
<span class="n">DEFINE_DA_EVENT</span><span class="p">(</span><span class="n">xfs_da_unlink_back</span><span class="p">);</span>
<span class="n">DEFINE_DA_EVENT</span><span class="p">(</span><span class="n">xfs_da_unlink_forward</span><span class="p">);</span>
<span class="n">DEFINE_DA_EVENT</span><span class="p">(</span><span class="n">xfs_da_root_split</span><span class="p">);</span>
<span class="n">DEFINE_DA_EVENT</span><span class="p">(</span><span class="n">xfs_da_root_join</span><span class="p">);</span>
<span class="n">DEFINE_DA_EVENT</span><span class="p">(</span><span class="n">xfs_da_node_add</span><span class="p">);</span>
<span class="n">DEFINE_DA_EVENT</span><span class="p">(</span><span class="n">xfs_da_node_create</span><span class="p">);</span>
<span class="n">DEFINE_DA_EVENT</span><span class="p">(</span><span class="n">xfs_da_node_split</span><span class="p">);</span>
<span class="n">DEFINE_DA_EVENT</span><span class="p">(</span><span class="n">xfs_da_node_remove</span><span class="p">);</span>
<span class="n">DEFINE_DA_EVENT</span><span class="p">(</span><span class="n">xfs_da_node_rebalance</span><span class="p">);</span>
<span class="n">DEFINE_DA_EVENT</span><span class="p">(</span><span class="n">xfs_da_node_unbalance</span><span class="p">);</span>
<span class="n">DEFINE_DA_EVENT</span><span class="p">(</span><span class="n">xfs_da_swap_lastblock</span><span class="p">);</span>
<span class="n">DEFINE_DA_EVENT</span><span class="p">(</span><span class="n">xfs_da_grow_inode</span><span class="p">);</span>
<span class="n">DEFINE_DA_EVENT</span><span class="p">(</span><span class="n">xfs_da_shrink_inode</span><span class="p">);</span>

<span class="n">DECLARE_EVENT_CLASS</span><span class="p">(</span><span class="n">xfs_dir2_space_class</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_da_args</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="kt">int</span> <span class="n">idx</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">idx</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_ino_t</span><span class="p">,</span> <span class="n">ino</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">op_flags</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">VFS_I</span><span class="p">(</span><span class="n">args</span><span class="o">-&gt;</span><span class="n">dp</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">i_sb</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">dp</span><span class="o">-&gt;</span><span class="n">i_ino</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">op_flags</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">op_flags</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d ino 0x%llx op_flags %s index %d&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span><span class="p">,</span>
		  <span class="n">__print_flags</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">op_flags</span><span class="p">,</span> <span class="s">&quot;|&quot;</span><span class="p">,</span> <span class="n">XFS_DA_OP_FLAGS</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">idx</span><span class="p">)</span>
<span class="p">)</span>

<span class="cp">#define DEFINE_DIR2_SPACE_EVENT(name) \</span>
<span class="cp">DEFINE_EVENT(xfs_dir2_space_class, name, \</span>
<span class="cp">	TP_PROTO(struct xfs_da_args *args, int idx), \</span>
<span class="cp">	TP_ARGS(args, idx))</span>
<span class="n">DEFINE_DIR2_SPACE_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_leafn_add</span><span class="p">);</span>
<span class="n">DEFINE_DIR2_SPACE_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_leafn_remove</span><span class="p">);</span>
<span class="n">DEFINE_DIR2_SPACE_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_grow_inode</span><span class="p">);</span>
<span class="n">DEFINE_DIR2_SPACE_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_shrink_inode</span><span class="p">);</span>

<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">xfs_dir2_leafn_moveents</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_da_args</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="kt">int</span> <span class="n">src_idx</span><span class="p">,</span> <span class="kt">int</span> <span class="n">dst_idx</span><span class="p">,</span> <span class="kt">int</span> <span class="n">count</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">src_idx</span><span class="p">,</span> <span class="n">dst_idx</span><span class="p">,</span> <span class="n">count</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_ino_t</span><span class="p">,</span> <span class="n">ino</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">op_flags</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">src_idx</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">dst_idx</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">VFS_I</span><span class="p">(</span><span class="n">args</span><span class="o">-&gt;</span><span class="n">dp</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">i_sb</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">dp</span><span class="o">-&gt;</span><span class="n">i_ino</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">op_flags</span> <span class="o">=</span> <span class="n">args</span><span class="o">-&gt;</span><span class="n">op_flags</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">src_idx</span> <span class="o">=</span> <span class="n">src_idx</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dst_idx</span> <span class="o">=</span> <span class="n">dst_idx</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">count</span> <span class="o">=</span> <span class="n">count</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d ino 0x%llx op_flags %s &quot;</span>
		  <span class="s">&quot;src_idx %d dst_idx %d count %d&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span><span class="p">,</span>
		  <span class="n">__print_flags</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">op_flags</span><span class="p">,</span> <span class="s">&quot;|&quot;</span><span class="p">,</span> <span class="n">XFS_DA_OP_FLAGS</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">src_idx</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dst_idx</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">count</span><span class="p">)</span>
<span class="p">);</span>

<span class="cp">#define XFS_SWAPEXT_INODES \</span>
<span class="cp">	{ 0,	&quot;target&quot; }, \</span>
<span class="cp">	{ 1,	&quot;temp&quot; }</span>

<span class="cp">#define XFS_INODE_FORMAT_STR \</span>
<span class="cp">	{ 0,	&quot;invalid&quot; }, \</span>
<span class="cp">	{ 1,	&quot;local&quot; }, \</span>
<span class="cp">	{ 2,	&quot;extent&quot; }, \</span>
<span class="cp">	{ 3,	&quot;btree&quot; }</span>

<span class="n">DECLARE_EVENT_CLASS</span><span class="p">(</span><span class="n">xfs_swap_extent_class</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_inode</span> <span class="o">*</span><span class="n">ip</span><span class="p">,</span> <span class="kt">int</span> <span class="n">which</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">which</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">which</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_ino_t</span><span class="p">,</span> <span class="n">ino</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">format</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">nex</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">broot_size</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">fork_off</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">VFS_I</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">i_sb</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">which</span> <span class="o">=</span> <span class="n">which</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span> <span class="o">=</span> <span class="n">ip</span><span class="o">-&gt;</span><span class="n">i_ino</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">format</span> <span class="o">=</span> <span class="n">ip</span><span class="o">-&gt;</span><span class="n">i_d</span><span class="p">.</span><span class="n">di_format</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">nex</span> <span class="o">=</span> <span class="n">ip</span><span class="o">-&gt;</span><span class="n">i_d</span><span class="p">.</span><span class="n">di_nextents</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">broot_size</span> <span class="o">=</span> <span class="n">ip</span><span class="o">-&gt;</span><span class="n">i_df</span><span class="p">.</span><span class="n">if_broot_bytes</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">fork_off</span> <span class="o">=</span> <span class="n">XFS_IFORK_BOFF</span><span class="p">(</span><span class="n">ip</span><span class="p">);</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d ino 0x%llx (%s), %s format, num_extents %d, &quot;</span>
		  <span class="s">&quot;broot size %d, fork offset %d&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span><span class="p">,</span>
		  <span class="n">__print_symbolic</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">which</span><span class="p">,</span> <span class="n">XFS_SWAPEXT_INODES</span><span class="p">),</span>
		  <span class="n">__print_symbolic</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">format</span><span class="p">,</span> <span class="n">XFS_INODE_FORMAT_STR</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">nex</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">broot_size</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">fork_off</span><span class="p">)</span>
<span class="p">)</span>

<span class="cp">#define DEFINE_SWAPEXT_EVENT(name) \</span>
<span class="cp">DEFINE_EVENT(xfs_swap_extent_class, name, \</span>
<span class="cp">	TP_PROTO(struct xfs_inode *ip, int which), \</span>
<span class="cp">	TP_ARGS(ip, which))</span>

<span class="n">DEFINE_SWAPEXT_EVENT</span><span class="p">(</span><span class="n">xfs_swap_extent_before</span><span class="p">);</span>
<span class="n">DEFINE_SWAPEXT_EVENT</span><span class="p">(</span><span class="n">xfs_swap_extent_after</span><span class="p">);</span>

<span class="n">DECLARE_EVENT_CLASS</span><span class="p">(</span><span class="n">xfs_log_recover_item_class</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xlog</span> <span class="o">*</span><span class="n">log</span><span class="p">,</span> <span class="k">struct</span> <span class="n">xlog_recover</span> <span class="o">*</span><span class="n">trans</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">xlog_recover_item</span> <span class="o">*</span><span class="n">item</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pass</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">log</span><span class="p">,</span> <span class="n">trans</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">pass</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xlog_tid_t</span><span class="p">,</span> <span class="n">tid</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">type</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">pass</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">total</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">log</span><span class="o">-&gt;</span><span class="n">l_mp</span><span class="o">-&gt;</span><span class="n">m_super</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">item</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span><span class="n">item</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">tid</span> <span class="o">=</span> <span class="n">trans</span><span class="o">-&gt;</span><span class="n">r_log_tid</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">type</span> <span class="o">=</span> <span class="n">ITEM_TYPE</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">pass</span> <span class="o">=</span> <span class="n">pass</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">count</span> <span class="o">=</span> <span class="n">item</span><span class="o">-&gt;</span><span class="n">ri_cnt</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">total</span> <span class="o">=</span> <span class="n">item</span><span class="o">-&gt;</span><span class="n">ri_total</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d trans 0x%x, pass %d, item 0x%p, item type %s &quot;</span>
		  <span class="s">&quot;item region count/total %d/%d&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">tid</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">pass</span><span class="p">,</span>
		  <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">item</span><span class="p">,</span>
		  <span class="n">__print_symbolic</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">type</span><span class="p">,</span> <span class="n">XFS_LI_TYPE_DESC</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">count</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">total</span><span class="p">)</span>
<span class="p">)</span>

<span class="cp">#define DEFINE_LOG_RECOVER_ITEM(name) \</span>
<span class="cp">DEFINE_EVENT(xfs_log_recover_item_class, name, \</span>
<span class="cp">	TP_PROTO(struct xlog *log, struct xlog_recover *trans, \</span>
<span class="cp">		struct xlog_recover_item *item, int pass), \</span>
<span class="cp">	TP_ARGS(log, trans, item, pass))</span>

<span class="n">DEFINE_LOG_RECOVER_ITEM</span><span class="p">(</span><span class="n">xfs_log_recover_item_add</span><span class="p">);</span>
<span class="n">DEFINE_LOG_RECOVER_ITEM</span><span class="p">(</span><span class="n">xfs_log_recover_item_add_cont</span><span class="p">);</span>
<span class="n">DEFINE_LOG_RECOVER_ITEM</span><span class="p">(</span><span class="n">xfs_log_recover_item_reorder_head</span><span class="p">);</span>
<span class="n">DEFINE_LOG_RECOVER_ITEM</span><span class="p">(</span><span class="n">xfs_log_recover_item_reorder_tail</span><span class="p">);</span>
<span class="n">DEFINE_LOG_RECOVER_ITEM</span><span class="p">(</span><span class="n">xfs_log_recover_item_recover</span><span class="p">);</span>

<span class="n">DECLARE_EVENT_CLASS</span><span class="p">(</span><span class="n">xfs_log_recover_buf_item_class</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xlog</span> <span class="o">*</span><span class="n">log</span><span class="p">,</span> <span class="k">struct</span> <span class="n">xfs_buf_log_format</span> <span class="o">*</span><span class="n">buf_f</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">log</span><span class="p">,</span> <span class="n">buf_f</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">__int64_t</span><span class="p">,</span> <span class="n">blkno</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">short</span><span class="p">,</span> <span class="n">len</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">short</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">short</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span> <span class="n">map_size</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">log</span><span class="o">-&gt;</span><span class="n">l_mp</span><span class="o">-&gt;</span><span class="n">m_super</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">blkno</span> <span class="o">=</span> <span class="n">buf_f</span><span class="o">-&gt;</span><span class="n">blf_blkno</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">len</span> <span class="o">=</span> <span class="n">buf_f</span><span class="o">-&gt;</span><span class="n">blf_len</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">=</span> <span class="n">buf_f</span><span class="o">-&gt;</span><span class="n">blf_flags</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">size</span> <span class="o">=</span> <span class="n">buf_f</span><span class="o">-&gt;</span><span class="n">blf_size</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">map_size</span> <span class="o">=</span> <span class="n">buf_f</span><span class="o">-&gt;</span><span class="n">blf_map_size</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d blkno 0x%llx, len %u, flags 0x%x, size %d, &quot;</span>
			<span class="s">&quot;map_size %d&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">blkno</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">len</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">map_size</span><span class="p">)</span>
<span class="p">)</span>

<span class="cp">#define DEFINE_LOG_RECOVER_BUF_ITEM(name) \</span>
<span class="cp">DEFINE_EVENT(xfs_log_recover_buf_item_class, name, \</span>
<span class="cp">	TP_PROTO(struct xlog *log, struct xfs_buf_log_format *buf_f), \</span>
<span class="cp">	TP_ARGS(log, buf_f))</span>

<span class="n">DEFINE_LOG_RECOVER_BUF_ITEM</span><span class="p">(</span><span class="n">xfs_log_recover_buf_not_cancel</span><span class="p">);</span>
<span class="n">DEFINE_LOG_RECOVER_BUF_ITEM</span><span class="p">(</span><span class="n">xfs_log_recover_buf_cancel</span><span class="p">);</span>
<span class="n">DEFINE_LOG_RECOVER_BUF_ITEM</span><span class="p">(</span><span class="n">xfs_log_recover_buf_cancel_add</span><span class="p">);</span>
<span class="n">DEFINE_LOG_RECOVER_BUF_ITEM</span><span class="p">(</span><span class="n">xfs_log_recover_buf_cancel_ref_inc</span><span class="p">);</span>
<span class="n">DEFINE_LOG_RECOVER_BUF_ITEM</span><span class="p">(</span><span class="n">xfs_log_recover_buf_recover</span><span class="p">);</span>
<span class="n">DEFINE_LOG_RECOVER_BUF_ITEM</span><span class="p">(</span><span class="n">xfs_log_recover_buf_inode_buf</span><span class="p">);</span>
<span class="n">DEFINE_LOG_RECOVER_BUF_ITEM</span><span class="p">(</span><span class="n">xfs_log_recover_buf_reg_buf</span><span class="p">);</span>
<span class="n">DEFINE_LOG_RECOVER_BUF_ITEM</span><span class="p">(</span><span class="n">xfs_log_recover_buf_dquot_buf</span><span class="p">);</span>

<span class="n">DECLARE_EVENT_CLASS</span><span class="p">(</span><span class="n">xfs_log_recover_ino_item_class</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xlog</span> <span class="o">*</span><span class="n">log</span><span class="p">,</span> <span class="k">struct</span> <span class="n">xfs_inode_log_format</span> <span class="o">*</span><span class="n">in_f</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">log</span><span class="p">,</span> <span class="n">in_f</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_ino_t</span><span class="p">,</span> <span class="n">ino</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">short</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">short</span><span class="p">,</span> <span class="n">asize</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">short</span><span class="p">,</span> <span class="n">dsize</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">__int64_t</span><span class="p">,</span> <span class="n">blkno</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">len</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">boffset</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">log</span><span class="o">-&gt;</span><span class="n">l_mp</span><span class="o">-&gt;</span><span class="n">m_super</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span> <span class="o">=</span> <span class="n">in_f</span><span class="o">-&gt;</span><span class="n">ilf_ino</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">size</span> <span class="o">=</span> <span class="n">in_f</span><span class="o">-&gt;</span><span class="n">ilf_size</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">fields</span> <span class="o">=</span> <span class="n">in_f</span><span class="o">-&gt;</span><span class="n">ilf_fields</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">asize</span> <span class="o">=</span> <span class="n">in_f</span><span class="o">-&gt;</span><span class="n">ilf_asize</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dsize</span> <span class="o">=</span> <span class="n">in_f</span><span class="o">-&gt;</span><span class="n">ilf_dsize</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">blkno</span> <span class="o">=</span> <span class="n">in_f</span><span class="o">-&gt;</span><span class="n">ilf_blkno</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">len</span> <span class="o">=</span> <span class="n">in_f</span><span class="o">-&gt;</span><span class="n">ilf_len</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">boffset</span> <span class="o">=</span> <span class="n">in_f</span><span class="o">-&gt;</span><span class="n">ilf_boffset</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d ino 0x%llx, size %u, fields 0x%x, asize %d, &quot;</span>
			<span class="s">&quot;dsize %d, blkno 0x%llx, len %d, boffset %d&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ino</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">fields</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">asize</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dsize</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">blkno</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">len</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">boffset</span><span class="p">)</span>
<span class="p">)</span>
<span class="cp">#define DEFINE_LOG_RECOVER_INO_ITEM(name) \</span>
<span class="cp">DEFINE_EVENT(xfs_log_recover_ino_item_class, name, \</span>
<span class="cp">	TP_PROTO(struct xlog *log, struct xfs_inode_log_format *in_f), \</span>
<span class="cp">	TP_ARGS(log, in_f))</span>

<span class="n">DEFINE_LOG_RECOVER_INO_ITEM</span><span class="p">(</span><span class="n">xfs_log_recover_inode_recover</span><span class="p">);</span>
<span class="n">DEFINE_LOG_RECOVER_INO_ITEM</span><span class="p">(</span><span class="n">xfs_log_recover_inode_cancel</span><span class="p">);</span>
<span class="n">DEFINE_LOG_RECOVER_INO_ITEM</span><span class="p">(</span><span class="n">xfs_log_recover_inode_skip</span><span class="p">);</span>

<span class="n">DECLARE_EVENT_CLASS</span><span class="p">(</span><span class="n">xfs_discard_class</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">xfs_mount</span> <span class="o">*</span><span class="n">mp</span><span class="p">,</span> <span class="n">xfs_agnumber_t</span> <span class="n">agno</span><span class="p">,</span>
		 <span class="n">xfs_agblock_t</span> <span class="n">agbno</span><span class="p">,</span> <span class="n">xfs_extlen_t</span> <span class="n">len</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">mp</span><span class="p">,</span> <span class="n">agno</span><span class="p">,</span> <span class="n">agbno</span><span class="p">,</span> <span class="n">len</span><span class="p">),</span>
	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">dev_t</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_agnumber_t</span><span class="p">,</span> <span class="n">agno</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_agblock_t</span><span class="p">,</span> <span class="n">agbno</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">xfs_extlen_t</span><span class="p">,</span> <span class="n">len</span><span class="p">)</span>
	<span class="p">),</span>
	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">mp</span><span class="o">-&gt;</span><span class="n">m_super</span><span class="o">-&gt;</span><span class="n">s_dev</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">agno</span> <span class="o">=</span> <span class="n">agno</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">agbno</span> <span class="o">=</span> <span class="n">agbno</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">len</span> <span class="o">=</span> <span class="n">len</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dev %d:%d agno %u agbno %u len %u</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
		  <span class="n">MAJOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span> <span class="n">MINOR</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">agno</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">agbno</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">len</span><span class="p">)</span>
<span class="p">)</span>

<span class="cp">#define DEFINE_DISCARD_EVENT(name) \</span>
<span class="cp">DEFINE_EVENT(xfs_discard_class, name, \</span>
<span class="cp">	TP_PROTO(struct xfs_mount *mp, xfs_agnumber_t agno, \</span>
<span class="cp">		 xfs_agblock_t agbno, xfs_extlen_t len), \</span>
<span class="cp">	TP_ARGS(mp, agno, agbno, len))</span>
<span class="n">DEFINE_DISCARD_EVENT</span><span class="p">(</span><span class="n">xfs_discard_extent</span><span class="p">);</span>
<span class="n">DEFINE_DISCARD_EVENT</span><span class="p">(</span><span class="n">xfs_discard_toosmall</span><span class="p">);</span>
<span class="n">DEFINE_DISCARD_EVENT</span><span class="p">(</span><span class="n">xfs_discard_exclude</span><span class="p">);</span>
<span class="n">DEFINE_DISCARD_EVENT</span><span class="p">(</span><span class="n">xfs_discard_busy</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* _TRACE_XFS_H */</span><span class="cp"></span>

<span class="cp">#undef TRACE_INCLUDE_PATH</span>
<span class="cp">#define TRACE_INCLUDE_PATH .</span>
<span class="cp">#define TRACE_INCLUDE_FILE xfs_trace</span>
<span class="cp">#include &lt;trace/define_trace.h&gt;</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
