<!DOCTYPE html>
<html><head><title>joekychen/linux » fs › squashfs › squashfs_fs.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>squashfs_fs.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef SQUASHFS_FS</span>
<span class="cp">#define SQUASHFS_FS</span>
<span class="cm">/*</span>
<span class="cm"> * Squashfs</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (c) 2002, 2003, 2004, 2005, 2006, 2007, 2008</span>
<span class="cm"> * Phillip Lougher &lt;phillip@squashfs.org.uk&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or</span>
<span class="cm"> * modify it under the terms of the GNU General Public License</span>
<span class="cm"> * as published by the Free Software Foundation; either version 2,</span>
<span class="cm"> * or (at your option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful,</span>
<span class="cm"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm"> * GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License</span>
<span class="cm"> * along with this program; if not, write to the Free Software</span>
<span class="cm"> * Foundation, 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</span>
<span class="cm"> *</span>
<span class="cm"> * squashfs_fs.h</span>
<span class="cm"> */</span>

<span class="cp">#define SQUASHFS_CACHED_FRAGMENTS	CONFIG_SQUASHFS_FRAGMENT_CACHE_SIZE</span>
<span class="cp">#define SQUASHFS_MAJOR			4</span>
<span class="cp">#define SQUASHFS_MINOR			0</span>
<span class="cp">#define SQUASHFS_START			0</span>

<span class="cm">/* size of metadata (inode and directory) blocks */</span>
<span class="cp">#define SQUASHFS_METADATA_SIZE		8192</span>

<span class="cm">/* default size of block device I/O */</span>
<span class="cp">#ifdef CONFIG_SQUASHFS_4K_DEVBLK_SIZE</span>
<span class="cp">#define SQUASHFS_DEVBLK_SIZE 4096</span>
<span class="cp">#else</span>
<span class="cp">#define SQUASHFS_DEVBLK_SIZE 1024</span>
<span class="cp">#endif</span>

<span class="cp">#define SQUASHFS_FILE_MAX_SIZE		1048576</span>
<span class="cp">#define SQUASHFS_FILE_MAX_LOG		20</span>

<span class="cm">/* Max length of filename (not 255) */</span>
<span class="cp">#define SQUASHFS_NAME_LEN		256</span>

<span class="cm">/* Max value for directory header count*/</span>
<span class="cp">#define SQUASHFS_DIR_COUNT		256</span>

<span class="cp">#define SQUASHFS_INVALID_FRAG		(0xffffffffU)</span>
<span class="cp">#define SQUASHFS_INVALID_XATTR		(0xffffffffU)</span>
<span class="cp">#define SQUASHFS_INVALID_BLK		(-1LL)</span>

<span class="cm">/* Filesystem flags */</span>
<span class="cp">#define SQUASHFS_NOI			0</span>
<span class="cp">#define SQUASHFS_NOD			1</span>
<span class="cp">#define SQUASHFS_NOF			3</span>
<span class="cp">#define SQUASHFS_NO_FRAG		4</span>
<span class="cp">#define SQUASHFS_ALWAYS_FRAG		5</span>
<span class="cp">#define SQUASHFS_DUPLICATE		6</span>
<span class="cp">#define SQUASHFS_EXPORT			7</span>
<span class="cp">#define SQUASHFS_COMP_OPT		10</span>

<span class="cp">#define SQUASHFS_BIT(flag, bit)		((flag &gt;&gt; bit) &amp; 1)</span>

<span class="cp">#define SQUASHFS_UNCOMPRESSED_INODES(flags)	SQUASHFS_BIT(flags, \</span>
<span class="cp">						SQUASHFS_NOI)</span>

<span class="cp">#define SQUASHFS_UNCOMPRESSED_DATA(flags)	SQUASHFS_BIT(flags, \</span>
<span class="cp">						SQUASHFS_NOD)</span>

<span class="cp">#define SQUASHFS_UNCOMPRESSED_FRAGMENTS(flags)	SQUASHFS_BIT(flags, \</span>
<span class="cp">						SQUASHFS_NOF)</span>

<span class="cp">#define SQUASHFS_NO_FRAGMENTS(flags)		SQUASHFS_BIT(flags, \</span>
<span class="cp">						SQUASHFS_NO_FRAG)</span>

<span class="cp">#define SQUASHFS_ALWAYS_FRAGMENTS(flags)	SQUASHFS_BIT(flags, \</span>
<span class="cp">						SQUASHFS_ALWAYS_FRAG)</span>

<span class="cp">#define SQUASHFS_DUPLICATES(flags)		SQUASHFS_BIT(flags, \</span>
<span class="cp">						SQUASHFS_DUPLICATE)</span>

<span class="cp">#define SQUASHFS_EXPORTABLE(flags)		SQUASHFS_BIT(flags, \</span>
<span class="cp">						SQUASHFS_EXPORT)</span>

<span class="cp">#define SQUASHFS_COMP_OPTS(flags)		SQUASHFS_BIT(flags, \</span>
<span class="cp">						SQUASHFS_COMP_OPT)</span>

<span class="cm">/* Max number of types and file types */</span>
<span class="cp">#define SQUASHFS_DIR_TYPE		1</span>
<span class="cp">#define SQUASHFS_REG_TYPE		2</span>
<span class="cp">#define SQUASHFS_SYMLINK_TYPE		3</span>
<span class="cp">#define SQUASHFS_BLKDEV_TYPE		4</span>
<span class="cp">#define SQUASHFS_CHRDEV_TYPE		5</span>
<span class="cp">#define SQUASHFS_FIFO_TYPE		6</span>
<span class="cp">#define SQUASHFS_SOCKET_TYPE		7</span>
<span class="cp">#define SQUASHFS_LDIR_TYPE		8</span>
<span class="cp">#define SQUASHFS_LREG_TYPE		9</span>
<span class="cp">#define SQUASHFS_LSYMLINK_TYPE		10</span>
<span class="cp">#define SQUASHFS_LBLKDEV_TYPE		11</span>
<span class="cp">#define SQUASHFS_LCHRDEV_TYPE		12</span>
<span class="cp">#define SQUASHFS_LFIFO_TYPE		13</span>
<span class="cp">#define SQUASHFS_LSOCKET_TYPE		14</span>

<span class="cm">/* Xattr types */</span>
<span class="cp">#define SQUASHFS_XATTR_USER             0</span>
<span class="cp">#define SQUASHFS_XATTR_TRUSTED          1</span>
<span class="cp">#define SQUASHFS_XATTR_SECURITY         2</span>
<span class="cp">#define SQUASHFS_XATTR_VALUE_OOL        256</span>
<span class="cp">#define SQUASHFS_XATTR_PREFIX_MASK      0xff</span>

<span class="cm">/* Flag whether block is compressed or uncompressed, bit is set if block is</span>
<span class="cm"> * uncompressed */</span>
<span class="cp">#define SQUASHFS_COMPRESSED_BIT		(1 &lt;&lt; 15)</span>

<span class="cp">#define SQUASHFS_COMPRESSED_SIZE(B)	(((B) &amp; ~SQUASHFS_COMPRESSED_BIT) ? \</span>
<span class="cp">		(B) &amp; ~SQUASHFS_COMPRESSED_BIT :  SQUASHFS_COMPRESSED_BIT)</span>

<span class="cp">#define SQUASHFS_COMPRESSED(B)		(!((B) &amp; SQUASHFS_COMPRESSED_BIT))</span>

<span class="cp">#define SQUASHFS_COMPRESSED_BIT_BLOCK	(1 &lt;&lt; 24)</span>

<span class="cp">#define SQUASHFS_COMPRESSED_SIZE_BLOCK(B)	((B) &amp; \</span>
<span class="cp">						~SQUASHFS_COMPRESSED_BIT_BLOCK)</span>

<span class="cp">#define SQUASHFS_COMPRESSED_BLOCK(B)	(!((B) &amp; SQUASHFS_COMPRESSED_BIT_BLOCK))</span>

<span class="cm">/*</span>
<span class="cm"> * Inode number ops.  Inodes consist of a compressed block number, and an</span>
<span class="cm"> * uncompressed offset within that block</span>
<span class="cm"> */</span>
<span class="cp">#define SQUASHFS_INODE_BLK(A)		((unsigned int) ((A) &gt;&gt; 16))</span>

<span class="cp">#define SQUASHFS_INODE_OFFSET(A)	((unsigned int) ((A) &amp; 0xffff))</span>

<span class="cp">#define SQUASHFS_MKINODE(A, B)		((long long)(((long long) (A)\</span>
<span class="cp">					&lt;&lt; 16) + (B)))</span>

<span class="cm">/* fragment and fragment table defines */</span>
<span class="cp">#define SQUASHFS_FRAGMENT_BYTES(A)	\</span>
<span class="cp">				((A) * sizeof(struct squashfs_fragment_entry))</span>

<span class="cp">#define SQUASHFS_FRAGMENT_INDEX(A)	(SQUASHFS_FRAGMENT_BYTES(A) / \</span>
<span class="cp">					SQUASHFS_METADATA_SIZE)</span>

<span class="cp">#define SQUASHFS_FRAGMENT_INDEX_OFFSET(A)	(SQUASHFS_FRAGMENT_BYTES(A) % \</span>
<span class="cp">						SQUASHFS_METADATA_SIZE)</span>

<span class="cp">#define SQUASHFS_FRAGMENT_INDEXES(A)	((SQUASHFS_FRAGMENT_BYTES(A) + \</span>
<span class="cp">					SQUASHFS_METADATA_SIZE - 1) / \</span>
<span class="cp">					SQUASHFS_METADATA_SIZE)</span>

<span class="cp">#define SQUASHFS_FRAGMENT_INDEX_BYTES(A)	(SQUASHFS_FRAGMENT_INDEXES(A) *\</span>
<span class="cp">						sizeof(u64))</span>

<span class="cm">/* inode lookup table defines */</span>
<span class="cp">#define SQUASHFS_LOOKUP_BYTES(A)	((A) * sizeof(u64))</span>

<span class="cp">#define SQUASHFS_LOOKUP_BLOCK(A)	(SQUASHFS_LOOKUP_BYTES(A) / \</span>
<span class="cp">					SQUASHFS_METADATA_SIZE)</span>

<span class="cp">#define SQUASHFS_LOOKUP_BLOCK_OFFSET(A)	(SQUASHFS_LOOKUP_BYTES(A) % \</span>
<span class="cp">					SQUASHFS_METADATA_SIZE)</span>

<span class="cp">#define SQUASHFS_LOOKUP_BLOCKS(A)	((SQUASHFS_LOOKUP_BYTES(A) + \</span>
<span class="cp">					SQUASHFS_METADATA_SIZE - 1) / \</span>
<span class="cp">					SQUASHFS_METADATA_SIZE)</span>

<span class="cp">#define SQUASHFS_LOOKUP_BLOCK_BYTES(A)	(SQUASHFS_LOOKUP_BLOCKS(A) *\</span>
<span class="cp">					sizeof(u64))</span>

<span class="cm">/* uid/gid lookup table defines */</span>
<span class="cp">#define SQUASHFS_ID_BYTES(A)		((A) * sizeof(unsigned int))</span>

<span class="cp">#define SQUASHFS_ID_BLOCK(A)		(SQUASHFS_ID_BYTES(A) / \</span>
<span class="cp">					SQUASHFS_METADATA_SIZE)</span>

<span class="cp">#define SQUASHFS_ID_BLOCK_OFFSET(A)	(SQUASHFS_ID_BYTES(A) % \</span>
<span class="cp">					SQUASHFS_METADATA_SIZE)</span>

<span class="cp">#define SQUASHFS_ID_BLOCKS(A)		((SQUASHFS_ID_BYTES(A) + \</span>
<span class="cp">					SQUASHFS_METADATA_SIZE - 1) / \</span>
<span class="cp">					SQUASHFS_METADATA_SIZE)</span>

<span class="cp">#define SQUASHFS_ID_BLOCK_BYTES(A)	(SQUASHFS_ID_BLOCKS(A) *\</span>
<span class="cp">					sizeof(u64))</span>
<span class="cm">/* xattr id lookup table defines */</span>
<span class="cp">#define SQUASHFS_XATTR_BYTES(A)		((A) * sizeof(struct squashfs_xattr_id))</span>

<span class="cp">#define SQUASHFS_XATTR_BLOCK(A)		(SQUASHFS_XATTR_BYTES(A) / \</span>
<span class="cp">					SQUASHFS_METADATA_SIZE)</span>

<span class="cp">#define SQUASHFS_XATTR_BLOCK_OFFSET(A)	(SQUASHFS_XATTR_BYTES(A) % \</span>
<span class="cp">					SQUASHFS_METADATA_SIZE)</span>

<span class="cp">#define SQUASHFS_XATTR_BLOCKS(A)	((SQUASHFS_XATTR_BYTES(A) + \</span>
<span class="cp">					SQUASHFS_METADATA_SIZE - 1) / \</span>
<span class="cp">					SQUASHFS_METADATA_SIZE)</span>

<span class="cp">#define SQUASHFS_XATTR_BLOCK_BYTES(A)	(SQUASHFS_XATTR_BLOCKS(A) *\</span>
<span class="cp">					sizeof(u64))</span>
<span class="cp">#define SQUASHFS_XATTR_BLK(A)		((unsigned int) ((A) &gt;&gt; 16))</span>

<span class="cp">#define SQUASHFS_XATTR_OFFSET(A)	((unsigned int) ((A) &amp; 0xffff))</span>

<span class="cm">/* cached data constants for filesystem */</span>
<span class="cp">#define SQUASHFS_CACHED_BLKS		8</span>

<span class="cm">/* meta index cache */</span>
<span class="cp">#define SQUASHFS_META_INDEXES	(SQUASHFS_METADATA_SIZE / sizeof(unsigned int))</span>
<span class="cp">#define SQUASHFS_META_ENTRIES	127</span>
<span class="cp">#define SQUASHFS_META_SLOTS	8</span>

<span class="k">struct</span> <span class="n">meta_entry</span> <span class="p">{</span>
	<span class="n">u64</span>			<span class="n">data_block</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>		<span class="n">index_block</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span>		<span class="n">offset</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span>		<span class="n">pad</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">meta_index</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>		<span class="n">inode_number</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>		<span class="n">offset</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span>		<span class="n">entries</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span>		<span class="n">skip</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span>		<span class="n">locked</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span>		<span class="n">pad</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">meta_entry</span>	<span class="n">meta_entry</span><span class="p">[</span><span class="n">SQUASHFS_META_ENTRIES</span><span class="p">];</span>
<span class="p">};</span>


<span class="cm">/*</span>
<span class="cm"> * definitions for structures on disk</span>
<span class="cm"> */</span>
<span class="cp">#define ZLIB_COMPRESSION	1</span>
<span class="cp">#define LZMA_COMPRESSION	2</span>
<span class="cp">#define LZO_COMPRESSION		3</span>
<span class="cp">#define XZ_COMPRESSION		4</span>

<span class="k">struct</span> <span class="n">squashfs_super_block</span> <span class="p">{</span>
	<span class="n">__le32</span>			<span class="n">s_magic</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">inodes</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">mkfs_time</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">block_size</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">fragments</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">compression</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">block_log</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">flags</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">no_ids</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">s_major</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">s_minor</span><span class="p">;</span>
	<span class="n">__le64</span>			<span class="n">root_inode</span><span class="p">;</span>
	<span class="n">__le64</span>			<span class="n">bytes_used</span><span class="p">;</span>
	<span class="n">__le64</span>			<span class="n">id_table_start</span><span class="p">;</span>
	<span class="n">__le64</span>			<span class="n">xattr_id_table_start</span><span class="p">;</span>
	<span class="n">__le64</span>			<span class="n">inode_table_start</span><span class="p">;</span>
	<span class="n">__le64</span>			<span class="n">directory_table_start</span><span class="p">;</span>
	<span class="n">__le64</span>			<span class="n">fragment_table_start</span><span class="p">;</span>
	<span class="n">__le64</span>			<span class="n">lookup_table_start</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">squashfs_dir_index</span> <span class="p">{</span>
	<span class="n">__le32</span>			<span class="n">index</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">start_block</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">size</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>		<span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">squashfs_base_inode</span> <span class="p">{</span>
	<span class="n">__le16</span>			<span class="n">inode_type</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">mode</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">uid</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">guid</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">mtime</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">inode_number</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">squashfs_ipc_inode</span> <span class="p">{</span>
	<span class="n">__le16</span>			<span class="n">inode_type</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">mode</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">uid</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">guid</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">mtime</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">inode_number</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">nlink</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">squashfs_lipc_inode</span> <span class="p">{</span>
	<span class="n">__le16</span>			<span class="n">inode_type</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">mode</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">uid</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">guid</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">mtime</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">inode_number</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">nlink</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">xattr</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">squashfs_dev_inode</span> <span class="p">{</span>
	<span class="n">__le16</span>			<span class="n">inode_type</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">mode</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">uid</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">guid</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">mtime</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">inode_number</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">nlink</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">rdev</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">squashfs_ldev_inode</span> <span class="p">{</span>
	<span class="n">__le16</span>			<span class="n">inode_type</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">mode</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">uid</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">guid</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">mtime</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">inode_number</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">nlink</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">rdev</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">xattr</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">squashfs_symlink_inode</span> <span class="p">{</span>
	<span class="n">__le16</span>			<span class="n">inode_type</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">mode</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">uid</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">guid</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">mtime</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">inode_number</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">nlink</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">symlink_size</span><span class="p">;</span>
	<span class="kt">char</span>			<span class="n">symlink</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">squashfs_reg_inode</span> <span class="p">{</span>
	<span class="n">__le16</span>			<span class="n">inode_type</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">mode</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">uid</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">guid</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">mtime</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">inode_number</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">start_block</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">fragment</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">offset</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">file_size</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">block_list</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">squashfs_lreg_inode</span> <span class="p">{</span>
	<span class="n">__le16</span>			<span class="n">inode_type</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">mode</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">uid</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">guid</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">mtime</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">inode_number</span><span class="p">;</span>
	<span class="n">__le64</span>			<span class="n">start_block</span><span class="p">;</span>
	<span class="n">__le64</span>			<span class="n">file_size</span><span class="p">;</span>
	<span class="n">__le64</span>			<span class="n">sparse</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">nlink</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">fragment</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">offset</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">xattr</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">block_list</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">squashfs_dir_inode</span> <span class="p">{</span>
	<span class="n">__le16</span>			<span class="n">inode_type</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">mode</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">uid</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">guid</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">mtime</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">inode_number</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">start_block</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">nlink</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">file_size</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">offset</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">parent_inode</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">squashfs_ldir_inode</span> <span class="p">{</span>
	<span class="n">__le16</span>			<span class="n">inode_type</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">mode</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">uid</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">guid</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">mtime</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">inode_number</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">nlink</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">file_size</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">start_block</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">parent_inode</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">i_count</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">offset</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">xattr</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">squashfs_dir_index</span>	<span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">union</span> <span class="n">squashfs_inode</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">squashfs_base_inode</span>		<span class="n">base</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">squashfs_dev_inode</span>		<span class="n">dev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">squashfs_ldev_inode</span>		<span class="n">ldev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">squashfs_symlink_inode</span>		<span class="n">symlink</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">squashfs_reg_inode</span>		<span class="n">reg</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">squashfs_lreg_inode</span>		<span class="n">lreg</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">squashfs_dir_inode</span>		<span class="n">dir</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">squashfs_ldir_inode</span>		<span class="n">ldir</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">squashfs_ipc_inode</span>		<span class="n">ipc</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">squashfs_lipc_inode</span>		<span class="n">lipc</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">squashfs_dir_entry</span> <span class="p">{</span>
	<span class="n">__le16</span>			<span class="n">offset</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">inode_number</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">type</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">size</span><span class="p">;</span>
	<span class="kt">char</span>			<span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">squashfs_dir_header</span> <span class="p">{</span>
	<span class="n">__le32</span>			<span class="n">count</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">start_block</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">inode_number</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">squashfs_fragment_entry</span> <span class="p">{</span>
	<span class="n">__le64</span>			<span class="n">start_block</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">size</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>		<span class="n">unused</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">squashfs_xattr_entry</span> <span class="p">{</span>
	<span class="n">__le16</span>			<span class="n">type</span><span class="p">;</span>
	<span class="n">__le16</span>			<span class="n">size</span><span class="p">;</span>
	<span class="kt">char</span>			<span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">squashfs_xattr_val</span> <span class="p">{</span>
	<span class="n">__le32</span>			<span class="n">vsize</span><span class="p">;</span>
	<span class="kt">char</span>			<span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">squashfs_xattr_id</span> <span class="p">{</span>
	<span class="n">__le64</span>			<span class="n">xattr</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">count</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">size</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">squashfs_xattr_id_table</span> <span class="p">{</span>
	<span class="n">__le64</span>			<span class="n">xattr_table_start</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">xattr_ids</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">unused</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
