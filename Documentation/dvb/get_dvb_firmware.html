<!DOCTYPE html>
<html><head><title>joekychen/linux » Documentation › dvb › get_dvb_firmware

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>get_dvb_firmware</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div><pre><code>DVB firmware extractor

(c) 2004 Andrew de Quincey

This program is free software; you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation; either version 2 of the License, or
  (at your option) any later version.

This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the

GNU General Public License for more details.

You should have received a copy of the GNU General Public License
  along with this program; if not, write to the Free Software
  Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
</code></pre></td><td class="code"><div class="highlight"><pre><span class="k">use</span> <span class="nn">File::</span><span class="n">Temp</span> <span class="sx">qw/ tempdir /</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">IO::</span><span class="n">Handle</span><span class="p">;</span>

<span class="nv">@components</span> <span class="o">=</span> <span class="p">(</span> <span class="s">&quot;sp8870&quot;</span><span class="p">,</span> <span class="s">&quot;sp887x&quot;</span><span class="p">,</span> <span class="s">&quot;tda10045&quot;</span><span class="p">,</span> <span class="s">&quot;tda10046&quot;</span><span class="p">,</span>
		<span class="s">&quot;tda10046lifeview&quot;</span><span class="p">,</span> <span class="s">&quot;av7110&quot;</span><span class="p">,</span> <span class="s">&quot;dec2000t&quot;</span><span class="p">,</span> <span class="s">&quot;dec2540t&quot;</span><span class="p">,</span>
		<span class="s">&quot;dec3000s&quot;</span><span class="p">,</span> <span class="s">&quot;vp7041&quot;</span><span class="p">,</span> <span class="s">&quot;dibusb&quot;</span><span class="p">,</span> <span class="s">&quot;nxt2002&quot;</span><span class="p">,</span> <span class="s">&quot;nxt2004&quot;</span><span class="p">,</span>
		<span class="s">&quot;or51211&quot;</span><span class="p">,</span> <span class="s">&quot;or51132_qam&quot;</span><span class="p">,</span> <span class="s">&quot;or51132_vsb&quot;</span><span class="p">,</span> <span class="s">&quot;bluebird&quot;</span><span class="p">,</span>
		<span class="s">&quot;opera1&quot;</span><span class="p">,</span> <span class="s">&quot;cx231xx&quot;</span><span class="p">,</span> <span class="s">&quot;cx18&quot;</span><span class="p">,</span> <span class="s">&quot;cx23885&quot;</span><span class="p">,</span> <span class="s">&quot;pvrusb2&quot;</span><span class="p">,</span> <span class="s">&quot;mpc718&quot;</span><span class="p">,</span>
		<span class="s">&quot;af9015&quot;</span><span class="p">,</span> <span class="s">&quot;ngene&quot;</span><span class="p">,</span> <span class="s">&quot;az6027&quot;</span><span class="p">,</span> <span class="s">&quot;lme2510_lg&quot;</span><span class="p">,</span> <span class="s">&quot;lme2510c_s7395&quot;</span><span class="p">,</span>
		<span class="s">&quot;lme2510c_s7395_old&quot;</span><span class="p">,</span> <span class="s">&quot;drxk&quot;</span><span class="p">,</span> <span class="s">&quot;drxk_terratec_h5&quot;</span><span class="p">,</span>
		<span class="s">&quot;drxk_hauppauge_hvr930c&quot;</span><span class="p">,</span> <span class="s">&quot;tda10071&quot;</span><span class="p">,</span> <span class="s">&quot;it9135&quot;</span><span class="p">,</span> <span class="s">&quot;it9137&quot;</span><span class="p">,</span>
		<span class="s">&quot;drxk_pctv&quot;</span><span class="p">);</span></pre></div></td></tr>


<tr id="section-2"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-2">&#182;</a></div></td><td class="code"><div class="highlight shebang"><pre><span>#!/usr/bin/perl
</span></pre></div></td></tr>


<tr id="section-3"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-3">&#182;</a></div><p>Check args</p></td><td class="code"><div class="highlight"><pre><span class="n">syntax</span><span class="p">()</span> <span class="k">if</span> <span class="p">(</span><span class="nb">scalar</span><span class="p">(</span><span class="nv">@ARGV</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">);</span>
<span class="nv">$cid</span> <span class="o">=</span> <span class="nv">$ARGV</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span></pre></div></td></tr>


<tr id="section-4"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-4">&#182;</a></div><p>Do it!</p></td><td class="code"><div class="highlight"><pre><span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nb">scalar</span><span class="p">(</span><span class="nv">@components</span><span class="p">);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$cid</span> <span class="ow">eq</span> <span class="nv">$components</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span> <span class="p">{</span>
	<span class="nv">$outfile</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="nv">$cid</span><span class="p">);</span>
	<span class="nb">die</span> <span class="vg">$@</span> <span class="k">if</span> <span class="vg">$@</span><span class="p">;</span>
	<span class="k">print</span> <span class="bp">STDERR</span> <span class="s">&lt;&lt;EOF;</span>
<span class="s">Firmware(s) $outfile extracted successfully.</span>
<span class="s">Now copy it(them) to either /usr/lib/hotplug/firmware or /lib/firmware</span>
<span class="s">(depending on configuration of firmware hotplug).</span>
<span class="s">EOF</span>
	<span class="nb">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span></pre></div></td></tr>


<tr id="section-5"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-5">&#182;</a></div><p>If we get here, it wasn't found</p></td><td class="code"><div class="highlight"><pre><span class="k">print</span> <span class="bp">STDERR</span> <span class="s">&quot;Unknown component \&quot;$cid\&quot;\n&quot;</span><span class="p">;</span>
<span class="n">syntax</span><span class="p">();</span></pre></div></td></tr>


<tr id="section-6"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-6">&#182;</a></div><hr />

<p>Firmware-specific extraction subroutines</p></td><td class="code"><div class="highlight"><pre><span class="k">sub </span><span class="nf">sp8870</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$sourcefile</span> <span class="o">=</span> <span class="s">&quot;tt_Premium_217g.zip&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://www.softwarepatch.pl/9999ccd06a4813cb827dbb0005071c71/$sourcefile&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;53970ec17a538945a6d8cb608a7b3899&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$outfile</span> <span class="o">=</span> <span class="s">&quot;dvb-fe-sp8870.fw&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$tmpdir</span> <span class="o">=</span> <span class="n">tempdir</span><span class="p">(</span><span class="n">DIR</span> <span class="o">=&gt;</span> <span class="s">&quot;/tmp&quot;</span><span class="p">,</span> <span class="n">CLEANUP</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">checkstandard</span><span class="p">();</span>

    <span class="n">wgetfile</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
    <span class="n">unzip</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$tmpdir</span><span class="p">);</span>
    <span class="n">verify</span><span class="p">(</span><span class="s">&quot;$tmpdir/software/OEM/HE/App/boot/SC_MAIN.MC&quot;</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>
    <span class="n">copy</span><span class="p">(</span><span class="s">&quot;$tmpdir/software/OEM/HE/App/boot/SC_MAIN.MC&quot;</span><span class="p">,</span> <span class="nv">$outfile</span><span class="p">);</span>

    <span class="nv">$outfile</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">sp887x</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$sourcefile</span> <span class="o">=</span> <span class="s">&quot;Dvbt1.3.57.6.zip&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://www.avermedia.com/software/$sourcefile&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$cabfile</span> <span class="o">=</span> <span class="s">&quot;DVBT Net  Ver1.3.57.6/disk1/data1.cab&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;237938d53a7f834c05c42b894ca68ac3&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$outfile</span> <span class="o">=</span> <span class="s">&quot;dvb-fe-sp887x.fw&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$tmpdir</span> <span class="o">=</span> <span class="n">tempdir</span><span class="p">(</span><span class="n">DIR</span> <span class="o">=&gt;</span> <span class="s">&quot;/tmp&quot;</span><span class="p">,</span> <span class="n">CLEANUP</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">checkstandard</span><span class="p">();</span>
    <span class="n">checkunshield</span><span class="p">();</span>

    <span class="n">wgetfile</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
    <span class="n">unzip</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$tmpdir</span><span class="p">);</span>
    <span class="n">unshield</span><span class="p">(</span><span class="s">&quot;$tmpdir/$cabfile&quot;</span><span class="p">,</span> <span class="nv">$tmpdir</span><span class="p">);</span>
    <span class="n">verify</span><span class="p">(</span><span class="s">&quot;$tmpdir/ZEnglish/sc_main.mc&quot;</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>
    <span class="n">copy</span><span class="p">(</span><span class="s">&quot;$tmpdir/ZEnglish/sc_main.mc&quot;</span><span class="p">,</span> <span class="nv">$outfile</span><span class="p">);</span>

    <span class="nv">$outfile</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">tda10045</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$sourcefile</span> <span class="o">=</span> <span class="s">&quot;tt_budget_217g.zip&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://www.technotrend.de/new/217g/$sourcefile&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;2105fd5bf37842fbcdfa4bfd58f3594a&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$outfile</span> <span class="o">=</span> <span class="s">&quot;dvb-fe-tda10045.fw&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$tmpdir</span> <span class="o">=</span> <span class="n">tempdir</span><span class="p">(</span><span class="n">DIR</span> <span class="o">=&gt;</span> <span class="s">&quot;/tmp&quot;</span><span class="p">,</span> <span class="n">CLEANUP</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">checkstandard</span><span class="p">();</span>

    <span class="n">wgetfile</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
    <span class="n">unzip</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$tmpdir</span><span class="p">);</span>
    <span class="n">extract</span><span class="p">(</span><span class="s">&quot;$tmpdir/software/OEM/PCI/App/ttlcdacc.dll&quot;</span><span class="p">,</span> <span class="mh">0x37ef9</span><span class="p">,</span> <span class="mi">30555</span><span class="p">,</span> <span class="s">&quot;$tmpdir/fwtmp&quot;</span><span class="p">);</span>
    <span class="n">verify</span><span class="p">(</span><span class="s">&quot;$tmpdir/fwtmp&quot;</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>
    <span class="n">copy</span><span class="p">(</span><span class="s">&quot;$tmpdir/fwtmp&quot;</span><span class="p">,</span> <span class="nv">$outfile</span><span class="p">);</span>

    <span class="nv">$outfile</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">tda10046</span> <span class="p">{</span>
	<span class="k">my</span> <span class="nv">$sourcefile</span> <span class="o">=</span> <span class="s">&quot;TT_PCI_2.19h_28_11_2006.zip&quot;</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://www.tt-download.com/download/updates/219/$sourcefile&quot;</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;6a7e1e2f2644b162ff0502367553c72d&quot;</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$outfile</span> <span class="o">=</span> <span class="s">&quot;dvb-fe-tda10046.fw&quot;</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$tmpdir</span> <span class="o">=</span> <span class="n">tempdir</span><span class="p">(</span><span class="n">DIR</span> <span class="o">=&gt;</span> <span class="s">&quot;/tmp&quot;</span><span class="p">,</span> <span class="n">CLEANUP</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">);</span>

	<span class="n">checkstandard</span><span class="p">();</span>

	<span class="n">wgetfile</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
	<span class="n">unzip</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$tmpdir</span><span class="p">);</span>
	<span class="n">extract</span><span class="p">(</span><span class="s">&quot;$tmpdir/TT_PCI_2.19h_28_11_2006/software/OEM/PCI/App/ttlcdacc.dll&quot;</span><span class="p">,</span> <span class="mh">0x65389</span><span class="p">,</span> <span class="mi">24478</span><span class="p">,</span> <span class="s">&quot;$tmpdir/fwtmp&quot;</span><span class="p">);</span>
	<span class="n">verify</span><span class="p">(</span><span class="s">&quot;$tmpdir/fwtmp&quot;</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>
	<span class="n">copy</span><span class="p">(</span><span class="s">&quot;$tmpdir/fwtmp&quot;</span><span class="p">,</span> <span class="nv">$outfile</span><span class="p">);</span>

	<span class="nv">$outfile</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">tda10046lifeview</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$sourcefile</span> <span class="o">=</span> <span class="s">&quot;7%5Cdrv_2.11.02.zip&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://www.lifeview.hk/dbimages/document/$sourcefile&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;1ea24dee4eea8fe971686981f34fd2e0&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$outfile</span> <span class="o">=</span> <span class="s">&quot;dvb-fe-tda10046.fw&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$tmpdir</span> <span class="o">=</span> <span class="n">tempdir</span><span class="p">(</span><span class="n">DIR</span> <span class="o">=&gt;</span> <span class="s">&quot;/tmp&quot;</span><span class="p">,</span> <span class="n">CLEANUP</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">checkstandard</span><span class="p">();</span>

    <span class="n">wgetfile</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
    <span class="n">unzip</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$tmpdir</span><span class="p">);</span>
    <span class="n">extract</span><span class="p">(</span><span class="s">&quot;$tmpdir/LVHybrid.sys&quot;</span><span class="p">,</span> <span class="mh">0x8b088</span><span class="p">,</span> <span class="mi">24602</span><span class="p">,</span> <span class="s">&quot;$tmpdir/fwtmp&quot;</span><span class="p">);</span>
    <span class="n">verify</span><span class="p">(</span><span class="s">&quot;$tmpdir/fwtmp&quot;</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>
    <span class="n">copy</span><span class="p">(</span><span class="s">&quot;$tmpdir/fwtmp&quot;</span><span class="p">,</span> <span class="nv">$outfile</span><span class="p">);</span>

    <span class="nv">$outfile</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">av7110</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$sourcefile</span> <span class="o">=</span> <span class="s">&quot;dvb-ttpci-01.fw-261d&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://www.linuxtv.org/downloads/firmware/$sourcefile&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;603431b6259715a8e88f376a53b64e2f&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$outfile</span> <span class="o">=</span> <span class="s">&quot;dvb-ttpci-01.fw&quot;</span><span class="p">;</span>

    <span class="n">checkstandard</span><span class="p">();</span>

    <span class="n">wgetfile</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
    <span class="n">verify</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>
    <span class="n">copy</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$outfile</span><span class="p">);</span>

    <span class="nv">$outfile</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">dec2000t</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$sourcefile</span> <span class="o">=</span> <span class="s">&quot;dec217g.exe&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://hauppauge.lightpath.net/de/$sourcefile&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;bd86f458cee4a8f0a8ce2d20c66215a9&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$outfile</span> <span class="o">=</span> <span class="s">&quot;dvb-ttusb-dec-2000t.fw&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$tmpdir</span> <span class="o">=</span> <span class="n">tempdir</span><span class="p">(</span><span class="n">DIR</span> <span class="o">=&gt;</span> <span class="s">&quot;/tmp&quot;</span><span class="p">,</span> <span class="n">CLEANUP</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">checkstandard</span><span class="p">();</span>

    <span class="n">wgetfile</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
    <span class="n">unzip</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$tmpdir</span><span class="p">);</span>
    <span class="n">verify</span><span class="p">(</span><span class="s">&quot;$tmpdir/software/OEM/STB/App/Boot/STB_PC_T.bin&quot;</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>
    <span class="n">copy</span><span class="p">(</span><span class="s">&quot;$tmpdir/software/OEM/STB/App/Boot/STB_PC_T.bin&quot;</span><span class="p">,</span> <span class="nv">$outfile</span><span class="p">);</span>

    <span class="nv">$outfile</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">dec2540t</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$sourcefile</span> <span class="o">=</span> <span class="s">&quot;dec217g.exe&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://hauppauge.lightpath.net/de/$sourcefile&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;53e58f4f5b5c2930beee74a7681fed92&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$outfile</span> <span class="o">=</span> <span class="s">&quot;dvb-ttusb-dec-2540t.fw&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$tmpdir</span> <span class="o">=</span> <span class="n">tempdir</span><span class="p">(</span><span class="n">DIR</span> <span class="o">=&gt;</span> <span class="s">&quot;/tmp&quot;</span><span class="p">,</span> <span class="n">CLEANUP</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">checkstandard</span><span class="p">();</span>

    <span class="n">wgetfile</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
    <span class="n">unzip</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$tmpdir</span><span class="p">);</span>
    <span class="n">verify</span><span class="p">(</span><span class="s">&quot;$tmpdir/software/OEM/STB/App/Boot/STB_PC_X.bin&quot;</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>
    <span class="n">copy</span><span class="p">(</span><span class="s">&quot;$tmpdir/software/OEM/STB/App/Boot/STB_PC_X.bin&quot;</span><span class="p">,</span> <span class="nv">$outfile</span><span class="p">);</span>

    <span class="nv">$outfile</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">dec3000s</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$sourcefile</span> <span class="o">=</span> <span class="s">&quot;dec217g.exe&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://hauppauge.lightpath.net/de/$sourcefile&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;b013ececea83f4d6d8d2a29ac7c1b448&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$outfile</span> <span class="o">=</span> <span class="s">&quot;dvb-ttusb-dec-3000s.fw&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$tmpdir</span> <span class="o">=</span> <span class="n">tempdir</span><span class="p">(</span><span class="n">DIR</span> <span class="o">=&gt;</span> <span class="s">&quot;/tmp&quot;</span><span class="p">,</span> <span class="n">CLEANUP</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">checkstandard</span><span class="p">();</span>

    <span class="n">wgetfile</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
    <span class="n">unzip</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$tmpdir</span><span class="p">);</span>
    <span class="n">verify</span><span class="p">(</span><span class="s">&quot;$tmpdir/software/OEM/STB/App/Boot/STB_PC_S.bin&quot;</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>
    <span class="n">copy</span><span class="p">(</span><span class="s">&quot;$tmpdir/software/OEM/STB/App/Boot/STB_PC_S.bin&quot;</span><span class="p">,</span> <span class="nv">$outfile</span><span class="p">);</span>

    <span class="nv">$outfile</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">sub </span><span class="nf">opera1</span><span class="p">{</span>
	<span class="k">my</span> <span class="nv">$tmpdir</span> <span class="o">=</span> <span class="n">tempdir</span><span class="p">(</span><span class="n">DIR</span> <span class="o">=&gt;</span> <span class="s">&quot;/tmp&quot;</span><span class="p">,</span> <span class="n">CLEANUP</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">);</span>

	<span class="n">checkstandard</span><span class="p">();</span>
	<span class="k">my</span> <span class="nv">$fwfile1</span><span class="o">=</span><span class="s">&quot;dvb-usb-opera1-fpga-01.fw&quot;</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$fwfile2</span><span class="o">=</span><span class="s">&quot;dvb-usb-opera-01.fw&quot;</span><span class="p">;</span>
	<span class="n">extract</span><span class="p">(</span><span class="s">&quot;2830SCap2.sys&quot;</span><span class="p">,</span> <span class="mh">0x62e8</span><span class="p">,</span> <span class="mi">55024</span><span class="p">,</span> <span class="s">&quot;$tmpdir/opera1-fpga.fw&quot;</span><span class="p">);</span>
	<span class="n">extract</span><span class="p">(</span><span class="s">&quot;2830SLoad2.sys&quot;</span><span class="p">,</span><span class="mh">0x3178</span><span class="p">,</span><span class="mh">0x3685</span><span class="o">-</span><span class="mh">0x3178</span><span class="p">,</span><span class="s">&quot;$tmpdir/fw1part1&quot;</span><span class="p">);</span>
	<span class="n">extract</span><span class="p">(</span><span class="s">&quot;2830SLoad2.sys&quot;</span><span class="p">,</span><span class="mh">0x0980</span><span class="p">,</span><span class="mh">0x3150</span><span class="o">-</span><span class="mh">0x0980</span><span class="p">,</span><span class="s">&quot;$tmpdir/fw1part2&quot;</span><span class="p">);</span>
	<span class="n">delzero</span><span class="p">(</span><span class="s">&quot;$tmpdir/fw1part1&quot;</span><span class="p">,</span><span class="s">&quot;$tmpdir/fw1part1-1&quot;</span><span class="p">);</span>
	<span class="n">delzero</span><span class="p">(</span><span class="s">&quot;$tmpdir/fw1part2&quot;</span><span class="p">,</span><span class="s">&quot;$tmpdir/fw1part2-1&quot;</span><span class="p">);</span>
	<span class="n">verify</span><span class="p">(</span><span class="s">&quot;$tmpdir/fw1part1-1&quot;</span><span class="p">,</span><span class="s">&quot;5e0909858fdf0b5b09ad48b9fe622e70&quot;</span><span class="p">);</span>
	<span class="n">verify</span><span class="p">(</span><span class="s">&quot;$tmpdir/fw1part2-1&quot;</span><span class="p">,</span><span class="s">&quot;d6e146f321427e931df2c6fcadac37a1&quot;</span><span class="p">);</span>
	<span class="n">verify</span><span class="p">(</span><span class="s">&quot;$tmpdir/opera1-fpga.fw&quot;</span><span class="p">,</span><span class="s">&quot;0f8133f5e9051f5f3c1928f7e5a1b07d&quot;</span><span class="p">);</span>

	<span class="k">my</span> <span class="nv">$RES1</span><span class="o">=</span><span class="s">&quot;\x01\x92\x7f\x00\x01\x00&quot;</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$RES0</span><span class="o">=</span><span class="s">&quot;\x01\x92\x7f\x00\x00\x00&quot;</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$DAT1</span><span class="o">=</span><span class="s">&quot;\x01\x00\xe6\x00\x01\x00&quot;</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$DAT0</span><span class="o">=</span><span class="s">&quot;\x01\x00\xe6\x00\x00\x00&quot;</span><span class="p">;</span>
	<span class="nb">open</span> <span class="n">FW</span><span class="p">,</span><span class="s">&quot;&gt;$tmpdir/opera.fw&quot;</span><span class="p">;</span>
	<span class="k">print</span> <span class="n">FW</span> <span class="s">&quot;$RES1&quot;</span><span class="p">;</span>
	<span class="k">print</span> <span class="n">FW</span> <span class="s">&quot;$DAT1&quot;</span><span class="p">;</span>
	<span class="k">print</span> <span class="n">FW</span> <span class="s">&quot;$RES1&quot;</span><span class="p">;</span>
	<span class="k">print</span> <span class="n">FW</span> <span class="s">&quot;$DAT1&quot;</span><span class="p">;</span>
	<span class="n">appendfile</span><span class="p">(</span><span class="n">FW</span><span class="p">,</span><span class="s">&quot;$tmpdir/fw1part1-1&quot;</span><span class="p">);</span>
	<span class="k">print</span> <span class="n">FW</span> <span class="s">&quot;$RES0&quot;</span><span class="p">;</span>
	<span class="k">print</span> <span class="n">FW</span> <span class="s">&quot;$DAT0&quot;</span><span class="p">;</span>
	<span class="k">print</span> <span class="n">FW</span> <span class="s">&quot;$RES1&quot;</span><span class="p">;</span>
	<span class="k">print</span> <span class="n">FW</span> <span class="s">&quot;$DAT1&quot;</span><span class="p">;</span>
	<span class="n">appendfile</span><span class="p">(</span><span class="n">FW</span><span class="p">,</span><span class="s">&quot;$tmpdir/fw1part2-1&quot;</span><span class="p">);</span>
	<span class="k">print</span> <span class="n">FW</span> <span class="s">&quot;$RES1&quot;</span><span class="p">;</span>
	<span class="k">print</span> <span class="n">FW</span> <span class="s">&quot;$DAT1&quot;</span><span class="p">;</span>
	<span class="k">print</span> <span class="n">FW</span> <span class="s">&quot;$RES0&quot;</span><span class="p">;</span>
	<span class="k">print</span> <span class="n">FW</span> <span class="s">&quot;$DAT0&quot;</span><span class="p">;</span>
	<span class="n">copy</span> <span class="p">(</span><span class="s">&quot;$tmpdir/opera1-fpga.fw&quot;</span><span class="p">,</span><span class="nv">$fwfile1</span><span class="p">);</span>
	<span class="n">copy</span> <span class="p">(</span><span class="s">&quot;$tmpdir/opera.fw&quot;</span><span class="p">,</span><span class="nv">$fwfile2</span><span class="p">);</span>

	<span class="nv">$fwfile1</span><span class="o">.</span><span class="s">&quot;,&quot;</span><span class="o">.</span><span class="nv">$fwfile2</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">vp7041</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$sourcefile</span> <span class="o">=</span> <span class="s">&quot;2.422.zip&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://www.twinhan.com/files/driver/USB-Ter/$sourcefile&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;e88c9372d1f66609a3e7b072c53fbcfe&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$outfile</span> <span class="o">=</span> <span class="s">&quot;dvb-vp7041-2.422.fw&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$tmpdir</span> <span class="o">=</span> <span class="n">tempdir</span><span class="p">(</span><span class="n">DIR</span> <span class="o">=&gt;</span> <span class="s">&quot;/tmp&quot;</span><span class="p">,</span> <span class="n">CLEANUP</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">checkstandard</span><span class="p">();</span>

    <span class="n">wgetfile</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
    <span class="n">unzip</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$tmpdir</span><span class="p">);</span>
    <span class="n">extract</span><span class="p">(</span><span class="s">&quot;$tmpdir/VisionDTV/Drivers/Win2K&amp;XP/UDTTload.sys&quot;</span><span class="p">,</span> <span class="mi">12503</span><span class="p">,</span> <span class="mi">3036</span><span class="p">,</span> <span class="s">&quot;$tmpdir/fwtmp1&quot;</span><span class="p">);</span>
    <span class="n">extract</span><span class="p">(</span><span class="s">&quot;$tmpdir/VisionDTV/Drivers/Win2K&amp;XP/UDTTload.sys&quot;</span><span class="p">,</span> <span class="mi">2207</span><span class="p">,</span> <span class="mi">10274</span><span class="p">,</span> <span class="s">&quot;$tmpdir/fwtmp2&quot;</span><span class="p">);</span>

    <span class="k">my</span> <span class="nv">$CMD</span> <span class="o">=</span> <span class="s">&quot;\000\001\000\222\177\000&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$PAD</span> <span class="o">=</span> <span class="s">&quot;\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="p">(</span><span class="nv">$FW</span><span class="p">);</span>
    <span class="nb">open</span> <span class="nv">$FW</span><span class="p">,</span> <span class="s">&quot;&gt;$tmpdir/fwtmp3&quot;</span><span class="p">;</span>
    <span class="k">print</span> <span class="nv">$FW</span> <span class="s">&quot;$CMD\001$PAD&quot;</span><span class="p">;</span>
    <span class="k">print</span> <span class="nv">$FW</span> <span class="s">&quot;$CMD\001$PAD&quot;</span><span class="p">;</span>
    <span class="n">appendfile</span><span class="p">(</span><span class="nv">$FW</span><span class="p">,</span> <span class="s">&quot;$tmpdir/fwtmp1&quot;</span><span class="p">);</span>
    <span class="k">print</span> <span class="nv">$FW</span> <span class="s">&quot;$CMD\000$PAD&quot;</span><span class="p">;</span>
    <span class="k">print</span> <span class="nv">$FW</span> <span class="s">&quot;$CMD\001$PAD&quot;</span><span class="p">;</span>
    <span class="n">appendfile</span><span class="p">(</span><span class="nv">$FW</span><span class="p">,</span> <span class="s">&quot;$tmpdir/fwtmp2&quot;</span><span class="p">);</span>
    <span class="k">print</span> <span class="nv">$FW</span> <span class="s">&quot;$CMD\001$PAD&quot;</span><span class="p">;</span>
    <span class="k">print</span> <span class="nv">$FW</span> <span class="s">&quot;$CMD\000$PAD&quot;</span><span class="p">;</span>
    <span class="nb">close</span><span class="p">(</span><span class="nv">$FW</span><span class="p">);</span>

    <span class="n">verify</span><span class="p">(</span><span class="s">&quot;$tmpdir/fwtmp3&quot;</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>
    <span class="n">copy</span><span class="p">(</span><span class="s">&quot;$tmpdir/fwtmp3&quot;</span><span class="p">,</span> <span class="nv">$outfile</span><span class="p">);</span>

    <span class="nv">$outfile</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">dibusb</span> <span class="p">{</span>
	<span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://www.linuxtv.org/downloads/firmware/dvb-usb-dibusb-5.0.0.11.fw&quot;</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$outfile</span> <span class="o">=</span> <span class="s">&quot;dvb-dibusb-5.0.0.11.fw&quot;</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;fa490295a527360ca16dcdf3224ca243&quot;</span><span class="p">;</span>

	<span class="n">checkstandard</span><span class="p">();</span>

	<span class="n">wgetfile</span><span class="p">(</span><span class="nv">$outfile</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
	<span class="n">verify</span><span class="p">(</span><span class="nv">$outfile</span><span class="p">,</span><span class="nv">$hash</span><span class="p">);</span>

	<span class="nv">$outfile</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">nxt2002</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$sourcefile</span> <span class="o">=</span> <span class="s">&quot;Technisat_DVB-PC_4_4_COMPACT.zip&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://www.bbti.us/download/windows/$sourcefile&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;476befae8c7c1bb9648954060b1eec1f&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$outfile</span> <span class="o">=</span> <span class="s">&quot;dvb-fe-nxt2002.fw&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$tmpdir</span> <span class="o">=</span> <span class="n">tempdir</span><span class="p">(</span><span class="n">DIR</span> <span class="o">=&gt;</span> <span class="s">&quot;/tmp&quot;</span><span class="p">,</span> <span class="n">CLEANUP</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">checkstandard</span><span class="p">();</span>

    <span class="n">wgetfile</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
    <span class="n">unzip</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$tmpdir</span><span class="p">);</span>
    <span class="n">verify</span><span class="p">(</span><span class="s">&quot;$tmpdir/SkyNET.sys&quot;</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>
    <span class="n">extract</span><span class="p">(</span><span class="s">&quot;$tmpdir/SkyNET.sys&quot;</span><span class="p">,</span> <span class="mi">331624</span><span class="p">,</span> <span class="mi">5908</span><span class="p">,</span> <span class="nv">$outfile</span><span class="p">);</span>

    <span class="nv">$outfile</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">nxt2004</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$sourcefile</span> <span class="o">=</span> <span class="s">&quot;AVerTVHD_MCE_A180_Drv_v1.2.2.16.zip&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://www.avermedia-usa.com/support/Drivers/$sourcefile&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;111cb885b1e009188346d72acfed024c&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$outfile</span> <span class="o">=</span> <span class="s">&quot;dvb-fe-nxt2004.fw&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$tmpdir</span> <span class="o">=</span> <span class="n">tempdir</span><span class="p">(</span><span class="n">DIR</span> <span class="o">=&gt;</span> <span class="s">&quot;/tmp&quot;</span><span class="p">,</span> <span class="n">CLEANUP</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">checkstandard</span><span class="p">();</span>

    <span class="n">wgetfile</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
    <span class="n">unzip</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$tmpdir</span><span class="p">);</span>
    <span class="n">verify</span><span class="p">(</span><span class="s">&quot;$tmpdir/3xHybrid.sys&quot;</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>
    <span class="n">extract</span><span class="p">(</span><span class="s">&quot;$tmpdir/3xHybrid.sys&quot;</span><span class="p">,</span> <span class="mi">465304</span><span class="p">,</span> <span class="mi">9584</span><span class="p">,</span> <span class="nv">$outfile</span><span class="p">);</span>

    <span class="nv">$outfile</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">or51211</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$fwfile</span> <span class="o">=</span> <span class="s">&quot;dvb-fe-or51211.fw&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://linuxtv.org/downloads/firmware/$fwfile&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;d830949c771a289505bf9eafc225d491&quot;</span><span class="p">;</span>

    <span class="n">checkstandard</span><span class="p">();</span>

    <span class="n">wgetfile</span><span class="p">(</span><span class="nv">$fwfile</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
    <span class="n">verify</span><span class="p">(</span><span class="nv">$fwfile</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>

    <span class="nv">$fwfile</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">cx231xx</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$fwfile</span> <span class="o">=</span> <span class="s">&quot;v4l-cx231xx-avcore-01.fw&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://linuxtv.org/downloads/firmware/$fwfile&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;7d3bb956dc9df0eafded2b56ba57cc42&quot;</span><span class="p">;</span>

    <span class="n">checkstandard</span><span class="p">();</span>

    <span class="n">wgetfile</span><span class="p">(</span><span class="nv">$fwfile</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
    <span class="n">verify</span><span class="p">(</span><span class="nv">$fwfile</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>

    <span class="nv">$fwfile</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">cx18</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://linuxtv.org/downloads/firmware/&quot;</span><span class="p">;</span>

    <span class="k">my</span> <span class="nv">%files</span> <span class="o">=</span> <span class="p">(</span>
	<span class="s">&#39;v4l-cx23418-apu.fw&#39;</span> <span class="o">=&gt;</span> <span class="s">&#39;588f081b562f5c653a3db1ad8f65939a&#39;</span><span class="p">,</span>
	<span class="s">&#39;v4l-cx23418-cpu.fw&#39;</span> <span class="o">=&gt;</span> <span class="s">&#39;b6c7ed64bc44b1a6e0840adaeac39d79&#39;</span><span class="p">,</span>
	<span class="s">&#39;v4l-cx23418-dig.fw&#39;</span> <span class="o">=&gt;</span> <span class="s">&#39;95bc688d3e7599fd5800161e9971cc55&#39;</span><span class="p">,</span>
    <span class="p">);</span>

    <span class="n">checkstandard</span><span class="p">();</span>

    <span class="k">my</span> <span class="nv">$allfiles</span><span class="p">;</span>
    <span class="k">foreach</span> <span class="k">my</span> <span class="nv">$fwfile</span> <span class="p">(</span><span class="nb">keys</span> <span class="nv">%files</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">wgetfile</span><span class="p">(</span><span class="nv">$fwfile</span><span class="p">,</span> <span class="s">&quot;$url/$fwfile&quot;</span><span class="p">);</span>
	<span class="n">verify</span><span class="p">(</span><span class="nv">$fwfile</span><span class="p">,</span> <span class="nv">$files</span><span class="p">{</span><span class="nv">$fwfile</span><span class="p">});</span>
	<span class="nv">$allfiles</span> <span class="o">.=</span> <span class="s">&quot; $fwfile&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nv">$allfiles</span> <span class="o">=~</span> <span class="sr">s/^\s//</span><span class="p">;</span>

    <span class="nv">$allfiles</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">mpc718</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$archive</span> <span class="o">=</span> <span class="s">&#39;Yuan MPC718 TV Tuner Card 2.13.10.1016.zip&#39;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;ftp://ftp.work.acer-euro.com/desktop/aspire_idea510/vista/Drivers/$archive&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$fwfile</span> <span class="o">=</span> <span class="s">&quot;dvb-cx18-mpc718-mt352.fw&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$tmpdir</span> <span class="o">=</span> <span class="n">tempdir</span><span class="p">(</span><span class="n">DIR</span> <span class="o">=&gt;</span> <span class="s">&quot;/tmp&quot;</span><span class="p">,</span> <span class="n">CLEANUP</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">checkstandard</span><span class="p">();</span>
    <span class="n">wgetfile</span><span class="p">(</span><span class="nv">$archive</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
    <span class="n">unzip</span><span class="p">(</span><span class="nv">$archive</span><span class="p">,</span> <span class="nv">$tmpdir</span><span class="p">);</span>

    <span class="k">my</span> <span class="nv">$sourcefile</span> <span class="o">=</span> <span class="s">&quot;$tmpdir/Yuan MPC718 TV Tuner Card 2.13.10.1016/mpc718_32bit/yuanrap.sys&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$found</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="nb">open</span> <span class="n">IN</span><span class="p">,</span> <span class="s">&#39;&lt;&#39;</span><span class="p">,</span> <span class="nv">$sourcefile</span> <span class="ow">or</span> <span class="nb">die</span> <span class="s">&quot;Couldn&#39;t open $sourcefile to extract $fwfile data\n&quot;</span><span class="p">;</span>
    <span class="nb">binmode</span> <span class="n">IN</span><span class="p">;</span>
    <span class="nb">open</span> <span class="n">OUT</span><span class="p">,</span> <span class="s">&#39;&gt;&#39;</span><span class="p">,</span> <span class="nv">$fwfile</span><span class="p">;</span>
    <span class="nb">binmode</span> <span class="n">OUT</span><span class="p">;</span>
    <span class="p">{</span></pre></div></td></tr>


<tr id="section-7"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-7">&#182;</a></div><p>Block scope because we change the line terminator variable $/</p></td><td class="code"><div class="highlight"><pre>	<span class="k">my</span> <span class="nv">$prevlen</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$currlen</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-8"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-8">&#182;</a></div><p>Buried in the data segment are 3 runs of almost identical
register-value pairs that end in 0x5d 0x01 which is a "TUNER GO"
command for the MT352.
Pull out the middle run (because it's easy) of register-value
pairs to make the "firmware" file.</p></td><td class="code"><div class="highlight"><pre>	<span class="nb">local</span> <span class="vg">$/</span> <span class="o">=</span> <span class="s">&quot;\x5d\x01&quot;</span><span class="p">;</span> <span class="c1"># MT352 &quot;TUNER GO&quot;</span>

	<span class="k">while</span> <span class="p">(</span><span class="sr">&lt;IN&gt;</span><span class="p">)</span> <span class="p">{</span>
	    <span class="nv">$currlen</span> <span class="o">=</span> <span class="nb">length</span><span class="p">(</span><span class="nv">$_</span><span class="p">);</span>
	    <span class="k">if</span> <span class="p">(</span><span class="nv">$prevlen</span> <span class="o">==</span> <span class="nv">$currlen</span> <span class="o">&amp;&amp;</span> <span class="nv">$currlen</span> <span class="o">&lt;=</span> <span class="mi">64</span><span class="p">)</span> <span class="p">{</span>
		<span class="nb">chop</span><span class="p">;</span> <span class="nb">chop</span><span class="p">;</span> <span class="c1"># Get rid of &quot;TUNER GO&quot;</span>
		<span class="sr">s/^\0\0//</span><span class="p">;</span>  <span class="c1"># get rid of leading 00 00 if it&#39;s there</span>
		<span class="nb">printf</span> <span class="n">OUT</span> <span class="s">&quot;$_&quot;</span><span class="p">;</span>
		<span class="nv">$found</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="k">last</span><span class="p">;</span>
	    <span class="p">}</span>
	    <span class="nv">$prevlen</span> <span class="o">=</span> <span class="nv">$currlen</span><span class="p">;</span>
	<span class="p">}</span>
    <span class="p">}</span>
    <span class="nb">close</span> <span class="n">OUT</span><span class="p">;</span>
    <span class="nb">close</span> <span class="n">IN</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$found</span><span class="p">)</span> <span class="p">{</span>
	<span class="nb">unlink</span> <span class="nv">$fwfile</span><span class="p">;</span>
	<span class="nb">die</span> <span class="s">&quot;Couldn&#39;t find valid register-value sequence in $sourcefile for $fwfile\n&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nv">$fwfile</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">cx23885</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://linuxtv.org/downloads/firmware/&quot;</span><span class="p">;</span>

    <span class="k">my</span> <span class="nv">%files</span> <span class="o">=</span> <span class="p">(</span>
	<span class="s">&#39;v4l-cx23885-avcore-01.fw&#39;</span> <span class="o">=&gt;</span> <span class="s">&#39;a9f8f5d901a7fb42f552e1ee6384f3bb&#39;</span><span class="p">,</span>
	<span class="s">&#39;v4l-cx23885-enc.fw&#39;</span>       <span class="o">=&gt;</span> <span class="s">&#39;a9f8f5d901a7fb42f552e1ee6384f3bb&#39;</span><span class="p">,</span>
    <span class="p">);</span>

    <span class="n">checkstandard</span><span class="p">();</span>

    <span class="k">my</span> <span class="nv">$allfiles</span><span class="p">;</span>
    <span class="k">foreach</span> <span class="k">my</span> <span class="nv">$fwfile</span> <span class="p">(</span><span class="nb">keys</span> <span class="nv">%files</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">wgetfile</span><span class="p">(</span><span class="nv">$fwfile</span><span class="p">,</span> <span class="s">&quot;$url/$fwfile&quot;</span><span class="p">);</span>
	<span class="n">verify</span><span class="p">(</span><span class="nv">$fwfile</span><span class="p">,</span> <span class="nv">$files</span><span class="p">{</span><span class="nv">$fwfile</span><span class="p">});</span>
	<span class="nv">$allfiles</span> <span class="o">.=</span> <span class="s">&quot; $fwfile&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nv">$allfiles</span> <span class="o">=~</span> <span class="sr">s/^\s//</span><span class="p">;</span>

    <span class="nv">$allfiles</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">pvrusb2</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://linuxtv.org/downloads/firmware/&quot;</span><span class="p">;</span>

    <span class="k">my</span> <span class="nv">%files</span> <span class="o">=</span> <span class="p">(</span>
	<span class="s">&#39;v4l-cx25840.fw&#39;</span>           <span class="o">=&gt;</span> <span class="s">&#39;dadb79e9904fc8af96e8111d9cb59320&#39;</span><span class="p">,</span>
    <span class="p">);</span>

    <span class="n">checkstandard</span><span class="p">();</span>

    <span class="k">my</span> <span class="nv">$allfiles</span><span class="p">;</span>
    <span class="k">foreach</span> <span class="k">my</span> <span class="nv">$fwfile</span> <span class="p">(</span><span class="nb">keys</span> <span class="nv">%files</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">wgetfile</span><span class="p">(</span><span class="nv">$fwfile</span><span class="p">,</span> <span class="s">&quot;$url/$fwfile&quot;</span><span class="p">);</span>
	<span class="n">verify</span><span class="p">(</span><span class="nv">$fwfile</span><span class="p">,</span> <span class="nv">$files</span><span class="p">{</span><span class="nv">$fwfile</span><span class="p">});</span>
	<span class="nv">$allfiles</span> <span class="o">.=</span> <span class="s">&quot; $fwfile&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nv">$allfiles</span> <span class="o">=~</span> <span class="sr">s/^\s//</span><span class="p">;</span>

    <span class="nv">$allfiles</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">or51132_qam</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$fwfile</span> <span class="o">=</span> <span class="s">&quot;dvb-fe-or51132-qam.fw&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://linuxtv.org/downloads/firmware/$fwfile&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;7702e8938612de46ccadfe9b413cb3b5&quot;</span><span class="p">;</span>

    <span class="n">checkstandard</span><span class="p">();</span>

    <span class="n">wgetfile</span><span class="p">(</span><span class="nv">$fwfile</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
    <span class="n">verify</span><span class="p">(</span><span class="nv">$fwfile</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>

    <span class="nv">$fwfile</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">or51132_vsb</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$fwfile</span> <span class="o">=</span> <span class="s">&quot;dvb-fe-or51132-vsb.fw&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://linuxtv.org/downloads/firmware/$fwfile&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;c16208e02f36fc439a557ad4c613364a&quot;</span><span class="p">;</span>

    <span class="n">checkstandard</span><span class="p">();</span>

    <span class="n">wgetfile</span><span class="p">(</span><span class="nv">$fwfile</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
    <span class="n">verify</span><span class="p">(</span><span class="nv">$fwfile</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>

    <span class="nv">$fwfile</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">bluebird</span> <span class="p">{</span>
	<span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://www.linuxtv.org/download/dvb/firmware/dvb-usb-bluebird-01.fw&quot;</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$outfile</span> <span class="o">=</span> <span class="s">&quot;dvb-usb-bluebird-01.fw&quot;</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;658397cb9eba9101af9031302671f49d&quot;</span><span class="p">;</span>

	<span class="n">checkstandard</span><span class="p">();</span>

	<span class="n">wgetfile</span><span class="p">(</span><span class="nv">$outfile</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
	<span class="n">verify</span><span class="p">(</span><span class="nv">$outfile</span><span class="p">,</span><span class="nv">$hash</span><span class="p">);</span>

	<span class="nv">$outfile</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">af9015</span> <span class="p">{</span>
	<span class="k">my</span> <span class="nv">$sourcefile</span> <span class="o">=</span> <span class="s">&quot;download.ashx?file=57&quot;</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://www.ite.com.tw/EN/Services/$sourcefile&quot;</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;e3f08935158038d385ad382442f4bb2d&quot;</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$outfile</span> <span class="o">=</span> <span class="s">&quot;dvb-usb-af9015.fw&quot;</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$tmpdir</span> <span class="o">=</span> <span class="n">tempdir</span><span class="p">(</span><span class="n">DIR</span> <span class="o">=&gt;</span> <span class="s">&quot;/tmp&quot;</span><span class="p">,</span> <span class="n">CLEANUP</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">my</span> <span class="nv">$fwoffset</span> <span class="o">=</span> <span class="mh">0x25690</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$fwlength</span> <span class="o">=</span> <span class="mi">18725</span><span class="p">;</span>
	<span class="k">my</span> <span class="p">(</span><span class="nv">$chunklength</span><span class="p">,</span> <span class="nv">$buf</span><span class="p">,</span> <span class="nv">$rcount</span><span class="p">);</span>

	<span class="n">checkstandard</span><span class="p">();</span>

	<span class="n">wgetfile</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
	<span class="n">unzip</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$tmpdir</span><span class="p">);</span>
	<span class="n">verify</span><span class="p">(</span><span class="s">&quot;$tmpdir/Driver/Files/AF15BDA.sys&quot;</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>

	<span class="nb">open</span> <span class="n">INFILE</span><span class="p">,</span> <span class="s">&#39;&lt;&#39;</span><span class="p">,</span> <span class="s">&quot;$tmpdir/Driver/Files/AF15BDA.sys&quot;</span><span class="p">;</span>
	<span class="nb">open</span> <span class="n">OUTFILE</span><span class="p">,</span> <span class="s">&#39;&gt;&#39;</span><span class="p">,</span> <span class="nv">$outfile</span><span class="p">;</span>

	<span class="nb">sysseek</span><span class="p">(</span><span class="n">INFILE</span><span class="p">,</span> <span class="nv">$fwoffset</span><span class="p">,</span> <span class="n">SEEK_SET</span><span class="p">);</span>
	<span class="k">while</span><span class="p">(</span><span class="nv">$fwlength</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="nv">$chunklength</span> <span class="o">=</span> <span class="mi">55</span><span class="p">;</span>
		<span class="nv">$chunklength</span> <span class="o">=</span> <span class="nv">$fwlength</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$chunklength</span> <span class="o">&gt;</span> <span class="nv">$fwlength</span><span class="p">);</span>
		<span class="nv">$rcount</span> <span class="o">=</span> <span class="nb">sysread</span><span class="p">(</span><span class="n">INFILE</span><span class="p">,</span> <span class="nv">$buf</span><span class="p">,</span> <span class="nv">$chunklength</span><span class="p">);</span>
		<span class="nb">die</span> <span class="s">&quot;Ran out of data\n&quot;</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$rcount</span> <span class="o">!=</span> <span class="nv">$chunklength</span><span class="p">);</span>
		<span class="nb">syswrite</span><span class="p">(</span><span class="n">OUTFILE</span><span class="p">,</span> <span class="nv">$buf</span><span class="p">);</span>
		<span class="nb">sysread</span><span class="p">(</span><span class="n">INFILE</span><span class="p">,</span> <span class="nv">$buf</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
		<span class="nv">$fwlength</span> <span class="o">-=</span> <span class="nv">$rcount</span> <span class="o">+</span> <span class="mi">8</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="nb">close</span> <span class="n">OUTFILE</span><span class="p">;</span>
	<span class="nb">close</span> <span class="n">INFILE</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">ngene</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://www.digitaldevices.de/download/&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$file1</span> <span class="o">=</span> <span class="s">&quot;ngene_15.fw&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hash1</span> <span class="o">=</span> <span class="s">&quot;d798d5a757121174f0dbc5f2833c0c85&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$file2</span> <span class="o">=</span> <span class="s">&quot;ngene_17.fw&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hash2</span> <span class="o">=</span> <span class="s">&quot;26b687136e127b8ac24b81e0eeafc20b&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$url2</span> <span class="o">=</span> <span class="s">&quot;http://l4m-daten.de/downloads/firmware/dvb-s2/linux/all/&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$file3</span> <span class="o">=</span> <span class="s">&quot;ngene_18.fw&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hash3</span> <span class="o">=</span> <span class="s">&quot;ebce3ea769a53e3e0b0197c3b3f127e3&quot;</span><span class="p">;</span>

    <span class="n">checkstandard</span><span class="p">();</span>

    <span class="n">wgetfile</span><span class="p">(</span><span class="nv">$file1</span><span class="p">,</span> <span class="nv">$url</span> <span class="o">.</span> <span class="nv">$file1</span><span class="p">);</span>
    <span class="n">verify</span><span class="p">(</span><span class="nv">$file1</span><span class="p">,</span> <span class="nv">$hash1</span><span class="p">);</span>

    <span class="n">wgetfile</span><span class="p">(</span><span class="nv">$file2</span><span class="p">,</span> <span class="nv">$url</span> <span class="o">.</span> <span class="nv">$file2</span><span class="p">);</span>
    <span class="n">verify</span><span class="p">(</span><span class="nv">$file2</span><span class="p">,</span> <span class="nv">$hash2</span><span class="p">);</span>

    <span class="n">wgetfile</span><span class="p">(</span><span class="nv">$file3</span><span class="p">,</span> <span class="nv">$url2</span> <span class="o">.</span> <span class="nv">$file3</span><span class="p">);</span>
    <span class="n">verify</span><span class="p">(</span><span class="nv">$file3</span><span class="p">,</span> <span class="nv">$hash3</span><span class="p">);</span>

    <span class="s">&quot;$file1, $file2, $file3&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">az6027</span><span class="p">{</span>
    <span class="k">my</span> <span class="nv">$firmware</span> <span class="o">=</span> <span class="s">&quot;dvb-usb-az6027-03.fw&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://linux.terratec.de/files/TERRATEC_S7/$firmware&quot;</span><span class="p">;</span>

    <span class="n">wgetfile</span><span class="p">(</span><span class="nv">$firmware</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>

    <span class="nv">$firmware</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">lme2510_lg</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$sourcefile</span> <span class="o">=</span> <span class="s">&quot;LMEBDA_DVBS.sys&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;fc6017ad01e79890a97ec53bea157ed2&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$outfile</span> <span class="o">=</span> <span class="s">&quot;dvb-usb-lme2510-lg.fw&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hasho</span> <span class="o">=</span> <span class="s">&quot;caa065d5fdbd2c09ad57b399bbf55cad&quot;</span><span class="p">;</span>

    <span class="n">checkstandard</span><span class="p">();</span>

    <span class="n">verify</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>
    <span class="n">extract</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="mi">4168</span><span class="p">,</span> <span class="mi">3841</span><span class="p">,</span> <span class="nv">$outfile</span><span class="p">);</span>
    <span class="n">verify</span><span class="p">(</span><span class="nv">$outfile</span><span class="p">,</span> <span class="nv">$hasho</span><span class="p">);</span>
    <span class="nv">$outfile</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">lme2510c_s7395</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$sourcefile</span> <span class="o">=</span> <span class="s">&quot;US2A0D.sys&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;b0155a8083fb822a3bd47bc360e74601&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$outfile</span> <span class="o">=</span> <span class="s">&quot;dvb-usb-lme2510c-s7395.fw&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hasho</span> <span class="o">=</span> <span class="s">&quot;3a3cf1aeebd17b6ddc04cebe131e94cf&quot;</span><span class="p">;</span>

    <span class="n">checkstandard</span><span class="p">();</span>

    <span class="n">verify</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>
    <span class="n">extract</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="mi">37248</span><span class="p">,</span> <span class="mi">3720</span><span class="p">,</span> <span class="nv">$outfile</span><span class="p">);</span>
    <span class="n">verify</span><span class="p">(</span><span class="nv">$outfile</span><span class="p">,</span> <span class="nv">$hasho</span><span class="p">);</span>
    <span class="nv">$outfile</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">lme2510c_s7395_old</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$sourcefile</span> <span class="o">=</span> <span class="s">&quot;LMEBDA_DVBS7395C.sys&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;7572ae0eb9cdf91baabd7c0ba9e09b31&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$outfile</span> <span class="o">=</span> <span class="s">&quot;dvb-usb-lme2510c-s7395.fw&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hasho</span> <span class="o">=</span> <span class="s">&quot;90430c5b435eb5c6f88fd44a9d950674&quot;</span><span class="p">;</span>

    <span class="n">checkstandard</span><span class="p">();</span>

    <span class="n">verify</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>
    <span class="n">extract</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="mi">4208</span><span class="p">,</span> <span class="mi">3881</span><span class="p">,</span> <span class="nv">$outfile</span><span class="p">);</span>
    <span class="n">verify</span><span class="p">(</span><span class="nv">$outfile</span><span class="p">,</span> <span class="nv">$hasho</span><span class="p">);</span>
    <span class="nv">$outfile</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">drxk</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://l4m-daten.de/files/&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$zipfile</span> <span class="o">=</span> <span class="s">&quot;DDTuner.zip&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;f5a37b9a20a3534997997c0b1382a3e5&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$tmpdir</span> <span class="o">=</span> <span class="n">tempdir</span><span class="p">(</span><span class="n">DIR</span> <span class="o">=&gt;</span> <span class="s">&quot;/tmp&quot;</span><span class="p">,</span> <span class="n">CLEANUP</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">my</span> <span class="nv">$drvfile</span> <span class="o">=</span> <span class="s">&quot;DDTuner.sys&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$fwfile</span> <span class="o">=</span> <span class="s">&quot;drxk_a3.mc&quot;</span><span class="p">;</span>

    <span class="n">checkstandard</span><span class="p">();</span>

    <span class="n">wgetfile</span><span class="p">(</span><span class="nv">$zipfile</span><span class="p">,</span> <span class="nv">$url</span> <span class="o">.</span> <span class="nv">$zipfile</span><span class="p">);</span>
    <span class="n">verify</span><span class="p">(</span><span class="nv">$zipfile</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>
    <span class="n">unzip</span><span class="p">(</span><span class="nv">$zipfile</span><span class="p">,</span> <span class="nv">$tmpdir</span><span class="p">);</span>
    <span class="n">extract</span><span class="p">(</span><span class="s">&quot;$tmpdir/$drvfile&quot;</span><span class="p">,</span> <span class="mh">0x14dd8</span><span class="p">,</span> <span class="mi">15634</span><span class="p">,</span> <span class="s">&quot;$fwfile&quot;</span><span class="p">);</span>

    <span class="s">&quot;$fwfile&quot;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">drxk_hauppauge_hvr930c</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://www.wintvcd.co.uk/drivers/&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$zipfile</span> <span class="o">=</span> <span class="s">&quot;HVR-9x0_5_10_325_28153_SIGNED.zip&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;83ab82e7e9480ec8bf1ae0155ca63c88&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$tmpdir</span> <span class="o">=</span> <span class="n">tempdir</span><span class="p">(</span><span class="n">DIR</span> <span class="o">=&gt;</span> <span class="s">&quot;/tmp&quot;</span><span class="p">,</span> <span class="n">CLEANUP</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">my</span> <span class="nv">$drvfile</span> <span class="o">=</span> <span class="s">&quot;HVR-900/emOEM.sys&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$fwfile</span> <span class="o">=</span> <span class="s">&quot;dvb-usb-hauppauge-hvr930c-drxk.fw&quot;</span><span class="p">;</span>

    <span class="n">checkstandard</span><span class="p">();</span>

    <span class="n">wgetfile</span><span class="p">(</span><span class="nv">$zipfile</span><span class="p">,</span> <span class="nv">$url</span> <span class="o">.</span> <span class="nv">$zipfile</span><span class="p">);</span>
    <span class="n">verify</span><span class="p">(</span><span class="nv">$zipfile</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>
    <span class="n">unzip</span><span class="p">(</span><span class="nv">$zipfile</span><span class="p">,</span> <span class="nv">$tmpdir</span><span class="p">);</span>
    <span class="n">extract</span><span class="p">(</span><span class="s">&quot;$tmpdir/$drvfile&quot;</span><span class="p">,</span> <span class="mh">0x117b0</span><span class="p">,</span> <span class="mi">42692</span><span class="p">,</span> <span class="s">&quot;$fwfile&quot;</span><span class="p">);</span>

    <span class="s">&quot;$fwfile&quot;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">drxk_terratec_h5</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://www.linuxtv.org/downloads/firmware/&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;19000dada8e2741162ccc50cc91fa7f1&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$fwfile</span> <span class="o">=</span> <span class="s">&quot;dvb-usb-terratec-h5-drxk.fw&quot;</span><span class="p">;</span>

    <span class="n">checkstandard</span><span class="p">();</span>

    <span class="n">wgetfile</span><span class="p">(</span><span class="nv">$fwfile</span><span class="p">,</span> <span class="nv">$url</span> <span class="o">.</span> <span class="nv">$fwfile</span><span class="p">);</span>
    <span class="n">verify</span><span class="p">(</span><span class="nv">$fwfile</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>

    <span class="s">&quot;$fwfile&quot;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">it9135</span> <span class="p">{</span>
	<span class="k">my</span> <span class="nv">$sourcefile</span> <span class="o">=</span> <span class="s">&quot;dvb-usb-it9135.zip&quot;</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://www.ite.com.tw/uploads/firmware/v3.6.0.0/$sourcefile&quot;</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;1e55f6c8833f1d0ae067c2bb2953e6a9&quot;</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$tmpdir</span> <span class="o">=</span> <span class="n">tempdir</span><span class="p">(</span><span class="n">DIR</span> <span class="o">=&gt;</span> <span class="s">&quot;/tmp&quot;</span><span class="p">,</span> <span class="n">CLEANUP</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">my</span> <span class="nv">$outfile</span> <span class="o">=</span> <span class="s">&quot;dvb-usb-it9135.fw&quot;</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$fwfile1</span> <span class="o">=</span> <span class="s">&quot;dvb-usb-it9135-01.fw&quot;</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$fwfile2</span> <span class="o">=</span> <span class="s">&quot;dvb-usb-it9135-02.fw&quot;</span><span class="p">;</span>

	<span class="n">checkstandard</span><span class="p">();</span>

	<span class="n">wgetfile</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
	<span class="n">unzip</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$tmpdir</span><span class="p">);</span>
	<span class="n">verify</span><span class="p">(</span><span class="s">&quot;$tmpdir/$outfile&quot;</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>
	<span class="n">extract</span><span class="p">(</span><span class="s">&quot;$tmpdir/$outfile&quot;</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">8128</span><span class="p">,</span> <span class="s">&quot;$fwfile1&quot;</span><span class="p">);</span>
	<span class="n">extract</span><span class="p">(</span><span class="s">&quot;$tmpdir/$outfile&quot;</span><span class="p">,</span> <span class="mi">12866</span><span class="p">,</span> <span class="mi">5817</span><span class="p">,</span> <span class="s">&quot;$fwfile2&quot;</span><span class="p">);</span>

	<span class="s">&quot;$fwfile1 $fwfile2&quot;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">it9137</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;http://kworld.server261.com/kworld/CD/ITE_TiVme/V1.00/&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$zipfile</span> <span class="o">=</span> <span class="s">&quot;Driver_V10.323.1.0412.100412.zip&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;79b597dc648698ed6820845c0c9d0d37&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$tmpdir</span> <span class="o">=</span> <span class="n">tempdir</span><span class="p">(</span><span class="n">DIR</span> <span class="o">=&gt;</span> <span class="s">&quot;/tmp&quot;</span><span class="p">,</span> <span class="n">CLEANUP</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">my</span> <span class="nv">$drvfile</span> <span class="o">=</span> <span class="s">&quot;Driver_V10.323.1.0412.100412/Data/x86/IT9135BDA.sys&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$fwfile</span> <span class="o">=</span> <span class="s">&quot;dvb-usb-it9137-01.fw&quot;</span><span class="p">;</span>

    <span class="n">checkstandard</span><span class="p">();</span>

    <span class="n">wgetfile</span><span class="p">(</span><span class="nv">$zipfile</span><span class="p">,</span> <span class="nv">$url</span> <span class="o">.</span> <span class="nv">$zipfile</span><span class="p">);</span>
    <span class="n">verify</span><span class="p">(</span><span class="nv">$zipfile</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>
    <span class="n">unzip</span><span class="p">(</span><span class="nv">$zipfile</span><span class="p">,</span> <span class="nv">$tmpdir</span><span class="p">);</span>
    <span class="n">extract</span><span class="p">(</span><span class="s">&quot;$tmpdir/$drvfile&quot;</span><span class="p">,</span> <span class="mi">69632</span><span class="p">,</span> <span class="mi">5731</span><span class="p">,</span> <span class="s">&quot;$fwfile&quot;</span><span class="p">);</span>

    <span class="s">&quot;$fwfile&quot;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">tda10071</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$sourcefile</span> <span class="o">=</span> <span class="s">&quot;PCTV_460e_reference.zip&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;ftp://ftp.pctvsystems.com/TV/driver/PCTV%2070e%2080e%20100e%20320e%20330e%20800e/&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;4403de903bf2593464c8d74bbc200a57&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$fwfile</span> <span class="o">=</span> <span class="s">&quot;dvb-fe-tda10071.fw&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$tmpdir</span> <span class="o">=</span> <span class="n">tempdir</span><span class="p">(</span><span class="n">DIR</span> <span class="o">=&gt;</span> <span class="s">&quot;/tmp&quot;</span><span class="p">,</span> <span class="n">CLEANUP</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">checkstandard</span><span class="p">();</span>

    <span class="n">wgetfile</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$url</span> <span class="o">.</span> <span class="nv">$sourcefile</span><span class="p">);</span>
    <span class="n">verify</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>
    <span class="n">unzip</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$tmpdir</span><span class="p">);</span>
    <span class="n">extract</span><span class="p">(</span><span class="s">&quot;$tmpdir/PCTV\ 70e\ 80e\ 100e\ 320e\ 330e\ 800e/32\ bit/emOEM.sys&quot;</span><span class="p">,</span> <span class="mh">0x67d38</span><span class="p">,</span> <span class="mi">40504</span><span class="p">,</span> <span class="nv">$fwfile</span><span class="p">);</span>

    <span class="s">&quot;$fwfile&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">drxk_pctv</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$sourcefile</span> <span class="o">=</span> <span class="s">&quot;PCTV_460e_reference.zip&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="s">&quot;ftp://ftp.pctvsystems.com/TV/driver/PCTV%2070e%2080e%20100e%20320e%20330e%20800e/&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s">&quot;4403de903bf2593464c8d74bbc200a57&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$fwfile</span> <span class="o">=</span> <span class="s">&quot;dvb-demod-drxk-pctv.fw&quot;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$tmpdir</span> <span class="o">=</span> <span class="n">tempdir</span><span class="p">(</span><span class="n">DIR</span> <span class="o">=&gt;</span> <span class="s">&quot;/tmp&quot;</span><span class="p">,</span> <span class="n">CLEANUP</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">checkstandard</span><span class="p">();</span>

    <span class="n">wgetfile</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$url</span> <span class="o">.</span> <span class="nv">$sourcefile</span><span class="p">);</span>
    <span class="n">verify</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>
    <span class="n">unzip</span><span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$tmpdir</span><span class="p">);</span>
    <span class="n">extract</span><span class="p">(</span><span class="s">&quot;$tmpdir/PCTV\ 70e\ 80e\ 100e\ 320e\ 330e\ 800e/32\ bit/emOEM.sys&quot;</span><span class="p">,</span> <span class="mh">0x72b80</span><span class="p">,</span> <span class="mi">42692</span><span class="p">,</span> <span class="nv">$fwfile</span><span class="p">);</span>

    <span class="s">&quot;$fwfile&quot;</span><span class="p">;</span>
<span class="p">}</span></pre></div></td></tr>


<tr id="section-9"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-9">&#182;</a></div><hr />

<p>Utilities</p></td><td class="code"><div class="highlight"><pre><span class="k">sub </span><span class="nf">checkstandard</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">system</span><span class="p">(</span><span class="s">&quot;which unzip &gt; /dev/null 2&gt;&amp;1&quot;</span><span class="p">))</span> <span class="p">{</span>
	<span class="nb">die</span> <span class="s">&quot;This firmware requires the unzip command - see ftp://ftp.info-zip.org/pub/infozip/UnZip.html\n&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">system</span><span class="p">(</span><span class="s">&quot;which md5sum &gt; /dev/null 2&gt;&amp;1&quot;</span><span class="p">))</span> <span class="p">{</span>
	<span class="nb">die</span> <span class="s">&quot;This firmware requires the md5sum command - see http://www.gnu.org/software/coreutils/\n&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">system</span><span class="p">(</span><span class="s">&quot;which wget &gt; /dev/null 2&gt;&amp;1&quot;</span><span class="p">))</span> <span class="p">{</span>
	<span class="nb">die</span> <span class="s">&quot;This firmware requires the wget command - see http://wget.sunsite.dk/\n&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">checkunshield</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">system</span><span class="p">(</span><span class="s">&quot;which unshield &gt; /dev/null 2&gt;&amp;1&quot;</span><span class="p">))</span> <span class="p">{</span>
	<span class="nb">die</span> <span class="s">&quot;This firmware requires the unshield command - see http://sourceforge.net/projects/synce/\n&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">wgetfile</span> <span class="p">{</span>
    <span class="k">my</span> <span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$url</span><span class="p">)</span> <span class="o">=</span> <span class="nv">@_</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="o">-</span><span class="n">f</span> <span class="nv">$sourcefile</span><span class="p">)</span> <span class="p">{</span>
	<span class="nb">system</span><span class="p">(</span><span class="s">&quot;wget -O \&quot;$sourcefile\&quot; \&quot;$url\&quot;&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">die</span> <span class="s">&quot;wget failed - unable to download firmware&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">unzip</span> <span class="p">{</span>
    <span class="k">my</span> <span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$todir</span><span class="p">)</span> <span class="o">=</span> <span class="nv">@_</span><span class="p">;</span>

    <span class="nv">$status</span> <span class="o">=</span> <span class="nb">system</span><span class="p">(</span><span class="s">&quot;unzip -q -o -d \&quot;$todir\&quot; \&quot;$sourcefile\&quot; 2&gt;/dev/null&quot;</span> <span class="p">);</span>
    <span class="k">if</span> <span class="p">(((</span><span class="nv">$status</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">||</span> <span class="p">((</span><span class="nv">$status</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
	<span class="nb">die</span> <span class="p">(</span><span class="s">&quot;unzip failed - unable to extract firmware&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">unshield</span> <span class="p">{</span>
    <span class="k">my</span> <span class="p">(</span><span class="nv">$sourcefile</span><span class="p">,</span> <span class="nv">$todir</span><span class="p">)</span> <span class="o">=</span> <span class="nv">@_</span><span class="p">;</span>

    <span class="nb">system</span><span class="p">(</span><span class="s">&quot;unshield x -d \&quot;$todir\&quot; \&quot;$sourcefile\&quot; &gt; /dev/null&quot;</span> <span class="p">)</span> <span class="ow">and</span> <span class="nb">die</span> <span class="p">(</span><span class="s">&quot;unshield failed - unable to extract firmware&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">verify</span> <span class="p">{</span>
    <span class="k">my</span> <span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">)</span> <span class="o">=</span> <span class="nv">@_</span><span class="p">;</span>
    <span class="k">my</span> <span class="p">(</span><span class="nv">$testhash</span><span class="p">);</span>

    <span class="nb">open</span><span class="p">(</span><span class="n">CMD</span><span class="p">,</span> <span class="s">&quot;md5sum \&quot;$filename\&quot;|&quot;</span><span class="p">);</span>
    <span class="nv">$testhash</span> <span class="o">=</span> <span class="sr">&lt;CMD&gt;</span><span class="p">;</span>
    <span class="nv">$testhash</span> <span class="o">=~</span><span class="sr"> /([a-zA-Z0-9]*)/</span><span class="p">;</span>
    <span class="nv">$testhash</span> <span class="o">=</span> <span class="nv">$1</span><span class="p">;</span>
    <span class="nb">close</span> <span class="n">CMD</span><span class="p">;</span>
    <span class="nb">die</span> <span class="s">&quot;Hash of extracted file does not match!\n&quot;</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$testhash</span> <span class="ow">ne</span> <span class="nv">$hash</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">copy</span> <span class="p">{</span>
    <span class="k">my</span> <span class="p">(</span><span class="nv">$from</span><span class="p">,</span> <span class="nv">$to</span><span class="p">)</span> <span class="o">=</span> <span class="nv">@_</span><span class="p">;</span>

    <span class="nb">system</span><span class="p">(</span><span class="s">&quot;cp -f \&quot;$from\&quot; \&quot;$to\&quot;&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">die</span> <span class="p">(</span><span class="s">&quot;cp failed&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">extract</span> <span class="p">{</span>
    <span class="k">my</span> <span class="p">(</span><span class="nv">$infile</span><span class="p">,</span> <span class="nv">$offset</span><span class="p">,</span> <span class="nv">$length</span><span class="p">,</span> <span class="nv">$outfile</span><span class="p">)</span> <span class="o">=</span> <span class="nv">@_</span><span class="p">;</span>
    <span class="k">my</span> <span class="p">(</span><span class="nv">$chunklength</span><span class="p">,</span> <span class="nv">$buf</span><span class="p">,</span> <span class="nv">$rcount</span><span class="p">);</span>

    <span class="nb">open</span> <span class="n">INFILE</span><span class="p">,</span> <span class="s">&quot;&lt;$infile&quot;</span><span class="p">;</span>
    <span class="nb">open</span> <span class="n">OUTFILE</span><span class="p">,</span> <span class="s">&quot;&gt;$outfile&quot;</span><span class="p">;</span>
    <span class="nb">sysseek</span><span class="p">(</span><span class="n">INFILE</span><span class="p">,</span> <span class="nv">$offset</span><span class="p">,</span> <span class="n">SEEK_SET</span><span class="p">);</span>
    <span class="k">while</span><span class="p">(</span><span class="nv">$length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span></pre></div></td></tr>


<tr id="section-10"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-10">&#182;</a></div><p>Calc chunk size</p></td><td class="code"><div class="highlight"><pre>	<span class="nv">$chunklength</span> <span class="o">=</span> <span class="mi">2048</span><span class="p">;</span>
	<span class="nv">$chunklength</span> <span class="o">=</span> <span class="nv">$length</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$chunklength</span> <span class="o">&gt;</span> <span class="nv">$length</span><span class="p">);</span>

	<span class="nv">$rcount</span> <span class="o">=</span> <span class="nb">sysread</span><span class="p">(</span><span class="n">INFILE</span><span class="p">,</span> <span class="nv">$buf</span><span class="p">,</span> <span class="nv">$chunklength</span><span class="p">);</span>
	<span class="nb">die</span> <span class="s">&quot;Ran out of data\n&quot;</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$rcount</span> <span class="o">!=</span> <span class="nv">$chunklength</span><span class="p">);</span>
	<span class="nb">syswrite</span><span class="p">(</span><span class="n">OUTFILE</span><span class="p">,</span> <span class="nv">$buf</span><span class="p">);</span>
	<span class="nv">$length</span> <span class="o">-=</span> <span class="nv">$rcount</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nb">close</span> <span class="n">INFILE</span><span class="p">;</span>
    <span class="nb">close</span> <span class="n">OUTFILE</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">appendfile</span> <span class="p">{</span>
    <span class="k">my</span> <span class="p">(</span><span class="nv">$FH</span><span class="p">,</span> <span class="nv">$infile</span><span class="p">)</span> <span class="o">=</span> <span class="nv">@_</span><span class="p">;</span>
    <span class="k">my</span> <span class="p">(</span><span class="nv">$buf</span><span class="p">);</span>

    <span class="nb">open</span> <span class="n">INFILE</span><span class="p">,</span> <span class="s">&quot;&lt;$infile&quot;</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
	<span class="nv">$rcount</span> <span class="o">=</span> <span class="nb">sysread</span><span class="p">(</span><span class="n">INFILE</span><span class="p">,</span> <span class="nv">$buf</span><span class="p">,</span> <span class="mi">2048</span><span class="p">);</span>
	<span class="k">last</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$rcount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">print</span> <span class="nv">$FH</span> <span class="nv">$buf</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nb">close</span><span class="p">(</span><span class="n">INFILE</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">delzero</span><span class="p">{</span>
	<span class="k">my</span> <span class="p">(</span><span class="nv">$infile</span><span class="p">,</span><span class="nv">$outfile</span><span class="p">)</span> <span class="o">=</span><span class="nv">@_</span><span class="p">;</span>

	<span class="nb">open</span> <span class="n">INFILE</span><span class="p">,</span><span class="s">&quot;&lt;$infile&quot;</span><span class="p">;</span>
	<span class="nb">open</span> <span class="n">OUTFILE</span><span class="p">,</span><span class="s">&quot;&gt;$outfile&quot;</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">){</span>
		<span class="nv">$rcount</span><span class="o">=</span><span class="nb">sysread</span><span class="p">(</span><span class="n">INFILE</span><span class="p">,</span><span class="nv">$buf</span><span class="p">,</span><span class="mi">22</span><span class="p">);</span>
		<span class="nv">$len</span><span class="o">=</span><span class="nb">ord</span><span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$buf</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">));</span>
		<span class="k">print</span> <span class="n">OUTFILE</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$buf</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
		<span class="k">print</span> <span class="n">OUTFILE</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$buf</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="nv">$len</span><span class="o">+</span><span class="mi">3</span><span class="p">);</span>
	<span class="k">last</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$rcount</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">);</span>
	<span class="nb">printf</span> <span class="n">OUTFILE</span> <span class="s">&quot;%c&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-11"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-11">&#182;</a></div><p>print $len." ".length($buf)."\n";</p></td><td class="code"><div class="highlight"><pre>	<span class="p">}</span>
	<span class="nb">close</span><span class="p">(</span><span class="n">INFILE</span><span class="p">);</span>
	<span class="nb">close</span><span class="p">(</span><span class="n">OUTFILE</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">syntax</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">print</span> <span class="bp">STDERR</span> <span class="s">&quot;syntax: get_dvb_firmware &lt;component&gt;\n&quot;</span><span class="p">;</span>
    <span class="k">print</span> <span class="bp">STDERR</span> <span class="s">&quot;Supported components:\n&quot;</span><span class="p">;</span>
    <span class="nv">@components</span> <span class="o">=</span> <span class="nb">sort</span> <span class="nv">@components</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nb">scalar</span><span class="p">(</span><span class="nv">@components</span><span class="p">);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">print</span> <span class="bp">STDERR</span> <span class="s">&quot;\t&quot;</span> <span class="o">.</span> <span class="nv">$components</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">.</span> <span class="s">&quot;\n&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
