<!DOCTYPE html>
<html><head><title>joekychen/linux » scripts › tags.sh

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../index.html"></a><h1>tags.sh</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="c">#!/bin/sh</span></pre></div></td></tr>


<tr id="section-2"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-2">&#182;</a></div><p>Generate tags or cscope files
Usage tags.sh <mode></p>

<p>mode may be any of: tags, TAGS, cscope</p>

<p>Uses the following environment variables:
ARCH, SUBARCH, SRCARCH, srctree, src, obj</p></td><td class="code"><div class="highlight"><pre><span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;$KBUILD_VERBOSE&quot;</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span> <span class="o">]</span>; <span class="k">then</span>
<span class="k">	</span><span class="nb">set</span> -x
<span class="k">fi</span></pre></div></td></tr>


<tr id="section-3"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-3">&#182;</a></div><p>This is a duplicate of RCS<em>FIND</em>IGNORE without escaped '()'</p></td><td class="code"><div class="highlight"><pre><span class="nv">ignore</span><span class="o">=</span><span class="s2">&quot;( -name SCCS -o -name BitKeeper -o -name .svn -o \</span>
<span class="s2">          -name CVS  -o -name .pc       -o -name .hg  -o \</span>
<span class="s2">          -name .git )                                   \</span>
<span class="s2">          -prune -o&quot;</span></pre></div></td></tr>


<tr id="section-4"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-4">&#182;</a></div><p>Do not use full path if we do not use O=.. builds
Use make O=. {tags|cscope}
to force full paths for a non-O= build</p></td><td class="code"><div class="highlight"><pre><span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;${KBUILD_SRC}&quot;</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="o">]</span>; <span class="k">then</span>
<span class="k">	</span><span class="nv">tree</span><span class="o">=</span>
<span class="k">else</span>
<span class="k">	</span><span class="nv">tree</span><span class="o">=</span><span class="k">${</span><span class="nv">srctree</span><span class="k">}</span>/
<span class="k">fi</span></pre></div></td></tr>


<tr id="section-5"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-5">&#182;</a></div><p>Find all available archs</p></td><td class="code"><div class="highlight"><pre>find_all_archs<span class="o">()</span>
<span class="o">{</span>
	<span class="nv">ALLSOURCE_ARCHS</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
	<span class="k">for </span>arch in <span class="sb">`</span>ls <span class="k">${</span><span class="nv">tree</span><span class="k">}</span>arch<span class="sb">`</span>; <span class="k">do</span>
<span class="k">		</span><span class="nv">ALLSOURCE_ARCHS</span><span class="o">=</span><span class="s2">&quot;${ALLSOURCE_ARCHS} &quot;</span><span class="k">${</span><span class="nv">arch</span><span class="p">##\/</span><span class="k">}</span>
	<span class="k">done</span>
<span class="o">}</span></pre></div></td></tr>


<tr id="section-6"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-6">&#182;</a></div><p>Detect if ALLSOURCE_ARCHS is set. If not, we assume SRCARCH</p></td><td class="code"><div class="highlight"><pre><span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;${ALLSOURCE_ARCHS}&quot;</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="o">]</span>; <span class="k">then</span>
<span class="k">	</span><span class="nv">ALLSOURCE_ARCHS</span><span class="o">=</span><span class="k">${</span><span class="nv">SRCARCH</span><span class="k">}</span>
<span class="k">elif</span> <span class="o">[</span> <span class="s2">&quot;${ALLSOURCE_ARCHS}&quot;</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span> <span class="o">]</span>; <span class="k">then</span>
<span class="k">	</span>find_all_archs
<span class="k">fi</span></pre></div></td></tr>


<tr id="section-7"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-7">&#182;</a></div><p>find sources in arch/$ARCH</p></td><td class="code"><div class="highlight"><pre>find_arch_sources<span class="o">()</span>
<span class="o">{</span>
	<span class="k">for </span>i in <span class="nv">$archincludedir</span>; <span class="k">do</span>
<span class="k">		</span><span class="nv">prune</span><span class="o">=</span><span class="s2">&quot;$prune -wholename $i -prune -o&quot;</span>
	<span class="k">done</span>
<span class="k">	</span>find <span class="k">${</span><span class="nv">tree</span><span class="k">}</span>arch/<span class="nv">$1</span> <span class="nv">$ignore</span> <span class="nv">$prune</span> -name <span class="s2">&quot;$2&quot;</span> -print;
<span class="o">}</span></pre></div></td></tr>


<tr id="section-8"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-8">&#182;</a></div><p>find sources in arch/$1/include</p></td><td class="code"><div class="highlight"><pre>find_arch_include_sources<span class="o">()</span>
<span class="o">{</span>
	<span class="nv">include</span><span class="o">=</span><span class="k">$(</span>find <span class="k">${</span><span class="nv">tree</span><span class="k">}</span>arch/<span class="nv">$1</span>/ -name include -type d<span class="k">)</span>;
	<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&quot;$include&quot;</span> <span class="o">]</span>; <span class="k">then</span>
<span class="k">		</span><span class="nv">archincludedir</span><span class="o">=</span><span class="s2">&quot;$archincludedir $include&quot;</span>
		find <span class="nv">$include</span> <span class="nv">$ignore</span> -name <span class="s2">&quot;$2&quot;</span> -print;
	<span class="k">fi</span>
<span class="o">}</span></pre></div></td></tr>


<tr id="section-9"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-9">&#182;</a></div><p>find sources in include/</p></td><td class="code"><div class="highlight"><pre>find_include_sources<span class="o">()</span>
<span class="o">{</span>
	find <span class="k">${</span><span class="nv">tree</span><span class="k">}</span>include <span class="nv">$ignore</span> -name config -prune -o -name <span class="s2">&quot;$1&quot;</span> -print;
<span class="o">}</span></pre></div></td></tr>


<tr id="section-10"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-10">&#182;</a></div><p>find sources in rest of tree
we could benefit from a list of dirs to search in here</p></td><td class="code"><div class="highlight"><pre>find_other_sources<span class="o">()</span>
<span class="o">{</span>
	find <span class="k">${</span><span class="nv">tree</span><span class="k">}</span>* <span class="nv">$ignore</span> <span class="se">\</span>
	     <span class="se">\(</span> -name include -o -name arch -o -name <span class="s1">&#39;.tmp_*&#39;</span> <span class="se">\)</span> -prune -o <span class="se">\</span>
	       -name <span class="s2">&quot;$1&quot;</span> -print;
<span class="o">}</span>

find_sources<span class="o">()</span>
<span class="o">{</span>
	find_arch_sources <span class="nv">$1</span> <span class="s2">&quot;$2&quot;</span>
<span class="o">}</span>

all_sources<span class="o">()</span>
<span class="o">{</span>
	find_arch_include_sources <span class="k">${</span><span class="nv">SRCARCH</span><span class="k">}</span> <span class="s1">&#39;*.[chS]&#39;</span>
	<span class="k">if</span> <span class="o">[</span> ! -z <span class="s2">&quot;$archinclude&quot;</span> <span class="o">]</span>; <span class="k">then</span>
<span class="k">		</span>find_arch_include_sources <span class="nv">$archinclude</span> <span class="s1">&#39;*.[chS]&#39;</span>
	<span class="k">fi</span>
<span class="k">	</span>find_include_sources <span class="s1">&#39;*.[chS]&#39;</span>
	<span class="k">for </span>arch in <span class="nv">$ALLSOURCE_ARCHS</span>
	<span class="k">do</span>
<span class="k">		</span>find_sources <span class="nv">$arch</span> <span class="s1">&#39;*.[chS]&#39;</span>
	<span class="k">done</span>
<span class="k">	</span>find_other_sources <span class="s1">&#39;*.[chS]&#39;</span>
<span class="o">}</span>

all_kconfigs<span class="o">()</span>
<span class="o">{</span>
	<span class="k">for </span>arch in <span class="nv">$ALLSOURCE_ARCHS</span>; <span class="k">do</span>
<span class="k">		</span>find_sources <span class="nv">$arch</span> <span class="s1">&#39;Kconfig*&#39;</span>
	<span class="k">done</span>
<span class="k">	</span>find_other_sources <span class="s1">&#39;Kconfig*&#39;</span>
<span class="o">}</span>

all_defconfigs<span class="o">()</span>
<span class="o">{</span>
	find_sources <span class="nv">$ALLSOURCE_ARCHS</span> <span class="s2">&quot;defconfig&quot;</span>
<span class="o">}</span>

docscope<span class="o">()</span>
<span class="o">{</span>
	<span class="o">(</span><span class="nb">echo</span> <span class="se">\-</span>k; <span class="nb">echo</span> <span class="se">\-</span>q; all_sources<span class="o">)</span> &gt; cscope.files
	cscope -b -f cscope.out
<span class="o">}</span>

dogtags<span class="o">()</span>
<span class="o">{</span>
	all_sources | gtags -i -f -
<span class="o">}</span>

exuberant<span class="o">()</span>
<span class="o">{</span>
	all_sources | xargs <span class="nv">$1</span> -a                               <span class="se">\</span>
	-I __initdata,__exitdata,__acquires,__releases          <span class="se">\</span>
	-I __read_mostly,____cacheline_aligned                  <span class="se">\</span>
	-I ____cacheline_aligned_in_smp                         <span class="se">\</span>
	-I ____cacheline_internodealigned_in_smp                <span class="se">\</span>
	-I EXPORT_SYMBOL,EXPORT_SYMBOL_GPL                      <span class="se">\</span>
	-I DEFINE_TRACE,EXPORT_TRACEPOINT_SYMBOL,EXPORT_TRACEPOINT_SYMBOL_GPL <span class="se">\</span>
	--extra<span class="o">=</span>+f --c-kinds<span class="o">=</span>+px                                <span class="se">\</span>
	--regex-asm<span class="o">=</span><span class="s1">&#39;/^(ENTRY|_GLOBAL)\(([^)]*)\).*/\2/&#39;</span>        <span class="se">\</span>
	--regex-c<span class="o">=</span><span class="s1">&#39;/^SYSCALL_DEFINE[[:digit:]]?\(([^,)]*).*/sys_\1/&#39;</span> <span class="se">\</span>
	--regex-c++<span class="o">=</span><span class="s1">&#39;/^TRACE_EVENT\(([^,)]*).*/trace_\1/&#39;</span>		<span class="se">\</span>
	--regex-c++<span class="o">=</span><span class="s1">&#39;/^DEFINE_EVENT\([^,)]*, *([^,)]*).*/trace_\1/&#39;</span>	<span class="se">\</span>
	--regex-c++<span class="o">=</span><span class="s1">&#39;/PAGEFLAG\(([^,)]*).*/Page\1/&#39;</span>			<span class="se">\</span>
	--regex-c++<span class="o">=</span><span class="s1">&#39;/PAGEFLAG\(([^,)]*).*/SetPage\1/&#39;</span>			<span class="se">\</span>
	--regex-c++<span class="o">=</span><span class="s1">&#39;/PAGEFLAG\(([^,)]*).*/ClearPage\1/&#39;</span>		<span class="se">\</span>
	--regex-c++<span class="o">=</span><span class="s1">&#39;/TESTSETFLAG\(([^,)]*).*/TestSetPage\1/&#39;</span>		<span class="se">\</span>
	--regex-c++<span class="o">=</span><span class="s1">&#39;/TESTPAGEFLAG\(([^,)]*).*/Page\1/&#39;</span>			<span class="se">\</span>
	--regex-c++<span class="o">=</span><span class="s1">&#39;/SETPAGEFLAG\(([^,)]*).*/SetPage\1/&#39;</span>		<span class="se">\</span>
	--regex-c++<span class="o">=</span><span class="s1">&#39;/__SETPAGEFLAG\(([^,)]*).*/__SetPage\1/&#39;</span>		<span class="se">\</span>
	--regex-c++<span class="o">=</span><span class="s1">&#39;/TESTCLEARFLAG\(([^,)]*).*/TestClearPage\1/&#39;</span>	<span class="se">\</span>
	--regex-c++<span class="o">=</span><span class="s1">&#39;/__TESTCLEARFLAG\(([^,)]*).*/TestClearPage\1/&#39;</span>	<span class="se">\</span>
	--regex-c++<span class="o">=</span><span class="s1">&#39;/CLEARPAGEFLAG\(([^,)]*).*/ClearPage\1/&#39;</span>		<span class="se">\</span>
	--regex-c++<span class="o">=</span><span class="s1">&#39;/__CLEARPAGEFLAG\(([^,)]*).*/__ClearPage\1/&#39;</span>	<span class="se">\</span>
	--regex-c++<span class="o">=</span><span class="s1">&#39;/__PAGEFLAG\(([^,)]*).*/__SetPage\1/&#39;</span>		<span class="se">\</span>
	--regex-c++<span class="o">=</span><span class="s1">&#39;/__PAGEFLAG\(([^,)]*).*/__ClearPage\1/&#39;</span>		<span class="se">\</span>
	--regex-c++<span class="o">=</span><span class="s1">&#39;/PAGEFLAG_FALSE\(([^,)]*).*/Page\1/&#39;</span>		<span class="se">\</span>
	--regex-c++<span class="o">=</span><span class="s1">&#39;/TESTSCFLAG\(([^,)]*).*/TestSetPage\1/&#39;</span>		<span class="se">\</span>
	--regex-c++<span class="o">=</span><span class="s1">&#39;/TESTSCFLAG\(([^,)]*).*/TestClearPage\1/&#39;</span>		<span class="se">\</span>
	--regex-c++<span class="o">=</span><span class="s1">&#39;/SETPAGEFLAG_NOOP\(([^,)]*).*/SetPage\1/&#39;</span>		<span class="se">\</span>
	--regex-c++<span class="o">=</span><span class="s1">&#39;/CLEARPAGEFLAG_NOOP\(([^,)]*).*/ClearPage\1/&#39;</span>	<span class="se">\</span>
	--regex-c++<span class="o">=</span><span class="s1">&#39;/__CLEARPAGEFLAG_NOOP\(([^,)]*).*/__ClearPage\1/&#39;</span>	<span class="se">\</span>
	--regex-c++<span class="o">=</span><span class="s1">&#39;/TESTCLEARFLAG_FALSE\(([^,)]*).*/TestClearPage\1/&#39;</span> <span class="se">\</span>
	--regex-c++<span class="o">=</span><span class="s1">&#39;/__TESTCLEARFLAG_FALSE\(([^,)]*).*/__TestClearPage\1/&#39;</span>

	all_kconfigs | xargs <span class="nv">$1</span> -a                              <span class="se">\</span>
	--langdef<span class="o">=</span>kconfig --language-force<span class="o">=</span>kconfig              <span class="se">\</span>
	--regex-kconfig<span class="o">=</span><span class="s1">&#39;/^[[:blank:]]*(menu|)config[[:blank:]]+([[:alnum:]_]+)/\2/&#39;</span>

	all_kconfigs | xargs <span class="nv">$1</span> -a                              <span class="se">\</span>
	--langdef<span class="o">=</span>kconfig --language-force<span class="o">=</span>kconfig              <span class="se">\</span>
	--regex-kconfig<span class="o">=</span><span class="s1">&#39;/^[[:blank:]]*(menu|)config[[:blank:]]+([[:alnum:]_]+)/CONFIG_\2/&#39;</span>

	all_defconfigs | xargs -r <span class="nv">$1</span> -a                         <span class="se">\</span>
	--langdef<span class="o">=</span>dotconfig --language-force<span class="o">=</span>dotconfig          <span class="se">\</span>
	--regex-dotconfig<span class="o">=</span><span class="s1">&#39;/^#?[[:blank:]]*(CONFIG_[[:alnum:]_]+)/\1/&#39;</span>
<span class="o">}</span>

emacs<span class="o">()</span>
<span class="o">{</span>
	all_sources | xargs <span class="nv">$1</span> -a                               <span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/^(ENTRY|_GLOBAL)(\([^)]*\)).*/\2/&#39;</span>            <span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/^SYSCALL_DEFINE[0-9]?(\([^,)]*\).*/sys_\1/&#39;</span>   <span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/^TRACE_EVENT(\([^,)]*\).*/trace_\1/&#39;</span>		<span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/^DEFINE_EVENT([^,)]*, *\([^,)]*\).*/trace_\1/&#39;</span> <span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/PAGEFLAG\(([^,)]*).*/Page\1/&#39;</span>			<span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/PAGEFLAG\(([^,)]*).*/SetPage\1/&#39;</span>		<span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/PAGEFLAG\(([^,)]*).*/ClearPage\1/&#39;</span>		<span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/TESTSETFLAG\(([^,)]*).*/TestSetPage\1/&#39;</span>	<span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/TESTPAGEFLAG\(([^,)]*).*/Page\1/&#39;</span>		<span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/SETPAGEFLAG\(([^,)]*).*/SetPage\1/&#39;</span>		<span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/__SETPAGEFLAG\(([^,)]*).*/__SetPage\1/&#39;</span>	<span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/TESTCLEARFLAG\(([^,)]*).*/TestClearPage\1/&#39;</span>	<span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/__TESTCLEARFLAG\(([^,)]*).*/TestClearPage\1/&#39;</span>	<span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/CLEARPAGEFLAG\(([^,)]*).*/ClearPage\1/&#39;</span>	<span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/__CLEARPAGEFLAG\(([^,)]*).*/__ClearPage\1/&#39;</span>	<span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/__PAGEFLAG\(([^,)]*).*/__SetPage\1/&#39;</span>		<span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/__PAGEFLAG\(([^,)]*).*/__ClearPage\1/&#39;</span>	<span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/PAGEFLAG_FALSE\(([^,)]*).*/Page\1/&#39;</span>		<span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/TESTSCFLAG\(([^,)]*).*/TestSetPage\1/&#39;</span>	<span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/TESTSCFLAG\(([^,)]*).*/TestClearPage\1/&#39;</span>	<span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/SETPAGEFLAG_NOOP\(([^,)]*).*/SetPage\1/&#39;</span>	<span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/CLEARPAGEFLAG_NOOP\(([^,)]*).*/ClearPage\1/&#39;</span>	<span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/__CLEARPAGEFLAG_NOOP\(([^,)]*).*/__ClearPage\1/&#39;</span> <span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/TESTCLEARFLAG_FALSE\(([^,)]*).*/TestClearPage\1/&#39;</span> <span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/__TESTCLEARFLAG_FALSE\(([^,)]*).*/__TestClearPage\1/&#39;</span>

	all_kconfigs | xargs <span class="nv">$1</span> -a                              <span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/^[ \t]*\(\(menu\)*config\)[ \t]+\([a-zA-Z0-9_]+\)/\3/&#39;</span>

	all_kconfigs | xargs <span class="nv">$1</span> -a                              <span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/^[ \t]*\(\(menu\)*config\)[ \t]+\([a-zA-Z0-9_]+\)/CONFIG_\3/&#39;</span>

	all_defconfigs | xargs -r <span class="nv">$1</span> -a                         <span class="se">\</span>
	--regex<span class="o">=</span><span class="s1">&#39;/^#?[ \t]?\(CONFIG_[a-zA-Z0-9_]+\)/\1/&#39;</span>
<span class="o">}</span>

xtags<span class="o">()</span>
<span class="o">{</span>
	<span class="k">if</span> <span class="nv">$1</span> --version 2&gt;&amp;1 | grep -iq exuberant; <span class="k">then</span>
<span class="k">		</span>exuberant <span class="nv">$1</span>
	<span class="k">elif</span> <span class="nv">$1</span> --version 2&gt;&amp;1 | grep -iq emacs; <span class="k">then</span>
<span class="k">		</span>emacs <span class="nv">$1</span>
	<span class="k">else</span>
<span class="k">		</span>all_sources | xargs <span class="nv">$1</span> -a
        <span class="k">fi</span>
<span class="o">}</span></pre></div></td></tr>


<tr id="section-11"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-11">&#182;</a></div><p>Support um (which uses SUBARCH)</p></td><td class="code"><div class="highlight"><pre><span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;${ARCH}&quot;</span> <span class="o">=</span> <span class="s2">&quot;um&quot;</span> <span class="o">]</span>; <span class="k">then</span>
<span class="k">	if</span> <span class="o">[</span> <span class="s2">&quot;$SUBARCH&quot;</span> <span class="o">=</span> <span class="s2">&quot;i386&quot;</span> <span class="o">]</span>; <span class="k">then</span>
<span class="k">		</span><span class="nv">archinclude</span><span class="o">=</span>x86
	<span class="k">elif</span> <span class="o">[</span> <span class="s2">&quot;$SUBARCH&quot;</span> <span class="o">=</span> <span class="s2">&quot;x86_64&quot;</span> <span class="o">]</span>; <span class="k">then</span>
<span class="k">		</span><span class="nv">archinclude</span><span class="o">=</span>x86
	<span class="k">else</span>
<span class="k">		</span><span class="nv">archinclude</span><span class="o">=</span><span class="k">${</span><span class="nv">SUBARCH</span><span class="k">}</span>
	<span class="k">fi</span>
<span class="k">fi</span>

<span class="nv">remove_structs</span><span class="o">=</span>
<span class="k">case</span> <span class="s2">&quot;$1&quot;</span> in
	<span class="s2">&quot;cscope&quot;</span><span class="o">)</span>
		docscope
		;;

	<span class="s2">&quot;gtags&quot;</span><span class="o">)</span>
		dogtags
		;;

	<span class="s2">&quot;tags&quot;</span><span class="o">)</span>
		rm -f tags
		xtags ctags
		<span class="nv">remove_structs</span><span class="o">=</span>y
		;;

	<span class="s2">&quot;TAGS&quot;</span><span class="o">)</span>
		rm -f TAGS
		xtags etags
		<span class="nv">remove_structs</span><span class="o">=</span>y
		;;
<span class="k">esac</span></pre></div></td></tr>


<tr id="section-12"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-12">&#182;</a></div><p>Remove structure forward declarations.</p></td><td class="code"><div class="highlight"><pre><span class="k">if</span> <span class="o">[</span> -n <span class="s2">&quot;$remove_structs&quot;</span> <span class="o">]</span>; <span class="k">then</span>
<span class="k">    </span><span class="nv">LANG</span><span class="o">=</span>C sed -i -e <span class="s1">&#39;/^\([a-zA-Z_][a-zA-Z0-9_]*\)\t.*\t\/\^struct \1;.*\$\/;&quot;\tx$/d&#39;</span> <span class="nv">$1</span>
<span class="k">fi</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:1}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../javascript/docco.min.js"></script>
</html>
