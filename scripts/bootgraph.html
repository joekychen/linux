<!DOCTYPE html>
<html><head><title>joekychen/linux » scripts › bootgraph.pl

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../index.html"></a><h1>bootgraph.pl</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="c1">#!/usr/bin/perl</span></pre></div></td></tr>


<tr id="section-2"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-2">&#182;</a></div><p>Copyright 2008, Intel Corporation</p>

<p>This file is part of the Linux kernel</p>

<p>This program file is free software; you can redistribute it and/or modify it
under the terms of the GNU General Public License as published by the
Free Software Foundation; version 2 of the License.</p>

<p>This program is distributed in the hope that it will be useful, but WITHOUT
ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
for more details.</p>

<p>You should have received a copy of the GNU General Public License
along with this program in a file named COPYING; if not, write to the
Free Software Foundation, Inc.,
51 Franklin Street, Fifth Floor,
Boston, MA 02110-1301 USA</p>

<p>Authors:
    Arjan van de Ven <a href="&#109;&#97;&#105;&#108;&#x74;&#111;:&#97;&#114;&#x6A;&#97;&#110;&#64;&#108;&#105;n&#117;x&#x2E;&#105;&#x6E;&#116;&#101;&#108;&#46;&#99;&#x6F;m">&#97;&#114;&#x6A;&#97;&#110;&#64;&#108;&#105;n&#117;x&#x2E;&#105;&#x6E;&#116;&#101;&#108;&#46;&#99;&#x6F;m</a></p></td><td class="code"><div class="highlight"><pre></pre></div></td></tr>


<tr id="section-3"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-3">&#182;</a></div><p>This script turns a dmesg output into a SVG graphic that shows which
functions take how much time. You can view SVG graphics with various
programs, including Inkscape, The Gimp and Firefox.</p>

<p>For this script to work, the kernel needs to be compiled with the
CONFIG<em>PRINTK</em>TIME configuration option enabled, and with
"initcall_debug" passed on the kernel command line.</p>

<p>usage:
    dmesg | perl scripts/bootgraph.pl > output.svg</p></td><td class="code"><div class="highlight"><pre><span class="k">use</span> <span class="n">strict</span><span class="p">;</span>

<span class="k">my</span> <span class="nv">%start</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">%end</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">%type</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$done</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$maxtime</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$firsttime</span> <span class="o">=</span> <span class="mi">99999</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">%pids</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">%pidctr</span><span class="p">;</span>

<span class="k">while</span> <span class="p">(</span><span class="o">&lt;&gt;</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">my</span> <span class="nv">$line</span> <span class="o">=</span> <span class="nv">$_</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="nv">$line</span> <span class="o">=~</span><span class="sr"> /([0-9\.]+)\] calling  ([a-zA-Z0-9\_\.]+)\+/</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">my</span> <span class="nv">$func</span> <span class="o">=</span> <span class="nv">$2</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="nv">$done</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="nv">$start</span><span class="p">{</span><span class="nv">$func</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$1</span><span class="p">;</span>
			<span class="nv">$type</span><span class="p">{</span><span class="nv">$func</span><span class="p">}</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="nv">$1</span> <span class="o">&lt;</span> <span class="nv">$firsttime</span><span class="p">)</span> <span class="p">{</span>
				<span class="nv">$firsttime</span> <span class="o">=</span> <span class="nv">$1</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="nv">$line</span> <span class="o">=~</span><span class="sr"> /\@ ([0-9]+)/</span><span class="p">)</span> <span class="p">{</span>
			<span class="nv">$pids</span><span class="p">{</span><span class="nv">$func</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="nv">$count</span> <span class="o">=</span> <span class="nv">$count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="nv">$line</span> <span class="o">=~</span><span class="sr"> /([0-9\.]+)\] async_waiting @ ([0-9]+)/</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">my</span> <span class="nv">$pid</span> <span class="o">=</span> <span class="nv">$2</span><span class="p">;</span>
		<span class="k">my</span> <span class="nv">$func</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">defined</span><span class="p">(</span><span class="nv">$pidctr</span><span class="p">{</span><span class="nv">$pid</span><span class="p">}))</span> <span class="p">{</span>
			<span class="nv">$func</span> <span class="o">=</span> <span class="s">&quot;wait_&quot;</span> <span class="o">.</span> <span class="nv">$pid</span> <span class="o">.</span> <span class="s">&quot;_1&quot;</span><span class="p">;</span>
			<span class="nv">$pidctr</span><span class="p">{</span><span class="nv">$pid</span><span class="p">}</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="nv">$pidctr</span><span class="p">{</span><span class="nv">$pid</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$pidctr</span><span class="p">{</span><span class="nv">$pid</span><span class="p">}</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
			<span class="nv">$func</span> <span class="o">=</span> <span class="s">&quot;wait_&quot;</span> <span class="o">.</span> <span class="nv">$pid</span> <span class="o">.</span> <span class="s">&quot;_&quot;</span> <span class="o">.</span> <span class="nv">$pidctr</span><span class="p">{</span><span class="nv">$pid</span><span class="p">};</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="nv">$done</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="nv">$start</span><span class="p">{</span><span class="nv">$func</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$1</span><span class="p">;</span>
			<span class="nv">$type</span><span class="p">{</span><span class="nv">$func</span><span class="p">}</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="nv">$1</span> <span class="o">&lt;</span> <span class="nv">$firsttime</span><span class="p">)</span> <span class="p">{</span>
				<span class="nv">$firsttime</span> <span class="o">=</span> <span class="nv">$1</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="nv">$pids</span><span class="p">{</span><span class="nv">$func</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$pid</span><span class="p">;</span>
		<span class="nv">$count</span> <span class="o">=</span> <span class="nv">$count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="nv">$line</span> <span class="o">=~</span><span class="sr"> /([0-9\.]+)\] initcall ([a-zA-Z0-9\_\.]+)\+.*returned/</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="nv">$done</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="nv">$end</span><span class="p">{</span><span class="nv">$2</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$1</span><span class="p">;</span>
			<span class="nv">$maxtime</span> <span class="o">=</span> <span class="nv">$1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="nv">$line</span> <span class="o">=~</span><span class="sr"> /([0-9\.]+)\] async_continuing @ ([0-9]+)/</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">my</span> <span class="nv">$pid</span> <span class="o">=</span> <span class="nv">$2</span><span class="p">;</span>
		<span class="k">my</span> <span class="nv">$func</span> <span class="o">=</span>  <span class="s">&quot;wait_&quot;</span> <span class="o">.</span> <span class="nv">$pid</span> <span class="o">.</span> <span class="s">&quot;_&quot;</span> <span class="o">.</span> <span class="nv">$pidctr</span><span class="p">{</span><span class="nv">$pid</span><span class="p">};</span>
		<span class="nv">$end</span><span class="p">{</span><span class="nv">$func</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$1</span><span class="p">;</span>
		<span class="nv">$maxtime</span> <span class="o">=</span> <span class="nv">$1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="nv">$line</span> <span class="o">=~</span><span class="sr"> /Write protecting the/</span><span class="p">)</span> <span class="p">{</span>
		<span class="nv">$done</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="nv">$line</span> <span class="o">=~</span><span class="sr"> /Freeing unused kernel memory/</span><span class="p">)</span> <span class="p">{</span>
		<span class="nv">$done</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">print</span> <span class="bp">STDERR</span> <span class="s">&lt;&lt;END;</span>
<span class="s">No data found in the dmesg. Make sure that &#39;printk.time=1&#39; and</span>
<span class="s">&#39;initcall_debug&#39; are passed on the kernel command line.</span>
<span class="s">Usage:</span>
<span class="s">      dmesg | perl scripts/bootgraph.pl &gt; output.svg</span>
<span class="s">END</span>
    <span class="nb">exit</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">print</span> <span class="s">&quot;&lt;?xml version=\&quot;1.0\&quot; standalone=\&quot;no\&quot;?&gt; \n&quot;</span><span class="p">;</span>
<span class="k">print</span> <span class="s">&quot;&lt;svg width=\&quot;2000\&quot; height=\&quot;100%\&quot; version=\&quot;1.1\&quot; xmlns=\&quot;http://www.w3.org/2000/svg\&quot;&gt;\n&quot;</span><span class="p">;</span>

<span class="k">my</span> <span class="nv">@styles</span><span class="p">;</span>

<span class="nv">$styles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;fill:rgb(0,0,255);fill-opacity:0.5;stroke-width:1;stroke:rgb(0,0,0)&quot;</span><span class="p">;</span>
<span class="nv">$styles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;fill:rgb(0,255,0);fill-opacity:0.5;stroke-width:1;stroke:rgb(0,0,0)&quot;</span><span class="p">;</span>
<span class="nv">$styles</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;fill:rgb(255,0,20);fill-opacity:0.5;stroke-width:1;stroke:rgb(0,0,0)&quot;</span><span class="p">;</span>
<span class="nv">$styles</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;fill:rgb(255,255,20);fill-opacity:0.5;stroke-width:1;stroke:rgb(0,0,0)&quot;</span><span class="p">;</span>
<span class="nv">$styles</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;fill:rgb(255,0,255);fill-opacity:0.5;stroke-width:1;stroke:rgb(0,0,0)&quot;</span><span class="p">;</span>
<span class="nv">$styles</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;fill:rgb(0,255,255);fill-opacity:0.5;stroke-width:1;stroke:rgb(0,0,0)&quot;</span><span class="p">;</span>
<span class="nv">$styles</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;fill:rgb(0,128,255);fill-opacity:0.5;stroke-width:1;stroke:rgb(0,0,0)&quot;</span><span class="p">;</span>
<span class="nv">$styles</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;fill:rgb(0,255,128);fill-opacity:0.5;stroke-width:1;stroke:rgb(0,0,0)&quot;</span><span class="p">;</span>
<span class="nv">$styles</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;fill:rgb(255,0,128);fill-opacity:0.5;stroke-width:1;stroke:rgb(0,0,0)&quot;</span><span class="p">;</span>
<span class="nv">$styles</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;fill:rgb(255,255,128);fill-opacity:0.5;stroke-width:1;stroke:rgb(0,0,0)&quot;</span><span class="p">;</span>
<span class="nv">$styles</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;fill:rgb(255,128,255);fill-opacity:0.5;stroke-width:1;stroke:rgb(0,0,0)&quot;</span><span class="p">;</span>
<span class="nv">$styles</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;fill:rgb(128,255,255);fill-opacity:0.5;stroke-width:1;stroke:rgb(0,0,0)&quot;</span><span class="p">;</span>

<span class="k">my</span> <span class="nv">$style_wait</span> <span class="o">=</span> <span class="s">&quot;fill:rgb(128,128,128);fill-opacity:0.5;stroke-width:0;stroke:rgb(0,0,0)&quot;</span><span class="p">;</span>

<span class="k">my</span> <span class="nv">$mult</span> <span class="o">=</span> <span class="mf">1950.0</span> <span class="o">/</span> <span class="p">(</span><span class="nv">$maxtime</span> <span class="o">-</span> <span class="nv">$firsttime</span><span class="p">);</span>
<span class="k">my</span> <span class="nv">$threshold2</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$maxtime</span> <span class="o">-</span> <span class="nv">$firsttime</span><span class="p">)</span> <span class="o">/</span> <span class="mf">120.0</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$threshold</span> <span class="o">=</span> <span class="nv">$threshold2</span><span class="o">/</span><span class="mi">10</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$stylecounter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">%rows</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$rowscount</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">@initcalls</span> <span class="o">=</span> <span class="nb">sort</span> <span class="p">{</span> <span class="nv">$start</span><span class="p">{</span><span class="nv">$a</span><span class="p">}</span> <span class="sr">&lt;=&gt;</span> <span class="nv">$start</span><span class="p">{</span><span class="nv">$b</span><span class="p">}</span> <span class="p">}</span> <span class="nb">keys</span><span class="p">(</span><span class="nv">%start</span><span class="p">);</span>

<span class="k">foreach</span> <span class="k">my</span> <span class="nv">$key</span> <span class="p">(</span><span class="nv">@initcalls</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">my</span> <span class="nv">$duration</span> <span class="o">=</span> <span class="nv">$end</span><span class="p">{</span><span class="nv">$key</span><span class="p">}</span> <span class="o">-</span> <span class="nv">$start</span><span class="p">{</span><span class="nv">$key</span><span class="p">};</span>

	<span class="k">if</span> <span class="p">(</span><span class="nv">$duration</span> <span class="o">&gt;=</span> <span class="nv">$threshold</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">my</span> <span class="p">(</span><span class="nv">$s</span><span class="p">,</span> <span class="nv">$s2</span><span class="p">,</span> <span class="nv">$s3</span><span class="p">,</span> <span class="nv">$e</span><span class="p">,</span> <span class="nv">$w</span><span class="p">,</span> <span class="nv">$y</span><span class="p">,</span> <span class="nv">$y2</span><span class="p">,</span> <span class="nv">$style</span><span class="p">);</span>
		<span class="k">my</span> <span class="nv">$pid</span> <span class="o">=</span> <span class="nv">$pids</span><span class="p">{</span><span class="nv">$key</span><span class="p">};</span>

		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">defined</span><span class="p">(</span><span class="nv">$rows</span><span class="p">{</span><span class="nv">$pid</span><span class="p">}))</span> <span class="p">{</span>
			<span class="nv">$rows</span><span class="p">{</span><span class="nv">$pid</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$rowscount</span><span class="p">;</span>
			<span class="nv">$rowscount</span> <span class="o">=</span> <span class="nv">$rowscount</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="nv">$s</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$start</span><span class="p">{</span><span class="nv">$key</span><span class="p">}</span> <span class="o">-</span> <span class="nv">$firsttime</span><span class="p">)</span> <span class="o">*</span> <span class="nv">$mult</span><span class="p">;</span>
		<span class="nv">$s2</span> <span class="o">=</span> <span class="nv">$s</span> <span class="o">+</span> <span class="mi">6</span><span class="p">;</span>
		<span class="nv">$s3</span> <span class="o">=</span> <span class="nv">$s</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
		<span class="nv">$e</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$end</span><span class="p">{</span><span class="nv">$key</span><span class="p">}</span> <span class="o">-</span> <span class="nv">$firsttime</span><span class="p">)</span> <span class="o">*</span> <span class="nv">$mult</span><span class="p">;</span>
		<span class="nv">$w</span> <span class="o">=</span> <span class="nv">$e</span> <span class="o">-</span> <span class="nv">$s</span><span class="p">;</span>

		<span class="nv">$y</span> <span class="o">=</span> <span class="nv">$rows</span><span class="p">{</span><span class="nv">$pid</span><span class="p">}</span> <span class="o">*</span> <span class="mi">150</span><span class="p">;</span>
		<span class="nv">$y2</span> <span class="o">=</span> <span class="nv">$y</span> <span class="o">+</span> <span class="mi">4</span><span class="p">;</span>

		<span class="nv">$style</span> <span class="o">=</span> <span class="nv">$styles</span><span class="p">[</span><span class="nv">$stylecounter</span><span class="p">];</span>
		<span class="nv">$stylecounter</span> <span class="o">=</span> <span class="nv">$stylecounter</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="nv">$stylecounter</span> <span class="o">&gt;</span> <span class="mi">11</span><span class="p">)</span> <span class="p">{</span>
			<span class="nv">$stylecounter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">};</span>

		<span class="k">if</span> <span class="p">(</span><span class="nv">$type</span><span class="p">{</span><span class="nv">$key</span><span class="p">}</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
			<span class="nv">$y</span> <span class="o">=</span> <span class="nv">$y</span> <span class="o">+</span> <span class="mi">15</span><span class="p">;</span>
			<span class="k">print</span> <span class="s">&quot;&lt;rect x=\&quot;$s\&quot; width=\&quot;$w\&quot; y=\&quot;$y\&quot; height=\&quot;115\&quot; style=\&quot;$style_wait\&quot;/&gt;\n&quot;</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="k">print</span> <span class="s">&quot;&lt;rect x=\&quot;$s\&quot; width=\&quot;$w\&quot; y=\&quot;$y\&quot; height=\&quot;145\&quot; style=\&quot;$style\&quot;/&gt;\n&quot;</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="nv">$duration</span> <span class="o">&gt;=</span> <span class="nv">$threshold2</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">print</span> <span class="s">&quot;&lt;text transform=\&quot;translate($s2,$y2) rotate(90)\&quot;&gt;$key&lt;/text&gt;\n&quot;</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="k">print</span> <span class="s">&quot;&lt;text transform=\&quot;translate($s3,$y2) rotate(90)\&quot; font-size=\&quot;3pt\&quot;&gt;$key&lt;/text&gt;\n&quot;</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span></pre></div></td></tr>


<tr id="section-4"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-4">&#182;</a></div><p>print the time line on top</p></td><td class="code"><div class="highlight"><pre><span class="k">my</span> <span class="nv">$time</span> <span class="o">=</span> <span class="nv">$firsttime</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$step</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$maxtime</span> <span class="o">-</span> <span class="nv">$firsttime</span><span class="p">)</span> <span class="o">/</span> <span class="mi">15</span><span class="p">;</span>
<span class="k">while</span> <span class="p">(</span><span class="nv">$time</span> <span class="o">&lt;</span> <span class="nv">$maxtime</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">my</span> <span class="nv">$s3</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$time</span> <span class="o">-</span> <span class="nv">$firsttime</span><span class="p">)</span> <span class="o">*</span> <span class="nv">$mult</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$tm</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nv">$time</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="mf">100.0</span><span class="p">;</span>
	<span class="k">print</span> <span class="s">&quot;&lt;text transform=\&quot;translate($s3,89) rotate(90)\&quot;&gt;$tm&lt;/text&gt;\n&quot;</span><span class="p">;</span>
	<span class="nv">$time</span> <span class="o">=</span> <span class="nv">$time</span> <span class="o">+</span> <span class="nv">$step</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">print</span> <span class="s">&quot;&lt;/svg&gt;\n&quot;</span><span class="p">;</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:1}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../javascript/docco.min.js"></script>
</html>
