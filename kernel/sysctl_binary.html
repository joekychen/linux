<!DOCTYPE html>
<html><head><title>joekychen/linux » kernel › sysctl_binary.c

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../index.html"></a><h1>sysctl_binary.c</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#include &lt;linux/stat.h&gt;</span>
<span class="cp">#include &lt;linux/sysctl.h&gt;</span>
<span class="cp">#include &quot;../fs/xfs/xfs_sysctl.h&quot;</span>
<span class="cp">#include &lt;linux/sunrpc/debug.h&gt;</span>
<span class="cp">#include &lt;linux/string.h&gt;</span>
<span class="cp">#include &lt;net/ip_vs.h&gt;</span>
<span class="cp">#include &lt;linux/syscalls.h&gt;</span>
<span class="cp">#include &lt;linux/namei.h&gt;</span>
<span class="cp">#include &lt;linux/mount.h&gt;</span>
<span class="cp">#include &lt;linux/fs.h&gt;</span>
<span class="cp">#include &lt;linux/nsproxy.h&gt;</span>
<span class="cp">#include &lt;linux/pid_namespace.h&gt;</span>
<span class="cp">#include &lt;linux/file.h&gt;</span>
<span class="cp">#include &lt;linux/ctype.h&gt;</span>
<span class="cp">#include &lt;linux/netdevice.h&gt;</span>
<span class="cp">#include &lt;linux/kernel.h&gt;</span>
<span class="cp">#include &lt;linux/slab.h&gt;</span>

<span class="cp">#ifdef CONFIG_SYSCTL_SYSCALL</span>

<span class="k">struct</span> <span class="n">bin_table</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">ssize_t</span> <span class="n">bin_convert_t</span><span class="p">(</span><span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="n">file</span><span class="p">,</span>
	<span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">oldval</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">oldlen</span><span class="p">,</span> <span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">newval</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">newlen</span><span class="p">);</span>

<span class="k">static</span> <span class="n">bin_convert_t</span> <span class="n">bin_dir</span><span class="p">;</span>
<span class="k">static</span> <span class="n">bin_convert_t</span> <span class="n">bin_string</span><span class="p">;</span>
<span class="k">static</span> <span class="n">bin_convert_t</span> <span class="n">bin_intvec</span><span class="p">;</span>
<span class="k">static</span> <span class="n">bin_convert_t</span> <span class="n">bin_ulongvec</span><span class="p">;</span>
<span class="k">static</span> <span class="n">bin_convert_t</span> <span class="n">bin_uuid</span><span class="p">;</span>
<span class="k">static</span> <span class="n">bin_convert_t</span> <span class="n">bin_dn_node_address</span><span class="p">;</span>

<span class="cp">#define CTL_DIR   bin_dir</span>
<span class="cp">#define CTL_STR   bin_string</span>
<span class="cp">#define CTL_INT   bin_intvec</span>
<span class="cp">#define CTL_ULONG bin_ulongvec</span>
<span class="cp">#define CTL_UUID  bin_uuid</span>
<span class="cp">#define CTL_DNADR bin_dn_node_address</span>

<span class="cp">#define BUFSZ 256</span>

<span class="k">struct</span> <span class="n">bin_table</span> <span class="p">{</span>
	<span class="n">bin_convert_t</span>		<span class="o">*</span><span class="n">convert</span><span class="p">;</span>
	<span class="kt">int</span>			<span class="n">ctl_name</span><span class="p">;</span>
	<span class="k">const</span> <span class="kt">char</span>		<span class="o">*</span><span class="n">procname</span><span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span>	<span class="o">*</span><span class="n">child</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_random_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">RANDOM_POOLSIZE</span><span class="p">,</span>	<span class="s">&quot;poolsize&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">RANDOM_ENTROPY_COUNT</span><span class="p">,</span>	<span class="s">&quot;entropy_avail&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">RANDOM_READ_THRESH</span><span class="p">,</span>	<span class="s">&quot;read_wakeup_threshold&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">RANDOM_WRITE_THRESH</span><span class="p">,</span>	<span class="s">&quot;write_wakeup_threshold&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_UUID</span><span class="p">,</span>	<span class="n">RANDOM_BOOT_ID</span><span class="p">,</span>		<span class="s">&quot;boot_id&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_UUID</span><span class="p">,</span>	<span class="n">RANDOM_UUID</span><span class="p">,</span>		<span class="s">&quot;uuid&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_pty_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">PTY_MAX</span><span class="p">,</span>	<span class="s">&quot;max&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">PTY_NR</span><span class="p">,</span>		<span class="s">&quot;nr&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_kern_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_STR</span><span class="p">,</span>	<span class="n">KERN_OSTYPE</span><span class="p">,</span>			<span class="s">&quot;ostype&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_STR</span><span class="p">,</span>	<span class="n">KERN_OSRELEASE</span><span class="p">,</span>			<span class="s">&quot;osrelease&quot;</span> <span class="p">},</span>
	<span class="cm">/* KERN_OSREV not used */</span>
	<span class="p">{</span> <span class="n">CTL_STR</span><span class="p">,</span>	<span class="n">KERN_VERSION</span><span class="p">,</span>			<span class="s">&quot;version&quot;</span> <span class="p">},</span>
	<span class="cm">/* KERN_SECUREMASK not used */</span>
	<span class="cm">/* KERN_PROF not used */</span>
	<span class="p">{</span> <span class="n">CTL_STR</span><span class="p">,</span>	<span class="n">KERN_NODENAME</span><span class="p">,</span>			<span class="s">&quot;hostname&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_STR</span><span class="p">,</span>	<span class="n">KERN_DOMAINNAME</span><span class="p">,</span>		<span class="s">&quot;domainname&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_PANIC</span><span class="p">,</span>			<span class="s">&quot;panic&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_REALROOTDEV</span><span class="p">,</span>		<span class="s">&quot;real-root-dev&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="n">CTL_STR</span><span class="p">,</span>	<span class="n">KERN_SPARC_REBOOT</span><span class="p">,</span>		<span class="s">&quot;reboot-cmd&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_CTLALTDEL</span><span class="p">,</span>			<span class="s">&quot;ctrl-alt-del&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_PRINTK</span><span class="p">,</span>			<span class="s">&quot;printk&quot;</span> <span class="p">},</span>

	<span class="cm">/* KERN_NAMETRANS not used */</span>
	<span class="cm">/* KERN_PPC_HTABRECLAIM not used */</span>
	<span class="cm">/* KERN_PPC_ZEROPAGED not used */</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_PPC_POWERSAVE_NAP</span><span class="p">,</span>		<span class="s">&quot;powersave-nap&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="n">CTL_STR</span><span class="p">,</span>	<span class="n">KERN_MODPROBE</span><span class="p">,</span>			<span class="s">&quot;modprobe&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_SG_BIG_BUFF</span><span class="p">,</span>		<span class="s">&quot;sg-big-buff&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_ACCT</span><span class="p">,</span>			<span class="s">&quot;acct&quot;</span> <span class="p">},</span>
	<span class="cm">/* KERN_PPC_L2CR &quot;l2cr&quot; no longer used */</span>

	<span class="cm">/* KERN_RTSIGNR not used */</span>
	<span class="cm">/* KERN_RTSIGMAX not used */</span>

	<span class="p">{</span> <span class="n">CTL_ULONG</span><span class="p">,</span>	<span class="n">KERN_SHMMAX</span><span class="p">,</span>			<span class="s">&quot;shmmax&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_MSGMAX</span><span class="p">,</span>			<span class="s">&quot;msgmax&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_MSGMNB</span><span class="p">,</span>			<span class="s">&quot;msgmnb&quot;</span> <span class="p">},</span>
	<span class="cm">/* KERN_MSGPOOL not used*/</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_SYSRQ</span><span class="p">,</span>			<span class="s">&quot;sysrq&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_MAX_THREADS</span><span class="p">,</span>		<span class="s">&quot;threads-max&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">KERN_RANDOM</span><span class="p">,</span>			<span class="s">&quot;random&quot;</span><span class="p">,</span>	<span class="n">bin_random_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_ULONG</span><span class="p">,</span>	<span class="n">KERN_SHMALL</span><span class="p">,</span>			<span class="s">&quot;shmall&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_MSGMNI</span><span class="p">,</span>			<span class="s">&quot;msgmni&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_SEM</span><span class="p">,</span>			<span class="s">&quot;sem&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_SPARC_STOP_A</span><span class="p">,</span>		<span class="s">&quot;stop-a&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_SHMMNI</span><span class="p">,</span>			<span class="s">&quot;shmmni&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_OVERFLOWUID</span><span class="p">,</span>		<span class="s">&quot;overflowuid&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_OVERFLOWGID</span><span class="p">,</span>		<span class="s">&quot;overflowgid&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="n">CTL_STR</span><span class="p">,</span>	<span class="n">KERN_HOTPLUG</span><span class="p">,</span>			<span class="s">&quot;hotplug&quot;</span><span class="p">,</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_IEEE_EMULATION_WARNINGS</span><span class="p">,</span>	<span class="s">&quot;ieee_emulation_warnings&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_S390_USER_DEBUG_LOGGING</span><span class="p">,</span>	<span class="s">&quot;userprocess_debug&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_CORE_USES_PID</span><span class="p">,</span>		<span class="s">&quot;core_uses_pid&quot;</span> <span class="p">},</span>
	<span class="cm">/* KERN_TAINTED &quot;tainted&quot; no longer used */</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_CADPID</span><span class="p">,</span>			<span class="s">&quot;cad_pid&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_PIDMAX</span><span class="p">,</span>			<span class="s">&quot;pid_max&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_STR</span><span class="p">,</span>	<span class="n">KERN_CORE_PATTERN</span><span class="p">,</span>		<span class="s">&quot;core_pattern&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_PANIC_ON_OOPS</span><span class="p">,</span>		<span class="s">&quot;panic_on_oops&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_HPPA_PWRSW</span><span class="p">,</span>		<span class="s">&quot;soft-power&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_HPPA_UNALIGNED</span><span class="p">,</span>		<span class="s">&quot;unaligned-trap&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_PRINTK_RATELIMIT</span><span class="p">,</span>		<span class="s">&quot;printk_ratelimit&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_PRINTK_RATELIMIT_BURST</span><span class="p">,</span>	<span class="s">&quot;printk_ratelimit_burst&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">KERN_PTY</span><span class="p">,</span>			<span class="s">&quot;pty&quot;</span><span class="p">,</span>		<span class="n">bin_pty_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_NGROUPS_MAX</span><span class="p">,</span>		<span class="s">&quot;ngroups_max&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_SPARC_SCONS_PWROFF</span><span class="p">,</span>	<span class="s">&quot;scons-poweroff&quot;</span> <span class="p">},</span>
	<span class="cm">/* KERN_HZ_TIMER &quot;hz_timer&quot; no longer used */</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_UNKNOWN_NMI_PANIC</span><span class="p">,</span>		<span class="s">&quot;unknown_nmi_panic&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_BOOTLOADER_TYPE</span><span class="p">,</span>		<span class="s">&quot;bootloader_type&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_RANDOMIZE</span><span class="p">,</span>			<span class="s">&quot;randomize_va_space&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_SPIN_RETRY</span><span class="p">,</span>		<span class="s">&quot;spin_retry&quot;</span> <span class="p">},</span>
	<span class="cm">/* KERN_ACPI_VIDEO_FLAGS &quot;acpi_video_flags&quot; no longer used */</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_IA64_UNALIGNED</span><span class="p">,</span>		<span class="s">&quot;ignore-unaligned-usertrap&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_COMPAT_LOG</span><span class="p">,</span>		<span class="s">&quot;compat-log&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_MAX_LOCK_DEPTH</span><span class="p">,</span>		<span class="s">&quot;max_lock_depth&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_PANIC_ON_NMI</span><span class="p">,</span>		<span class="s">&quot;panic_on_unrecovered_nmi&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_vm_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">VM_OVERCOMMIT_MEMORY</span><span class="p">,</span>		<span class="s">&quot;overcommit_memory&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">VM_PAGE_CLUSTER</span><span class="p">,</span>		<span class="s">&quot;page-cluster&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">VM_DIRTY_BACKGROUND</span><span class="p">,</span>		<span class="s">&quot;dirty_background_ratio&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">VM_DIRTY_RATIO</span><span class="p">,</span>			<span class="s">&quot;dirty_ratio&quot;</span> <span class="p">},</span>
	<span class="cm">/* VM_DIRTY_WB_CS &quot;dirty_writeback_centisecs&quot; no longer used */</span>
	<span class="cm">/* VM_DIRTY_EXPIRE_CS &quot;dirty_expire_centisecs&quot; no longer used */</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">VM_NR_PDFLUSH_THREADS</span><span class="p">,</span>		<span class="s">&quot;nr_pdflush_threads&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">VM_OVERCOMMIT_RATIO</span><span class="p">,</span>		<span class="s">&quot;overcommit_ratio&quot;</span> <span class="p">},</span>
	<span class="cm">/* VM_PAGEBUF unused */</span>
	<span class="cm">/* VM_HUGETLB_PAGES &quot;nr_hugepages&quot; no longer used */</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">VM_SWAPPINESS</span><span class="p">,</span>			<span class="s">&quot;swappiness&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">VM_LOWMEM_RESERVE_RATIO</span><span class="p">,</span>	<span class="s">&quot;lowmem_reserve_ratio&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">VM_MIN_FREE_KBYTES</span><span class="p">,</span>		<span class="s">&quot;min_free_kbytes&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">VM_MAX_MAP_COUNT</span><span class="p">,</span>		<span class="s">&quot;max_map_count&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">VM_LAPTOP_MODE</span><span class="p">,</span>			<span class="s">&quot;laptop_mode&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">VM_BLOCK_DUMP</span><span class="p">,</span>			<span class="s">&quot;block_dump&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">VM_HUGETLB_GROUP</span><span class="p">,</span>		<span class="s">&quot;hugetlb_shm_group&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">VM_VFS_CACHE_PRESSURE</span><span class="p">,</span>	<span class="s">&quot;vfs_cache_pressure&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">VM_LEGACY_VA_LAYOUT</span><span class="p">,</span>		<span class="s">&quot;legacy_va_layout&quot;</span> <span class="p">},</span>
	<span class="cm">/* VM_SWAP_TOKEN_TIMEOUT unused */</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">VM_DROP_PAGECACHE</span><span class="p">,</span>		<span class="s">&quot;drop_caches&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">VM_PERCPU_PAGELIST_FRACTION</span><span class="p">,</span>	<span class="s">&quot;percpu_pagelist_fraction&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">VM_ZONE_RECLAIM_MODE</span><span class="p">,</span>		<span class="s">&quot;zone_reclaim_mode&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">VM_MIN_UNMAPPED</span><span class="p">,</span>		<span class="s">&quot;min_unmapped_ratio&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">VM_PANIC_ON_OOM</span><span class="p">,</span>		<span class="s">&quot;panic_on_oom&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">VM_VDSO_ENABLED</span><span class="p">,</span>		<span class="s">&quot;vdso_enabled&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">VM_MIN_SLAB</span><span class="p">,</span>			<span class="s">&quot;min_slab_ratio&quot;</span> <span class="p">},</span>

	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_core_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_CORE_WMEM_MAX</span><span class="p">,</span>	<span class="s">&quot;wmem_max&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_CORE_RMEM_MAX</span><span class="p">,</span>	<span class="s">&quot;rmem_max&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_CORE_WMEM_DEFAULT</span><span class="p">,</span>	<span class="s">&quot;wmem_default&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_CORE_RMEM_DEFAULT</span><span class="p">,</span>	<span class="s">&quot;rmem_default&quot;</span> <span class="p">},</span>
	<span class="cm">/* NET_CORE_DESTROY_DELAY unused */</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_CORE_MAX_BACKLOG</span><span class="p">,</span>	<span class="s">&quot;netdev_max_backlog&quot;</span> <span class="p">},</span>
	<span class="cm">/* NET_CORE_FASTROUTE unused */</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_CORE_MSG_COST</span><span class="p">,</span>	<span class="s">&quot;message_cost&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_CORE_MSG_BURST</span><span class="p">,</span>	<span class="s">&quot;message_burst&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_CORE_OPTMEM_MAX</span><span class="p">,</span>	<span class="s">&quot;optmem_max&quot;</span> <span class="p">},</span>
	<span class="cm">/* NET_CORE_HOT_LIST_LENGTH unused */</span>
	<span class="cm">/* NET_CORE_DIVERT_VERSION unused */</span>
	<span class="cm">/* NET_CORE_NO_CONG_THRESH unused */</span>
	<span class="cm">/* NET_CORE_NO_CONG unused */</span>
	<span class="cm">/* NET_CORE_LO_CONG unused */</span>
	<span class="cm">/* NET_CORE_MOD_CONG unused */</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_CORE_DEV_WEIGHT</span><span class="p">,</span>	<span class="s">&quot;dev_weight&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_CORE_SOMAXCONN</span><span class="p">,</span>	<span class="s">&quot;somaxconn&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_CORE_BUDGET</span><span class="p">,</span>	<span class="s">&quot;netdev_budget&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_CORE_AEVENT_ETIME</span><span class="p">,</span>	<span class="s">&quot;xfrm_aevent_etime&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_CORE_AEVENT_RSEQTH</span><span class="p">,</span>	<span class="s">&quot;xfrm_aevent_rseqth&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_CORE_WARNINGS</span><span class="p">,</span>	<span class="s">&quot;warnings&quot;</span> <span class="p">},</span>
	<span class="p">{},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_unix_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* NET_UNIX_DESTROY_DELAY unused */</span>
	<span class="cm">/* NET_UNIX_DELETE_DELAY unused */</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_UNIX_MAX_DGRAM_QLEN</span><span class="p">,</span>	<span class="s">&quot;max_dgram_qlen&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_ipv4_route_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_ROUTE_FLUSH</span><span class="p">,</span>			<span class="s">&quot;flush&quot;</span> <span class="p">},</span>
	<span class="cm">/* NET_IPV4_ROUTE_MIN_DELAY &quot;min_delay&quot; no longer used */</span>
	<span class="cm">/* NET_IPV4_ROUTE_MAX_DELAY &quot;max_delay&quot; no longer used */</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_ROUTE_GC_THRESH</span><span class="p">,</span>		<span class="s">&quot;gc_thresh&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_ROUTE_MAX_SIZE</span><span class="p">,</span>		<span class="s">&quot;max_size&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_ROUTE_GC_MIN_INTERVAL</span><span class="p">,</span>		<span class="s">&quot;gc_min_interval&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_ROUTE_GC_MIN_INTERVAL_MS</span><span class="p">,</span>	<span class="s">&quot;gc_min_interval_ms&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_ROUTE_GC_TIMEOUT</span><span class="p">,</span>		<span class="s">&quot;gc_timeout&quot;</span> <span class="p">},</span>
	<span class="cm">/* NET_IPV4_ROUTE_GC_INTERVAL &quot;gc_interval&quot; no longer used */</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_ROUTE_REDIRECT_LOAD</span><span class="p">,</span>		<span class="s">&quot;redirect_load&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_ROUTE_REDIRECT_NUMBER</span><span class="p">,</span>		<span class="s">&quot;redirect_number&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_ROUTE_REDIRECT_SILENCE</span><span class="p">,</span>	<span class="s">&quot;redirect_silence&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_ROUTE_ERROR_COST</span><span class="p">,</span>		<span class="s">&quot;error_cost&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_ROUTE_ERROR_BURST</span><span class="p">,</span>		<span class="s">&quot;error_burst&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_ROUTE_GC_ELASTICITY</span><span class="p">,</span>		<span class="s">&quot;gc_elasticity&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_ROUTE_MTU_EXPIRES</span><span class="p">,</span>		<span class="s">&quot;mtu_expires&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_ROUTE_MIN_PMTU</span><span class="p">,</span>		<span class="s">&quot;min_pmtu&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_ROUTE_MIN_ADVMSS</span><span class="p">,</span>		<span class="s">&quot;min_adv_mss&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_ipv4_conf_vars_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_CONF_FORWARDING</span><span class="p">,</span>		<span class="s">&quot;forwarding&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_CONF_MC_FORWARDING</span><span class="p">,</span>		<span class="s">&quot;mc_forwarding&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_CONF_ACCEPT_REDIRECTS</span><span class="p">,</span>		<span class="s">&quot;accept_redirects&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_CONF_SECURE_REDIRECTS</span><span class="p">,</span>		<span class="s">&quot;secure_redirects&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_CONF_SEND_REDIRECTS</span><span class="p">,</span>		<span class="s">&quot;send_redirects&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_CONF_SHARED_MEDIA</span><span class="p">,</span>		<span class="s">&quot;shared_media&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_CONF_RP_FILTER</span><span class="p">,</span>		<span class="s">&quot;rp_filter&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_CONF_ACCEPT_SOURCE_ROUTE</span><span class="p">,</span>	<span class="s">&quot;accept_source_route&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_CONF_PROXY_ARP</span><span class="p">,</span>		<span class="s">&quot;proxy_arp&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_CONF_MEDIUM_ID</span><span class="p">,</span>		<span class="s">&quot;medium_id&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_CONF_BOOTP_RELAY</span><span class="p">,</span>		<span class="s">&quot;bootp_relay&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_CONF_LOG_MARTIANS</span><span class="p">,</span>		<span class="s">&quot;log_martians&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_CONF_TAG</span><span class="p">,</span>			<span class="s">&quot;tag&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_CONF_ARPFILTER</span><span class="p">,</span>		<span class="s">&quot;arp_filter&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_CONF_ARP_ANNOUNCE</span><span class="p">,</span>		<span class="s">&quot;arp_announce&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_CONF_ARP_IGNORE</span><span class="p">,</span>		<span class="s">&quot;arp_ignore&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_CONF_ARP_ACCEPT</span><span class="p">,</span>		<span class="s">&quot;arp_accept&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_CONF_ARP_NOTIFY</span><span class="p">,</span>		<span class="s">&quot;arp_notify&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_CONF_NOXFRM</span><span class="p">,</span>			<span class="s">&quot;disable_xfrm&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_CONF_NOPOLICY</span><span class="p">,</span>			<span class="s">&quot;disable_policy&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_CONF_FORCE_IGMP_VERSION</span><span class="p">,</span>	<span class="s">&quot;force_igmp_version&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_CONF_PROMOTE_SECONDARIES</span><span class="p">,</span>	<span class="s">&quot;promote_secondaries&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_ipv4_conf_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_PROTO_CONF_ALL</span><span class="p">,</span>	<span class="s">&quot;all&quot;</span><span class="p">,</span>		<span class="n">bin_net_ipv4_conf_vars_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_PROTO_CONF_DEFAULT</span><span class="p">,</span>	<span class="s">&quot;default&quot;</span><span class="p">,</span>	<span class="n">bin_net_ipv4_conf_vars_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">bin_net_ipv4_conf_vars_table</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_neigh_vars_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NEIGH_MCAST_SOLICIT</span><span class="p">,</span>	<span class="s">&quot;mcast_solicit&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NEIGH_UCAST_SOLICIT</span><span class="p">,</span>	<span class="s">&quot;ucast_solicit&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NEIGH_APP_SOLICIT</span><span class="p">,</span>		<span class="s">&quot;app_solicit&quot;</span> <span class="p">},</span>
	<span class="cm">/* NET_NEIGH_RETRANS_TIME &quot;retrans_time&quot; no longer used */</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NEIGH_REACHABLE_TIME</span><span class="p">,</span>	<span class="s">&quot;base_reachable_time&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NEIGH_DELAY_PROBE_TIME</span><span class="p">,</span>	<span class="s">&quot;delay_first_probe_time&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NEIGH_GC_STALE_TIME</span><span class="p">,</span>	<span class="s">&quot;gc_stale_time&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NEIGH_UNRES_QLEN</span><span class="p">,</span>		<span class="s">&quot;unres_qlen&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NEIGH_PROXY_QLEN</span><span class="p">,</span>		<span class="s">&quot;proxy_qlen&quot;</span> <span class="p">},</span>
	<span class="cm">/* NET_NEIGH_ANYCAST_DELAY &quot;anycast_delay&quot; no longer used */</span>
	<span class="cm">/* NET_NEIGH_PROXY_DELAY &quot;proxy_delay&quot; no longer used */</span>
	<span class="cm">/* NET_NEIGH_LOCKTIME &quot;locktime&quot; no longer used */</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NEIGH_GC_INTERVAL</span><span class="p">,</span>		<span class="s">&quot;gc_interval&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NEIGH_GC_THRESH1</span><span class="p">,</span>		<span class="s">&quot;gc_thresh1&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NEIGH_GC_THRESH2</span><span class="p">,</span>		<span class="s">&quot;gc_thresh2&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NEIGH_GC_THRESH3</span><span class="p">,</span>		<span class="s">&quot;gc_thresh3&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NEIGH_RETRANS_TIME_MS</span><span class="p">,</span>	<span class="s">&quot;retrans_time_ms&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NEIGH_REACHABLE_TIME_MS</span><span class="p">,</span>	<span class="s">&quot;base_reachable_time_ms&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_neigh_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_PROTO_CONF_DEFAULT</span><span class="p">,</span> <span class="s">&quot;default&quot;</span><span class="p">,</span> <span class="n">bin_net_neigh_vars_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">bin_net_neigh_vars_table</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_ipv4_netfilter_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_NF_CONNTRACK_MAX</span><span class="p">,</span>		<span class="s">&quot;ip_conntrack_max&quot;</span> <span class="p">},</span>

	<span class="cm">/* NET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_SYN_SENT &quot;ip_conntrack_tcp_timeout_syn_sent&quot; no longer used */</span>
	<span class="cm">/* NET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_SYN_RECV &quot;ip_conntrack_tcp_timeout_syn_recv&quot; no longer used */</span>
	<span class="cm">/* NET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_ESTABLISHED &quot;ip_conntrack_tcp_timeout_established&quot; no longer used */</span>
	<span class="cm">/* NET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_FIN_WAIT &quot;ip_conntrack_tcp_timeout_fin_wait&quot; no longer used */</span>
	<span class="cm">/* NET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_CLOSE_WAIT	&quot;ip_conntrack_tcp_timeout_close_wait&quot; no longer used */</span>
	<span class="cm">/* NET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_LAST_ACK &quot;ip_conntrack_tcp_timeout_last_ack&quot; no longer used */</span>
	<span class="cm">/* NET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_TIME_WAIT &quot;ip_conntrack_tcp_timeout_time_wait&quot; no longer used */</span>
	<span class="cm">/* NET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_CLOSE &quot;ip_conntrack_tcp_timeout_close&quot; no longer used */</span>

	<span class="cm">/* NET_IPV4_NF_CONNTRACK_UDP_TIMEOUT &quot;ip_conntrack_udp_timeout&quot; no longer used */</span>
	<span class="cm">/* NET_IPV4_NF_CONNTRACK_UDP_TIMEOUT_STREAM &quot;ip_conntrack_udp_timeout_stream&quot; no longer used */</span>
	<span class="cm">/* NET_IPV4_NF_CONNTRACK_ICMP_TIMEOUT &quot;ip_conntrack_icmp_timeout&quot; no longer used */</span>
	<span class="cm">/* NET_IPV4_NF_CONNTRACK_GENERIC_TIMEOUT &quot;ip_conntrack_generic_timeout&quot; no longer used */</span>

	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_NF_CONNTRACK_BUCKETS</span><span class="p">,</span>		<span class="s">&quot;ip_conntrack_buckets&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_NF_CONNTRACK_LOG_INVALID</span><span class="p">,</span>	<span class="s">&quot;ip_conntrack_log_invalid&quot;</span> <span class="p">},</span>
	<span class="cm">/* NET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_MAX_RETRANS &quot;ip_conntrack_tcp_timeout_max_retrans&quot; no longer used */</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_NF_CONNTRACK_TCP_LOOSE</span><span class="p">,</span>	<span class="s">&quot;ip_conntrack_tcp_loose&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_NF_CONNTRACK_TCP_BE_LIBERAL</span><span class="p">,</span>	<span class="s">&quot;ip_conntrack_tcp_be_liberal&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_NF_CONNTRACK_TCP_MAX_RETRANS</span><span class="p">,</span>	<span class="s">&quot;ip_conntrack_tcp_max_retrans&quot;</span> <span class="p">},</span>

	<span class="cm">/* NET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_CLOSED &quot;ip_conntrack_sctp_timeout_closed&quot; no longer used */</span>
	<span class="cm">/* NET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_WAIT &quot;ip_conntrack_sctp_timeout_cookie_wait&quot; no longer used */</span>
	<span class="cm">/* NET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_ECHOED &quot;ip_conntrack_sctp_timeout_cookie_echoed&quot; no longer used */</span>
	<span class="cm">/* NET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_ESTABLISHED &quot;ip_conntrack_sctp_timeout_established&quot; no longer used */</span>
	<span class="cm">/* NET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_SENT &quot;ip_conntrack_sctp_timeout_shutdown_sent&quot; no longer used */</span>
	<span class="cm">/* NET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_RECD &quot;ip_conntrack_sctp_timeout_shutdown_recd&quot; no longer used */</span>
	<span class="cm">/* NET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_ACK_SENT &quot;ip_conntrack_sctp_timeout_shutdown_ack_sent&quot; no longer used */</span>

	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_NF_CONNTRACK_COUNT</span><span class="p">,</span>		<span class="s">&quot;ip_conntrack_count&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_NF_CONNTRACK_CHECKSUM</span><span class="p">,</span>		<span class="s">&quot;ip_conntrack_checksum&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_ipv4_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span><span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_FORWARD</span><span class="p">,</span>			<span class="s">&quot;ip_forward&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_IPV4_CONF</span><span class="p">,</span>		<span class="s">&quot;conf&quot;</span><span class="p">,</span>		<span class="n">bin_net_ipv4_conf_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_IPV4_NEIGH</span><span class="p">,</span>		<span class="s">&quot;neigh&quot;</span><span class="p">,</span>	<span class="n">bin_net_neigh_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_IPV4_ROUTE</span><span class="p">,</span>		<span class="s">&quot;route&quot;</span><span class="p">,</span>	<span class="n">bin_net_ipv4_route_table</span> <span class="p">},</span>
	<span class="cm">/* NET_IPV4_FIB_HASH unused */</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_IPV4_NETFILTER</span><span class="p">,</span>	<span class="s">&quot;netfilter&quot;</span><span class="p">,</span>	<span class="n">bin_net_ipv4_netfilter_table</span> <span class="p">},</span>

	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_TCP_TIMESTAMPS</span><span class="p">,</span>		<span class="s">&quot;tcp_timestamps&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_TCP_WINDOW_SCALING</span><span class="p">,</span>		<span class="s">&quot;tcp_window_scaling&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_TCP_SACK</span><span class="p">,</span>			<span class="s">&quot;tcp_sack&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_TCP_RETRANS_COLLAPSE</span><span class="p">,</span>		<span class="s">&quot;tcp_retrans_collapse&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_DEFAULT_TTL</span><span class="p">,</span>			<span class="s">&quot;ip_default_ttl&quot;</span> <span class="p">},</span>
	<span class="cm">/* NET_IPV4_AUTOCONFIG unused */</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_NO_PMTU_DISC</span><span class="p">,</span>			<span class="s">&quot;ip_no_pmtu_disc&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_NONLOCAL_BIND</span><span class="p">,</span>			<span class="s">&quot;ip_nonlocal_bind&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_TCP_SYN_RETRIES</span><span class="p">,</span>		<span class="s">&quot;tcp_syn_retries&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_SYNACK_RETRIES</span><span class="p">,</span>			<span class="s">&quot;tcp_synack_retries&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_MAX_ORPHANS</span><span class="p">,</span>			<span class="s">&quot;tcp_max_orphans&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_MAX_TW_BUCKETS</span><span class="p">,</span>			<span class="s">&quot;tcp_max_tw_buckets&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_DYNADDR</span><span class="p">,</span>			<span class="s">&quot;ip_dynaddr&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_TCP_KEEPALIVE_TIME</span><span class="p">,</span>		<span class="s">&quot;tcp_keepalive_time&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_TCP_KEEPALIVE_PROBES</span><span class="p">,</span>		<span class="s">&quot;tcp_keepalive_probes&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_TCP_KEEPALIVE_INTVL</span><span class="p">,</span>		<span class="s">&quot;tcp_keepalive_intvl&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_TCP_RETRIES1</span><span class="p">,</span>			<span class="s">&quot;tcp_retries1&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_TCP_RETRIES2</span><span class="p">,</span>			<span class="s">&quot;tcp_retries2&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_TCP_FIN_TIMEOUT</span><span class="p">,</span>		<span class="s">&quot;tcp_fin_timeout&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_SYNCOOKIES</span><span class="p">,</span>			<span class="s">&quot;tcp_syncookies&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_TW_RECYCLE</span><span class="p">,</span>			<span class="s">&quot;tcp_tw_recycle&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_ABORT_ON_OVERFLOW</span><span class="p">,</span>		<span class="s">&quot;tcp_abort_on_overflow&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_STDURG</span><span class="p">,</span>				<span class="s">&quot;tcp_stdurg&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_RFC1337</span><span class="p">,</span>			<span class="s">&quot;tcp_rfc1337&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_MAX_SYN_BACKLOG</span><span class="p">,</span>		<span class="s">&quot;tcp_max_syn_backlog&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_LOCAL_PORT_RANGE</span><span class="p">,</span>		<span class="s">&quot;ip_local_port_range&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_IGMP_MAX_MEMBERSHIPS</span><span class="p">,</span>		<span class="s">&quot;igmp_max_memberships&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_IGMP_MAX_MSF</span><span class="p">,</span>			<span class="s">&quot;igmp_max_msf&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_INET_PEER_THRESHOLD</span><span class="p">,</span>		<span class="s">&quot;inet_peer_threshold&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_INET_PEER_MINTTL</span><span class="p">,</span>		<span class="s">&quot;inet_peer_minttl&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_INET_PEER_MAXTTL</span><span class="p">,</span>		<span class="s">&quot;inet_peer_maxttl&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_INET_PEER_GC_MINTIME</span><span class="p">,</span>		<span class="s">&quot;inet_peer_gc_mintime&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_INET_PEER_GC_MAXTIME</span><span class="p">,</span>		<span class="s">&quot;inet_peer_gc_maxtime&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_ORPHAN_RETRIES</span><span class="p">,</span>			<span class="s">&quot;tcp_orphan_retries&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_FACK</span><span class="p">,</span>				<span class="s">&quot;tcp_fack&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_REORDERING</span><span class="p">,</span>			<span class="s">&quot;tcp_reordering&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_ECN</span><span class="p">,</span>				<span class="s">&quot;tcp_ecn&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_DSACK</span><span class="p">,</span>				<span class="s">&quot;tcp_dsack&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_MEM</span><span class="p">,</span>				<span class="s">&quot;tcp_mem&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_WMEM</span><span class="p">,</span>				<span class="s">&quot;tcp_wmem&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_RMEM</span><span class="p">,</span>				<span class="s">&quot;tcp_rmem&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_APP_WIN</span><span class="p">,</span>			<span class="s">&quot;tcp_app_win&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_ADV_WIN_SCALE</span><span class="p">,</span>			<span class="s">&quot;tcp_adv_win_scale&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_TW_REUSE</span><span class="p">,</span>			<span class="s">&quot;tcp_tw_reuse&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_FRTO</span><span class="p">,</span>				<span class="s">&quot;tcp_frto&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_FRTO_RESPONSE</span><span class="p">,</span>			<span class="s">&quot;tcp_frto_response&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_LOW_LATENCY</span><span class="p">,</span>			<span class="s">&quot;tcp_low_latency&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_NO_METRICS_SAVE</span><span class="p">,</span>		<span class="s">&quot;tcp_no_metrics_save&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_MODERATE_RCVBUF</span><span class="p">,</span>		<span class="s">&quot;tcp_moderate_rcvbuf&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_TSO_WIN_DIVISOR</span><span class="p">,</span>		<span class="s">&quot;tcp_tso_win_divisor&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_STR</span><span class="p">,</span>	<span class="n">NET_TCP_CONG_CONTROL</span><span class="p">,</span>			<span class="s">&quot;tcp_congestion_control&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_ABC</span><span class="p">,</span>				<span class="s">&quot;tcp_abc&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_MTU_PROBING</span><span class="p">,</span>			<span class="s">&quot;tcp_mtu_probing&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_BASE_MSS</span><span class="p">,</span>			<span class="s">&quot;tcp_base_mss&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_TCP_WORKAROUND_SIGNED_WINDOWS</span><span class="p">,</span>	<span class="s">&quot;tcp_workaround_signed_windows&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_DMA_COPYBREAK</span><span class="p">,</span>			<span class="s">&quot;tcp_dma_copybreak&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_SLOW_START_AFTER_IDLE</span><span class="p">,</span>		<span class="s">&quot;tcp_slow_start_after_idle&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_CIPSOV4_CACHE_ENABLE</span><span class="p">,</span>		<span class="s">&quot;cipso_cache_enable&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_CIPSOV4_CACHE_BUCKET_SIZE</span><span class="p">,</span>		<span class="s">&quot;cipso_cache_bucket_size&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_CIPSOV4_RBM_OPTFMT</span><span class="p">,</span>			<span class="s">&quot;cipso_rbm_optfmt&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_CIPSOV4_RBM_STRICTVALID</span><span class="p">,</span>		<span class="s">&quot;cipso_rbm_strictvalid&quot;</span> <span class="p">},</span>
	<span class="cm">/* NET_TCP_AVAIL_CONG_CONTROL &quot;tcp_available_congestion_control&quot; no longer used */</span>
	<span class="p">{</span> <span class="n">CTL_STR</span><span class="p">,</span>	<span class="n">NET_TCP_ALLOWED_CONG_CONTROL</span><span class="p">,</span>		<span class="s">&quot;tcp_allowed_congestion_control&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TCP_MAX_SSTHRESH</span><span class="p">,</span>			<span class="s">&quot;tcp_max_ssthresh&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_ICMP_ECHO_IGNORE_ALL</span><span class="p">,</span>		<span class="s">&quot;icmp_echo_ignore_all&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_ICMP_ECHO_IGNORE_BROADCASTS</span><span class="p">,</span>	<span class="s">&quot;icmp_echo_ignore_broadcasts&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_ICMP_IGNORE_BOGUS_ERROR_RESPONSES</span><span class="p">,</span>	<span class="s">&quot;icmp_ignore_bogus_error_responses&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_ICMP_ERRORS_USE_INBOUND_IFADDR</span><span class="p">,</span>	<span class="s">&quot;icmp_errors_use_inbound_ifaddr&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_ICMP_RATELIMIT</span><span class="p">,</span>		<span class="s">&quot;icmp_ratelimit&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_ICMP_RATEMASK</span><span class="p">,</span>			<span class="s">&quot;icmp_ratemask&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_IPFRAG_HIGH_THRESH</span><span class="p">,</span>		<span class="s">&quot;ipfrag_high_thresh&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_IPFRAG_LOW_THRESH</span><span class="p">,</span>		<span class="s">&quot;ipfrag_low_thresh&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_IPFRAG_TIME</span><span class="p">,</span>			<span class="s">&quot;ipfrag_time&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV4_IPFRAG_SECRET_INTERVAL</span><span class="p">,</span>	<span class="s">&quot;ipfrag_secret_interval&quot;</span> <span class="p">},</span>
	<span class="cm">/* NET_IPV4_IPFRAG_MAX_DIST &quot;ipfrag_max_dist&quot; no longer used */</span>

	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="mi">2088</span> <span class="cm">/* NET_IPQ_QMAX */</span><span class="p">,</span>		<span class="s">&quot;ip_queue_maxlen&quot;</span> <span class="p">},</span>

	<span class="cm">/* NET_TCP_DEFAULT_WIN_SCALE unused */</span>
	<span class="cm">/* NET_TCP_BIC_BETA unused */</span>
	<span class="cm">/* NET_IPV4_TCP_MAX_KA_PROBES unused */</span>
	<span class="cm">/* NET_IPV4_IP_MASQ_DEBUG unused */</span>
	<span class="cm">/* NET_TCP_SYN_TAILDROP unused */</span>
	<span class="cm">/* NET_IPV4_ICMP_SOURCEQUENCH_RATE unused */</span>
	<span class="cm">/* NET_IPV4_ICMP_DESTUNREACH_RATE unused */</span>
	<span class="cm">/* NET_IPV4_ICMP_TIMEEXCEED_RATE unused */</span>
	<span class="cm">/* NET_IPV4_ICMP_PARAMPROB_RATE unused */</span>
	<span class="cm">/* NET_IPV4_ICMP_ECHOREPLY_RATE unused */</span>
	<span class="cm">/* NET_IPV4_ALWAYS_DEFRAG unused */</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_ipx_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPX_PPROP_BROADCASTING</span><span class="p">,</span>	<span class="s">&quot;ipx_pprop_broadcasting&quot;</span> <span class="p">},</span>
	<span class="cm">/* NET_IPX_FORWARDING unused */</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_atalk_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_ATALK_AARP_EXPIRY_TIME</span><span class="p">,</span>		<span class="s">&quot;aarp-expiry-time&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_ATALK_AARP_TICK_TIME</span><span class="p">,</span>		<span class="s">&quot;aarp-tick-time&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_ATALK_AARP_RETRANSMIT_LIMIT</span><span class="p">,</span>	<span class="s">&quot;aarp-retransmit-limit&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_ATALK_AARP_RESOLVE_TIME</span><span class="p">,</span>		<span class="s">&quot;aarp-resolve-time&quot;</span> <span class="p">},</span>
	<span class="p">{},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_netrom_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NETROM_DEFAULT_PATH_QUALITY</span><span class="p">,</span>		<span class="s">&quot;default_path_quality&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NETROM_OBSOLESCENCE_COUNT_INITIALISER</span><span class="p">,</span>	<span class="s">&quot;obsolescence_count_initialiser&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NETROM_NETWORK_TTL_INITIALISER</span><span class="p">,</span>		<span class="s">&quot;network_ttl_initialiser&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NETROM_TRANSPORT_TIMEOUT</span><span class="p">,</span>			<span class="s">&quot;transport_timeout&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NETROM_TRANSPORT_MAXIMUM_TRIES</span><span class="p">,</span>		<span class="s">&quot;transport_maximum_tries&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NETROM_TRANSPORT_ACKNOWLEDGE_DELAY</span><span class="p">,</span>		<span class="s">&quot;transport_acknowledge_delay&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NETROM_TRANSPORT_BUSY_DELAY</span><span class="p">,</span>		<span class="s">&quot;transport_busy_delay&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NETROM_TRANSPORT_REQUESTED_WINDOW_SIZE</span><span class="p">,</span>	<span class="s">&quot;transport_requested_window_size&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NETROM_TRANSPORT_NO_ACTIVITY_TIMEOUT</span><span class="p">,</span>	<span class="s">&quot;transport_no_activity_timeout&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NETROM_ROUTING_CONTROL</span><span class="p">,</span>			<span class="s">&quot;routing_control&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NETROM_LINK_FAILS_COUNT</span><span class="p">,</span>			<span class="s">&quot;link_fails_count&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NETROM_RESET</span><span class="p">,</span>				<span class="s">&quot;reset&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_ax25_param_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_AX25_IP_DEFAULT_MODE</span><span class="p">,</span>	<span class="s">&quot;ip_default_mode&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_AX25_DEFAULT_MODE</span><span class="p">,</span>		<span class="s">&quot;ax25_default_mode&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_AX25_BACKOFF_TYPE</span><span class="p">,</span>		<span class="s">&quot;backoff_type&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_AX25_CONNECT_MODE</span><span class="p">,</span>		<span class="s">&quot;connect_mode&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_AX25_STANDARD_WINDOW</span><span class="p">,</span>	<span class="s">&quot;standard_window_size&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_AX25_EXTENDED_WINDOW</span><span class="p">,</span>	<span class="s">&quot;extended_window_size&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_AX25_T1_TIMEOUT</span><span class="p">,</span>		<span class="s">&quot;t1_timeout&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_AX25_T2_TIMEOUT</span><span class="p">,</span>		<span class="s">&quot;t2_timeout&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_AX25_T3_TIMEOUT</span><span class="p">,</span>		<span class="s">&quot;t3_timeout&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_AX25_IDLE_TIMEOUT</span><span class="p">,</span>		<span class="s">&quot;idle_timeout&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_AX25_N2</span><span class="p">,</span>			<span class="s">&quot;maximum_retry_count&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_AX25_PACLEN</span><span class="p">,</span>		<span class="s">&quot;maximum_packet_length&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_AX25_PROTOCOL</span><span class="p">,</span>		<span class="s">&quot;protocol&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_AX25_DAMA_SLAVE_TIMEOUT</span><span class="p">,</span>	<span class="s">&quot;dama_slave_timeout&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_ax25_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">bin_net_ax25_param_table</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_rose_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_ROSE_RESTART_REQUEST_TIMEOUT</span><span class="p">,</span>	<span class="s">&quot;restart_request_timeout&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_ROSE_CALL_REQUEST_TIMEOUT</span><span class="p">,</span>		<span class="s">&quot;call_request_timeout&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_ROSE_RESET_REQUEST_TIMEOUT</span><span class="p">,</span>		<span class="s">&quot;reset_request_timeout&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_ROSE_CLEAR_REQUEST_TIMEOUT</span><span class="p">,</span>		<span class="s">&quot;clear_request_timeout&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_ROSE_ACK_HOLD_BACK_TIMEOUT</span><span class="p">,</span>		<span class="s">&quot;acknowledge_hold_back_timeout&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_ROSE_ROUTING_CONTROL</span><span class="p">,</span>		<span class="s">&quot;routing_control&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_ROSE_LINK_FAIL_TIMEOUT</span><span class="p">,</span>		<span class="s">&quot;link_fail_timeout&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_ROSE_MAX_VCS</span><span class="p">,</span>			<span class="s">&quot;maximum_virtual_circuits&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_ROSE_WINDOW_SIZE</span><span class="p">,</span>			<span class="s">&quot;window_size&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_ROSE_NO_ACTIVITY_TIMEOUT</span><span class="p">,</span>		<span class="s">&quot;no_activity_timeout&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_ipv6_conf_var_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_FORWARDING</span><span class="p">,</span>			<span class="s">&quot;forwarding&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_HOP_LIMIT</span><span class="p">,</span>			<span class="s">&quot;hop_limit&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_MTU</span><span class="p">,</span>				<span class="s">&quot;mtu&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_ACCEPT_RA</span><span class="p">,</span>			<span class="s">&quot;accept_ra&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_ACCEPT_REDIRECTS</span><span class="p">,</span>		<span class="s">&quot;accept_redirects&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_AUTOCONF</span><span class="p">,</span>			<span class="s">&quot;autoconf&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_DAD_TRANSMITS</span><span class="p">,</span>			<span class="s">&quot;dad_transmits&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_RTR_SOLICITS</span><span class="p">,</span>			<span class="s">&quot;router_solicitations&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_RTR_SOLICIT_INTERVAL</span><span class="p">,</span>		<span class="s">&quot;router_solicitation_interval&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_RTR_SOLICIT_DELAY</span><span class="p">,</span>		<span class="s">&quot;router_solicitation_delay&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_USE_TEMPADDR</span><span class="p">,</span>			<span class="s">&quot;use_tempaddr&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_TEMP_VALID_LFT</span><span class="p">,</span>		<span class="s">&quot;temp_valid_lft&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_TEMP_PREFERED_LFT</span><span class="p">,</span>		<span class="s">&quot;temp_prefered_lft&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_REGEN_MAX_RETRY</span><span class="p">,</span>		<span class="s">&quot;regen_max_retry&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_MAX_DESYNC_FACTOR</span><span class="p">,</span>		<span class="s">&quot;max_desync_factor&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_MAX_ADDRESSES</span><span class="p">,</span>			<span class="s">&quot;max_addresses&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_FORCE_MLD_VERSION</span><span class="p">,</span>		<span class="s">&quot;force_mld_version&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_ACCEPT_RA_DEFRTR</span><span class="p">,</span>		<span class="s">&quot;accept_ra_defrtr&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_ACCEPT_RA_PINFO</span><span class="p">,</span>		<span class="s">&quot;accept_ra_pinfo&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_ACCEPT_RA_RTR_PREF</span><span class="p">,</span>		<span class="s">&quot;accept_ra_rtr_pref&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_RTR_PROBE_INTERVAL</span><span class="p">,</span>		<span class="s">&quot;router_probe_interval&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_ACCEPT_RA_RT_INFO_MAX_PLEN</span><span class="p">,</span>	<span class="s">&quot;accept_ra_rt_info_max_plen&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_PROXY_NDP</span><span class="p">,</span>			<span class="s">&quot;proxy_ndp&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_ACCEPT_SOURCE_ROUTE</span><span class="p">,</span>		<span class="s">&quot;accept_source_route&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_ipv6_conf_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_PROTO_CONF_ALL</span><span class="p">,</span>		<span class="s">&quot;all&quot;</span><span class="p">,</span>	<span class="n">bin_net_ipv6_conf_var_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_PROTO_CONF_DEFAULT</span><span class="p">,</span> 	<span class="s">&quot;default&quot;</span><span class="p">,</span> <span class="n">bin_net_ipv6_conf_var_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">bin_net_ipv6_conf_var_table</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_ipv6_route_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* NET_IPV6_ROUTE_FLUSH	&quot;flush&quot;  no longer used */</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_ROUTE_GC_THRESH</span><span class="p">,</span>		<span class="s">&quot;gc_thresh&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_ROUTE_MAX_SIZE</span><span class="p">,</span>		<span class="s">&quot;max_size&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_ROUTE_GC_MIN_INTERVAL</span><span class="p">,</span>		<span class="s">&quot;gc_min_interval&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_ROUTE_GC_TIMEOUT</span><span class="p">,</span>		<span class="s">&quot;gc_timeout&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_ROUTE_GC_INTERVAL</span><span class="p">,</span>		<span class="s">&quot;gc_interval&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_ROUTE_GC_ELASTICITY</span><span class="p">,</span>		<span class="s">&quot;gc_elasticity&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_ROUTE_MTU_EXPIRES</span><span class="p">,</span>		<span class="s">&quot;mtu_expires&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_ROUTE_MIN_ADVMSS</span><span class="p">,</span>		<span class="s">&quot;min_adv_mss&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_ROUTE_GC_MIN_INTERVAL_MS</span><span class="p">,</span>	<span class="s">&quot;gc_min_interval_ms&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_ipv6_icmp_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_ICMP_RATELIMIT</span><span class="p">,</span>	<span class="s">&quot;ratelimit&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_ipv6_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_IPV6_CONF</span><span class="p">,</span>		<span class="s">&quot;conf&quot;</span><span class="p">,</span>		<span class="n">bin_net_ipv6_conf_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_IPV6_NEIGH</span><span class="p">,</span>		<span class="s">&quot;neigh&quot;</span><span class="p">,</span>	<span class="n">bin_net_neigh_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_IPV6_ROUTE</span><span class="p">,</span>		<span class="s">&quot;route&quot;</span><span class="p">,</span>	<span class="n">bin_net_ipv6_route_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_IPV6_ICMP</span><span class="p">,</span>		<span class="s">&quot;icmp&quot;</span><span class="p">,</span>		<span class="n">bin_net_ipv6_icmp_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_BINDV6ONLY</span><span class="p">,</span>		<span class="s">&quot;bindv6only&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_IP6FRAG_HIGH_THRESH</span><span class="p">,</span>	<span class="s">&quot;ip6frag_high_thresh&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_IP6FRAG_LOW_THRESH</span><span class="p">,</span>	<span class="s">&quot;ip6frag_low_thresh&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_IP6FRAG_TIME</span><span class="p">,</span>		<span class="s">&quot;ip6frag_time&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_IP6FRAG_SECRET_INTERVAL</span><span class="p">,</span>	<span class="s">&quot;ip6frag_secret_interval&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IPV6_MLD_MAX_MSF</span><span class="p">,</span>		<span class="s">&quot;mld_max_msf&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="mi">2088</span> <span class="cm">/* IPQ_QMAX */</span><span class="p">,</span>		<span class="s">&quot;ip6_queue_maxlen&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_x25_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_X25_RESTART_REQUEST_TIMEOUT</span><span class="p">,</span>	<span class="s">&quot;restart_request_timeout&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_X25_CALL_REQUEST_TIMEOUT</span><span class="p">,</span>		<span class="s">&quot;call_request_timeout&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_X25_RESET_REQUEST_TIMEOUT</span><span class="p">,</span>	<span class="s">&quot;reset_request_timeout&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_X25_CLEAR_REQUEST_TIMEOUT</span><span class="p">,</span>	<span class="s">&quot;clear_request_timeout&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_X25_ACK_HOLD_BACK_TIMEOUT</span><span class="p">,</span>	<span class="s">&quot;acknowledgement_hold_back_timeout&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_X25_FORWARD</span><span class="p">,</span>			<span class="s">&quot;x25_forward&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_tr_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_TR_RIF_TIMEOUT</span><span class="p">,</span>	<span class="s">&quot;rif_timeout&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>


<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_decnet_conf_vars</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_DECNET_CONF_DEV_FORWARDING</span><span class="p">,</span>	<span class="s">&quot;forwarding&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_DECNET_CONF_DEV_PRIORITY</span><span class="p">,</span>	<span class="s">&quot;priority&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_DECNET_CONF_DEV_T2</span><span class="p">,</span>		<span class="s">&quot;t2&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_DECNET_CONF_DEV_T3</span><span class="p">,</span>		<span class="s">&quot;t3&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_decnet_conf</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span> <span class="n">NET_DECNET_CONF_ETHER</span><span class="p">,</span>    <span class="s">&quot;ethernet&quot;</span><span class="p">,</span> <span class="n">bin_net_decnet_conf_vars</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span> <span class="n">NET_DECNET_CONF_GRE</span><span class="p">,</span>	     <span class="s">&quot;ipgre&quot;</span><span class="p">,</span>    <span class="n">bin_net_decnet_conf_vars</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span> <span class="n">NET_DECNET_CONF_X25</span><span class="p">,</span>	     <span class="s">&quot;x25&quot;</span><span class="p">,</span>      <span class="n">bin_net_decnet_conf_vars</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span> <span class="n">NET_DECNET_CONF_PPP</span><span class="p">,</span>	     <span class="s">&quot;ppp&quot;</span><span class="p">,</span>      <span class="n">bin_net_decnet_conf_vars</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span> <span class="n">NET_DECNET_CONF_DDCMP</span><span class="p">,</span>    <span class="s">&quot;ddcmp&quot;</span><span class="p">,</span>    <span class="n">bin_net_decnet_conf_vars</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span> <span class="n">NET_DECNET_CONF_LOOPBACK</span><span class="p">,</span> <span class="s">&quot;loopback&quot;</span><span class="p">,</span> <span class="n">bin_net_decnet_conf_vars</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>			     <span class="nb">NULL</span><span class="p">,</span>	 <span class="n">bin_net_decnet_conf_vars</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_decnet_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_DECNET_CONF</span><span class="p">,</span>		<span class="s">&quot;conf&quot;</span><span class="p">,</span>	<span class="n">bin_net_decnet_conf</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DNADR</span><span class="p">,</span>	<span class="n">NET_DECNET_NODE_ADDRESS</span><span class="p">,</span>	<span class="s">&quot;node_address&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_STR</span><span class="p">,</span>	<span class="n">NET_DECNET_NODE_NAME</span><span class="p">,</span>		<span class="s">&quot;node_name&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_STR</span><span class="p">,</span>	<span class="n">NET_DECNET_DEFAULT_DEVICE</span><span class="p">,</span>	<span class="s">&quot;default_device&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_DECNET_TIME_WAIT</span><span class="p">,</span>		<span class="s">&quot;time_wait&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_DECNET_DN_COUNT</span><span class="p">,</span>		<span class="s">&quot;dn_count&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_DECNET_DI_COUNT</span><span class="p">,</span>		<span class="s">&quot;di_count&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_DECNET_DR_COUNT</span><span class="p">,</span>		<span class="s">&quot;dr_count&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_DECNET_DST_GC_INTERVAL</span><span class="p">,</span>	<span class="s">&quot;dst_gc_interval&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_DECNET_NO_FC_MAX_CWND</span><span class="p">,</span>	<span class="s">&quot;no_fc_max_cwnd&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_DECNET_MEM</span><span class="p">,</span>		<span class="s">&quot;decnet_mem&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_DECNET_RMEM</span><span class="p">,</span>		<span class="s">&quot;decnet_rmem&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_DECNET_WMEM</span><span class="p">,</span>		<span class="s">&quot;decnet_wmem&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_DECNET_DEBUG_LEVEL</span><span class="p">,</span>	<span class="s">&quot;debug&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_sctp_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_SCTP_RTO_INITIAL</span><span class="p">,</span>		<span class="s">&quot;rto_initial&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_SCTP_RTO_MIN</span><span class="p">,</span>		<span class="s">&quot;rto_min&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_SCTP_RTO_MAX</span><span class="p">,</span>		<span class="s">&quot;rto_max&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_SCTP_RTO_ALPHA</span><span class="p">,</span>		<span class="s">&quot;rto_alpha_exp_divisor&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_SCTP_RTO_BETA</span><span class="p">,</span>		<span class="s">&quot;rto_beta_exp_divisor&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_SCTP_VALID_COOKIE_LIFE</span><span class="p">,</span>	<span class="s">&quot;valid_cookie_life&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_SCTP_ASSOCIATION_MAX_RETRANS</span><span class="p">,</span>	<span class="s">&quot;association_max_retrans&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_SCTP_PATH_MAX_RETRANS</span><span class="p">,</span>	<span class="s">&quot;path_max_retrans&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_SCTP_MAX_INIT_RETRANSMITS</span><span class="p">,</span>	<span class="s">&quot;max_init_retransmits&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_SCTP_HB_INTERVAL</span><span class="p">,</span>		<span class="s">&quot;hb_interval&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_SCTP_PRESERVE_ENABLE</span><span class="p">,</span>	<span class="s">&quot;cookie_preserve_enable&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_SCTP_MAX_BURST</span><span class="p">,</span>		<span class="s">&quot;max_burst&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_SCTP_ADDIP_ENABLE</span><span class="p">,</span>		<span class="s">&quot;addip_enable&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_SCTP_PRSCTP_ENABLE</span><span class="p">,</span>		<span class="s">&quot;prsctp_enable&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_SCTP_SNDBUF_POLICY</span><span class="p">,</span>		<span class="s">&quot;sndbuf_policy&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_SCTP_SACK_TIMEOUT</span><span class="p">,</span>		<span class="s">&quot;sack_timeout&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_SCTP_RCVBUF_POLICY</span><span class="p">,</span>		<span class="s">&quot;rcvbuf_policy&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_llc_llc2_timeout_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_LLC2_ACK_TIMEOUT</span><span class="p">,</span>	<span class="s">&quot;ack&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_LLC2_P_TIMEOUT</span><span class="p">,</span>	<span class="s">&quot;p&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_LLC2_REJ_TIMEOUT</span><span class="p">,</span>	<span class="s">&quot;rej&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_LLC2_BUSY_TIMEOUT</span><span class="p">,</span>	<span class="s">&quot;busy&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_llc_station_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_LLC_STATION_ACK_TIMEOUT</span><span class="p">,</span>	<span class="s">&quot;ack_timeout&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_llc_llc2_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_LLC2</span><span class="p">,</span>		<span class="s">&quot;timeout&quot;</span><span class="p">,</span>	<span class="n">bin_net_llc_llc2_timeout_table</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_llc_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_LLC2</span><span class="p">,</span>		<span class="s">&quot;llc2&quot;</span><span class="p">,</span>		<span class="n">bin_net_llc_llc2_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_LLC_STATION</span><span class="p">,</span>	<span class="s">&quot;station&quot;</span><span class="p">,</span>	<span class="n">bin_net_llc_station_table</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_netfilter_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NF_CONNTRACK_MAX</span><span class="p">,</span>			<span class="s">&quot;nf_conntrack_max&quot;</span> <span class="p">},</span>
	<span class="cm">/* NET_NF_CONNTRACK_TCP_TIMEOUT_SYN_SENT &quot;nf_conntrack_tcp_timeout_syn_sent&quot; no longer used */</span>
	<span class="cm">/* NET_NF_CONNTRACK_TCP_TIMEOUT_SYN_RECV &quot;nf_conntrack_tcp_timeout_syn_recv&quot; no longer used */</span>
	<span class="cm">/* NET_NF_CONNTRACK_TCP_TIMEOUT_ESTABLISHED &quot;nf_conntrack_tcp_timeout_established&quot; no longer used */</span>
	<span class="cm">/* NET_NF_CONNTRACK_TCP_TIMEOUT_FIN_WAIT &quot;nf_conntrack_tcp_timeout_fin_wait&quot; no longer used */</span>
	<span class="cm">/* NET_NF_CONNTRACK_TCP_TIMEOUT_CLOSE_WAIT &quot;nf_conntrack_tcp_timeout_close_wait&quot; no longer used */</span>
	<span class="cm">/* NET_NF_CONNTRACK_TCP_TIMEOUT_LAST_ACK &quot;nf_conntrack_tcp_timeout_last_ack&quot; no longer used */</span>
	<span class="cm">/* NET_NF_CONNTRACK_TCP_TIMEOUT_TIME_WAIT &quot;nf_conntrack_tcp_timeout_time_wait&quot; no longer used */</span>
	<span class="cm">/* NET_NF_CONNTRACK_TCP_TIMEOUT_CLOSE &quot;nf_conntrack_tcp_timeout_close&quot; no longer used */</span>
	<span class="cm">/* NET_NF_CONNTRACK_UDP_TIMEOUT	&quot;nf_conntrack_udp_timeout&quot; no longer used */</span>
	<span class="cm">/* NET_NF_CONNTRACK_UDP_TIMEOUT_STREAM &quot;nf_conntrack_udp_timeout_stream&quot; no longer used */</span>
	<span class="cm">/* NET_NF_CONNTRACK_ICMP_TIMEOUT &quot;nf_conntrack_icmp_timeout&quot; no longer used */</span>
	<span class="cm">/* NET_NF_CONNTRACK_GENERIC_TIMEOUT &quot;nf_conntrack_generic_timeout&quot; no longer used */</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NF_CONNTRACK_BUCKETS</span><span class="p">,</span>		<span class="s">&quot;nf_conntrack_buckets&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NF_CONNTRACK_LOG_INVALID</span><span class="p">,</span>		<span class="s">&quot;nf_conntrack_log_invalid&quot;</span> <span class="p">},</span>
	<span class="cm">/* NET_NF_CONNTRACK_TCP_TIMEOUT_MAX_RETRANS &quot;nf_conntrack_tcp_timeout_max_retrans&quot; no longer used */</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NF_CONNTRACK_TCP_LOOSE</span><span class="p">,</span>		<span class="s">&quot;nf_conntrack_tcp_loose&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NF_CONNTRACK_TCP_BE_LIBERAL</span><span class="p">,</span>	<span class="s">&quot;nf_conntrack_tcp_be_liberal&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NF_CONNTRACK_TCP_MAX_RETRANS</span><span class="p">,</span>	<span class="s">&quot;nf_conntrack_tcp_max_retrans&quot;</span> <span class="p">},</span>
	<span class="cm">/* NET_NF_CONNTRACK_SCTP_TIMEOUT_CLOSED &quot;nf_conntrack_sctp_timeout_closed&quot; no longer used */</span>
	<span class="cm">/* NET_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_WAIT &quot;nf_conntrack_sctp_timeout_cookie_wait&quot; no longer used */</span>
	<span class="cm">/* NET_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_ECHOED &quot;nf_conntrack_sctp_timeout_cookie_echoed&quot; no longer used */</span>
	<span class="cm">/* NET_NF_CONNTRACK_SCTP_TIMEOUT_ESTABLISHED &quot;nf_conntrack_sctp_timeout_established&quot; no longer used */</span>
	<span class="cm">/* NET_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_SENT &quot;nf_conntrack_sctp_timeout_shutdown_sent&quot; no longer used */</span>
	<span class="cm">/* NET_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_RECD &quot;nf_conntrack_sctp_timeout_shutdown_recd&quot; no longer used */</span>
	<span class="cm">/* NET_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_ACK_SENT &quot;nf_conntrack_sctp_timeout_shutdown_ack_sent&quot; no longer used */</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NF_CONNTRACK_COUNT</span><span class="p">,</span>			<span class="s">&quot;nf_conntrack_count&quot;</span> <span class="p">},</span>
	<span class="cm">/* NET_NF_CONNTRACK_ICMPV6_TIMEOUT &quot;nf_conntrack_icmpv6_timeout&quot; no longer used */</span>
	<span class="cm">/* NET_NF_CONNTRACK_FRAG6_TIMEOUT &quot;nf_conntrack_frag6_timeout&quot; no longer used */</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NF_CONNTRACK_FRAG6_LOW_THRESH</span><span class="p">,</span>	<span class="s">&quot;nf_conntrack_frag6_low_thresh&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NF_CONNTRACK_FRAG6_HIGH_THRESH</span><span class="p">,</span>	<span class="s">&quot;nf_conntrack_frag6_high_thresh&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_NF_CONNTRACK_CHECKSUM</span><span class="p">,</span>		<span class="s">&quot;nf_conntrack_checksum&quot;</span> <span class="p">},</span>

	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_irda_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IRDA_DISCOVERY</span><span class="p">,</span>		<span class="s">&quot;discovery&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_STR</span><span class="p">,</span>	<span class="n">NET_IRDA_DEVNAME</span><span class="p">,</span>		<span class="s">&quot;devname&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IRDA_DEBUG</span><span class="p">,</span>			<span class="s">&quot;debug&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IRDA_FAST_POLL</span><span class="p">,</span>		<span class="s">&quot;fast_poll_increase&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IRDA_DISCOVERY_SLOTS</span><span class="p">,</span>	<span class="s">&quot;discovery_slots&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IRDA_DISCOVERY_TIMEOUT</span><span class="p">,</span>	<span class="s">&quot;discovery_timeout&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IRDA_SLOT_TIMEOUT</span><span class="p">,</span>		<span class="s">&quot;slot_timeout&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IRDA_MAX_BAUD_RATE</span><span class="p">,</span>		<span class="s">&quot;max_baud_rate&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IRDA_MIN_TX_TURN_TIME</span><span class="p">,</span>	<span class="s">&quot;min_tx_turn_time&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IRDA_MAX_TX_DATA_SIZE</span><span class="p">,</span>	<span class="s">&quot;max_tx_data_size&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IRDA_MAX_TX_WINDOW</span><span class="p">,</span>		<span class="s">&quot;max_tx_window&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IRDA_MAX_NOREPLY_TIME</span><span class="p">,</span>	<span class="s">&quot;max_noreply_time&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IRDA_WARN_NOREPLY_TIME</span><span class="p">,</span>	<span class="s">&quot;warn_noreply_time&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">NET_IRDA_LAP_KEEPALIVE_TIME</span><span class="p">,</span>	<span class="s">&quot;lap_keepalive_time&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_net_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_CORE</span><span class="p">,</span>		<span class="s">&quot;core&quot;</span><span class="p">,</span>		<span class="n">bin_net_core_table</span> <span class="p">},</span>
	<span class="cm">/* NET_ETHER not used */</span>
	<span class="cm">/* NET_802 not used */</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_UNIX</span><span class="p">,</span>		<span class="s">&quot;unix&quot;</span><span class="p">,</span>		<span class="n">bin_net_unix_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_IPV4</span><span class="p">,</span>		<span class="s">&quot;ipv4&quot;</span><span class="p">,</span>		<span class="n">bin_net_ipv4_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_IPX</span><span class="p">,</span>		<span class="s">&quot;ipx&quot;</span><span class="p">,</span>		<span class="n">bin_net_ipx_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_ATALK</span><span class="p">,</span>		<span class="s">&quot;appletalk&quot;</span><span class="p">,</span>	<span class="n">bin_net_atalk_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_NETROM</span><span class="p">,</span>		<span class="s">&quot;netrom&quot;</span><span class="p">,</span>	<span class="n">bin_net_netrom_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_AX25</span><span class="p">,</span>		<span class="s">&quot;ax25&quot;</span><span class="p">,</span>		<span class="n">bin_net_ax25_table</span> <span class="p">},</span>
	<span class="cm">/*  NET_BRIDGE &quot;bridge&quot; no longer used */</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_ROSE</span><span class="p">,</span>		<span class="s">&quot;rose&quot;</span><span class="p">,</span>		<span class="n">bin_net_rose_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_IPV6</span><span class="p">,</span>		<span class="s">&quot;ipv6&quot;</span><span class="p">,</span>		<span class="n">bin_net_ipv6_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_X25</span><span class="p">,</span>		<span class="s">&quot;x25&quot;</span><span class="p">,</span>		<span class="n">bin_net_x25_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_TR</span><span class="p">,</span>			<span class="s">&quot;token-ring&quot;</span><span class="p">,</span>	<span class="n">bin_net_tr_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_DECNET</span><span class="p">,</span>		<span class="s">&quot;decnet&quot;</span><span class="p">,</span>	<span class="n">bin_net_decnet_table</span> <span class="p">},</span>
	<span class="cm">/*  NET_ECONET not used */</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_SCTP</span><span class="p">,</span>		<span class="s">&quot;sctp&quot;</span><span class="p">,</span>		<span class="n">bin_net_sctp_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_LLC</span><span class="p">,</span>		<span class="s">&quot;llc&quot;</span><span class="p">,</span>		<span class="n">bin_net_llc_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_NETFILTER</span><span class="p">,</span>		<span class="s">&quot;netfilter&quot;</span><span class="p">,</span>	<span class="n">bin_net_netfilter_table</span> <span class="p">},</span>
	<span class="cm">/* NET_DCCP &quot;dccp&quot; no longer used */</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">NET_IRDA</span><span class="p">,</span>		<span class="s">&quot;irda&quot;</span><span class="p">,</span>		<span class="n">bin_net_irda_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="mi">2089</span><span class="p">,</span>			<span class="s">&quot;nf_conntrack_max&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_fs_quota_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">FS_DQ_LOOKUPS</span><span class="p">,</span>		<span class="s">&quot;lookups&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">FS_DQ_DROPS</span><span class="p">,</span>		<span class="s">&quot;drops&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">FS_DQ_READS</span><span class="p">,</span>		<span class="s">&quot;reads&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">FS_DQ_WRITES</span><span class="p">,</span>		<span class="s">&quot;writes&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">FS_DQ_CACHE_HITS</span><span class="p">,</span>	<span class="s">&quot;cache_hits&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">FS_DQ_ALLOCATED</span><span class="p">,</span>	<span class="s">&quot;allocated_dquots&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">FS_DQ_FREE</span><span class="p">,</span>		<span class="s">&quot;free_dquots&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">FS_DQ_SYNCS</span><span class="p">,</span>		<span class="s">&quot;syncs&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">FS_DQ_WARNINGS</span><span class="p">,</span>		<span class="s">&quot;warnings&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_fs_xfs_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">XFS_SGID_INHERIT</span><span class="p">,</span>	<span class="s">&quot;irix_sgid_inherit&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">XFS_SYMLINK_MODE</span><span class="p">,</span>	<span class="s">&quot;irix_symlink_mode&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">XFS_PANIC_MASK</span><span class="p">,</span>		<span class="s">&quot;panic_mask&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">XFS_ERRLEVEL</span><span class="p">,</span>		<span class="s">&quot;error_level&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">XFS_SYNCD_TIMER</span><span class="p">,</span>	<span class="s">&quot;xfssyncd_centisecs&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">XFS_INHERIT_SYNC</span><span class="p">,</span>	<span class="s">&quot;inherit_sync&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">XFS_INHERIT_NODUMP</span><span class="p">,</span>	<span class="s">&quot;inherit_nodump&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">XFS_INHERIT_NOATIME</span><span class="p">,</span>	<span class="s">&quot;inherit_noatime&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">XFS_BUF_TIMER</span><span class="p">,</span>		<span class="s">&quot;xfsbufd_centisecs&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">XFS_BUF_AGE</span><span class="p">,</span>		<span class="s">&quot;age_buffer_centisecs&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">XFS_INHERIT_NOSYM</span><span class="p">,</span>	<span class="s">&quot;inherit_nosymlinks&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">XFS_ROTORSTEP</span><span class="p">,</span>	<span class="s">&quot;rotorstep&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">XFS_INHERIT_NODFRG</span><span class="p">,</span>	<span class="s">&quot;inherit_nodefrag&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">XFS_FILESTREAM_TIMER</span><span class="p">,</span>	<span class="s">&quot;filestream_centisecs&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">XFS_STATS_CLEAR</span><span class="p">,</span>	<span class="s">&quot;stats_clear&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_fs_ocfs2_nm_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_STR</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span> <span class="s">&quot;hb_ctl_path&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_fs_ocfs2_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="s">&quot;nm&quot;</span><span class="p">,</span>	<span class="n">bin_fs_ocfs2_nm_table</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_inotify_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">INOTIFY_MAX_USER_INSTANCES</span><span class="p">,</span>	<span class="s">&quot;max_user_instances&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">INOTIFY_MAX_USER_WATCHES</span><span class="p">,</span>	<span class="s">&quot;max_user_watches&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">INOTIFY_MAX_QUEUED_EVENTS</span><span class="p">,</span>	<span class="s">&quot;max_queued_events&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_fs_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">FS_NRINODE</span><span class="p">,</span>		<span class="s">&quot;inode-nr&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">FS_STATINODE</span><span class="p">,</span>		<span class="s">&quot;inode-state&quot;</span> <span class="p">},</span>
	<span class="cm">/* FS_MAXINODE unused */</span>
	<span class="cm">/* FS_NRDQUOT unused */</span>
	<span class="cm">/* FS_MAXDQUOT unused */</span>
	<span class="cm">/* FS_NRFILE &quot;file-nr&quot; no longer used */</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">FS_MAXFILE</span><span class="p">,</span>		<span class="s">&quot;file-max&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">FS_DENTRY</span><span class="p">,</span>		<span class="s">&quot;dentry-state&quot;</span> <span class="p">},</span>
	<span class="cm">/* FS_NRSUPER unused */</span>
	<span class="cm">/* FS_MAXUPSER unused */</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">FS_OVERFLOWUID</span><span class="p">,</span>		<span class="s">&quot;overflowuid&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">FS_OVERFLOWGID</span><span class="p">,</span>		<span class="s">&quot;overflowgid&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">FS_LEASES</span><span class="p">,</span>		<span class="s">&quot;leases-enable&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">FS_DIR_NOTIFY</span><span class="p">,</span>		<span class="s">&quot;dir-notify-enable&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">FS_LEASE_TIME</span><span class="p">,</span>		<span class="s">&quot;lease-break-time&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">FS_DQSTATS</span><span class="p">,</span>		<span class="s">&quot;quota&quot;</span><span class="p">,</span>	<span class="n">bin_fs_quota_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">FS_XFS</span><span class="p">,</span>			<span class="s">&quot;xfs&quot;</span><span class="p">,</span>		<span class="n">bin_fs_xfs_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_ULONG</span><span class="p">,</span>	<span class="n">FS_AIO_NR</span><span class="p">,</span>		<span class="s">&quot;aio-nr&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_ULONG</span><span class="p">,</span>	<span class="n">FS_AIO_MAX_NR</span><span class="p">,</span>		<span class="s">&quot;aio-max-nr&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">FS_INOTIFY</span><span class="p">,</span>		<span class="s">&quot;inotify&quot;</span><span class="p">,</span>	<span class="n">bin_inotify_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">FS_OCFS2</span><span class="p">,</span>		<span class="s">&quot;ocfs2&quot;</span><span class="p">,</span>	<span class="n">bin_fs_ocfs2_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">KERN_SETUID_DUMPABLE</span><span class="p">,</span>	<span class="s">&quot;suid_dumpable&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_ipmi_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">DEV_IPMI_POWEROFF_POWERCYCLE</span><span class="p">,</span>	<span class="s">&quot;poweroff_powercycle&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_mac_hid_files</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* DEV_MAC_HID_KEYBOARD_SENDS_LINUX_KEYCODES unused */</span>
	<span class="cm">/* DEV_MAC_HID_KEYBOARD_LOCK_KEYCODES unused */</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">DEV_MAC_HID_MOUSE_BUTTON_EMULATION</span><span class="p">,</span>	<span class="s">&quot;mouse_button_emulation&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">DEV_MAC_HID_MOUSE_BUTTON2_KEYCODE</span><span class="p">,</span>	<span class="s">&quot;mouse_button2_keycode&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">DEV_MAC_HID_MOUSE_BUTTON3_KEYCODE</span><span class="p">,</span>	<span class="s">&quot;mouse_button3_keycode&quot;</span> <span class="p">},</span>
	<span class="cm">/* DEV_MAC_HID_ADB_MOUSE_SENDS_KEYCODES unused */</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_raid_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">DEV_RAID_SPEED_LIMIT_MIN</span><span class="p">,</span>	<span class="s">&quot;speed_limit_min&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">DEV_RAID_SPEED_LIMIT_MAX</span><span class="p">,</span>	<span class="s">&quot;speed_limit_max&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_scsi_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span> <span class="n">DEV_SCSI_LOGGING_LEVEL</span><span class="p">,</span> <span class="s">&quot;logging_level&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_dev_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* DEV_CDROM	&quot;cdrom&quot; no longer used */</span>
	<span class="cm">/* DEV_HWMON unused */</span>
	<span class="cm">/* DEV_PARPORT	&quot;parport&quot; no longer used */</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">DEV_RAID</span><span class="p">,</span>	<span class="s">&quot;raid&quot;</span><span class="p">,</span>		<span class="n">bin_raid_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">DEV_MAC_HID</span><span class="p">,</span>	<span class="s">&quot;mac_hid&quot;</span><span class="p">,</span>	<span class="n">bin_mac_hid_files</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">DEV_SCSI</span><span class="p">,</span>	<span class="s">&quot;scsi&quot;</span><span class="p">,</span>		<span class="n">bin_scsi_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">DEV_IPMI</span><span class="p">,</span>	<span class="s">&quot;ipmi&quot;</span><span class="p">,</span>		<span class="n">bin_ipmi_table</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_bus_isa_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">BUS_ISA_MEM_BASE</span><span class="p">,</span>	<span class="s">&quot;membase&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">BUS_ISA_PORT_BASE</span><span class="p">,</span>	<span class="s">&quot;portbase&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">BUS_ISA_PORT_SHIFT</span><span class="p">,</span>	<span class="s">&quot;portshift&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_bus_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">CTL_BUS_ISA</span><span class="p">,</span>	<span class="s">&quot;isa&quot;</span><span class="p">,</span>	<span class="n">bin_bus_isa_table</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>


<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_s390dbf_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="mi">5678</span> <span class="cm">/* CTL_S390DBF_STOPPABLE */</span><span class="p">,</span> <span class="s">&quot;debug_stoppable&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="mi">5679</span> <span class="cm">/* CTL_S390DBF_ACTIVE */</span><span class="p">,</span>	  <span class="s">&quot;debug_active&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_sunrpc_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* CTL_RPCDEBUG	&quot;rpc_debug&quot;  no longer used */</span>
	<span class="cm">/* CTL_NFSDEBUG &quot;nfs_debug&quot;  no longer used */</span>
	<span class="cm">/* CTL_NFSDDEBUG &quot;nfsd_debug&quot; no longer used  */</span>
	<span class="cm">/* CTL_NLMDEBUG &quot;nlm_debug&quot; no longer used */</span>

	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">CTL_SLOTTABLE_UDP</span><span class="p">,</span>	<span class="s">&quot;udp_slot_table_entries&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">CTL_SLOTTABLE_TCP</span><span class="p">,</span>	<span class="s">&quot;tcp_slot_table_entries&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">CTL_MIN_RESVPORT</span><span class="p">,</span>	<span class="s">&quot;min_resvport&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="n">CTL_MAX_RESVPORT</span><span class="p">,</span>	<span class="s">&quot;max_resvport&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_pm_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* frv specific */</span>
	<span class="cm">/* 1 == CTL_PM_SUSPEND	&quot;suspend&quot;  no longer used&quot; */</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="mi">2</span> <span class="cm">/* CTL_PM_CMODE */</span><span class="p">,</span>		<span class="s">&quot;cmode&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="mi">3</span> <span class="cm">/* CTL_PM_P0 */</span><span class="p">,</span>		<span class="s">&quot;p0&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_INT</span><span class="p">,</span>	<span class="mi">4</span> <span class="cm">/* CTL_PM_CM */</span><span class="p">,</span>		<span class="s">&quot;cm&quot;</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="n">bin_root_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">CTL_KERN</span><span class="p">,</span>	<span class="s">&quot;kernel&quot;</span><span class="p">,</span>	<span class="n">bin_kern_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">CTL_VM</span><span class="p">,</span>		<span class="s">&quot;vm&quot;</span><span class="p">,</span>		<span class="n">bin_vm_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">CTL_NET</span><span class="p">,</span>	<span class="s">&quot;net&quot;</span><span class="p">,</span>		<span class="n">bin_net_table</span> <span class="p">},</span>
	<span class="cm">/* CTL_PROC not used */</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">CTL_FS</span><span class="p">,</span>		<span class="s">&quot;fs&quot;</span><span class="p">,</span>		<span class="n">bin_fs_table</span> <span class="p">},</span>
	<span class="cm">/* CTL_DEBUG &quot;debug&quot; no longer used */</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">CTL_DEV</span><span class="p">,</span>	<span class="s">&quot;dev&quot;</span><span class="p">,</span>		<span class="n">bin_dev_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">CTL_BUS</span><span class="p">,</span>	<span class="s">&quot;bus&quot;</span><span class="p">,</span>		<span class="n">bin_bus_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">CTL_ABI</span><span class="p">,</span>	<span class="s">&quot;abi&quot;</span> <span class="p">},</span>
	<span class="cm">/* CTL_CPU not used */</span>
	<span class="cm">/* CTL_ARLAN &quot;arlan&quot; no longer used */</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">CTL_S390DBF</span><span class="p">,</span>	<span class="s">&quot;s390dbf&quot;</span><span class="p">,</span>	<span class="n">bin_s390dbf_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">CTL_SUNRPC</span><span class="p">,</span>	<span class="s">&quot;sunrpc&quot;</span><span class="p">,</span>	<span class="n">bin_sunrpc_table</span> <span class="p">},</span>
	<span class="p">{</span> <span class="n">CTL_DIR</span><span class="p">,</span>	<span class="n">CTL_PM</span><span class="p">,</span>		<span class="s">&quot;pm&quot;</span><span class="p">,</span>		<span class="n">bin_pm_table</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">ssize_t</span> <span class="nf">bin_dir</span><span class="p">(</span><span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="n">file</span><span class="p">,</span>
	<span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">oldval</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">oldlen</span><span class="p">,</span> <span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">newval</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">newlen</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="o">-</span><span class="n">ENOTDIR</span><span class="p">;</span>
<span class="p">}</span>


<span class="k">static</span> <span class="kt">ssize_t</span> <span class="nf">bin_string</span><span class="p">(</span><span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="n">file</span><span class="p">,</span>
	<span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">oldval</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">oldlen</span><span class="p">,</span> <span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">newval</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">newlen</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">ssize_t</span> <span class="n">result</span><span class="p">,</span> <span class="n">copied</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">oldval</span> <span class="o">&amp;&amp;</span> <span class="n">oldlen</span><span class="p">)</span> <span class="p">{</span>
		<span class="kt">char</span> <span class="n">__user</span> <span class="o">*</span><span class="n">lastp</span><span class="p">;</span>
		<span class="n">loff_t</span> <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">ch</span><span class="p">;</span>

		<span class="n">result</span> <span class="o">=</span> <span class="n">vfs_read</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">oldval</span><span class="p">,</span> <span class="n">oldlen</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pos</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>

		<span class="n">copied</span> <span class="o">=</span> <span class="n">result</span><span class="p">;</span>
		<span class="n">lastp</span> <span class="o">=</span> <span class="n">oldval</span> <span class="o">+</span> <span class="n">copied</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>

		<span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">get_user</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="n">lastp</span><span class="p">))</span>
			<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>

		<span class="cm">/* Trim off the trailing newline */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ch</span> <span class="o">==</span> <span class="sc">&#39;\n&#39;</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">put_user</span><span class="p">(</span><span class="sc">&#39;\0&#39;</span><span class="p">,</span> <span class="n">lastp</span><span class="p">))</span>
				<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>
			<span class="n">copied</span> <span class="o">-=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">newval</span> <span class="o">&amp;&amp;</span> <span class="n">newlen</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">loff_t</span> <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

		<span class="n">result</span> <span class="o">=</span> <span class="n">vfs_write</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">newval</span><span class="p">,</span> <span class="n">newlen</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pos</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">result</span> <span class="o">=</span> <span class="n">copied</span><span class="p">;</span>
<span class="nl">out:</span>
	<span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">ssize_t</span> <span class="nf">bin_intvec</span><span class="p">(</span><span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="n">file</span><span class="p">,</span>
	<span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">oldval</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">oldlen</span><span class="p">,</span> <span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">newval</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">newlen</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">mm_segment_t</span> <span class="n">old_fs</span> <span class="o">=</span> <span class="n">get_fs</span><span class="p">();</span>
	<span class="kt">ssize_t</span> <span class="n">copied</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">char</span> <span class="o">*</span><span class="n">buffer</span><span class="p">;</span>
	<span class="kt">ssize_t</span> <span class="n">result</span><span class="p">;</span>

	<span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>
	<span class="n">buffer</span> <span class="o">=</span> <span class="n">kmalloc</span><span class="p">(</span><span class="n">BUFSZ</span><span class="p">,</span> <span class="n">GFP_KERNEL</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">buffer</span><span class="p">)</span>
		<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">oldval</span> <span class="o">&amp;&amp;</span> <span class="n">oldlen</span><span class="p">)</span> <span class="p">{</span>
		<span class="kt">unsigned</span> <span class="n">__user</span> <span class="o">*</span><span class="n">vec</span> <span class="o">=</span> <span class="n">oldval</span><span class="p">;</span>
		<span class="kt">size_t</span> <span class="n">length</span> <span class="o">=</span> <span class="n">oldlen</span> <span class="o">/</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">vec</span><span class="p">);</span>
		<span class="n">loff_t</span> <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">,</span> <span class="o">*</span><span class="n">end</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

		<span class="n">set_fs</span><span class="p">(</span><span class="n">KERNEL_DS</span><span class="p">);</span>
		<span class="n">result</span> <span class="o">=</span> <span class="n">vfs_read</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">BUFSZ</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pos</span><span class="p">);</span>
		<span class="n">set_fs</span><span class="p">(</span><span class="n">old_fs</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">out_kfree</span><span class="p">;</span>

		<span class="n">str</span> <span class="o">=</span> <span class="n">buffer</span><span class="p">;</span>
		<span class="n">end</span> <span class="o">=</span> <span class="n">str</span> <span class="o">+</span> <span class="n">result</span><span class="p">;</span>
		<span class="o">*</span><span class="n">end</span><span class="o">++</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">value</span><span class="p">;</span>

			<span class="n">value</span> <span class="o">=</span> <span class="n">simple_strtoul</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">str</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
			<span class="k">while</span> <span class="p">(</span><span class="n">isspace</span><span class="p">(</span><span class="o">*</span><span class="n">str</span><span class="p">))</span>
				<span class="n">str</span><span class="o">++</span><span class="p">;</span>
			
			<span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">put_user</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">vec</span> <span class="o">+</span> <span class="n">i</span><span class="p">))</span>
				<span class="k">goto</span> <span class="n">out_kfree</span><span class="p">;</span>

			<span class="n">copied</span> <span class="o">+=</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">vec</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">isdigit</span><span class="p">(</span><span class="o">*</span><span class="n">str</span><span class="p">))</span>
				<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">newval</span> <span class="o">&amp;&amp;</span> <span class="n">newlen</span><span class="p">)</span> <span class="p">{</span>
		<span class="kt">unsigned</span> <span class="n">__user</span> <span class="o">*</span><span class="n">vec</span> <span class="o">=</span> <span class="n">newval</span><span class="p">;</span>
		<span class="kt">size_t</span> <span class="n">length</span> <span class="o">=</span> <span class="n">newlen</span> <span class="o">/</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">vec</span><span class="p">);</span>
		<span class="n">loff_t</span> <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">,</span> <span class="o">*</span><span class="n">end</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

		<span class="n">str</span> <span class="o">=</span> <span class="n">buffer</span><span class="p">;</span>
		<span class="n">end</span> <span class="o">=</span> <span class="n">str</span> <span class="o">+</span> <span class="n">BUFSZ</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">value</span><span class="p">;</span>

			<span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">get_user</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">vec</span> <span class="o">+</span> <span class="n">i</span><span class="p">))</span>
				<span class="k">goto</span> <span class="n">out_kfree</span><span class="p">;</span>

			<span class="n">str</span> <span class="o">+=</span> <span class="n">snprintf</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">end</span> <span class="o">-</span> <span class="n">str</span><span class="p">,</span> <span class="s">&quot;%lu</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
		<span class="p">}</span>

		<span class="n">set_fs</span><span class="p">(</span><span class="n">KERNEL_DS</span><span class="p">);</span>
		<span class="n">result</span> <span class="o">=</span> <span class="n">vfs_write</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">str</span> <span class="o">-</span> <span class="n">buffer</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pos</span><span class="p">);</span>
		<span class="n">set_fs</span><span class="p">(</span><span class="n">old_fs</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">out_kfree</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">result</span> <span class="o">=</span> <span class="n">copied</span><span class="p">;</span>
<span class="nl">out_kfree:</span>
	<span class="n">kfree</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>
<span class="nl">out:</span>
	<span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">ssize_t</span> <span class="nf">bin_ulongvec</span><span class="p">(</span><span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="n">file</span><span class="p">,</span>
	<span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">oldval</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">oldlen</span><span class="p">,</span> <span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">newval</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">newlen</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">mm_segment_t</span> <span class="n">old_fs</span> <span class="o">=</span> <span class="n">get_fs</span><span class="p">();</span>
	<span class="kt">ssize_t</span> <span class="n">copied</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">char</span> <span class="o">*</span><span class="n">buffer</span><span class="p">;</span>
	<span class="kt">ssize_t</span> <span class="n">result</span><span class="p">;</span>

	<span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>
	<span class="n">buffer</span> <span class="o">=</span> <span class="n">kmalloc</span><span class="p">(</span><span class="n">BUFSZ</span><span class="p">,</span> <span class="n">GFP_KERNEL</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">buffer</span><span class="p">)</span>
		<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">oldval</span> <span class="o">&amp;&amp;</span> <span class="n">oldlen</span><span class="p">)</span> <span class="p">{</span>
		<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">__user</span> <span class="o">*</span><span class="n">vec</span> <span class="o">=</span> <span class="n">oldval</span><span class="p">;</span>
		<span class="kt">size_t</span> <span class="n">length</span> <span class="o">=</span> <span class="n">oldlen</span> <span class="o">/</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">vec</span><span class="p">);</span>
		<span class="n">loff_t</span> <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">,</span> <span class="o">*</span><span class="n">end</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

		<span class="n">set_fs</span><span class="p">(</span><span class="n">KERNEL_DS</span><span class="p">);</span>
		<span class="n">result</span> <span class="o">=</span> <span class="n">vfs_read</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">BUFSZ</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pos</span><span class="p">);</span>
		<span class="n">set_fs</span><span class="p">(</span><span class="n">old_fs</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">out_kfree</span><span class="p">;</span>

		<span class="n">str</span> <span class="o">=</span> <span class="n">buffer</span><span class="p">;</span>
		<span class="n">end</span> <span class="o">=</span> <span class="n">str</span> <span class="o">+</span> <span class="n">result</span><span class="p">;</span>
		<span class="o">*</span><span class="n">end</span><span class="o">++</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">value</span><span class="p">;</span>

			<span class="n">value</span> <span class="o">=</span> <span class="n">simple_strtoul</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">str</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
			<span class="k">while</span> <span class="p">(</span><span class="n">isspace</span><span class="p">(</span><span class="o">*</span><span class="n">str</span><span class="p">))</span>
				<span class="n">str</span><span class="o">++</span><span class="p">;</span>
			
			<span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">put_user</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">vec</span> <span class="o">+</span> <span class="n">i</span><span class="p">))</span>
				<span class="k">goto</span> <span class="n">out_kfree</span><span class="p">;</span>

			<span class="n">copied</span> <span class="o">+=</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">vec</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">isdigit</span><span class="p">(</span><span class="o">*</span><span class="n">str</span><span class="p">))</span>
				<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">newval</span> <span class="o">&amp;&amp;</span> <span class="n">newlen</span><span class="p">)</span> <span class="p">{</span>
		<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">__user</span> <span class="o">*</span><span class="n">vec</span> <span class="o">=</span> <span class="n">newval</span><span class="p">;</span>
		<span class="kt">size_t</span> <span class="n">length</span> <span class="o">=</span> <span class="n">newlen</span> <span class="o">/</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">vec</span><span class="p">);</span>
		<span class="n">loff_t</span> <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">,</span> <span class="o">*</span><span class="n">end</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

		<span class="n">str</span> <span class="o">=</span> <span class="n">buffer</span><span class="p">;</span>
		<span class="n">end</span> <span class="o">=</span> <span class="n">str</span> <span class="o">+</span> <span class="n">BUFSZ</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">value</span><span class="p">;</span>

			<span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">get_user</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">vec</span> <span class="o">+</span> <span class="n">i</span><span class="p">))</span>
				<span class="k">goto</span> <span class="n">out_kfree</span><span class="p">;</span>

			<span class="n">str</span> <span class="o">+=</span> <span class="n">snprintf</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">end</span> <span class="o">-</span> <span class="n">str</span><span class="p">,</span> <span class="s">&quot;%lu</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
		<span class="p">}</span>

		<span class="n">set_fs</span><span class="p">(</span><span class="n">KERNEL_DS</span><span class="p">);</span>
		<span class="n">result</span> <span class="o">=</span> <span class="n">vfs_write</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">str</span> <span class="o">-</span> <span class="n">buffer</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pos</span><span class="p">);</span>
		<span class="n">set_fs</span><span class="p">(</span><span class="n">old_fs</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">out_kfree</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">result</span> <span class="o">=</span> <span class="n">copied</span><span class="p">;</span>
<span class="nl">out_kfree:</span>
	<span class="n">kfree</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>
<span class="nl">out:</span>
	<span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">ssize_t</span> <span class="nf">bin_uuid</span><span class="p">(</span><span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="n">file</span><span class="p">,</span>
	<span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">oldval</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">oldlen</span><span class="p">,</span> <span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">newval</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">newlen</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">mm_segment_t</span> <span class="n">old_fs</span> <span class="o">=</span> <span class="n">get_fs</span><span class="p">();</span>
	<span class="kt">ssize_t</span> <span class="n">result</span><span class="p">,</span> <span class="n">copied</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="cm">/* Only supports reads */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">oldval</span> <span class="o">&amp;&amp;</span> <span class="n">oldlen</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">loff_t</span> <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">40</span><span class="p">],</span> <span class="o">*</span><span class="n">str</span> <span class="o">=</span> <span class="n">buf</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">uuid</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
		<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

		<span class="n">set_fs</span><span class="p">(</span><span class="n">KERNEL_DS</span><span class="p">);</span>
		<span class="n">result</span> <span class="o">=</span> <span class="n">vfs_read</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pos</span><span class="p">);</span>
		<span class="n">set_fs</span><span class="p">(</span><span class="n">old_fs</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>

		<span class="n">buf</span><span class="p">[</span><span class="n">result</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>

		<span class="cm">/* Convert the uuid to from a string to binary */</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="n">EIO</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">isxdigit</span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">||</span> <span class="o">!</span><span class="n">isxdigit</span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
				<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>

			<span class="n">uuid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">hex_to_bin</span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span>
					<span class="n">hex_to_bin</span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
			<span class="n">str</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="n">str</span> <span class="o">==</span> <span class="sc">&#39;-&#39;</span><span class="p">)</span>
				<span class="n">str</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">oldlen</span> <span class="o">&gt;</span> <span class="mi">16</span><span class="p">)</span>
			<span class="n">oldlen</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>

		<span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">copy_to_user</span><span class="p">(</span><span class="n">oldval</span><span class="p">,</span> <span class="n">uuid</span><span class="p">,</span> <span class="n">oldlen</span><span class="p">))</span>
			<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>

		<span class="n">copied</span> <span class="o">=</span> <span class="n">oldlen</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">result</span> <span class="o">=</span> <span class="n">copied</span><span class="p">;</span>
<span class="nl">out:</span>
	<span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">ssize_t</span> <span class="nf">bin_dn_node_address</span><span class="p">(</span><span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="n">file</span><span class="p">,</span>
	<span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">oldval</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">oldlen</span><span class="p">,</span> <span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">newval</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">newlen</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">mm_segment_t</span> <span class="n">old_fs</span> <span class="o">=</span> <span class="n">get_fs</span><span class="p">();</span>
	<span class="kt">ssize_t</span> <span class="n">result</span><span class="p">,</span> <span class="n">copied</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">oldval</span> <span class="o">&amp;&amp;</span> <span class="n">oldlen</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">loff_t</span> <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span> <span class="o">*</span><span class="n">nodep</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">area</span><span class="p">,</span> <span class="n">node</span><span class="p">;</span>
		<span class="n">__le16</span> <span class="n">dnaddr</span><span class="p">;</span>

		<span class="n">set_fs</span><span class="p">(</span><span class="n">KERNEL_DS</span><span class="p">);</span>
		<span class="n">result</span> <span class="o">=</span> <span class="n">vfs_read</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pos</span><span class="p">);</span>
		<span class="n">set_fs</span><span class="p">(</span><span class="n">old_fs</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>

		<span class="n">buf</span><span class="p">[</span><span class="n">result</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>

		<span class="cm">/* Convert the decnet address to binary */</span>
		<span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="n">EIO</span><span class="p">;</span>
		<span class="n">nodep</span> <span class="o">=</span> <span class="n">strchr</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="sc">&#39;.&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">nodep</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>

		<span class="n">area</span> <span class="o">=</span> <span class="n">simple_strtoul</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
		<span class="n">node</span> <span class="o">=</span> <span class="n">simple_strtoul</span><span class="p">(</span><span class="n">nodep</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>

		<span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="n">EIO</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">((</span><span class="n">area</span> <span class="o">&gt;</span> <span class="mi">63</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="n">node</span> <span class="o">&gt;</span> <span class="mi">1023</span><span class="p">))</span>
			<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>

		<span class="n">dnaddr</span> <span class="o">=</span> <span class="n">cpu_to_le16</span><span class="p">((</span><span class="n">area</span> <span class="o">&lt;&lt;</span> <span class="mi">10</span><span class="p">)</span> <span class="o">|</span> <span class="n">node</span><span class="p">);</span>

		<span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">put_user</span><span class="p">(</span><span class="n">dnaddr</span><span class="p">,</span> <span class="p">(</span><span class="n">__le16</span> <span class="n">__user</span> <span class="o">*</span><span class="p">)</span><span class="n">oldval</span><span class="p">))</span>
			<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>

		<span class="n">copied</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">dnaddr</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">newval</span> <span class="o">&amp;&amp;</span> <span class="n">newlen</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">loff_t</span> <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">__le16</span> <span class="n">dnaddr</span><span class="p">;</span>
		<span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">15</span><span class="p">];</span>
		<span class="kt">int</span> <span class="n">len</span><span class="p">;</span>

		<span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">newlen</span> <span class="o">!=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">dnaddr</span><span class="p">))</span>
			<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>

		<span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">get_user</span><span class="p">(</span><span class="n">dnaddr</span><span class="p">,</span> <span class="p">(</span><span class="n">__le16</span> <span class="n">__user</span> <span class="o">*</span><span class="p">)</span><span class="n">newval</span><span class="p">))</span>
			<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>

		<span class="n">len</span> <span class="o">=</span> <span class="n">snprintf</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buf</span><span class="p">),</span> <span class="s">&quot;%hu.%hu&quot;</span><span class="p">,</span>
				<span class="n">le16_to_cpu</span><span class="p">(</span><span class="n">dnaddr</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">10</span><span class="p">,</span>
				<span class="n">le16_to_cpu</span><span class="p">(</span><span class="n">dnaddr</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x3ff</span><span class="p">);</span>

		<span class="n">set_fs</span><span class="p">(</span><span class="n">KERNEL_DS</span><span class="p">);</span>
		<span class="n">result</span> <span class="o">=</span> <span class="n">vfs_write</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">len</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pos</span><span class="p">);</span>
		<span class="n">set_fs</span><span class="p">(</span><span class="n">old_fs</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">result</span> <span class="o">=</span> <span class="n">copied</span><span class="p">;</span>
<span class="nl">out:</span>
	<span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="o">*</span><span class="nf">get_sysctl</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">nlen</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">path</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="o">*</span><span class="n">table</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">bin_root_table</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">ctl_name</span><span class="p">;</span>

	<span class="cm">/* The binary sysctl tables have a small maximum depth so</span>
<span class="cm">	 * there is no danger of overflowing our path as it PATH_MAX</span>
<span class="cm">	 * bytes long.</span>
<span class="cm">	 */</span>
	<span class="n">memcpy</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">&quot;sys/&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
	<span class="n">path</span> <span class="o">+=</span> <span class="mi">4</span><span class="p">;</span>

<span class="nl">repeat:</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">nlen</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">ERR_PTR</span><span class="p">(</span><span class="o">-</span><span class="n">ENOTDIR</span><span class="p">);</span>
	<span class="n">ctl_name</span> <span class="o">=</span> <span class="o">*</span><span class="n">name</span><span class="p">;</span>
	<span class="n">name</span><span class="o">++</span><span class="p">;</span>
	<span class="n">nlen</span><span class="o">--</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span> <span class="p">;</span> <span class="n">table</span><span class="o">-&gt;</span><span class="n">convert</span><span class="p">;</span> <span class="n">table</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

		<span class="cm">/*</span>
<span class="cm">		 * For a wild card entry map from ifindex to network</span>
<span class="cm">		 * device name.</span>
<span class="cm">		 */</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">table</span><span class="o">-&gt;</span><span class="n">ctl_name</span><span class="p">)</span> <span class="p">{</span>
<span class="cp">#ifdef CONFIG_NET</span>
			<span class="k">struct</span> <span class="n">net</span> <span class="o">*</span><span class="n">net</span> <span class="o">=</span> <span class="n">current</span><span class="o">-&gt;</span><span class="n">nsproxy</span><span class="o">-&gt;</span><span class="n">net_ns</span><span class="p">;</span>
			<span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">;</span>
			<span class="n">dev</span> <span class="o">=</span> <span class="n">dev_get_by_index</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">ctl_name</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">dev</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">len</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">dev</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
				<span class="n">memcpy</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">dev</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="n">len</span><span class="p">);</span>
				<span class="n">dev_put</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>
			<span class="p">}</span>
<span class="cp">#endif</span>
		<span class="cm">/* Use the well known sysctl number to proc name mapping */</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">ctl_name</span> <span class="o">==</span> <span class="n">table</span><span class="o">-&gt;</span><span class="n">ctl_name</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">len</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">table</span><span class="o">-&gt;</span><span class="n">procname</span><span class="p">);</span>
			<span class="n">memcpy</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">table</span><span class="o">-&gt;</span><span class="n">procname</span><span class="p">,</span> <span class="n">len</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">len</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">path</span> <span class="o">+=</span> <span class="n">len</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">table</span><span class="o">-&gt;</span><span class="n">child</span><span class="p">)</span> <span class="p">{</span>
				<span class="o">*</span><span class="n">path</span><span class="o">++</span> <span class="o">=</span> <span class="sc">&#39;/&#39;</span><span class="p">;</span>
				<span class="n">table</span> <span class="o">=</span> <span class="n">table</span><span class="o">-&gt;</span><span class="n">child</span><span class="p">;</span>
				<span class="k">goto</span> <span class="n">repeat</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="o">*</span><span class="n">path</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
			<span class="k">return</span> <span class="n">table</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">ERR_PTR</span><span class="p">(</span><span class="o">-</span><span class="n">ENOTDIR</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">char</span> <span class="o">*</span><span class="nf">sysctl_getname</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">nlen</span><span class="p">,</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="o">**</span><span class="n">tablep</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">char</span> <span class="o">*</span><span class="n">tmp</span><span class="p">,</span> <span class="o">*</span><span class="n">result</span><span class="p">;</span>

	<span class="n">result</span> <span class="o">=</span> <span class="n">ERR_PTR</span><span class="p">(</span><span class="o">-</span><span class="n">ENOMEM</span><span class="p">);</span>
	<span class="n">tmp</span> <span class="o">=</span> <span class="n">__getname</span><span class="p">();</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">tmp</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="o">*</span><span class="n">table</span> <span class="o">=</span> <span class="n">get_sysctl</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">nlen</span><span class="p">,</span> <span class="n">tmp</span><span class="p">);</span>
		<span class="n">result</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">;</span>
		<span class="o">*</span><span class="n">tablep</span> <span class="o">=</span> <span class="n">table</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">IS_ERR</span><span class="p">(</span><span class="n">table</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">__putname</span><span class="p">(</span><span class="n">tmp</span><span class="p">);</span>
			<span class="n">result</span> <span class="o">=</span> <span class="n">ERR_CAST</span><span class="p">(</span><span class="n">table</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">ssize_t</span> <span class="nf">binary_sysctl</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">nlen</span><span class="p">,</span>
	<span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">oldval</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">oldlen</span><span class="p">,</span> <span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">newval</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">newlen</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">bin_table</span> <span class="o">*</span><span class="n">table</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">vfsmount</span> <span class="o">*</span><span class="n">mnt</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="n">file</span><span class="p">;</span>
	<span class="kt">ssize_t</span> <span class="n">result</span><span class="p">;</span>
	<span class="kt">char</span> <span class="o">*</span><span class="n">pathname</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">flags</span><span class="p">;</span>

	<span class="n">pathname</span> <span class="o">=</span> <span class="n">sysctl_getname</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">nlen</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">table</span><span class="p">);</span>
	<span class="n">result</span> <span class="o">=</span> <span class="n">PTR_ERR</span><span class="p">(</span><span class="n">pathname</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">IS_ERR</span><span class="p">(</span><span class="n">pathname</span><span class="p">))</span>
		<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>

	<span class="cm">/* How should the sysctl be accessed? */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">oldval</span> <span class="o">&amp;&amp;</span> <span class="n">oldlen</span> <span class="o">&amp;&amp;</span> <span class="n">newval</span> <span class="o">&amp;&amp;</span> <span class="n">newlen</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">flags</span> <span class="o">=</span> <span class="n">O_RDWR</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">newval</span> <span class="o">&amp;&amp;</span> <span class="n">newlen</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">flags</span> <span class="o">=</span> <span class="n">O_WRONLY</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">oldval</span> <span class="o">&amp;&amp;</span> <span class="n">oldlen</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">flags</span> <span class="o">=</span> <span class="n">O_RDONLY</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">goto</span> <span class="n">out_putname</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">mnt</span> <span class="o">=</span> <span class="n">current</span><span class="o">-&gt;</span><span class="n">nsproxy</span><span class="o">-&gt;</span><span class="n">pid_ns</span><span class="o">-&gt;</span><span class="n">proc_mnt</span><span class="p">;</span>
	<span class="n">file</span> <span class="o">=</span> <span class="n">file_open_root</span><span class="p">(</span><span class="n">mnt</span><span class="o">-&gt;</span><span class="n">mnt_root</span><span class="p">,</span> <span class="n">mnt</span><span class="p">,</span> <span class="n">pathname</span><span class="p">,</span> <span class="n">flags</span><span class="p">);</span>
	<span class="n">result</span> <span class="o">=</span> <span class="n">PTR_ERR</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">IS_ERR</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>
		<span class="k">goto</span> <span class="n">out_putname</span><span class="p">;</span>

	<span class="n">result</span> <span class="o">=</span> <span class="n">table</span><span class="o">-&gt;</span><span class="n">convert</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">oldval</span><span class="p">,</span> <span class="n">oldlen</span><span class="p">,</span> <span class="n">newval</span><span class="p">,</span> <span class="n">newlen</span><span class="p">);</span>

	<span class="n">fput</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<span class="nl">out_putname:</span>
	<span class="n">__putname</span><span class="p">(</span><span class="n">pathname</span><span class="p">);</span>
<span class="nl">out:</span>
	<span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>


<span class="cp">#else </span><span class="cm">/* CONFIG_SYSCTL_SYSCALL */</span><span class="cp"></span>

<span class="k">static</span> <span class="kt">ssize_t</span> <span class="nf">binary_sysctl</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">nlen</span><span class="p">,</span>
	<span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">oldval</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">oldlen</span><span class="p">,</span> <span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">newval</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">newlen</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="o">-</span><span class="n">ENOSYS</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#endif </span><span class="cm">/* CONFIG_SYSCTL_SYSCALL */</span><span class="cp"></span>


<span class="k">static</span> <span class="kt">void</span> <span class="nf">deprecated_sysctl_warning</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">nlen</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="cm">/*</span>
<span class="cm">	 * CTL_KERN/KERN_VERSION is used by older glibc and cannot</span>
<span class="cm">	 * ever go away.</span>
<span class="cm">	 */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">CTL_KERN</span> <span class="o">&amp;&amp;</span> <span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">KERN_VERSION</span><span class="p">)</span>
		<span class="k">return</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">printk_ratelimit</span><span class="p">())</span> <span class="p">{</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span>
			<span class="s">&quot;warning: process `%s&#39; used the deprecated sysctl &quot;</span>
			<span class="s">&quot;system call with &quot;</span><span class="p">,</span> <span class="n">current</span><span class="o">-&gt;</span><span class="n">comm</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nlen</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="s">&quot;%d.&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
		<span class="n">printk</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#define WARN_ONCE_HASH_BITS 8</span>
<span class="cp">#define WARN_ONCE_HASH_SIZE (1&lt;&lt;WARN_ONCE_HASH_BITS)</span>

<span class="k">static</span> <span class="n">DECLARE_BITMAP</span><span class="p">(</span><span class="n">warn_once_bitmap</span><span class="p">,</span> <span class="n">WARN_ONCE_HASH_SIZE</span><span class="p">);</span>

<span class="cp">#define FNV32_OFFSET 2166136261U</span>
<span class="cp">#define FNV32_PRIME 0x01000193</span>

<span class="cm">/*</span>
<span class="cm"> * Print each legacy sysctl (approximately) only once.</span>
<span class="cm"> * To avoid making the tables non-const use a external</span>
<span class="cm"> * hash-table instead.</span>
<span class="cm"> * Worst case hash collision: 6, but very rarely.</span>
<span class="cm"> * NOTE! We don&#39;t use the SMP-safe bit tests. We simply</span>
<span class="cm"> * don&#39;t care enough.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">warn_on_bintable</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">nlen</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">hash</span> <span class="o">=</span> <span class="n">FNV32_OFFSET</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nlen</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
		<span class="n">hash</span> <span class="o">=</span> <span class="p">(</span><span class="n">hash</span> <span class="o">^</span> <span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="n">FNV32_PRIME</span><span class="p">;</span>
	<span class="n">hash</span> <span class="o">%=</span> <span class="n">WARN_ONCE_HASH_SIZE</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">__test_and_set_bit</span><span class="p">(</span><span class="n">hash</span><span class="p">,</span> <span class="n">warn_once_bitmap</span><span class="p">))</span>
		<span class="k">return</span><span class="p">;</span>
	<span class="n">deprecated_sysctl_warning</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">nlen</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">ssize_t</span> <span class="nf">do_sysctl</span><span class="p">(</span><span class="kt">int</span> <span class="n">__user</span> <span class="o">*</span><span class="n">args_name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">nlen</span><span class="p">,</span>
	<span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">oldval</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">oldlen</span><span class="p">,</span> <span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">newval</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">newlen</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">name</span><span class="p">[</span><span class="n">CTL_MAXNAME</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="cm">/* Check args-&gt;nlen. */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">nlen</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">nlen</span> <span class="o">&gt;</span> <span class="n">CTL_MAXNAME</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENOTDIR</span><span class="p">;</span>
	<span class="cm">/* Read in the sysctl name for simplicity */</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nlen</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">get_user</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">args_name</span> <span class="o">+</span> <span class="n">i</span><span class="p">))</span>
			<span class="k">return</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>

	<span class="n">warn_on_bintable</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">nlen</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">binary_sysctl</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">nlen</span><span class="p">,</span> <span class="n">oldval</span><span class="p">,</span> <span class="n">oldlen</span><span class="p">,</span> <span class="n">newval</span><span class="p">,</span> <span class="n">newlen</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">SYSCALL_DEFINE1</span><span class="p">(</span><span class="n">sysctl</span><span class="p">,</span> <span class="k">struct</span> <span class="n">__sysctl_args</span> <span class="n">__user</span> <span class="o">*</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">__sysctl_args</span> <span class="n">tmp</span><span class="p">;</span>
	<span class="kt">size_t</span> <span class="n">oldlen</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">ssize_t</span> <span class="n">result</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">copy_from_user</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tmp</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">tmp</span><span class="p">)))</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">tmp</span><span class="p">.</span><span class="n">oldval</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">tmp</span><span class="p">.</span><span class="n">oldlenp</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">tmp</span><span class="p">.</span><span class="n">oldlenp</span> <span class="o">&amp;&amp;</span> <span class="n">get_user</span><span class="p">(</span><span class="n">oldlen</span><span class="p">,</span> <span class="n">tmp</span><span class="p">.</span><span class="n">oldlenp</span><span class="p">))</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>

	<span class="n">result</span> <span class="o">=</span> <span class="n">do_sysctl</span><span class="p">(</span><span class="n">tmp</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">tmp</span><span class="p">.</span><span class="n">nlen</span><span class="p">,</span> <span class="n">tmp</span><span class="p">.</span><span class="n">oldval</span><span class="p">,</span> <span class="n">oldlen</span><span class="p">,</span>
			   <span class="n">tmp</span><span class="p">.</span><span class="n">newval</span><span class="p">,</span> <span class="n">tmp</span><span class="p">.</span><span class="n">newlen</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">oldlen</span> <span class="o">=</span> <span class="n">result</span><span class="p">;</span>
		<span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">tmp</span><span class="p">.</span><span class="n">oldlenp</span> <span class="o">&amp;&amp;</span> <span class="n">put_user</span><span class="p">(</span><span class="n">oldlen</span><span class="p">,</span> <span class="n">tmp</span><span class="p">.</span><span class="n">oldlenp</span><span class="p">))</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>


<span class="cp">#ifdef CONFIG_COMPAT</span>
<span class="cp">#include &lt;asm/compat.h&gt;</span>

<span class="k">struct</span> <span class="n">compat_sysctl_args</span> <span class="p">{</span>
	<span class="n">compat_uptr_t</span>	<span class="n">name</span><span class="p">;</span>
	<span class="kt">int</span>		<span class="n">nlen</span><span class="p">;</span>
	<span class="n">compat_uptr_t</span>	<span class="n">oldval</span><span class="p">;</span>
	<span class="n">compat_uptr_t</span>	<span class="n">oldlenp</span><span class="p">;</span>
	<span class="n">compat_uptr_t</span>	<span class="n">newval</span><span class="p">;</span>
	<span class="n">compat_size_t</span>	<span class="n">newlen</span><span class="p">;</span>
	<span class="n">compat_ulong_t</span>	<span class="n">__unused</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
<span class="p">};</span>

<span class="n">asmlinkage</span> <span class="kt">long</span> <span class="nf">compat_sys_sysctl</span><span class="p">(</span><span class="k">struct</span> <span class="n">compat_sysctl_args</span> <span class="n">__user</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">compat_sysctl_args</span> <span class="n">tmp</span><span class="p">;</span>
	<span class="n">compat_size_t</span> <span class="n">__user</span> <span class="o">*</span><span class="n">compat_oldlenp</span><span class="p">;</span>
	<span class="kt">size_t</span> <span class="n">oldlen</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">ssize_t</span> <span class="n">result</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">copy_from_user</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tmp</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">tmp</span><span class="p">)))</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">tmp</span><span class="p">.</span><span class="n">oldval</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">tmp</span><span class="p">.</span><span class="n">oldlenp</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>

	<span class="n">compat_oldlenp</span> <span class="o">=</span> <span class="n">compat_ptr</span><span class="p">(</span><span class="n">tmp</span><span class="p">.</span><span class="n">oldlenp</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">compat_oldlenp</span> <span class="o">&amp;&amp;</span> <span class="n">get_user</span><span class="p">(</span><span class="n">oldlen</span><span class="p">,</span> <span class="n">compat_oldlenp</span><span class="p">))</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>

	<span class="n">result</span> <span class="o">=</span> <span class="n">do_sysctl</span><span class="p">(</span><span class="n">compat_ptr</span><span class="p">(</span><span class="n">tmp</span><span class="p">.</span><span class="n">name</span><span class="p">),</span> <span class="n">tmp</span><span class="p">.</span><span class="n">nlen</span><span class="p">,</span>
			   <span class="n">compat_ptr</span><span class="p">(</span><span class="n">tmp</span><span class="p">.</span><span class="n">oldval</span><span class="p">),</span> <span class="n">oldlen</span><span class="p">,</span>
			   <span class="n">compat_ptr</span><span class="p">(</span><span class="n">tmp</span><span class="p">.</span><span class="n">newval</span><span class="p">),</span> <span class="n">tmp</span><span class="p">.</span><span class="n">newlen</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">oldlen</span> <span class="o">=</span> <span class="n">result</span><span class="p">;</span>
		<span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">compat_oldlenp</span> <span class="o">&amp;&amp;</span> <span class="n">put_user</span><span class="p">(</span><span class="n">oldlen</span><span class="p">,</span> <span class="n">compat_oldlenp</span><span class="p">))</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#endif </span><span class="cm">/* CONFIG_COMPAT */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:1}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../javascript/docco.min.js"></script>
</html>
