<!DOCTYPE html>
<html><head><title>joekychen/linux » sound › soc › codecs › max98088.c

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>max98088.c</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * max98088.c -- MAX98088 ALSA SoC Audio driver</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright 2010 Maxim Integrated Products</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> * it under the terms of the GNU General Public License version 2 as</span>
<span class="cm"> * published by the Free Software Foundation.</span>
<span class="cm"> */</span>

<span class="cp">#include &lt;linux/module.h&gt;</span>
<span class="cp">#include &lt;linux/moduleparam.h&gt;</span>
<span class="cp">#include &lt;linux/kernel.h&gt;</span>
<span class="cp">#include &lt;linux/init.h&gt;</span>
<span class="cp">#include &lt;linux/delay.h&gt;</span>
<span class="cp">#include &lt;linux/pm.h&gt;</span>
<span class="cp">#include &lt;linux/i2c.h&gt;</span>
<span class="cp">#include &lt;sound/core.h&gt;</span>
<span class="cp">#include &lt;sound/pcm.h&gt;</span>
<span class="cp">#include &lt;sound/pcm_params.h&gt;</span>
<span class="cp">#include &lt;sound/soc.h&gt;</span>
<span class="cp">#include &lt;sound/initval.h&gt;</span>
<span class="cp">#include &lt;sound/tlv.h&gt;</span>
<span class="cp">#include &lt;linux/slab.h&gt;</span>
<span class="cp">#include &lt;asm/div64.h&gt;</span>
<span class="cp">#include &lt;sound/max98088.h&gt;</span>
<span class="cp">#include &quot;max98088.h&quot;</span>

<span class="k">enum</span> <span class="n">max98088_type</span> <span class="p">{</span>
       <span class="n">MAX98088</span><span class="p">,</span>
       <span class="n">MAX98089</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">max98088_cdata</span> <span class="p">{</span>
       <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rate</span><span class="p">;</span>
       <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">fmt</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">eq_sel</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">max98088_priv</span> <span class="p">{</span>
       <span class="k">enum</span> <span class="n">max98088_type</span> <span class="n">devtype</span><span class="p">;</span>
       <span class="k">struct</span> <span class="n">max98088_pdata</span> <span class="o">*</span><span class="n">pdata</span><span class="p">;</span>
       <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">sysclk</span><span class="p">;</span>
       <span class="k">struct</span> <span class="n">max98088_cdata</span> <span class="n">dai</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
       <span class="kt">int</span> <span class="n">eq_textcnt</span><span class="p">;</span>
       <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">eq_texts</span><span class="p">;</span>
       <span class="k">struct</span> <span class="n">soc_enum</span> <span class="n">eq_enum</span><span class="p">;</span>
       <span class="n">u8</span> <span class="n">ina_state</span><span class="p">;</span>
       <span class="n">u8</span> <span class="n">inb_state</span><span class="p">;</span>
       <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ex_mode</span><span class="p">;</span>
       <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">digmic</span><span class="p">;</span>
       <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mic1pre</span><span class="p">;</span>
       <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mic2pre</span><span class="p">;</span>
       <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">extmic_mode</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">u8</span> <span class="n">max98088_reg</span><span class="p">[</span><span class="n">M98088_REG_CNT</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 00 IRQ status */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 01 MIC status */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 02 jack status */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 03 battery voltage */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 04 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 05 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 06 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 07 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 08 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 09 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 0A */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 0B */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 0C */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 0D */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 0E */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 0F interrupt enable */</span>

       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 10 master clock */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 11 DAI1 clock mode */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 12 DAI1 clock control */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 13 DAI1 clock control */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 14 DAI1 format */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 15 DAI1 clock */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 16 DAI1 config */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 17 DAI1 TDM */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 18 DAI1 filters */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 19 DAI2 clock mode */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 1A DAI2 clock control */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 1B DAI2 clock control */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 1C DAI2 format */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 1D DAI2 clock */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 1E DAI2 config */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 1F DAI2 TDM */</span>

       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 20 DAI2 filters */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 21 data config */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 22 DAC mixer */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 23 left ADC mixer */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 24 right ADC mixer */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 25 left HP mixer */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 26 right HP mixer */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 27 HP control */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 28 left REC mixer */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 29 right REC mixer */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 2A REC control */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 2B left SPK mixer */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 2C right SPK mixer */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 2D SPK control */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 2E sidetone */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 2F DAI1 playback level */</span>

       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 30 DAI1 playback level */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 31 DAI2 playback level */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 32 DAI2 playbakc level */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 33 left ADC level */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 34 right ADC level */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 35 MIC1 level */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 36 MIC2 level */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 37 INA level */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 38 INB level */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 39 left HP volume */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 3A right HP volume */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 3B left REC volume */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 3C right REC volume */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 3D left SPK volume */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 3E right SPK volume */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 3F MIC config */</span>

       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 40 MIC threshold */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 41 excursion limiter filter */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 42 excursion limiter threshold */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 43 ALC */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 44 power limiter threshold */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 45 power limiter config */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 46 distortion limiter config */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 47 audio input */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 48 microphone */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 49 level control */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 4A bypass switches */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 4B jack detect */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 4C input enable */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 4D output enable */</span>
       <span class="mh">0xF0</span><span class="p">,</span> <span class="cm">/* 4E bias control */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 4F DAC power */</span>

       <span class="mh">0x0F</span><span class="p">,</span> <span class="cm">/* 50 DAC power */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 51 system */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 52 DAI1 EQ1 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 53 DAI1 EQ1 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 54 DAI1 EQ1 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 55 DAI1 EQ1 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 56 DAI1 EQ1 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 57 DAI1 EQ1 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 58 DAI1 EQ1 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 59 DAI1 EQ1 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 5A DAI1 EQ1 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 5B DAI1 EQ1 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 5C DAI1 EQ2 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 5D DAI1 EQ2 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 5E DAI1 EQ2 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 5F DAI1 EQ2 */</span>

       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 60 DAI1 EQ2 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 61 DAI1 EQ2 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 62 DAI1 EQ2 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 63 DAI1 EQ2 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 64 DAI1 EQ2 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 65 DAI1 EQ2 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 66 DAI1 EQ3 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 67 DAI1 EQ3 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 68 DAI1 EQ3 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 69 DAI1 EQ3 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 6A DAI1 EQ3 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 6B DAI1 EQ3 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 6C DAI1 EQ3 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 6D DAI1 EQ3 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 6E DAI1 EQ3 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 6F DAI1 EQ3 */</span>

       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 70 DAI1 EQ4 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 71 DAI1 EQ4 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 72 DAI1 EQ4 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 73 DAI1 EQ4 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 74 DAI1 EQ4 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 75 DAI1 EQ4 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 76 DAI1 EQ4 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 77 DAI1 EQ4 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 78 DAI1 EQ4 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 79 DAI1 EQ4 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 7A DAI1 EQ5 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 7B DAI1 EQ5 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 7C DAI1 EQ5 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 7D DAI1 EQ5 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 7E DAI1 EQ5 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 7F DAI1 EQ5 */</span>

       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 80 DAI1 EQ5 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 81 DAI1 EQ5 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 82 DAI1 EQ5 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 83 DAI1 EQ5 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 84 DAI2 EQ1 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 85 DAI2 EQ1 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 86 DAI2 EQ1 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 87 DAI2 EQ1 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 88 DAI2 EQ1 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 89 DAI2 EQ1 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 8A DAI2 EQ1 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 8B DAI2 EQ1 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 8C DAI2 EQ1 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 8D DAI2 EQ1 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 8E DAI2 EQ2 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 8F DAI2 EQ2 */</span>

       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 90 DAI2 EQ2 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 91 DAI2 EQ2 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 92 DAI2 EQ2 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 93 DAI2 EQ2 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 94 DAI2 EQ2 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 95 DAI2 EQ2 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 96 DAI2 EQ2 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 97 DAI2 EQ2 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 98 DAI2 EQ3 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 99 DAI2 EQ3 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 9A DAI2 EQ3 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 9B DAI2 EQ3 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 9C DAI2 EQ3 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 9D DAI2 EQ3 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 9E DAI2 EQ3 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 9F DAI2 EQ3 */</span>

       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* A0 DAI2 EQ3 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* A1 DAI2 EQ3 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* A2 DAI2 EQ4 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* A3 DAI2 EQ4 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* A4 DAI2 EQ4 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* A5 DAI2 EQ4 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* A6 DAI2 EQ4 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* A7 DAI2 EQ4 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* A8 DAI2 EQ4 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* A9 DAI2 EQ4 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* AA DAI2 EQ4 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* AB DAI2 EQ4 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* AC DAI2 EQ5 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* AD DAI2 EQ5 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* AE DAI2 EQ5 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* AF DAI2 EQ5 */</span>

       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* B0 DAI2 EQ5 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* B1 DAI2 EQ5 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* B2 DAI2 EQ5 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* B3 DAI2 EQ5 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* B4 DAI2 EQ5 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* B5 DAI2 EQ5 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* B6 DAI1 biquad */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* B7 DAI1 biquad */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* B8 DAI1 biquad */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* B9 DAI1 biquad */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* BA DAI1 biquad */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* BB DAI1 biquad */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* BC DAI1 biquad */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* BD DAI1 biquad */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* BE DAI1 biquad */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* BF DAI1 biquad */</span>

       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* C0 DAI2 biquad */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* C1 DAI2 biquad */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* C2 DAI2 biquad */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* C3 DAI2 biquad */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* C4 DAI2 biquad */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* C5 DAI2 biquad */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* C6 DAI2 biquad */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* C7 DAI2 biquad */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* C8 DAI2 biquad */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* C9 DAI2 biquad */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* CA */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* CB */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* CC */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* CD */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* CE */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* CF */</span>

       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* D0 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* D1 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* D2 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* D3 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* D4 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* D5 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* D6 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* D7 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* D8 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* D9 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* DA */</span>
       <span class="mh">0x70</span><span class="p">,</span> <span class="cm">/* DB */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* DC */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* DD */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* DE */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* DF */</span>

       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* E0 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* E1 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* E2 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* E3 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* E4 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* E5 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* E6 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* E7 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* E8 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* E9 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* EA */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* EB */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* EC */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* ED */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* EE */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* EF */</span>

       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* F0 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* F1 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* F2 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* F3 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* F4 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* F5 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* F6 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* F7 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* F8 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* F9 */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* FA */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* FB */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* FC */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* FD */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* FE */</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* FF */</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="p">{</span>
       <span class="kt">int</span> <span class="n">readable</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">writable</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">vol</span><span class="p">;</span>
<span class="p">}</span> <span class="n">max98088_access</span><span class="p">[</span><span class="n">M98088_REG_CNT</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">1</span> <span class="p">},</span> <span class="cm">/* 00 IRQ status */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">1</span> <span class="p">},</span> <span class="cm">/* 01 MIC status */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">1</span> <span class="p">},</span> <span class="cm">/* 02 jack status */</span>
       <span class="p">{</span> <span class="mh">0x1F</span><span class="p">,</span> <span class="mh">0x1F</span><span class="p">,</span> <span class="mi">1</span> <span class="p">},</span> <span class="cm">/* 03 battery voltage */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 04 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 05 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 06 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 07 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 08 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 09 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 0A */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 0B */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 0C */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 0D */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 0E */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 0F interrupt enable */</span>

       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 10 master clock */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 11 DAI1 clock mode */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 12 DAI1 clock control */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 13 DAI1 clock control */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 14 DAI1 format */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 15 DAI1 clock */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 16 DAI1 config */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 17 DAI1 TDM */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 18 DAI1 filters */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 19 DAI2 clock mode */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 1A DAI2 clock control */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 1B DAI2 clock control */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 1C DAI2 format */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 1D DAI2 clock */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 1E DAI2 config */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 1F DAI2 TDM */</span>

       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 20 DAI2 filters */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 21 data config */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 22 DAC mixer */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 23 left ADC mixer */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 24 right ADC mixer */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 25 left HP mixer */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 26 right HP mixer */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 27 HP control */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 28 left REC mixer */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 29 right REC mixer */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 2A REC control */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 2B left SPK mixer */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 2C right SPK mixer */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 2D SPK control */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 2E sidetone */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 2F DAI1 playback level */</span>

       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 30 DAI1 playback level */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 31 DAI2 playback level */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 32 DAI2 playbakc level */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 33 left ADC level */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 34 right ADC level */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 35 MIC1 level */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 36 MIC2 level */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 37 INA level */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 38 INB level */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 39 left HP volume */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 3A right HP volume */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 3B left REC volume */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 3C right REC volume */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 3D left SPK volume */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 3E right SPK volume */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 3F MIC config */</span>

       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 40 MIC threshold */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 41 excursion limiter filter */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 42 excursion limiter threshold */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 43 ALC */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 44 power limiter threshold */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 45 power limiter config */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 46 distortion limiter config */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 47 audio input */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 48 microphone */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 49 level control */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 4A bypass switches */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 4B jack detect */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 4C input enable */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 4D output enable */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 4E bias control */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 4F DAC power */</span>

       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 50 DAC power */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 51 system */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 52 DAI1 EQ1 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 53 DAI1 EQ1 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 54 DAI1 EQ1 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 55 DAI1 EQ1 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 56 DAI1 EQ1 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 57 DAI1 EQ1 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 58 DAI1 EQ1 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 59 DAI1 EQ1 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 5A DAI1 EQ1 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 5B DAI1 EQ1 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 5C DAI1 EQ2 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 5D DAI1 EQ2 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 5E DAI1 EQ2 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 5F DAI1 EQ2 */</span>

       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 60 DAI1 EQ2 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 61 DAI1 EQ2 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 62 DAI1 EQ2 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 63 DAI1 EQ2 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 64 DAI1 EQ2 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 65 DAI1 EQ2 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 66 DAI1 EQ3 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 67 DAI1 EQ3 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 68 DAI1 EQ3 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 69 DAI1 EQ3 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 6A DAI1 EQ3 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 6B DAI1 EQ3 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 6C DAI1 EQ3 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 6D DAI1 EQ3 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 6E DAI1 EQ3 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 6F DAI1 EQ3 */</span>

       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 70 DAI1 EQ4 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 71 DAI1 EQ4 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 72 DAI1 EQ4 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 73 DAI1 EQ4 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 74 DAI1 EQ4 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 75 DAI1 EQ4 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 76 DAI1 EQ4 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 77 DAI1 EQ4 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 78 DAI1 EQ4 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 79 DAI1 EQ4 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 7A DAI1 EQ5 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 7B DAI1 EQ5 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 7C DAI1 EQ5 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 7D DAI1 EQ5 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 7E DAI1 EQ5 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 7F DAI1 EQ5 */</span>

       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 80 DAI1 EQ5 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 81 DAI1 EQ5 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 82 DAI1 EQ5 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 83 DAI1 EQ5 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 84 DAI2 EQ1 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 85 DAI2 EQ1 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 86 DAI2 EQ1 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 87 DAI2 EQ1 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 88 DAI2 EQ1 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 89 DAI2 EQ1 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 8A DAI2 EQ1 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 8B DAI2 EQ1 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 8C DAI2 EQ1 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 8D DAI2 EQ1 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 8E DAI2 EQ2 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 8F DAI2 EQ2 */</span>

       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 90 DAI2 EQ2 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 91 DAI2 EQ2 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 92 DAI2 EQ2 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 93 DAI2 EQ2 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 94 DAI2 EQ2 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 95 DAI2 EQ2 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 96 DAI2 EQ2 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 97 DAI2 EQ2 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 98 DAI2 EQ3 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 99 DAI2 EQ3 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 9A DAI2 EQ3 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 9B DAI2 EQ3 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 9C DAI2 EQ3 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 9D DAI2 EQ3 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 9E DAI2 EQ3 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* 9F DAI2 EQ3 */</span>

       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* A0 DAI2 EQ3 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* A1 DAI2 EQ3 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* A2 DAI2 EQ4 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* A3 DAI2 EQ4 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* A4 DAI2 EQ4 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* A5 DAI2 EQ4 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* A6 DAI2 EQ4 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* A7 DAI2 EQ4 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* A8 DAI2 EQ4 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* A9 DAI2 EQ4 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* AA DAI2 EQ4 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* AB DAI2 EQ4 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* AC DAI2 EQ5 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* AD DAI2 EQ5 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* AE DAI2 EQ5 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* AF DAI2 EQ5 */</span>

       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* B0 DAI2 EQ5 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* B1 DAI2 EQ5 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* B2 DAI2 EQ5 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* B3 DAI2 EQ5 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* B4 DAI2 EQ5 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* B5 DAI2 EQ5 */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* B6 DAI1 biquad */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* B7 DAI1 biquad */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* B8 DAI1 biquad */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* B9 DAI1 biquad */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* BA DAI1 biquad */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* BB DAI1 biquad */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* BC DAI1 biquad */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* BD DAI1 biquad */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* BE DAI1 biquad */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* BF DAI1 biquad */</span>

       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* C0 DAI2 biquad */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* C1 DAI2 biquad */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* C2 DAI2 biquad */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* C3 DAI2 biquad */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* C4 DAI2 biquad */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* C5 DAI2 biquad */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* C6 DAI2 biquad */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* C7 DAI2 biquad */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* C8 DAI2 biquad */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* C9 DAI2 biquad */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* CA */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* CB */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* CC */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* CD */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* CE */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* CF */</span>

       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* D0 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* D1 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* D2 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* D3 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* D4 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* D5 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* D6 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* D7 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* D8 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* D9 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* DA */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* DB */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* DC */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* DD */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* DE */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* DF */</span>

       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* E0 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* E1 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* E2 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* E3 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* E4 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* E5 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* E6 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* E7 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* E8 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* E9 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* EA */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* EB */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* EC */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* ED */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* EE */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* EF */</span>

       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* F0 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* F1 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* F2 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* F3 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* F4 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* F5 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* F6 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* F7 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* F8 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* F9 */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* FA */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* FB */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* FC */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* FD */</span>
       <span class="p">{</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span> <span class="cm">/* FE */</span>
       <span class="p">{</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mi">1</span> <span class="p">},</span> <span class="cm">/* FF */</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">max98088_volatile_register</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">reg</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">return</span> <span class="n">max98088_access</span><span class="p">[</span><span class="n">reg</span><span class="p">].</span><span class="n">vol</span><span class="p">;</span>
<span class="p">}</span>


<span class="cm">/*</span>
<span class="cm"> * Load equalizer DSP coefficient configurations registers</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">m98088_eq_band</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dai</span><span class="p">,</span>
                   <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">band</span><span class="p">,</span> <span class="n">u16</span> <span class="o">*</span><span class="n">coefs</span><span class="p">)</span>
<span class="p">{</span>
       <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">eq_reg</span><span class="p">;</span>
       <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

       <span class="n">BUG_ON</span><span class="p">(</span><span class="n">band</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">);</span>
       <span class="n">BUG_ON</span><span class="p">(</span><span class="n">dai</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">);</span>

       <span class="cm">/* Load the base register address */</span>
       <span class="n">eq_reg</span> <span class="o">=</span> <span class="n">dai</span> <span class="o">?</span> <span class="n">M98088_REG_84_DAI2_EQ_BASE</span> <span class="o">:</span> <span class="n">M98088_REG_52_DAI1_EQ_BASE</span><span class="p">;</span>

       <span class="cm">/* Add the band address offset, note adjustment for word address */</span>
       <span class="n">eq_reg</span> <span class="o">+=</span> <span class="n">band</span> <span class="o">*</span> <span class="p">(</span><span class="n">M98088_COEFS_PER_BAND</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">);</span>

       <span class="cm">/* Step through the registers and coefs */</span>
       <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">M98088_COEFS_PER_BAND</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
               <span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">eq_reg</span><span class="o">++</span><span class="p">,</span> <span class="n">M98088_BYTE1</span><span class="p">(</span><span class="n">coefs</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
               <span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">eq_reg</span><span class="o">++</span><span class="p">,</span> <span class="n">M98088_BYTE0</span><span class="p">(</span><span class="n">coefs</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
       <span class="p">}</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * Excursion limiter modes</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">max98088_exmode_texts</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
       <span class="s">&quot;Off&quot;</span><span class="p">,</span> <span class="s">&quot;100Hz&quot;</span><span class="p">,</span> <span class="s">&quot;400Hz&quot;</span><span class="p">,</span> <span class="s">&quot;600Hz&quot;</span><span class="p">,</span> <span class="s">&quot;800Hz&quot;</span><span class="p">,</span> <span class="s">&quot;1000Hz&quot;</span><span class="p">,</span> <span class="s">&quot;200-400Hz&quot;</span><span class="p">,</span>
       <span class="s">&quot;400-600Hz&quot;</span><span class="p">,</span> <span class="s">&quot;400-800Hz&quot;</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">max98088_exmode_values</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
       <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x32</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">soc_enum</span> <span class="n">max98088_exmode_enum</span> <span class="o">=</span>
       <span class="n">SOC_VALUE_ENUM_SINGLE</span><span class="p">(</span><span class="n">M98088_REG_41_SPKDHP</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span>
                             <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">max98088_exmode_texts</span><span class="p">),</span>
                             <span class="n">max98088_exmode_texts</span><span class="p">,</span>
                             <span class="n">max98088_exmode_values</span><span class="p">);</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">max98088_ex_thresh</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span> <span class="cm">/* volts PP */</span>
       <span class="s">&quot;0.6&quot;</span><span class="p">,</span> <span class="s">&quot;1.2&quot;</span><span class="p">,</span> <span class="s">&quot;1.8&quot;</span><span class="p">,</span> <span class="s">&quot;2.4&quot;</span><span class="p">,</span> <span class="s">&quot;3.0&quot;</span><span class="p">,</span> <span class="s">&quot;3.6&quot;</span><span class="p">,</span> <span class="s">&quot;4.2&quot;</span><span class="p">,</span> <span class="s">&quot;4.8&quot;</span><span class="p">};</span>
<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">soc_enum</span> <span class="n">max98088_ex_thresh_enum</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
       <span class="n">SOC_ENUM_SINGLE</span><span class="p">(</span><span class="n">M98088_REG_42_SPKDHP_THRESH</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
               <span class="n">max98088_ex_thresh</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">max98088_fltr_mode</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;Voice&quot;</span><span class="p">,</span> <span class="s">&quot;Music&quot;</span> <span class="p">};</span>
<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">soc_enum</span> <span class="n">max98088_filter_mode_enum</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
       <span class="n">SOC_ENUM_SINGLE</span><span class="p">(</span><span class="n">M98088_REG_18_DAI1_FILTERS</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">max98088_fltr_mode</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">max98088_extmic_text</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;None&quot;</span><span class="p">,</span> <span class="s">&quot;MIC1&quot;</span><span class="p">,</span> <span class="s">&quot;MIC2&quot;</span> <span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">soc_enum</span> <span class="n">max98088_extmic_enum</span> <span class="o">=</span>
       <span class="n">SOC_ENUM_SINGLE</span><span class="p">(</span><span class="n">M98088_REG_48_CFG_MIC</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">max98088_extmic_text</span><span class="p">);</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">max98088_extmic_mux</span> <span class="o">=</span>
       <span class="n">SOC_DAPM_ENUM</span><span class="p">(</span><span class="s">&quot;External MIC Mux&quot;</span><span class="p">,</span> <span class="n">max98088_extmic_enum</span><span class="p">);</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">max98088_dai1_fltr</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
       <span class="s">&quot;Off&quot;</span><span class="p">,</span> <span class="s">&quot;fc=258/fs=16k&quot;</span><span class="p">,</span> <span class="s">&quot;fc=500/fs=16k&quot;</span><span class="p">,</span>
       <span class="s">&quot;fc=258/fs=8k&quot;</span><span class="p">,</span> <span class="s">&quot;fc=500/fs=8k&quot;</span><span class="p">,</span> <span class="s">&quot;fc=200&quot;</span><span class="p">};</span>
<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">soc_enum</span> <span class="n">max98088_dai1_dac_filter_enum</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
       <span class="n">SOC_ENUM_SINGLE</span><span class="p">(</span><span class="n">M98088_REG_18_DAI1_FILTERS</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">max98088_dai1_fltr</span><span class="p">),</span>
<span class="p">};</span>
<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">soc_enum</span> <span class="n">max98088_dai1_adc_filter_enum</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
       <span class="n">SOC_ENUM_SINGLE</span><span class="p">(</span><span class="n">M98088_REG_18_DAI1_FILTERS</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">max98088_dai1_fltr</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">max98088_mic1pre_set</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
                               <span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
       <span class="k">struct</span> <span class="n">max98088_priv</span> <span class="o">*</span><span class="n">max98088</span> <span class="o">=</span> <span class="n">snd_soc_codec_get_drvdata</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
       <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">sel</span> <span class="o">=</span> <span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">integer</span><span class="p">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

       <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">mic1pre</span> <span class="o">=</span> <span class="n">sel</span><span class="p">;</span>
       <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_35_LVL_MIC1</span><span class="p">,</span> <span class="n">M98088_MICPRE_MASK</span><span class="p">,</span>
               <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">sel</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">M98088_MICPRE_SHIFT</span><span class="p">);</span>

       <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">max98088_mic1pre_get</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
                               <span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
       <span class="k">struct</span> <span class="n">max98088_priv</span> <span class="o">*</span><span class="n">max98088</span> <span class="o">=</span> <span class="n">snd_soc_codec_get_drvdata</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>

       <span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">integer</span><span class="p">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">mic1pre</span><span class="p">;</span>
       <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">max98088_mic2pre_set</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
                               <span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
       <span class="k">struct</span> <span class="n">max98088_priv</span> <span class="o">*</span><span class="n">max98088</span> <span class="o">=</span> <span class="n">snd_soc_codec_get_drvdata</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
       <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">sel</span> <span class="o">=</span> <span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">integer</span><span class="p">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

       <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">mic2pre</span> <span class="o">=</span> <span class="n">sel</span><span class="p">;</span>
       <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_36_LVL_MIC2</span><span class="p">,</span> <span class="n">M98088_MICPRE_MASK</span><span class="p">,</span>
               <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">sel</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">M98088_MICPRE_SHIFT</span><span class="p">);</span>

       <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">max98088_mic2pre_get</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
                               <span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
       <span class="k">struct</span> <span class="n">max98088_priv</span> <span class="o">*</span><span class="n">max98088</span> <span class="o">=</span> <span class="n">snd_soc_codec_get_drvdata</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>

       <span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">integer</span><span class="p">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">mic2pre</span><span class="p">;</span>
       <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">max98088_micboost_tlv</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
       <span class="n">TLV_DB_RANGE_HEAD</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
       <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TLV_DB_SCALE_ITEM</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">TLV_DB_SCALE_ITEM</span><span class="p">(</span><span class="mi">3000</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">max98088_snd_controls</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>

       <span class="n">SOC_DOUBLE_R</span><span class="p">(</span><span class="s">&quot;Headphone Volume&quot;</span><span class="p">,</span> <span class="n">M98088_REG_39_LVL_HP_L</span><span class="p">,</span>
               <span class="n">M98088_REG_3A_LVL_HP_R</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DOUBLE_R</span><span class="p">(</span><span class="s">&quot;Speaker Volume&quot;</span><span class="p">,</span> <span class="n">M98088_REG_3D_LVL_SPK_L</span><span class="p">,</span>
               <span class="n">M98088_REG_3E_LVL_SPK_R</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DOUBLE_R</span><span class="p">(</span><span class="s">&quot;Receiver Volume&quot;</span><span class="p">,</span> <span class="n">M98088_REG_3B_LVL_REC_L</span><span class="p">,</span>
               <span class="n">M98088_REG_3C_LVL_REC_R</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

       <span class="n">SOC_DOUBLE_R</span><span class="p">(</span><span class="s">&quot;Headphone Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_39_LVL_HP_L</span><span class="p">,</span>
               <span class="n">M98088_REG_3A_LVL_HP_R</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
       <span class="n">SOC_DOUBLE_R</span><span class="p">(</span><span class="s">&quot;Speaker Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_3D_LVL_SPK_L</span><span class="p">,</span>
               <span class="n">M98088_REG_3E_LVL_SPK_R</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
       <span class="n">SOC_DOUBLE_R</span><span class="p">(</span><span class="s">&quot;Receiver Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_3B_LVL_REC_L</span><span class="p">,</span>
               <span class="n">M98088_REG_3C_LVL_REC_R</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>

       <span class="n">SOC_SINGLE</span><span class="p">(</span><span class="s">&quot;MIC1 Volume&quot;</span><span class="p">,</span> <span class="n">M98088_REG_35_LVL_MIC1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
       <span class="n">SOC_SINGLE</span><span class="p">(</span><span class="s">&quot;MIC2 Volume&quot;</span><span class="p">,</span> <span class="n">M98088_REG_36_LVL_MIC2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>

       <span class="n">SOC_SINGLE_EXT_TLV</span><span class="p">(</span><span class="s">&quot;MIC1 Boost Volume&quot;</span><span class="p">,</span>
                       <span class="n">M98088_REG_35_LVL_MIC1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                       <span class="n">max98088_mic1pre_get</span><span class="p">,</span> <span class="n">max98088_mic1pre_set</span><span class="p">,</span>
                       <span class="n">max98088_micboost_tlv</span><span class="p">),</span>
       <span class="n">SOC_SINGLE_EXT_TLV</span><span class="p">(</span><span class="s">&quot;MIC2 Boost Volume&quot;</span><span class="p">,</span>
                       <span class="n">M98088_REG_36_LVL_MIC2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                       <span class="n">max98088_mic2pre_get</span><span class="p">,</span> <span class="n">max98088_mic2pre_set</span><span class="p">,</span>
                       <span class="n">max98088_micboost_tlv</span><span class="p">),</span>

       <span class="n">SOC_SINGLE</span><span class="p">(</span><span class="s">&quot;INA Volume&quot;</span><span class="p">,</span> <span class="n">M98088_REG_37_LVL_INA</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
       <span class="n">SOC_SINGLE</span><span class="p">(</span><span class="s">&quot;INB Volume&quot;</span><span class="p">,</span> <span class="n">M98088_REG_38_LVL_INB</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>

       <span class="n">SOC_SINGLE</span><span class="p">(</span><span class="s">&quot;ADCL Volume&quot;</span><span class="p">,</span> <span class="n">M98088_REG_33_LVL_ADC_L</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_SINGLE</span><span class="p">(</span><span class="s">&quot;ADCR Volume&quot;</span><span class="p">,</span> <span class="n">M98088_REG_34_LVL_ADC_R</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

       <span class="n">SOC_SINGLE</span><span class="p">(</span><span class="s">&quot;ADCL Boost Volume&quot;</span><span class="p">,</span> <span class="n">M98088_REG_33_LVL_ADC_L</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_SINGLE</span><span class="p">(</span><span class="s">&quot;ADCR Boost Volume&quot;</span><span class="p">,</span> <span class="n">M98088_REG_34_LVL_ADC_R</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

       <span class="n">SOC_SINGLE</span><span class="p">(</span><span class="s">&quot;EQ1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_49_CFG_LEVEL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_SINGLE</span><span class="p">(</span><span class="s">&quot;EQ2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_49_CFG_LEVEL</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

       <span class="n">SOC_ENUM</span><span class="p">(</span><span class="s">&quot;EX Limiter Mode&quot;</span><span class="p">,</span> <span class="n">max98088_exmode_enum</span><span class="p">),</span>
       <span class="n">SOC_ENUM</span><span class="p">(</span><span class="s">&quot;EX Limiter Threshold&quot;</span><span class="p">,</span> <span class="n">max98088_ex_thresh_enum</span><span class="p">),</span>

       <span class="n">SOC_ENUM</span><span class="p">(</span><span class="s">&quot;DAI1 Filter Mode&quot;</span><span class="p">,</span> <span class="n">max98088_filter_mode_enum</span><span class="p">),</span>
       <span class="n">SOC_ENUM</span><span class="p">(</span><span class="s">&quot;DAI1 DAC Filter&quot;</span><span class="p">,</span> <span class="n">max98088_dai1_dac_filter_enum</span><span class="p">),</span>
       <span class="n">SOC_ENUM</span><span class="p">(</span><span class="s">&quot;DAI1 ADC Filter&quot;</span><span class="p">,</span> <span class="n">max98088_dai1_adc_filter_enum</span><span class="p">),</span>
       <span class="n">SOC_SINGLE</span><span class="p">(</span><span class="s">&quot;DAI2 DC Block Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_20_DAI2_FILTERS</span><span class="p">,</span>
               <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

       <span class="n">SOC_SINGLE</span><span class="p">(</span><span class="s">&quot;ALC Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_43_SPKALC_COMP</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_SINGLE</span><span class="p">(</span><span class="s">&quot;ALC Threshold&quot;</span><span class="p">,</span> <span class="n">M98088_REG_43_SPKALC_COMP</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_SINGLE</span><span class="p">(</span><span class="s">&quot;ALC Multiband&quot;</span><span class="p">,</span> <span class="n">M98088_REG_43_SPKALC_COMP</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_SINGLE</span><span class="p">(</span><span class="s">&quot;ALC Release Time&quot;</span><span class="p">,</span> <span class="n">M98088_REG_43_SPKALC_COMP</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

       <span class="n">SOC_SINGLE</span><span class="p">(</span><span class="s">&quot;PWR Limiter Threshold&quot;</span><span class="p">,</span> <span class="n">M98088_REG_44_PWRLMT_CFG</span><span class="p">,</span>
               <span class="mi">4</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_SINGLE</span><span class="p">(</span><span class="s">&quot;PWR Limiter Weight&quot;</span><span class="p">,</span> <span class="n">M98088_REG_44_PWRLMT_CFG</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_SINGLE</span><span class="p">(</span><span class="s">&quot;PWR Limiter Time1&quot;</span><span class="p">,</span> <span class="n">M98088_REG_45_PWRLMT_TIME</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_SINGLE</span><span class="p">(</span><span class="s">&quot;PWR Limiter Time2&quot;</span><span class="p">,</span> <span class="n">M98088_REG_45_PWRLMT_TIME</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

       <span class="n">SOC_SINGLE</span><span class="p">(</span><span class="s">&quot;THD Limiter Threshold&quot;</span><span class="p">,</span> <span class="n">M98088_REG_46_THDLMT_CFG</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_SINGLE</span><span class="p">(</span><span class="s">&quot;THD Limiter Time&quot;</span><span class="p">,</span> <span class="n">M98088_REG_46_THDLMT_CFG</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="p">};</span>

<span class="cm">/* Left speaker mixer switch */</span>
<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">max98088_left_speaker_mixer_controls</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Left DAC1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_2B_MIX_SPK_LEFT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Right DAC1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_2B_MIX_SPK_LEFT</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Left DAC2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_2B_MIX_SPK_LEFT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Right DAC2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_2B_MIX_SPK_LEFT</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;MIC1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_2B_MIX_SPK_LEFT</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;MIC2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_2B_MIX_SPK_LEFT</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INA1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_2B_MIX_SPK_LEFT</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INA2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_2B_MIX_SPK_LEFT</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INB1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_2B_MIX_SPK_LEFT</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INB2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_2B_MIX_SPK_LEFT</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="p">};</span>

<span class="cm">/* Right speaker mixer switch */</span>
<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">max98088_right_speaker_mixer_controls</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Left DAC1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_2C_MIX_SPK_RIGHT</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Right DAC1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_2C_MIX_SPK_RIGHT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Left DAC2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_2C_MIX_SPK_RIGHT</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Right DAC2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_2C_MIX_SPK_RIGHT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;MIC1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_2C_MIX_SPK_RIGHT</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;MIC2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_2C_MIX_SPK_RIGHT</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INA1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_2C_MIX_SPK_RIGHT</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INA2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_2C_MIX_SPK_RIGHT</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INB1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_2C_MIX_SPK_RIGHT</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INB2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_2C_MIX_SPK_RIGHT</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="p">};</span>

<span class="cm">/* Left headphone mixer switch */</span>
<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">max98088_left_hp_mixer_controls</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Left DAC1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_25_MIX_HP_LEFT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Right DAC1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_25_MIX_HP_LEFT</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Left DAC2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_25_MIX_HP_LEFT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Right DAC2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_25_MIX_HP_LEFT</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;MIC1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_25_MIX_HP_LEFT</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;MIC2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_25_MIX_HP_LEFT</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INA1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_25_MIX_HP_LEFT</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INA2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_25_MIX_HP_LEFT</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INB1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_25_MIX_HP_LEFT</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INB2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_25_MIX_HP_LEFT</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="p">};</span>

<span class="cm">/* Right headphone mixer switch */</span>
<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">max98088_right_hp_mixer_controls</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Left DAC1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_26_MIX_HP_RIGHT</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Right DAC1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_26_MIX_HP_RIGHT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Left DAC2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_26_MIX_HP_RIGHT</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Right DAC2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_26_MIX_HP_RIGHT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;MIC1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_26_MIX_HP_RIGHT</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;MIC2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_26_MIX_HP_RIGHT</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INA1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_26_MIX_HP_RIGHT</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INA2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_26_MIX_HP_RIGHT</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INB1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_26_MIX_HP_RIGHT</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INB2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_26_MIX_HP_RIGHT</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="p">};</span>

<span class="cm">/* Left earpiece/receiver mixer switch */</span>
<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">max98088_left_rec_mixer_controls</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Left DAC1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_28_MIX_REC_LEFT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Right DAC1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_28_MIX_REC_LEFT</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Left DAC2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_28_MIX_REC_LEFT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Right DAC2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_28_MIX_REC_LEFT</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;MIC1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_28_MIX_REC_LEFT</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;MIC2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_28_MIX_REC_LEFT</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INA1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_28_MIX_REC_LEFT</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INA2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_28_MIX_REC_LEFT</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INB1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_28_MIX_REC_LEFT</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INB2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_28_MIX_REC_LEFT</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="p">};</span>

<span class="cm">/* Right earpiece/receiver mixer switch */</span>
<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">max98088_right_rec_mixer_controls</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Left DAC1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_29_MIX_REC_RIGHT</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Right DAC1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_29_MIX_REC_RIGHT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Left DAC2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_29_MIX_REC_RIGHT</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Right DAC2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_29_MIX_REC_RIGHT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;MIC1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_29_MIX_REC_RIGHT</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;MIC2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_29_MIX_REC_RIGHT</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INA1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_29_MIX_REC_RIGHT</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INA2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_29_MIX_REC_RIGHT</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INB1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_29_MIX_REC_RIGHT</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INB2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_29_MIX_REC_RIGHT</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="p">};</span>

<span class="cm">/* Left ADC mixer switch */</span>
<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">max98088_left_ADC_mixer_controls</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;MIC1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_23_MIX_ADC_LEFT</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;MIC2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_23_MIX_ADC_LEFT</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INA1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_23_MIX_ADC_LEFT</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INA2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_23_MIX_ADC_LEFT</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INB1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_23_MIX_ADC_LEFT</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INB2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_23_MIX_ADC_LEFT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="p">};</span>

<span class="cm">/* Right ADC mixer switch */</span>
<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">max98088_right_ADC_mixer_controls</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;MIC1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_24_MIX_ADC_RIGHT</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;MIC2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_24_MIX_ADC_RIGHT</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INA1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_24_MIX_ADC_RIGHT</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INA2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_24_MIX_ADC_RIGHT</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INB1 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_24_MIX_ADC_RIGHT</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;INB2 Switch&quot;</span><span class="p">,</span> <span class="n">M98088_REG_24_MIX_ADC_RIGHT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">max98088_mic_event</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_dapm_widget</span> <span class="o">*</span><span class="n">w</span><span class="p">,</span>
                            <span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span> <span class="kt">int</span> <span class="n">event</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">w</span><span class="o">-&gt;</span><span class="n">codec</span><span class="p">;</span>
       <span class="k">struct</span> <span class="n">max98088_priv</span> <span class="o">*</span><span class="n">max98088</span> <span class="o">=</span> <span class="n">snd_soc_codec_get_drvdata</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>

       <span class="k">switch</span> <span class="p">(</span><span class="n">event</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">case</span> <span class="n">SND_SOC_DAPM_POST_PMU</span>:
               <span class="k">if</span> <span class="p">(</span><span class="n">w</span><span class="o">-&gt;</span><span class="n">reg</span> <span class="o">==</span> <span class="n">M98088_REG_35_LVL_MIC1</span><span class="p">)</span> <span class="p">{</span>
                       <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">w</span><span class="o">-&gt;</span><span class="n">reg</span><span class="p">,</span> <span class="n">M98088_MICPRE_MASK</span><span class="p">,</span>
                               <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">max98088</span><span class="o">-&gt;</span><span class="n">mic1pre</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">M98088_MICPRE_SHIFT</span><span class="p">);</span>
               <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                       <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">w</span><span class="o">-&gt;</span><span class="n">reg</span><span class="p">,</span> <span class="n">M98088_MICPRE_MASK</span><span class="p">,</span>
                               <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">max98088</span><span class="o">-&gt;</span><span class="n">mic2pre</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">M98088_MICPRE_SHIFT</span><span class="p">);</span>
               <span class="p">}</span>
               <span class="k">break</span><span class="p">;</span>
       <span class="k">case</span> <span class="n">SND_SOC_DAPM_POST_PMD</span>:
               <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">w</span><span class="o">-&gt;</span><span class="n">reg</span><span class="p">,</span> <span class="n">M98088_MICPRE_MASK</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
               <span class="k">break</span><span class="p">;</span>
       <span class="nl">default:</span>
               <span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
       <span class="p">}</span>

       <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * The line inputs are 2-channel stereo inputs with the left</span>
<span class="cm"> * and right channels sharing a common PGA power control signal.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">max98088_line_pga</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_dapm_widget</span> <span class="o">*</span><span class="n">w</span><span class="p">,</span>
                            <span class="kt">int</span> <span class="n">event</span><span class="p">,</span> <span class="kt">int</span> <span class="n">line</span><span class="p">,</span> <span class="n">u8</span> <span class="n">channel</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">w</span><span class="o">-&gt;</span><span class="n">codec</span><span class="p">;</span>
       <span class="k">struct</span> <span class="n">max98088_priv</span> <span class="o">*</span><span class="n">max98088</span> <span class="o">=</span> <span class="n">snd_soc_codec_get_drvdata</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
       <span class="n">u8</span> <span class="o">*</span><span class="n">state</span><span class="p">;</span>

       <span class="n">BUG_ON</span><span class="p">(</span><span class="o">!</span><span class="p">((</span><span class="n">channel</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">channel</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)));</span>

       <span class="k">switch</span> <span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">case</span> <span class="n">LINE_INA</span>:
               <span class="n">state</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">max98088</span><span class="o">-&gt;</span><span class="n">ina_state</span><span class="p">;</span>
               <span class="k">break</span><span class="p">;</span>
       <span class="k">case</span> <span class="n">LINE_INB</span>:
               <span class="n">state</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">max98088</span><span class="o">-&gt;</span><span class="n">inb_state</span><span class="p">;</span>
               <span class="k">break</span><span class="p">;</span>
       <span class="nl">default:</span>
               <span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
       <span class="p">}</span>

       <span class="k">switch</span> <span class="p">(</span><span class="n">event</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">case</span> <span class="n">SND_SOC_DAPM_POST_PMU</span>:
               <span class="o">*</span><span class="n">state</span> <span class="o">|=</span> <span class="n">channel</span><span class="p">;</span>
               <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">w</span><span class="o">-&gt;</span><span class="n">reg</span><span class="p">,</span>
                       <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">w</span><span class="o">-&gt;</span><span class="n">shift</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">w</span><span class="o">-&gt;</span><span class="n">shift</span><span class="p">));</span>
               <span class="k">break</span><span class="p">;</span>
       <span class="k">case</span> <span class="n">SND_SOC_DAPM_POST_PMD</span>:
               <span class="o">*</span><span class="n">state</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">channel</span><span class="p">;</span>
               <span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="n">state</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                       <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">w</span><span class="o">-&gt;</span><span class="n">reg</span><span class="p">,</span>
                               <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">w</span><span class="o">-&gt;</span><span class="n">shift</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>
               <span class="p">}</span>
               <span class="k">break</span><span class="p">;</span>
       <span class="nl">default:</span>
               <span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
       <span class="p">}</span>

       <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">max98088_pga_ina1_event</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_dapm_widget</span> <span class="o">*</span><span class="n">w</span><span class="p">,</span>
                                  <span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="kt">int</span> <span class="n">event</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">return</span> <span class="n">max98088_line_pga</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">LINE_INA</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">max98088_pga_ina2_event</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_dapm_widget</span> <span class="o">*</span><span class="n">w</span><span class="p">,</span>
                                  <span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="kt">int</span> <span class="n">event</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">return</span> <span class="n">max98088_line_pga</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">LINE_INA</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">max98088_pga_inb1_event</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_dapm_widget</span> <span class="o">*</span><span class="n">w</span><span class="p">,</span>
                                  <span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="kt">int</span> <span class="n">event</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">return</span> <span class="n">max98088_line_pga</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">LINE_INB</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">max98088_pga_inb2_event</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_dapm_widget</span> <span class="o">*</span><span class="n">w</span><span class="p">,</span>
                                  <span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="kt">int</span> <span class="n">event</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">return</span> <span class="n">max98088_line_pga</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">LINE_INB</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_soc_dapm_widget</span> <span class="n">max98088_dapm_widgets</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>

       <span class="n">SND_SOC_DAPM_ADC</span><span class="p">(</span><span class="s">&quot;ADCL&quot;</span><span class="p">,</span> <span class="s">&quot;HiFi Capture&quot;</span><span class="p">,</span> <span class="n">M98088_REG_4C_PWR_EN_IN</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SND_SOC_DAPM_ADC</span><span class="p">(</span><span class="s">&quot;ADCR&quot;</span><span class="p">,</span> <span class="s">&quot;HiFi Capture&quot;</span><span class="p">,</span> <span class="n">M98088_REG_4C_PWR_EN_IN</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

       <span class="n">SND_SOC_DAPM_DAC</span><span class="p">(</span><span class="s">&quot;DACL1&quot;</span><span class="p">,</span> <span class="s">&quot;HiFi Playback&quot;</span><span class="p">,</span>
               <span class="n">M98088_REG_4D_PWR_EN_OUT</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SND_SOC_DAPM_DAC</span><span class="p">(</span><span class="s">&quot;DACR1&quot;</span><span class="p">,</span> <span class="s">&quot;HiFi Playback&quot;</span><span class="p">,</span>
               <span class="n">M98088_REG_4D_PWR_EN_OUT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SND_SOC_DAPM_DAC</span><span class="p">(</span><span class="s">&quot;DACL2&quot;</span><span class="p">,</span> <span class="s">&quot;Aux Playback&quot;</span><span class="p">,</span>
               <span class="n">M98088_REG_4D_PWR_EN_OUT</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SND_SOC_DAPM_DAC</span><span class="p">(</span><span class="s">&quot;DACR2&quot;</span><span class="p">,</span> <span class="s">&quot;Aux Playback&quot;</span><span class="p">,</span>
               <span class="n">M98088_REG_4D_PWR_EN_OUT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

       <span class="n">SND_SOC_DAPM_PGA</span><span class="p">(</span><span class="s">&quot;HP Left Out&quot;</span><span class="p">,</span> <span class="n">M98088_REG_4D_PWR_EN_OUT</span><span class="p">,</span>
               <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SND_SOC_DAPM_PGA</span><span class="p">(</span><span class="s">&quot;HP Right Out&quot;</span><span class="p">,</span> <span class="n">M98088_REG_4D_PWR_EN_OUT</span><span class="p">,</span>
               <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

       <span class="n">SND_SOC_DAPM_PGA</span><span class="p">(</span><span class="s">&quot;SPK Left Out&quot;</span><span class="p">,</span> <span class="n">M98088_REG_4D_PWR_EN_OUT</span><span class="p">,</span>
               <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SND_SOC_DAPM_PGA</span><span class="p">(</span><span class="s">&quot;SPK Right Out&quot;</span><span class="p">,</span> <span class="n">M98088_REG_4D_PWR_EN_OUT</span><span class="p">,</span>
               <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

       <span class="n">SND_SOC_DAPM_PGA</span><span class="p">(</span><span class="s">&quot;REC Left Out&quot;</span><span class="p">,</span> <span class="n">M98088_REG_4D_PWR_EN_OUT</span><span class="p">,</span>
               <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="n">SND_SOC_DAPM_PGA</span><span class="p">(</span><span class="s">&quot;REC Right Out&quot;</span><span class="p">,</span> <span class="n">M98088_REG_4D_PWR_EN_OUT</span><span class="p">,</span>
               <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

       <span class="n">SND_SOC_DAPM_MUX</span><span class="p">(</span><span class="s">&quot;External MIC&quot;</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
               <span class="o">&amp;</span><span class="n">max98088_extmic_mux</span><span class="p">),</span>

       <span class="n">SND_SOC_DAPM_MIXER</span><span class="p">(</span><span class="s">&quot;Left HP Mixer&quot;</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
               <span class="o">&amp;</span><span class="n">max98088_left_hp_mixer_controls</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
               <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">max98088_left_hp_mixer_controls</span><span class="p">)),</span>

       <span class="n">SND_SOC_DAPM_MIXER</span><span class="p">(</span><span class="s">&quot;Right HP Mixer&quot;</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
               <span class="o">&amp;</span><span class="n">max98088_right_hp_mixer_controls</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
               <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">max98088_right_hp_mixer_controls</span><span class="p">)),</span>

       <span class="n">SND_SOC_DAPM_MIXER</span><span class="p">(</span><span class="s">&quot;Left SPK Mixer&quot;</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
               <span class="o">&amp;</span><span class="n">max98088_left_speaker_mixer_controls</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
               <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">max98088_left_speaker_mixer_controls</span><span class="p">)),</span>

       <span class="n">SND_SOC_DAPM_MIXER</span><span class="p">(</span><span class="s">&quot;Right SPK Mixer&quot;</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
               <span class="o">&amp;</span><span class="n">max98088_right_speaker_mixer_controls</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
               <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">max98088_right_speaker_mixer_controls</span><span class="p">)),</span>

       <span class="n">SND_SOC_DAPM_MIXER</span><span class="p">(</span><span class="s">&quot;Left REC Mixer&quot;</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
         <span class="o">&amp;</span><span class="n">max98088_left_rec_mixer_controls</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
               <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">max98088_left_rec_mixer_controls</span><span class="p">)),</span>

       <span class="n">SND_SOC_DAPM_MIXER</span><span class="p">(</span><span class="s">&quot;Right REC Mixer&quot;</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
         <span class="o">&amp;</span><span class="n">max98088_right_rec_mixer_controls</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
               <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">max98088_right_rec_mixer_controls</span><span class="p">)),</span>

       <span class="n">SND_SOC_DAPM_MIXER</span><span class="p">(</span><span class="s">&quot;Left ADC Mixer&quot;</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
               <span class="o">&amp;</span><span class="n">max98088_left_ADC_mixer_controls</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
               <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">max98088_left_ADC_mixer_controls</span><span class="p">)),</span>

       <span class="n">SND_SOC_DAPM_MIXER</span><span class="p">(</span><span class="s">&quot;Right ADC Mixer&quot;</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
               <span class="o">&amp;</span><span class="n">max98088_right_ADC_mixer_controls</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
               <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">max98088_right_ADC_mixer_controls</span><span class="p">)),</span>

       <span class="n">SND_SOC_DAPM_PGA_E</span><span class="p">(</span><span class="s">&quot;MIC1 Input&quot;</span><span class="p">,</span> <span class="n">M98088_REG_35_LVL_MIC1</span><span class="p">,</span>
               <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">max98088_mic_event</span><span class="p">,</span>
               <span class="n">SND_SOC_DAPM_POST_PMU</span> <span class="o">|</span> <span class="n">SND_SOC_DAPM_POST_PMD</span><span class="p">),</span>

       <span class="n">SND_SOC_DAPM_PGA_E</span><span class="p">(</span><span class="s">&quot;MIC2 Input&quot;</span><span class="p">,</span> <span class="n">M98088_REG_36_LVL_MIC2</span><span class="p">,</span>
               <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">max98088_mic_event</span><span class="p">,</span>
               <span class="n">SND_SOC_DAPM_POST_PMU</span> <span class="o">|</span> <span class="n">SND_SOC_DAPM_POST_PMD</span><span class="p">),</span>

       <span class="n">SND_SOC_DAPM_PGA_E</span><span class="p">(</span><span class="s">&quot;INA1 Input&quot;</span><span class="p">,</span> <span class="n">M98088_REG_4C_PWR_EN_IN</span><span class="p">,</span>
               <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">max98088_pga_ina1_event</span><span class="p">,</span>
               <span class="n">SND_SOC_DAPM_POST_PMU</span> <span class="o">|</span> <span class="n">SND_SOC_DAPM_POST_PMD</span><span class="p">),</span>

       <span class="n">SND_SOC_DAPM_PGA_E</span><span class="p">(</span><span class="s">&quot;INA2 Input&quot;</span><span class="p">,</span> <span class="n">M98088_REG_4C_PWR_EN_IN</span><span class="p">,</span>
               <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">max98088_pga_ina2_event</span><span class="p">,</span>
               <span class="n">SND_SOC_DAPM_POST_PMU</span> <span class="o">|</span> <span class="n">SND_SOC_DAPM_POST_PMD</span><span class="p">),</span>

       <span class="n">SND_SOC_DAPM_PGA_E</span><span class="p">(</span><span class="s">&quot;INB1 Input&quot;</span><span class="p">,</span> <span class="n">M98088_REG_4C_PWR_EN_IN</span><span class="p">,</span>
               <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">max98088_pga_inb1_event</span><span class="p">,</span>
               <span class="n">SND_SOC_DAPM_POST_PMU</span> <span class="o">|</span> <span class="n">SND_SOC_DAPM_POST_PMD</span><span class="p">),</span>

       <span class="n">SND_SOC_DAPM_PGA_E</span><span class="p">(</span><span class="s">&quot;INB2 Input&quot;</span><span class="p">,</span> <span class="n">M98088_REG_4C_PWR_EN_IN</span><span class="p">,</span>
               <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">max98088_pga_inb2_event</span><span class="p">,</span>
               <span class="n">SND_SOC_DAPM_POST_PMU</span> <span class="o">|</span> <span class="n">SND_SOC_DAPM_POST_PMD</span><span class="p">),</span>

       <span class="n">SND_SOC_DAPM_MICBIAS</span><span class="p">(</span><span class="s">&quot;MICBIAS&quot;</span><span class="p">,</span> <span class="n">M98088_REG_4C_PWR_EN_IN</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

       <span class="n">SND_SOC_DAPM_OUTPUT</span><span class="p">(</span><span class="s">&quot;HPL&quot;</span><span class="p">),</span>
       <span class="n">SND_SOC_DAPM_OUTPUT</span><span class="p">(</span><span class="s">&quot;HPR&quot;</span><span class="p">),</span>
       <span class="n">SND_SOC_DAPM_OUTPUT</span><span class="p">(</span><span class="s">&quot;SPKL&quot;</span><span class="p">),</span>
       <span class="n">SND_SOC_DAPM_OUTPUT</span><span class="p">(</span><span class="s">&quot;SPKR&quot;</span><span class="p">),</span>
       <span class="n">SND_SOC_DAPM_OUTPUT</span><span class="p">(</span><span class="s">&quot;RECL&quot;</span><span class="p">),</span>
       <span class="n">SND_SOC_DAPM_OUTPUT</span><span class="p">(</span><span class="s">&quot;RECR&quot;</span><span class="p">),</span>

       <span class="n">SND_SOC_DAPM_INPUT</span><span class="p">(</span><span class="s">&quot;MIC1&quot;</span><span class="p">),</span>
       <span class="n">SND_SOC_DAPM_INPUT</span><span class="p">(</span><span class="s">&quot;MIC2&quot;</span><span class="p">),</span>
       <span class="n">SND_SOC_DAPM_INPUT</span><span class="p">(</span><span class="s">&quot;INA1&quot;</span><span class="p">),</span>
       <span class="n">SND_SOC_DAPM_INPUT</span><span class="p">(</span><span class="s">&quot;INA2&quot;</span><span class="p">),</span>
       <span class="n">SND_SOC_DAPM_INPUT</span><span class="p">(</span><span class="s">&quot;INB1&quot;</span><span class="p">),</span>
       <span class="n">SND_SOC_DAPM_INPUT</span><span class="p">(</span><span class="s">&quot;INB2&quot;</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_soc_dapm_route</span> <span class="n">max98088_audio_map</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
       <span class="cm">/* Left headphone output mixer */</span>
       <span class="p">{</span><span class="s">&quot;Left HP Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Left DAC1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;DACL1&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left HP Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Left DAC2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;DACL2&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left HP Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Right DAC1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;DACR1&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left HP Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Right DAC2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;DACR2&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left HP Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;MIC1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;MIC1 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left HP Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;MIC2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;MIC2 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left HP Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INA1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INA1 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left HP Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INA2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INA2 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left HP Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INB1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INB1 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left HP Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INB2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INB2 Input&quot;</span><span class="p">},</span>

       <span class="cm">/* Right headphone output mixer */</span>
       <span class="p">{</span><span class="s">&quot;Right HP Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Left DAC1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;DACL1&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right HP Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Left DAC2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;DACL2&quot;</span>  <span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right HP Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Right DAC1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;DACR1&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right HP Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Right DAC2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;DACR2&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right HP Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;MIC1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;MIC1 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right HP Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;MIC2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;MIC2 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right HP Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INA1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INA1 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right HP Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INA2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INA2 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right HP Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INB1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INB1 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right HP Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INB2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INB2 Input&quot;</span><span class="p">},</span>

       <span class="cm">/* Left speaker output mixer */</span>
       <span class="p">{</span><span class="s">&quot;Left SPK Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Left DAC1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;DACL1&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left SPK Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Left DAC2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;DACL2&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left SPK Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Right DAC1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;DACR1&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left SPK Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Right DAC2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;DACR2&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left SPK Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;MIC1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;MIC1 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left SPK Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;MIC2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;MIC2 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left SPK Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INA1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INA1 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left SPK Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INA2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INA2 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left SPK Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INB1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INB1 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left SPK Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INB2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INB2 Input&quot;</span><span class="p">},</span>

       <span class="cm">/* Right speaker output mixer */</span>
       <span class="p">{</span><span class="s">&quot;Right SPK Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Left DAC1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;DACL1&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right SPK Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Left DAC2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;DACL2&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right SPK Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Right DAC1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;DACR1&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right SPK Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Right DAC2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;DACR2&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right SPK Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;MIC1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;MIC1 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right SPK Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;MIC2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;MIC2 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right SPK Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INA1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INA1 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right SPK Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INA2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INA2 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right SPK Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INB1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INB1 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right SPK Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INB2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INB2 Input&quot;</span><span class="p">},</span>

       <span class="cm">/* Earpiece/Receiver output mixer */</span>
       <span class="p">{</span><span class="s">&quot;Left REC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Left DAC1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;DACL1&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left REC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Left DAC2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;DACL2&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left REC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Right DAC1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;DACR1&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left REC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Right DAC2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;DACR2&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left REC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;MIC1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;MIC1 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left REC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;MIC2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;MIC2 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left REC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INA1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INA1 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left REC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INA2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INA2 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left REC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INB1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INB1 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left REC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INB2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INB2 Input&quot;</span><span class="p">},</span>

       <span class="cm">/* Earpiece/Receiver output mixer */</span>
       <span class="p">{</span><span class="s">&quot;Right REC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Left DAC1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;DACL1&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right REC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Left DAC2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;DACL2&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right REC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Right DAC1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;DACR1&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right REC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Right DAC2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;DACR2&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right REC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;MIC1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;MIC1 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right REC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;MIC2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;MIC2 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right REC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INA1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INA1 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right REC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INA2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INA2 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right REC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INB1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INB1 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right REC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INB2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INB2 Input&quot;</span><span class="p">},</span>

       <span class="p">{</span><span class="s">&quot;HP Left Out&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Left HP Mixer&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;HP Right Out&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Right HP Mixer&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;SPK Left Out&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Left SPK Mixer&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;SPK Right Out&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Right SPK Mixer&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;REC Left Out&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Left REC Mixer&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;REC Right Out&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Right REC Mixer&quot;</span><span class="p">},</span>

       <span class="p">{</span><span class="s">&quot;HPL&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;HP Left Out&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;HPR&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;HP Right Out&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;SPKL&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;SPK Left Out&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;SPKR&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;SPK Right Out&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;RECL&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;REC Left Out&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;RECR&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;REC Right Out&quot;</span><span class="p">},</span>

       <span class="cm">/* Left ADC input mixer */</span>
       <span class="p">{</span><span class="s">&quot;Left ADC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;MIC1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;MIC1 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left ADC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;MIC2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;MIC2 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left ADC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INA1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INA1 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left ADC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INA2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INA2 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left ADC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INB1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INB1 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Left ADC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INB2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INB2 Input&quot;</span><span class="p">},</span>

       <span class="cm">/* Right ADC input mixer */</span>
       <span class="p">{</span><span class="s">&quot;Right ADC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;MIC1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;MIC1 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right ADC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;MIC2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;MIC2 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right ADC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INA1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INA1 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right ADC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INA2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INA2 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right ADC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INB1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INB1 Input&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;Right ADC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;INB2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;INB2 Input&quot;</span><span class="p">},</span>

       <span class="cm">/* Inputs */</span>
       <span class="p">{</span><span class="s">&quot;ADCL&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Left ADC Mixer&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;ADCR&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Right ADC Mixer&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;INA1 Input&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;INA1&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;INA2 Input&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;INA2&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;INB1 Input&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;INB1&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;INB2 Input&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;INB2&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;MIC1 Input&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;MIC1&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s">&quot;MIC2 Input&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;MIC2&quot;</span><span class="p">},</span>
<span class="p">};</span>

<span class="cm">/* codec mclk clock divider coefficients */</span>
<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="p">{</span>
       <span class="n">u32</span> <span class="n">rate</span><span class="p">;</span>
       <span class="n">u8</span>  <span class="n">sr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">rate_table</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
       <span class="p">{</span><span class="mi">8000</span><span class="p">,</span>  <span class="mh">0x10</span><span class="p">},</span>
       <span class="p">{</span><span class="mi">11025</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">},</span>
       <span class="p">{</span><span class="mi">16000</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">},</span>
       <span class="p">{</span><span class="mi">22050</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">},</span>
       <span class="p">{</span><span class="mi">24000</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">},</span>
       <span class="p">{</span><span class="mi">32000</span><span class="p">,</span> <span class="mh">0x60</span><span class="p">},</span>
       <span class="p">{</span><span class="mi">44100</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">},</span>
       <span class="p">{</span><span class="mi">48000</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">},</span>
       <span class="p">{</span><span class="mi">88200</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">},</span>
       <span class="p">{</span><span class="mi">96000</span><span class="p">,</span> <span class="mh">0xA0</span><span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">rate_value</span><span class="p">(</span><span class="kt">int</span> <span class="n">rate</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">value</span><span class="p">)</span>
<span class="p">{</span>
       <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

       <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">rate_table</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
               <span class="k">if</span> <span class="p">(</span><span class="n">rate_table</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">rate</span> <span class="o">&gt;=</span> <span class="n">rate</span><span class="p">)</span> <span class="p">{</span>
                       <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">rate_table</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">sr</span><span class="p">;</span>
                       <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
               <span class="p">}</span>
       <span class="p">}</span>
       <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">rate_table</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">sr</span><span class="p">;</span>
       <span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">max98088_dai1_hw_params</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_pcm_substream</span> <span class="o">*</span><span class="n">substream</span><span class="p">,</span>
                                  <span class="k">struct</span> <span class="n">snd_pcm_hw_params</span> <span class="o">*</span><span class="n">params</span><span class="p">,</span>
                                  <span class="k">struct</span> <span class="n">snd_soc_dai</span> <span class="o">*</span><span class="n">dai</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">dai</span><span class="o">-&gt;</span><span class="n">codec</span><span class="p">;</span>
       <span class="k">struct</span> <span class="n">max98088_priv</span> <span class="o">*</span><span class="n">max98088</span> <span class="o">=</span> <span class="n">snd_soc_codec_get_drvdata</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
       <span class="k">struct</span> <span class="n">max98088_cdata</span> <span class="o">*</span><span class="n">cdata</span><span class="p">;</span>
       <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">ni</span><span class="p">;</span>
       <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rate</span><span class="p">;</span>
       <span class="n">u8</span> <span class="n">regval</span><span class="p">;</span>

       <span class="n">cdata</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">max98088</span><span class="o">-&gt;</span><span class="n">dai</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

       <span class="n">rate</span> <span class="o">=</span> <span class="n">params_rate</span><span class="p">(</span><span class="n">params</span><span class="p">);</span>

       <span class="k">switch</span> <span class="p">(</span><span class="n">params_format</span><span class="p">(</span><span class="n">params</span><span class="p">))</span> <span class="p">{</span>
       <span class="k">case</span> <span class="n">SNDRV_PCM_FORMAT_S16_LE</span>:
               <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_14_DAI1_FORMAT</span><span class="p">,</span>
                       <span class="n">M98088_DAI_WS</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
               <span class="k">break</span><span class="p">;</span>
       <span class="k">case</span> <span class="n">SNDRV_PCM_FORMAT_S24_LE</span>:
               <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_14_DAI1_FORMAT</span><span class="p">,</span>
                       <span class="n">M98088_DAI_WS</span><span class="p">,</span> <span class="n">M98088_DAI_WS</span><span class="p">);</span>
               <span class="k">break</span><span class="p">;</span>
       <span class="nl">default:</span>
               <span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
       <span class="p">}</span>

       <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_51_PWR_SYS</span><span class="p">,</span> <span class="n">M98088_SHDNRUN</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

       <span class="k">if</span> <span class="p">(</span><span class="n">rate_value</span><span class="p">(</span><span class="n">rate</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">regval</span><span class="p">))</span>
               <span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>

       <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_11_DAI1_CLKMODE</span><span class="p">,</span>
               <span class="n">M98088_CLKMODE_MASK</span><span class="p">,</span> <span class="n">regval</span><span class="p">);</span>
       <span class="n">cdata</span><span class="o">-&gt;</span><span class="n">rate</span> <span class="o">=</span> <span class="n">rate</span><span class="p">;</span>

       <span class="cm">/* Configure NI when operating as master */</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">snd_soc_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_14_DAI1_FORMAT</span><span class="p">)</span>
               <span class="o">&amp;</span> <span class="n">M98088_DAI_MAS</span><span class="p">)</span> <span class="p">{</span>
               <span class="k">if</span> <span class="p">(</span><span class="n">max98088</span><span class="o">-&gt;</span><span class="n">sysclk</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                       <span class="n">dev_err</span><span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;Invalid system clock frequency</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
                       <span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
               <span class="p">}</span>
               <span class="n">ni</span> <span class="o">=</span> <span class="mi">65536ULL</span> <span class="o">*</span> <span class="p">(</span><span class="n">rate</span> <span class="o">&lt;</span> <span class="mi">50000</span> <span class="o">?</span> <span class="mi">96ULL</span> <span class="o">:</span> <span class="mi">48ULL</span><span class="p">)</span>
                               <span class="o">*</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="kt">int</span><span class="p">)</span><span class="n">rate</span><span class="p">;</span>
               <span class="n">do_div</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="kt">int</span><span class="p">)</span><span class="n">max98088</span><span class="o">-&gt;</span><span class="n">sysclk</span><span class="p">);</span>
               <span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_12_DAI1_CLKCFG_HI</span><span class="p">,</span>
                       <span class="p">(</span><span class="n">ni</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x7F</span><span class="p">);</span>
               <span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_13_DAI1_CLKCFG_LO</span><span class="p">,</span>
                       <span class="n">ni</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">);</span>
       <span class="p">}</span>

       <span class="cm">/* Update sample rate mode */</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">rate</span> <span class="o">&lt;</span> <span class="mi">50000</span><span class="p">)</span>
               <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_18_DAI1_FILTERS</span><span class="p">,</span>
                       <span class="n">M98088_DAI_DHF</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
       <span class="k">else</span>
               <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_18_DAI1_FILTERS</span><span class="p">,</span>
                       <span class="n">M98088_DAI_DHF</span><span class="p">,</span> <span class="n">M98088_DAI_DHF</span><span class="p">);</span>

       <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_51_PWR_SYS</span><span class="p">,</span> <span class="n">M98088_SHDNRUN</span><span class="p">,</span>
               <span class="n">M98088_SHDNRUN</span><span class="p">);</span>

       <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">max98088_dai2_hw_params</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_pcm_substream</span> <span class="o">*</span><span class="n">substream</span><span class="p">,</span>
                                  <span class="k">struct</span> <span class="n">snd_pcm_hw_params</span> <span class="o">*</span><span class="n">params</span><span class="p">,</span>
                                  <span class="k">struct</span> <span class="n">snd_soc_dai</span> <span class="o">*</span><span class="n">dai</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">dai</span><span class="o">-&gt;</span><span class="n">codec</span><span class="p">;</span>
       <span class="k">struct</span> <span class="n">max98088_priv</span> <span class="o">*</span><span class="n">max98088</span> <span class="o">=</span> <span class="n">snd_soc_codec_get_drvdata</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
       <span class="k">struct</span> <span class="n">max98088_cdata</span> <span class="o">*</span><span class="n">cdata</span><span class="p">;</span>
       <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">ni</span><span class="p">;</span>
       <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rate</span><span class="p">;</span>
       <span class="n">u8</span> <span class="n">regval</span><span class="p">;</span>

       <span class="n">cdata</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">max98088</span><span class="o">-&gt;</span><span class="n">dai</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>

       <span class="n">rate</span> <span class="o">=</span> <span class="n">params_rate</span><span class="p">(</span><span class="n">params</span><span class="p">);</span>

       <span class="k">switch</span> <span class="p">(</span><span class="n">params_format</span><span class="p">(</span><span class="n">params</span><span class="p">))</span> <span class="p">{</span>
       <span class="k">case</span> <span class="n">SNDRV_PCM_FORMAT_S16_LE</span>:
               <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_1C_DAI2_FORMAT</span><span class="p">,</span>
                       <span class="n">M98088_DAI_WS</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
               <span class="k">break</span><span class="p">;</span>
       <span class="k">case</span> <span class="n">SNDRV_PCM_FORMAT_S24_LE</span>:
               <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_1C_DAI2_FORMAT</span><span class="p">,</span>
                       <span class="n">M98088_DAI_WS</span><span class="p">,</span> <span class="n">M98088_DAI_WS</span><span class="p">);</span>
               <span class="k">break</span><span class="p">;</span>
       <span class="nl">default:</span>
               <span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
       <span class="p">}</span>

       <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_51_PWR_SYS</span><span class="p">,</span> <span class="n">M98088_SHDNRUN</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

       <span class="k">if</span> <span class="p">(</span><span class="n">rate_value</span><span class="p">(</span><span class="n">rate</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">regval</span><span class="p">))</span>
               <span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>

       <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_19_DAI2_CLKMODE</span><span class="p">,</span>
               <span class="n">M98088_CLKMODE_MASK</span><span class="p">,</span> <span class="n">regval</span><span class="p">);</span>
       <span class="n">cdata</span><span class="o">-&gt;</span><span class="n">rate</span> <span class="o">=</span> <span class="n">rate</span><span class="p">;</span>

       <span class="cm">/* Configure NI when operating as master */</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">snd_soc_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_1C_DAI2_FORMAT</span><span class="p">)</span>
               <span class="o">&amp;</span> <span class="n">M98088_DAI_MAS</span><span class="p">)</span> <span class="p">{</span>
               <span class="k">if</span> <span class="p">(</span><span class="n">max98088</span><span class="o">-&gt;</span><span class="n">sysclk</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                       <span class="n">dev_err</span><span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;Invalid system clock frequency</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
                       <span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
               <span class="p">}</span>
               <span class="n">ni</span> <span class="o">=</span> <span class="mi">65536ULL</span> <span class="o">*</span> <span class="p">(</span><span class="n">rate</span> <span class="o">&lt;</span> <span class="mi">50000</span> <span class="o">?</span> <span class="mi">96ULL</span> <span class="o">:</span> <span class="mi">48ULL</span><span class="p">)</span>
                               <span class="o">*</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="kt">int</span><span class="p">)</span><span class="n">rate</span><span class="p">;</span>
               <span class="n">do_div</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="kt">int</span><span class="p">)</span><span class="n">max98088</span><span class="o">-&gt;</span><span class="n">sysclk</span><span class="p">);</span>
               <span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_1A_DAI2_CLKCFG_HI</span><span class="p">,</span>
                       <span class="p">(</span><span class="n">ni</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x7F</span><span class="p">);</span>
               <span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_1B_DAI2_CLKCFG_LO</span><span class="p">,</span>
                       <span class="n">ni</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">);</span>
       <span class="p">}</span>

       <span class="cm">/* Update sample rate mode */</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">rate</span> <span class="o">&lt;</span> <span class="mi">50000</span><span class="p">)</span>
               <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_20_DAI2_FILTERS</span><span class="p">,</span>
                       <span class="n">M98088_DAI_DHF</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
       <span class="k">else</span>
               <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_20_DAI2_FILTERS</span><span class="p">,</span>
                       <span class="n">M98088_DAI_DHF</span><span class="p">,</span> <span class="n">M98088_DAI_DHF</span><span class="p">);</span>

       <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_51_PWR_SYS</span><span class="p">,</span> <span class="n">M98088_SHDNRUN</span><span class="p">,</span>
               <span class="n">M98088_SHDNRUN</span><span class="p">);</span>

       <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">max98088_dai_set_sysclk</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_dai</span> <span class="o">*</span><span class="n">dai</span><span class="p">,</span>
                                  <span class="kt">int</span> <span class="n">clk_id</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">freq</span><span class="p">,</span> <span class="kt">int</span> <span class="n">dir</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">dai</span><span class="o">-&gt;</span><span class="n">codec</span><span class="p">;</span>
       <span class="k">struct</span> <span class="n">max98088_priv</span> <span class="o">*</span><span class="n">max98088</span> <span class="o">=</span> <span class="n">snd_soc_codec_get_drvdata</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>

       <span class="cm">/* Requested clock frequency is already setup */</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">freq</span> <span class="o">==</span> <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">sysclk</span><span class="p">)</span>
               <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

       <span class="cm">/* Setup clocks for slave mode, and using the PLL</span>
<span class="cm">        * PSCLK = 0x01 (when master clk is 10MHz to 20MHz)</span>
<span class="cm">        *         0x02 (when master clk is 20MHz to 30MHz)..</span>
<span class="cm">        */</span>
       <span class="k">if</span> <span class="p">((</span><span class="n">freq</span> <span class="o">&gt;=</span> <span class="mi">10000000</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">freq</span> <span class="o">&lt;</span> <span class="mi">20000000</span><span class="p">))</span> <span class="p">{</span>
               <span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_10_SYS_CLK</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">);</span>
       <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">((</span><span class="n">freq</span> <span class="o">&gt;=</span> <span class="mi">20000000</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">freq</span> <span class="o">&lt;</span> <span class="mi">30000000</span><span class="p">))</span> <span class="p">{</span>
               <span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_10_SYS_CLK</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">);</span>
       <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
               <span class="n">dev_err</span><span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;Invalid master clock frequency</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
               <span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
       <span class="p">}</span>

       <span class="k">if</span> <span class="p">(</span><span class="n">snd_soc_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_51_PWR_SYS</span><span class="p">)</span>  <span class="o">&amp;</span> <span class="n">M98088_SHDNRUN</span><span class="p">)</span> <span class="p">{</span>
               <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_51_PWR_SYS</span><span class="p">,</span>
                       <span class="n">M98088_SHDNRUN</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
               <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_51_PWR_SYS</span><span class="p">,</span>
                       <span class="n">M98088_SHDNRUN</span><span class="p">,</span> <span class="n">M98088_SHDNRUN</span><span class="p">);</span>
       <span class="p">}</span>

       <span class="n">dev_dbg</span><span class="p">(</span><span class="n">dai</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;Clock source is %d at %uHz</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">clk_id</span><span class="p">,</span> <span class="n">freq</span><span class="p">);</span>

       <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">sysclk</span> <span class="o">=</span> <span class="n">freq</span><span class="p">;</span>
       <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">max98088_dai1_set_fmt</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_dai</span> <span class="o">*</span><span class="n">codec_dai</span><span class="p">,</span>
                                <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">fmt</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">codec_dai</span><span class="o">-&gt;</span><span class="n">codec</span><span class="p">;</span>
       <span class="k">struct</span> <span class="n">max98088_priv</span> <span class="o">*</span><span class="n">max98088</span> <span class="o">=</span> <span class="n">snd_soc_codec_get_drvdata</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
       <span class="k">struct</span> <span class="n">max98088_cdata</span> <span class="o">*</span><span class="n">cdata</span><span class="p">;</span>
       <span class="n">u8</span> <span class="n">reg15val</span><span class="p">;</span>
       <span class="n">u8</span> <span class="n">reg14val</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

       <span class="n">cdata</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">max98088</span><span class="o">-&gt;</span><span class="n">dai</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

       <span class="k">if</span> <span class="p">(</span><span class="n">fmt</span> <span class="o">!=</span> <span class="n">cdata</span><span class="o">-&gt;</span><span class="n">fmt</span><span class="p">)</span> <span class="p">{</span>
               <span class="n">cdata</span><span class="o">-&gt;</span><span class="n">fmt</span> <span class="o">=</span> <span class="n">fmt</span><span class="p">;</span>

               <span class="k">switch</span> <span class="p">(</span><span class="n">fmt</span> <span class="o">&amp;</span> <span class="n">SND_SOC_DAIFMT_MASTER_MASK</span><span class="p">)</span> <span class="p">{</span>
               <span class="k">case</span> <span class="n">SND_SOC_DAIFMT_CBS_CFS</span>:
                       <span class="cm">/* Slave mode PLL */</span>
                       <span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_12_DAI1_CLKCFG_HI</span><span class="p">,</span>
                               <span class="mh">0x80</span><span class="p">);</span>
                       <span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_13_DAI1_CLKCFG_LO</span><span class="p">,</span>
                               <span class="mh">0x00</span><span class="p">);</span>
                       <span class="k">break</span><span class="p">;</span>
               <span class="k">case</span> <span class="n">SND_SOC_DAIFMT_CBM_CFM</span>:
                       <span class="cm">/* Set to master mode */</span>
                       <span class="n">reg14val</span> <span class="o">|=</span> <span class="n">M98088_DAI_MAS</span><span class="p">;</span>
                       <span class="k">break</span><span class="p">;</span>
               <span class="k">case</span> <span class="n">SND_SOC_DAIFMT_CBS_CFM</span>:
               <span class="k">case</span> <span class="n">SND_SOC_DAIFMT_CBM_CFS</span>:
               <span class="nl">default:</span>
                       <span class="n">dev_err</span><span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;Clock mode unsupported&quot;</span><span class="p">);</span>
                       <span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
               <span class="p">}</span>

               <span class="k">switch</span> <span class="p">(</span><span class="n">fmt</span> <span class="o">&amp;</span> <span class="n">SND_SOC_DAIFMT_FORMAT_MASK</span><span class="p">)</span> <span class="p">{</span>
               <span class="k">case</span> <span class="n">SND_SOC_DAIFMT_I2S</span>:
                       <span class="n">reg14val</span> <span class="o">|=</span> <span class="n">M98088_DAI_DLY</span><span class="p">;</span>
                       <span class="k">break</span><span class="p">;</span>
               <span class="k">case</span> <span class="n">SND_SOC_DAIFMT_LEFT_J</span>:
                       <span class="k">break</span><span class="p">;</span>
               <span class="nl">default:</span>
                       <span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
               <span class="p">}</span>

               <span class="k">switch</span> <span class="p">(</span><span class="n">fmt</span> <span class="o">&amp;</span> <span class="n">SND_SOC_DAIFMT_INV_MASK</span><span class="p">)</span> <span class="p">{</span>
               <span class="k">case</span> <span class="n">SND_SOC_DAIFMT_NB_NF</span>:
                       <span class="k">break</span><span class="p">;</span>
               <span class="k">case</span> <span class="n">SND_SOC_DAIFMT_NB_IF</span>:
                       <span class="n">reg14val</span> <span class="o">|=</span> <span class="n">M98088_DAI_WCI</span><span class="p">;</span>
                       <span class="k">break</span><span class="p">;</span>
               <span class="k">case</span> <span class="n">SND_SOC_DAIFMT_IB_NF</span>:
                       <span class="n">reg14val</span> <span class="o">|=</span> <span class="n">M98088_DAI_BCI</span><span class="p">;</span>
                       <span class="k">break</span><span class="p">;</span>
               <span class="k">case</span> <span class="n">SND_SOC_DAIFMT_IB_IF</span>:
                       <span class="n">reg14val</span> <span class="o">|=</span> <span class="n">M98088_DAI_BCI</span><span class="o">|</span><span class="n">M98088_DAI_WCI</span><span class="p">;</span>
                       <span class="k">break</span><span class="p">;</span>
               <span class="nl">default:</span>
                       <span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
               <span class="p">}</span>

               <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_14_DAI1_FORMAT</span><span class="p">,</span>
                       <span class="n">M98088_DAI_MAS</span> <span class="o">|</span> <span class="n">M98088_DAI_DLY</span> <span class="o">|</span> <span class="n">M98088_DAI_BCI</span> <span class="o">|</span>
                       <span class="n">M98088_DAI_WCI</span><span class="p">,</span> <span class="n">reg14val</span><span class="p">);</span>

               <span class="n">reg15val</span> <span class="o">=</span> <span class="n">M98088_DAI_BSEL64</span><span class="p">;</span>
               <span class="k">if</span> <span class="p">(</span><span class="n">max98088</span><span class="o">-&gt;</span><span class="n">digmic</span><span class="p">)</span>
                       <span class="n">reg15val</span> <span class="o">|=</span> <span class="n">M98088_DAI_OSR64</span><span class="p">;</span>
               <span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_15_DAI1_CLOCK</span><span class="p">,</span> <span class="n">reg15val</span><span class="p">);</span>
       <span class="p">}</span>

       <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">max98088_dai2_set_fmt</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_dai</span> <span class="o">*</span><span class="n">codec_dai</span><span class="p">,</span>
                                <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">fmt</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">codec_dai</span><span class="o">-&gt;</span><span class="n">codec</span><span class="p">;</span>
       <span class="k">struct</span> <span class="n">max98088_priv</span> <span class="o">*</span><span class="n">max98088</span> <span class="o">=</span> <span class="n">snd_soc_codec_get_drvdata</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
       <span class="k">struct</span> <span class="n">max98088_cdata</span> <span class="o">*</span><span class="n">cdata</span><span class="p">;</span>
       <span class="n">u8</span> <span class="n">reg1Cval</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

       <span class="n">cdata</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">max98088</span><span class="o">-&gt;</span><span class="n">dai</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>

       <span class="k">if</span> <span class="p">(</span><span class="n">fmt</span> <span class="o">!=</span> <span class="n">cdata</span><span class="o">-&gt;</span><span class="n">fmt</span><span class="p">)</span> <span class="p">{</span>
               <span class="n">cdata</span><span class="o">-&gt;</span><span class="n">fmt</span> <span class="o">=</span> <span class="n">fmt</span><span class="p">;</span>

               <span class="k">switch</span> <span class="p">(</span><span class="n">fmt</span> <span class="o">&amp;</span> <span class="n">SND_SOC_DAIFMT_MASTER_MASK</span><span class="p">)</span> <span class="p">{</span>
               <span class="k">case</span> <span class="n">SND_SOC_DAIFMT_CBS_CFS</span>:
                       <span class="cm">/* Slave mode PLL */</span>
                       <span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_1A_DAI2_CLKCFG_HI</span><span class="p">,</span>
                               <span class="mh">0x80</span><span class="p">);</span>
                       <span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_1B_DAI2_CLKCFG_LO</span><span class="p">,</span>
                               <span class="mh">0x00</span><span class="p">);</span>
                       <span class="k">break</span><span class="p">;</span>
               <span class="k">case</span> <span class="n">SND_SOC_DAIFMT_CBM_CFM</span>:
                       <span class="cm">/* Set to master mode */</span>
                       <span class="n">reg1Cval</span> <span class="o">|=</span> <span class="n">M98088_DAI_MAS</span><span class="p">;</span>
                       <span class="k">break</span><span class="p">;</span>
               <span class="k">case</span> <span class="n">SND_SOC_DAIFMT_CBS_CFM</span>:
               <span class="k">case</span> <span class="n">SND_SOC_DAIFMT_CBM_CFS</span>:
               <span class="nl">default:</span>
                       <span class="n">dev_err</span><span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;Clock mode unsupported&quot;</span><span class="p">);</span>
                       <span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
               <span class="p">}</span>

               <span class="k">switch</span> <span class="p">(</span><span class="n">fmt</span> <span class="o">&amp;</span> <span class="n">SND_SOC_DAIFMT_FORMAT_MASK</span><span class="p">)</span> <span class="p">{</span>
               <span class="k">case</span> <span class="n">SND_SOC_DAIFMT_I2S</span>:
                       <span class="n">reg1Cval</span> <span class="o">|=</span> <span class="n">M98088_DAI_DLY</span><span class="p">;</span>
                       <span class="k">break</span><span class="p">;</span>
               <span class="k">case</span> <span class="n">SND_SOC_DAIFMT_LEFT_J</span>:
                       <span class="k">break</span><span class="p">;</span>
               <span class="nl">default:</span>
                       <span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
               <span class="p">}</span>

               <span class="k">switch</span> <span class="p">(</span><span class="n">fmt</span> <span class="o">&amp;</span> <span class="n">SND_SOC_DAIFMT_INV_MASK</span><span class="p">)</span> <span class="p">{</span>
               <span class="k">case</span> <span class="n">SND_SOC_DAIFMT_NB_NF</span>:
                       <span class="k">break</span><span class="p">;</span>
               <span class="k">case</span> <span class="n">SND_SOC_DAIFMT_NB_IF</span>:
                       <span class="n">reg1Cval</span> <span class="o">|=</span> <span class="n">M98088_DAI_WCI</span><span class="p">;</span>
                       <span class="k">break</span><span class="p">;</span>
               <span class="k">case</span> <span class="n">SND_SOC_DAIFMT_IB_NF</span>:
                       <span class="n">reg1Cval</span> <span class="o">|=</span> <span class="n">M98088_DAI_BCI</span><span class="p">;</span>
                       <span class="k">break</span><span class="p">;</span>
               <span class="k">case</span> <span class="n">SND_SOC_DAIFMT_IB_IF</span>:
                       <span class="n">reg1Cval</span> <span class="o">|=</span> <span class="n">M98088_DAI_BCI</span><span class="o">|</span><span class="n">M98088_DAI_WCI</span><span class="p">;</span>
                       <span class="k">break</span><span class="p">;</span>
               <span class="nl">default:</span>
                       <span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
               <span class="p">}</span>

               <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_1C_DAI2_FORMAT</span><span class="p">,</span>
                       <span class="n">M98088_DAI_MAS</span> <span class="o">|</span> <span class="n">M98088_DAI_DLY</span> <span class="o">|</span> <span class="n">M98088_DAI_BCI</span> <span class="o">|</span>
                       <span class="n">M98088_DAI_WCI</span><span class="p">,</span> <span class="n">reg1Cval</span><span class="p">);</span>

               <span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_1D_DAI2_CLOCK</span><span class="p">,</span>
                       <span class="n">M98088_DAI_BSEL64</span><span class="p">);</span>
       <span class="p">}</span>

       <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">max98088_dai1_digital_mute</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_dai</span> <span class="o">*</span><span class="n">codec_dai</span><span class="p">,</span> <span class="kt">int</span> <span class="n">mute</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">codec_dai</span><span class="o">-&gt;</span><span class="n">codec</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">reg</span><span class="p">;</span>

       <span class="k">if</span> <span class="p">(</span><span class="n">mute</span><span class="p">)</span>
               <span class="n">reg</span> <span class="o">=</span> <span class="n">M98088_DAI_MUTE</span><span class="p">;</span>
       <span class="k">else</span>
               <span class="n">reg</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

       <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_2F_LVL_DAI1_PLAY</span><span class="p">,</span>
                           <span class="n">M98088_DAI_MUTE_MASK</span><span class="p">,</span> <span class="n">reg</span><span class="p">);</span>
       <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">max98088_dai2_digital_mute</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_dai</span> <span class="o">*</span><span class="n">codec_dai</span><span class="p">,</span> <span class="kt">int</span> <span class="n">mute</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">codec_dai</span><span class="o">-&gt;</span><span class="n">codec</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">reg</span><span class="p">;</span>

       <span class="k">if</span> <span class="p">(</span><span class="n">mute</span><span class="p">)</span>
               <span class="n">reg</span> <span class="o">=</span> <span class="n">M98088_DAI_MUTE</span><span class="p">;</span>
       <span class="k">else</span>
               <span class="n">reg</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

       <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_31_LVL_DAI2_PLAY</span><span class="p">,</span>
                           <span class="n">M98088_DAI_MUTE_MASK</span><span class="p">,</span> <span class="n">reg</span><span class="p">);</span>
       <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">max98088_sync_cache</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
       <span class="n">u16</span> <span class="o">*</span><span class="n">reg_cache</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">reg_cache</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">cache_sync</span><span class="p">)</span>
               <span class="k">return</span><span class="p">;</span>

       <span class="n">codec</span><span class="o">-&gt;</span><span class="n">cache_only</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

       <span class="cm">/* write back cached values if they&#39;re writeable and</span>
<span class="cm">        * different from the hardware default.</span>
<span class="cm">        */</span>
       <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">driver</span><span class="o">-&gt;</span><span class="n">reg_cache_size</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
               <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">max98088_access</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">writable</span><span class="p">)</span>
                       <span class="k">continue</span><span class="p">;</span>

               <span class="k">if</span> <span class="p">(</span><span class="n">reg_cache</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">max98088_reg</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                       <span class="k">continue</span><span class="p">;</span>

               <span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">reg_cache</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
       <span class="p">}</span>

       <span class="n">codec</span><span class="o">-&gt;</span><span class="n">cache_sync</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">max98088_set_bias_level</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
                                  <span class="k">enum</span> <span class="n">snd_soc_bias_level</span> <span class="n">level</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">switch</span> <span class="p">(</span><span class="n">level</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">case</span> <span class="n">SND_SOC_BIAS_ON</span>:
               <span class="k">break</span><span class="p">;</span>

       <span class="k">case</span> <span class="n">SND_SOC_BIAS_PREPARE</span>:
               <span class="k">break</span><span class="p">;</span>

       <span class="k">case</span> <span class="n">SND_SOC_BIAS_STANDBY</span>:
               <span class="k">if</span> <span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">dapm</span><span class="p">.</span><span class="n">bias_level</span> <span class="o">==</span> <span class="n">SND_SOC_BIAS_OFF</span><span class="p">)</span>
                       <span class="n">max98088_sync_cache</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>

               <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_4C_PWR_EN_IN</span><span class="p">,</span>
                               <span class="n">M98088_MBEN</span><span class="p">,</span> <span class="n">M98088_MBEN</span><span class="p">);</span>
               <span class="k">break</span><span class="p">;</span>

       <span class="k">case</span> <span class="n">SND_SOC_BIAS_OFF</span>:
               <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_4C_PWR_EN_IN</span><span class="p">,</span>
                               <span class="n">M98088_MBEN</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
               <span class="n">codec</span><span class="o">-&gt;</span><span class="n">cache_sync</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
               <span class="k">break</span><span class="p">;</span>
       <span class="p">}</span>
       <span class="n">codec</span><span class="o">-&gt;</span><span class="n">dapm</span><span class="p">.</span><span class="n">bias_level</span> <span class="o">=</span> <span class="n">level</span><span class="p">;</span>
       <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#define MAX98088_RATES SNDRV_PCM_RATE_8000_96000</span>
<span class="cp">#define MAX98088_FORMATS (SNDRV_PCM_FMTBIT_S16_LE | SNDRV_PCM_FMTBIT_S24_LE)</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_soc_dai_ops</span> <span class="n">max98088_dai1_ops</span> <span class="o">=</span> <span class="p">{</span>
       <span class="p">.</span><span class="n">set_sysclk</span> <span class="o">=</span> <span class="n">max98088_dai_set_sysclk</span><span class="p">,</span>
       <span class="p">.</span><span class="n">set_fmt</span> <span class="o">=</span> <span class="n">max98088_dai1_set_fmt</span><span class="p">,</span>
       <span class="p">.</span><span class="n">hw_params</span> <span class="o">=</span> <span class="n">max98088_dai1_hw_params</span><span class="p">,</span>
       <span class="p">.</span><span class="n">digital_mute</span> <span class="o">=</span> <span class="n">max98088_dai1_digital_mute</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_soc_dai_ops</span> <span class="n">max98088_dai2_ops</span> <span class="o">=</span> <span class="p">{</span>
       <span class="p">.</span><span class="n">set_sysclk</span> <span class="o">=</span> <span class="n">max98088_dai_set_sysclk</span><span class="p">,</span>
       <span class="p">.</span><span class="n">set_fmt</span> <span class="o">=</span> <span class="n">max98088_dai2_set_fmt</span><span class="p">,</span>
       <span class="p">.</span><span class="n">hw_params</span> <span class="o">=</span> <span class="n">max98088_dai2_hw_params</span><span class="p">,</span>
       <span class="p">.</span><span class="n">digital_mute</span> <span class="o">=</span> <span class="n">max98088_dai2_digital_mute</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">snd_soc_dai_driver</span> <span class="n">max98088_dai</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
<span class="p">{</span>
       <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;HiFi&quot;</span><span class="p">,</span>
       <span class="p">.</span><span class="n">playback</span> <span class="o">=</span> <span class="p">{</span>
               <span class="p">.</span><span class="n">stream_name</span> <span class="o">=</span> <span class="s">&quot;HiFi Playback&quot;</span><span class="p">,</span>
               <span class="p">.</span><span class="n">channels_min</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
               <span class="p">.</span><span class="n">channels_max</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
               <span class="p">.</span><span class="n">rates</span> <span class="o">=</span> <span class="n">MAX98088_RATES</span><span class="p">,</span>
               <span class="p">.</span><span class="n">formats</span> <span class="o">=</span> <span class="n">MAX98088_FORMATS</span><span class="p">,</span>
       <span class="p">},</span>
       <span class="p">.</span><span class="n">capture</span> <span class="o">=</span> <span class="p">{</span>
               <span class="p">.</span><span class="n">stream_name</span> <span class="o">=</span> <span class="s">&quot;HiFi Capture&quot;</span><span class="p">,</span>
               <span class="p">.</span><span class="n">channels_min</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
               <span class="p">.</span><span class="n">channels_max</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
               <span class="p">.</span><span class="n">rates</span> <span class="o">=</span> <span class="n">MAX98088_RATES</span><span class="p">,</span>
               <span class="p">.</span><span class="n">formats</span> <span class="o">=</span> <span class="n">MAX98088_FORMATS</span><span class="p">,</span>
       <span class="p">},</span>
        <span class="p">.</span><span class="n">ops</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">max98088_dai1_ops</span><span class="p">,</span>
<span class="p">},</span>
<span class="p">{</span>
       <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Aux&quot;</span><span class="p">,</span>
       <span class="p">.</span><span class="n">playback</span> <span class="o">=</span> <span class="p">{</span>
               <span class="p">.</span><span class="n">stream_name</span> <span class="o">=</span> <span class="s">&quot;Aux Playback&quot;</span><span class="p">,</span>
               <span class="p">.</span><span class="n">channels_min</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
               <span class="p">.</span><span class="n">channels_max</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
               <span class="p">.</span><span class="n">rates</span> <span class="o">=</span> <span class="n">MAX98088_RATES</span><span class="p">,</span>
               <span class="p">.</span><span class="n">formats</span> <span class="o">=</span> <span class="n">MAX98088_FORMATS</span><span class="p">,</span>
       <span class="p">},</span>
       <span class="p">.</span><span class="n">ops</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">max98088_dai2_ops</span><span class="p">,</span>
<span class="p">}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">eq_mode_name</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;EQ1 Mode&quot;</span><span class="p">,</span> <span class="s">&quot;EQ2 Mode&quot;</span><span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">max98088_get_channel</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">eq_mode_name</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">eq_mode_name</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">i</span><span class="p">;</span>

	<span class="cm">/* Shouldn&#39;t happen */</span>
	<span class="n">dev_err</span><span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;Bad EQ channel name &#39;%s&#39;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">);</span>
	<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">max98088_setup_eq1</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">struct</span> <span class="n">max98088_priv</span> <span class="o">*</span><span class="n">max98088</span> <span class="o">=</span> <span class="n">snd_soc_codec_get_drvdata</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
       <span class="k">struct</span> <span class="n">max98088_pdata</span> <span class="o">*</span><span class="n">pdata</span> <span class="o">=</span> <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">pdata</span><span class="p">;</span>
       <span class="k">struct</span> <span class="n">max98088_eq_cfg</span> <span class="o">*</span><span class="n">coef_set</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">best</span><span class="p">,</span> <span class="n">best_val</span><span class="p">,</span> <span class="n">save</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">sel</span><span class="p">,</span> <span class="n">fs</span><span class="p">;</span>
       <span class="k">struct</span> <span class="n">max98088_cdata</span> <span class="o">*</span><span class="n">cdata</span><span class="p">;</span>

       <span class="n">cdata</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">max98088</span><span class="o">-&gt;</span><span class="n">dai</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">pdata</span> <span class="o">||</span> <span class="o">!</span><span class="n">max98088</span><span class="o">-&gt;</span><span class="n">eq_textcnt</span><span class="p">)</span>
               <span class="k">return</span><span class="p">;</span>

       <span class="cm">/* Find the selected configuration with nearest sample rate */</span>
       <span class="n">fs</span> <span class="o">=</span> <span class="n">cdata</span><span class="o">-&gt;</span><span class="n">rate</span><span class="p">;</span>
       <span class="n">sel</span> <span class="o">=</span> <span class="n">cdata</span><span class="o">-&gt;</span><span class="n">eq_sel</span><span class="p">;</span>

       <span class="n">best</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
       <span class="n">best_val</span> <span class="o">=</span> <span class="n">INT_MAX</span><span class="p">;</span>
       <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">pdata</span><span class="o">-&gt;</span><span class="n">eq_cfgcnt</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
               <span class="k">if</span> <span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">eq_cfg</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">name</span><span class="p">,</span> <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">eq_texts</span><span class="p">[</span><span class="n">sel</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span>
                   <span class="n">abs</span><span class="p">(</span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">eq_cfg</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">rate</span> <span class="o">-</span> <span class="n">fs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">best_val</span><span class="p">)</span> <span class="p">{</span>
                       <span class="n">best</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
                       <span class="n">best_val</span> <span class="o">=</span> <span class="n">abs</span><span class="p">(</span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">eq_cfg</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">rate</span> <span class="o">-</span> <span class="n">fs</span><span class="p">);</span>
               <span class="p">}</span>
       <span class="p">}</span>

       <span class="n">dev_dbg</span><span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;Selected %s/%dHz for %dHz sample rate</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
               <span class="n">pdata</span><span class="o">-&gt;</span><span class="n">eq_cfg</span><span class="p">[</span><span class="n">best</span><span class="p">].</span><span class="n">name</span><span class="p">,</span>
               <span class="n">pdata</span><span class="o">-&gt;</span><span class="n">eq_cfg</span><span class="p">[</span><span class="n">best</span><span class="p">].</span><span class="n">rate</span><span class="p">,</span> <span class="n">fs</span><span class="p">);</span>

       <span class="cm">/* Disable EQ while configuring, and save current on/off state */</span>
       <span class="n">save</span> <span class="o">=</span> <span class="n">snd_soc_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_49_CFG_LEVEL</span><span class="p">);</span>
       <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_49_CFG_LEVEL</span><span class="p">,</span> <span class="n">M98088_EQ1EN</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

       <span class="n">coef_set</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">eq_cfg</span><span class="p">[</span><span class="n">sel</span><span class="p">];</span>

       <span class="n">m98088_eq_band</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">coef_set</span><span class="o">-&gt;</span><span class="n">band1</span><span class="p">);</span>
       <span class="n">m98088_eq_band</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">coef_set</span><span class="o">-&gt;</span><span class="n">band2</span><span class="p">);</span>
       <span class="n">m98088_eq_band</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">coef_set</span><span class="o">-&gt;</span><span class="n">band3</span><span class="p">);</span>
       <span class="n">m98088_eq_band</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">coef_set</span><span class="o">-&gt;</span><span class="n">band4</span><span class="p">);</span>
       <span class="n">m98088_eq_band</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">coef_set</span><span class="o">-&gt;</span><span class="n">band5</span><span class="p">);</span>

       <span class="cm">/* Restore the original on/off state */</span>
       <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_49_CFG_LEVEL</span><span class="p">,</span> <span class="n">M98088_EQ1EN</span><span class="p">,</span> <span class="n">save</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">max98088_setup_eq2</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">struct</span> <span class="n">max98088_priv</span> <span class="o">*</span><span class="n">max98088</span> <span class="o">=</span> <span class="n">snd_soc_codec_get_drvdata</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
       <span class="k">struct</span> <span class="n">max98088_pdata</span> <span class="o">*</span><span class="n">pdata</span> <span class="o">=</span> <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">pdata</span><span class="p">;</span>
       <span class="k">struct</span> <span class="n">max98088_eq_cfg</span> <span class="o">*</span><span class="n">coef_set</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">best</span><span class="p">,</span> <span class="n">best_val</span><span class="p">,</span> <span class="n">save</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">sel</span><span class="p">,</span> <span class="n">fs</span><span class="p">;</span>
       <span class="k">struct</span> <span class="n">max98088_cdata</span> <span class="o">*</span><span class="n">cdata</span><span class="p">;</span>

       <span class="n">cdata</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">max98088</span><span class="o">-&gt;</span><span class="n">dai</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>

       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">pdata</span> <span class="o">||</span> <span class="o">!</span><span class="n">max98088</span><span class="o">-&gt;</span><span class="n">eq_textcnt</span><span class="p">)</span>
               <span class="k">return</span><span class="p">;</span>

       <span class="cm">/* Find the selected configuration with nearest sample rate */</span>
       <span class="n">fs</span> <span class="o">=</span> <span class="n">cdata</span><span class="o">-&gt;</span><span class="n">rate</span><span class="p">;</span>

       <span class="n">sel</span> <span class="o">=</span> <span class="n">cdata</span><span class="o">-&gt;</span><span class="n">eq_sel</span><span class="p">;</span>
       <span class="n">best</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
       <span class="n">best_val</span> <span class="o">=</span> <span class="n">INT_MAX</span><span class="p">;</span>
       <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">pdata</span><span class="o">-&gt;</span><span class="n">eq_cfgcnt</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
               <span class="k">if</span> <span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">eq_cfg</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">name</span><span class="p">,</span> <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">eq_texts</span><span class="p">[</span><span class="n">sel</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span>
                   <span class="n">abs</span><span class="p">(</span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">eq_cfg</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">rate</span> <span class="o">-</span> <span class="n">fs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">best_val</span><span class="p">)</span> <span class="p">{</span>
                       <span class="n">best</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
                       <span class="n">best_val</span> <span class="o">=</span> <span class="n">abs</span><span class="p">(</span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">eq_cfg</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">rate</span> <span class="o">-</span> <span class="n">fs</span><span class="p">);</span>
               <span class="p">}</span>
       <span class="p">}</span>

       <span class="n">dev_dbg</span><span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;Selected %s/%dHz for %dHz sample rate</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
               <span class="n">pdata</span><span class="o">-&gt;</span><span class="n">eq_cfg</span><span class="p">[</span><span class="n">best</span><span class="p">].</span><span class="n">name</span><span class="p">,</span>
               <span class="n">pdata</span><span class="o">-&gt;</span><span class="n">eq_cfg</span><span class="p">[</span><span class="n">best</span><span class="p">].</span><span class="n">rate</span><span class="p">,</span> <span class="n">fs</span><span class="p">);</span>

       <span class="cm">/* Disable EQ while configuring, and save current on/off state */</span>
       <span class="n">save</span> <span class="o">=</span> <span class="n">snd_soc_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_49_CFG_LEVEL</span><span class="p">);</span>
       <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_49_CFG_LEVEL</span><span class="p">,</span> <span class="n">M98088_EQ2EN</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

       <span class="n">coef_set</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">eq_cfg</span><span class="p">[</span><span class="n">sel</span><span class="p">];</span>

       <span class="n">m98088_eq_band</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">coef_set</span><span class="o">-&gt;</span><span class="n">band1</span><span class="p">);</span>
       <span class="n">m98088_eq_band</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">coef_set</span><span class="o">-&gt;</span><span class="n">band2</span><span class="p">);</span>
       <span class="n">m98088_eq_band</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">coef_set</span><span class="o">-&gt;</span><span class="n">band3</span><span class="p">);</span>
       <span class="n">m98088_eq_band</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">coef_set</span><span class="o">-&gt;</span><span class="n">band4</span><span class="p">);</span>
       <span class="n">m98088_eq_band</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">coef_set</span><span class="o">-&gt;</span><span class="n">band5</span><span class="p">);</span>

       <span class="cm">/* Restore the original on/off state */</span>
       <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_49_CFG_LEVEL</span><span class="p">,</span> <span class="n">M98088_EQ2EN</span><span class="p">,</span>
               <span class="n">save</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">max98088_put_eq_enum</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
                                <span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
       <span class="k">struct</span> <span class="n">max98088_priv</span> <span class="o">*</span><span class="n">max98088</span> <span class="o">=</span> <span class="n">snd_soc_codec_get_drvdata</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
       <span class="k">struct</span> <span class="n">max98088_pdata</span> <span class="o">*</span><span class="n">pdata</span> <span class="o">=</span> <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">pdata</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">channel</span> <span class="o">=</span> <span class="n">max98088_get_channel</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">kcontrol</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">.</span><span class="n">name</span><span class="p">);</span>
       <span class="k">struct</span> <span class="n">max98088_cdata</span> <span class="o">*</span><span class="n">cdata</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">sel</span> <span class="o">=</span> <span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">integer</span><span class="p">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

       <span class="k">if</span> <span class="p">(</span><span class="n">channel</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
	       <span class="k">return</span> <span class="n">channel</span><span class="p">;</span>

       <span class="n">cdata</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">max98088</span><span class="o">-&gt;</span><span class="n">dai</span><span class="p">[</span><span class="n">channel</span><span class="p">];</span>

       <span class="k">if</span> <span class="p">(</span><span class="n">sel</span> <span class="o">&gt;=</span> <span class="n">pdata</span><span class="o">-&gt;</span><span class="n">eq_cfgcnt</span><span class="p">)</span>
               <span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>

       <span class="n">cdata</span><span class="o">-&gt;</span><span class="n">eq_sel</span> <span class="o">=</span> <span class="n">sel</span><span class="p">;</span>

       <span class="k">switch</span> <span class="p">(</span><span class="n">channel</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">case</span> <span class="mi">0</span>:
               <span class="n">max98088_setup_eq1</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
               <span class="k">break</span><span class="p">;</span>
       <span class="k">case</span> <span class="mi">1</span>:
               <span class="n">max98088_setup_eq2</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
               <span class="k">break</span><span class="p">;</span>
       <span class="p">}</span>

       <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">max98088_get_eq_enum</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
                                <span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
       <span class="k">struct</span> <span class="n">max98088_priv</span> <span class="o">*</span><span class="n">max98088</span> <span class="o">=</span> <span class="n">snd_soc_codec_get_drvdata</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
       <span class="kt">int</span> <span class="n">channel</span> <span class="o">=</span> <span class="n">max98088_get_channel</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">kcontrol</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">.</span><span class="n">name</span><span class="p">);</span>
       <span class="k">struct</span> <span class="n">max98088_cdata</span> <span class="o">*</span><span class="n">cdata</span><span class="p">;</span>

       <span class="k">if</span> <span class="p">(</span><span class="n">channel</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
	       <span class="k">return</span> <span class="n">channel</span><span class="p">;</span>

       <span class="n">cdata</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">max98088</span><span class="o">-&gt;</span><span class="n">dai</span><span class="p">[</span><span class="n">channel</span><span class="p">];</span>
       <span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">enumerated</span><span class="p">.</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cdata</span><span class="o">-&gt;</span><span class="n">eq_sel</span><span class="p">;</span>
       <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">max98088_handle_eq_pdata</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">struct</span> <span class="n">max98088_priv</span> <span class="o">*</span><span class="n">max98088</span> <span class="o">=</span> <span class="n">snd_soc_codec_get_drvdata</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
       <span class="k">struct</span> <span class="n">max98088_pdata</span> <span class="o">*</span><span class="n">pdata</span> <span class="o">=</span> <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">pdata</span><span class="p">;</span>
       <span class="k">struct</span> <span class="n">max98088_eq_cfg</span> <span class="o">*</span><span class="n">cfg</span><span class="p">;</span>
       <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cfgcnt</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">;</span>
       <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">t</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">ret</span><span class="p">;</span>
       <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">controls</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
               <span class="n">SOC_ENUM_EXT</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">eq_mode_name</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                       <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">eq_enum</span><span class="p">,</span>
                       <span class="n">max98088_get_eq_enum</span><span class="p">,</span>
                       <span class="n">max98088_put_eq_enum</span><span class="p">),</span>
               <span class="n">SOC_ENUM_EXT</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">eq_mode_name</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                       <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">eq_enum</span><span class="p">,</span>
                       <span class="n">max98088_get_eq_enum</span><span class="p">,</span>
                       <span class="n">max98088_put_eq_enum</span><span class="p">),</span>
       <span class="p">};</span>
       <span class="n">BUILD_BUG_ON</span><span class="p">(</span><span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">controls</span><span class="p">)</span> <span class="o">!=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">eq_mode_name</span><span class="p">));</span>

       <span class="n">cfg</span> <span class="o">=</span> <span class="n">pdata</span><span class="o">-&gt;</span><span class="n">eq_cfg</span><span class="p">;</span>
       <span class="n">cfgcnt</span> <span class="o">=</span> <span class="n">pdata</span><span class="o">-&gt;</span><span class="n">eq_cfgcnt</span><span class="p">;</span>

       <span class="cm">/* Setup an array of texts for the equalizer enum.</span>
<span class="cm">        * This is based on Mark Brown&#39;s equalizer driver code.</span>
<span class="cm">        */</span>
       <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">eq_textcnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
       <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">eq_texts</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
       <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cfgcnt</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
               <span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">eq_textcnt</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                       <span class="k">if</span> <span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">name</span><span class="p">,</span> <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">eq_texts</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
                               <span class="k">break</span><span class="p">;</span>
               <span class="p">}</span>

               <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">!=</span> <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">eq_textcnt</span><span class="p">)</span>
                       <span class="k">continue</span><span class="p">;</span>

               <span class="cm">/* Expand the array */</span>
               <span class="n">t</span> <span class="o">=</span> <span class="n">krealloc</span><span class="p">(</span><span class="n">max98088</span><span class="o">-&gt;</span><span class="n">eq_texts</span><span class="p">,</span>
                            <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">max98088</span><span class="o">-&gt;</span><span class="n">eq_textcnt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                            <span class="n">GFP_KERNEL</span><span class="p">);</span>
               <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
                       <span class="k">continue</span><span class="p">;</span>

               <span class="cm">/* Store the new entry */</span>
               <span class="n">t</span><span class="p">[</span><span class="n">max98088</span><span class="o">-&gt;</span><span class="n">eq_textcnt</span><span class="p">]</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">name</span><span class="p">;</span>
               <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">eq_textcnt</span><span class="o">++</span><span class="p">;</span>
               <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">eq_texts</span> <span class="o">=</span> <span class="n">t</span><span class="p">;</span>
       <span class="p">}</span>

       <span class="cm">/* Now point the soc_enum to .texts array items */</span>
       <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">eq_enum</span><span class="p">.</span><span class="n">texts</span> <span class="o">=</span> <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">eq_texts</span><span class="p">;</span>
       <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">eq_enum</span><span class="p">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">eq_textcnt</span><span class="p">;</span>

       <span class="n">ret</span> <span class="o">=</span> <span class="n">snd_soc_add_codec_controls</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">controls</span><span class="p">,</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">controls</span><span class="p">));</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
               <span class="n">dev_err</span><span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;Failed to add EQ control: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">ret</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">max98088_handle_pdata</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">struct</span> <span class="n">max98088_priv</span> <span class="o">*</span><span class="n">max98088</span> <span class="o">=</span> <span class="n">snd_soc_codec_get_drvdata</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
       <span class="k">struct</span> <span class="n">max98088_pdata</span> <span class="o">*</span><span class="n">pdata</span> <span class="o">=</span> <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">pdata</span><span class="p">;</span>
       <span class="n">u8</span> <span class="n">regval</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">pdata</span><span class="p">)</span> <span class="p">{</span>
               <span class="n">dev_dbg</span><span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;No platform data</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
               <span class="k">return</span><span class="p">;</span>
       <span class="p">}</span>

       <span class="cm">/* Configure mic for analog/digital mic mode */</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">digmic_left_mode</span><span class="p">)</span>
               <span class="n">regval</span> <span class="o">|=</span> <span class="n">M98088_DIGMIC_L</span><span class="p">;</span>

       <span class="k">if</span> <span class="p">(</span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">digmic_right_mode</span><span class="p">)</span>
               <span class="n">regval</span> <span class="o">|=</span> <span class="n">M98088_DIGMIC_R</span><span class="p">;</span>

       <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">digmic</span> <span class="o">=</span> <span class="p">(</span><span class="n">regval</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>

       <span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_48_CFG_MIC</span><span class="p">,</span> <span class="n">regval</span><span class="p">);</span>

       <span class="cm">/* Configure receiver output */</span>
       <span class="n">regval</span> <span class="o">=</span> <span class="p">((</span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">receiver_mode</span><span class="p">)</span> <span class="o">?</span> <span class="n">M98088_REC_LINEMODE</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
       <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_2A_MIC_REC_CNTL</span><span class="p">,</span>
               <span class="n">M98088_REC_LINEMODE_MASK</span><span class="p">,</span> <span class="n">regval</span><span class="p">);</span>

       <span class="cm">/* Configure equalizers */</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">eq_cfgcnt</span><span class="p">)</span>
               <span class="n">max98088_handle_eq_pdata</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
<span class="p">}</span>

<span class="cp">#ifdef CONFIG_PM</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">max98088_suspend</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
       <span class="n">max98088_set_bias_level</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">SND_SOC_BIAS_OFF</span><span class="p">);</span>

       <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">max98088_resume</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
       <span class="n">max98088_set_bias_level</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">SND_SOC_BIAS_STANDBY</span><span class="p">);</span>

       <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">#else</span>
<span class="cp">#define max98088_suspend NULL</span>
<span class="cp">#define max98088_resume NULL</span>
<span class="cp">#endif</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">max98088_probe</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">struct</span> <span class="n">max98088_priv</span> <span class="o">*</span><span class="n">max98088</span> <span class="o">=</span> <span class="n">snd_soc_codec_get_drvdata</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
       <span class="k">struct</span> <span class="n">max98088_cdata</span> <span class="o">*</span><span class="n">cdata</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

       <span class="n">codec</span><span class="o">-&gt;</span><span class="n">cache_sync</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

       <span class="n">ret</span> <span class="o">=</span> <span class="n">snd_soc_codec_set_cache_io</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">SND_SOC_I2C</span><span class="p">);</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
               <span class="n">dev_err</span><span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;Failed to set cache I/O: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">ret</span><span class="p">);</span>
               <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
       <span class="p">}</span>

       <span class="cm">/* initialize private data */</span>

       <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">sysclk</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
       <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">eq_textcnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

       <span class="n">cdata</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">max98088</span><span class="o">-&gt;</span><span class="n">dai</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
       <span class="n">cdata</span><span class="o">-&gt;</span><span class="n">rate</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
       <span class="n">cdata</span><span class="o">-&gt;</span><span class="n">fmt</span>  <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
       <span class="n">cdata</span><span class="o">-&gt;</span><span class="n">eq_sel</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

       <span class="n">cdata</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">max98088</span><span class="o">-&gt;</span><span class="n">dai</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
       <span class="n">cdata</span><span class="o">-&gt;</span><span class="n">rate</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
       <span class="n">cdata</span><span class="o">-&gt;</span><span class="n">fmt</span>  <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
       <span class="n">cdata</span><span class="o">-&gt;</span><span class="n">eq_sel</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

       <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">ina_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
       <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">inb_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
       <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">ex_mode</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
       <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">digmic</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
       <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">mic1pre</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
       <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">mic2pre</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

       <span class="n">ret</span> <span class="o">=</span> <span class="n">snd_soc_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_FF_REV_ID</span><span class="p">);</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
               <span class="n">dev_err</span><span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;Failed to read device revision: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
                       <span class="n">ret</span><span class="p">);</span>
               <span class="k">goto</span> <span class="n">err_access</span><span class="p">;</span>
       <span class="p">}</span>
       <span class="n">dev_info</span><span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;revision %c</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">ret</span> <span class="o">+</span> <span class="sc">&#39;A&#39;</span><span class="p">);</span>

       <span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_51_PWR_SYS</span><span class="p">,</span> <span class="n">M98088_PWRSV</span><span class="p">);</span>

       <span class="cm">/* initialize registers cache to hardware default */</span>
       <span class="n">max98088_set_bias_level</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">SND_SOC_BIAS_STANDBY</span><span class="p">);</span>

       <span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_0F_IRQ_ENABLE</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">);</span>

       <span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_22_MIX_DAC</span><span class="p">,</span>
               <span class="n">M98088_DAI1L_TO_DACL</span><span class="o">|</span><span class="n">M98088_DAI2L_TO_DACL</span><span class="o">|</span>
               <span class="n">M98088_DAI1R_TO_DACR</span><span class="o">|</span><span class="n">M98088_DAI2R_TO_DACR</span><span class="p">);</span>

       <span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_4E_BIAS_CNTL</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">);</span>
       <span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_50_DAC_BIAS2</span><span class="p">,</span> <span class="mh">0x0F</span><span class="p">);</span>

       <span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_16_DAI1_IOCFG</span><span class="p">,</span>
               <span class="n">M98088_S1NORMAL</span><span class="o">|</span><span class="n">M98088_SDATA</span><span class="p">);</span>

       <span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">M98088_REG_1E_DAI2_IOCFG</span><span class="p">,</span>
               <span class="n">M98088_S2NORMAL</span><span class="o">|</span><span class="n">M98088_SDATA</span><span class="p">);</span>

       <span class="n">max98088_handle_pdata</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>

       <span class="n">snd_soc_add_codec_controls</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">max98088_snd_controls</span><span class="p">,</span>
                            <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">max98088_snd_controls</span><span class="p">));</span>

<span class="nl">err_access:</span>
       <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">max98088_remove</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">struct</span> <span class="n">max98088_priv</span> <span class="o">*</span><span class="n">max98088</span> <span class="o">=</span> <span class="n">snd_soc_codec_get_drvdata</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>

       <span class="n">max98088_set_bias_level</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">SND_SOC_BIAS_OFF</span><span class="p">);</span>
       <span class="n">kfree</span><span class="p">(</span><span class="n">max98088</span><span class="o">-&gt;</span><span class="n">eq_texts</span><span class="p">);</span>

       <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">snd_soc_codec_driver</span> <span class="n">soc_codec_dev_max98088</span> <span class="o">=</span> <span class="p">{</span>
       <span class="p">.</span><span class="n">probe</span>   <span class="o">=</span> <span class="n">max98088_probe</span><span class="p">,</span>
       <span class="p">.</span><span class="n">remove</span>  <span class="o">=</span> <span class="n">max98088_remove</span><span class="p">,</span>
       <span class="p">.</span><span class="n">suspend</span> <span class="o">=</span> <span class="n">max98088_suspend</span><span class="p">,</span>
       <span class="p">.</span><span class="n">resume</span>  <span class="o">=</span> <span class="n">max98088_resume</span><span class="p">,</span>
       <span class="p">.</span><span class="n">set_bias_level</span> <span class="o">=</span> <span class="n">max98088_set_bias_level</span><span class="p">,</span>
       <span class="p">.</span><span class="n">reg_cache_size</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">max98088_reg</span><span class="p">),</span>
       <span class="p">.</span><span class="n">reg_word_size</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">u8</span><span class="p">),</span>
       <span class="p">.</span><span class="n">reg_cache_default</span> <span class="o">=</span> <span class="n">max98088_reg</span><span class="p">,</span>
       <span class="p">.</span><span class="n">volatile_register</span> <span class="o">=</span> <span class="n">max98088_volatile_register</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dapm_widgets</span> <span class="o">=</span> <span class="n">max98088_dapm_widgets</span><span class="p">,</span>
	<span class="p">.</span><span class="n">num_dapm_widgets</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">max98088_dapm_widgets</span><span class="p">),</span>
	<span class="p">.</span><span class="n">dapm_routes</span> <span class="o">=</span> <span class="n">max98088_audio_map</span><span class="p">,</span>
	<span class="p">.</span><span class="n">num_dapm_routes</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">max98088_audio_map</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">max98088_i2c_probe</span><span class="p">(</span><span class="k">struct</span> <span class="n">i2c_client</span> <span class="o">*</span><span class="n">i2c</span><span class="p">,</span>
                            <span class="k">const</span> <span class="k">struct</span> <span class="n">i2c_device_id</span> <span class="o">*</span><span class="n">id</span><span class="p">)</span>
<span class="p">{</span>
       <span class="k">struct</span> <span class="n">max98088_priv</span> <span class="o">*</span><span class="n">max98088</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">ret</span><span class="p">;</span>

       <span class="n">max98088</span> <span class="o">=</span> <span class="n">devm_kzalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">i2c</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">max98088_priv</span><span class="p">),</span>
			       <span class="n">GFP_KERNEL</span><span class="p">);</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">max98088</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
               <span class="k">return</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>

       <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">devtype</span> <span class="o">=</span> <span class="n">id</span><span class="o">-&gt;</span><span class="n">driver_data</span><span class="p">;</span>

       <span class="n">i2c_set_clientdata</span><span class="p">(</span><span class="n">i2c</span><span class="p">,</span> <span class="n">max98088</span><span class="p">);</span>
       <span class="n">max98088</span><span class="o">-&gt;</span><span class="n">pdata</span> <span class="o">=</span> <span class="n">i2c</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">.</span><span class="n">platform_data</span><span class="p">;</span>

       <span class="n">ret</span> <span class="o">=</span> <span class="n">snd_soc_register_codec</span><span class="p">(</span><span class="o">&amp;</span><span class="n">i2c</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span>
                       <span class="o">&amp;</span><span class="n">soc_codec_dev_max98088</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">max98088_dai</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">);</span>
       <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="n">__devexit</span> <span class="nf">max98088_i2c_remove</span><span class="p">(</span><span class="k">struct</span> <span class="n">i2c_client</span> <span class="o">*</span><span class="n">client</span><span class="p">)</span>
<span class="p">{</span>
       <span class="n">snd_soc_unregister_codec</span><span class="p">(</span><span class="o">&amp;</span><span class="n">client</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">);</span>
       <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">i2c_device_id</span> <span class="n">max98088_i2c_id</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
       <span class="p">{</span> <span class="s">&quot;max98088&quot;</span><span class="p">,</span> <span class="n">MAX98088</span> <span class="p">},</span>
       <span class="p">{</span> <span class="s">&quot;max98089&quot;</span><span class="p">,</span> <span class="n">MAX98089</span> <span class="p">},</span>
       <span class="p">{</span> <span class="p">}</span>
<span class="p">};</span>
<span class="n">MODULE_DEVICE_TABLE</span><span class="p">(</span><span class="n">i2c</span><span class="p">,</span> <span class="n">max98088_i2c_id</span><span class="p">);</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">i2c_driver</span> <span class="n">max98088_i2c_driver</span> <span class="o">=</span> <span class="p">{</span>
       <span class="p">.</span><span class="n">driver</span> <span class="o">=</span> <span class="p">{</span>
               <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;max98088&quot;</span><span class="p">,</span>
               <span class="p">.</span><span class="n">owner</span> <span class="o">=</span> <span class="n">THIS_MODULE</span><span class="p">,</span>
       <span class="p">},</span>
       <span class="p">.</span><span class="n">probe</span>  <span class="o">=</span> <span class="n">max98088_i2c_probe</span><span class="p">,</span>
       <span class="p">.</span><span class="n">remove</span> <span class="o">=</span> <span class="n">__devexit_p</span><span class="p">(</span><span class="n">max98088_i2c_remove</span><span class="p">),</span>
       <span class="p">.</span><span class="n">id_table</span> <span class="o">=</span> <span class="n">max98088_i2c_id</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="n">__init</span> <span class="nf">max98088_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
       <span class="kt">int</span> <span class="n">ret</span><span class="p">;</span>

       <span class="n">ret</span> <span class="o">=</span> <span class="n">i2c_add_driver</span><span class="p">(</span><span class="o">&amp;</span><span class="n">max98088_i2c_driver</span><span class="p">);</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span>
               <span class="n">pr_err</span><span class="p">(</span><span class="s">&quot;Failed to register max98088 I2C driver: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">ret</span><span class="p">);</span>

       <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">module_init</span><span class="p">(</span><span class="n">max98088_init</span><span class="p">);</span>

<span class="k">static</span> <span class="kt">void</span> <span class="n">__exit</span> <span class="nf">max98088_exit</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
       <span class="n">i2c_del_driver</span><span class="p">(</span><span class="o">&amp;</span><span class="n">max98088_i2c_driver</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">module_exit</span><span class="p">(</span><span class="n">max98088_exit</span><span class="p">);</span>

<span class="n">MODULE_DESCRIPTION</span><span class="p">(</span><span class="s">&quot;ALSA SoC MAX98088 driver&quot;</span><span class="p">);</span>
<span class="n">MODULE_AUTHOR</span><span class="p">(</span><span class="s">&quot;Peter Hsiang, Jesse Marroquin&quot;</span><span class="p">);</span>
<span class="n">MODULE_LICENSE</span><span class="p">(</span><span class="s">&quot;GPL&quot;</span><span class="p">);</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
