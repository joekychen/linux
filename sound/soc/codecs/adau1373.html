<!DOCTYPE html>
<html><head><title>joekychen/linux » sound › soc › codecs › adau1373.c

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>adau1373.c</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Analog Devices ADAU1373 Audio Codec drive</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright 2011 Analog Devices Inc.</span>
<span class="cm"> * Author: Lars-Peter Clausen &lt;lars@metafoo.de&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * Licensed under the GPL-2 or later.</span>
<span class="cm"> */</span>

<span class="cp">#include &lt;linux/module.h&gt;</span>
<span class="cp">#include &lt;linux/init.h&gt;</span>
<span class="cp">#include &lt;linux/delay.h&gt;</span>
<span class="cp">#include &lt;linux/pm.h&gt;</span>
<span class="cp">#include &lt;linux/i2c.h&gt;</span>
<span class="cp">#include &lt;linux/slab.h&gt;</span>
<span class="cp">#include &lt;linux/gcd.h&gt;</span>

<span class="cp">#include &lt;sound/core.h&gt;</span>
<span class="cp">#include &lt;sound/pcm.h&gt;</span>
<span class="cp">#include &lt;sound/pcm_params.h&gt;</span>
<span class="cp">#include &lt;sound/tlv.h&gt;</span>
<span class="cp">#include &lt;sound/soc.h&gt;</span>
<span class="cp">#include &lt;sound/adau1373.h&gt;</span>

<span class="cp">#include &quot;adau1373.h&quot;</span>

<span class="k">struct</span> <span class="n">adau1373_dai</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">clk_src</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">sysclk</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">enable_src</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">master</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">adau1373</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">adau1373_dai</span> <span class="n">dais</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="p">};</span>

<span class="cp">#define ADAU1373_INPUT_MODE	0x00</span>
<span class="cp">#define ADAU1373_AINL_CTRL(x)	(0x01 + (x) * 2)</span>
<span class="cp">#define ADAU1373_AINR_CTRL(x)	(0x02 + (x) * 2)</span>
<span class="cp">#define ADAU1373_LLINE_OUT(x)	(0x9 + (x) * 2)</span>
<span class="cp">#define ADAU1373_RLINE_OUT(x)	(0xa + (x) * 2)</span>
<span class="cp">#define ADAU1373_LSPK_OUT	0x0d</span>
<span class="cp">#define ADAU1373_RSPK_OUT	0x0e</span>
<span class="cp">#define ADAU1373_LHP_OUT	0x0f</span>
<span class="cp">#define ADAU1373_RHP_OUT	0x10</span>
<span class="cp">#define ADAU1373_ADC_GAIN	0x11</span>
<span class="cp">#define ADAU1373_LADC_MIXER	0x12</span>
<span class="cp">#define ADAU1373_RADC_MIXER	0x13</span>
<span class="cp">#define ADAU1373_LLINE1_MIX	0x14</span>
<span class="cp">#define ADAU1373_RLINE1_MIX	0x15</span>
<span class="cp">#define ADAU1373_LLINE2_MIX	0x16</span>
<span class="cp">#define ADAU1373_RLINE2_MIX	0x17</span>
<span class="cp">#define ADAU1373_LSPK_MIX	0x18</span>
<span class="cp">#define ADAU1373_RSPK_MIX	0x19</span>
<span class="cp">#define ADAU1373_LHP_MIX	0x1a</span>
<span class="cp">#define ADAU1373_RHP_MIX	0x1b</span>
<span class="cp">#define ADAU1373_EP_MIX		0x1c</span>
<span class="cp">#define ADAU1373_HP_CTRL	0x1d</span>
<span class="cp">#define ADAU1373_HP_CTRL2	0x1e</span>
<span class="cp">#define ADAU1373_LS_CTRL	0x1f</span>
<span class="cp">#define ADAU1373_EP_CTRL	0x21</span>
<span class="cp">#define ADAU1373_MICBIAS_CTRL1	0x22</span>
<span class="cp">#define ADAU1373_MICBIAS_CTRL2	0x23</span>
<span class="cp">#define ADAU1373_OUTPUT_CTRL	0x24</span>
<span class="cp">#define ADAU1373_PWDN_CTRL1	0x25</span>
<span class="cp">#define ADAU1373_PWDN_CTRL2	0x26</span>
<span class="cp">#define ADAU1373_PWDN_CTRL3	0x27</span>
<span class="cp">#define ADAU1373_DPLL_CTRL(x)	(0x28 + (x) * 7)</span>
<span class="cp">#define ADAU1373_PLL_CTRL1(x)	(0x29 + (x) * 7)</span>
<span class="cp">#define ADAU1373_PLL_CTRL2(x)	(0x2a + (x) * 7)</span>
<span class="cp">#define ADAU1373_PLL_CTRL3(x)	(0x2b + (x) * 7)</span>
<span class="cp">#define ADAU1373_PLL_CTRL4(x)	(0x2c + (x) * 7)</span>
<span class="cp">#define ADAU1373_PLL_CTRL5(x)	(0x2d + (x) * 7)</span>
<span class="cp">#define ADAU1373_PLL_CTRL6(x)	(0x2e + (x) * 7)</span>
<span class="cp">#define ADAU1373_PLL_CTRL7(x)	(0x2f + (x) * 7)</span>
<span class="cp">#define ADAU1373_HEADDECT	0x36</span>
<span class="cp">#define ADAU1373_ADC_DAC_STATUS	0x37</span>
<span class="cp">#define ADAU1373_ADC_CTRL	0x3c</span>
<span class="cp">#define ADAU1373_DAI(x)		(0x44 + (x))</span>
<span class="cp">#define ADAU1373_CLK_SRC_DIV(x)	(0x40 + (x) * 2)</span>
<span class="cp">#define ADAU1373_BCLKDIV(x)	(0x47 + (x))</span>
<span class="cp">#define ADAU1373_SRC_RATIOA(x)	(0x4a + (x) * 2)</span>
<span class="cp">#define ADAU1373_SRC_RATIOB(x)	(0x4b + (x) * 2)</span>
<span class="cp">#define ADAU1373_DEEMP_CTRL	0x50</span>
<span class="cp">#define ADAU1373_SRC_DAI_CTRL(x) (0x51 + (x))</span>
<span class="cp">#define ADAU1373_DIN_MIX_CTRL(x) (0x56 + (x))</span>
<span class="cp">#define ADAU1373_DOUT_MIX_CTRL(x) (0x5b + (x))</span>
<span class="cp">#define ADAU1373_DAI_PBL_VOL(x)	(0x62 + (x) * 2)</span>
<span class="cp">#define ADAU1373_DAI_PBR_VOL(x)	(0x63 + (x) * 2)</span>
<span class="cp">#define ADAU1373_DAI_RECL_VOL(x) (0x68 + (x) * 2)</span>
<span class="cp">#define ADAU1373_DAI_RECR_VOL(x) (0x69 + (x) * 2)</span>
<span class="cp">#define ADAU1373_DAC1_PBL_VOL	0x6e</span>
<span class="cp">#define ADAU1373_DAC1_PBR_VOL	0x6f</span>
<span class="cp">#define ADAU1373_DAC2_PBL_VOL	0x70</span>
<span class="cp">#define ADAU1373_DAC2_PBR_VOL	0x71</span>
<span class="cp">#define ADAU1373_ADC_RECL_VOL	0x72</span>
<span class="cp">#define ADAU1373_ADC_RECR_VOL	0x73</span>
<span class="cp">#define ADAU1373_DMIC_RECL_VOL	0x74</span>
<span class="cp">#define ADAU1373_DMIC_RECR_VOL	0x75</span>
<span class="cp">#define ADAU1373_VOL_GAIN1	0x76</span>
<span class="cp">#define ADAU1373_VOL_GAIN2	0x77</span>
<span class="cp">#define ADAU1373_VOL_GAIN3	0x78</span>
<span class="cp">#define ADAU1373_HPF_CTRL	0x7d</span>
<span class="cp">#define ADAU1373_BASS1		0x7e</span>
<span class="cp">#define ADAU1373_BASS2		0x7f</span>
<span class="cp">#define ADAU1373_DRC(x)		(0x80 + (x) * 0x10)</span>
<span class="cp">#define ADAU1373_3D_CTRL1	0xc0</span>
<span class="cp">#define ADAU1373_3D_CTRL2	0xc1</span>
<span class="cp">#define ADAU1373_FDSP_SEL1	0xdc</span>
<span class="cp">#define ADAU1373_FDSP_SEL2	0xdd</span>
<span class="cp">#define ADAU1373_FDSP_SEL3	0xde</span>
<span class="cp">#define ADAU1373_FDSP_SEL4	0xdf</span>
<span class="cp">#define ADAU1373_DIGMICCTRL	0xe2</span>
<span class="cp">#define ADAU1373_DIGEN		0xeb</span>
<span class="cp">#define ADAU1373_SOFT_RESET	0xff</span>


<span class="cp">#define ADAU1373_PLL_CTRL6_DPLL_BYPASS	BIT(1)</span>
<span class="cp">#define ADAU1373_PLL_CTRL6_PLL_EN	BIT(0)</span>

<span class="cp">#define ADAU1373_DAI_INVERT_BCLK	BIT(7)</span>
<span class="cp">#define ADAU1373_DAI_MASTER		BIT(6)</span>
<span class="cp">#define ADAU1373_DAI_INVERT_LRCLK	BIT(4)</span>
<span class="cp">#define ADAU1373_DAI_WLEN_16		0x0</span>
<span class="cp">#define ADAU1373_DAI_WLEN_20		0x4</span>
<span class="cp">#define ADAU1373_DAI_WLEN_24		0x8</span>
<span class="cp">#define ADAU1373_DAI_WLEN_32		0xc</span>
<span class="cp">#define ADAU1373_DAI_WLEN_MASK		0xc</span>
<span class="cp">#define ADAU1373_DAI_FORMAT_RIGHT_J	0x0</span>
<span class="cp">#define ADAU1373_DAI_FORMAT_LEFT_J	0x1</span>
<span class="cp">#define ADAU1373_DAI_FORMAT_I2S		0x2</span>
<span class="cp">#define ADAU1373_DAI_FORMAT_DSP		0x3</span>

<span class="cp">#define ADAU1373_BCLKDIV_SOURCE		BIT(5)</span>
<span class="cp">#define ADAU1373_BCLKDIV_32		0x03</span>
<span class="cp">#define ADAU1373_BCLKDIV_64		0x02</span>
<span class="cp">#define ADAU1373_BCLKDIV_128		0x01</span>
<span class="cp">#define ADAU1373_BCLKDIV_256		0x00</span>

<span class="cp">#define ADAU1373_ADC_CTRL_PEAK_DETECT	BIT(0)</span>
<span class="cp">#define ADAU1373_ADC_CTRL_RESET		BIT(1)</span>
<span class="cp">#define ADAU1373_ADC_CTRL_RESET_FORCE	BIT(2)</span>

<span class="cp">#define ADAU1373_OUTPUT_CTRL_LDIFF	BIT(3)</span>
<span class="cp">#define ADAU1373_OUTPUT_CTRL_LNFBEN	BIT(2)</span>

<span class="cp">#define ADAU1373_PWDN_CTRL3_PWR_EN BIT(0)</span>

<span class="cp">#define ADAU1373_EP_CTRL_MICBIAS1_OFFSET 4</span>
<span class="cp">#define ADAU1373_EP_CTRL_MICBIAS2_OFFSET 2</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">adau1373_default_regs</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 0x00 */</span>
	<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
	<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 0x10 */</span>
	<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
	<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 0x20 */</span>
	<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
	<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 0x30 */</span>
	<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
	<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 0x40 */</span>
	<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
	<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 0x50 */</span>
	<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
	<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 0x60 */</span>
	<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
	<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 0x70 */</span>
	<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
	<span class="mh">0x78</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 0x80 */</span>
	<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0x7a</span><span class="p">,</span> <span class="mh">0xdf</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
	<span class="mh">0x78</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 0x90 */</span>
	<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0x7a</span><span class="p">,</span> <span class="mh">0xdf</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
	<span class="mh">0x78</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 0xa0 */</span>
	<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0x7a</span><span class="p">,</span> <span class="mh">0xdf</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
	<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="cm">/* 0xb0 */</span>
	<span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
	<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 0xc0 */</span>
	<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
	<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 0xd0 */</span>
	<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
	<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="cm">/* 0xe0 */</span>
	<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">adau1373_out_tlv</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">TLV_DB_RANGE_HEAD</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
	<span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">TLV_DB_SCALE_ITEM</span><span class="p">(</span><span class="o">-</span><span class="mi">7900</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
	<span class="mi">8</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="n">TLV_DB_SCALE_ITEM</span><span class="p">(</span><span class="o">-</span><span class="mi">4700</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="mi">16</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="n">TLV_DB_SCALE_ITEM</span><span class="p">(</span><span class="o">-</span><span class="mi">2300</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="mi">24</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="n">TLV_DB_SCALE_ITEM</span><span class="p">(</span><span class="o">-</span><span class="mi">700</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">DECLARE_TLV_DB_MINMAX</span><span class="p">(</span><span class="n">adau1373_digital_tlv</span><span class="p">,</span> <span class="o">-</span><span class="mi">9563</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">DECLARE_TLV_DB_SCALE</span><span class="p">(</span><span class="n">adau1373_in_pga_tlv</span><span class="p">,</span> <span class="o">-</span><span class="mi">1300</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">DECLARE_TLV_DB_SCALE</span><span class="p">(</span><span class="n">adau1373_ep_tlv</span><span class="p">,</span> <span class="o">-</span><span class="mi">600</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">DECLARE_TLV_DB_SCALE</span><span class="p">(</span><span class="n">adau1373_input_boost_tlv</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">DECLARE_TLV_DB_SCALE</span><span class="p">(</span><span class="n">adau1373_gain_boost_tlv</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">DECLARE_TLV_DB_SCALE</span><span class="p">(</span><span class="n">adau1373_speaker_boost_tlv</span><span class="p">,</span> <span class="mi">1200</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">adau1373_fdsp_sel_text</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="s">&quot;None&quot;</span><span class="p">,</span>
	<span class="s">&quot;Channel 1&quot;</span><span class="p">,</span>
	<span class="s">&quot;Channel 2&quot;</span><span class="p">,</span>
	<span class="s">&quot;Channel 3&quot;</span><span class="p">,</span>
	<span class="s">&quot;Channel 4&quot;</span><span class="p">,</span>
	<span class="s">&quot;Channel 5&quot;</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">SOC_ENUM_SINGLE_DECL</span><span class="p">(</span><span class="n">adau1373_drc1_channel_enum</span><span class="p">,</span>
	<span class="n">ADAU1373_FDSP_SEL1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">adau1373_fdsp_sel_text</span><span class="p">);</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">SOC_ENUM_SINGLE_DECL</span><span class="p">(</span><span class="n">adau1373_drc2_channel_enum</span><span class="p">,</span>
	<span class="n">ADAU1373_FDSP_SEL1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_fdsp_sel_text</span><span class="p">);</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">SOC_ENUM_SINGLE_DECL</span><span class="p">(</span><span class="n">adau1373_drc3_channel_enum</span><span class="p">,</span>
	<span class="n">ADAU1373_FDSP_SEL2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_fdsp_sel_text</span><span class="p">);</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">SOC_ENUM_SINGLE_DECL</span><span class="p">(</span><span class="n">adau1373_hpf_channel_enum</span><span class="p">,</span>
	<span class="n">ADAU1373_FDSP_SEL3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_fdsp_sel_text</span><span class="p">);</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">SOC_ENUM_SINGLE_DECL</span><span class="p">(</span><span class="n">adau1373_bass_channel_enum</span><span class="p">,</span>
	<span class="n">ADAU1373_FDSP_SEL4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">adau1373_fdsp_sel_text</span><span class="p">);</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">adau1373_hpf_cutoff_text</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="s">&quot;3.7Hz&quot;</span><span class="p">,</span> <span class="s">&quot;50Hz&quot;</span><span class="p">,</span> <span class="s">&quot;100Hz&quot;</span><span class="p">,</span> <span class="s">&quot;150Hz&quot;</span><span class="p">,</span> <span class="s">&quot;200Hz&quot;</span><span class="p">,</span> <span class="s">&quot;250Hz&quot;</span><span class="p">,</span> <span class="s">&quot;300Hz&quot;</span><span class="p">,</span> <span class="s">&quot;350Hz&quot;</span><span class="p">,</span>
	<span class="s">&quot;400Hz&quot;</span><span class="p">,</span> <span class="s">&quot;450Hz&quot;</span><span class="p">,</span> <span class="s">&quot;500Hz&quot;</span><span class="p">,</span> <span class="s">&quot;550Hz&quot;</span><span class="p">,</span> <span class="s">&quot;600Hz&quot;</span><span class="p">,</span> <span class="s">&quot;650Hz&quot;</span><span class="p">,</span> <span class="s">&quot;700Hz&quot;</span><span class="p">,</span> <span class="s">&quot;750Hz&quot;</span><span class="p">,</span>
	<span class="s">&quot;800Hz&quot;</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">SOC_ENUM_SINGLE_DECL</span><span class="p">(</span><span class="n">adau1373_hpf_cutoff_enum</span><span class="p">,</span>
	<span class="n">ADAU1373_HPF_CTRL</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">adau1373_hpf_cutoff_text</span><span class="p">);</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">adau1373_bass_lpf_cutoff_text</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="s">&quot;801Hz&quot;</span><span class="p">,</span> <span class="s">&quot;1001Hz&quot;</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">adau1373_bass_clip_level_text</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="s">&quot;0.125&quot;</span><span class="p">,</span> <span class="s">&quot;0.250&quot;</span><span class="p">,</span> <span class="s">&quot;0.370&quot;</span><span class="p">,</span> <span class="s">&quot;0.500&quot;</span><span class="p">,</span> <span class="s">&quot;0.625&quot;</span><span class="p">,</span> <span class="s">&quot;0.750&quot;</span><span class="p">,</span> <span class="s">&quot;0.875&quot;</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">adau1373_bass_clip_level_values</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">adau1373_bass_hpf_cutoff_text</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="s">&quot;158Hz&quot;</span><span class="p">,</span> <span class="s">&quot;232Hz&quot;</span><span class="p">,</span> <span class="s">&quot;347Hz&quot;</span><span class="p">,</span> <span class="s">&quot;520Hz&quot;</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">adau1373_bass_tlv</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">TLV_DB_RANGE_HEAD</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
	<span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">TLV_DB_SCALE_ITEM</span><span class="p">(</span><span class="o">-</span><span class="mi">600</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
	<span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">TLV_DB_SCALE_ITEM</span><span class="p">(</span><span class="mi">950</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">TLV_DB_SCALE_ITEM</span><span class="p">(</span><span class="mi">1400</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">SOC_ENUM_SINGLE_DECL</span><span class="p">(</span><span class="n">adau1373_bass_lpf_cutoff_enum</span><span class="p">,</span>
	<span class="n">ADAU1373_BASS1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">adau1373_bass_lpf_cutoff_text</span><span class="p">);</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">SOC_VALUE_ENUM_SINGLE_DECL</span><span class="p">(</span><span class="n">adau1373_bass_clip_level_enum</span><span class="p">,</span>
	<span class="n">ADAU1373_BASS1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">adau1373_bass_clip_level_text</span><span class="p">,</span>
	<span class="n">adau1373_bass_clip_level_values</span><span class="p">);</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">SOC_ENUM_SINGLE_DECL</span><span class="p">(</span><span class="n">adau1373_bass_hpf_cutoff_enum</span><span class="p">,</span>
	<span class="n">ADAU1373_BASS1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_bass_hpf_cutoff_text</span><span class="p">);</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">adau1373_3d_level_text</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="s">&quot;0%&quot;</span><span class="p">,</span> <span class="s">&quot;6.67%&quot;</span><span class="p">,</span> <span class="s">&quot;13.33%&quot;</span><span class="p">,</span> <span class="s">&quot;20%&quot;</span><span class="p">,</span> <span class="s">&quot;26.67%&quot;</span><span class="p">,</span> <span class="s">&quot;33.33%&quot;</span><span class="p">,</span>
	<span class="s">&quot;40%&quot;</span><span class="p">,</span> <span class="s">&quot;46.67%&quot;</span><span class="p">,</span> <span class="s">&quot;53.33%&quot;</span><span class="p">,</span> <span class="s">&quot;60%&quot;</span><span class="p">,</span> <span class="s">&quot;66.67%&quot;</span><span class="p">,</span> <span class="s">&quot;73.33%&quot;</span><span class="p">,</span>
	<span class="s">&quot;80%&quot;</span><span class="p">,</span> <span class="s">&quot;86.67&quot;</span><span class="p">,</span> <span class="s">&quot;99.33%&quot;</span><span class="p">,</span> <span class="s">&quot;100%&quot;</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">adau1373_3d_cutoff_text</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="s">&quot;No 3D&quot;</span><span class="p">,</span> <span class="s">&quot;0.03125 fs&quot;</span><span class="p">,</span> <span class="s">&quot;0.04583 fs&quot;</span><span class="p">,</span> <span class="s">&quot;0.075 fs&quot;</span><span class="p">,</span> <span class="s">&quot;0.11458 fs&quot;</span><span class="p">,</span>
	<span class="s">&quot;0.16875 fs&quot;</span><span class="p">,</span> <span class="s">&quot;0.27083 fs&quot;</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">SOC_ENUM_SINGLE_DECL</span><span class="p">(</span><span class="n">adau1373_3d_level_enum</span><span class="p">,</span>
	<span class="n">ADAU1373_3D_CTRL1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">adau1373_3d_level_text</span><span class="p">);</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">SOC_ENUM_SINGLE_DECL</span><span class="p">(</span><span class="n">adau1373_3d_cutoff_enum</span><span class="p">,</span>
	<span class="n">ADAU1373_3D_CTRL1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_3d_cutoff_text</span><span class="p">);</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">adau1373_3d_tlv</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">TLV_DB_RANGE_HEAD</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
	<span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">TLV_DB_SCALE_ITEM</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">TLV_DB_LINEAR_ITEM</span><span class="p">(</span><span class="o">-</span><span class="mi">1800</span><span class="p">,</span> <span class="o">-</span><span class="mi">120</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">adau1373_lr_mux_text</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="s">&quot;Mute&quot;</span><span class="p">,</span>
	<span class="s">&quot;Right Channel (L+R)&quot;</span><span class="p">,</span>
	<span class="s">&quot;Left Channel (L+R)&quot;</span><span class="p">,</span>
	<span class="s">&quot;Stereo&quot;</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">SOC_ENUM_SINGLE_DECL</span><span class="p">(</span><span class="n">adau1373_lineout1_lr_mux_enum</span><span class="p">,</span>
	<span class="n">ADAU1373_OUTPUT_CTRL</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">adau1373_lr_mux_text</span><span class="p">);</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">SOC_ENUM_SINGLE_DECL</span><span class="p">(</span><span class="n">adau1373_lineout2_lr_mux_enum</span><span class="p">,</span>
	<span class="n">ADAU1373_OUTPUT_CTRL</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">adau1373_lr_mux_text</span><span class="p">);</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">SOC_ENUM_SINGLE_DECL</span><span class="p">(</span><span class="n">adau1373_speaker_lr_mux_enum</span><span class="p">,</span>
	<span class="n">ADAU1373_LS_CTRL</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">adau1373_lr_mux_text</span><span class="p">);</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">adau1373_controls</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">SOC_DOUBLE_R_TLV</span><span class="p">(</span><span class="s">&quot;AIF1 Capture Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_DAI_RECL_VOL</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
		<span class="n">ADAU1373_DAI_RECR_VOL</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">adau1373_digital_tlv</span><span class="p">),</span>
	<span class="n">SOC_DOUBLE_R_TLV</span><span class="p">(</span><span class="s">&quot;AIF2 Capture Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_DAI_RECL_VOL</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
		<span class="n">ADAU1373_DAI_RECR_VOL</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">adau1373_digital_tlv</span><span class="p">),</span>
	<span class="n">SOC_DOUBLE_R_TLV</span><span class="p">(</span><span class="s">&quot;AIF3 Capture Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_DAI_RECL_VOL</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
		<span class="n">ADAU1373_DAI_RECR_VOL</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">adau1373_digital_tlv</span><span class="p">),</span>

	<span class="n">SOC_DOUBLE_R_TLV</span><span class="p">(</span><span class="s">&quot;ADC Capture Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_ADC_RECL_VOL</span><span class="p">,</span>
		<span class="n">ADAU1373_ADC_RECR_VOL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">adau1373_digital_tlv</span><span class="p">),</span>
	<span class="n">SOC_DOUBLE_R_TLV</span><span class="p">(</span><span class="s">&quot;DMIC Capture Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_DMIC_RECL_VOL</span><span class="p">,</span>
		<span class="n">ADAU1373_DMIC_RECR_VOL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">adau1373_digital_tlv</span><span class="p">),</span>

	<span class="n">SOC_DOUBLE_R_TLV</span><span class="p">(</span><span class="s">&quot;AIF1 Playback Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_DAI_PBL_VOL</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
		<span class="n">ADAU1373_DAI_PBR_VOL</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">adau1373_digital_tlv</span><span class="p">),</span>
	<span class="n">SOC_DOUBLE_R_TLV</span><span class="p">(</span><span class="s">&quot;AIF2 Playback Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_DAI_PBL_VOL</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
		<span class="n">ADAU1373_DAI_PBR_VOL</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">adau1373_digital_tlv</span><span class="p">),</span>
	<span class="n">SOC_DOUBLE_R_TLV</span><span class="p">(</span><span class="s">&quot;AIF3 Playback Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_DAI_PBL_VOL</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
		<span class="n">ADAU1373_DAI_PBR_VOL</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">adau1373_digital_tlv</span><span class="p">),</span>

	<span class="n">SOC_DOUBLE_R_TLV</span><span class="p">(</span><span class="s">&quot;DAC1 Playback Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_DAC1_PBL_VOL</span><span class="p">,</span>
		<span class="n">ADAU1373_DAC1_PBR_VOL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">adau1373_digital_tlv</span><span class="p">),</span>
	<span class="n">SOC_DOUBLE_R_TLV</span><span class="p">(</span><span class="s">&quot;DAC2 Playback Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_DAC2_PBL_VOL</span><span class="p">,</span>
		<span class="n">ADAU1373_DAC2_PBR_VOL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">adau1373_digital_tlv</span><span class="p">),</span>

	<span class="n">SOC_DOUBLE_R_TLV</span><span class="p">(</span><span class="s">&quot;Lineout1 Playback Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_LLINE_OUT</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
		<span class="n">ADAU1373_RLINE_OUT</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_out_tlv</span><span class="p">),</span>
	<span class="n">SOC_DOUBLE_R_TLV</span><span class="p">(</span><span class="s">&quot;Speaker Playback Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_LSPK_OUT</span><span class="p">,</span>
		<span class="n">ADAU1373_RSPK_OUT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_out_tlv</span><span class="p">),</span>
	<span class="n">SOC_DOUBLE_R_TLV</span><span class="p">(</span><span class="s">&quot;Headphone Playback Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_LHP_OUT</span><span class="p">,</span>
		<span class="n">ADAU1373_RHP_OUT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_out_tlv</span><span class="p">),</span>

	<span class="n">SOC_DOUBLE_R_TLV</span><span class="p">(</span><span class="s">&quot;Input 1 Capture Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_AINL_CTRL</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
		<span class="n">ADAU1373_AINR_CTRL</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_in_pga_tlv</span><span class="p">),</span>
	<span class="n">SOC_DOUBLE_R_TLV</span><span class="p">(</span><span class="s">&quot;Input 2 Capture Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_AINL_CTRL</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
		<span class="n">ADAU1373_AINR_CTRL</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_in_pga_tlv</span><span class="p">),</span>
	<span class="n">SOC_DOUBLE_R_TLV</span><span class="p">(</span><span class="s">&quot;Input 3 Capture Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_AINL_CTRL</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
		<span class="n">ADAU1373_AINR_CTRL</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_in_pga_tlv</span><span class="p">),</span>
	<span class="n">SOC_DOUBLE_R_TLV</span><span class="p">(</span><span class="s">&quot;Input 4 Capture Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_AINL_CTRL</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
		<span class="n">ADAU1373_AINR_CTRL</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_in_pga_tlv</span><span class="p">),</span>

	<span class="n">SOC_SINGLE_TLV</span><span class="p">(</span><span class="s">&quot;Earpiece Playback Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_EP_CTRL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
		<span class="n">adau1373_ep_tlv</span><span class="p">),</span>

	<span class="n">SOC_DOUBLE_TLV</span><span class="p">(</span><span class="s">&quot;AIF3 Boost Playback Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_VOL_GAIN1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span>
		<span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_gain_boost_tlv</span><span class="p">),</span>
	<span class="n">SOC_DOUBLE_TLV</span><span class="p">(</span><span class="s">&quot;AIF2 Boost Playback Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_VOL_GAIN1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
		<span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_gain_boost_tlv</span><span class="p">),</span>
	<span class="n">SOC_DOUBLE_TLV</span><span class="p">(</span><span class="s">&quot;AIF1 Boost Playback Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_VOL_GAIN1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
		<span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_gain_boost_tlv</span><span class="p">),</span>
	<span class="n">SOC_DOUBLE_TLV</span><span class="p">(</span><span class="s">&quot;AIF3 Boost Capture Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_VOL_GAIN2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span>
		<span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_gain_boost_tlv</span><span class="p">),</span>
	<span class="n">SOC_DOUBLE_TLV</span><span class="p">(</span><span class="s">&quot;AIF2 Boost Capture Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_VOL_GAIN2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
		<span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_gain_boost_tlv</span><span class="p">),</span>
	<span class="n">SOC_DOUBLE_TLV</span><span class="p">(</span><span class="s">&quot;AIF1 Boost Capture Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_VOL_GAIN2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
		<span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_gain_boost_tlv</span><span class="p">),</span>
	<span class="n">SOC_DOUBLE_TLV</span><span class="p">(</span><span class="s">&quot;DMIC Boost Capture Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_VOL_GAIN3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span>
		<span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_gain_boost_tlv</span><span class="p">),</span>
	<span class="n">SOC_DOUBLE_TLV</span><span class="p">(</span><span class="s">&quot;ADC Boost Capture Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_VOL_GAIN3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span>
		<span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_gain_boost_tlv</span><span class="p">),</span>
	<span class="n">SOC_DOUBLE_TLV</span><span class="p">(</span><span class="s">&quot;DAC2 Boost Playback Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_VOL_GAIN3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
		<span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_gain_boost_tlv</span><span class="p">),</span>
	<span class="n">SOC_DOUBLE_TLV</span><span class="p">(</span><span class="s">&quot;DAC1 Boost Playback Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_VOL_GAIN3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
		<span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_gain_boost_tlv</span><span class="p">),</span>

	<span class="n">SOC_DOUBLE_TLV</span><span class="p">(</span><span class="s">&quot;Input 1 Boost Capture Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_ADC_GAIN</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>
		<span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_input_boost_tlv</span><span class="p">),</span>
	<span class="n">SOC_DOUBLE_TLV</span><span class="p">(</span><span class="s">&quot;Input 2 Boost Capture Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_ADC_GAIN</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span>
		<span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_input_boost_tlv</span><span class="p">),</span>
	<span class="n">SOC_DOUBLE_TLV</span><span class="p">(</span><span class="s">&quot;Input 3 Boost Capture Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_ADC_GAIN</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>
		<span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_input_boost_tlv</span><span class="p">),</span>
	<span class="n">SOC_DOUBLE_TLV</span><span class="p">(</span><span class="s">&quot;Input 4 Boost Capture Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_ADC_GAIN</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span>
		<span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_input_boost_tlv</span><span class="p">),</span>

	<span class="n">SOC_DOUBLE_TLV</span><span class="p">(</span><span class="s">&quot;Speaker Boost Playback Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_LS_CTRL</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
		<span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_speaker_boost_tlv</span><span class="p">),</span>

	<span class="n">SOC_ENUM</span><span class="p">(</span><span class="s">&quot;Lineout1 LR Mux&quot;</span><span class="p">,</span> <span class="n">adau1373_lineout1_lr_mux_enum</span><span class="p">),</span>
	<span class="n">SOC_ENUM</span><span class="p">(</span><span class="s">&quot;Speaker LR Mux&quot;</span><span class="p">,</span> <span class="n">adau1373_speaker_lr_mux_enum</span><span class="p">),</span>

	<span class="n">SOC_ENUM</span><span class="p">(</span><span class="s">&quot;HPF Cutoff&quot;</span><span class="p">,</span> <span class="n">adau1373_hpf_cutoff_enum</span><span class="p">),</span>
	<span class="n">SOC_DOUBLE</span><span class="p">(</span><span class="s">&quot;HPF Switch&quot;</span><span class="p">,</span> <span class="n">ADAU1373_HPF_CTRL</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SOC_ENUM</span><span class="p">(</span><span class="s">&quot;HPF Channel&quot;</span><span class="p">,</span> <span class="n">adau1373_hpf_channel_enum</span><span class="p">),</span>

	<span class="n">SOC_ENUM</span><span class="p">(</span><span class="s">&quot;Bass HPF Cutoff&quot;</span><span class="p">,</span> <span class="n">adau1373_bass_hpf_cutoff_enum</span><span class="p">),</span>
	<span class="n">SOC_VALUE_ENUM</span><span class="p">(</span><span class="s">&quot;Bass Clip Level Threshold&quot;</span><span class="p">,</span>
	    <span class="n">adau1373_bass_clip_level_enum</span><span class="p">),</span>
	<span class="n">SOC_ENUM</span><span class="p">(</span><span class="s">&quot;Bass LPF Cutoff&quot;</span><span class="p">,</span> <span class="n">adau1373_bass_lpf_cutoff_enum</span><span class="p">),</span>
	<span class="n">SOC_DOUBLE</span><span class="p">(</span><span class="s">&quot;Bass Playback Switch&quot;</span><span class="p">,</span> <span class="n">ADAU1373_BASS2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SOC_SINGLE_TLV</span><span class="p">(</span><span class="s">&quot;Bass Playback Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_BASS2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
	    <span class="n">adau1373_bass_tlv</span><span class="p">),</span>
	<span class="n">SOC_ENUM</span><span class="p">(</span><span class="s">&quot;Bass Channel&quot;</span><span class="p">,</span> <span class="n">adau1373_bass_channel_enum</span><span class="p">),</span>

	<span class="n">SOC_ENUM</span><span class="p">(</span><span class="s">&quot;3D Freq&quot;</span><span class="p">,</span> <span class="n">adau1373_3d_cutoff_enum</span><span class="p">),</span>
	<span class="n">SOC_ENUM</span><span class="p">(</span><span class="s">&quot;3D Level&quot;</span><span class="p">,</span> <span class="n">adau1373_3d_level_enum</span><span class="p">),</span>
	<span class="n">SOC_SINGLE</span><span class="p">(</span><span class="s">&quot;3D Playback Switch&quot;</span><span class="p">,</span> <span class="n">ADAU1373_3D_CTRL2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SOC_SINGLE_TLV</span><span class="p">(</span><span class="s">&quot;3D Playback Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_3D_CTRL2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
		<span class="n">adau1373_3d_tlv</span><span class="p">),</span>
	<span class="n">SOC_ENUM</span><span class="p">(</span><span class="s">&quot;3D Channel&quot;</span><span class="p">,</span> <span class="n">adau1373_bass_channel_enum</span><span class="p">),</span>

	<span class="n">SOC_SINGLE</span><span class="p">(</span><span class="s">&quot;Zero Cross Switch&quot;</span><span class="p">,</span> <span class="n">ADAU1373_PWDN_CTRL3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">adau1373_lineout2_controls</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">SOC_DOUBLE_R_TLV</span><span class="p">(</span><span class="s">&quot;Lineout2 Playback Volume&quot;</span><span class="p">,</span> <span class="n">ADAU1373_LLINE_OUT</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
		<span class="n">ADAU1373_RLINE_OUT</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_out_tlv</span><span class="p">),</span>
	<span class="n">SOC_ENUM</span><span class="p">(</span><span class="s">&quot;Lineout2 LR Mux&quot;</span><span class="p">,</span> <span class="n">adau1373_lineout2_lr_mux_enum</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">adau1373_drc_controls</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">SOC_ENUM</span><span class="p">(</span><span class="s">&quot;DRC1 Channel&quot;</span><span class="p">,</span> <span class="n">adau1373_drc1_channel_enum</span><span class="p">),</span>
	<span class="n">SOC_ENUM</span><span class="p">(</span><span class="s">&quot;DRC2 Channel&quot;</span><span class="p">,</span> <span class="n">adau1373_drc2_channel_enum</span><span class="p">),</span>
	<span class="n">SOC_ENUM</span><span class="p">(</span><span class="s">&quot;DRC3 Channel&quot;</span><span class="p">,</span> <span class="n">adau1373_drc3_channel_enum</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">adau1373_pll_event</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_dapm_widget</span> <span class="o">*</span><span class="n">w</span><span class="p">,</span>
	<span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span> <span class="kt">int</span> <span class="n">event</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">w</span><span class="o">-&gt;</span><span class="n">codec</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">pll_id</span> <span class="o">=</span> <span class="n">w</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="sc">&#39;1&#39;</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">val</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">SND_SOC_DAPM_EVENT_ON</span><span class="p">(</span><span class="n">event</span><span class="p">))</span>
		<span class="n">val</span> <span class="o">=</span> <span class="n">ADAU1373_PLL_CTRL6_PLL_EN</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="n">val</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">ADAU1373_PLL_CTRL6</span><span class="p">(</span><span class="n">pll_id</span><span class="p">),</span>
		<span class="n">ADAU1373_PLL_CTRL6_PLL_EN</span><span class="p">,</span> <span class="n">val</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">SND_SOC_DAPM_EVENT_ON</span><span class="p">(</span><span class="n">event</span><span class="p">))</span>
		<span class="n">mdelay</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">adau1373_decimator_text</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="s">&quot;ADC&quot;</span><span class="p">,</span>
	<span class="s">&quot;DMIC1&quot;</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">soc_enum</span> <span class="n">adau1373_decimator_enum</span> <span class="o">=</span>
	<span class="n">SOC_ENUM_SINGLE</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">adau1373_decimator_text</span><span class="p">);</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">adau1373_decimator_mux</span> <span class="o">=</span>
	<span class="n">SOC_DAPM_ENUM_VIRT</span><span class="p">(</span><span class="s">&quot;Decimator Mux&quot;</span><span class="p">,</span> <span class="n">adau1373_decimator_enum</span><span class="p">);</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">adau1373_left_adc_mixer_controls</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;DAC1 Switch&quot;</span><span class="p">,</span> <span class="n">ADAU1373_LADC_MIXER</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Input 4 Switch&quot;</span><span class="p">,</span> <span class="n">ADAU1373_LADC_MIXER</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Input 3 Switch&quot;</span><span class="p">,</span> <span class="n">ADAU1373_LADC_MIXER</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Input 2 Switch&quot;</span><span class="p">,</span> <span class="n">ADAU1373_LADC_MIXER</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Input 1 Switch&quot;</span><span class="p">,</span> <span class="n">ADAU1373_LADC_MIXER</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">adau1373_right_adc_mixer_controls</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;DAC1 Switch&quot;</span><span class="p">,</span> <span class="n">ADAU1373_RADC_MIXER</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Input 4 Switch&quot;</span><span class="p">,</span> <span class="n">ADAU1373_RADC_MIXER</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Input 3 Switch&quot;</span><span class="p">,</span> <span class="n">ADAU1373_RADC_MIXER</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Input 2 Switch&quot;</span><span class="p">,</span> <span class="n">ADAU1373_RADC_MIXER</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Input 1 Switch&quot;</span><span class="p">,</span> <span class="n">ADAU1373_RADC_MIXER</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="p">};</span>

<span class="cp">#define DECLARE_ADAU1373_OUTPUT_MIXER_CTRLS(_name, _reg) \</span>
<span class="cp">const struct snd_kcontrol_new _name[] = { \</span>
<span class="cp">	SOC_DAPM_SINGLE(&quot;Left DAC2 Switch&quot;, _reg, 7, 1, 0), \</span>
<span class="cp">	SOC_DAPM_SINGLE(&quot;Right DAC2 Switch&quot;, _reg, 6, 1, 0), \</span>
<span class="cp">	SOC_DAPM_SINGLE(&quot;Left DAC1 Switch&quot;, _reg, 5, 1, 0), \</span>
<span class="cp">	SOC_DAPM_SINGLE(&quot;Right DAC1 Switch&quot;, _reg, 4, 1, 0), \</span>
<span class="cp">	SOC_DAPM_SINGLE(&quot;Input 4 Bypass Switch&quot;, _reg, 3, 1, 0), \</span>
<span class="cp">	SOC_DAPM_SINGLE(&quot;Input 3 Bypass Switch&quot;, _reg, 2, 1, 0), \</span>
<span class="cp">	SOC_DAPM_SINGLE(&quot;Input 2 Bypass Switch&quot;, _reg, 1, 1, 0), \</span>
<span class="cp">	SOC_DAPM_SINGLE(&quot;Input 1 Bypass Switch&quot;, _reg, 0, 1, 0), \</span>
<span class="cp">}</span>

<span class="k">static</span> <span class="n">DECLARE_ADAU1373_OUTPUT_MIXER_CTRLS</span><span class="p">(</span><span class="n">adau1373_left_line1_mixer_controls</span><span class="p">,</span>
	<span class="n">ADAU1373_LLINE1_MIX</span><span class="p">);</span>
<span class="k">static</span> <span class="n">DECLARE_ADAU1373_OUTPUT_MIXER_CTRLS</span><span class="p">(</span><span class="n">adau1373_right_line1_mixer_controls</span><span class="p">,</span>
	<span class="n">ADAU1373_RLINE1_MIX</span><span class="p">);</span>
<span class="k">static</span> <span class="n">DECLARE_ADAU1373_OUTPUT_MIXER_CTRLS</span><span class="p">(</span><span class="n">adau1373_left_line2_mixer_controls</span><span class="p">,</span>
	<span class="n">ADAU1373_LLINE2_MIX</span><span class="p">);</span>
<span class="k">static</span> <span class="n">DECLARE_ADAU1373_OUTPUT_MIXER_CTRLS</span><span class="p">(</span><span class="n">adau1373_right_line2_mixer_controls</span><span class="p">,</span>
	<span class="n">ADAU1373_RLINE2_MIX</span><span class="p">);</span>
<span class="k">static</span> <span class="n">DECLARE_ADAU1373_OUTPUT_MIXER_CTRLS</span><span class="p">(</span><span class="n">adau1373_left_spk_mixer_controls</span><span class="p">,</span>
	<span class="n">ADAU1373_LSPK_MIX</span><span class="p">);</span>
<span class="k">static</span> <span class="n">DECLARE_ADAU1373_OUTPUT_MIXER_CTRLS</span><span class="p">(</span><span class="n">adau1373_right_spk_mixer_controls</span><span class="p">,</span>
	<span class="n">ADAU1373_RSPK_MIX</span><span class="p">);</span>
<span class="k">static</span> <span class="n">DECLARE_ADAU1373_OUTPUT_MIXER_CTRLS</span><span class="p">(</span><span class="n">adau1373_ep_mixer_controls</span><span class="p">,</span>
	<span class="n">ADAU1373_EP_MIX</span><span class="p">);</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">adau1373_left_hp_mixer_controls</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Left DAC1 Switch&quot;</span><span class="p">,</span> <span class="n">ADAU1373_LHP_MIX</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Left DAC2 Switch&quot;</span><span class="p">,</span> <span class="n">ADAU1373_LHP_MIX</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Input 4 Bypass Switch&quot;</span><span class="p">,</span> <span class="n">ADAU1373_LHP_MIX</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Input 3 Bypass Switch&quot;</span><span class="p">,</span> <span class="n">ADAU1373_LHP_MIX</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Input 2 Bypass Switch&quot;</span><span class="p">,</span> <span class="n">ADAU1373_LHP_MIX</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Input 1 Bypass Switch&quot;</span><span class="p">,</span> <span class="n">ADAU1373_LHP_MIX</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">adau1373_right_hp_mixer_controls</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Right DAC1 Switch&quot;</span><span class="p">,</span> <span class="n">ADAU1373_RHP_MIX</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Right DAC2 Switch&quot;</span><span class="p">,</span> <span class="n">ADAU1373_RHP_MIX</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Input 4 Bypass Switch&quot;</span><span class="p">,</span> <span class="n">ADAU1373_RHP_MIX</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Input 3 Bypass Switch&quot;</span><span class="p">,</span> <span class="n">ADAU1373_RHP_MIX</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Input 2 Bypass Switch&quot;</span><span class="p">,</span> <span class="n">ADAU1373_RHP_MIX</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SOC_DAPM_SINGLE</span><span class="p">(</span><span class="s">&quot;Input 1 Bypass Switch&quot;</span><span class="p">,</span> <span class="n">ADAU1373_RHP_MIX</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="p">};</span>

<span class="cp">#define DECLARE_ADAU1373_DSP_CHANNEL_MIXER_CTRLS(_name, _reg) \</span>
<span class="cp">const struct snd_kcontrol_new _name[] = { \</span>
<span class="cp">	SOC_DAPM_SINGLE(&quot;DMIC2 Swapped Switch&quot;, _reg, 6, 1, 0), \</span>
<span class="cp">	SOC_DAPM_SINGLE(&quot;DMIC2 Switch&quot;, _reg, 5, 1, 0), \</span>
<span class="cp">	SOC_DAPM_SINGLE(&quot;ADC/DMIC1 Swapped Switch&quot;, _reg, 4, 1, 0), \</span>
<span class="cp">	SOC_DAPM_SINGLE(&quot;ADC/DMIC1 Switch&quot;, _reg, 3, 1, 0), \</span>
<span class="cp">	SOC_DAPM_SINGLE(&quot;AIF3 Switch&quot;, _reg, 2, 1, 0), \</span>
<span class="cp">	SOC_DAPM_SINGLE(&quot;AIF2 Switch&quot;, _reg, 1, 1, 0), \</span>
<span class="cp">	SOC_DAPM_SINGLE(&quot;AIF1 Switch&quot;, _reg, 0, 1, 0), \</span>
<span class="cp">}</span>

<span class="k">static</span> <span class="n">DECLARE_ADAU1373_DSP_CHANNEL_MIXER_CTRLS</span><span class="p">(</span><span class="n">adau1373_dsp_channel1_mixer_controls</span><span class="p">,</span>
	<span class="n">ADAU1373_DIN_MIX_CTRL</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
<span class="k">static</span> <span class="n">DECLARE_ADAU1373_DSP_CHANNEL_MIXER_CTRLS</span><span class="p">(</span><span class="n">adau1373_dsp_channel2_mixer_controls</span><span class="p">,</span>
	<span class="n">ADAU1373_DIN_MIX_CTRL</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
<span class="k">static</span> <span class="n">DECLARE_ADAU1373_DSP_CHANNEL_MIXER_CTRLS</span><span class="p">(</span><span class="n">adau1373_dsp_channel3_mixer_controls</span><span class="p">,</span>
	<span class="n">ADAU1373_DIN_MIX_CTRL</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>
<span class="k">static</span> <span class="n">DECLARE_ADAU1373_DSP_CHANNEL_MIXER_CTRLS</span><span class="p">(</span><span class="n">adau1373_dsp_channel4_mixer_controls</span><span class="p">,</span>
	<span class="n">ADAU1373_DIN_MIX_CTRL</span><span class="p">(</span><span class="mi">3</span><span class="p">));</span>
<span class="k">static</span> <span class="n">DECLARE_ADAU1373_DSP_CHANNEL_MIXER_CTRLS</span><span class="p">(</span><span class="n">adau1373_dsp_channel5_mixer_controls</span><span class="p">,</span>
	<span class="n">ADAU1373_DIN_MIX_CTRL</span><span class="p">(</span><span class="mi">4</span><span class="p">));</span>

<span class="cp">#define DECLARE_ADAU1373_DSP_OUTPUT_MIXER_CTRLS(_name, _reg) \</span>
<span class="cp">const struct snd_kcontrol_new _name[] = { \</span>
<span class="cp">	SOC_DAPM_SINGLE(&quot;DSP Channel5 Switch&quot;, _reg, 4, 1, 0), \</span>
<span class="cp">	SOC_DAPM_SINGLE(&quot;DSP Channel4 Switch&quot;, _reg, 3, 1, 0), \</span>
<span class="cp">	SOC_DAPM_SINGLE(&quot;DSP Channel3 Switch&quot;, _reg, 2, 1, 0), \</span>
<span class="cp">	SOC_DAPM_SINGLE(&quot;DSP Channel2 Switch&quot;, _reg, 1, 1, 0), \</span>
<span class="cp">	SOC_DAPM_SINGLE(&quot;DSP Channel1 Switch&quot;, _reg, 0, 1, 0), \</span>
<span class="cp">}</span>

<span class="k">static</span> <span class="n">DECLARE_ADAU1373_DSP_OUTPUT_MIXER_CTRLS</span><span class="p">(</span><span class="n">adau1373_aif1_mixer_controls</span><span class="p">,</span>
	<span class="n">ADAU1373_DOUT_MIX_CTRL</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
<span class="k">static</span> <span class="n">DECLARE_ADAU1373_DSP_OUTPUT_MIXER_CTRLS</span><span class="p">(</span><span class="n">adau1373_aif2_mixer_controls</span><span class="p">,</span>
	<span class="n">ADAU1373_DOUT_MIX_CTRL</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
<span class="k">static</span> <span class="n">DECLARE_ADAU1373_DSP_OUTPUT_MIXER_CTRLS</span><span class="p">(</span><span class="n">adau1373_aif3_mixer_controls</span><span class="p">,</span>
	<span class="n">ADAU1373_DOUT_MIX_CTRL</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>
<span class="k">static</span> <span class="n">DECLARE_ADAU1373_DSP_OUTPUT_MIXER_CTRLS</span><span class="p">(</span><span class="n">adau1373_dac1_mixer_controls</span><span class="p">,</span>
	<span class="n">ADAU1373_DOUT_MIX_CTRL</span><span class="p">(</span><span class="mi">3</span><span class="p">));</span>
<span class="k">static</span> <span class="n">DECLARE_ADAU1373_DSP_OUTPUT_MIXER_CTRLS</span><span class="p">(</span><span class="n">adau1373_dac2_mixer_controls</span><span class="p">,</span>
	<span class="n">ADAU1373_DOUT_MIX_CTRL</span><span class="p">(</span><span class="mi">4</span><span class="p">));</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_soc_dapm_widget</span> <span class="n">adau1373_dapm_widgets</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* Datasheet claims Left ADC is bit 6 and Right ADC is bit 7, but that</span>
<span class="cm">	 * doesn&#39;t seem to be the case. */</span>
	<span class="n">SND_SOC_DAPM_ADC</span><span class="p">(</span><span class="s">&quot;Left ADC&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">ADAU1373_PWDN_CTRL1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_ADC</span><span class="p">(</span><span class="s">&quot;Right ADC&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">ADAU1373_PWDN_CTRL1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

	<span class="n">SND_SOC_DAPM_ADC</span><span class="p">(</span><span class="s">&quot;DMIC1&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">ADAU1373_DIGMICCTRL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_ADC</span><span class="p">(</span><span class="s">&quot;DMIC2&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">ADAU1373_DIGMICCTRL</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

	<span class="n">SND_SOC_DAPM_VIRT_MUX</span><span class="p">(</span><span class="s">&quot;Decimator Mux&quot;</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
		<span class="o">&amp;</span><span class="n">adau1373_decimator_mux</span><span class="p">),</span>

	<span class="n">SND_SOC_DAPM_SUPPLY</span><span class="p">(</span><span class="s">&quot;MICBIAS2&quot;</span><span class="p">,</span> <span class="n">ADAU1373_PWDN_CTRL1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_SUPPLY</span><span class="p">(</span><span class="s">&quot;MICBIAS1&quot;</span><span class="p">,</span> <span class="n">ADAU1373_PWDN_CTRL1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

	<span class="n">SND_SOC_DAPM_PGA</span><span class="p">(</span><span class="s">&quot;IN4PGA&quot;</span><span class="p">,</span> <span class="n">ADAU1373_PWDN_CTRL1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_PGA</span><span class="p">(</span><span class="s">&quot;IN3PGA&quot;</span><span class="p">,</span> <span class="n">ADAU1373_PWDN_CTRL1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_PGA</span><span class="p">(</span><span class="s">&quot;IN2PGA&quot;</span><span class="p">,</span> <span class="n">ADAU1373_PWDN_CTRL1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_PGA</span><span class="p">(</span><span class="s">&quot;IN1PGA&quot;</span><span class="p">,</span> <span class="n">ADAU1373_PWDN_CTRL1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

	<span class="n">SND_SOC_DAPM_DAC</span><span class="p">(</span><span class="s">&quot;Left DAC2&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">ADAU1373_PWDN_CTRL2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_DAC</span><span class="p">(</span><span class="s">&quot;Right DAC2&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">ADAU1373_PWDN_CTRL2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_DAC</span><span class="p">(</span><span class="s">&quot;Left DAC1&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">ADAU1373_PWDN_CTRL2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_DAC</span><span class="p">(</span><span class="s">&quot;Right DAC1&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">ADAU1373_PWDN_CTRL2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

	<span class="n">SOC_MIXER_ARRAY</span><span class="p">(</span><span class="s">&quot;Left ADC Mixer&quot;</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
		<span class="n">adau1373_left_adc_mixer_controls</span><span class="p">),</span>
	<span class="n">SOC_MIXER_ARRAY</span><span class="p">(</span><span class="s">&quot;Right ADC Mixer&quot;</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
		<span class="n">adau1373_right_adc_mixer_controls</span><span class="p">),</span>

	<span class="n">SOC_MIXER_ARRAY</span><span class="p">(</span><span class="s">&quot;Left Lineout2 Mixer&quot;</span><span class="p">,</span> <span class="n">ADAU1373_PWDN_CTRL2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
		<span class="n">adau1373_left_line2_mixer_controls</span><span class="p">),</span>
	<span class="n">SOC_MIXER_ARRAY</span><span class="p">(</span><span class="s">&quot;Right Lineout2 Mixer&quot;</span><span class="p">,</span> <span class="n">ADAU1373_PWDN_CTRL2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
		<span class="n">adau1373_right_line2_mixer_controls</span><span class="p">),</span>
	<span class="n">SOC_MIXER_ARRAY</span><span class="p">(</span><span class="s">&quot;Left Lineout1 Mixer&quot;</span><span class="p">,</span> <span class="n">ADAU1373_PWDN_CTRL2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
		<span class="n">adau1373_left_line1_mixer_controls</span><span class="p">),</span>
	<span class="n">SOC_MIXER_ARRAY</span><span class="p">(</span><span class="s">&quot;Right Lineout1 Mixer&quot;</span><span class="p">,</span> <span class="n">ADAU1373_PWDN_CTRL2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
		<span class="n">adau1373_right_line1_mixer_controls</span><span class="p">),</span>

	<span class="n">SOC_MIXER_ARRAY</span><span class="p">(</span><span class="s">&quot;Earpiece Mixer&quot;</span><span class="p">,</span> <span class="n">ADAU1373_PWDN_CTRL3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
		<span class="n">adau1373_ep_mixer_controls</span><span class="p">),</span>
	<span class="n">SOC_MIXER_ARRAY</span><span class="p">(</span><span class="s">&quot;Left Speaker Mixer&quot;</span><span class="p">,</span> <span class="n">ADAU1373_PWDN_CTRL3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
		<span class="n">adau1373_left_spk_mixer_controls</span><span class="p">),</span>
	<span class="n">SOC_MIXER_ARRAY</span><span class="p">(</span><span class="s">&quot;Right Speaker Mixer&quot;</span><span class="p">,</span> <span class="n">ADAU1373_PWDN_CTRL3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
		<span class="n">adau1373_right_spk_mixer_controls</span><span class="p">),</span>
	<span class="n">SOC_MIXER_ARRAY</span><span class="p">(</span><span class="s">&quot;Left Headphone Mixer&quot;</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
		<span class="n">adau1373_left_hp_mixer_controls</span><span class="p">),</span>
	<span class="n">SOC_MIXER_ARRAY</span><span class="p">(</span><span class="s">&quot;Right Headphone Mixer&quot;</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
		<span class="n">adau1373_right_hp_mixer_controls</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_SUPPLY</span><span class="p">(</span><span class="s">&quot;Headphone Enable&quot;</span><span class="p">,</span> <span class="n">ADAU1373_PWDN_CTRL3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
		<span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

	<span class="n">SND_SOC_DAPM_SUPPLY</span><span class="p">(</span><span class="s">&quot;AIF1 CLK&quot;</span><span class="p">,</span> <span class="n">ADAU1373_SRC_DAI_CTRL</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
	    <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_SUPPLY</span><span class="p">(</span><span class="s">&quot;AIF2 CLK&quot;</span><span class="p">,</span> <span class="n">ADAU1373_SRC_DAI_CTRL</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
	    <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_SUPPLY</span><span class="p">(</span><span class="s">&quot;AIF3 CLK&quot;</span><span class="p">,</span> <span class="n">ADAU1373_SRC_DAI_CTRL</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
	    <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_SUPPLY</span><span class="p">(</span><span class="s">&quot;AIF1 IN SRC&quot;</span><span class="p">,</span> <span class="n">ADAU1373_SRC_DAI_CTRL</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
	    <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_SUPPLY</span><span class="p">(</span><span class="s">&quot;AIF1 OUT SRC&quot;</span><span class="p">,</span> <span class="n">ADAU1373_SRC_DAI_CTRL</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
	    <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_SUPPLY</span><span class="p">(</span><span class="s">&quot;AIF2 IN SRC&quot;</span><span class="p">,</span> <span class="n">ADAU1373_SRC_DAI_CTRL</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
	    <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_SUPPLY</span><span class="p">(</span><span class="s">&quot;AIF2 OUT SRC&quot;</span><span class="p">,</span> <span class="n">ADAU1373_SRC_DAI_CTRL</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
	    <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_SUPPLY</span><span class="p">(</span><span class="s">&quot;AIF3 IN SRC&quot;</span><span class="p">,</span> <span class="n">ADAU1373_SRC_DAI_CTRL</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
	    <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_SUPPLY</span><span class="p">(</span><span class="s">&quot;AIF3 OUT SRC&quot;</span><span class="p">,</span> <span class="n">ADAU1373_SRC_DAI_CTRL</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
	    <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

	<span class="n">SND_SOC_DAPM_AIF_IN</span><span class="p">(</span><span class="s">&quot;AIF1 IN&quot;</span><span class="p">,</span> <span class="s">&quot;AIF1 Playback&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_AIF_OUT</span><span class="p">(</span><span class="s">&quot;AIF1 OUT&quot;</span><span class="p">,</span> <span class="s">&quot;AIF1 Capture&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_AIF_IN</span><span class="p">(</span><span class="s">&quot;AIF2 IN&quot;</span><span class="p">,</span> <span class="s">&quot;AIF2 Playback&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_AIF_OUT</span><span class="p">(</span><span class="s">&quot;AIF2 OUT&quot;</span><span class="p">,</span> <span class="s">&quot;AIF2 Capture&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_AIF_IN</span><span class="p">(</span><span class="s">&quot;AIF3 IN&quot;</span><span class="p">,</span> <span class="s">&quot;AIF3 Playback&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_AIF_OUT</span><span class="p">(</span><span class="s">&quot;AIF3 OUT&quot;</span><span class="p">,</span> <span class="s">&quot;AIF3 Capture&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

	<span class="n">SOC_MIXER_ARRAY</span><span class="p">(</span><span class="s">&quot;DSP Channel1 Mixer&quot;</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
		<span class="n">adau1373_dsp_channel1_mixer_controls</span><span class="p">),</span>
	<span class="n">SOC_MIXER_ARRAY</span><span class="p">(</span><span class="s">&quot;DSP Channel2 Mixer&quot;</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
		<span class="n">adau1373_dsp_channel2_mixer_controls</span><span class="p">),</span>
	<span class="n">SOC_MIXER_ARRAY</span><span class="p">(</span><span class="s">&quot;DSP Channel3 Mixer&quot;</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
		<span class="n">adau1373_dsp_channel3_mixer_controls</span><span class="p">),</span>
	<span class="n">SOC_MIXER_ARRAY</span><span class="p">(</span><span class="s">&quot;DSP Channel4 Mixer&quot;</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
		<span class="n">adau1373_dsp_channel4_mixer_controls</span><span class="p">),</span>
	<span class="n">SOC_MIXER_ARRAY</span><span class="p">(</span><span class="s">&quot;DSP Channel5 Mixer&quot;</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
		<span class="n">adau1373_dsp_channel5_mixer_controls</span><span class="p">),</span>

	<span class="n">SOC_MIXER_ARRAY</span><span class="p">(</span><span class="s">&quot;AIF1 Mixer&quot;</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
		<span class="n">adau1373_aif1_mixer_controls</span><span class="p">),</span>
	<span class="n">SOC_MIXER_ARRAY</span><span class="p">(</span><span class="s">&quot;AIF2 Mixer&quot;</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
		<span class="n">adau1373_aif2_mixer_controls</span><span class="p">),</span>
	<span class="n">SOC_MIXER_ARRAY</span><span class="p">(</span><span class="s">&quot;AIF3 Mixer&quot;</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
		<span class="n">adau1373_aif3_mixer_controls</span><span class="p">),</span>
	<span class="n">SOC_MIXER_ARRAY</span><span class="p">(</span><span class="s">&quot;DAC1 Mixer&quot;</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
		<span class="n">adau1373_dac1_mixer_controls</span><span class="p">),</span>
	<span class="n">SOC_MIXER_ARRAY</span><span class="p">(</span><span class="s">&quot;DAC2 Mixer&quot;</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
		<span class="n">adau1373_dac2_mixer_controls</span><span class="p">),</span>

	<span class="n">SND_SOC_DAPM_SUPPLY</span><span class="p">(</span><span class="s">&quot;DSP&quot;</span><span class="p">,</span> <span class="n">ADAU1373_DIGEN</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_SUPPLY</span><span class="p">(</span><span class="s">&quot;Recording Engine B&quot;</span><span class="p">,</span> <span class="n">ADAU1373_DIGEN</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_SUPPLY</span><span class="p">(</span><span class="s">&quot;Recording Engine A&quot;</span><span class="p">,</span> <span class="n">ADAU1373_DIGEN</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_SUPPLY</span><span class="p">(</span><span class="s">&quot;Playback Engine B&quot;</span><span class="p">,</span> <span class="n">ADAU1373_DIGEN</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_SUPPLY</span><span class="p">(</span><span class="s">&quot;Playback Engine A&quot;</span><span class="p">,</span> <span class="n">ADAU1373_DIGEN</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

	<span class="n">SND_SOC_DAPM_SUPPLY</span><span class="p">(</span><span class="s">&quot;PLL1&quot;</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_pll_event</span><span class="p">,</span>
		<span class="n">SND_SOC_DAPM_PRE_PMU</span> <span class="o">|</span> <span class="n">SND_SOC_DAPM_POST_PMD</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_SUPPLY</span><span class="p">(</span><span class="s">&quot;PLL2&quot;</span><span class="p">,</span> <span class="n">SND_SOC_NOPM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">adau1373_pll_event</span><span class="p">,</span>
		<span class="n">SND_SOC_DAPM_PRE_PMU</span> <span class="o">|</span> <span class="n">SND_SOC_DAPM_POST_PMD</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_SUPPLY</span><span class="p">(</span><span class="s">&quot;SYSCLK1&quot;</span><span class="p">,</span> <span class="n">ADAU1373_CLK_SRC_DIV</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_SUPPLY</span><span class="p">(</span><span class="s">&quot;SYSCLK2&quot;</span><span class="p">,</span> <span class="n">ADAU1373_CLK_SRC_DIV</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

	<span class="n">SND_SOC_DAPM_INPUT</span><span class="p">(</span><span class="s">&quot;AIN1L&quot;</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_INPUT</span><span class="p">(</span><span class="s">&quot;AIN1R&quot;</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_INPUT</span><span class="p">(</span><span class="s">&quot;AIN2L&quot;</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_INPUT</span><span class="p">(</span><span class="s">&quot;AIN2R&quot;</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_INPUT</span><span class="p">(</span><span class="s">&quot;AIN3L&quot;</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_INPUT</span><span class="p">(</span><span class="s">&quot;AIN3R&quot;</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_INPUT</span><span class="p">(</span><span class="s">&quot;AIN4L&quot;</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_INPUT</span><span class="p">(</span><span class="s">&quot;AIN4R&quot;</span><span class="p">),</span>

	<span class="n">SND_SOC_DAPM_INPUT</span><span class="p">(</span><span class="s">&quot;DMIC1DAT&quot;</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_INPUT</span><span class="p">(</span><span class="s">&quot;DMIC2DAT&quot;</span><span class="p">),</span>

	<span class="n">SND_SOC_DAPM_OUTPUT</span><span class="p">(</span><span class="s">&quot;LOUT1L&quot;</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_OUTPUT</span><span class="p">(</span><span class="s">&quot;LOUT1R&quot;</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_OUTPUT</span><span class="p">(</span><span class="s">&quot;LOUT2L&quot;</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_OUTPUT</span><span class="p">(</span><span class="s">&quot;LOUT2R&quot;</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_OUTPUT</span><span class="p">(</span><span class="s">&quot;HPL&quot;</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_OUTPUT</span><span class="p">(</span><span class="s">&quot;HPR&quot;</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_OUTPUT</span><span class="p">(</span><span class="s">&quot;SPKL&quot;</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_OUTPUT</span><span class="p">(</span><span class="s">&quot;SPKR&quot;</span><span class="p">),</span>
	<span class="n">SND_SOC_DAPM_OUTPUT</span><span class="p">(</span><span class="s">&quot;EP&quot;</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">adau1373_check_aif_clk</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_dapm_widget</span> <span class="o">*</span><span class="n">source</span><span class="p">,</span>
	<span class="k">struct</span> <span class="n">snd_soc_dapm_widget</span> <span class="o">*</span><span class="n">sink</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">source</span><span class="o">-&gt;</span><span class="n">codec</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">adau1373</span> <span class="o">*</span><span class="n">adau1373</span> <span class="o">=</span> <span class="n">snd_soc_codec_get_drvdata</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dai</span><span class="p">;</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">clk</span><span class="p">;</span>

	<span class="n">dai</span> <span class="o">=</span> <span class="n">sink</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="sc">&#39;1&#39;</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">adau1373</span><span class="o">-&gt;</span><span class="n">dais</span><span class="p">[</span><span class="n">dai</span><span class="p">].</span><span class="n">master</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">adau1373</span><span class="o">-&gt;</span><span class="n">dais</span><span class="p">[</span><span class="n">dai</span><span class="p">].</span><span class="n">clk_src</span> <span class="o">==</span> <span class="n">ADAU1373_CLK_SRC_PLL1</span><span class="p">)</span>
		<span class="n">clk</span> <span class="o">=</span> <span class="s">&quot;SYSCLK1&quot;</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="n">clk</span> <span class="o">=</span> <span class="s">&quot;SYSCLK2&quot;</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">strcmp</span><span class="p">(</span><span class="n">source</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="n">clk</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">adau1373_check_src</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_dapm_widget</span> <span class="o">*</span><span class="n">source</span><span class="p">,</span>
	<span class="k">struct</span> <span class="n">snd_soc_dapm_widget</span> <span class="o">*</span><span class="n">sink</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">source</span><span class="o">-&gt;</span><span class="n">codec</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">adau1373</span> <span class="o">*</span><span class="n">adau1373</span> <span class="o">=</span> <span class="n">snd_soc_codec_get_drvdata</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dai</span><span class="p">;</span>

	<span class="n">dai</span> <span class="o">=</span> <span class="n">sink</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="sc">&#39;1&#39;</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">adau1373</span><span class="o">-&gt;</span><span class="n">dais</span><span class="p">[</span><span class="n">dai</span><span class="p">].</span><span class="n">enable_src</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#define DSP_CHANNEL_MIXER_ROUTES(_sink) \</span>
<span class="cp">	{ _sink, &quot;DMIC2 Swapped Switch&quot;, &quot;DMIC2&quot; }, \</span>
<span class="cp">	{ _sink, &quot;DMIC2 Switch&quot;, &quot;DMIC2&quot; }, \</span>
<span class="cp">	{ _sink, &quot;ADC/DMIC1 Swapped Switch&quot;, &quot;Decimator Mux&quot; }, \</span>
<span class="cp">	{ _sink, &quot;ADC/DMIC1 Switch&quot;, &quot;Decimator Mux&quot; }, \</span>
<span class="cp">	{ _sink, &quot;AIF1 Switch&quot;, &quot;AIF1 IN&quot; }, \</span>
<span class="cp">	{ _sink, &quot;AIF2 Switch&quot;, &quot;AIF2 IN&quot; }, \</span>
<span class="cp">	{ _sink, &quot;AIF3 Switch&quot;, &quot;AIF3 IN&quot; }</span>

<span class="cp">#define DSP_OUTPUT_MIXER_ROUTES(_sink) \</span>
<span class="cp">	{ _sink, &quot;DSP Channel1 Switch&quot;, &quot;DSP Channel1 Mixer&quot; }, \</span>
<span class="cp">	{ _sink, &quot;DSP Channel2 Switch&quot;, &quot;DSP Channel2 Mixer&quot; }, \</span>
<span class="cp">	{ _sink, &quot;DSP Channel3 Switch&quot;, &quot;DSP Channel3 Mixer&quot; }, \</span>
<span class="cp">	{ _sink, &quot;DSP Channel4 Switch&quot;, &quot;DSP Channel4 Mixer&quot; }, \</span>
<span class="cp">	{ _sink, &quot;DSP Channel5 Switch&quot;, &quot;DSP Channel5 Mixer&quot; }</span>

<span class="cp">#define LEFT_OUTPUT_MIXER_ROUTES(_sink) \</span>
<span class="cp">	{ _sink, &quot;Right DAC2 Switch&quot;, &quot;Right DAC2&quot; }, \</span>
<span class="cp">	{ _sink, &quot;Left DAC2 Switch&quot;, &quot;Left DAC2&quot; }, \</span>
<span class="cp">	{ _sink, &quot;Right DAC1 Switch&quot;, &quot;Right DAC1&quot; }, \</span>
<span class="cp">	{ _sink, &quot;Left DAC1 Switch&quot;, &quot;Left DAC1&quot; }, \</span>
<span class="cp">	{ _sink, &quot;Input 1 Bypass Switch&quot;, &quot;IN1PGA&quot; }, \</span>
<span class="cp">	{ _sink, &quot;Input 2 Bypass Switch&quot;, &quot;IN2PGA&quot; }, \</span>
<span class="cp">	{ _sink, &quot;Input 3 Bypass Switch&quot;, &quot;IN3PGA&quot; }, \</span>
<span class="cp">	{ _sink, &quot;Input 4 Bypass Switch&quot;, &quot;IN4PGA&quot; }</span>

<span class="cp">#define RIGHT_OUTPUT_MIXER_ROUTES(_sink) \</span>
<span class="cp">	{ _sink, &quot;Right DAC2 Switch&quot;, &quot;Right DAC2&quot; }, \</span>
<span class="cp">	{ _sink, &quot;Left DAC2 Switch&quot;, &quot;Left DAC2&quot; }, \</span>
<span class="cp">	{ _sink, &quot;Right DAC1 Switch&quot;, &quot;Right DAC1&quot; }, \</span>
<span class="cp">	{ _sink, &quot;Left DAC1 Switch&quot;, &quot;Left DAC1&quot; }, \</span>
<span class="cp">	{ _sink, &quot;Input 1 Bypass Switch&quot;, &quot;IN1PGA&quot; }, \</span>
<span class="cp">	{ _sink, &quot;Input 2 Bypass Switch&quot;, &quot;IN2PGA&quot; }, \</span>
<span class="cp">	{ _sink, &quot;Input 3 Bypass Switch&quot;, &quot;IN3PGA&quot; }, \</span>
<span class="cp">	{ _sink, &quot;Input 4 Bypass Switch&quot;, &quot;IN4PGA&quot; }</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_soc_dapm_route</span> <span class="n">adau1373_dapm_routes</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="s">&quot;Left ADC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;DAC1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;Left DAC1&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Left ADC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Input 1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;IN1PGA&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Left ADC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Input 2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;IN2PGA&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Left ADC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Input 3 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;IN3PGA&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Left ADC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Input 4 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;IN4PGA&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="s">&quot;Right ADC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;DAC1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;Right DAC1&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Right ADC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Input 1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;IN1PGA&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Right ADC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Input 2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;IN2PGA&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Right ADC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Input 3 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;IN3PGA&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Right ADC Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Input 4 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;IN4PGA&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="s">&quot;Left ADC&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Left ADC Mixer&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Right ADC&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Right ADC Mixer&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="s">&quot;Decimator Mux&quot;</span><span class="p">,</span> <span class="s">&quot;ADC&quot;</span><span class="p">,</span> <span class="s">&quot;Left ADC&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Decimator Mux&quot;</span><span class="p">,</span> <span class="s">&quot;ADC&quot;</span><span class="p">,</span> <span class="s">&quot;Right ADC&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Decimator Mux&quot;</span><span class="p">,</span> <span class="s">&quot;DMIC1&quot;</span><span class="p">,</span> <span class="s">&quot;DMIC1&quot;</span> <span class="p">},</span>

	<span class="n">DSP_CHANNEL_MIXER_ROUTES</span><span class="p">(</span><span class="s">&quot;DSP Channel1 Mixer&quot;</span><span class="p">),</span>
	<span class="n">DSP_CHANNEL_MIXER_ROUTES</span><span class="p">(</span><span class="s">&quot;DSP Channel2 Mixer&quot;</span><span class="p">),</span>
	<span class="n">DSP_CHANNEL_MIXER_ROUTES</span><span class="p">(</span><span class="s">&quot;DSP Channel3 Mixer&quot;</span><span class="p">),</span>
	<span class="n">DSP_CHANNEL_MIXER_ROUTES</span><span class="p">(</span><span class="s">&quot;DSP Channel4 Mixer&quot;</span><span class="p">),</span>
	<span class="n">DSP_CHANNEL_MIXER_ROUTES</span><span class="p">(</span><span class="s">&quot;DSP Channel5 Mixer&quot;</span><span class="p">),</span>

	<span class="n">DSP_OUTPUT_MIXER_ROUTES</span><span class="p">(</span><span class="s">&quot;AIF1 Mixer&quot;</span><span class="p">),</span>
	<span class="n">DSP_OUTPUT_MIXER_ROUTES</span><span class="p">(</span><span class="s">&quot;AIF2 Mixer&quot;</span><span class="p">),</span>
	<span class="n">DSP_OUTPUT_MIXER_ROUTES</span><span class="p">(</span><span class="s">&quot;AIF3 Mixer&quot;</span><span class="p">),</span>
	<span class="n">DSP_OUTPUT_MIXER_ROUTES</span><span class="p">(</span><span class="s">&quot;DAC1 Mixer&quot;</span><span class="p">),</span>
	<span class="n">DSP_OUTPUT_MIXER_ROUTES</span><span class="p">(</span><span class="s">&quot;DAC2 Mixer&quot;</span><span class="p">),</span>

	<span class="p">{</span> <span class="s">&quot;AIF1 OUT&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;AIF1 Mixer&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;AIF2 OUT&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;AIF2 Mixer&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;AIF3 OUT&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;AIF3 Mixer&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Left DAC1&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;DAC1 Mixer&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Right DAC1&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;DAC1 Mixer&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Left DAC2&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;DAC2 Mixer&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Right DAC2&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;DAC2 Mixer&quot;</span> <span class="p">},</span>

	<span class="n">LEFT_OUTPUT_MIXER_ROUTES</span><span class="p">(</span><span class="s">&quot;Left Lineout1 Mixer&quot;</span><span class="p">),</span>
	<span class="n">RIGHT_OUTPUT_MIXER_ROUTES</span><span class="p">(</span><span class="s">&quot;Right Lineout1 Mixer&quot;</span><span class="p">),</span>
	<span class="n">LEFT_OUTPUT_MIXER_ROUTES</span><span class="p">(</span><span class="s">&quot;Left Lineout2 Mixer&quot;</span><span class="p">),</span>
	<span class="n">RIGHT_OUTPUT_MIXER_ROUTES</span><span class="p">(</span><span class="s">&quot;Right Lineout2 Mixer&quot;</span><span class="p">),</span>
	<span class="n">LEFT_OUTPUT_MIXER_ROUTES</span><span class="p">(</span><span class="s">&quot;Left Speaker Mixer&quot;</span><span class="p">),</span>
	<span class="n">RIGHT_OUTPUT_MIXER_ROUTES</span><span class="p">(</span><span class="s">&quot;Right Speaker Mixer&quot;</span><span class="p">),</span>

	<span class="p">{</span> <span class="s">&quot;Left Headphone Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Left DAC2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;Left DAC2&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Left Headphone Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Left DAC1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;Left DAC1&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Left Headphone Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Input 1 Bypass Switch&quot;</span><span class="p">,</span> <span class="s">&quot;IN1PGA&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Left Headphone Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Input 2 Bypass Switch&quot;</span><span class="p">,</span> <span class="s">&quot;IN2PGA&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Left Headphone Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Input 3 Bypass Switch&quot;</span><span class="p">,</span> <span class="s">&quot;IN3PGA&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Left Headphone Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Input 4 Bypass Switch&quot;</span><span class="p">,</span> <span class="s">&quot;IN4PGA&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Right Headphone Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Right DAC2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;Right DAC2&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Right Headphone Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Right DAC1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;Right DAC1&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Right Headphone Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Input 1 Bypass Switch&quot;</span><span class="p">,</span> <span class="s">&quot;IN1PGA&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Right Headphone Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Input 2 Bypass Switch&quot;</span><span class="p">,</span> <span class="s">&quot;IN2PGA&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Right Headphone Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Input 3 Bypass Switch&quot;</span><span class="p">,</span> <span class="s">&quot;IN3PGA&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Right Headphone Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Input 4 Bypass Switch&quot;</span><span class="p">,</span> <span class="s">&quot;IN4PGA&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="s">&quot;Left Headphone Mixer&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Headphone Enable&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Right Headphone Mixer&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Headphone Enable&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="s">&quot;Earpiece Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Right DAC2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;Right DAC2&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Earpiece Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Left DAC2 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;Left DAC2&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Earpiece Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Right DAC1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;Right DAC1&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Earpiece Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Left DAC1 Switch&quot;</span><span class="p">,</span> <span class="s">&quot;Left DAC1&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Earpiece Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Input 1 Bypass Switch&quot;</span><span class="p">,</span> <span class="s">&quot;IN1PGA&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Earpiece Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Input 2 Bypass Switch&quot;</span><span class="p">,</span> <span class="s">&quot;IN2PGA&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Earpiece Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Input 3 Bypass Switch&quot;</span><span class="p">,</span> <span class="s">&quot;IN3PGA&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Earpiece Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;Input 4 Bypass Switch&quot;</span><span class="p">,</span> <span class="s">&quot;IN4PGA&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="s">&quot;LOUT1L&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Left Lineout1 Mixer&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;LOUT1R&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Right Lineout1 Mixer&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;LOUT2L&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Left Lineout2 Mixer&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;LOUT2R&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Right Lineout2 Mixer&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;SPKL&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Left Speaker Mixer&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;SPKR&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Right Speaker Mixer&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;HPL&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Left Headphone Mixer&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;HPR&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Right Headphone Mixer&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;EP&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Earpiece Mixer&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="s">&quot;IN1PGA&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;AIN1L&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;IN2PGA&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;AIN2L&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;IN3PGA&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;AIN3L&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;IN4PGA&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;AIN4L&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;IN1PGA&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;AIN1R&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;IN2PGA&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;AIN2R&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;IN3PGA&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;AIN3R&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;IN4PGA&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;AIN4R&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="s">&quot;SYSCLK1&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;PLL1&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;SYSCLK2&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;PLL2&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="s">&quot;Left DAC1&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;SYSCLK1&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Right DAC1&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;SYSCLK1&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Left DAC2&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;SYSCLK1&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Right DAC2&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;SYSCLK1&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Left ADC&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;SYSCLK1&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Right ADC&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;SYSCLK1&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="s">&quot;DSP&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;SYSCLK1&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="s">&quot;AIF1 Mixer&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;DSP&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;AIF2 Mixer&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;DSP&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;AIF3 Mixer&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;DSP&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;DAC1 Mixer&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;DSP&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;DAC2 Mixer&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;DSP&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;DAC1 Mixer&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Playback Engine A&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;DAC2 Mixer&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Playback Engine B&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Left ADC Mixer&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Recording Engine A&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;Right ADC Mixer&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Recording Engine A&quot;</span> <span class="p">},</span>

	<span class="p">{</span> <span class="s">&quot;AIF1 CLK&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;SYSCLK1&quot;</span><span class="p">,</span> <span class="n">adau1373_check_aif_clk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;AIF2 CLK&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;SYSCLK1&quot;</span><span class="p">,</span> <span class="n">adau1373_check_aif_clk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;AIF3 CLK&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;SYSCLK1&quot;</span><span class="p">,</span> <span class="n">adau1373_check_aif_clk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;AIF1 CLK&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;SYSCLK2&quot;</span><span class="p">,</span> <span class="n">adau1373_check_aif_clk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;AIF2 CLK&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;SYSCLK2&quot;</span><span class="p">,</span> <span class="n">adau1373_check_aif_clk</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;AIF3 CLK&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;SYSCLK2&quot;</span><span class="p">,</span> <span class="n">adau1373_check_aif_clk</span> <span class="p">},</span>

	<span class="p">{</span> <span class="s">&quot;AIF1 IN&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;AIF1 CLK&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;AIF1 OUT&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;AIF1 CLK&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;AIF2 IN&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;AIF2 CLK&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;AIF2 OUT&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;AIF2 CLK&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;AIF3 IN&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;AIF3 CLK&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;AIF3 OUT&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;AIF3 CLK&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;AIF1 IN&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;AIF1 IN SRC&quot;</span><span class="p">,</span> <span class="n">adau1373_check_src</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;AIF1 OUT&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;AIF1 OUT SRC&quot;</span><span class="p">,</span> <span class="n">adau1373_check_src</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;AIF2 IN&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;AIF2 IN SRC&quot;</span><span class="p">,</span> <span class="n">adau1373_check_src</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;AIF2 OUT&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;AIF2 OUT SRC&quot;</span><span class="p">,</span> <span class="n">adau1373_check_src</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;AIF3 IN&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;AIF3 IN SRC&quot;</span><span class="p">,</span> <span class="n">adau1373_check_src</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;AIF3 OUT&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;AIF3 OUT SRC&quot;</span><span class="p">,</span> <span class="n">adau1373_check_src</span> <span class="p">},</span>

	<span class="p">{</span> <span class="s">&quot;DMIC1&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;DMIC1DAT&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;DMIC1&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;SYSCLK1&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;DMIC1&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Recording Engine A&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;DMIC2&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;DMIC2DAT&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;DMIC2&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;SYSCLK1&quot;</span> <span class="p">},</span>
	<span class="p">{</span> <span class="s">&quot;DMIC2&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Recording Engine B&quot;</span> <span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">adau1373_hw_params</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_pcm_substream</span> <span class="o">*</span><span class="n">substream</span><span class="p">,</span>
	<span class="k">struct</span> <span class="n">snd_pcm_hw_params</span> <span class="o">*</span><span class="n">params</span><span class="p">,</span> <span class="k">struct</span> <span class="n">snd_soc_dai</span> <span class="o">*</span><span class="n">dai</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">dai</span><span class="o">-&gt;</span><span class="n">codec</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">adau1373</span> <span class="o">*</span><span class="n">adau1373</span> <span class="o">=</span> <span class="n">snd_soc_codec_get_drvdata</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">adau1373_dai</span> <span class="o">*</span><span class="n">adau1373_dai</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">adau1373</span><span class="o">-&gt;</span><span class="n">dais</span><span class="p">[</span><span class="n">dai</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">div</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">freq</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ctrl</span><span class="p">;</span>

	<span class="n">freq</span> <span class="o">=</span> <span class="n">adau1373_dai</span><span class="o">-&gt;</span><span class="n">sysclk</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">freq</span> <span class="o">%</span> <span class="n">params_rate</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">freq</span> <span class="o">/</span> <span class="n">params_rate</span><span class="p">(</span><span class="n">params</span><span class="p">))</span> <span class="p">{</span>
	<span class="k">case</span> <span class="mi">1024</span>: <span class="cm">/* sysclk / 256 */</span>
		<span class="n">div</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">1536</span>: <span class="cm">/* 2/3 sysclk / 256 */</span>
		<span class="n">div</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">2048</span>: <span class="cm">/* 1/2 sysclk / 256 */</span>
		<span class="n">div</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">3072</span>: <span class="cm">/* 1/3 sysclk / 256 */</span>
		<span class="n">div</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">4096</span>: <span class="cm">/* 1/4 sysclk / 256 */</span>
		<span class="n">div</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">6144</span>: <span class="cm">/* 1/6 sysclk / 256 */</span>
		<span class="n">div</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">5632</span>: <span class="cm">/* 2/11 sysclk / 256 */</span>
		<span class="n">div</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">adau1373_dai</span><span class="o">-&gt;</span><span class="n">enable_src</span> <span class="o">=</span> <span class="p">(</span><span class="n">div</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">);</span>

	<span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">ADAU1373_BCLKDIV</span><span class="p">(</span><span class="n">dai</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">),</span>
		<span class="o">~</span><span class="n">ADAU1373_BCLKDIV_SOURCE</span><span class="p">,</span> <span class="p">(</span><span class="n">div</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">|</span> <span class="n">ADAU1373_BCLKDIV_64</span><span class="p">);</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">params_format</span><span class="p">(</span><span class="n">params</span><span class="p">))</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">SNDRV_PCM_FORMAT_S16_LE</span>:
		<span class="n">ctrl</span> <span class="o">=</span> <span class="n">ADAU1373_DAI_WLEN_16</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">SNDRV_PCM_FORMAT_S20_3LE</span>:
		<span class="n">ctrl</span> <span class="o">=</span> <span class="n">ADAU1373_DAI_WLEN_20</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">SNDRV_PCM_FORMAT_S24_LE</span>:
		<span class="n">ctrl</span> <span class="o">=</span> <span class="n">ADAU1373_DAI_WLEN_24</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">SNDRV_PCM_FORMAT_S32_LE</span>:
		<span class="n">ctrl</span> <span class="o">=</span> <span class="n">ADAU1373_DAI_WLEN_32</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">ADAU1373_DAI</span><span class="p">(</span><span class="n">dai</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">),</span>
			<span class="n">ADAU1373_DAI_WLEN_MASK</span><span class="p">,</span> <span class="n">ctrl</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">adau1373_set_dai_fmt</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_dai</span> <span class="o">*</span><span class="n">dai</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">fmt</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">dai</span><span class="o">-&gt;</span><span class="n">codec</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">adau1373</span> <span class="o">*</span><span class="n">adau1373</span> <span class="o">=</span> <span class="n">snd_soc_codec_get_drvdata</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">adau1373_dai</span> <span class="o">*</span><span class="n">adau1373_dai</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">adau1373</span><span class="o">-&gt;</span><span class="n">dais</span><span class="p">[</span><span class="n">dai</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ctrl</span><span class="p">;</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">fmt</span> <span class="o">&amp;</span> <span class="n">SND_SOC_DAIFMT_MASTER_MASK</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">SND_SOC_DAIFMT_CBM_CFM</span>:
		<span class="n">ctrl</span> <span class="o">=</span> <span class="n">ADAU1373_DAI_MASTER</span><span class="p">;</span>
		<span class="n">adau1373_dai</span><span class="o">-&gt;</span><span class="n">master</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">SND_SOC_DAIFMT_CBS_CFS</span>:
		<span class="n">ctrl</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">adau1373_dai</span><span class="o">-&gt;</span><span class="n">master</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">fmt</span> <span class="o">&amp;</span> <span class="n">SND_SOC_DAIFMT_FORMAT_MASK</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">SND_SOC_DAIFMT_I2S</span>:
		<span class="n">ctrl</span> <span class="o">|=</span> <span class="n">ADAU1373_DAI_FORMAT_I2S</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">SND_SOC_DAIFMT_LEFT_J</span>:
		<span class="n">ctrl</span> <span class="o">|=</span> <span class="n">ADAU1373_DAI_FORMAT_LEFT_J</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">SND_SOC_DAIFMT_RIGHT_J</span>:
		<span class="n">ctrl</span> <span class="o">|=</span> <span class="n">ADAU1373_DAI_FORMAT_RIGHT_J</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">SND_SOC_DAIFMT_DSP_B</span>:
		<span class="n">ctrl</span> <span class="o">|=</span> <span class="n">ADAU1373_DAI_FORMAT_DSP</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">fmt</span> <span class="o">&amp;</span> <span class="n">SND_SOC_DAIFMT_INV_MASK</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">SND_SOC_DAIFMT_NB_NF</span>:
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">SND_SOC_DAIFMT_IB_NF</span>:
		<span class="n">ctrl</span> <span class="o">|=</span> <span class="n">ADAU1373_DAI_INVERT_BCLK</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">SND_SOC_DAIFMT_NB_IF</span>:
		<span class="n">ctrl</span> <span class="o">|=</span> <span class="n">ADAU1373_DAI_INVERT_LRCLK</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">SND_SOC_DAIFMT_IB_IF</span>:
		<span class="n">ctrl</span> <span class="o">|=</span> <span class="n">ADAU1373_DAI_INVERT_LRCLK</span> <span class="o">|</span> <span class="n">ADAU1373_DAI_INVERT_BCLK</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">ADAU1373_DAI</span><span class="p">(</span><span class="n">dai</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">),</span>
		<span class="o">~</span><span class="n">ADAU1373_DAI_WLEN_MASK</span><span class="p">,</span> <span class="n">ctrl</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">adau1373_set_dai_sysclk</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_dai</span> <span class="o">*</span><span class="n">dai</span><span class="p">,</span>
	<span class="kt">int</span> <span class="n">clk_id</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">freq</span><span class="p">,</span> <span class="kt">int</span> <span class="n">dir</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">adau1373</span> <span class="o">*</span><span class="n">adau1373</span> <span class="o">=</span> <span class="n">snd_soc_codec_get_drvdata</span><span class="p">(</span><span class="n">dai</span><span class="o">-&gt;</span><span class="n">codec</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">adau1373_dai</span> <span class="o">*</span><span class="n">adau1373_dai</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">adau1373</span><span class="o">-&gt;</span><span class="n">dais</span><span class="p">[</span><span class="n">dai</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">];</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">clk_id</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">ADAU1373_CLK_SRC_PLL1</span>:
	<span class="k">case</span> <span class="n">ADAU1373_CLK_SRC_PLL2</span>:
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">adau1373_dai</span><span class="o">-&gt;</span><span class="n">sysclk</span> <span class="o">=</span> <span class="n">freq</span><span class="p">;</span>
	<span class="n">adau1373_dai</span><span class="o">-&gt;</span><span class="n">clk_src</span> <span class="o">=</span> <span class="n">clk_id</span><span class="p">;</span>

	<span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">dai</span><span class="o">-&gt;</span><span class="n">codec</span><span class="p">,</span> <span class="n">ADAU1373_BCLKDIV</span><span class="p">(</span><span class="n">dai</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">),</span>
		<span class="n">ADAU1373_BCLKDIV_SOURCE</span><span class="p">,</span> <span class="n">clk_id</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_soc_dai_ops</span> <span class="n">adau1373_dai_ops</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">hw_params</span>	<span class="o">=</span> <span class="n">adau1373_hw_params</span><span class="p">,</span>
	<span class="p">.</span><span class="n">set_sysclk</span>	<span class="o">=</span> <span class="n">adau1373_set_dai_sysclk</span><span class="p">,</span>
	<span class="p">.</span><span class="n">set_fmt</span>	<span class="o">=</span> <span class="n">adau1373_set_dai_fmt</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define ADAU1373_FORMATS (SNDRV_PCM_FMTBIT_S16_LE | SNDRV_PCM_FMTBIT_S20_3LE | \</span>
<span class="cp">	SNDRV_PCM_FMTBIT_S24_LE | SNDRV_PCM_FMTBIT_S32_LE)</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">snd_soc_dai_driver</span> <span class="n">adau1373_dai_driver</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
		<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;adau1373-aif1&quot;</span><span class="p">,</span>
		<span class="p">.</span><span class="n">playback</span> <span class="o">=</span> <span class="p">{</span>
			<span class="p">.</span><span class="n">stream_name</span> <span class="o">=</span> <span class="s">&quot;AIF1 Playback&quot;</span><span class="p">,</span>
			<span class="p">.</span><span class="n">channels_min</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
			<span class="p">.</span><span class="n">channels_max</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
			<span class="p">.</span><span class="n">rates</span> <span class="o">=</span> <span class="n">SNDRV_PCM_RATE_8000_48000</span><span class="p">,</span>
			<span class="p">.</span><span class="n">formats</span> <span class="o">=</span> <span class="n">ADAU1373_FORMATS</span><span class="p">,</span>
		<span class="p">},</span>
		<span class="p">.</span><span class="n">capture</span> <span class="o">=</span> <span class="p">{</span>
			<span class="p">.</span><span class="n">stream_name</span> <span class="o">=</span> <span class="s">&quot;AIF1 Capture&quot;</span><span class="p">,</span>
			<span class="p">.</span><span class="n">channels_min</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
			<span class="p">.</span><span class="n">channels_max</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
			<span class="p">.</span><span class="n">rates</span> <span class="o">=</span> <span class="n">SNDRV_PCM_RATE_8000_48000</span><span class="p">,</span>
			<span class="p">.</span><span class="n">formats</span> <span class="o">=</span> <span class="n">ADAU1373_FORMATS</span><span class="p">,</span>
		<span class="p">},</span>
		<span class="p">.</span><span class="n">ops</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">adau1373_dai_ops</span><span class="p">,</span>
		<span class="p">.</span><span class="n">symmetric_rates</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
		<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;adau1373-aif2&quot;</span><span class="p">,</span>
		<span class="p">.</span><span class="n">playback</span> <span class="o">=</span> <span class="p">{</span>
			<span class="p">.</span><span class="n">stream_name</span> <span class="o">=</span> <span class="s">&quot;AIF2 Playback&quot;</span><span class="p">,</span>
			<span class="p">.</span><span class="n">channels_min</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
			<span class="p">.</span><span class="n">channels_max</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
			<span class="p">.</span><span class="n">rates</span> <span class="o">=</span> <span class="n">SNDRV_PCM_RATE_8000_48000</span><span class="p">,</span>
			<span class="p">.</span><span class="n">formats</span> <span class="o">=</span> <span class="n">ADAU1373_FORMATS</span><span class="p">,</span>
		<span class="p">},</span>
		<span class="p">.</span><span class="n">capture</span> <span class="o">=</span> <span class="p">{</span>
			<span class="p">.</span><span class="n">stream_name</span> <span class="o">=</span> <span class="s">&quot;AIF2 Capture&quot;</span><span class="p">,</span>
			<span class="p">.</span><span class="n">channels_min</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
			<span class="p">.</span><span class="n">channels_max</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
			<span class="p">.</span><span class="n">rates</span> <span class="o">=</span> <span class="n">SNDRV_PCM_RATE_8000_48000</span><span class="p">,</span>
			<span class="p">.</span><span class="n">formats</span> <span class="o">=</span> <span class="n">ADAU1373_FORMATS</span><span class="p">,</span>
		<span class="p">},</span>
		<span class="p">.</span><span class="n">ops</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">adau1373_dai_ops</span><span class="p">,</span>
		<span class="p">.</span><span class="n">symmetric_rates</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
		<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;adau1373-aif3&quot;</span><span class="p">,</span>
		<span class="p">.</span><span class="n">playback</span> <span class="o">=</span> <span class="p">{</span>
			<span class="p">.</span><span class="n">stream_name</span> <span class="o">=</span> <span class="s">&quot;AIF3 Playback&quot;</span><span class="p">,</span>
			<span class="p">.</span><span class="n">channels_min</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
			<span class="p">.</span><span class="n">channels_max</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
			<span class="p">.</span><span class="n">rates</span> <span class="o">=</span> <span class="n">SNDRV_PCM_RATE_8000_48000</span><span class="p">,</span>
			<span class="p">.</span><span class="n">formats</span> <span class="o">=</span> <span class="n">ADAU1373_FORMATS</span><span class="p">,</span>
		<span class="p">},</span>
		<span class="p">.</span><span class="n">capture</span> <span class="o">=</span> <span class="p">{</span>
			<span class="p">.</span><span class="n">stream_name</span> <span class="o">=</span> <span class="s">&quot;AIF3 Capture&quot;</span><span class="p">,</span>
			<span class="p">.</span><span class="n">channels_min</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
			<span class="p">.</span><span class="n">channels_max</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
			<span class="p">.</span><span class="n">rates</span> <span class="o">=</span> <span class="n">SNDRV_PCM_RATE_8000_48000</span><span class="p">,</span>
			<span class="p">.</span><span class="n">formats</span> <span class="o">=</span> <span class="n">ADAU1373_FORMATS</span><span class="p">,</span>
		<span class="p">},</span>
		<span class="p">.</span><span class="n">ops</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">adau1373_dai_ops</span><span class="p">,</span>
		<span class="p">.</span><span class="n">symmetric_rates</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">adau1373_set_pll</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pll_id</span><span class="p">,</span>
	<span class="kt">int</span> <span class="n">source</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">freq_in</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">freq_out</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dpll_div</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">mode</span><span class="p">;</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">pll_id</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">ADAU1373_PLL1</span>:
	<span class="k">case</span> <span class="n">ADAU1373_PLL2</span>:
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">source</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">ADAU1373_PLL_SRC_BCLK1</span>:
	<span class="k">case</span> <span class="n">ADAU1373_PLL_SRC_BCLK2</span>:
	<span class="k">case</span> <span class="n">ADAU1373_PLL_SRC_BCLK3</span>:
	<span class="k">case</span> <span class="n">ADAU1373_PLL_SRC_LRCLK1</span>:
	<span class="k">case</span> <span class="n">ADAU1373_PLL_SRC_LRCLK2</span>:
	<span class="k">case</span> <span class="n">ADAU1373_PLL_SRC_LRCLK3</span>:
	<span class="k">case</span> <span class="n">ADAU1373_PLL_SRC_MCLK1</span>:
	<span class="k">case</span> <span class="n">ADAU1373_PLL_SRC_MCLK2</span>:
	<span class="k">case</span> <span class="n">ADAU1373_PLL_SRC_GPIO1</span>:
	<span class="k">case</span> <span class="n">ADAU1373_PLL_SRC_GPIO2</span>:
	<span class="k">case</span> <span class="n">ADAU1373_PLL_SRC_GPIO3</span>:
	<span class="k">case</span> <span class="n">ADAU1373_PLL_SRC_GPIO4</span>:
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">freq_in</span> <span class="o">&lt;</span> <span class="mi">7813</span> <span class="o">||</span> <span class="n">freq_in</span> <span class="o">&gt;</span> <span class="mi">27000000</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">freq_out</span> <span class="o">&lt;</span> <span class="mi">45158000</span> <span class="o">||</span> <span class="n">freq_out</span> <span class="o">&gt;</span> <span class="mi">49152000</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>

	<span class="cm">/* APLL input needs to be &gt;= 8Mhz, so in case freq_in is less we use the</span>
<span class="cm">	 * DPLL to get it there. DPLL_out = (DPLL_in / div) * 1024 */</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">freq_in</span> <span class="o">&lt;</span> <span class="mi">8000000</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">freq_in</span> <span class="o">*=</span> <span class="mi">2</span><span class="p">;</span>
		<span class="n">dpll_div</span><span class="o">++</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">freq_out</span> <span class="o">%</span> <span class="n">freq_in</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* fout = fin * (r + (n/m)) / x */</span>
		<span class="n">x</span> <span class="o">=</span> <span class="n">DIV_ROUND_UP</span><span class="p">(</span><span class="n">freq_in</span><span class="p">,</span> <span class="mi">13500000</span><span class="p">);</span>
		<span class="n">freq_in</span> <span class="o">/=</span> <span class="n">x</span><span class="p">;</span>
		<span class="n">r</span> <span class="o">=</span> <span class="n">freq_out</span> <span class="o">/</span> <span class="n">freq_in</span><span class="p">;</span>
		<span class="n">i</span> <span class="o">=</span> <span class="n">freq_out</span> <span class="o">%</span> <span class="n">freq_in</span><span class="p">;</span>
		<span class="n">j</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">freq_in</span><span class="p">);</span>
		<span class="n">n</span> <span class="o">=</span> <span class="n">i</span> <span class="o">/</span> <span class="n">j</span><span class="p">;</span>
		<span class="n">m</span> <span class="o">=</span> <span class="n">freq_in</span> <span class="o">/</span> <span class="n">j</span><span class="p">;</span>
		<span class="n">x</span><span class="o">--</span><span class="p">;</span>
		<span class="n">mode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="cm">/* fout = fin / r */</span>
		<span class="n">r</span> <span class="o">=</span> <span class="n">freq_out</span> <span class="o">/</span> <span class="n">freq_in</span><span class="p">;</span>
		<span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">m</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">mode</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">r</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">||</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">8</span> <span class="o">||</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="o">||</span> <span class="n">m</span> <span class="o">&gt;</span> <span class="mh">0xffff</span> <span class="o">||</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mh">0xffff</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">dpll_div</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">dpll_div</span> <span class="o">=</span> <span class="mi">11</span> <span class="o">-</span> <span class="n">dpll_div</span><span class="p">;</span>
		<span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">ADAU1373_PLL_CTRL6</span><span class="p">(</span><span class="n">pll_id</span><span class="p">),</span>
			<span class="n">ADAU1373_PLL_CTRL6_DPLL_BYPASS</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">ADAU1373_PLL_CTRL6</span><span class="p">(</span><span class="n">pll_id</span><span class="p">),</span>
			<span class="n">ADAU1373_PLL_CTRL6_DPLL_BYPASS</span><span class="p">,</span>
			<span class="n">ADAU1373_PLL_CTRL6_DPLL_BYPASS</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">ADAU1373_DPLL_CTRL</span><span class="p">(</span><span class="n">pll_id</span><span class="p">),</span>
		<span class="p">(</span><span class="n">source</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">dpll_div</span><span class="p">);</span>
	<span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">ADAU1373_PLL_CTRL1</span><span class="p">(</span><span class="n">pll_id</span><span class="p">),</span> <span class="p">(</span><span class="n">m</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">);</span>
	<span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">ADAU1373_PLL_CTRL2</span><span class="p">(</span><span class="n">pll_id</span><span class="p">),</span> <span class="n">m</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">);</span>
	<span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">ADAU1373_PLL_CTRL3</span><span class="p">(</span><span class="n">pll_id</span><span class="p">),</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">);</span>
	<span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">ADAU1373_PLL_CTRL4</span><span class="p">(</span><span class="n">pll_id</span><span class="p">),</span> <span class="n">n</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">);</span>
	<span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">ADAU1373_PLL_CTRL5</span><span class="p">(</span><span class="n">pll_id</span><span class="p">),</span>
		<span class="p">(</span><span class="n">r</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="n">mode</span><span class="p">);</span>

	<span class="cm">/* Set sysclk to pll_rate / 4 */</span>
	<span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">ADAU1373_CLK_SRC_DIV</span><span class="p">(</span><span class="n">pll_id</span><span class="p">),</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">adau1373_load_drc_settings</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nr</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">drc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ADAU1373_DRC_SIZE</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">ADAU1373_DRC</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">drc</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">bool</span> <span class="nf">adau1373_valid_micbias</span><span class="p">(</span><span class="k">enum</span> <span class="n">adau1373_micbias_voltage</span> <span class="n">micbias</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">micbias</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">ADAU1373_MICBIAS_2_9V</span>:
	<span class="k">case</span> <span class="n">ADAU1373_MICBIAS_2_2V</span>:
	<span class="k">case</span> <span class="n">ADAU1373_MICBIAS_2_6V</span>:
	<span class="k">case</span> <span class="n">ADAU1373_MICBIAS_1_8V</span>:
		<span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">adau1373_probe</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">adau1373_platform_data</span> <span class="o">*</span><span class="n">pdata</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">dev</span><span class="o">-&gt;</span><span class="n">platform_data</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">lineout_differential</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">val</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">ret</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="n">ret</span> <span class="o">=</span> <span class="n">snd_soc_codec_set_cache_io</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">SND_SOC_I2C</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">dev_err</span><span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="s">&quot;failed to set cache I/O: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">ret</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">pdata</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">num_drc</span> <span class="o">&gt;</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">drc_setting</span><span class="p">))</span>
			<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>

		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">adau1373_valid_micbias</span><span class="p">(</span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">micbias1</span><span class="p">)</span> <span class="o">||</span>
			<span class="o">!</span><span class="n">adau1373_valid_micbias</span><span class="p">(</span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">micbias2</span><span class="p">))</span>
			<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>

		<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">pdata</span><span class="o">-&gt;</span><span class="n">num_drc</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">adau1373_load_drc_settings</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span>
				<span class="n">pdata</span><span class="o">-&gt;</span><span class="n">drc_setting</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
		<span class="p">}</span>

		<span class="n">snd_soc_add_codec_controls</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">adau1373_drc_controls</span><span class="p">,</span>
			<span class="n">pdata</span><span class="o">-&gt;</span><span class="n">num_drc</span><span class="p">);</span>

		<span class="n">val</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">input_differential</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
				<span class="n">val</span> <span class="o">|=</span> <span class="n">BIT</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">ADAU1373_INPUT_MODE</span><span class="p">,</span> <span class="n">val</span><span class="p">);</span>

		<span class="n">val</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">lineout_differential</span><span class="p">)</span>
			<span class="n">val</span> <span class="o">|=</span> <span class="n">ADAU1373_OUTPUT_CTRL_LDIFF</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">lineout_ground_sense</span><span class="p">)</span>
			<span class="n">val</span> <span class="o">|=</span> <span class="n">ADAU1373_OUTPUT_CTRL_LNFBEN</span><span class="p">;</span>
		<span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">ADAU1373_OUTPUT_CTRL</span><span class="p">,</span> <span class="n">val</span><span class="p">);</span>

		<span class="n">lineout_differential</span> <span class="o">=</span> <span class="n">pdata</span><span class="o">-&gt;</span><span class="n">lineout_differential</span><span class="p">;</span>

		<span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">ADAU1373_EP_CTRL</span><span class="p">,</span>
			<span class="p">(</span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">micbias1</span> <span class="o">&lt;&lt;</span> <span class="n">ADAU1373_EP_CTRL_MICBIAS1_OFFSET</span><span class="p">)</span> <span class="o">|</span>
			<span class="p">(</span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">micbias2</span> <span class="o">&lt;&lt;</span> <span class="n">ADAU1373_EP_CTRL_MICBIAS2_OFFSET</span><span class="p">));</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lineout_differential</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">snd_soc_add_codec_controls</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">adau1373_lineout2_controls</span><span class="p">,</span>
			<span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">adau1373_lineout2_controls</span><span class="p">));</span>
	<span class="p">}</span>

	<span class="n">snd_soc_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">ADAU1373_ADC_CTRL</span><span class="p">,</span>
	    <span class="n">ADAU1373_ADC_CTRL_RESET_FORCE</span> <span class="o">|</span> <span class="n">ADAU1373_ADC_CTRL_PEAK_DETECT</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">adau1373_set_bias_level</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
	<span class="k">enum</span> <span class="n">snd_soc_bias_level</span> <span class="n">level</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">level</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">SND_SOC_BIAS_ON</span>:
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">SND_SOC_BIAS_PREPARE</span>:
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">SND_SOC_BIAS_STANDBY</span>:
		<span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">ADAU1373_PWDN_CTRL3</span><span class="p">,</span>
			<span class="n">ADAU1373_PWDN_CTRL3_PWR_EN</span><span class="p">,</span> <span class="n">ADAU1373_PWDN_CTRL3_PWR_EN</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">SND_SOC_BIAS_OFF</span>:
		<span class="n">snd_soc_update_bits</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">ADAU1373_PWDN_CTRL3</span><span class="p">,</span>
			<span class="n">ADAU1373_PWDN_CTRL3_PWR_EN</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">dapm</span><span class="p">.</span><span class="n">bias_level</span> <span class="o">=</span> <span class="n">level</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">adau1373_remove</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">adau1373_set_bias_level</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">SND_SOC_BIAS_OFF</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">adau1373_suspend</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">adau1373_set_bias_level</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">SND_SOC_BIAS_OFF</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">adau1373_resume</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_soc_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">adau1373_set_bias_level</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">SND_SOC_BIAS_STANDBY</span><span class="p">);</span>
	<span class="n">snd_soc_cache_sync</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">snd_soc_codec_driver</span> <span class="n">adau1373_codec_driver</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">probe</span> <span class="o">=</span>	<span class="n">adau1373_probe</span><span class="p">,</span>
	<span class="p">.</span><span class="n">remove</span> <span class="o">=</span>	<span class="n">adau1373_remove</span><span class="p">,</span>
	<span class="p">.</span><span class="n">suspend</span> <span class="o">=</span>	<span class="n">adau1373_suspend</span><span class="p">,</span>
	<span class="p">.</span><span class="n">resume</span> <span class="o">=</span>	<span class="n">adau1373_resume</span><span class="p">,</span>
	<span class="p">.</span><span class="n">set_bias_level</span> <span class="o">=</span> <span class="n">adau1373_set_bias_level</span><span class="p">,</span>
	<span class="p">.</span><span class="n">idle_bias_off</span> <span class="o">=</span> <span class="nb">true</span><span class="p">,</span>
	<span class="p">.</span><span class="n">reg_cache_size</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">adau1373_default_regs</span><span class="p">),</span>
	<span class="p">.</span><span class="n">reg_cache_default</span> <span class="o">=</span> <span class="n">adau1373_default_regs</span><span class="p">,</span>
	<span class="p">.</span><span class="n">reg_word_size</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">uint8_t</span><span class="p">),</span>

	<span class="p">.</span><span class="n">set_pll</span> <span class="o">=</span> <span class="n">adau1373_set_pll</span><span class="p">,</span>

	<span class="p">.</span><span class="n">controls</span> <span class="o">=</span> <span class="n">adau1373_controls</span><span class="p">,</span>
	<span class="p">.</span><span class="n">num_controls</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">adau1373_controls</span><span class="p">),</span>
	<span class="p">.</span><span class="n">dapm_widgets</span> <span class="o">=</span> <span class="n">adau1373_dapm_widgets</span><span class="p">,</span>
	<span class="p">.</span><span class="n">num_dapm_widgets</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">adau1373_dapm_widgets</span><span class="p">),</span>
	<span class="p">.</span><span class="n">dapm_routes</span> <span class="o">=</span> <span class="n">adau1373_dapm_routes</span><span class="p">,</span>
	<span class="p">.</span><span class="n">num_dapm_routes</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">adau1373_dapm_routes</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="n">__devinit</span> <span class="nf">adau1373_i2c_probe</span><span class="p">(</span><span class="k">struct</span> <span class="n">i2c_client</span> <span class="o">*</span><span class="n">client</span><span class="p">,</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">i2c_device_id</span> <span class="o">*</span><span class="n">id</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">adau1373</span> <span class="o">*</span><span class="n">adau1373</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">ret</span><span class="p">;</span>

	<span class="n">adau1373</span> <span class="o">=</span> <span class="n">devm_kzalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">client</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">adau1373</span><span class="p">),</span> <span class="n">GFP_KERNEL</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">adau1373</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>

	<span class="n">dev_set_drvdata</span><span class="p">(</span><span class="o">&amp;</span><span class="n">client</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="n">adau1373</span><span class="p">);</span>

	<span class="n">ret</span> <span class="o">=</span> <span class="n">snd_soc_register_codec</span><span class="p">(</span><span class="o">&amp;</span><span class="n">client</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">adau1373_codec_driver</span><span class="p">,</span>
			<span class="n">adau1373_dai_driver</span><span class="p">,</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">adau1373_dai_driver</span><span class="p">));</span>
	<span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="n">__devexit</span> <span class="nf">adau1373_i2c_remove</span><span class="p">(</span><span class="k">struct</span> <span class="n">i2c_client</span> <span class="o">*</span><span class="n">client</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">snd_soc_unregister_codec</span><span class="p">(</span><span class="o">&amp;</span><span class="n">client</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">i2c_device_id</span> <span class="n">adau1373_i2c_id</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="s">&quot;adau1373&quot;</span><span class="p">,</span> <span class="mi">0</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">}</span>
<span class="p">};</span>
<span class="n">MODULE_DEVICE_TABLE</span><span class="p">(</span><span class="n">i2c</span><span class="p">,</span> <span class="n">adau1373_i2c_id</span><span class="p">);</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">i2c_driver</span> <span class="n">adau1373_i2c_driver</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">driver</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;adau1373&quot;</span><span class="p">,</span>
		<span class="p">.</span><span class="n">owner</span> <span class="o">=</span> <span class="n">THIS_MODULE</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">.</span><span class="n">probe</span> <span class="o">=</span> <span class="n">adau1373_i2c_probe</span><span class="p">,</span>
	<span class="p">.</span><span class="n">remove</span> <span class="o">=</span> <span class="n">__devexit_p</span><span class="p">(</span><span class="n">adau1373_i2c_remove</span><span class="p">),</span>
	<span class="p">.</span><span class="n">id_table</span> <span class="o">=</span> <span class="n">adau1373_i2c_id</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="n">__init</span> <span class="nf">adau1373_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">i2c_add_driver</span><span class="p">(</span><span class="o">&amp;</span><span class="n">adau1373_i2c_driver</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">module_init</span><span class="p">(</span><span class="n">adau1373_init</span><span class="p">);</span>

<span class="k">static</span> <span class="kt">void</span> <span class="n">__exit</span> <span class="nf">adau1373_exit</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">i2c_del_driver</span><span class="p">(</span><span class="o">&amp;</span><span class="n">adau1373_i2c_driver</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">module_exit</span><span class="p">(</span><span class="n">adau1373_exit</span><span class="p">);</span>

<span class="n">MODULE_DESCRIPTION</span><span class="p">(</span><span class="s">&quot;ASoC ADAU1373 driver&quot;</span><span class="p">);</span>
<span class="n">MODULE_AUTHOR</span><span class="p">(</span><span class="s">&quot;Lars-Peter Clausen &lt;lars@metafoo.de&gt;&quot;</span><span class="p">);</span>
<span class="n">MODULE_LICENSE</span><span class="p">(</span><span class="s">&quot;GPL&quot;</span><span class="p">);</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
