f | seq.c | s | 4.0K | 116 | Paul Gortmaker | paul.gortmaker@windriver.com | 1331490457 |  | device.h: cleanup users outside of linux/include (C files)  For files that are actively using linux/device.h, make sure that they call it out.  This will allow us to clean up some of the implicit uses of linux/device.h within include/* without introducing build regressions.  Yes, this was created by "cheating" -- i.e. the headers were cleaned up, and then the fallout was found and fixed, and then the two commits were reordered.  This ensures we don't introduce build regressions into the git history.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | Makefile | g | 1.2K |  | Jaswinder Singh Rajput | jaswinder@kernel.org | 1248023401 |  | ALSA: OSS sequencer should be initialized after snd_seq_system_client_init  When build SND_SEQUENCER in kernel then OSS sequencer(alsa_seq_oss_init) is initialized before System (snd_seq_system_client_init) which leads to memory leak :  unreferenced object 0xf6b0e680 (size 256):   comm "swapper", pid 1, jiffies 4294670753   backtrace:     [<c108ac5c>] create_object+0x135/0x204     [<c108adfe>] kmemleak_alloc+0x26/0x4c     [<c1087de2>] kmem_cache_alloc+0x72/0xff     [<c126d2ac>] seq_create_client1+0x22/0x160     [<c126e3b6>] snd_seq_create_kernel_client+0x72/0xef     [<c1485a05>] snd_seq_oss_create_client+0x86/0x142     [<c1485920>] alsa_seq_oss_init+0xf6/0x155     [<c1001059>] do_one_initcall+0x4f/0x111     [<c14655be>] kernel_init+0x115/0x166     [<c10032af>] kernel_thread_helper+0x7/0x10     [<ffffffff>] 0xffffffff unreferenced object 0xf688a580 (size 64):   comm "swapper", pid 1, jiffies 4294670753   backtrace:     [<c108ac5c>] create_object+0x135/0x204     [<c108adfe>] kmemleak_alloc+0x26/0x4c     [<c1087de2>] kmem_cache_alloc+0x72/0xff     [<c126f964>] snd_seq_pool_new+0x1c/0xb8     [<c126d311>] seq_create_client1+0x87/0x160     [<c126e3b6>] snd_seq_create_kernel_client+0x72/0xef     [<c1485a05>] snd_seq_oss_create_client+0x86/0x142     [<c1485920>] alsa_seq_oss_init+0xf6/0x155     [<c1001059>] do_one_initcall+0x4f/0x111     [<c14655be>] kernel_init+0x115/0x166     [<c10032af>] kernel_thread_helper+0x7/0x10     [<ffffffff>] 0xffffffff unreferenced object 0xf6b0e480 (size 256):   comm "swapper", pid 1, jiffies 4294670754   backtrace:     [<c108ac5c>] create_object+0x135/0x204     [<c108adfe>] kmemleak_alloc+0x26/0x4c     [<c1087de2>] kmem_cache_alloc+0x72/0xff     [<c12725a0>] snd_seq_create_port+0x51/0x21c     [<c126de50>] snd_seq_ioctl_create_port+0x57/0x13c     [<c126d07a>] snd_seq_do_ioctl+0x4a/0x69     [<c126d0de>] snd_seq_kernel_client_ctl+0x33/0x49     [<c1485a74>] snd_seq_oss_create_client+0xf5/0x142     [<c1485920>] alsa_seq_oss_init+0xf6/0x155     [<c1001059>] do_one_initcall+0x4f/0x111     [<c14655be>] kernel_init+0x115/0x166     [<c10032af>] kernel_thread_helper+0x7/0x10     [<ffffffff>] 0xffffffff  The correct order should be :  System (snd_seq_system_client_init) should be initialized before OSS sequencer(alsa_seq_oss_init) which is equivalent to :  1. insmod sound/core/seq/snd-seq-device.ko 2. insmod sound/core/seq/snd-seq.ko 3. insmod sound/core/seq/snd-seq-midi-event.ko 4. insmod sound/core/seq/oss/snd-seq-oss.ko  Including sound/core/seq/oss/Makefile after other seq modules fixes the ordering and memory leak.  Signed-off-by: Jaswinder Singh Rajput <jaswinderrajput@gmail.com> Signed-off-by: Takashi Iwai <tiwai@suse.de>
f | seq_queue.h | s | 4.4K | 107 | Ingo Molnar | mingo@elte.hu | 1143019490 |  | [ALSA] semaphore -> mutex (core part)  Semaphore to mutex conversion.  The conversion was generated via scripts, and the result was validated automatically via a script as well.  Signed-off-by: Ingo Molnar <mingo@elte.hu> Signed-off-by: Andrew Morton <akpm@osdl.org> Signed-off-by: Takashi Iwai <tiwai@suse.de>
f | seq_ports.h | s | 4.9K | 114 | Takashi Iwai | tiwai@suse.de | 1136287072 |  | [ALSA] Remove xxx_t typedefs: Sequencer  Modules: ALSA sequencer  Remove xxx_t typedefs from the core sequencer codes.  Signed-off-by: Takashi Iwai <tiwai@suse.de>
f | seq_memory.c | s | 12K | 446 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103882 |  | sound: Add export.h for THIS_MODULE/EXPORT_SYMBOL where needed  These aren't modules, but they do make use of these macros, so they will need export.h to get that definition.  Previously, they got it via the implicit module.h inclusion.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | seq_ports.c | s | 18K | 584 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103881 |  | sound: Add module.h to the previously silent sound users  Lots of sound drivers were getting module.h via the implicit presence of it in <linux/device.h> but we are going to clean that up.  So fix up those users now.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | seq_fifo.c | s | 5.9K | 223 | Takashi Iwai | tiwai@suse.de | 1218620795 |  | ALSA: Kill snd_assert() in sound/core/*  Kill snd_assert() in sound/core/*, either removed or replaced with if () with snd_BUG_ON().  Signed-off-by: Takashi Iwai <tiwai@suse.de> Signed-off-by: Jaroslav Kysela <perex@perex.cz>
f | seq_clientmgr.h | s | 2.9K | 84 | Marcin Ślusarz | marcin.slusarz@gmail.com | 1201796975 |  | [ALSA] sound/core/seq: move declarations of globally visible variables to proper headers  sound/core/seq: move declarations of globally visible variables to proper headers  Signed-off-by: Marcin Ślusarz <marcin.slusarz@gmail.com> Signed-off-by: Takashi Iwai <tiwai@suse.de> Signed-off-by: Jaroslav Kysela <perex@perex.cz>
f | seq_clientmgr.c | s | 65K | 2183 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103882 |  | sound: Add export.h for THIS_MODULE/EXPORT_SYMBOL where needed  These aren't modules, but they do make use of these macros, so they will need export.h to get that definition.  Previously, they got it via the implicit module.h inclusion.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | seq_timer.c | s | 10K | 391 | Clemens Ladisch | clemens@ladisch.de | 1263829110 |  | sound: seq_timer: simplify snd_seq_timer_set_tick_resolution() parameters  As snd_seq_timer_set_tick_resolution() is always called with the same three fields of struct snd_seq_timer, it suffices to give that as the only parameter.  Signed-off-by: Clemens Ladisch <clemens@ladisch.de> Signed-off-by: Jaroslav Kysela <perex@perex.cz>
f | seq_info.c | s | 2.0K | 64 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103882 |  | sound: Add export.h for THIS_MODULE/EXPORT_SYMBOL where needed  These aren't modules, but they do make use of these macros, so they will need export.h to get that definition.  Previously, they got it via the implicit module.h inclusion.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | seq_fifo.h | s | 2.2K | 55 | Takashi Iwai | tiwai@suse.de | 1136287072 |  | [ALSA] Remove xxx_t typedefs: Sequencer  Modules: ALSA sequencer  Remove xxx_t typedefs from the core sequencer codes.  Signed-off-by: Takashi Iwai <tiwai@suse.de>
f | seq_system.c | s | 5.3K | 146 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103882 |  | sound: Add export.h for THIS_MODULE/EXPORT_SYMBOL where needed  These aren't modules, but they do make use of these macros, so they will need export.h to get that definition.  Previously, they got it via the implicit module.h inclusion.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | seq_queue.c | s | 19K | 674 | Luca Tettamanti | kronos.it@gmail.com | 1306390744 |  | ALSA: core: remove unused variables.  Drop a few variables that are never read.  Signed-off-by: Luca Tettamanti <kronos.it@gmail.com> Signed-off-by: Takashi Iwai <tiwai@suse.de>
f | seq_lock.c | s | 1.5K | 43 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103882 |  | sound: Add export.h for THIS_MODULE/EXPORT_SYMBOL where needed  These aren't modules, but they do make use of these macros, so they will need export.h to get that definition.  Previously, they got it via the implicit module.h inclusion.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | seq_lock.h | s | 901B | 22 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
d | oss |  | 18 items |  | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103882 |  | sound: Add export.h for THIS_MODULE/EXPORT_SYMBOL where needed  These aren't modules, but they do make use of these macros, so they will need export.h to get that definition.  Previously, they got it via the implicit module.h inclusion.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | seq_device.c | s | 13K | 487 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103881 |  | sound: Add module.h to the previously silent sound users  Lots of sound drivers were getting module.h via the implicit presence of it in <linux/device.h> but we are going to clean that up.  So fix up those users now.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | seq_prioq.h | s | 2.0K | 48 | Takashi Iwai | tiwai@suse.de | 1136287072 |  | [ALSA] Remove xxx_t typedefs: Sequencer  Modules: ALSA sequencer  Remove xxx_t typedefs from the core sequencer codes.  Signed-off-by: Takashi Iwai <tiwai@suse.de>
f | Kconfig | g | 386B |  | Michal Marek | mmarek@suse.cz | 1243590582 |  | ALSA: clean up the logic for building sequencer modules  Instead of mangling the CONFIG_* variables in the makefiles over and over, set a few helper variables in Kconfig.  Signed-off-by: Michal Marek <mmarek@suse.cz> Signed-off-by: Takashi Iwai <tiwai@suse.de>
f | seq_midi.c | s | 14K | 441 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103879 |  | sound: fix drivers needing module.h not moduleparam.h  The implicit presence of module.h lured several users into incorrectly thinking that they only needed/used modparam.h but once we clean up the module.h presence, these will show up as build failures, so fix 'em now.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | seq_midi_emul.c | s | 19K | 665 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103881 |  | sound: Add module.h to the previously silent sound users  Lots of sound drivers were getting module.h via the implicit presence of it in <linux/device.h> but we are going to clean that up.  So fix up those users now.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | seq_virmidi.c | s | 13K | 486 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103881 |  | sound: Add module.h to the previously silent sound users  Lots of sound drivers were getting module.h via the implicit presence of it in <linux/device.h> but we are going to clean that up.  So fix up those users now.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | seq_info.h | s | 1.4K | 35 | Takashi Iwai | tiwai@suse.de | 1136287805 |  | [ALSA] Optimize for config without PROC_FS (seq and oss parts)  Modules: ALSA<-OSS emulation,ALSA sequencer,ALSA<-OSS sequencer  Optimize the code when compiled without CONFIG_PROC_FS (in seq and oss emulation parts).  Signed-off-by: Takashi Iwai <tiwai@suse.de>
f | seq_compat.c | s | 4.6K | 119 | Tejun Heo | tj@kernel.org | 1269954152 |  | include cleanup: Update gfp.h and slab.h includes to prepare for breaking implicit slab.h inclusion from percpu.h  percpu.h is included by sched.h and module.h and thus ends up being included when building most .c files.  percpu.h includes slab.h which in turn includes gfp.h making everything defined by the two files universally available and complicating inclusion dependencies.  percpu.h -> slab.h dependency is about to be removed.  Prepare for this change by updating users of gfp and slab facilities include those headers directly instead of assuming availability.  As this conversion needs to touch large number of source files, the following script is used as the basis of conversion.    http://userweb.kernel.org/~tj/misc/slabh-sweep.py  The script does the followings.  * Scan files for gfp and slab usages and update includes such that   only the necessary includes are there.  ie. if only gfp is used,   gfp.h, if slab is used, slab.h.  * When the script inserts a new include, it looks at the include   blocks and try to put the new include such that its order conforms   to its surrounding.  It's put in the include block which contains   core kernel includes, in the same order that the rest are ordered -   alphabetical, Christmas tree, rev-Xmas-tree or at the end if there   doesn't seem to be any matching order.  * If the script can't find a place to put a new include (mostly   because the file doesn't have fitting include block), it prints out   an error message indicating which .h file needs to be added to the   file.  The conversion was done in the following steps.  1. The initial automatic conversion of all .c files updated slightly    over 4000 files, deleting around 700 includes and adding ~480 gfp.h    and ~3000 slab.h inclusions.  The script emitted errors for ~400    files.  2. Each error was manually checked.  Some didn't need the inclusion,    some needed manual addition while adding it to implementation .h or    embedding .c file was more appropriate for others.  This step added    inclusions to around 150 files.  3. The script was run again and the output was compared to the edits    from #2 to make sure no file was left behind.  4. Several build tests were done and a couple of problems were fixed.    e.g. lib/decompress_*.c used malloc/free() wrappers around slab    APIs requiring slab.h to be added manually.  5. The script was run on all .h files but without automatically    editing them as sprinkling gfp.h and slab.h inclusions around .h    files could easily lead to inclusion dependency hell.  Most gfp.h    inclusion directives were ignored as stuff from gfp.h was usually    wildly available and often used in preprocessor macros.  Each    slab.h inclusion directive was examined and added manually as    necessary.  6. percpu.h was updated not to include slab.h.  7. Build test were done on the following configurations and failures    were fixed.  CONFIG_GCOV_KERNEL was turned off for all tests (as my    distributed build env didn't work with gcov compiles) and a few    more options had to be turned off depending on archs to make things    build (like ipr on powerpc/64 which failed due to missing writeq).     * x86 and x86_64 UP and SMP allmodconfig and a custom test config.    * powerpc and powerpc64 SMP allmodconfig    * sparc and sparc64 SMP allmodconfig    * ia64 SMP allmodconfig    * s390 SMP allmodconfig    * alpha SMP allmodconfig    * um on x86_64 SMP allmodconfig  8. percpu.h modifications were reverted so that it could be applied as    a separate patch and serve as bisection point.  Given the fact that I had only a couple of failures from tests on step 6, I'm fairly confident about the coverage of this conversion patch. If there is a breakage, it's likely to be something in one of the arch headers which should be easily discoverable easily on most builds of the specific arch.  Signed-off-by: Tejun Heo <tj@kernel.org> Guess-its-ok-by: Christoph Lameter <cl@linux-foundation.org> Cc: Ingo Molnar <mingo@redhat.com> Cc: Lee Schermerhorn <Lee.Schermerhorn@hp.com>
f | seq_midi_event.c | s | 15K | 492 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103881 |  | sound: Add module.h to the previously silent sound users  Lots of sound drivers were getting module.h via the implicit presence of it in <linux/device.h> but we are going to clean that up.  So fix up those users now.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | seq_prioq.c | s | 10K | 395 | Takashi Iwai | tiwai@suse.de | 1233846049 |  | ALSA: Add missing KERN_* prefix to printk in sound/core  Signed-off-by: Takashi Iwai <tiwai@suse.de>
f | seq_timer.h | s | 4.6K | 123 | Marcin Ślusarz | marcin.slusarz@gmail.com | 1201796975 |  | [ALSA] sound/core/seq: move declarations of globally visible variables to proper headers  sound/core/seq: move declarations of globally visible variables to proper headers  Signed-off-by: Marcin Ślusarz <marcin.slusarz@gmail.com> Signed-off-by: Takashi Iwai <tiwai@suse.de> Signed-off-by: Jaroslav Kysela <perex@perex.cz>
f | seq_dummy.c | s | 6.6K | 226 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1333148595 |  | Documentation: remove references to /etc/modprobe.conf  Usage of /etc/modprobe.conf file was deprecated by module-init-tools and is no longer parsed by new kmod tool. References to this file are replaced in Documentation, comments and Kconfig according to the context.  There are also some references to the old /etc/modules.conf from 2.4 kernels that are being removed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi> Acked-by: Takashi Iwai <tiwai@suse.de> Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Signed-off-by: Randy Dunlap <rdunlap@xenotime.net> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | seq_memory.h | s | 3.2K | 83 | Clemens Ladisch | clemens@ladisch.de | 1297699811 |  | ALSA: core: sparse cleanups  Change the core code where sparse complains.  In most cases, this means just adding annotations to confirm that we indeed want to do the dirty things we're doing.  Signed-off-by: Clemens Ladisch <clemens@ladisch.de> Signed-off-by: Takashi Iwai <tiwai@suse.de>
f | seq_system.h | s | 2.0K | 37 | Takashi Iwai | tiwai@suse.de | 1136287072 |  | [ALSA] Remove xxx_t typedefs: Sequencer  Modules: ALSA sequencer  Remove xxx_t typedefs from the core sequencer codes.  Signed-off-by: Takashi Iwai <tiwai@suse.de>
