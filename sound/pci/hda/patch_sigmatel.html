<!DOCTYPE html>
<html><head><title>joekychen/linux » sound › pci › hda › patch_sigmatel.c

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>patch_sigmatel.c</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Universal Interface for Intel High Definition Audio Codec</span>
<span class="cm"> *</span>
<span class="cm"> * HD audio interface patch for SigmaTel STAC92xx</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (c) 2005 Embedded Alley Solutions, Inc.</span>
<span class="cm"> * Matt Porter &lt;mporter@embeddedalley.com&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * Based on patch_cmedia.c and patch_realtek.c</span>
<span class="cm"> * Copyright (c) 2004 Takashi Iwai &lt;tiwai@suse.de&gt;</span>
<span class="cm"> *</span>
<span class="cm"> *  This driver is free software; you can redistribute it and/or modify</span>
<span class="cm"> *  it under the terms of the GNU General Public License as published by</span>
<span class="cm"> *  the Free Software Foundation; either version 2 of the License, or</span>
<span class="cm"> *  (at your option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> *  This driver is distributed in the hope that it will be useful,</span>
<span class="cm"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm"> *  GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> *  You should have received a copy of the GNU General Public License</span>
<span class="cm"> *  along with this program; if not, write to the Free Software</span>
<span class="cm"> *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA</span>
<span class="cm"> */</span>

<span class="cp">#include &lt;linux/init.h&gt;</span>
<span class="cp">#include &lt;linux/delay.h&gt;</span>
<span class="cp">#include &lt;linux/slab.h&gt;</span>
<span class="cp">#include &lt;linux/pci.h&gt;</span>
<span class="cp">#include &lt;linux/dmi.h&gt;</span>
<span class="cp">#include &lt;linux/module.h&gt;</span>
<span class="cp">#include &lt;sound/core.h&gt;</span>
<span class="cp">#include &lt;sound/asoundef.h&gt;</span>
<span class="cp">#include &lt;sound/jack.h&gt;</span>
<span class="cp">#include &lt;sound/tlv.h&gt;</span>
<span class="cp">#include &quot;hda_codec.h&quot;</span>
<span class="cp">#include &quot;hda_local.h&quot;</span>
<span class="cp">#include &quot;hda_auto_parser.h&quot;</span>
<span class="cp">#include &quot;hda_beep.h&quot;</span>
<span class="cp">#include &quot;hda_jack.h&quot;</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">STAC_VREF_EVENT</span>	<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">STAC_INSERT_EVENT</span><span class="p">,</span>
	<span class="n">STAC_PWR_EVENT</span><span class="p">,</span>
	<span class="n">STAC_HP_EVENT</span><span class="p">,</span>
	<span class="n">STAC_LO_EVENT</span><span class="p">,</span>
	<span class="n">STAC_MIC_EVENT</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">STAC_AUTO</span><span class="p">,</span>
	<span class="n">STAC_REF</span><span class="p">,</span>
	<span class="n">STAC_9200_OQO</span><span class="p">,</span>
	<span class="n">STAC_9200_DELL_D21</span><span class="p">,</span>
	<span class="n">STAC_9200_DELL_D22</span><span class="p">,</span>
	<span class="n">STAC_9200_DELL_D23</span><span class="p">,</span>
	<span class="n">STAC_9200_DELL_M21</span><span class="p">,</span>
	<span class="n">STAC_9200_DELL_M22</span><span class="p">,</span>
	<span class="n">STAC_9200_DELL_M23</span><span class="p">,</span>
	<span class="n">STAC_9200_DELL_M24</span><span class="p">,</span>
	<span class="n">STAC_9200_DELL_M25</span><span class="p">,</span>
	<span class="n">STAC_9200_DELL_M26</span><span class="p">,</span>
	<span class="n">STAC_9200_DELL_M27</span><span class="p">,</span>
	<span class="n">STAC_9200_M4</span><span class="p">,</span>
	<span class="n">STAC_9200_M4_2</span><span class="p">,</span>
	<span class="n">STAC_9200_PANASONIC</span><span class="p">,</span>
	<span class="n">STAC_9200_MODELS</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">STAC_9205_AUTO</span><span class="p">,</span>
	<span class="n">STAC_9205_REF</span><span class="p">,</span>
	<span class="n">STAC_9205_DELL_M42</span><span class="p">,</span>
	<span class="n">STAC_9205_DELL_M43</span><span class="p">,</span>
	<span class="n">STAC_9205_DELL_M44</span><span class="p">,</span>
	<span class="n">STAC_9205_EAPD</span><span class="p">,</span>
	<span class="n">STAC_9205_MODELS</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">STAC_92HD73XX_AUTO</span><span class="p">,</span>
	<span class="n">STAC_92HD73XX_NO_JD</span><span class="p">,</span> <span class="cm">/* no jack-detection */</span>
	<span class="n">STAC_92HD73XX_REF</span><span class="p">,</span>
	<span class="n">STAC_92HD73XX_INTEL</span><span class="p">,</span>
	<span class="n">STAC_DELL_M6_AMIC</span><span class="p">,</span>
	<span class="n">STAC_DELL_M6_DMIC</span><span class="p">,</span>
	<span class="n">STAC_DELL_M6_BOTH</span><span class="p">,</span>
	<span class="n">STAC_DELL_EQ</span><span class="p">,</span>
	<span class="n">STAC_ALIENWARE_M17X</span><span class="p">,</span>
	<span class="n">STAC_92HD73XX_MODELS</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">STAC_92HD83XXX_AUTO</span><span class="p">,</span>
	<span class="n">STAC_92HD83XXX_REF</span><span class="p">,</span>
	<span class="n">STAC_92HD83XXX_PWR_REF</span><span class="p">,</span>
	<span class="n">STAC_DELL_S14</span><span class="p">,</span>
	<span class="n">STAC_DELL_VOSTRO_3500</span><span class="p">,</span>
	<span class="n">STAC_92HD83XXX_HP_cNB11_INTQUAD</span><span class="p">,</span>
	<span class="n">STAC_HP_DV7_4000</span><span class="p">,</span>
	<span class="n">STAC_HP_ZEPHYR</span><span class="p">,</span>
	<span class="n">STAC_92HD83XXX_MODELS</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">STAC_92HD71BXX_AUTO</span><span class="p">,</span>
	<span class="n">STAC_92HD71BXX_REF</span><span class="p">,</span>
	<span class="n">STAC_DELL_M4_1</span><span class="p">,</span>
	<span class="n">STAC_DELL_M4_2</span><span class="p">,</span>
	<span class="n">STAC_DELL_M4_3</span><span class="p">,</span>
	<span class="n">STAC_HP_M4</span><span class="p">,</span>
	<span class="n">STAC_HP_DV4</span><span class="p">,</span>
	<span class="n">STAC_HP_DV5</span><span class="p">,</span>
	<span class="n">STAC_HP_HDX</span><span class="p">,</span>
	<span class="n">STAC_HP_DV4_1222NR</span><span class="p">,</span>
	<span class="n">STAC_92HD71BXX_MODELS</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">STAC_925x_AUTO</span><span class="p">,</span>
	<span class="n">STAC_925x_REF</span><span class="p">,</span>
	<span class="n">STAC_M1</span><span class="p">,</span>
	<span class="n">STAC_M1_2</span><span class="p">,</span>
	<span class="n">STAC_M2</span><span class="p">,</span>
	<span class="n">STAC_M2_2</span><span class="p">,</span>
	<span class="n">STAC_M3</span><span class="p">,</span>
	<span class="n">STAC_M5</span><span class="p">,</span>
	<span class="n">STAC_M6</span><span class="p">,</span>
	<span class="n">STAC_925x_MODELS</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">STAC_922X_AUTO</span><span class="p">,</span>
	<span class="n">STAC_D945_REF</span><span class="p">,</span>
	<span class="n">STAC_D945GTP3</span><span class="p">,</span>
	<span class="n">STAC_D945GTP5</span><span class="p">,</span>
	<span class="n">STAC_INTEL_MAC_V1</span><span class="p">,</span>
	<span class="n">STAC_INTEL_MAC_V2</span><span class="p">,</span>
	<span class="n">STAC_INTEL_MAC_V3</span><span class="p">,</span>
	<span class="n">STAC_INTEL_MAC_V4</span><span class="p">,</span>
	<span class="n">STAC_INTEL_MAC_V5</span><span class="p">,</span>
	<span class="n">STAC_INTEL_MAC_AUTO</span><span class="p">,</span> <span class="cm">/* This model is selected if no module parameter</span>
<span class="cm">			      * is given, one of the above models will be</span>
<span class="cm">			      * chosen according to the subsystem id. */</span>
	<span class="cm">/* for backward compatibility */</span>
	<span class="n">STAC_MACMINI</span><span class="p">,</span>
	<span class="n">STAC_MACBOOK</span><span class="p">,</span>
	<span class="n">STAC_MACBOOK_PRO_V1</span><span class="p">,</span>
	<span class="n">STAC_MACBOOK_PRO_V2</span><span class="p">,</span>
	<span class="n">STAC_IMAC_INTEL</span><span class="p">,</span>
	<span class="n">STAC_IMAC_INTEL_20</span><span class="p">,</span>
	<span class="n">STAC_ECS_202</span><span class="p">,</span>
	<span class="n">STAC_922X_DELL_D81</span><span class="p">,</span>
	<span class="n">STAC_922X_DELL_D82</span><span class="p">,</span>
	<span class="n">STAC_922X_DELL_M81</span><span class="p">,</span>
	<span class="n">STAC_922X_DELL_M82</span><span class="p">,</span>
	<span class="n">STAC_922X_MODELS</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">STAC_927X_AUTO</span><span class="p">,</span>
	<span class="n">STAC_D965_REF_NO_JD</span><span class="p">,</span> <span class="cm">/* no jack-detection */</span>
	<span class="n">STAC_D965_REF</span><span class="p">,</span>
	<span class="n">STAC_D965_3ST</span><span class="p">,</span>
	<span class="n">STAC_D965_5ST</span><span class="p">,</span>
	<span class="n">STAC_D965_5ST_NO_FP</span><span class="p">,</span>
	<span class="n">STAC_DELL_3ST</span><span class="p">,</span>
	<span class="n">STAC_DELL_BIOS</span><span class="p">,</span>
	<span class="n">STAC_927X_VOLKNOB</span><span class="p">,</span>
	<span class="n">STAC_927X_MODELS</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">STAC_9872_AUTO</span><span class="p">,</span>
	<span class="n">STAC_9872_VAIO</span><span class="p">,</span>
	<span class="n">STAC_9872_MODELS</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">sigmatel_mic_route</span> <span class="p">{</span>
	<span class="n">hda_nid_t</span> <span class="n">pin</span><span class="p">;</span>
	<span class="kt">signed</span> <span class="kt">char</span> <span class="n">mux_idx</span><span class="p">;</span>
	<span class="kt">signed</span> <span class="kt">char</span> <span class="n">dmux_idx</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define MAX_PINS_NUM 16</span>
<span class="cp">#define MAX_ADCS_NUM 4</span>
<span class="cp">#define MAX_DMICS_NUM 4</span>

<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="o">*</span><span class="n">mixers</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">num_mixers</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">board_config</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">eapd_switch</span><span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">surr_switch</span><span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">alt_switch</span><span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">hp_detect</span><span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">spdif_mute</span><span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">check_volume_offset</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">auto_mic</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">linear_tone_beep</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>

	<span class="cm">/* gpio lines */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">eapd_mask</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">gpio_mask</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">gpio_dir</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">gpio_data</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">gpio_mute</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">gpio_led</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">gpio_led_polarity</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">vref_mute_led_nid</span><span class="p">;</span> <span class="cm">/* pin NID for mute-LED vref control */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">vref_led</span><span class="p">;</span>

	<span class="cm">/* stream */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">stream_delay</span><span class="p">;</span>

	<span class="cm">/* analog loopback */</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="o">*</span><span class="n">aloopback_ctl</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">aloopback_mask</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">aloopback_shift</span><span class="p">;</span>

	<span class="cm">/* power management */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">power_map_bits</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">num_pwrs</span><span class="p">;</span>
	<span class="k">const</span> <span class="n">hda_nid_t</span> <span class="o">*</span><span class="n">pwr_nids</span><span class="p">;</span>
	<span class="k">const</span> <span class="n">hda_nid_t</span> <span class="o">*</span><span class="n">dac_list</span><span class="p">;</span>

	<span class="cm">/* playback */</span>
	<span class="k">struct</span> <span class="n">hda_input_mux</span> <span class="o">*</span><span class="n">mono_mux</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cur_mmux</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hda_multi_out</span> <span class="n">multiout</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="n">dac_nids</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
	<span class="n">hda_nid_t</span> <span class="n">hp_dacs</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
	<span class="n">hda_nid_t</span> <span class="n">speaker_dacs</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>

	<span class="kt">int</span> <span class="n">volume_offset</span><span class="p">;</span>

	<span class="cm">/* capture */</span>
	<span class="k">const</span> <span class="n">hda_nid_t</span> <span class="o">*</span><span class="n">adc_nids</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">num_adcs</span><span class="p">;</span>
	<span class="k">const</span> <span class="n">hda_nid_t</span> <span class="o">*</span><span class="n">mux_nids</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">num_muxes</span><span class="p">;</span>
	<span class="k">const</span> <span class="n">hda_nid_t</span> <span class="o">*</span><span class="n">dmic_nids</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">num_dmics</span><span class="p">;</span>
	<span class="k">const</span> <span class="n">hda_nid_t</span> <span class="o">*</span><span class="n">dmux_nids</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">num_dmuxes</span><span class="p">;</span>
	<span class="k">const</span> <span class="n">hda_nid_t</span> <span class="o">*</span><span class="n">smux_nids</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">num_smuxes</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">num_analog_muxes</span><span class="p">;</span>

	<span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="o">*</span><span class="n">capvols</span><span class="p">;</span> <span class="cm">/* amp-volume attr: HDA_COMPOSE_AMP_VAL() */</span>
	<span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="o">*</span><span class="n">capsws</span><span class="p">;</span> <span class="cm">/* amp-mute attr: HDA_COMPOSE_AMP_VAL() */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">num_caps</span><span class="p">;</span> <span class="cm">/* number of capture volume/switch elements */</span>

	<span class="k">struct</span> <span class="n">sigmatel_mic_route</span> <span class="n">ext_mic</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sigmatel_mic_route</span> <span class="n">int_mic</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sigmatel_mic_route</span> <span class="n">dock_mic</span><span class="p">;</span>

	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="k">const</span> <span class="o">*</span><span class="n">spdif_labels</span><span class="p">;</span>

	<span class="n">hda_nid_t</span> <span class="n">dig_in_nid</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="n">mono_nid</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="n">anabeep_nid</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="n">digbeep_nid</span><span class="p">;</span>

	<span class="cm">/* pin widgets */</span>
	<span class="k">const</span> <span class="n">hda_nid_t</span> <span class="o">*</span><span class="n">pin_nids</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">num_pins</span><span class="p">;</span>

	<span class="cm">/* codec specific stuff */</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">hda_verb</span> <span class="o">*</span><span class="n">init</span><span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="o">*</span><span class="n">mixer</span><span class="p">;</span>

	<span class="cm">/* capture source */</span>
	<span class="k">struct</span> <span class="n">hda_input_mux</span> <span class="o">*</span><span class="n">dinput_mux</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cur_dmux</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">hda_input_mux</span> <span class="o">*</span><span class="n">input_mux</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cur_mux</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">hda_input_mux</span> <span class="o">*</span><span class="n">sinput_mux</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cur_smux</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cur_amux</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="o">*</span><span class="n">amp_nids</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">powerdown_adcs</span><span class="p">;</span>

	<span class="cm">/* i/o switches */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">io_switch</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">clfe_swap</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="n">line_switch</span><span class="p">;</span>	<span class="cm">/* shared line-in for input and output */</span>
	<span class="n">hda_nid_t</span> <span class="n">mic_switch</span><span class="p">;</span>	<span class="cm">/* shared mic-in for input and output */</span>
	<span class="n">hda_nid_t</span> <span class="n">hp_switch</span><span class="p">;</span> <span class="cm">/* NID of HP as line-out */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">aloopback</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">hda_pcm</span> <span class="n">pcm_rec</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>	<span class="cm">/* PCM information */</span>

	<span class="cm">/* dynamic controls and input_mux */</span>
	<span class="k">struct</span> <span class="n">auto_pin_cfg</span> <span class="n">autocfg</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">snd_array</span> <span class="n">kctls</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hda_input_mux</span> <span class="n">private_dimux</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hda_input_mux</span> <span class="n">private_imux</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hda_input_mux</span> <span class="n">private_smux</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hda_input_mux</span> <span class="n">private_mono_mux</span><span class="p">;</span>

	<span class="cm">/* auto spec */</span>
	<span class="kt">unsigned</span> <span class="n">auto_pin_cnt</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="n">auto_pin_nids</span><span class="p">[</span><span class="n">MAX_PINS_NUM</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="n">auto_adc_cnt</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="n">auto_adc_nids</span><span class="p">[</span><span class="n">MAX_ADCS_NUM</span><span class="p">];</span>
	<span class="n">hda_nid_t</span> <span class="n">auto_mux_nids</span><span class="p">[</span><span class="n">MAX_ADCS_NUM</span><span class="p">];</span>
	<span class="n">hda_nid_t</span> <span class="n">auto_dmux_nids</span><span class="p">[</span><span class="n">MAX_ADCS_NUM</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">auto_capvols</span><span class="p">[</span><span class="n">MAX_ADCS_NUM</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="n">auto_dmic_cnt</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="n">auto_dmic_nids</span><span class="p">[</span><span class="n">MAX_DMICS_NUM</span><span class="p">];</span>

	<span class="k">struct</span> <span class="n">hda_vmaster_mute_hook</span> <span class="n">vmaster_mute</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define AC_VERB_IDT_SET_POWER_MAP	0x7ec</span>
<span class="cp">#define AC_VERB_IDT_GET_POWER_MAP	0xfec</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac9200_adc_nids</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mh">0x03</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac9200_mux_nids</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mh">0x0c</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac9200_dac_nids</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mh">0x02</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac92hd73xx_pwr_nids</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0x0b</span><span class="p">,</span> <span class="mh">0x0c</span><span class="p">,</span> <span class="mh">0xd</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span>
	<span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x11</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac92hd73xx_slave_dig_outs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x26</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac92hd73xx_adc_nids</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x1a</span><span class="p">,</span> <span class="mh">0x1b</span>
<span class="p">};</span>

<span class="cp">#define STAC92HD73XX_NUM_DMICS	2</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac92hd73xx_dmic_nids</span><span class="p">[</span><span class="n">STAC92HD73XX_NUM_DMICS</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x13</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mi">0</span>
<span class="p">};</span>

<span class="cp">#define STAC92HD73_DAC_COUNT 5</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac92hd73xx_mux_nids</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac92hd73xx_dmux_nids</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac92hd73xx_smux_nids</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define STAC92HD73XX_NUM_CAPS	2</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">stac92hd73xx_capvols</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">HDA_COMPOSE_AMP_VAL</span><span class="p">(</span><span class="mh">0x20</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">),</span>
	<span class="n">HDA_COMPOSE_AMP_VAL</span><span class="p">(</span><span class="mh">0x21</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">),</span>
<span class="p">};</span>
<span class="cp">#define stac92hd73xx_capsws	stac92hd73xx_capvols</span>

<span class="cp">#define STAC92HD83_DAC_COUNT 3</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac92hd83xxx_pwr_nids</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0x0b</span><span class="p">,</span> <span class="mh">0x0c</span><span class="p">,</span> <span class="mh">0xd</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span>
	<span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x10</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac92hd83xxx_slave_dig_outs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x1e</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac92hd83xxx_dmic_nids</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
		<span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac92hd71bxx_pwr_nids</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0x0f</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac92hd71bxx_adc_nids</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac92hd71bxx_mux_nids</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x1a</span><span class="p">,</span> <span class="mh">0x1b</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac92hd71bxx_dmux_nids</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x1c</span><span class="p">,</span> <span class="mh">0x1d</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac92hd71bxx_smux_nids</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x24</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define STAC92HD71BXX_NUM_DMICS	2</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac92hd71bxx_dmic_nids</span><span class="p">[</span><span class="n">STAC92HD71BXX_NUM_DMICS</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x19</span><span class="p">,</span> <span class="mi">0</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac92hd71bxx_dmic_5port_nids</span><span class="p">[</span><span class="n">STAC92HD71BXX_NUM_DMICS</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x18</span><span class="p">,</span> <span class="mi">0</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac92hd71bxx_slave_dig_outs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x22</span><span class="p">,</span> <span class="mi">0</span>
<span class="p">};</span>

<span class="cp">#define STAC92HD71BXX_NUM_CAPS		2</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">stac92hd71bxx_capvols</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">HDA_COMPOSE_AMP_VAL</span><span class="p">(</span><span class="mh">0x1c</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">),</span>
	<span class="n">HDA_COMPOSE_AMP_VAL</span><span class="p">(</span><span class="mh">0x1d</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">),</span>
<span class="p">};</span>
<span class="cp">#define stac92hd71bxx_capsws	stac92hd71bxx_capvols</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac925x_adc_nids</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mh">0x03</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac925x_mux_nids</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mh">0x0f</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac925x_dac_nids</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mh">0x02</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define STAC925X_NUM_DMICS	1</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac925x_dmic_nids</span><span class="p">[</span><span class="n">STAC925X_NUM_DMICS</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x15</span><span class="p">,</span> <span class="mi">0</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac925x_dmux_nids</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x14</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">stac925x_capvols</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">HDA_COMPOSE_AMP_VAL</span><span class="p">(</span><span class="mh">0x09</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">),</span>
<span class="p">};</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">stac925x_capsws</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">HDA_COMPOSE_AMP_VAL</span><span class="p">(</span><span class="mh">0x14</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac922x_adc_nids</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac922x_mux_nids</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define STAC922X_NUM_CAPS	2</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">stac922x_capvols</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">HDA_COMPOSE_AMP_VAL</span><span class="p">(</span><span class="mh">0x17</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_INPUT</span><span class="p">),</span>
	<span class="n">HDA_COMPOSE_AMP_VAL</span><span class="p">(</span><span class="mh">0x18</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_INPUT</span><span class="p">),</span>
<span class="p">};</span>
<span class="cp">#define stac922x_capsws		stac922x_capvols</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac927x_slave_dig_outs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x1f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac927x_adc_nids</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x09</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac927x_mux_nids</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mh">0x15</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x17</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac927x_smux_nids</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x21</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac927x_dac_nids</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mi">0</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac927x_dmux_nids</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x1b</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define STAC927X_NUM_DMICS 2</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac927x_dmic_nids</span><span class="p">[</span><span class="n">STAC927X_NUM_DMICS</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x13</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mi">0</span>
<span class="p">};</span>

<span class="cp">#define STAC927X_NUM_CAPS	3</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">stac927x_capvols</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">HDA_COMPOSE_AMP_VAL</span><span class="p">(</span><span class="mh">0x18</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_INPUT</span><span class="p">),</span>
	<span class="n">HDA_COMPOSE_AMP_VAL</span><span class="p">(</span><span class="mh">0x19</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_INPUT</span><span class="p">),</span>
	<span class="n">HDA_COMPOSE_AMP_VAL</span><span class="p">(</span><span class="mh">0x1a</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_INPUT</span><span class="p">),</span>
<span class="p">};</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">stac927x_capsws</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">HDA_COMPOSE_AMP_VAL</span><span class="p">(</span><span class="mh">0x1b</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">),</span>
	<span class="n">HDA_COMPOSE_AMP_VAL</span><span class="p">(</span><span class="mh">0x1c</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">),</span>
	<span class="n">HDA_COMPOSE_AMP_VAL</span><span class="p">(</span><span class="mh">0x1d</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="k">const</span> <span class="n">stac927x_spdif_labels</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="s">&quot;Digital Playback&quot;</span><span class="p">,</span> <span class="s">&quot;ADAT&quot;</span><span class="p">,</span> <span class="s">&quot;Analog Mux 1&quot;</span><span class="p">,</span>
	<span class="s">&quot;Analog Mux 2&quot;</span><span class="p">,</span> <span class="s">&quot;Analog Mux 3&quot;</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac9205_adc_nids</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x13</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac9205_mux_nids</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mh">0x19</span><span class="p">,</span> <span class="mh">0x1a</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac9205_dmux_nids</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x1d</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac9205_smux_nids</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x21</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define STAC9205_NUM_DMICS	2</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac9205_dmic_nids</span><span class="p">[</span><span class="n">STAC9205_NUM_DMICS</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mh">0x17</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mi">0</span>
<span class="p">};</span>

<span class="cp">#define STAC9205_NUM_CAPS	2</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">stac9205_capvols</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">HDA_COMPOSE_AMP_VAL</span><span class="p">(</span><span class="mh">0x1b</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_INPUT</span><span class="p">),</span>
	<span class="n">HDA_COMPOSE_AMP_VAL</span><span class="p">(</span><span class="mh">0x1c</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_INPUT</span><span class="p">),</span>
<span class="p">};</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">stac9205_capsws</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">HDA_COMPOSE_AMP_VAL</span><span class="p">(</span><span class="mh">0x1d</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">),</span>
	<span class="n">HDA_COMPOSE_AMP_VAL</span><span class="p">(</span><span class="mh">0x1e</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac9200_pin_nids</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span> 
	<span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac925x_pin_nids</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0x0b</span><span class="p">,</span> 
	<span class="mh">0x0c</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac922x_pin_nids</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0x0b</span><span class="p">,</span> <span class="mh">0x0c</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span>
	<span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">,</span> <span class="mh">0x1b</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac92hd73xx_pin_nids</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0x0b</span><span class="p">,</span> <span class="mh">0x0c</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span>
	<span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span>
	<span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x23</span>
<span class="p">};</span>

<span class="cp">#define STAC92HD71BXX_NUM_PINS 13</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac92hd71bxx_pin_nids_4port</span><span class="p">[</span><span class="n">STAC92HD71BXX_NUM_PINS</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0x0b</span><span class="p">,</span> <span class="mh">0x0c</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
	<span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x19</span><span class="p">,</span> <span class="mh">0x1e</span><span class="p">,</span>
	<span class="mh">0x1f</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x27</span>
<span class="p">};</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac92hd71bxx_pin_nids_6port</span><span class="p">[</span><span class="n">STAC92HD71BXX_NUM_PINS</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0x0b</span><span class="p">,</span> <span class="mh">0x0c</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span>
	<span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x19</span><span class="p">,</span> <span class="mh">0x1e</span><span class="p">,</span>
	<span class="mh">0x1f</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x27</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac927x_pin_nids</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0x0b</span><span class="p">,</span> <span class="mh">0x0c</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span>
	<span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span>
	<span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac9205_pin_nids</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0x0b</span><span class="p">,</span> <span class="mh">0x0c</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span>
	<span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x17</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span>
	<span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_dmux_enum_info</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
				   <span class="k">struct</span> <span class="n">snd_ctl_elem_info</span> <span class="o">*</span><span class="n">uinfo</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">snd_hda_input_mux_info</span><span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">dinput_mux</span><span class="p">,</span> <span class="n">uinfo</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_dmux_enum_get</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
				  <span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dmux_idx</span> <span class="o">=</span> <span class="n">snd_ctl_get_ioffidx</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">);</span>

	<span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">enumerated</span><span class="p">.</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">cur_dmux</span><span class="p">[</span><span class="n">dmux_idx</span><span class="p">];</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_dmux_enum_put</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
				  <span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dmux_idx</span> <span class="o">=</span> <span class="n">snd_ctl_get_ioffidx</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">snd_hda_input_mux_put</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dinput_mux</span><span class="p">,</span> <span class="n">ucontrol</span><span class="p">,</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmux_nids</span><span class="p">[</span><span class="n">dmux_idx</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">cur_dmux</span><span class="p">[</span><span class="n">dmux_idx</span><span class="p">]);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_smux_enum_info</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
				   <span class="k">struct</span> <span class="n">snd_ctl_elem_info</span> <span class="o">*</span><span class="n">uinfo</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">snd_hda_input_mux_info</span><span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">sinput_mux</span><span class="p">,</span> <span class="n">uinfo</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_smux_enum_get</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
				  <span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">smux_idx</span> <span class="o">=</span> <span class="n">snd_ctl_get_ioffidx</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">);</span>

	<span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">enumerated</span><span class="p">.</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">cur_smux</span><span class="p">[</span><span class="n">smux_idx</span><span class="p">];</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_smux_enum_put</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
				  <span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hda_input_mux</span> <span class="o">*</span><span class="n">smux</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">private_smux</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">smux_idx</span> <span class="o">=</span> <span class="n">snd_ctl_get_ioffidx</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">err</span><span class="p">,</span> <span class="n">val</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">;</span>

	<span class="n">err</span> <span class="o">=</span> <span class="n">snd_hda_input_mux_put</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">sinput_mux</span><span class="p">,</span> <span class="n">ucontrol</span><span class="p">,</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">smux_nids</span><span class="p">[</span><span class="n">smux_idx</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">cur_smux</span><span class="p">[</span><span class="n">smux_idx</span><span class="p">]);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">spdif_mute</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">smux_idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
			<span class="n">nid</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dig_out_nid</span><span class="p">;</span>
		<span class="k">else</span>
			<span class="n">nid</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">slave_dig_outs</span><span class="p">[</span><span class="n">smux_idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">cur_smux</span><span class="p">[</span><span class="n">smux_idx</span><span class="p">]</span> <span class="o">==</span> <span class="n">smux</span><span class="o">-&gt;</span><span class="n">num_items</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
			<span class="n">val</span> <span class="o">=</span> <span class="n">HDA_AMP_MUTE</span><span class="p">;</span>
		<span class="k">else</span>
			<span class="n">val</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="cm">/* un/mute SPDIF out */</span>
		<span class="n">snd_hda_codec_amp_stereo</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
					 <span class="n">HDA_AMP_MUTE</span><span class="p">,</span> <span class="n">val</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac_vrefout_set</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
					<span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">new_vref</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">error</span><span class="p">,</span> <span class="n">pinctl</span><span class="p">;</span>

	<span class="n">snd_printdd</span><span class="p">(</span><span class="s">&quot;%s, nid %x ctl %x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">new_vref</span><span class="p">);</span>
	<span class="n">pinctl</span> <span class="o">=</span> <span class="n">snd_hda_codec_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
				<span class="n">AC_VERB_GET_PIN_WIDGET_CONTROL</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">pinctl</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">pinctl</span><span class="p">;</span>

	<span class="n">pinctl</span> <span class="o">&amp;=</span> <span class="mh">0xff</span><span class="p">;</span>
	<span class="n">pinctl</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">AC_PINCTL_VREFEN</span><span class="p">;</span>
	<span class="n">pinctl</span> <span class="o">|=</span> <span class="p">(</span><span class="n">new_vref</span> <span class="o">&amp;</span> <span class="n">AC_PINCTL_VREFEN</span><span class="p">);</span>

	<span class="n">error</span> <span class="o">=</span> <span class="n">snd_hda_set_pin_ctl_cache</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">pinctl</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">error</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">error</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">stac92xx_vref_set</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
					<span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">new_vref</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">error</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">pincfg</span><span class="p">;</span>
	<span class="n">pincfg</span> <span class="o">=</span> <span class="n">snd_hda_codec_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
				<span class="n">AC_VERB_GET_PIN_WIDGET_CONTROL</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

	<span class="n">pincfg</span> <span class="o">&amp;=</span> <span class="mh">0xff</span><span class="p">;</span>
	<span class="n">pincfg</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="p">(</span><span class="n">AC_PINCTL_VREFEN</span> <span class="o">|</span> <span class="n">AC_PINCTL_IN_EN</span> <span class="o">|</span> <span class="n">AC_PINCTL_OUT_EN</span><span class="p">);</span>
	<span class="n">pincfg</span> <span class="o">|=</span> <span class="n">new_vref</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">new_vref</span> <span class="o">==</span> <span class="n">AC_PINCTL_VREF_HIZ</span><span class="p">)</span>
		<span class="n">pincfg</span> <span class="o">|=</span> <span class="n">AC_PINCTL_OUT_EN</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="n">pincfg</span> <span class="o">|=</span> <span class="n">AC_PINCTL_IN_EN</span><span class="p">;</span>

	<span class="n">error</span> <span class="o">=</span> <span class="n">snd_hda_set_pin_ctl_cache</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">pincfg</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">error</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">error</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">stac92xx_vref_get</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">vref</span><span class="p">;</span>
	<span class="n">vref</span> <span class="o">=</span> <span class="n">snd_hda_codec_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
				<span class="n">AC_VERB_GET_PIN_WIDGET_CONTROL</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">vref</span> <span class="o">&amp;=</span> <span class="n">AC_PINCTL_VREFEN</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">vref</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_mux_enum_info</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span> <span class="k">struct</span> <span class="n">snd_ctl_elem_info</span> <span class="o">*</span><span class="n">uinfo</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">snd_hda_input_mux_info</span><span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">input_mux</span><span class="p">,</span> <span class="n">uinfo</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_mux_enum_get</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span> <span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">adc_idx</span> <span class="o">=</span> <span class="n">snd_ctl_get_ioffidx</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">);</span>

	<span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">enumerated</span><span class="p">.</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">cur_mux</span><span class="p">[</span><span class="n">adc_idx</span><span class="p">];</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_mux_enum_put</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span> <span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">adc_idx</span> <span class="o">=</span> <span class="n">snd_ctl_get_ioffidx</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">);</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">hda_input_mux</span> <span class="o">*</span><span class="n">imux</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">input_mux</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">idx</span><span class="p">,</span> <span class="n">prev_idx</span><span class="p">,</span> <span class="n">didx</span><span class="p">;</span>

	<span class="n">idx</span> <span class="o">=</span> <span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">enumerated</span><span class="p">.</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">idx</span> <span class="o">&gt;=</span> <span class="n">imux</span><span class="o">-&gt;</span><span class="n">num_items</span><span class="p">)</span>
		<span class="n">idx</span> <span class="o">=</span> <span class="n">imux</span><span class="o">-&gt;</span><span class="n">num_items</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">prev_idx</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">cur_mux</span><span class="p">[</span><span class="n">adc_idx</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">prev_idx</span> <span class="o">==</span> <span class="n">idx</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">idx</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_analog_muxes</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">snd_hda_codec_write_cache</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">mux_nids</span><span class="p">[</span><span class="n">adc_idx</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span>
					  <span class="n">AC_VERB_SET_CONNECT_SEL</span><span class="p">,</span>
					  <span class="n">imux</span><span class="o">-&gt;</span><span class="n">items</span><span class="p">[</span><span class="n">idx</span><span class="p">].</span><span class="n">index</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">prev_idx</span> <span class="o">&gt;=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_analog_muxes</span> <span class="o">&amp;&amp;</span>
		    <span class="n">spec</span><span class="o">-&gt;</span><span class="n">mux_nids</span><span class="p">[</span><span class="n">adc_idx</span><span class="p">]</span> <span class="o">!=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmux_nids</span><span class="p">[</span><span class="n">adc_idx</span><span class="p">])</span> <span class="p">{</span>
			<span class="n">imux</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dinput_mux</span><span class="p">;</span>
			<span class="cm">/* 0 = analog */</span>
			<span class="n">snd_hda_codec_write_cache</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
						  <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmux_nids</span><span class="p">[</span><span class="n">adc_idx</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span>
						  <span class="n">AC_VERB_SET_CONNECT_SEL</span><span class="p">,</span>
						  <span class="n">imux</span><span class="o">-&gt;</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">index</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">imux</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dinput_mux</span><span class="p">;</span>
		<span class="cm">/* first dimux item is hardcoded to select analog imux,</span>
<span class="cm">		 * so lets skip it</span>
<span class="cm">		 */</span>
		<span class="n">didx</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">-</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_analog_muxes</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">snd_hda_codec_write_cache</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmux_nids</span><span class="p">[</span><span class="n">adc_idx</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span>
					  <span class="n">AC_VERB_SET_CONNECT_SEL</span><span class="p">,</span>
					  <span class="n">imux</span><span class="o">-&gt;</span><span class="n">items</span><span class="p">[</span><span class="n">didx</span><span class="p">].</span><span class="n">index</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">cur_mux</span><span class="p">[</span><span class="n">adc_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_mono_mux_enum_info</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
	<span class="k">struct</span> <span class="n">snd_ctl_elem_info</span> <span class="o">*</span><span class="n">uinfo</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">snd_hda_input_mux_info</span><span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">mono_mux</span><span class="p">,</span> <span class="n">uinfo</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_mono_mux_enum_get</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
	<span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>

	<span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">enumerated</span><span class="p">.</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">cur_mmux</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_mono_mux_enum_put</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
	<span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">snd_hda_input_mux_put</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">mono_mux</span><span class="p">,</span> <span class="n">ucontrol</span><span class="p">,</span>
				     <span class="n">spec</span><span class="o">-&gt;</span><span class="n">mono_nid</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">cur_mmux</span><span class="p">);</span>
<span class="p">}</span>

<span class="cp">#define stac92xx_aloopback_info snd_ctl_boolean_mono_info</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_aloopback_get</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
	<span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">snd_ctl_get_ioffidx</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>

	<span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">integer</span><span class="p">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">!!</span><span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">aloopback</span> <span class="o">&amp;</span>
					      <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">aloopback_mask</span> <span class="o">&lt;&lt;</span> <span class="n">idx</span><span class="p">));</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_aloopback_put</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">snd_ctl_get_ioffidx</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">);</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dac_mode</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">val</span><span class="p">,</span> <span class="n">idx_val</span><span class="p">;</span>

	<span class="n">idx_val</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">aloopback_mask</span> <span class="o">&lt;&lt;</span> <span class="n">idx</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">integer</span><span class="p">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
		<span class="n">val</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">aloopback</span> <span class="o">|</span> <span class="n">idx_val</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="n">val</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">aloopback</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">idx_val</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">aloopback</span> <span class="o">==</span> <span class="n">val</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">aloopback</span> <span class="o">=</span> <span class="n">val</span><span class="p">;</span>

	<span class="cm">/* Only return the bits defined by the shift value of the</span>
<span class="cm">	 * first two bytes of the mask</span>
<span class="cm">	 */</span>
	<span class="n">dac_mode</span> <span class="o">=</span> <span class="n">snd_hda_codec_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">afg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
				      <span class="n">kcontrol</span><span class="o">-&gt;</span><span class="n">private_value</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">);</span>
	<span class="n">dac_mode</span> <span class="o">&gt;&gt;=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">aloopback_shift</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">aloopback</span> <span class="o">&amp;</span> <span class="n">idx_val</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">snd_hda_power_up</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
		<span class="n">dac_mode</span> <span class="o">|=</span> <span class="n">idx_val</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">snd_hda_power_down</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
		<span class="n">dac_mode</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">idx_val</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">snd_hda_codec_write_cache</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">afg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
		<span class="n">kcontrol</span><span class="o">-&gt;</span><span class="n">private_value</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">,</span> <span class="n">dac_mode</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hda_verb</span> <span class="n">stac9200_core_init</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* set dac0mux for dac converter */</span>
	<span class="p">{</span> <span class="mh">0x07</span><span class="p">,</span> <span class="n">AC_VERB_SET_CONNECT_SEL</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hda_verb</span> <span class="n">stac9200_eapd_init</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* set dac0mux for dac converter */</span>
	<span class="p">{</span><span class="mh">0x07</span><span class="p">,</span> <span class="n">AC_VERB_SET_CONNECT_SEL</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
	<span class="p">{</span><span class="mh">0x08</span><span class="p">,</span> <span class="n">AC_VERB_SET_EAPD_BTLENABLE</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hda_verb</span> <span class="n">dell_eq_core_init</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* set master volume to max value without distortion</span>
<span class="cm">	 * and direct control */</span>
	<span class="p">{</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="n">AC_VERB_SET_VOLUME_KNOB_CONTROL</span><span class="p">,</span> <span class="mh">0xec</span><span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hda_verb</span> <span class="n">stac92hd73xx_core_init</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* set master volume and direct control */</span>
	<span class="p">{</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="n">AC_VERB_SET_VOLUME_KNOB_CONTROL</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hda_verb</span> <span class="n">stac92hd83xxx_core_init</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* power state controls amps */</span>
	<span class="p">{</span> <span class="mh">0x01</span><span class="p">,</span> <span class="n">AC_VERB_SET_EAPD</span><span class="p">,</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hda_verb</span> <span class="n">stac92hd83xxx_hp_zephyr_init</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x785</span><span class="p">,</span> <span class="mh">0x43</span> <span class="p">},</span>
	<span class="p">{</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x782</span><span class="p">,</span> <span class="mh">0xe0</span> <span class="p">},</span>
	<span class="p">{</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x795</span><span class="p">,</span> <span class="mh">0x00</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hda_verb</span> <span class="n">stac92hd71bxx_core_init</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* set master volume and direct control */</span>
	<span class="p">{</span> <span class="mh">0x28</span><span class="p">,</span> <span class="n">AC_VERB_SET_VOLUME_KNOB_CONTROL</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hda_verb</span> <span class="n">stac92hd71bxx_unmute_core_init</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* unmute right and left channels for nodes 0x0f, 0xa, 0x0d */</span>
	<span class="p">{</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="n">AC_VERB_SET_AMP_GAIN_MUTE</span><span class="p">,</span> <span class="n">AMP_IN_UNMUTE</span><span class="p">(</span><span class="mi">0</span><span class="p">)},</span>
	<span class="p">{</span> <span class="mh">0x0a</span><span class="p">,</span> <span class="n">AC_VERB_SET_AMP_GAIN_MUTE</span><span class="p">,</span> <span class="n">AMP_IN_UNMUTE</span><span class="p">(</span><span class="mi">0</span><span class="p">)},</span>
	<span class="p">{</span> <span class="mh">0x0d</span><span class="p">,</span> <span class="n">AC_VERB_SET_AMP_GAIN_MUTE</span><span class="p">,</span> <span class="n">AMP_IN_UNMUTE</span><span class="p">(</span><span class="mi">0</span><span class="p">)},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hda_verb</span> <span class="n">stac925x_core_init</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* set dac0mux for dac converter */</span>
	<span class="p">{</span> <span class="mh">0x06</span><span class="p">,</span> <span class="n">AC_VERB_SET_CONNECT_SEL</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">},</span>
	<span class="cm">/* mute the master volume */</span>
	<span class="p">{</span> <span class="mh">0x0e</span><span class="p">,</span> <span class="n">AC_VERB_SET_AMP_GAIN_MUTE</span><span class="p">,</span> <span class="n">AMP_OUT_MUTE</span> <span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hda_verb</span> <span class="n">stac922x_core_init</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* set master volume and direct control */</span>	
	<span class="p">{</span> <span class="mh">0x16</span><span class="p">,</span> <span class="n">AC_VERB_SET_VOLUME_KNOB_CONTROL</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hda_verb</span> <span class="n">d965_core_init</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* set master volume and direct control */</span>	
	<span class="p">{</span> <span class="mh">0x24</span><span class="p">,</span> <span class="n">AC_VERB_SET_VOLUME_KNOB_CONTROL</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
	<span class="cm">/* unmute node 0x1b */</span>
	<span class="p">{</span> <span class="mh">0x1b</span><span class="p">,</span> <span class="n">AC_VERB_SET_AMP_GAIN_MUTE</span><span class="p">,</span> <span class="mh">0xb000</span><span class="p">},</span>
	<span class="cm">/* select node 0x03 as DAC */</span>	
	<span class="p">{</span> <span class="mh">0x0b</span><span class="p">,</span> <span class="n">AC_VERB_SET_CONNECT_SEL</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hda_verb</span> <span class="n">dell_3st_core_init</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* don&#39;t set delta bit */</span>
	<span class="p">{</span><span class="mh">0x24</span><span class="p">,</span> <span class="n">AC_VERB_SET_VOLUME_KNOB_CONTROL</span><span class="p">,</span> <span class="mh">0x7f</span><span class="p">},</span>
	<span class="cm">/* unmute node 0x1b */</span>
	<span class="p">{</span><span class="mh">0x1b</span><span class="p">,</span> <span class="n">AC_VERB_SET_AMP_GAIN_MUTE</span><span class="p">,</span> <span class="mh">0xb000</span><span class="p">},</span>
	<span class="cm">/* select node 0x03 as DAC */</span>
	<span class="p">{</span><span class="mh">0x0b</span><span class="p">,</span> <span class="n">AC_VERB_SET_CONNECT_SEL</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hda_verb</span> <span class="n">stac927x_core_init</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* set master volume and direct control */</span>	
	<span class="p">{</span> <span class="mh">0x24</span><span class="p">,</span> <span class="n">AC_VERB_SET_VOLUME_KNOB_CONTROL</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
	<span class="cm">/* enable analog pc beep path */</span>
	<span class="p">{</span> <span class="mh">0x01</span><span class="p">,</span> <span class="n">AC_VERB_SET_DIGI_CONVERT_2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hda_verb</span> <span class="n">stac927x_volknob_core_init</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* don&#39;t set delta bit */</span>
	<span class="p">{</span><span class="mh">0x24</span><span class="p">,</span> <span class="n">AC_VERB_SET_VOLUME_KNOB_CONTROL</span><span class="p">,</span> <span class="mh">0x7f</span><span class="p">},</span>
	<span class="cm">/* enable analog pc beep path */</span>
	<span class="p">{</span><span class="mh">0x01</span><span class="p">,</span> <span class="n">AC_VERB_SET_DIGI_CONVERT_2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hda_verb</span> <span class="n">stac9205_core_init</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* set master volume and direct control */</span>	
	<span class="p">{</span> <span class="mh">0x24</span><span class="p">,</span> <span class="n">AC_VERB_SET_VOLUME_KNOB_CONTROL</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">},</span>
	<span class="cm">/* enable analog pc beep path */</span>
	<span class="p">{</span> <span class="mh">0x01</span><span class="p">,</span> <span class="n">AC_VERB_SET_DIGI_CONVERT_2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">},</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="cp">#define STAC_MONO_MUX \</span>
<span class="cp">	{ \</span>
<span class="cp">		.iface = SNDRV_CTL_ELEM_IFACE_MIXER, \</span>
<span class="cp">		.name = &quot;Mono Mux&quot;, \</span>
<span class="cp">		.count = 1, \</span>
<span class="cp">		.info = stac92xx_mono_mux_enum_info, \</span>
<span class="cp">		.get = stac92xx_mono_mux_enum_get, \</span>
<span class="cp">		.put = stac92xx_mono_mux_enum_put, \</span>
<span class="cp">	}</span>

<span class="cp">#define STAC_ANALOG_LOOPBACK(verb_read, verb_write, cnt) \</span>
<span class="cp">	{ \</span>
<span class="cp">		.iface = SNDRV_CTL_ELEM_IFACE_MIXER, \</span>
<span class="cp">		.name  = &quot;Analog Loopback&quot;, \</span>
<span class="cp">		.count = cnt, \</span>
<span class="cp">		.info  = stac92xx_aloopback_info, \</span>
<span class="cp">		.get   = stac92xx_aloopback_get, \</span>
<span class="cp">		.put   = stac92xx_aloopback_put, \</span>
<span class="cp">		.private_value = verb_read | (verb_write &lt;&lt; 16), \</span>
<span class="cp">	}</span>

<span class="cp">#define DC_BIAS(xname, idx, nid) \</span>
<span class="cp">	{ \</span>
<span class="cp">		.iface = SNDRV_CTL_ELEM_IFACE_MIXER, \</span>
<span class="cp">		.name = xname, \</span>
<span class="cp">		.index = idx, \</span>
<span class="cp">		.info = stac92xx_dc_bias_info, \</span>
<span class="cp">		.get = stac92xx_dc_bias_get, \</span>
<span class="cp">		.put = stac92xx_dc_bias_put, \</span>
<span class="cp">		.private_value = nid, \</span>
<span class="cp">	}</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">stac9200_mixer</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">HDA_CODEC_VOLUME_MIN_MUTE</span><span class="p">(</span><span class="s">&quot;PCM Playback Volume&quot;</span><span class="p">,</span> <span class="mh">0xb</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">),</span>
	<span class="n">HDA_CODEC_MUTE</span><span class="p">(</span><span class="s">&quot;PCM Playback Switch&quot;</span><span class="p">,</span> <span class="mh">0xb</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">),</span>
	<span class="n">HDA_CODEC_VOLUME</span><span class="p">(</span><span class="s">&quot;Capture Volume&quot;</span><span class="p">,</span> <span class="mh">0x0a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">),</span>
	<span class="n">HDA_CODEC_MUTE</span><span class="p">(</span><span class="s">&quot;Capture Switch&quot;</span><span class="p">,</span> <span class="mh">0x0a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">),</span>
	<span class="p">{</span> <span class="p">}</span> <span class="cm">/* end */</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">stac92hd73xx_6ch_loopback</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">STAC_ANALOG_LOOPBACK</span><span class="p">(</span><span class="mh">0xFA0</span><span class="p">,</span> <span class="mh">0x7A1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">stac92hd73xx_8ch_loopback</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">STAC_ANALOG_LOOPBACK</span><span class="p">(</span><span class="mh">0xFA0</span><span class="p">,</span> <span class="mh">0x7A1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">stac92hd73xx_10ch_loopback</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">STAC_ANALOG_LOOPBACK</span><span class="p">(</span><span class="mh">0xFA0</span><span class="p">,</span> <span class="mh">0x7A1</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
	<span class="p">{}</span>
<span class="p">};</span>


<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">stac92hd71bxx_loopback</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">STAC_ANALOG_LOOPBACK</span><span class="p">(</span><span class="mh">0xFA0</span><span class="p">,</span> <span class="mh">0x7A0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">stac925x_mixer</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">HDA_CODEC_VOLUME_MIN_MUTE</span><span class="p">(</span><span class="s">&quot;PCM Playback Volume&quot;</span><span class="p">,</span> <span class="mh">0xe</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">),</span>
	<span class="n">HDA_CODEC_MUTE</span><span class="p">(</span><span class="s">&quot;PCM Playback Switch&quot;</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">),</span>
	<span class="p">{</span> <span class="p">}</span> <span class="cm">/* end */</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">stac9205_loopback</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">STAC_ANALOG_LOOPBACK</span><span class="p">(</span><span class="mh">0xFE0</span><span class="p">,</span> <span class="mh">0x7E0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">stac927x_loopback</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">STAC_ANALOG_LOOPBACK</span><span class="p">(</span><span class="mh">0xFEB</span><span class="p">,</span> <span class="mh">0x7EB</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">stac_dmux_mixer</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">iface</span> <span class="o">=</span> <span class="n">SNDRV_CTL_ELEM_IFACE_MIXER</span><span class="p">,</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Digital Input Source&quot;</span><span class="p">,</span>
	<span class="cm">/* count set later */</span>
	<span class="p">.</span><span class="n">info</span> <span class="o">=</span> <span class="n">stac92xx_dmux_enum_info</span><span class="p">,</span>
	<span class="p">.</span><span class="n">get</span> <span class="o">=</span> <span class="n">stac92xx_dmux_enum_get</span><span class="p">,</span>
	<span class="p">.</span><span class="n">put</span> <span class="o">=</span> <span class="n">stac92xx_dmux_enum_put</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">stac_smux_mixer</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">iface</span> <span class="o">=</span> <span class="n">SNDRV_CTL_ELEM_IFACE_MIXER</span><span class="p">,</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;IEC958 Playback Source&quot;</span><span class="p">,</span>
	<span class="cm">/* count set later */</span>
	<span class="p">.</span><span class="n">info</span> <span class="o">=</span> <span class="n">stac92xx_smux_enum_info</span><span class="p">,</span>
	<span class="p">.</span><span class="n">get</span> <span class="o">=</span> <span class="n">stac92xx_smux_enum_get</span><span class="p">,</span>
	<span class="p">.</span><span class="n">put</span> <span class="o">=</span> <span class="n">stac92xx_smux_enum_put</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="k">const</span> <span class="n">slave_pfxs</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="s">&quot;Front&quot;</span><span class="p">,</span> <span class="s">&quot;Surround&quot;</span><span class="p">,</span> <span class="s">&quot;Center&quot;</span><span class="p">,</span> <span class="s">&quot;LFE&quot;</span><span class="p">,</span> <span class="s">&quot;Side&quot;</span><span class="p">,</span>
	<span class="s">&quot;Headphone&quot;</span><span class="p">,</span> <span class="s">&quot;Speaker&quot;</span><span class="p">,</span> <span class="s">&quot;IEC958&quot;</span><span class="p">,</span>
	<span class="nb">NULL</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">void</span> <span class="n">stac92xx_update_led_status</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="kt">int</span> <span class="n">enabled</span><span class="p">);</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac92xx_vmaster_hook</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">private_data</span><span class="p">,</span> <span class="kt">int</span> <span class="n">val</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">stac92xx_update_led_status</span><span class="p">(</span><span class="n">private_data</span><span class="p">,</span> <span class="n">val</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="n">stac92xx_free_kctls</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">);</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_build_controls</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">vmaster_tlv</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">err</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">mixer</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">snd_hda_add_new_ctls</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">mixer</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_mixers</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">snd_hda_add_new_ctls</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">mixers</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_mic</span> <span class="o">&amp;&amp;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmuxes</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span>
	    <span class="n">snd_hda_get_bool_hint</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="s">&quot;separate_dmux&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">stac_dmux_mixer</span><span class="p">.</span><span class="n">count</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmuxes</span><span class="p">;</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">snd_hda_ctl_add</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
				  <span class="n">snd_ctl_new1</span><span class="p">(</span><span class="o">&amp;</span><span class="n">stac_dmux_mixer</span><span class="p">,</span> <span class="n">codec</span><span class="p">));</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_smuxes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="kt">int</span> <span class="n">wcaps</span> <span class="o">=</span> <span class="n">get_wcaps</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dig_out_nid</span><span class="p">);</span>
		<span class="k">struct</span> <span class="n">hda_input_mux</span> <span class="o">*</span><span class="n">smux</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">private_smux</span><span class="p">;</span>
		<span class="cm">/* check for mute support on SPDIF out */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">wcaps</span> <span class="o">&amp;</span> <span class="n">AC_WCAP_OUT_AMP</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">snd_hda_add_imux_item</span><span class="p">(</span><span class="n">smux</span><span class="p">,</span> <span class="s">&quot;Off&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">spdif_mute</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">stac_smux_mixer</span><span class="p">.</span><span class="n">count</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_smuxes</span><span class="p">;</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">snd_hda_ctl_add</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
				  <span class="n">snd_ctl_new1</span><span class="p">(</span><span class="o">&amp;</span><span class="n">stac_smux_mixer</span><span class="p">,</span> <span class="n">codec</span><span class="p">));</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dig_out_nid</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">snd_hda_create_spdif_out_ctls</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
						    <span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dig_out_nid</span><span class="p">,</span>
						    <span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dig_out_nid</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">snd_hda_create_spdif_share_sw</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
						    <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">share_spdif</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">dig_in_nid</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_dir</span> <span class="o">&amp;</span> <span class="mh">0x01</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">snd_hda_create_spdif_in_ctls</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dig_in_nid</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="cm">/* if we have no master control, let&#39;s create it */</span>
	<span class="n">snd_hda_set_vmaster_tlv</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dac_nids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
				<span class="n">HDA_OUTPUT</span><span class="p">,</span> <span class="n">vmaster_tlv</span><span class="p">);</span>
	<span class="cm">/* correct volume offset */</span>
	<span class="n">vmaster_tlv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">vmaster_tlv</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">volume_offset</span><span class="p">;</span>
	<span class="cm">/* minimum value is actually mute */</span>
	<span class="n">vmaster_tlv</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">|=</span> <span class="n">TLV_DB_SCALE_MUTE</span><span class="p">;</span>
	<span class="n">err</span> <span class="o">=</span> <span class="n">snd_hda_add_vmaster</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="s">&quot;Master Playback Volume&quot;</span><span class="p">,</span>
				  <span class="n">vmaster_tlv</span><span class="p">,</span> <span class="n">slave_pfxs</span><span class="p">,</span>
				  <span class="s">&quot;Playback Volume&quot;</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>

	<span class="n">err</span> <span class="o">=</span> <span class="n">__snd_hda_add_vmaster</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="s">&quot;Master Playback Switch&quot;</span><span class="p">,</span>
				    <span class="nb">NULL</span><span class="p">,</span> <span class="n">slave_pfxs</span><span class="p">,</span>
				    <span class="s">&quot;Playback Switch&quot;</span><span class="p">,</span> <span class="nb">true</span><span class="p">,</span>
				    <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">vmaster_mute</span><span class="p">.</span><span class="n">sw_kctl</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">vmaster_mute</span><span class="p">.</span><span class="n">hook</span> <span class="o">=</span> <span class="n">stac92xx_vmaster_hook</span><span class="p">;</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">snd_hda_add_vmaster_hook</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">vmaster_mute</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">aloopback_ctl</span> <span class="o">&amp;&amp;</span>
	    <span class="n">snd_hda_get_bool_hint</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="s">&quot;loopback&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">snd_hda_add_new_ctls</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">aloopback_ctl</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">stac92xx_free_kctls</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span> <span class="cm">/* no longer needed */</span>

	<span class="n">err</span> <span class="o">=</span> <span class="n">snd_hda_jack_add_kctls</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>	
<span class="p">}</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ref9200_pin_configs</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x01c47010</span><span class="p">,</span> <span class="mh">0x01447010</span><span class="p">,</span> <span class="mh">0x0221401f</span><span class="p">,</span> <span class="mh">0x01114010</span><span class="p">,</span>
	<span class="mh">0x02a19020</span><span class="p">,</span> <span class="mh">0x01a19021</span><span class="p">,</span> <span class="mh">0x90100140</span><span class="p">,</span> <span class="mh">0x01813122</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">gateway9200_m4_pin_configs</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x400000fe</span><span class="p">,</span> <span class="mh">0x404500f4</span><span class="p">,</span> <span class="mh">0x400100f0</span><span class="p">,</span> <span class="mh">0x90110010</span><span class="p">,</span>
	<span class="mh">0x400100f1</span><span class="p">,</span> <span class="mh">0x02a1902e</span><span class="p">,</span> <span class="mh">0x500000f2</span><span class="p">,</span> <span class="mh">0x500000f3</span><span class="p">,</span>
<span class="p">};</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">gateway9200_m4_2_pin_configs</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x400000fe</span><span class="p">,</span> <span class="mh">0x404500f4</span><span class="p">,</span> <span class="mh">0x400100f0</span><span class="p">,</span> <span class="mh">0x90110010</span><span class="p">,</span>
	<span class="mh">0x400100f1</span><span class="p">,</span> <span class="mh">0x02a1902e</span><span class="p">,</span> <span class="mh">0x500000f2</span><span class="p">,</span> <span class="mh">0x500000f3</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm">    STAC 9200 pin configs for</span>
<span class="cm">    102801A8</span>
<span class="cm">    102801DE</span>
<span class="cm">    102801E8</span>
<span class="cm">*/</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dell9200_d21_pin_configs</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x400001f0</span><span class="p">,</span> <span class="mh">0x400001f1</span><span class="p">,</span> <span class="mh">0x02214030</span><span class="p">,</span> <span class="mh">0x01014010</span><span class="p">,</span> 
	<span class="mh">0x02a19020</span><span class="p">,</span> <span class="mh">0x01a19021</span><span class="p">,</span> <span class="mh">0x90100140</span><span class="p">,</span> <span class="mh">0x01813122</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* </span>
<span class="cm">    STAC 9200 pin configs for</span>
<span class="cm">    102801C0</span>
<span class="cm">    102801C1</span>
<span class="cm">*/</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dell9200_d22_pin_configs</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x400001f0</span><span class="p">,</span> <span class="mh">0x400001f1</span><span class="p">,</span> <span class="mh">0x0221401f</span><span class="p">,</span> <span class="mh">0x01014010</span><span class="p">,</span> 
	<span class="mh">0x01813020</span><span class="p">,</span> <span class="mh">0x02a19021</span><span class="p">,</span> <span class="mh">0x90100140</span><span class="p">,</span> <span class="mh">0x400001f2</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* </span>
<span class="cm">    STAC 9200 pin configs for</span>
<span class="cm">    102801C4 (Dell Dimension E310)</span>
<span class="cm">    102801C5</span>
<span class="cm">    102801C7</span>
<span class="cm">    102801D9</span>
<span class="cm">    102801DA</span>
<span class="cm">    102801E3</span>
<span class="cm">*/</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dell9200_d23_pin_configs</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x400001f0</span><span class="p">,</span> <span class="mh">0x400001f1</span><span class="p">,</span> <span class="mh">0x0221401f</span><span class="p">,</span> <span class="mh">0x01014010</span><span class="p">,</span> 
	<span class="mh">0x01813020</span><span class="p">,</span> <span class="mh">0x01a19021</span><span class="p">,</span> <span class="mh">0x90100140</span><span class="p">,</span> <span class="mh">0x400001f2</span><span class="p">,</span> 
<span class="p">};</span>


<span class="cm">/* </span>
<span class="cm">    STAC 9200-32 pin configs for</span>
<span class="cm">    102801B5 (Dell Inspiron 630m)</span>
<span class="cm">    102801D8 (Dell Inspiron 640m)</span>
<span class="cm">*/</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dell9200_m21_pin_configs</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x40c003fa</span><span class="p">,</span> <span class="mh">0x03441340</span><span class="p">,</span> <span class="mh">0x0321121f</span><span class="p">,</span> <span class="mh">0x90170310</span><span class="p">,</span>
	<span class="mh">0x408003fb</span><span class="p">,</span> <span class="mh">0x03a11020</span><span class="p">,</span> <span class="mh">0x401003fc</span><span class="p">,</span> <span class="mh">0x403003fd</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* </span>
<span class="cm">    STAC 9200-32 pin configs for</span>
<span class="cm">    102801C2 (Dell Latitude D620)</span>
<span class="cm">    102801C8 </span>
<span class="cm">    102801CC (Dell Latitude D820)</span>
<span class="cm">    102801D4 </span>
<span class="cm">    102801D6 </span>
<span class="cm">*/</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dell9200_m22_pin_configs</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x40c003fa</span><span class="p">,</span> <span class="mh">0x0144131f</span><span class="p">,</span> <span class="mh">0x0321121f</span><span class="p">,</span> <span class="mh">0x90170310</span><span class="p">,</span> 
	<span class="mh">0x90a70321</span><span class="p">,</span> <span class="mh">0x03a11020</span><span class="p">,</span> <span class="mh">0x401003fb</span><span class="p">,</span> <span class="mh">0x40f000fc</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* </span>
<span class="cm">    STAC 9200-32 pin configs for</span>
<span class="cm">    102801CE (Dell XPS M1710)</span>
<span class="cm">    102801CF (Dell Precision M90)</span>
<span class="cm">*/</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dell9200_m23_pin_configs</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x40c003fa</span><span class="p">,</span> <span class="mh">0x01441340</span><span class="p">,</span> <span class="mh">0x0421421f</span><span class="p">,</span> <span class="mh">0x90170310</span><span class="p">,</span>
	<span class="mh">0x408003fb</span><span class="p">,</span> <span class="mh">0x04a1102e</span><span class="p">,</span> <span class="mh">0x90170311</span><span class="p">,</span> <span class="mh">0x403003fc</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm">    STAC 9200-32 pin configs for </span>
<span class="cm">    102801C9</span>
<span class="cm">    102801CA</span>
<span class="cm">    102801CB (Dell Latitude 120L)</span>
<span class="cm">    102801D3</span>
<span class="cm">*/</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dell9200_m24_pin_configs</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x40c003fa</span><span class="p">,</span> <span class="mh">0x404003fb</span><span class="p">,</span> <span class="mh">0x0321121f</span><span class="p">,</span> <span class="mh">0x90170310</span><span class="p">,</span> 
	<span class="mh">0x408003fc</span><span class="p">,</span> <span class="mh">0x03a11020</span><span class="p">,</span> <span class="mh">0x401003fd</span><span class="p">,</span> <span class="mh">0x403003fe</span><span class="p">,</span> 
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm">    STAC 9200-32 pin configs for</span>
<span class="cm">    102801BD (Dell Inspiron E1505n)</span>
<span class="cm">    102801EE</span>
<span class="cm">    102801EF</span>
<span class="cm">*/</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dell9200_m25_pin_configs</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x40c003fa</span><span class="p">,</span> <span class="mh">0x01441340</span><span class="p">,</span> <span class="mh">0x0421121f</span><span class="p">,</span> <span class="mh">0x90170310</span><span class="p">,</span> 
	<span class="mh">0x408003fb</span><span class="p">,</span> <span class="mh">0x04a11020</span><span class="p">,</span> <span class="mh">0x401003fc</span><span class="p">,</span> <span class="mh">0x403003fd</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm">    STAC 9200-32 pin configs for</span>
<span class="cm">    102801F5 (Dell Inspiron 1501)</span>
<span class="cm">    102801F6</span>
<span class="cm">*/</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dell9200_m26_pin_configs</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x40c003fa</span><span class="p">,</span> <span class="mh">0x404003fb</span><span class="p">,</span> <span class="mh">0x0421121f</span><span class="p">,</span> <span class="mh">0x90170310</span><span class="p">,</span> 
	<span class="mh">0x408003fc</span><span class="p">,</span> <span class="mh">0x04a11020</span><span class="p">,</span> <span class="mh">0x401003fd</span><span class="p">,</span> <span class="mh">0x403003fe</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm">    STAC 9200-32</span>
<span class="cm">    102801CD (Dell Inspiron E1705/9400)</span>
<span class="cm">*/</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dell9200_m27_pin_configs</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x40c003fa</span><span class="p">,</span> <span class="mh">0x01441340</span><span class="p">,</span> <span class="mh">0x0421121f</span><span class="p">,</span> <span class="mh">0x90170310</span><span class="p">,</span>
	<span class="mh">0x90170310</span><span class="p">,</span> <span class="mh">0x04a11020</span><span class="p">,</span> <span class="mh">0x90170310</span><span class="p">,</span> <span class="mh">0x40f003fc</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">oqo9200_pin_configs</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x40c000f0</span><span class="p">,</span> <span class="mh">0x404000f1</span><span class="p">,</span> <span class="mh">0x0221121f</span><span class="p">,</span> <span class="mh">0x02211210</span><span class="p">,</span>
	<span class="mh">0x90170111</span><span class="p">,</span> <span class="mh">0x90a70120</span><span class="p">,</span> <span class="mh">0x400000f2</span><span class="p">,</span> <span class="mh">0x400000f3</span><span class="p">,</span>
<span class="p">};</span>


<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">stac9200_brd_tbl</span><span class="p">[</span><span class="n">STAC_9200_MODELS</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">[</span><span class="n">STAC_REF</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref9200_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_OQO</span><span class="p">]</span> <span class="o">=</span> <span class="n">oqo9200_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_DELL_D21</span><span class="p">]</span> <span class="o">=</span> <span class="n">dell9200_d21_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_DELL_D22</span><span class="p">]</span> <span class="o">=</span> <span class="n">dell9200_d22_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_DELL_D23</span><span class="p">]</span> <span class="o">=</span> <span class="n">dell9200_d23_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_DELL_M21</span><span class="p">]</span> <span class="o">=</span> <span class="n">dell9200_m21_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_DELL_M22</span><span class="p">]</span> <span class="o">=</span> <span class="n">dell9200_m22_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_DELL_M23</span><span class="p">]</span> <span class="o">=</span> <span class="n">dell9200_m23_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_DELL_M24</span><span class="p">]</span> <span class="o">=</span> <span class="n">dell9200_m24_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_DELL_M25</span><span class="p">]</span> <span class="o">=</span> <span class="n">dell9200_m25_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_DELL_M26</span><span class="p">]</span> <span class="o">=</span> <span class="n">dell9200_m26_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_DELL_M27</span><span class="p">]</span> <span class="o">=</span> <span class="n">dell9200_m27_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_M4</span><span class="p">]</span> <span class="o">=</span> <span class="n">gateway9200_m4_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_M4_2</span><span class="p">]</span> <span class="o">=</span> <span class="n">gateway9200_m4_2_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_PANASONIC</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref9200_pin_configs</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="k">const</span> <span class="n">stac9200_models</span><span class="p">[</span><span class="n">STAC_9200_MODELS</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">[</span><span class="n">STAC_AUTO</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;auto&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_REF</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;ref&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_OQO</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;oqo&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_DELL_D21</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;dell-d21&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_DELL_D22</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;dell-d22&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_DELL_D23</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;dell-d23&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_DELL_M21</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;dell-m21&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_DELL_M22</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;dell-m22&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_DELL_M23</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;dell-m23&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_DELL_M24</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;dell-m24&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_DELL_M25</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;dell-m25&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_DELL_M26</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;dell-m26&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_DELL_M27</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;dell-m27&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_M4</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;gateway-m4&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_M4_2</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;gateway-m4-2&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9200_PANASONIC</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;panasonic&quot;</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_pci_quirk</span> <span class="n">stac9200_cfg_tbl</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* SigmaTel reference board */</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x2668</span><span class="p">,</span>
		      <span class="s">&quot;DFI LanParty&quot;</span><span class="p">,</span> <span class="n">STAC_REF</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DFI</span><span class="p">,</span> <span class="mh">0x3101</span><span class="p">,</span>
		      <span class="s">&quot;DFI LanParty&quot;</span><span class="p">,</span> <span class="n">STAC_REF</span><span class="p">),</span>
	<span class="cm">/* Dell laptops have BIOS problem */</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01a8</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_D21</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01b5</span><span class="p">,</span>
		      <span class="s">&quot;Dell Inspiron 630m&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_M21</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01bd</span><span class="p">,</span>
		      <span class="s">&quot;Dell Inspiron E1505n&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_M25</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01c0</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_D22</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01c1</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_D22</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01c2</span><span class="p">,</span>
		      <span class="s">&quot;Dell Latitude D620&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_M22</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01c5</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_D23</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01c7</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_D23</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01c8</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_M22</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01c9</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_M24</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01ca</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_M24</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01cb</span><span class="p">,</span>
		      <span class="s">&quot;Dell Latitude 120L&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_M24</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01cc</span><span class="p">,</span>
		      <span class="s">&quot;Dell Latitude D820&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_M22</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01cd</span><span class="p">,</span>
		      <span class="s">&quot;Dell Inspiron E1705/9400&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_M27</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01ce</span><span class="p">,</span>
		      <span class="s">&quot;Dell XPS M1710&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_M23</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01cf</span><span class="p">,</span>
		      <span class="s">&quot;Dell Precision M90&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_M23</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01d3</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_M22</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01d4</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_M22</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01d6</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_M22</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01d8</span><span class="p">,</span>
		      <span class="s">&quot;Dell Inspiron 640m&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_M21</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01d9</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_D23</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01da</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_D23</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01de</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_D21</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01e3</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_D23</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01e8</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_D21</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01ee</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_M25</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01ef</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_M25</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01f5</span><span class="p">,</span>
		      <span class="s">&quot;Dell Inspiron 1501&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_M26</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01f6</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_9200_DELL_M26</span><span class="p">),</span>
	<span class="cm">/* Panasonic */</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="mh">0x10f7</span><span class="p">,</span> <span class="mh">0x8338</span><span class="p">,</span> <span class="s">&quot;Panasonic CF-74&quot;</span><span class="p">,</span> <span class="n">STAC_9200_PANASONIC</span><span class="p">),</span>
	<span class="cm">/* Gateway machines needs EAPD to be set on resume */</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="mh">0x107b</span><span class="p">,</span> <span class="mh">0x0205</span><span class="p">,</span> <span class="s">&quot;Gateway S-7110M&quot;</span><span class="p">,</span> <span class="n">STAC_9200_M4</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="mh">0x107b</span><span class="p">,</span> <span class="mh">0x0317</span><span class="p">,</span> <span class="s">&quot;Gateway MT3423, MX341*&quot;</span><span class="p">,</span> <span class="n">STAC_9200_M4_2</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="mh">0x107b</span><span class="p">,</span> <span class="mh">0x0318</span><span class="p">,</span> <span class="s">&quot;Gateway ML3019, MT3707&quot;</span><span class="p">,</span> <span class="n">STAC_9200_M4_2</span><span class="p">),</span>
	<span class="cm">/* OQO Mobile */</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="mh">0x1106</span><span class="p">,</span> <span class="mh">0x3288</span><span class="p">,</span> <span class="s">&quot;OQO Model 2&quot;</span><span class="p">,</span> <span class="n">STAC_9200_OQO</span><span class="p">),</span>
	<span class="p">{}</span> <span class="cm">/* terminator */</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ref925x_pin_configs</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x40c003f0</span><span class="p">,</span> <span class="mh">0x424503f2</span><span class="p">,</span> <span class="mh">0x01813022</span><span class="p">,</span> <span class="mh">0x02a19021</span><span class="p">,</span>
	<span class="mh">0x90a70320</span><span class="p">,</span> <span class="mh">0x02214210</span><span class="p">,</span> <span class="mh">0x01019020</span><span class="p">,</span> <span class="mh">0x9033032e</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">stac925xM1_pin_configs</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x40c003f4</span><span class="p">,</span> <span class="mh">0x424503f2</span><span class="p">,</span> <span class="mh">0x400000f3</span><span class="p">,</span> <span class="mh">0x02a19020</span><span class="p">,</span>
	<span class="mh">0x40a000f0</span><span class="p">,</span> <span class="mh">0x90100210</span><span class="p">,</span> <span class="mh">0x400003f1</span><span class="p">,</span> <span class="mh">0x9033032e</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">stac925xM1_2_pin_configs</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x40c003f4</span><span class="p">,</span> <span class="mh">0x424503f2</span><span class="p">,</span> <span class="mh">0x400000f3</span><span class="p">,</span> <span class="mh">0x02a19020</span><span class="p">,</span>
	<span class="mh">0x40a000f0</span><span class="p">,</span> <span class="mh">0x90100210</span><span class="p">,</span> <span class="mh">0x400003f1</span><span class="p">,</span> <span class="mh">0x9033032e</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">stac925xM2_pin_configs</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x40c003f4</span><span class="p">,</span> <span class="mh">0x424503f2</span><span class="p">,</span> <span class="mh">0x400000f3</span><span class="p">,</span> <span class="mh">0x02a19020</span><span class="p">,</span>
	<span class="mh">0x40a000f0</span><span class="p">,</span> <span class="mh">0x90100210</span><span class="p">,</span> <span class="mh">0x400003f1</span><span class="p">,</span> <span class="mh">0x9033032e</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">stac925xM2_2_pin_configs</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x40c003f4</span><span class="p">,</span> <span class="mh">0x424503f2</span><span class="p">,</span> <span class="mh">0x400000f3</span><span class="p">,</span> <span class="mh">0x02a19020</span><span class="p">,</span>
	<span class="mh">0x40a000f0</span><span class="p">,</span> <span class="mh">0x90100210</span><span class="p">,</span> <span class="mh">0x400003f1</span><span class="p">,</span> <span class="mh">0x9033032e</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">stac925xM3_pin_configs</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x40c003f4</span><span class="p">,</span> <span class="mh">0x424503f2</span><span class="p">,</span> <span class="mh">0x400000f3</span><span class="p">,</span> <span class="mh">0x02a19020</span><span class="p">,</span>
	<span class="mh">0x40a000f0</span><span class="p">,</span> <span class="mh">0x90100210</span><span class="p">,</span> <span class="mh">0x400003f1</span><span class="p">,</span> <span class="mh">0x503303f3</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">stac925xM5_pin_configs</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x40c003f4</span><span class="p">,</span> <span class="mh">0x424503f2</span><span class="p">,</span> <span class="mh">0x400000f3</span><span class="p">,</span> <span class="mh">0x02a19020</span><span class="p">,</span>
	<span class="mh">0x40a000f0</span><span class="p">,</span> <span class="mh">0x90100210</span><span class="p">,</span> <span class="mh">0x400003f1</span><span class="p">,</span> <span class="mh">0x9033032e</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">stac925xM6_pin_configs</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x40c003f4</span><span class="p">,</span> <span class="mh">0x424503f2</span><span class="p">,</span> <span class="mh">0x400000f3</span><span class="p">,</span> <span class="mh">0x02a19020</span><span class="p">,</span>
	<span class="mh">0x40a000f0</span><span class="p">,</span> <span class="mh">0x90100210</span><span class="p">,</span> <span class="mh">0x400003f1</span><span class="p">,</span> <span class="mh">0x90330320</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">stac925x_brd_tbl</span><span class="p">[</span><span class="n">STAC_925x_MODELS</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">[</span><span class="n">STAC_REF</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref925x_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_M1</span><span class="p">]</span> <span class="o">=</span> <span class="n">stac925xM1_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_M1_2</span><span class="p">]</span> <span class="o">=</span> <span class="n">stac925xM1_2_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_M2</span><span class="p">]</span> <span class="o">=</span> <span class="n">stac925xM2_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_M2_2</span><span class="p">]</span> <span class="o">=</span> <span class="n">stac925xM2_2_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_M3</span><span class="p">]</span> <span class="o">=</span> <span class="n">stac925xM3_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_M5</span><span class="p">]</span> <span class="o">=</span> <span class="n">stac925xM5_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_M6</span><span class="p">]</span> <span class="o">=</span> <span class="n">stac925xM6_pin_configs</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="k">const</span> <span class="n">stac925x_models</span><span class="p">[</span><span class="n">STAC_925x_MODELS</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">[</span><span class="n">STAC_925x_AUTO</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;auto&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_REF</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;ref&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_M1</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;m1&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_M1_2</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;m1-2&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_M2</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;m2&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_M2_2</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;m2-2&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_M3</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;m3&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_M5</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;m5&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_M6</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;m6&quot;</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_pci_quirk</span> <span class="n">stac925x_codec_id_cfg_tbl</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="mh">0x107b</span><span class="p">,</span> <span class="mh">0x0316</span><span class="p">,</span> <span class="s">&quot;Gateway M255&quot;</span><span class="p">,</span> <span class="n">STAC_M2</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="mh">0x107b</span><span class="p">,</span> <span class="mh">0x0366</span><span class="p">,</span> <span class="s">&quot;Gateway MP6954&quot;</span><span class="p">,</span> <span class="n">STAC_M5</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="mh">0x107b</span><span class="p">,</span> <span class="mh">0x0461</span><span class="p">,</span> <span class="s">&quot;Gateway NX560XL&quot;</span><span class="p">,</span> <span class="n">STAC_M1</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="mh">0x107b</span><span class="p">,</span> <span class="mh">0x0681</span><span class="p">,</span> <span class="s">&quot;Gateway NX860&quot;</span><span class="p">,</span> <span class="n">STAC_M2</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="mh">0x107b</span><span class="p">,</span> <span class="mh">0x0367</span><span class="p">,</span> <span class="s">&quot;Gateway MX6453&quot;</span><span class="p">,</span> <span class="n">STAC_M1_2</span><span class="p">),</span>
	<span class="cm">/* Not sure about the brand name for those */</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="mh">0x107b</span><span class="p">,</span> <span class="mh">0x0281</span><span class="p">,</span> <span class="s">&quot;Gateway mobile&quot;</span><span class="p">,</span> <span class="n">STAC_M1</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="mh">0x107b</span><span class="p">,</span> <span class="mh">0x0507</span><span class="p">,</span> <span class="s">&quot;Gateway mobile&quot;</span><span class="p">,</span> <span class="n">STAC_M3</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="mh">0x107b</span><span class="p">,</span> <span class="mh">0x0281</span><span class="p">,</span> <span class="s">&quot;Gateway mobile&quot;</span><span class="p">,</span> <span class="n">STAC_M6</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="mh">0x107b</span><span class="p">,</span> <span class="mh">0x0685</span><span class="p">,</span> <span class="s">&quot;Gateway mobile&quot;</span><span class="p">,</span> <span class="n">STAC_M2_2</span><span class="p">),</span>
	<span class="p">{}</span> <span class="cm">/* terminator */</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_pci_quirk</span> <span class="n">stac925x_cfg_tbl</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* SigmaTel reference board */</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x2668</span><span class="p">,</span> <span class="s">&quot;DFI LanParty&quot;</span><span class="p">,</span> <span class="n">STAC_REF</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DFI</span><span class="p">,</span> <span class="mh">0x3101</span><span class="p">,</span> <span class="s">&quot;DFI LanParty&quot;</span><span class="p">,</span> <span class="n">STAC_REF</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="mh">0x8384</span><span class="p">,</span> <span class="mh">0x7632</span><span class="p">,</span> <span class="s">&quot;Stac9202 Reference Board&quot;</span><span class="p">,</span> <span class="n">STAC_REF</span><span class="p">),</span>

	<span class="cm">/* Default table for unknown ID */</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="mh">0x1002</span><span class="p">,</span> <span class="mh">0x437b</span><span class="p">,</span> <span class="s">&quot;Gateway mobile&quot;</span><span class="p">,</span> <span class="n">STAC_M2_2</span><span class="p">),</span>

	<span class="p">{}</span> <span class="cm">/* terminator */</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ref92hd73xx_pin_configs</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x02214030</span><span class="p">,</span> <span class="mh">0x02a19040</span><span class="p">,</span> <span class="mh">0x01a19020</span><span class="p">,</span> <span class="mh">0x02214030</span><span class="p">,</span>
	<span class="mh">0x0181302e</span><span class="p">,</span> <span class="mh">0x01014010</span><span class="p">,</span> <span class="mh">0x01014020</span><span class="p">,</span> <span class="mh">0x01014030</span><span class="p">,</span>
	<span class="mh">0x02319040</span><span class="p">,</span> <span class="mh">0x90a000f0</span><span class="p">,</span> <span class="mh">0x90a000f0</span><span class="p">,</span> <span class="mh">0x01452050</span><span class="p">,</span>
	<span class="mh">0x01452050</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dell_m6_pin_configs</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0321101f</span><span class="p">,</span> <span class="mh">0x4f00000f</span><span class="p">,</span> <span class="mh">0x4f0000f0</span><span class="p">,</span> <span class="mh">0x90170110</span><span class="p">,</span>
	<span class="mh">0x03a11020</span><span class="p">,</span> <span class="mh">0x0321101f</span><span class="p">,</span> <span class="mh">0x4f0000f0</span><span class="p">,</span> <span class="mh">0x4f0000f0</span><span class="p">,</span>
	<span class="mh">0x4f0000f0</span><span class="p">,</span> <span class="mh">0x90a60160</span><span class="p">,</span> <span class="mh">0x4f0000f0</span><span class="p">,</span> <span class="mh">0x4f0000f0</span><span class="p">,</span>
	<span class="mh">0x4f0000f0</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">alienware_m17x_pin_configs</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0321101f</span><span class="p">,</span> <span class="mh">0x0321101f</span><span class="p">,</span> <span class="mh">0x03a11020</span><span class="p">,</span> <span class="mh">0x03014020</span><span class="p">,</span>
	<span class="mh">0x90170110</span><span class="p">,</span> <span class="mh">0x4f0000f0</span><span class="p">,</span> <span class="mh">0x4f0000f0</span><span class="p">,</span> <span class="mh">0x4f0000f0</span><span class="p">,</span>
	<span class="mh">0x4f0000f0</span><span class="p">,</span> <span class="mh">0x90a60160</span><span class="p">,</span> <span class="mh">0x4f0000f0</span><span class="p">,</span> <span class="mh">0x4f0000f0</span><span class="p">,</span>
	<span class="mh">0x904601b0</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">intel_dg45id_pin_configs</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x02214230</span><span class="p">,</span> <span class="mh">0x02A19240</span><span class="p">,</span> <span class="mh">0x01013214</span><span class="p">,</span> <span class="mh">0x01014210</span><span class="p">,</span>
	<span class="mh">0x01A19250</span><span class="p">,</span> <span class="mh">0x01011212</span><span class="p">,</span> <span class="mh">0x01016211</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">stac92hd73xx_brd_tbl</span><span class="p">[</span><span class="n">STAC_92HD73XX_MODELS</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">[</span><span class="n">STAC_92HD73XX_REF</span><span class="p">]</span>	<span class="o">=</span> <span class="n">ref92hd73xx_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_DELL_M6_AMIC</span><span class="p">]</span>	<span class="o">=</span> <span class="n">dell_m6_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_DELL_M6_DMIC</span><span class="p">]</span>	<span class="o">=</span> <span class="n">dell_m6_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_DELL_M6_BOTH</span><span class="p">]</span>	<span class="o">=</span> <span class="n">dell_m6_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_DELL_EQ</span><span class="p">]</span>	<span class="o">=</span> <span class="n">dell_m6_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_ALIENWARE_M17X</span><span class="p">]</span>	<span class="o">=</span> <span class="n">alienware_m17x_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_92HD73XX_INTEL</span><span class="p">]</span>	<span class="o">=</span> <span class="n">intel_dg45id_pin_configs</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="k">const</span> <span class="n">stac92hd73xx_models</span><span class="p">[</span><span class="n">STAC_92HD73XX_MODELS</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">[</span><span class="n">STAC_92HD73XX_AUTO</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;auto&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_92HD73XX_NO_JD</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;no-jd&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_92HD73XX_REF</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;ref&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_92HD73XX_INTEL</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;intel&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_DELL_M6_AMIC</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;dell-m6-amic&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_DELL_M6_DMIC</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;dell-m6-dmic&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_DELL_M6_BOTH</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;dell-m6&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_DELL_EQ</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;dell-eq&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_ALIENWARE_M17X</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;alienware&quot;</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_pci_quirk</span> <span class="n">stac92hd73xx_cfg_tbl</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* SigmaTel reference board */</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x2668</span><span class="p">,</span>
				<span class="s">&quot;DFI LanParty&quot;</span><span class="p">,</span> <span class="n">STAC_92HD73XX_REF</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DFI</span><span class="p">,</span> <span class="mh">0x3101</span><span class="p">,</span>
				<span class="s">&quot;DFI LanParty&quot;</span><span class="p">,</span> <span class="n">STAC_92HD73XX_REF</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x5002</span><span class="p">,</span>
				<span class="s">&quot;Intel DG45ID&quot;</span><span class="p">,</span> <span class="n">STAC_92HD73XX_INTEL</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x5003</span><span class="p">,</span>
				<span class="s">&quot;Intel DG45FC&quot;</span><span class="p">,</span> <span class="n">STAC_92HD73XX_INTEL</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x0254</span><span class="p">,</span>
				<span class="s">&quot;Dell Studio 1535&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_M6_DMIC</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x0255</span><span class="p">,</span>
				<span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_M6_DMIC</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x0256</span><span class="p">,</span>
				<span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_M6_BOTH</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x0257</span><span class="p">,</span>
				<span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_M6_BOTH</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x025e</span><span class="p">,</span>
				<span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_M6_AMIC</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x025f</span><span class="p">,</span>
				<span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_M6_AMIC</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x0271</span><span class="p">,</span>
				<span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_M6_DMIC</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x0272</span><span class="p">,</span>
				<span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_M6_DMIC</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x029f</span><span class="p">,</span>
				<span class="s">&quot;Dell Studio 1537&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_M6_DMIC</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x02a0</span><span class="p">,</span>
				<span class="s">&quot;Dell Studio 17&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_M6_DMIC</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x02be</span><span class="p">,</span>
				<span class="s">&quot;Dell Studio 1555&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_M6_DMIC</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x02bd</span><span class="p">,</span>
				<span class="s">&quot;Dell Studio 1557&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_M6_DMIC</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x02fe</span><span class="p">,</span>
				<span class="s">&quot;Dell Studio XPS 1645&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_M6_DMIC</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x0413</span><span class="p">,</span>
				<span class="s">&quot;Dell Studio 1558&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_M6_DMIC</span><span class="p">),</span>
	<span class="p">{}</span> <span class="cm">/* terminator */</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_pci_quirk</span> <span class="n">stac92hd73xx_codec_id_cfg_tbl</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x02a1</span><span class="p">,</span>
		      <span class="s">&quot;Alienware M17x&quot;</span><span class="p">,</span> <span class="n">STAC_ALIENWARE_M17X</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x043a</span><span class="p">,</span>
		      <span class="s">&quot;Alienware M17x&quot;</span><span class="p">,</span> <span class="n">STAC_ALIENWARE_M17X</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x0490</span><span class="p">,</span>
		      <span class="s">&quot;Alienware M17x R3&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_EQ</span><span class="p">),</span>
	<span class="p">{}</span> <span class="cm">/* terminator */</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ref92hd83xxx_pin_configs</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x02214030</span><span class="p">,</span> <span class="mh">0x02211010</span><span class="p">,</span> <span class="mh">0x02a19020</span><span class="p">,</span> <span class="mh">0x02170130</span><span class="p">,</span>
	<span class="mh">0x01014050</span><span class="p">,</span> <span class="mh">0x01819040</span><span class="p">,</span> <span class="mh">0x01014020</span><span class="p">,</span> <span class="mh">0x90a3014e</span><span class="p">,</span>
	<span class="mh">0x01451160</span><span class="p">,</span> <span class="mh">0x98560170</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dell_s14_pin_configs</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0221403f</span><span class="p">,</span> <span class="mh">0x0221101f</span><span class="p">,</span> <span class="mh">0x02a19020</span><span class="p">,</span> <span class="mh">0x90170110</span><span class="p">,</span>
	<span class="mh">0x40f000f0</span><span class="p">,</span> <span class="mh">0x40f000f0</span><span class="p">,</span> <span class="mh">0x40f000f0</span><span class="p">,</span> <span class="mh">0x90a60160</span><span class="p">,</span>
	<span class="mh">0x40f000f0</span><span class="p">,</span> <span class="mh">0x40f000f0</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dell_vostro_3500_pin_configs</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x02a11020</span><span class="p">,</span> <span class="mh">0x0221101f</span><span class="p">,</span> <span class="mh">0x400000f0</span><span class="p">,</span> <span class="mh">0x90170110</span><span class="p">,</span>
	<span class="mh">0x400000f1</span><span class="p">,</span> <span class="mh">0x400000f2</span><span class="p">,</span> <span class="mh">0x400000f3</span><span class="p">,</span> <span class="mh">0x90a60160</span><span class="p">,</span>
	<span class="mh">0x400000f4</span><span class="p">,</span> <span class="mh">0x400000f5</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">hp_dv7_4000_pin_configs</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x03a12050</span><span class="p">,</span> <span class="mh">0x0321201f</span><span class="p">,</span> <span class="mh">0x40f000f0</span><span class="p">,</span> <span class="mh">0x90170110</span><span class="p">,</span>
	<span class="mh">0x40f000f0</span><span class="p">,</span> <span class="mh">0x40f000f0</span><span class="p">,</span> <span class="mh">0x90170110</span><span class="p">,</span> <span class="mh">0xd5a30140</span><span class="p">,</span>
	<span class="mh">0x40f000f0</span><span class="p">,</span> <span class="mh">0x40f000f0</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">hp_zephyr_pin_configs</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x01813050</span><span class="p">,</span> <span class="mh">0x0421201f</span><span class="p">,</span> <span class="mh">0x04a1205e</span><span class="p">,</span> <span class="mh">0x96130310</span><span class="p">,</span>
	<span class="mh">0x96130310</span><span class="p">,</span> <span class="mh">0x0101401f</span><span class="p">,</span> <span class="mh">0x1111611f</span><span class="p">,</span> <span class="mh">0xd5a30130</span><span class="p">,</span>
	<span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">hp_cNB11_intquad_pin_configs</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x40f000f0</span><span class="p">,</span> <span class="mh">0x0221101f</span><span class="p">,</span> <span class="mh">0x02a11020</span><span class="p">,</span> <span class="mh">0x92170110</span><span class="p">,</span>
	<span class="mh">0x40f000f0</span><span class="p">,</span> <span class="mh">0x92170110</span><span class="p">,</span> <span class="mh">0x40f000f0</span><span class="p">,</span> <span class="mh">0xd5a30130</span><span class="p">,</span>
	<span class="mh">0x40f000f0</span><span class="p">,</span> <span class="mh">0x40f000f0</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">stac92hd83xxx_brd_tbl</span><span class="p">[</span><span class="n">STAC_92HD83XXX_MODELS</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">[</span><span class="n">STAC_92HD83XXX_REF</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref92hd83xxx_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_92HD83XXX_PWR_REF</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref92hd83xxx_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_DELL_S14</span><span class="p">]</span> <span class="o">=</span> <span class="n">dell_s14_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_DELL_VOSTRO_3500</span><span class="p">]</span> <span class="o">=</span> <span class="n">dell_vostro_3500_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_92HD83XXX_HP_cNB11_INTQUAD</span><span class="p">]</span> <span class="o">=</span> <span class="n">hp_cNB11_intquad_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_HP_DV7_4000</span><span class="p">]</span> <span class="o">=</span> <span class="n">hp_dv7_4000_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_HP_ZEPHYR</span><span class="p">]</span> <span class="o">=</span> <span class="n">hp_zephyr_pin_configs</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="k">const</span> <span class="n">stac92hd83xxx_models</span><span class="p">[</span><span class="n">STAC_92HD83XXX_MODELS</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">[</span><span class="n">STAC_92HD83XXX_AUTO</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;auto&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_92HD83XXX_REF</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;ref&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_92HD83XXX_PWR_REF</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;mic-ref&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_DELL_S14</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;dell-s14&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_DELL_VOSTRO_3500</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;dell-vostro-3500&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_92HD83XXX_HP_cNB11_INTQUAD</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;hp_cNB11_intquad&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_HP_DV7_4000</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;hp-dv7-4000&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_HP_ZEPHYR</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;hp-zephyr&quot;</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_pci_quirk</span> <span class="n">stac92hd83xxx_cfg_tbl</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* SigmaTel reference board */</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x2668</span><span class="p">,</span>
		      <span class="s">&quot;DFI LanParty&quot;</span><span class="p">,</span> <span class="n">STAC_92HD83XXX_REF</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DFI</span><span class="p">,</span> <span class="mh">0x3101</span><span class="p">,</span>
		      <span class="s">&quot;DFI LanParty&quot;</span><span class="p">,</span> <span class="n">STAC_92HD83XXX_REF</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x02ba</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_S14</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x1028</span><span class="p">,</span>
		      <span class="s">&quot;Dell Vostro 3500&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_VOSTRO_3500</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x1656</span><span class="p">,</span>
			  <span class="s">&quot;HP&quot;</span><span class="p">,</span> <span class="n">STAC_92HD83XXX_HP_cNB11_INTQUAD</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x1657</span><span class="p">,</span>
			  <span class="s">&quot;HP&quot;</span><span class="p">,</span> <span class="n">STAC_92HD83XXX_HP_cNB11_INTQUAD</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x1658</span><span class="p">,</span>
			  <span class="s">&quot;HP&quot;</span><span class="p">,</span> <span class="n">STAC_92HD83XXX_HP_cNB11_INTQUAD</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x1659</span><span class="p">,</span>
			  <span class="s">&quot;HP&quot;</span><span class="p">,</span> <span class="n">STAC_92HD83XXX_HP_cNB11_INTQUAD</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x165A</span><span class="p">,</span>
			  <span class="s">&quot;HP&quot;</span><span class="p">,</span> <span class="n">STAC_92HD83XXX_HP_cNB11_INTQUAD</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x165B</span><span class="p">,</span>
			  <span class="s">&quot;HP&quot;</span><span class="p">,</span> <span class="n">STAC_92HD83XXX_HP_cNB11_INTQUAD</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x3388</span><span class="p">,</span>
			  <span class="s">&quot;HP&quot;</span><span class="p">,</span> <span class="n">STAC_92HD83XXX_HP_cNB11_INTQUAD</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x3389</span><span class="p">,</span>
			  <span class="s">&quot;HP&quot;</span><span class="p">,</span> <span class="n">STAC_92HD83XXX_HP_cNB11_INTQUAD</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x355B</span><span class="p">,</span>
			  <span class="s">&quot;HP&quot;</span><span class="p">,</span> <span class="n">STAC_92HD83XXX_HP_cNB11_INTQUAD</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x355C</span><span class="p">,</span>
			  <span class="s">&quot;HP&quot;</span><span class="p">,</span> <span class="n">STAC_92HD83XXX_HP_cNB11_INTQUAD</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x355D</span><span class="p">,</span>
			  <span class="s">&quot;HP&quot;</span><span class="p">,</span> <span class="n">STAC_92HD83XXX_HP_cNB11_INTQUAD</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x355E</span><span class="p">,</span>
			  <span class="s">&quot;HP&quot;</span><span class="p">,</span> <span class="n">STAC_92HD83XXX_HP_cNB11_INTQUAD</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x355F</span><span class="p">,</span>
			  <span class="s">&quot;HP&quot;</span><span class="p">,</span> <span class="n">STAC_92HD83XXX_HP_cNB11_INTQUAD</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x3560</span><span class="p">,</span>
			  <span class="s">&quot;HP&quot;</span><span class="p">,</span> <span class="n">STAC_92HD83XXX_HP_cNB11_INTQUAD</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x358B</span><span class="p">,</span>
			  <span class="s">&quot;HP&quot;</span><span class="p">,</span> <span class="n">STAC_92HD83XXX_HP_cNB11_INTQUAD</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x358C</span><span class="p">,</span>
			  <span class="s">&quot;HP&quot;</span><span class="p">,</span> <span class="n">STAC_92HD83XXX_HP_cNB11_INTQUAD</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x358D</span><span class="p">,</span>
			  <span class="s">&quot;HP&quot;</span><span class="p">,</span> <span class="n">STAC_92HD83XXX_HP_cNB11_INTQUAD</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x3591</span><span class="p">,</span>
			  <span class="s">&quot;HP&quot;</span><span class="p">,</span> <span class="n">STAC_92HD83XXX_HP_cNB11_INTQUAD</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x3592</span><span class="p">,</span>
			  <span class="s">&quot;HP&quot;</span><span class="p">,</span> <span class="n">STAC_92HD83XXX_HP_cNB11_INTQUAD</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x3593</span><span class="p">,</span>
			  <span class="s">&quot;HP&quot;</span><span class="p">,</span> <span class="n">STAC_92HD83XXX_HP_cNB11_INTQUAD</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x3561</span><span class="p">,</span>
			  <span class="s">&quot;HP&quot;</span><span class="p">,</span> <span class="n">STAC_HP_ZEPHYR</span><span class="p">),</span>
	<span class="p">{}</span> <span class="cm">/* terminator */</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_pci_quirk</span> <span class="n">stac92hd83xxx_codec_id_cfg_tbl</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x3561</span><span class="p">,</span>
			  <span class="s">&quot;HP&quot;</span><span class="p">,</span> <span class="n">STAC_HP_ZEPHYR</span><span class="p">),</span>
	<span class="p">{}</span> <span class="cm">/* terminator */</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ref92hd71bxx_pin_configs</span><span class="p">[</span><span class="n">STAC92HD71BXX_NUM_PINS</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x02214030</span><span class="p">,</span> <span class="mh">0x02a19040</span><span class="p">,</span> <span class="mh">0x01a19020</span><span class="p">,</span> <span class="mh">0x01014010</span><span class="p">,</span>
	<span class="mh">0x0181302e</span><span class="p">,</span> <span class="mh">0x01014010</span><span class="p">,</span> <span class="mh">0x01019020</span><span class="p">,</span> <span class="mh">0x90a000f0</span><span class="p">,</span>
	<span class="mh">0x90a000f0</span><span class="p">,</span> <span class="mh">0x01452050</span><span class="p">,</span> <span class="mh">0x01452050</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span>
	<span class="mh">0x00000000</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dell_m4_1_pin_configs</span><span class="p">[</span><span class="n">STAC92HD71BXX_NUM_PINS</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0421101f</span><span class="p">,</span> <span class="mh">0x04a11221</span><span class="p">,</span> <span class="mh">0x40f000f0</span><span class="p">,</span> <span class="mh">0x90170110</span><span class="p">,</span>
	<span class="mh">0x23a1902e</span><span class="p">,</span> <span class="mh">0x23014250</span><span class="p">,</span> <span class="mh">0x40f000f0</span><span class="p">,</span> <span class="mh">0x90a000f0</span><span class="p">,</span>
	<span class="mh">0x40f000f0</span><span class="p">,</span> <span class="mh">0x4f0000f0</span><span class="p">,</span> <span class="mh">0x4f0000f0</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span>
	<span class="mh">0x00000000</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dell_m4_2_pin_configs</span><span class="p">[</span><span class="n">STAC92HD71BXX_NUM_PINS</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0421101f</span><span class="p">,</span> <span class="mh">0x04a11221</span><span class="p">,</span> <span class="mh">0x90a70330</span><span class="p">,</span> <span class="mh">0x90170110</span><span class="p">,</span>
	<span class="mh">0x23a1902e</span><span class="p">,</span> <span class="mh">0x23014250</span><span class="p">,</span> <span class="mh">0x40f000f0</span><span class="p">,</span> <span class="mh">0x40f000f0</span><span class="p">,</span>
	<span class="mh">0x40f000f0</span><span class="p">,</span> <span class="mh">0x044413b0</span><span class="p">,</span> <span class="mh">0x044413b0</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span>
	<span class="mh">0x00000000</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dell_m4_3_pin_configs</span><span class="p">[</span><span class="n">STAC92HD71BXX_NUM_PINS</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0421101f</span><span class="p">,</span> <span class="mh">0x04a11221</span><span class="p">,</span> <span class="mh">0x90a70330</span><span class="p">,</span> <span class="mh">0x90170110</span><span class="p">,</span>
	<span class="mh">0x40f000f0</span><span class="p">,</span> <span class="mh">0x40f000f0</span><span class="p">,</span> <span class="mh">0x40f000f0</span><span class="p">,</span> <span class="mh">0x90a000f0</span><span class="p">,</span>
	<span class="mh">0x40f000f0</span><span class="p">,</span> <span class="mh">0x044413b0</span><span class="p">,</span> <span class="mh">0x044413b0</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span>
	<span class="mh">0x00000000</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">stac92hd71bxx_brd_tbl</span><span class="p">[</span><span class="n">STAC_92HD71BXX_MODELS</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">[</span><span class="n">STAC_92HD71BXX_REF</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref92hd71bxx_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_DELL_M4_1</span><span class="p">]</span>	<span class="o">=</span> <span class="n">dell_m4_1_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_DELL_M4_2</span><span class="p">]</span>	<span class="o">=</span> <span class="n">dell_m4_2_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_DELL_M4_3</span><span class="p">]</span>	<span class="o">=</span> <span class="n">dell_m4_3_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_HP_M4</span><span class="p">]</span>		<span class="o">=</span> <span class="nb">NULL</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_HP_DV4</span><span class="p">]</span>		<span class="o">=</span> <span class="nb">NULL</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_HP_DV5</span><span class="p">]</span>		<span class="o">=</span> <span class="nb">NULL</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_HP_HDX</span><span class="p">]</span>           <span class="o">=</span> <span class="nb">NULL</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_HP_DV4_1222NR</span><span class="p">]</span>	<span class="o">=</span> <span class="nb">NULL</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="k">const</span> <span class="n">stac92hd71bxx_models</span><span class="p">[</span><span class="n">STAC_92HD71BXX_MODELS</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">[</span><span class="n">STAC_92HD71BXX_AUTO</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;auto&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_92HD71BXX_REF</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;ref&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_DELL_M4_1</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;dell-m4-1&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_DELL_M4_2</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;dell-m4-2&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_DELL_M4_3</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;dell-m4-3&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_HP_M4</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;hp-m4&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_HP_DV4</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;hp-dv4&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_HP_DV5</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;hp-dv5&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_HP_HDX</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;hp-hdx&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_HP_DV4_1222NR</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;hp-dv4-1222nr&quot;</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_pci_quirk</span> <span class="n">stac92hd71bxx_cfg_tbl</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* SigmaTel reference board */</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x2668</span><span class="p">,</span>
		      <span class="s">&quot;DFI LanParty&quot;</span><span class="p">,</span> <span class="n">STAC_92HD71BXX_REF</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DFI</span><span class="p">,</span> <span class="mh">0x3101</span><span class="p">,</span>
		      <span class="s">&quot;DFI LanParty&quot;</span><span class="p">,</span> <span class="n">STAC_92HD71BXX_REF</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x30fb</span><span class="p">,</span>
		      <span class="s">&quot;HP dv4-1222nr&quot;</span><span class="p">,</span> <span class="n">STAC_HP_DV4_1222NR</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK_MASK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0xfff0</span><span class="p">,</span> <span class="mh">0x1720</span><span class="p">,</span>
			  <span class="s">&quot;HP&quot;</span><span class="p">,</span> <span class="n">STAC_HP_DV5</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK_MASK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0xfff0</span><span class="p">,</span> <span class="mh">0x3080</span><span class="p">,</span>
		      <span class="s">&quot;HP&quot;</span><span class="p">,</span> <span class="n">STAC_HP_DV5</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK_MASK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0xfff0</span><span class="p">,</span> <span class="mh">0x30f0</span><span class="p">,</span>
		      <span class="s">&quot;HP dv4-7&quot;</span><span class="p">,</span> <span class="n">STAC_HP_DV4</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK_MASK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0xfff0</span><span class="p">,</span> <span class="mh">0x3600</span><span class="p">,</span>
		      <span class="s">&quot;HP dv4-7&quot;</span><span class="p">,</span> <span class="n">STAC_HP_DV5</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x3610</span><span class="p">,</span>
		      <span class="s">&quot;HP HDX&quot;</span><span class="p">,</span> <span class="n">STAC_HP_HDX</span><span class="p">),</span>  <span class="cm">/* HDX18 */</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x361a</span><span class="p">,</span>
		      <span class="s">&quot;HP mini 1000&quot;</span><span class="p">,</span> <span class="n">STAC_HP_M4</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x361b</span><span class="p">,</span>
		      <span class="s">&quot;HP HDX&quot;</span><span class="p">,</span> <span class="n">STAC_HP_HDX</span><span class="p">),</span>  <span class="cm">/* HDX16 */</span>
	<span class="n">SND_PCI_QUIRK_MASK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0xfff0</span><span class="p">,</span> <span class="mh">0x3620</span><span class="p">,</span>
		      <span class="s">&quot;HP dv6&quot;</span><span class="p">,</span> <span class="n">STAC_HP_DV5</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x3061</span><span class="p">,</span>
		      <span class="s">&quot;HP dv6&quot;</span><span class="p">,</span> <span class="n">STAC_HP_DV5</span><span class="p">),</span> <span class="cm">/* HP dv6-1110ax */</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0x363e</span><span class="p">,</span>
		      <span class="s">&quot;HP DV6&quot;</span><span class="p">,</span> <span class="n">STAC_HP_DV5</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK_MASK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_HP</span><span class="p">,</span> <span class="mh">0xfff0</span><span class="p">,</span> <span class="mh">0x7010</span><span class="p">,</span>
		      <span class="s">&quot;HP&quot;</span><span class="p">,</span> <span class="n">STAC_HP_DV5</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x0233</span><span class="p">,</span>
				<span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_M4_1</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x0234</span><span class="p">,</span>
				<span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_M4_1</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x0250</span><span class="p">,</span>
				<span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_M4_1</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x024f</span><span class="p">,</span>
				<span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_M4_1</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x024d</span><span class="p">,</span>
				<span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_M4_1</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x0251</span><span class="p">,</span>
				<span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_M4_1</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x0277</span><span class="p">,</span>
				<span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_M4_1</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x0263</span><span class="p">,</span>
				<span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_M4_2</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x0265</span><span class="p">,</span>
				<span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_M4_2</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x0262</span><span class="p">,</span>
				<span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_M4_2</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x0264</span><span class="p">,</span>
				<span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_M4_2</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x02aa</span><span class="p">,</span>
				<span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_M4_3</span><span class="p">),</span>
	<span class="p">{}</span> <span class="cm">/* terminator */</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ref922x_pin_configs</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x01014010</span><span class="p">,</span> <span class="mh">0x01016011</span><span class="p">,</span> <span class="mh">0x01012012</span><span class="p">,</span> <span class="mh">0x0221401f</span><span class="p">,</span>
	<span class="mh">0x01813122</span><span class="p">,</span> <span class="mh">0x01011014</span><span class="p">,</span> <span class="mh">0x01441030</span><span class="p">,</span> <span class="mh">0x01c41030</span><span class="p">,</span>
	<span class="mh">0x40000100</span><span class="p">,</span> <span class="mh">0x40000100</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm">    STAC 922X pin configs for</span>
<span class="cm">    102801A7</span>
<span class="cm">    102801AB</span>
<span class="cm">    102801A9</span>
<span class="cm">    102801D1</span>
<span class="cm">    102801D2</span>
<span class="cm">*/</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dell_922x_d81_pin_configs</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x02214030</span><span class="p">,</span> <span class="mh">0x01a19021</span><span class="p">,</span> <span class="mh">0x01111012</span><span class="p">,</span> <span class="mh">0x01114010</span><span class="p">,</span>
	<span class="mh">0x02a19020</span><span class="p">,</span> <span class="mh">0x01117011</span><span class="p">,</span> <span class="mh">0x400001f0</span><span class="p">,</span> <span class="mh">0x400001f1</span><span class="p">,</span>
	<span class="mh">0x01813122</span><span class="p">,</span> <span class="mh">0x400001f2</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm">    STAC 922X pin configs for</span>
<span class="cm">    102801AC</span>
<span class="cm">    102801D0</span>
<span class="cm">*/</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dell_922x_d82_pin_configs</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x02214030</span><span class="p">,</span> <span class="mh">0x01a19021</span><span class="p">,</span> <span class="mh">0x01111012</span><span class="p">,</span> <span class="mh">0x01114010</span><span class="p">,</span>
	<span class="mh">0x02a19020</span><span class="p">,</span> <span class="mh">0x01117011</span><span class="p">,</span> <span class="mh">0x01451140</span><span class="p">,</span> <span class="mh">0x400001f0</span><span class="p">,</span>
	<span class="mh">0x01813122</span><span class="p">,</span> <span class="mh">0x400001f1</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm">    STAC 922X pin configs for</span>
<span class="cm">    102801BF</span>
<span class="cm">*/</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dell_922x_m81_pin_configs</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0321101f</span><span class="p">,</span> <span class="mh">0x01112024</span><span class="p">,</span> <span class="mh">0x01111222</span><span class="p">,</span> <span class="mh">0x91174220</span><span class="p">,</span>
	<span class="mh">0x03a11050</span><span class="p">,</span> <span class="mh">0x01116221</span><span class="p">,</span> <span class="mh">0x90a70330</span><span class="p">,</span> <span class="mh">0x01452340</span><span class="p">,</span> 
	<span class="mh">0x40C003f1</span><span class="p">,</span> <span class="mh">0x405003f0</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm">    STAC 9221 A1 pin configs for</span>
<span class="cm">    102801D7 (Dell XPS M1210)</span>
<span class="cm">*/</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dell_922x_m82_pin_configs</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x02211211</span><span class="p">,</span> <span class="mh">0x408103ff</span><span class="p">,</span> <span class="mh">0x02a1123e</span><span class="p">,</span> <span class="mh">0x90100310</span><span class="p">,</span> 
	<span class="mh">0x408003f1</span><span class="p">,</span> <span class="mh">0x0221121f</span><span class="p">,</span> <span class="mh">0x03451340</span><span class="p">,</span> <span class="mh">0x40c003f2</span><span class="p">,</span> 
	<span class="mh">0x508003f3</span><span class="p">,</span> <span class="mh">0x405003f4</span><span class="p">,</span> 
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">d945gtp3_pin_configs</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0221401f</span><span class="p">,</span> <span class="mh">0x01a19022</span><span class="p">,</span> <span class="mh">0x01813021</span><span class="p">,</span> <span class="mh">0x01014010</span><span class="p">,</span>
	<span class="mh">0x40000100</span><span class="p">,</span> <span class="mh">0x40000100</span><span class="p">,</span> <span class="mh">0x40000100</span><span class="p">,</span> <span class="mh">0x40000100</span><span class="p">,</span>
	<span class="mh">0x02a19120</span><span class="p">,</span> <span class="mh">0x40000100</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">d945gtp5_pin_configs</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0221401f</span><span class="p">,</span> <span class="mh">0x01011012</span><span class="p">,</span> <span class="mh">0x01813024</span><span class="p">,</span> <span class="mh">0x01014010</span><span class="p">,</span>
	<span class="mh">0x01a19021</span><span class="p">,</span> <span class="mh">0x01016011</span><span class="p">,</span> <span class="mh">0x01452130</span><span class="p">,</span> <span class="mh">0x40000100</span><span class="p">,</span>
	<span class="mh">0x02a19320</span><span class="p">,</span> <span class="mh">0x40000100</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">intel_mac_v1_pin_configs</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0121e21f</span><span class="p">,</span> <span class="mh">0x400000ff</span><span class="p">,</span> <span class="mh">0x9017e110</span><span class="p">,</span> <span class="mh">0x400000fd</span><span class="p">,</span>
	<span class="mh">0x400000fe</span><span class="p">,</span> <span class="mh">0x0181e020</span><span class="p">,</span> <span class="mh">0x1145e030</span><span class="p">,</span> <span class="mh">0x11c5e240</span><span class="p">,</span>
	<span class="mh">0x400000fc</span><span class="p">,</span> <span class="mh">0x400000fb</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">intel_mac_v2_pin_configs</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0121e21f</span><span class="p">,</span> <span class="mh">0x90a7012e</span><span class="p">,</span> <span class="mh">0x9017e110</span><span class="p">,</span> <span class="mh">0x400000fd</span><span class="p">,</span>
	<span class="mh">0x400000fe</span><span class="p">,</span> <span class="mh">0x0181e020</span><span class="p">,</span> <span class="mh">0x1145e230</span><span class="p">,</span> <span class="mh">0x500000fa</span><span class="p">,</span>
	<span class="mh">0x400000fc</span><span class="p">,</span> <span class="mh">0x400000fb</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">intel_mac_v3_pin_configs</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0121e21f</span><span class="p">,</span> <span class="mh">0x90a7012e</span><span class="p">,</span> <span class="mh">0x9017e110</span><span class="p">,</span> <span class="mh">0x400000fd</span><span class="p">,</span>
	<span class="mh">0x400000fe</span><span class="p">,</span> <span class="mh">0x0181e020</span><span class="p">,</span> <span class="mh">0x1145e230</span><span class="p">,</span> <span class="mh">0x11c5e240</span><span class="p">,</span>
	<span class="mh">0x400000fc</span><span class="p">,</span> <span class="mh">0x400000fb</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">intel_mac_v4_pin_configs</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0321e21f</span><span class="p">,</span> <span class="mh">0x03a1e02e</span><span class="p">,</span> <span class="mh">0x9017e110</span><span class="p">,</span> <span class="mh">0x9017e11f</span><span class="p">,</span>
	<span class="mh">0x400000fe</span><span class="p">,</span> <span class="mh">0x0381e020</span><span class="p">,</span> <span class="mh">0x1345e230</span><span class="p">,</span> <span class="mh">0x13c5e240</span><span class="p">,</span>
	<span class="mh">0x400000fc</span><span class="p">,</span> <span class="mh">0x400000fb</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">intel_mac_v5_pin_configs</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0321e21f</span><span class="p">,</span> <span class="mh">0x03a1e02e</span><span class="p">,</span> <span class="mh">0x9017e110</span><span class="p">,</span> <span class="mh">0x9017e11f</span><span class="p">,</span>
	<span class="mh">0x400000fe</span><span class="p">,</span> <span class="mh">0x0381e020</span><span class="p">,</span> <span class="mh">0x1345e230</span><span class="p">,</span> <span class="mh">0x13c5e240</span><span class="p">,</span>
	<span class="mh">0x400000fc</span><span class="p">,</span> <span class="mh">0x400000fb</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ecs202_pin_configs</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0221401f</span><span class="p">,</span> <span class="mh">0x02a19020</span><span class="p">,</span> <span class="mh">0x01a19020</span><span class="p">,</span> <span class="mh">0x01114010</span><span class="p">,</span>
	<span class="mh">0x408000f0</span><span class="p">,</span> <span class="mh">0x01813022</span><span class="p">,</span> <span class="mh">0x074510a0</span><span class="p">,</span> <span class="mh">0x40c400f1</span><span class="p">,</span>
	<span class="mh">0x9037012e</span><span class="p">,</span> <span class="mh">0x40e000f2</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">stac922x_brd_tbl</span><span class="p">[</span><span class="n">STAC_922X_MODELS</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">[</span><span class="n">STAC_D945_REF</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref922x_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_D945GTP3</span><span class="p">]</span> <span class="o">=</span> <span class="n">d945gtp3_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_D945GTP5</span><span class="p">]</span> <span class="o">=</span> <span class="n">d945gtp5_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_INTEL_MAC_V1</span><span class="p">]</span> <span class="o">=</span> <span class="n">intel_mac_v1_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_INTEL_MAC_V2</span><span class="p">]</span> <span class="o">=</span> <span class="n">intel_mac_v2_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_INTEL_MAC_V3</span><span class="p">]</span> <span class="o">=</span> <span class="n">intel_mac_v3_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_INTEL_MAC_V4</span><span class="p">]</span> <span class="o">=</span> <span class="n">intel_mac_v4_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_INTEL_MAC_V5</span><span class="p">]</span> <span class="o">=</span> <span class="n">intel_mac_v5_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_INTEL_MAC_AUTO</span><span class="p">]</span> <span class="o">=</span> <span class="n">intel_mac_v3_pin_configs</span><span class="p">,</span>
	<span class="cm">/* for backward compatibility */</span>
	<span class="p">[</span><span class="n">STAC_MACMINI</span><span class="p">]</span> <span class="o">=</span> <span class="n">intel_mac_v3_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_MACBOOK</span><span class="p">]</span> <span class="o">=</span> <span class="n">intel_mac_v5_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_MACBOOK_PRO_V1</span><span class="p">]</span> <span class="o">=</span> <span class="n">intel_mac_v3_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_MACBOOK_PRO_V2</span><span class="p">]</span> <span class="o">=</span> <span class="n">intel_mac_v3_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_IMAC_INTEL</span><span class="p">]</span> <span class="o">=</span> <span class="n">intel_mac_v2_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_IMAC_INTEL_20</span><span class="p">]</span> <span class="o">=</span> <span class="n">intel_mac_v3_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_ECS_202</span><span class="p">]</span> <span class="o">=</span> <span class="n">ecs202_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_922X_DELL_D81</span><span class="p">]</span> <span class="o">=</span> <span class="n">dell_922x_d81_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_922X_DELL_D82</span><span class="p">]</span> <span class="o">=</span> <span class="n">dell_922x_d82_pin_configs</span><span class="p">,</span>	
	<span class="p">[</span><span class="n">STAC_922X_DELL_M81</span><span class="p">]</span> <span class="o">=</span> <span class="n">dell_922x_m81_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_922X_DELL_M82</span><span class="p">]</span> <span class="o">=</span> <span class="n">dell_922x_m82_pin_configs</span><span class="p">,</span>	
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="k">const</span> <span class="n">stac922x_models</span><span class="p">[</span><span class="n">STAC_922X_MODELS</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">[</span><span class="n">STAC_922X_AUTO</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;auto&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_D945_REF</span><span class="p">]</span>	<span class="o">=</span> <span class="s">&quot;ref&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_D945GTP5</span><span class="p">]</span>	<span class="o">=</span> <span class="s">&quot;5stack&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_D945GTP3</span><span class="p">]</span>	<span class="o">=</span> <span class="s">&quot;3stack&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_INTEL_MAC_V1</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;intel-mac-v1&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_INTEL_MAC_V2</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;intel-mac-v2&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_INTEL_MAC_V3</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;intel-mac-v3&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_INTEL_MAC_V4</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;intel-mac-v4&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_INTEL_MAC_V5</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;intel-mac-v5&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_INTEL_MAC_AUTO</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;intel-mac-auto&quot;</span><span class="p">,</span>
	<span class="cm">/* for backward compatibility */</span>
	<span class="p">[</span><span class="n">STAC_MACMINI</span><span class="p">]</span>	<span class="o">=</span> <span class="s">&quot;macmini&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_MACBOOK</span><span class="p">]</span>	<span class="o">=</span> <span class="s">&quot;macbook&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_MACBOOK_PRO_V1</span><span class="p">]</span>	<span class="o">=</span> <span class="s">&quot;macbook-pro-v1&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_MACBOOK_PRO_V2</span><span class="p">]</span>	<span class="o">=</span> <span class="s">&quot;macbook-pro&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_IMAC_INTEL</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;imac-intel&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_IMAC_INTEL_20</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;imac-intel-20&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_ECS_202</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;ecs202&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_922X_DELL_D81</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;dell-d81&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_922X_DELL_D82</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;dell-d82&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_922X_DELL_M81</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;dell-m81&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_922X_DELL_M82</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;dell-m82&quot;</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_pci_quirk</span> <span class="n">stac922x_cfg_tbl</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* SigmaTel reference board */</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x2668</span><span class="p">,</span>
		      <span class="s">&quot;DFI LanParty&quot;</span><span class="p">,</span> <span class="n">STAC_D945_REF</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DFI</span><span class="p">,</span> <span class="mh">0x3101</span><span class="p">,</span>
		      <span class="s">&quot;DFI LanParty&quot;</span><span class="p">,</span> <span class="n">STAC_D945_REF</span><span class="p">),</span>
	<span class="cm">/* Intel 945G based systems */</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x0101</span><span class="p">,</span>
		      <span class="s">&quot;Intel D945G&quot;</span><span class="p">,</span> <span class="n">STAC_D945GTP3</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x0202</span><span class="p">,</span>
		      <span class="s">&quot;Intel D945G&quot;</span><span class="p">,</span> <span class="n">STAC_D945GTP3</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x0606</span><span class="p">,</span>
		      <span class="s">&quot;Intel D945G&quot;</span><span class="p">,</span> <span class="n">STAC_D945GTP3</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x0601</span><span class="p">,</span>
		      <span class="s">&quot;Intel D945G&quot;</span><span class="p">,</span> <span class="n">STAC_D945GTP3</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x0111</span><span class="p">,</span>
		      <span class="s">&quot;Intel D945G&quot;</span><span class="p">,</span> <span class="n">STAC_D945GTP3</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x1115</span><span class="p">,</span>
		      <span class="s">&quot;Intel D945G&quot;</span><span class="p">,</span> <span class="n">STAC_D945GTP3</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x1116</span><span class="p">,</span>
		      <span class="s">&quot;Intel D945G&quot;</span><span class="p">,</span> <span class="n">STAC_D945GTP3</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x1117</span><span class="p">,</span>
		      <span class="s">&quot;Intel D945G&quot;</span><span class="p">,</span> <span class="n">STAC_D945GTP3</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x1118</span><span class="p">,</span>
		      <span class="s">&quot;Intel D945G&quot;</span><span class="p">,</span> <span class="n">STAC_D945GTP3</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x1119</span><span class="p">,</span>
		      <span class="s">&quot;Intel D945G&quot;</span><span class="p">,</span> <span class="n">STAC_D945GTP3</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x8826</span><span class="p">,</span>
		      <span class="s">&quot;Intel D945G&quot;</span><span class="p">,</span> <span class="n">STAC_D945GTP3</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x5049</span><span class="p">,</span>
		      <span class="s">&quot;Intel D945G&quot;</span><span class="p">,</span> <span class="n">STAC_D945GTP3</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x5055</span><span class="p">,</span>
		      <span class="s">&quot;Intel D945G&quot;</span><span class="p">,</span> <span class="n">STAC_D945GTP3</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x5048</span><span class="p">,</span>
		      <span class="s">&quot;Intel D945G&quot;</span><span class="p">,</span> <span class="n">STAC_D945GTP3</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x0110</span><span class="p">,</span>
		      <span class="s">&quot;Intel D945G&quot;</span><span class="p">,</span> <span class="n">STAC_D945GTP3</span><span class="p">),</span>
	<span class="cm">/* Intel D945G 5-stack systems */</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x0404</span><span class="p">,</span>
		      <span class="s">&quot;Intel D945G&quot;</span><span class="p">,</span> <span class="n">STAC_D945GTP5</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x0303</span><span class="p">,</span>
		      <span class="s">&quot;Intel D945G&quot;</span><span class="p">,</span> <span class="n">STAC_D945GTP5</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x0013</span><span class="p">,</span>
		      <span class="s">&quot;Intel D945G&quot;</span><span class="p">,</span> <span class="n">STAC_D945GTP5</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x0417</span><span class="p">,</span>
		      <span class="s">&quot;Intel D945G&quot;</span><span class="p">,</span> <span class="n">STAC_D945GTP5</span><span class="p">),</span>
	<span class="cm">/* Intel 945P based systems */</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x0b0b</span><span class="p">,</span>
		      <span class="s">&quot;Intel D945P&quot;</span><span class="p">,</span> <span class="n">STAC_D945GTP3</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x0112</span><span class="p">,</span>
		      <span class="s">&quot;Intel D945P&quot;</span><span class="p">,</span> <span class="n">STAC_D945GTP3</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x0d0d</span><span class="p">,</span>
		      <span class="s">&quot;Intel D945P&quot;</span><span class="p">,</span> <span class="n">STAC_D945GTP3</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x0909</span><span class="p">,</span>
		      <span class="s">&quot;Intel D945P&quot;</span><span class="p">,</span> <span class="n">STAC_D945GTP3</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x0505</span><span class="p">,</span>
		      <span class="s">&quot;Intel D945P&quot;</span><span class="p">,</span> <span class="n">STAC_D945GTP3</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x0707</span><span class="p">,</span>
		      <span class="s">&quot;Intel D945P&quot;</span><span class="p">,</span> <span class="n">STAC_D945GTP5</span><span class="p">),</span>
	<span class="cm">/* other intel */</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x0204</span><span class="p">,</span>
		      <span class="s">&quot;Intel D945&quot;</span><span class="p">,</span> <span class="n">STAC_D945_REF</span><span class="p">),</span>
	<span class="cm">/* other systems  */</span>
	<span class="cm">/* Apple Intel Mac (Mac Mini, MacBook, MacBook Pro...) */</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="mh">0x8384</span><span class="p">,</span> <span class="mh">0x7680</span><span class="p">,</span>
		      <span class="s">&quot;Mac&quot;</span><span class="p">,</span> <span class="n">STAC_INTEL_MAC_AUTO</span><span class="p">),</span>
	<span class="cm">/* Dell systems  */</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01a7</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_922X_DELL_D81</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01a9</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_922X_DELL_D81</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01ab</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_922X_DELL_D81</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01ac</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_922X_DELL_D82</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01bf</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_922X_DELL_M81</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01d0</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_922X_DELL_D82</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01d1</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_922X_DELL_D81</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01d2</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_922X_DELL_D81</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01d7</span><span class="p">,</span>
		      <span class="s">&quot;Dell XPS M1210&quot;</span><span class="p">,</span> <span class="n">STAC_922X_DELL_M82</span><span class="p">),</span>
	<span class="cm">/* ECS/PC Chips boards */</span>
	<span class="n">SND_PCI_QUIRK_MASK</span><span class="p">(</span><span class="mh">0x1019</span><span class="p">,</span> <span class="mh">0xf000</span><span class="p">,</span> <span class="mh">0x2000</span><span class="p">,</span>
		      <span class="s">&quot;ECS/PC chips&quot;</span><span class="p">,</span> <span class="n">STAC_ECS_202</span><span class="p">),</span>
	<span class="p">{}</span> <span class="cm">/* terminator */</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ref927x_pin_configs</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x02214020</span><span class="p">,</span> <span class="mh">0x02a19080</span><span class="p">,</span> <span class="mh">0x0181304e</span><span class="p">,</span> <span class="mh">0x01014010</span><span class="p">,</span>
	<span class="mh">0x01a19040</span><span class="p">,</span> <span class="mh">0x01011012</span><span class="p">,</span> <span class="mh">0x01016011</span><span class="p">,</span> <span class="mh">0x0101201f</span><span class="p">,</span> 
	<span class="mh">0x183301f0</span><span class="p">,</span> <span class="mh">0x18a001f0</span><span class="p">,</span> <span class="mh">0x18a001f0</span><span class="p">,</span> <span class="mh">0x01442070</span><span class="p">,</span>
	<span class="mh">0x01c42190</span><span class="p">,</span> <span class="mh">0x40000100</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">d965_3st_pin_configs</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0221401f</span><span class="p">,</span> <span class="mh">0x02a19120</span><span class="p">,</span> <span class="mh">0x40000100</span><span class="p">,</span> <span class="mh">0x01014011</span><span class="p">,</span>
	<span class="mh">0x01a19021</span><span class="p">,</span> <span class="mh">0x01813024</span><span class="p">,</span> <span class="mh">0x40000100</span><span class="p">,</span> <span class="mh">0x40000100</span><span class="p">,</span>
	<span class="mh">0x40000100</span><span class="p">,</span> <span class="mh">0x40000100</span><span class="p">,</span> <span class="mh">0x40000100</span><span class="p">,</span> <span class="mh">0x40000100</span><span class="p">,</span>
	<span class="mh">0x40000100</span><span class="p">,</span> <span class="mh">0x40000100</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">d965_5st_pin_configs</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x02214020</span><span class="p">,</span> <span class="mh">0x02a19080</span><span class="p">,</span> <span class="mh">0x0181304e</span><span class="p">,</span> <span class="mh">0x01014010</span><span class="p">,</span>
	<span class="mh">0x01a19040</span><span class="p">,</span> <span class="mh">0x01011012</span><span class="p">,</span> <span class="mh">0x01016011</span><span class="p">,</span> <span class="mh">0x40000100</span><span class="p">,</span>
	<span class="mh">0x40000100</span><span class="p">,</span> <span class="mh">0x40000100</span><span class="p">,</span> <span class="mh">0x40000100</span><span class="p">,</span> <span class="mh">0x01442070</span><span class="p">,</span>
	<span class="mh">0x40000100</span><span class="p">,</span> <span class="mh">0x40000100</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">d965_5st_no_fp_pin_configs</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x40000100</span><span class="p">,</span> <span class="mh">0x40000100</span><span class="p">,</span> <span class="mh">0x0181304e</span><span class="p">,</span> <span class="mh">0x01014010</span><span class="p">,</span>
	<span class="mh">0x01a19040</span><span class="p">,</span> <span class="mh">0x01011012</span><span class="p">,</span> <span class="mh">0x01016011</span><span class="p">,</span> <span class="mh">0x40000100</span><span class="p">,</span>
	<span class="mh">0x40000100</span><span class="p">,</span> <span class="mh">0x40000100</span><span class="p">,</span> <span class="mh">0x40000100</span><span class="p">,</span> <span class="mh">0x01442070</span><span class="p">,</span>
	<span class="mh">0x40000100</span><span class="p">,</span> <span class="mh">0x40000100</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dell_3st_pin_configs</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x02211230</span><span class="p">,</span> <span class="mh">0x02a11220</span><span class="p">,</span> <span class="mh">0x01a19040</span><span class="p">,</span> <span class="mh">0x01114210</span><span class="p">,</span>
	<span class="mh">0x01111212</span><span class="p">,</span> <span class="mh">0x01116211</span><span class="p">,</span> <span class="mh">0x01813050</span><span class="p">,</span> <span class="mh">0x01112214</span><span class="p">,</span>
	<span class="mh">0x403003fa</span><span class="p">,</span> <span class="mh">0x90a60040</span><span class="p">,</span> <span class="mh">0x90a60040</span><span class="p">,</span> <span class="mh">0x404003fb</span><span class="p">,</span>
	<span class="mh">0x40c003fc</span><span class="p">,</span> <span class="mh">0x40000100</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">stac927x_brd_tbl</span><span class="p">[</span><span class="n">STAC_927X_MODELS</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">[</span><span class="n">STAC_D965_REF_NO_JD</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref927x_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_D965_REF</span><span class="p">]</span>  <span class="o">=</span> <span class="n">ref927x_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_D965_3ST</span><span class="p">]</span>  <span class="o">=</span> <span class="n">d965_3st_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_D965_5ST</span><span class="p">]</span>  <span class="o">=</span> <span class="n">d965_5st_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_D965_5ST_NO_FP</span><span class="p">]</span>  <span class="o">=</span> <span class="n">d965_5st_no_fp_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_DELL_3ST</span><span class="p">]</span>  <span class="o">=</span> <span class="n">dell_3st_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_DELL_BIOS</span><span class="p">]</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_927X_VOLKNOB</span><span class="p">]</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="k">const</span> <span class="n">stac927x_models</span><span class="p">[</span><span class="n">STAC_927X_MODELS</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">[</span><span class="n">STAC_927X_AUTO</span><span class="p">]</span>	<span class="o">=</span> <span class="s">&quot;auto&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_D965_REF_NO_JD</span><span class="p">]</span>	<span class="o">=</span> <span class="s">&quot;ref-no-jd&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_D965_REF</span><span class="p">]</span>		<span class="o">=</span> <span class="s">&quot;ref&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_D965_3ST</span><span class="p">]</span>		<span class="o">=</span> <span class="s">&quot;3stack&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_D965_5ST</span><span class="p">]</span>		<span class="o">=</span> <span class="s">&quot;5stack&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_D965_5ST_NO_FP</span><span class="p">]</span>	<span class="o">=</span> <span class="s">&quot;5stack-no-fp&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_DELL_3ST</span><span class="p">]</span>		<span class="o">=</span> <span class="s">&quot;dell-3stack&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_DELL_BIOS</span><span class="p">]</span>	<span class="o">=</span> <span class="s">&quot;dell-bios&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_927X_VOLKNOB</span><span class="p">]</span>	<span class="o">=</span> <span class="s">&quot;volknob&quot;</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_pci_quirk</span> <span class="n">stac927x_cfg_tbl</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* SigmaTel reference board */</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x2668</span><span class="p">,</span>
		      <span class="s">&quot;DFI LanParty&quot;</span><span class="p">,</span> <span class="n">STAC_D965_REF</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DFI</span><span class="p">,</span> <span class="mh">0x3101</span><span class="p">,</span>
		      <span class="s">&quot;DFI LanParty&quot;</span><span class="p">,</span> <span class="n">STAC_D965_REF</span><span class="p">),</span>
	 <span class="cm">/* Intel 946 based systems */</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x3d01</span><span class="p">,</span> <span class="s">&quot;Intel D946&quot;</span><span class="p">,</span> <span class="n">STAC_D965_3ST</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0xa301</span><span class="p">,</span> <span class="s">&quot;Intel D946&quot;</span><span class="p">,</span> <span class="n">STAC_D965_3ST</span><span class="p">),</span>
	<span class="cm">/* 965 based 3 stack systems */</span>
	<span class="n">SND_PCI_QUIRK_MASK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0xff00</span><span class="p">,</span> <span class="mh">0x2100</span><span class="p">,</span>
			   <span class="s">&quot;Intel D965&quot;</span><span class="p">,</span> <span class="n">STAC_D965_3ST</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK_MASK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0xff00</span><span class="p">,</span> <span class="mh">0x2000</span><span class="p">,</span>
			   <span class="s">&quot;Intel D965&quot;</span><span class="p">,</span> <span class="n">STAC_D965_3ST</span><span class="p">),</span>
	<span class="cm">/* Dell 3 stack systems */</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span>  <span class="mh">0x01dd</span><span class="p">,</span> <span class="s">&quot;Dell Dimension E520&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_3ST</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span>  <span class="mh">0x01ed</span><span class="p">,</span> <span class="s">&quot;Dell     &quot;</span><span class="p">,</span> <span class="n">STAC_DELL_3ST</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span>  <span class="mh">0x01f4</span><span class="p">,</span> <span class="s">&quot;Dell     &quot;</span><span class="p">,</span> <span class="n">STAC_DELL_3ST</span><span class="p">),</span>
	<span class="cm">/* Dell 3 stack systems with verb table in BIOS */</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span>  <span class="mh">0x01f3</span><span class="p">,</span> <span class="s">&quot;Dell Inspiron 1420&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_BIOS</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span>  <span class="mh">0x01f7</span><span class="p">,</span> <span class="s">&quot;Dell XPS M1730&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_BIOS</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span>  <span class="mh">0x0227</span><span class="p">,</span> <span class="s">&quot;Dell Vostro 1400  &quot;</span><span class="p">,</span> <span class="n">STAC_DELL_BIOS</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span>  <span class="mh">0x022e</span><span class="p">,</span> <span class="s">&quot;Dell     &quot;</span><span class="p">,</span> <span class="n">STAC_DELL_BIOS</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span>  <span class="mh">0x022f</span><span class="p">,</span> <span class="s">&quot;Dell Inspiron 1525&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_BIOS</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span>  <span class="mh">0x0242</span><span class="p">,</span> <span class="s">&quot;Dell     &quot;</span><span class="p">,</span> <span class="n">STAC_DELL_BIOS</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span>  <span class="mh">0x0243</span><span class="p">,</span> <span class="s">&quot;Dell     &quot;</span><span class="p">,</span> <span class="n">STAC_DELL_BIOS</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span>  <span class="mh">0x02ff</span><span class="p">,</span> <span class="s">&quot;Dell     &quot;</span><span class="p">,</span> <span class="n">STAC_DELL_BIOS</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span>  <span class="mh">0x0209</span><span class="p">,</span> <span class="s">&quot;Dell XPS 1330&quot;</span><span class="p">,</span> <span class="n">STAC_DELL_BIOS</span><span class="p">),</span>
	<span class="cm">/* 965 based 5 stack systems */</span>
	<span class="n">SND_PCI_QUIRK_MASK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0xff00</span><span class="p">,</span> <span class="mh">0x2300</span><span class="p">,</span>
			   <span class="s">&quot;Intel D965&quot;</span><span class="p">,</span> <span class="n">STAC_D965_5ST</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK_MASK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0xff00</span><span class="p">,</span> <span class="mh">0x2500</span><span class="p">,</span>
			   <span class="s">&quot;Intel D965&quot;</span><span class="p">,</span> <span class="n">STAC_D965_5ST</span><span class="p">),</span>
	<span class="cm">/* volume-knob fixes */</span>
	<span class="n">SND_PCI_QUIRK_VENDOR</span><span class="p">(</span><span class="mh">0x10cf</span><span class="p">,</span> <span class="s">&quot;FSC&quot;</span><span class="p">,</span> <span class="n">STAC_927X_VOLKNOB</span><span class="p">),</span>
	<span class="p">{}</span> <span class="cm">/* terminator */</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ref9205_pin_configs</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x40000100</span><span class="p">,</span> <span class="mh">0x40000100</span><span class="p">,</span> <span class="mh">0x01016011</span><span class="p">,</span> <span class="mh">0x01014010</span><span class="p">,</span>
	<span class="mh">0x01813122</span><span class="p">,</span> <span class="mh">0x01a19021</span><span class="p">,</span> <span class="mh">0x01019020</span><span class="p">,</span> <span class="mh">0x40000100</span><span class="p">,</span>
	<span class="mh">0x90a000f0</span><span class="p">,</span> <span class="mh">0x90a000f0</span><span class="p">,</span> <span class="mh">0x01441030</span><span class="p">,</span> <span class="mh">0x01c41030</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm">    STAC 9205 pin configs for</span>
<span class="cm">    102801F1</span>
<span class="cm">    102801F2</span>
<span class="cm">    102801FC</span>
<span class="cm">    102801FD</span>
<span class="cm">    10280204</span>
<span class="cm">    1028021F</span>
<span class="cm">    10280228 (Dell Vostro 1500)</span>
<span class="cm">    10280229 (Dell Vostro 1700)</span>
<span class="cm">*/</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dell_9205_m42_pin_configs</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0321101F</span><span class="p">,</span> <span class="mh">0x03A11020</span><span class="p">,</span> <span class="mh">0x400003FA</span><span class="p">,</span> <span class="mh">0x90170310</span><span class="p">,</span>
	<span class="mh">0x400003FB</span><span class="p">,</span> <span class="mh">0x400003FC</span><span class="p">,</span> <span class="mh">0x400003FD</span><span class="p">,</span> <span class="mh">0x40F000F9</span><span class="p">,</span>
	<span class="mh">0x90A60330</span><span class="p">,</span> <span class="mh">0x400003FF</span><span class="p">,</span> <span class="mh">0x0144131F</span><span class="p">,</span> <span class="mh">0x40C003FE</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm">    STAC 9205 pin configs for</span>
<span class="cm">    102801F9</span>
<span class="cm">    102801FA</span>
<span class="cm">    102801FE</span>
<span class="cm">    102801FF (Dell Precision M4300)</span>
<span class="cm">    10280206</span>
<span class="cm">    10280200</span>
<span class="cm">    10280201</span>
<span class="cm">*/</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dell_9205_m43_pin_configs</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0321101f</span><span class="p">,</span> <span class="mh">0x03a11020</span><span class="p">,</span> <span class="mh">0x90a70330</span><span class="p">,</span> <span class="mh">0x90170310</span><span class="p">,</span>
	<span class="mh">0x400000fe</span><span class="p">,</span> <span class="mh">0x400000ff</span><span class="p">,</span> <span class="mh">0x400000fd</span><span class="p">,</span> <span class="mh">0x40f000f9</span><span class="p">,</span>
	<span class="mh">0x400000fa</span><span class="p">,</span> <span class="mh">0x400000fc</span><span class="p">,</span> <span class="mh">0x0144131f</span><span class="p">,</span> <span class="mh">0x40c003f8</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dell_9205_m44_pin_configs</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0421101f</span><span class="p">,</span> <span class="mh">0x04a11020</span><span class="p">,</span> <span class="mh">0x400003fa</span><span class="p">,</span> <span class="mh">0x90170310</span><span class="p">,</span>
	<span class="mh">0x400003fb</span><span class="p">,</span> <span class="mh">0x400003fc</span><span class="p">,</span> <span class="mh">0x400003fd</span><span class="p">,</span> <span class="mh">0x400003f9</span><span class="p">,</span>
	<span class="mh">0x90a60330</span><span class="p">,</span> <span class="mh">0x400003ff</span><span class="p">,</span> <span class="mh">0x01441340</span><span class="p">,</span> <span class="mh">0x40c003fe</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">stac9205_brd_tbl</span><span class="p">[</span><span class="n">STAC_9205_MODELS</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">[</span><span class="n">STAC_9205_REF</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref9205_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9205_DELL_M42</span><span class="p">]</span> <span class="o">=</span> <span class="n">dell_9205_m42_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9205_DELL_M43</span><span class="p">]</span> <span class="o">=</span> <span class="n">dell_9205_m43_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9205_DELL_M44</span><span class="p">]</span> <span class="o">=</span> <span class="n">dell_9205_m44_pin_configs</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9205_EAPD</span><span class="p">]</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="k">const</span> <span class="n">stac9205_models</span><span class="p">[</span><span class="n">STAC_9205_MODELS</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">[</span><span class="n">STAC_9205_AUTO</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;auto&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9205_REF</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;ref&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9205_DELL_M42</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;dell-m42&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9205_DELL_M43</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;dell-m43&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9205_DELL_M44</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;dell-m44&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9205_EAPD</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;eapd&quot;</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_pci_quirk</span> <span class="n">stac9205_cfg_tbl</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* SigmaTel reference board */</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0x2668</span><span class="p">,</span>
		      <span class="s">&quot;DFI LanParty&quot;</span><span class="p">,</span> <span class="n">STAC_9205_REF</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_INTEL</span><span class="p">,</span> <span class="mh">0xfb30</span><span class="p">,</span>
		      <span class="s">&quot;SigmaTel&quot;</span><span class="p">,</span> <span class="n">STAC_9205_REF</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DFI</span><span class="p">,</span> <span class="mh">0x3101</span><span class="p">,</span>
		      <span class="s">&quot;DFI LanParty&quot;</span><span class="p">,</span> <span class="n">STAC_9205_REF</span><span class="p">),</span>
	<span class="cm">/* Dell */</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01f1</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_9205_DELL_M42</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01f2</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_9205_DELL_M42</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01f8</span><span class="p">,</span>
		      <span class="s">&quot;Dell Precision&quot;</span><span class="p">,</span> <span class="n">STAC_9205_DELL_M43</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01f9</span><span class="p">,</span>
		      <span class="s">&quot;Dell Precision&quot;</span><span class="p">,</span> <span class="n">STAC_9205_DELL_M43</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01fa</span><span class="p">,</span>
		      <span class="s">&quot;Dell Precision&quot;</span><span class="p">,</span> <span class="n">STAC_9205_DELL_M43</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01fc</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_9205_DELL_M42</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01fd</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_9205_DELL_M42</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01fe</span><span class="p">,</span>
		      <span class="s">&quot;Dell Precision&quot;</span><span class="p">,</span> <span class="n">STAC_9205_DELL_M43</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x01ff</span><span class="p">,</span>
		      <span class="s">&quot;Dell Precision M4300&quot;</span><span class="p">,</span> <span class="n">STAC_9205_DELL_M43</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x0204</span><span class="p">,</span>
		      <span class="s">&quot;unknown Dell&quot;</span><span class="p">,</span> <span class="n">STAC_9205_DELL_M42</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x0206</span><span class="p">,</span>
		      <span class="s">&quot;Dell Precision&quot;</span><span class="p">,</span> <span class="n">STAC_9205_DELL_M43</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x021b</span><span class="p">,</span>
		      <span class="s">&quot;Dell Precision&quot;</span><span class="p">,</span> <span class="n">STAC_9205_DELL_M43</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x021c</span><span class="p">,</span>
		      <span class="s">&quot;Dell Precision&quot;</span><span class="p">,</span> <span class="n">STAC_9205_DELL_M43</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x021f</span><span class="p">,</span>
		      <span class="s">&quot;Dell Inspiron&quot;</span><span class="p">,</span> <span class="n">STAC_9205_DELL_M44</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x0228</span><span class="p">,</span>
		      <span class="s">&quot;Dell Vostro 1500&quot;</span><span class="p">,</span> <span class="n">STAC_9205_DELL_M42</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_DELL</span><span class="p">,</span> <span class="mh">0x0229</span><span class="p">,</span>
		      <span class="s">&quot;Dell Vostro 1700&quot;</span><span class="p">,</span> <span class="n">STAC_9205_DELL_M42</span><span class="p">),</span>
	<span class="cm">/* Gateway */</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="mh">0x107b</span><span class="p">,</span> <span class="mh">0x0560</span><span class="p">,</span> <span class="s">&quot;Gateway T6834c&quot;</span><span class="p">,</span> <span class="n">STAC_9205_EAPD</span><span class="p">),</span>
	<span class="n">SND_PCI_QUIRK</span><span class="p">(</span><span class="mh">0x107b</span><span class="p">,</span> <span class="mh">0x0565</span><span class="p">,</span> <span class="s">&quot;Gateway T1616&quot;</span><span class="p">,</span> <span class="n">STAC_9205_EAPD</span><span class="p">),</span>
	<span class="p">{}</span> <span class="cm">/* terminator */</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac92xx_set_config_regs</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
				     <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">pincfgs</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">pincfgs</span><span class="p">)</span>
		<span class="k">return</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">pin_nids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">pincfgs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
			<span class="n">snd_hda_codec_set_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">pin_nids</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
						 <span class="n">pincfgs</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * Analog playback callbacks</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_playback_pcm_open</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_pcm_stream</span> <span class="o">*</span><span class="n">hinfo</span><span class="p">,</span>
				      <span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
				      <span class="k">struct</span> <span class="n">snd_pcm_substream</span> <span class="o">*</span><span class="n">substream</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">stream_delay</span><span class="p">)</span>
		<span class="n">msleep</span><span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">stream_delay</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">snd_hda_multi_out_analog_open</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">,</span> <span class="n">substream</span><span class="p">,</span>
					     <span class="n">hinfo</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_playback_pcm_prepare</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_pcm_stream</span> <span class="o">*</span><span class="n">hinfo</span><span class="p">,</span>
					 <span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
					 <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">stream_tag</span><span class="p">,</span>
					 <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">format</span><span class="p">,</span>
					 <span class="k">struct</span> <span class="n">snd_pcm_substream</span> <span class="o">*</span><span class="n">substream</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">snd_hda_multi_out_analog_prepare</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">,</span> <span class="n">stream_tag</span><span class="p">,</span> <span class="n">format</span><span class="p">,</span> <span class="n">substream</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_playback_pcm_cleanup</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_pcm_stream</span> <span class="o">*</span><span class="n">hinfo</span><span class="p">,</span>
					<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
					<span class="k">struct</span> <span class="n">snd_pcm_substream</span> <span class="o">*</span><span class="n">substream</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">snd_hda_multi_out_analog_cleanup</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * Digital playback callbacks</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_dig_playback_pcm_open</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_pcm_stream</span> <span class="o">*</span><span class="n">hinfo</span><span class="p">,</span>
					  <span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
					  <span class="k">struct</span> <span class="n">snd_pcm_substream</span> <span class="o">*</span><span class="n">substream</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">snd_hda_multi_out_dig_open</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_dig_playback_pcm_close</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_pcm_stream</span> <span class="o">*</span><span class="n">hinfo</span><span class="p">,</span>
					   <span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
					   <span class="k">struct</span> <span class="n">snd_pcm_substream</span> <span class="o">*</span><span class="n">substream</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">snd_hda_multi_out_dig_close</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_dig_playback_pcm_prepare</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_pcm_stream</span> <span class="o">*</span><span class="n">hinfo</span><span class="p">,</span>
					 <span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
					 <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">stream_tag</span><span class="p">,</span>
					 <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">format</span><span class="p">,</span>
					 <span class="k">struct</span> <span class="n">snd_pcm_substream</span> <span class="o">*</span><span class="n">substream</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">snd_hda_multi_out_dig_prepare</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">,</span>
					     <span class="n">stream_tag</span><span class="p">,</span> <span class="n">format</span><span class="p">,</span> <span class="n">substream</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_dig_playback_pcm_cleanup</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_pcm_stream</span> <span class="o">*</span><span class="n">hinfo</span><span class="p">,</span>
					<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
					<span class="k">struct</span> <span class="n">snd_pcm_substream</span> <span class="o">*</span><span class="n">substream</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">snd_hda_multi_out_dig_cleanup</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">);</span>
<span class="p">}</span>


<span class="cm">/*</span>
<span class="cm"> * Analog capture callbacks</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_capture_pcm_prepare</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_pcm_stream</span> <span class="o">*</span><span class="n">hinfo</span><span class="p">,</span>
					<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
					<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">stream_tag</span><span class="p">,</span>
					<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">format</span><span class="p">,</span>
					<span class="k">struct</span> <span class="n">snd_pcm_substream</span> <span class="o">*</span><span class="n">substream</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="n">nid</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">adc_nids</span><span class="p">[</span><span class="n">substream</span><span class="o">-&gt;</span><span class="n">number</span><span class="p">];</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">powerdown_adcs</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">msleep</span><span class="p">(</span><span class="mi">40</span><span class="p">);</span>
		<span class="n">snd_hda_codec_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
			<span class="n">AC_VERB_SET_POWER_STATE</span><span class="p">,</span> <span class="n">AC_PWRST_D0</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">snd_hda_codec_setup_stream</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">stream_tag</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">format</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_capture_pcm_cleanup</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_pcm_stream</span> <span class="o">*</span><span class="n">hinfo</span><span class="p">,</span>
					<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
					<span class="k">struct</span> <span class="n">snd_pcm_substream</span> <span class="o">*</span><span class="n">substream</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="n">nid</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">adc_nids</span><span class="p">[</span><span class="n">substream</span><span class="o">-&gt;</span><span class="n">number</span><span class="p">];</span>

	<span class="n">snd_hda_codec_cleanup_stream</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">powerdown_adcs</span><span class="p">)</span>
		<span class="n">snd_hda_codec_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
			<span class="n">AC_VERB_SET_POWER_STATE</span><span class="p">,</span> <span class="n">AC_PWRST_D3</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hda_pcm_stream</span> <span class="n">stac92xx_pcm_digital_playback</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">substreams</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="p">.</span><span class="n">channels_min</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="p">.</span><span class="n">channels_max</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="cm">/* NID is set in stac92xx_build_pcms */</span>
	<span class="p">.</span><span class="n">ops</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">open</span> <span class="o">=</span> <span class="n">stac92xx_dig_playback_pcm_open</span><span class="p">,</span>
		<span class="p">.</span><span class="n">close</span> <span class="o">=</span> <span class="n">stac92xx_dig_playback_pcm_close</span><span class="p">,</span>
		<span class="p">.</span><span class="n">prepare</span> <span class="o">=</span> <span class="n">stac92xx_dig_playback_pcm_prepare</span><span class="p">,</span>
		<span class="p">.</span><span class="n">cleanup</span> <span class="o">=</span> <span class="n">stac92xx_dig_playback_pcm_cleanup</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hda_pcm_stream</span> <span class="n">stac92xx_pcm_digital_capture</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">substreams</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="p">.</span><span class="n">channels_min</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="p">.</span><span class="n">channels_max</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="cm">/* NID is set in stac92xx_build_pcms */</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hda_pcm_stream</span> <span class="n">stac92xx_pcm_analog_playback</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">substreams</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="p">.</span><span class="n">channels_min</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="p">.</span><span class="n">channels_max</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="p">.</span><span class="n">nid</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">,</span> <span class="cm">/* NID to query formats and rates */</span>
	<span class="p">.</span><span class="n">ops</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">open</span> <span class="o">=</span> <span class="n">stac92xx_playback_pcm_open</span><span class="p">,</span>
		<span class="p">.</span><span class="n">prepare</span> <span class="o">=</span> <span class="n">stac92xx_playback_pcm_prepare</span><span class="p">,</span>
		<span class="p">.</span><span class="n">cleanup</span> <span class="o">=</span> <span class="n">stac92xx_playback_pcm_cleanup</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hda_pcm_stream</span> <span class="n">stac92xx_pcm_analog_alt_playback</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">substreams</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="p">.</span><span class="n">channels_min</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="p">.</span><span class="n">channels_max</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="p">.</span><span class="n">nid</span> <span class="o">=</span> <span class="mh">0x06</span><span class="p">,</span> <span class="cm">/* NID to query formats and rates */</span>
	<span class="p">.</span><span class="n">ops</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">open</span> <span class="o">=</span> <span class="n">stac92xx_playback_pcm_open</span><span class="p">,</span>
		<span class="p">.</span><span class="n">prepare</span> <span class="o">=</span> <span class="n">stac92xx_playback_pcm_prepare</span><span class="p">,</span>
		<span class="p">.</span><span class="n">cleanup</span> <span class="o">=</span> <span class="n">stac92xx_playback_pcm_cleanup</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hda_pcm_stream</span> <span class="n">stac92xx_pcm_analog_capture</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">channels_min</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="p">.</span><span class="n">channels_max</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="cm">/* NID + .substreams is set in stac92xx_build_pcms */</span>
	<span class="p">.</span><span class="n">ops</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">prepare</span> <span class="o">=</span> <span class="n">stac92xx_capture_pcm_prepare</span><span class="p">,</span>
		<span class="p">.</span><span class="n">cleanup</span> <span class="o">=</span> <span class="n">stac92xx_capture_pcm_cleanup</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_build_pcms</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hda_pcm</span> <span class="o">*</span><span class="n">info</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">pcm_rec</span><span class="p">;</span>

	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">num_pcms</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">pcm_info</span> <span class="o">=</span> <span class="n">info</span><span class="p">;</span>

	<span class="n">info</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC92xx Analog&quot;</span><span class="p">;</span>
	<span class="n">info</span><span class="o">-&gt;</span><span class="n">stream</span><span class="p">[</span><span class="n">SNDRV_PCM_STREAM_PLAYBACK</span><span class="p">]</span> <span class="o">=</span> <span class="n">stac92xx_pcm_analog_playback</span><span class="p">;</span>
	<span class="n">info</span><span class="o">-&gt;</span><span class="n">stream</span><span class="p">[</span><span class="n">SNDRV_PCM_STREAM_PLAYBACK</span><span class="p">].</span><span class="n">nid</span> <span class="o">=</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dac_nids</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="n">info</span><span class="o">-&gt;</span><span class="n">stream</span><span class="p">[</span><span class="n">SNDRV_PCM_STREAM_CAPTURE</span><span class="p">]</span> <span class="o">=</span> <span class="n">stac92xx_pcm_analog_capture</span><span class="p">;</span>
	<span class="n">info</span><span class="o">-&gt;</span><span class="n">stream</span><span class="p">[</span><span class="n">SNDRV_PCM_STREAM_CAPTURE</span><span class="p">].</span><span class="n">nid</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">adc_nids</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="n">info</span><span class="o">-&gt;</span><span class="n">stream</span><span class="p">[</span><span class="n">SNDRV_PCM_STREAM_CAPTURE</span><span class="p">].</span><span class="n">substreams</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_adcs</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">alt_switch</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">codec</span><span class="o">-&gt;</span><span class="n">num_pcms</span><span class="o">++</span><span class="p">;</span>
		<span class="n">info</span><span class="o">++</span><span class="p">;</span>
		<span class="n">info</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC92xx Analog Alt&quot;</span><span class="p">;</span>
		<span class="n">info</span><span class="o">-&gt;</span><span class="n">stream</span><span class="p">[</span><span class="n">SNDRV_PCM_STREAM_PLAYBACK</span><span class="p">]</span> <span class="o">=</span> <span class="n">stac92xx_pcm_analog_alt_playback</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dig_out_nid</span> <span class="o">||</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dig_in_nid</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">codec</span><span class="o">-&gt;</span><span class="n">num_pcms</span><span class="o">++</span><span class="p">;</span>
		<span class="n">info</span><span class="o">++</span><span class="p">;</span>
		<span class="n">info</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC92xx Digital&quot;</span><span class="p">;</span>
		<span class="n">info</span><span class="o">-&gt;</span><span class="n">pcm_type</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">dig_out_type</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dig_out_nid</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">info</span><span class="o">-&gt;</span><span class="n">stream</span><span class="p">[</span><span class="n">SNDRV_PCM_STREAM_PLAYBACK</span><span class="p">]</span> <span class="o">=</span> <span class="n">stac92xx_pcm_digital_playback</span><span class="p">;</span>
			<span class="n">info</span><span class="o">-&gt;</span><span class="n">stream</span><span class="p">[</span><span class="n">SNDRV_PCM_STREAM_PLAYBACK</span><span class="p">].</span><span class="n">nid</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dig_out_nid</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">dig_in_nid</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">info</span><span class="o">-&gt;</span><span class="n">stream</span><span class="p">[</span><span class="n">SNDRV_PCM_STREAM_CAPTURE</span><span class="p">]</span> <span class="o">=</span> <span class="n">stac92xx_pcm_digital_capture</span><span class="p">;</span>
			<span class="n">info</span><span class="o">-&gt;</span><span class="n">stream</span><span class="p">[</span><span class="n">SNDRV_PCM_STREAM_CAPTURE</span><span class="p">].</span><span class="n">nid</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dig_in_nid</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac92xx_auto_set_pinctl</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pin_type</span><span class="p">)</span>

<span class="p">{</span>
	<span class="n">snd_hda_set_pin_ctl_cache</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">pin_type</span><span class="p">);</span>
<span class="p">}</span>

<span class="cp">#define stac92xx_hp_switch_info		snd_ctl_boolean_mono_info</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_hp_switch_get</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>

	<span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">integer</span><span class="p">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">!!</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">hp_switch</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="n">stac_issue_unsol_event</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">);</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_hp_switch_put</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">nid</span> <span class="o">=</span> <span class="n">kcontrol</span><span class="o">-&gt;</span><span class="n">private_value</span><span class="p">;</span>
 
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">hp_switch</span> <span class="o">=</span> <span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">integer</span><span class="p">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">?</span> <span class="n">nid</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>

	<span class="cm">/* check to be sure that the ports are up to date with</span>
<span class="cm">	 * switch changes</span>
<span class="cm">	 */</span>
	<span class="n">stac_issue_unsol_event</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_dc_bias_info</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
				<span class="k">struct</span> <span class="n">snd_ctl_elem_info</span> <span class="o">*</span><span class="n">uinfo</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="k">const</span> <span class="n">texts</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
		<span class="s">&quot;Mic In&quot;</span><span class="p">,</span> <span class="s">&quot;Line In&quot;</span><span class="p">,</span> <span class="s">&quot;Line Out&quot;</span>
	<span class="p">};</span>

	<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="n">nid</span> <span class="o">=</span> <span class="n">kcontrol</span><span class="o">-&gt;</span><span class="n">private_value</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">nid</span> <span class="o">==</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">mic_switch</span> <span class="o">||</span> <span class="n">nid</span> <span class="o">==</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">line_switch</span><span class="p">)</span>
		<span class="n">i</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

	<span class="n">uinfo</span><span class="o">-&gt;</span><span class="n">type</span> <span class="o">=</span> <span class="n">SNDRV_CTL_ELEM_TYPE_ENUMERATED</span><span class="p">;</span>
	<span class="n">uinfo</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">enumerated</span><span class="p">.</span><span class="n">items</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
	<span class="n">uinfo</span><span class="o">-&gt;</span><span class="n">count</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">uinfo</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">enumerated</span><span class="p">.</span><span class="n">item</span> <span class="o">&gt;=</span> <span class="n">i</span><span class="p">)</span>
		<span class="n">uinfo</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">enumerated</span><span class="p">.</span><span class="n">item</span> <span class="o">=</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">strcpy</span><span class="p">(</span><span class="n">uinfo</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">enumerated</span><span class="p">.</span><span class="n">name</span><span class="p">,</span>
		<span class="n">texts</span><span class="p">[</span><span class="n">uinfo</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">enumerated</span><span class="p">.</span><span class="n">item</span><span class="p">]);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_dc_bias_get</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
				<span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="n">hda_nid_t</span> <span class="n">nid</span> <span class="o">=</span> <span class="n">kcontrol</span><span class="o">-&gt;</span><span class="n">private_value</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">vref</span> <span class="o">=</span> <span class="n">stac92xx_vref_get</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">vref</span> <span class="o">==</span> <span class="n">snd_hda_get_default_vref</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">))</span>
		<span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">enumerated</span><span class="p">.</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">vref</span> <span class="o">==</span> <span class="n">AC_PINCTL_VREF_GRD</span><span class="p">)</span>
		<span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">enumerated</span><span class="p">.</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">vref</span> <span class="o">==</span> <span class="n">AC_PINCTL_VREF_HIZ</span><span class="p">)</span>
		<span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">enumerated</span><span class="p">.</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_dc_bias_put</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
				<span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">new_vref</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">error</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="n">nid</span> <span class="o">=</span> <span class="n">kcontrol</span><span class="o">-&gt;</span><span class="n">private_value</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">enumerated</span><span class="p">.</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">new_vref</span> <span class="o">=</span> <span class="n">snd_hda_get_default_vref</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
	<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">enumerated</span><span class="p">.</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
		<span class="n">new_vref</span> <span class="o">=</span> <span class="n">AC_PINCTL_VREF_GRD</span><span class="p">;</span>
	<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">enumerated</span><span class="p">.</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
		<span class="n">new_vref</span> <span class="o">=</span> <span class="n">AC_PINCTL_VREF_HIZ</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">new_vref</span> <span class="o">!=</span> <span class="n">stac92xx_vref_get</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">error</span> <span class="o">=</span> <span class="n">stac92xx_vref_set</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">new_vref</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">error</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_io_switch_info</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
				<span class="k">struct</span> <span class="n">snd_ctl_elem_info</span> <span class="o">*</span><span class="n">uinfo</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">char</span> <span class="o">*</span><span class="n">texts</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">kcontrol</span><span class="o">-&gt;</span><span class="n">private_value</span> <span class="o">==</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">line_switch</span><span class="p">)</span>
		<span class="n">texts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;Line In&quot;</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="n">texts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;Mic In&quot;</span><span class="p">;</span>
	<span class="n">texts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;Line Out&quot;</span><span class="p">;</span>
	<span class="n">uinfo</span><span class="o">-&gt;</span><span class="n">type</span> <span class="o">=</span> <span class="n">SNDRV_CTL_ELEM_TYPE_ENUMERATED</span><span class="p">;</span>
	<span class="n">uinfo</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">enumerated</span><span class="p">.</span><span class="n">items</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
	<span class="n">uinfo</span><span class="o">-&gt;</span><span class="n">count</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">uinfo</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">enumerated</span><span class="p">.</span><span class="n">item</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">)</span>
		<span class="n">uinfo</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">enumerated</span><span class="p">.</span><span class="n">item</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">strcpy</span><span class="p">(</span><span class="n">uinfo</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">enumerated</span><span class="p">.</span><span class="n">name</span><span class="p">,</span>
		<span class="n">texts</span><span class="p">[</span><span class="n">uinfo</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">enumerated</span><span class="p">.</span><span class="n">item</span><span class="p">]);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_io_switch_get</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span> <span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="n">nid</span> <span class="o">=</span> <span class="n">kcontrol</span><span class="o">-&gt;</span><span class="n">private_value</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">io_idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">nid</span> <span class="o">==</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">mic_switch</span><span class="p">)</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">enumerated</span><span class="p">.</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">io_switch</span><span class="p">[</span><span class="n">io_idx</span><span class="p">];</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_io_switch_put</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span> <span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
        <span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="n">nid</span> <span class="o">=</span> <span class="n">kcontrol</span><span class="o">-&gt;</span><span class="n">private_value</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">io_idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">nid</span> <span class="o">==</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">mic_switch</span><span class="p">)</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">val</span> <span class="o">=</span> <span class="o">!!</span><span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">enumerated</span><span class="p">.</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">io_switch</span><span class="p">[</span><span class="n">io_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">val</span><span class="p">)</span>
		<span class="n">stac92xx_auto_set_pinctl</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">AC_PINCTL_OUT_EN</span><span class="p">);</span>
	<span class="k">else</span> <span class="p">{</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">pinctl</span> <span class="o">=</span> <span class="n">AC_PINCTL_IN_EN</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">io_idx</span><span class="p">)</span> <span class="cm">/* set VREF for mic */</span>
			<span class="n">pinctl</span> <span class="o">|=</span> <span class="n">snd_hda_get_default_vref</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
		<span class="n">stac92xx_auto_set_pinctl</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">pinctl</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="cm">/* check the auto-mute again: we need to mute/unmute the speaker</span>
<span class="cm">	 * appropriately according to the pin direction</span>
<span class="cm">	 */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">hp_detect</span><span class="p">)</span>
		<span class="n">stac_issue_unsol_event</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>

        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#define stac92xx_clfe_switch_info snd_ctl_boolean_mono_info</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_clfe_switch_get</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>

	<span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">integer</span><span class="p">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">clfe_swap</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_clfe_switch_put</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="n">nid</span> <span class="o">=</span> <span class="n">kcontrol</span><span class="o">-&gt;</span><span class="n">private_value</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">val</span> <span class="o">=</span> <span class="o">!!</span><span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">integer</span><span class="p">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">clfe_swap</span> <span class="o">==</span> <span class="n">val</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">clfe_swap</span> <span class="o">=</span> <span class="n">val</span><span class="p">;</span>

	<span class="n">snd_hda_codec_write_cache</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">AC_VERB_SET_EAPD_BTLENABLE</span><span class="p">,</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">clfe_swap</span> <span class="o">?</span> <span class="mh">0x4</span> <span class="o">:</span> <span class="mh">0x0</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#define STAC_CODEC_HP_SWITCH(xname) \</span>
<span class="cp">	{ .iface = SNDRV_CTL_ELEM_IFACE_MIXER, \</span>
<span class="cp">	  .name = xname, \</span>
<span class="cp">	  .index = 0, \</span>
<span class="cp">	  .info = stac92xx_hp_switch_info, \</span>
<span class="cp">	  .get = stac92xx_hp_switch_get, \</span>
<span class="cp">	  .put = stac92xx_hp_switch_put, \</span>
<span class="cp">	}</span>

<span class="cp">#define STAC_CODEC_IO_SWITCH(xname, xpval) \</span>
<span class="cp">	{ .iface = SNDRV_CTL_ELEM_IFACE_MIXER, \</span>
<span class="cp">	  .name = xname, \</span>
<span class="cp">	  .index = 0, \</span>
<span class="cp">          .info = stac92xx_io_switch_info, \</span>
<span class="cp">          .get = stac92xx_io_switch_get, \</span>
<span class="cp">          .put = stac92xx_io_switch_put, \</span>
<span class="cp">          .private_value = xpval, \</span>
<span class="cp">	}</span>

<span class="cp">#define STAC_CODEC_CLFE_SWITCH(xname, xpval) \</span>
<span class="cp">	{ .iface = SNDRV_CTL_ELEM_IFACE_MIXER, \</span>
<span class="cp">	  .name = xname, \</span>
<span class="cp">	  .index = 0, \</span>
<span class="cp">	  .info = stac92xx_clfe_switch_info, \</span>
<span class="cp">	  .get = stac92xx_clfe_switch_get, \</span>
<span class="cp">	  .put = stac92xx_clfe_switch_put, \</span>
<span class="cp">	  .private_value = xpval, \</span>
<span class="cp">	}</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">STAC_CTL_WIDGET_VOL</span><span class="p">,</span>
	<span class="n">STAC_CTL_WIDGET_MUTE</span><span class="p">,</span>
	<span class="n">STAC_CTL_WIDGET_MUTE_BEEP</span><span class="p">,</span>
	<span class="n">STAC_CTL_WIDGET_MONO_MUX</span><span class="p">,</span>
	<span class="n">STAC_CTL_WIDGET_HP_SWITCH</span><span class="p">,</span>
	<span class="n">STAC_CTL_WIDGET_IO_SWITCH</span><span class="p">,</span>
	<span class="n">STAC_CTL_WIDGET_CLFE_SWITCH</span><span class="p">,</span>
	<span class="n">STAC_CTL_WIDGET_DC_BIAS</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">stac92xx_control_templates</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">HDA_CODEC_VOLUME</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">HDA_CODEC_MUTE</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">HDA_CODEC_MUTE_BEEP</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">STAC_MONO_MUX</span><span class="p">,</span>
	<span class="n">STAC_CODEC_HP_SWITCH</span><span class="p">(</span><span class="nb">NULL</span><span class="p">),</span>
	<span class="n">STAC_CODEC_IO_SWITCH</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">STAC_CODEC_CLFE_SWITCH</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
	<span class="n">DC_BIAS</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="p">};</span>

<span class="cm">/* add dynamic controls */</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="o">*</span>
<span class="nf">stac_control_new</span><span class="p">(</span><span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span><span class="p">,</span>
		 <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="o">*</span><span class="n">ktemp</span><span class="p">,</span>
		 <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span>
		 <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">subdev</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="o">*</span><span class="n">knew</span><span class="p">;</span>

	<span class="n">snd_array_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">kctls</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">knew</span><span class="p">),</span> <span class="mi">32</span><span class="p">);</span>
	<span class="n">knew</span> <span class="o">=</span> <span class="n">snd_array_new</span><span class="p">(</span><span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">kctls</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">knew</span><span class="p">)</span>
		<span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="o">*</span><span class="n">knew</span> <span class="o">=</span> <span class="o">*</span><span class="n">ktemp</span><span class="p">;</span>
	<span class="n">knew</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">=</span> <span class="n">kstrdup</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">GFP_KERNEL</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">knew</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* roolback */</span>
		<span class="n">memset</span><span class="p">(</span><span class="n">knew</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">knew</span><span class="p">));</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">kctls</span><span class="p">.</span><span class="n">alloced</span><span class="o">--</span><span class="p">;</span>
		<span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">knew</span><span class="o">-&gt;</span><span class="n">subdevice</span> <span class="o">=</span> <span class="n">subdev</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">knew</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_add_control_temp</span><span class="p">(</span><span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span><span class="p">,</span>
				     <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="o">*</span><span class="n">ktemp</span><span class="p">,</span>
				     <span class="kt">int</span> <span class="n">idx</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span>
				     <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">val</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="o">*</span><span class="n">knew</span> <span class="o">=</span> <span class="n">stac_control_new</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">ktemp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
							 <span class="n">HDA_SUBDEV_AMP_FLAG</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">knew</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>
	<span class="n">knew</span><span class="o">-&gt;</span><span class="n">index</span> <span class="o">=</span> <span class="n">idx</span><span class="p">;</span>
	<span class="n">knew</span><span class="o">-&gt;</span><span class="n">private_value</span> <span class="o">=</span> <span class="n">val</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">stac92xx_add_control_idx</span><span class="p">(</span><span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span><span class="p">,</span>
					   <span class="kt">int</span> <span class="n">type</span><span class="p">,</span> <span class="kt">int</span> <span class="n">idx</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span>
					   <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">val</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">stac92xx_add_control_temp</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span>
					 <span class="o">&amp;</span><span class="n">stac92xx_control_templates</span><span class="p">[</span><span class="n">type</span><span class="p">],</span>
					 <span class="n">idx</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">);</span>
<span class="p">}</span>


<span class="cm">/* add dynamic controls */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">stac92xx_add_control</span><span class="p">(</span><span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span><span class="p">,</span> <span class="kt">int</span> <span class="n">type</span><span class="p">,</span>
				       <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">val</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">stac92xx_add_control_idx</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">type</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">stac_input_src_temp</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">iface</span> <span class="o">=</span> <span class="n">SNDRV_CTL_ELEM_IFACE_MIXER</span><span class="p">,</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Input Source&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">info</span> <span class="o">=</span> <span class="n">stac92xx_mux_enum_info</span><span class="p">,</span>
	<span class="p">.</span><span class="n">get</span> <span class="o">=</span> <span class="n">stac92xx_mux_enum_get</span><span class="p">,</span>
	<span class="p">.</span><span class="n">put</span> <span class="o">=</span> <span class="n">stac92xx_mux_enum_put</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">stac92xx_add_jack_mode_control</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
						<span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">,</span> <span class="kt">int</span> <span class="n">idx</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">def_conf</span> <span class="o">=</span> <span class="n">snd_hda_codec_get_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">control</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="mi">22</span><span class="p">];</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">snd_hda_get_input_pin_attr</span><span class="p">(</span><span class="n">def_conf</span><span class="p">)</span> <span class="o">!=</span> <span class="n">INPUT_PIN_ATTR_INT</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">snd_hda_get_default_vref</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">)</span> <span class="o">==</span> <span class="n">AC_PINCTL_VREF_GRD</span>
			<span class="o">&amp;&amp;</span> <span class="n">nid</span> <span class="o">==</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">line_switch</span><span class="p">)</span>
			<span class="n">control</span> <span class="o">=</span> <span class="n">STAC_CTL_WIDGET_IO_SWITCH</span><span class="p">;</span>
		<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">snd_hda_query_pin_caps</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">)</span>
			<span class="o">&amp;</span> <span class="p">(</span><span class="n">AC_PINCAP_VREF_GRD</span> <span class="o">&lt;&lt;</span> <span class="n">AC_PINCAP_VREF_SHIFT</span><span class="p">))</span>
			<span class="n">control</span> <span class="o">=</span> <span class="n">STAC_CTL_WIDGET_DC_BIAS</span><span class="p">;</span>
		<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">nid</span> <span class="o">==</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">mic_switch</span><span class="p">)</span>
			<span class="n">control</span> <span class="o">=</span> <span class="n">STAC_CTL_WIDGET_IO_SWITCH</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">control</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">snd_hda_get_pin_label</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">,</span>
				      <span class="n">name</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="nb">NULL</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">stac92xx_add_control</span><span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span>
					<span class="n">strcat</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s">&quot; Jack Mode&quot;</span><span class="p">),</span> <span class="n">nid</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_add_input_source</span><span class="p">(</span><span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="o">*</span><span class="n">knew</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hda_input_mux</span> <span class="o">*</span><span class="n">imux</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">private_imux</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_mic</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span> <span class="cm">/* no need for input source */</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_adcs</span> <span class="o">||</span> <span class="n">imux</span><span class="o">-&gt;</span><span class="n">num_items</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span> <span class="cm">/* no need for input source control */</span>
	<span class="n">knew</span> <span class="o">=</span> <span class="n">stac_control_new</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">stac_input_src_temp</span><span class="p">,</span>
				<span class="n">stac_input_src_temp</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">knew</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>
	<span class="n">knew</span><span class="o">-&gt;</span><span class="n">count</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_adcs</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* check whether the line-input can be used as line-out */</span>
<span class="k">static</span> <span class="n">hda_nid_t</span> <span class="nf">check_line_out_switch</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">auto_pin_cfg</span> <span class="o">*</span><span class="n">cfg</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">pincap</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_out_type</span> <span class="o">!=</span> <span class="n">AUTO_PIN_LINE_OUT</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">num_inputs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">cfg</span><span class="o">-&gt;</span><span class="n">inputs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">type</span> <span class="o">==</span> <span class="n">AUTO_PIN_LINE_IN</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">nid</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">inputs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">pin</span><span class="p">;</span>
			<span class="n">pincap</span> <span class="o">=</span> <span class="n">snd_hda_query_pin_caps</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">pincap</span> <span class="o">&amp;</span> <span class="n">AC_PINCAP_OUT</span><span class="p">)</span>
				<span class="k">return</span> <span class="n">nid</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">hda_nid_t</span> <span class="n">get_unassigned_dac</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">);</span>

<span class="cm">/* check whether the mic-input can be used as line-out */</span>
<span class="k">static</span> <span class="n">hda_nid_t</span> <span class="nf">check_mic_out_switch</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="o">*</span><span class="n">dac</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">auto_pin_cfg</span> <span class="o">*</span><span class="n">cfg</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">def_conf</span><span class="p">,</span> <span class="n">pincap</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="o">*</span><span class="n">dac</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_out_type</span> <span class="o">!=</span> <span class="n">AUTO_PIN_LINE_OUT</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">num_inputs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">hda_nid_t</span> <span class="n">nid</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">inputs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">pin</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">cfg</span><span class="o">-&gt;</span><span class="n">inputs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">type</span> <span class="o">!=</span> <span class="n">AUTO_PIN_MIC</span><span class="p">)</span>
			<span class="k">continue</span><span class="p">;</span>
		<span class="n">def_conf</span> <span class="o">=</span> <span class="n">snd_hda_codec_get_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
		<span class="cm">/* some laptops have an internal analog microphone</span>
<span class="cm">		 * which can&#39;t be used as a output */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">snd_hda_get_input_pin_attr</span><span class="p">(</span><span class="n">def_conf</span><span class="p">)</span> <span class="o">!=</span> <span class="n">INPUT_PIN_ATTR_INT</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">pincap</span> <span class="o">=</span> <span class="n">snd_hda_query_pin_caps</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">pincap</span> <span class="o">&amp;</span> <span class="n">AC_PINCAP_OUT</span><span class="p">)</span> <span class="p">{</span>
				<span class="o">*</span><span class="n">dac</span> <span class="o">=</span> <span class="n">get_unassigned_dac</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="n">dac</span><span class="p">)</span>
					<span class="k">return</span> <span class="n">nid</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">is_in_dac_nids</span><span class="p">(</span><span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">num_dacs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dac_nids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">nid</span><span class="p">)</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">check_all_dac_nids</span><span class="p">(</span><span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">is_in_dac_nids</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">nid</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">hp_outs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">hp_dacs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">nid</span><span class="p">)</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">speaker_outs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">speaker_dacs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">nid</span><span class="p">)</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">hda_nid_t</span> <span class="nf">get_unassigned_dac</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">auto_pin_cfg</span> <span class="o">*</span><span class="n">cfg</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">j</span><span class="p">,</span> <span class="n">conn_len</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="n">conn</span><span class="p">[</span><span class="n">HDA_MAX_CONNECTIONS</span><span class="p">],</span> <span class="n">fallback_dac</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">wcaps</span><span class="p">,</span> <span class="n">wtype</span><span class="p">;</span>

	<span class="n">conn_len</span> <span class="o">=</span> <span class="n">snd_hda_get_connections</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">conn</span><span class="p">,</span>
					   <span class="n">HDA_MAX_CONNECTIONS</span><span class="p">);</span>
	<span class="cm">/* 92HD88: trace back up the link of nids to find the DAC */</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">conn_len</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">get_wcaps_type</span><span class="p">(</span><span class="n">get_wcaps</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">conn</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
					<span class="o">!=</span> <span class="n">AC_WID_AUD_OUT</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">nid</span> <span class="o">=</span> <span class="n">conn</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="n">conn_len</span> <span class="o">=</span> <span class="n">snd_hda_get_connections</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">conn</span><span class="p">,</span>
			<span class="n">HDA_MAX_CONNECTIONS</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">conn_len</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">wcaps</span> <span class="o">=</span> <span class="n">get_wcaps</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">conn</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
		<span class="n">wtype</span> <span class="o">=</span> <span class="n">get_wcaps_type</span><span class="p">(</span><span class="n">wcaps</span><span class="p">);</span>
		<span class="cm">/* we check only analog outputs */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">wtype</span> <span class="o">!=</span> <span class="n">AC_WID_AUD_OUT</span> <span class="o">||</span> <span class="p">(</span><span class="n">wcaps</span> <span class="o">&amp;</span> <span class="n">AC_WCAP_DIGITAL</span><span class="p">))</span>
			<span class="k">continue</span><span class="p">;</span>
		<span class="cm">/* if this route has a free DAC, assign it */</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">check_all_dac_nids</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">conn</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">conn_len</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
				<span class="cm">/* select this DAC in the pin&#39;s input mux */</span>
				<span class="n">snd_hda_codec_write_cache</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
						  <span class="n">AC_VERB_SET_CONNECT_SEL</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">return</span> <span class="n">conn</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="cm">/* if all DACs are already assigned, connect to the primary DAC,</span>
<span class="cm">	   unless we&#39;re assigning a secondary headphone */</span>
	<span class="n">fallback_dac</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dac_nids</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">hp_nid</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">hp_outs</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">cfg</span><span class="o">-&gt;</span><span class="n">hp_pins</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">nid</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">fallback_dac</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">hp_nid</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">conn_len</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">conn_len</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">conn</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">fallback_dac</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">snd_hda_codec_write_cache</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
						  <span class="n">AC_VERB_SET_CONNECT_SEL</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="n">add_spec_dacs</span><span class="p">(</span><span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">add_spec_extra_dacs</span><span class="p">(</span><span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Fill in the dac_nids table from the parsed pin configuration</span>
<span class="cm"> * This function only works when every pin in line_out_pins[]</span>
<span class="cm"> * contains atleast one DAC in its connection list. Some 92xx</span>
<span class="cm"> * codecs are not connected directly to a DAC, such as the 9200</span>
<span class="cm"> * and 9202/925x. For those, dac_nids[] must be hard-coded.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_auto_fill_dac_nids</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">auto_pin_cfg</span> <span class="o">*</span><span class="n">cfg</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">,</span> <span class="n">dac</span><span class="p">;</span>
	
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_outs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">nid</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_out_pins</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="n">dac</span> <span class="o">=</span> <span class="n">get_unassigned_dac</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">dac</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">num_dacs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
				<span class="cm">/* we have already working output pins,</span>
<span class="cm">				 * so let&#39;s drop the broken ones again</span>
<span class="cm">				 */</span>
				<span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_outs</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">num_dacs</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="cm">/* error out, no available DAC found */</span>
			<span class="n">snd_printk</span><span class="p">(</span><span class="n">KERN_ERR</span>
				   <span class="s">&quot;%s: No available DAC for pin 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
				   <span class="n">__func__</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
			<span class="k">return</span> <span class="o">-</span><span class="n">ENODEV</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">add_spec_dacs</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">dac</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">hp_outs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">nid</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">hp_pins</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="n">dac</span> <span class="o">=</span> <span class="n">get_unassigned_dac</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">dac</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">hp_nid</span><span class="p">)</span>
				<span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">hp_nid</span> <span class="o">=</span> <span class="n">dac</span><span class="p">;</span>
			<span class="k">else</span>
				<span class="n">add_spec_extra_dacs</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">dac</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">hp_dacs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dac</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">speaker_outs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">nid</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">speaker_pins</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="n">dac</span> <span class="o">=</span> <span class="n">get_unassigned_dac</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">dac</span><span class="p">)</span>
			<span class="n">add_spec_extra_dacs</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">dac</span><span class="p">);</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">speaker_dacs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dac</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="cm">/* add line-in as output */</span>
	<span class="n">nid</span> <span class="o">=</span> <span class="n">check_line_out_switch</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">nid</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">dac</span> <span class="o">=</span> <span class="n">get_unassigned_dac</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">dac</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">snd_printdd</span><span class="p">(</span><span class="s">&quot;STAC: Add line-in 0x%x as output %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
				    <span class="n">nid</span><span class="p">,</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_outs</span><span class="p">);</span>
			<span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_out_pins</span><span class="p">[</span><span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_outs</span><span class="p">]</span> <span class="o">=</span> <span class="n">nid</span><span class="p">;</span>
			<span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_outs</span><span class="o">++</span><span class="p">;</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">line_switch</span> <span class="o">=</span> <span class="n">nid</span><span class="p">;</span>
			<span class="n">add_spec_dacs</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">dac</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="cm">/* add mic as output */</span>
	<span class="n">nid</span> <span class="o">=</span> <span class="n">check_mic_out_switch</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">dac</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">nid</span> <span class="o">&amp;&amp;</span> <span class="n">dac</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">snd_printdd</span><span class="p">(</span><span class="s">&quot;STAC: Add mic-in 0x%x as output %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
			    <span class="n">nid</span><span class="p">,</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_outs</span><span class="p">);</span>
		<span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_out_pins</span><span class="p">[</span><span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_outs</span><span class="p">]</span> <span class="o">=</span> <span class="n">nid</span><span class="p">;</span>
		<span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_outs</span><span class="o">++</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">mic_switch</span> <span class="o">=</span> <span class="n">nid</span><span class="p">;</span>
		<span class="n">add_spec_dacs</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">dac</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">snd_printd</span><span class="p">(</span><span class="s">&quot;stac92xx: dac_nids=%d (0x%x/0x%x/0x%x/0x%x/0x%x)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
		   <span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">num_dacs</span><span class="p">,</span>
		   <span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dac_nids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
		   <span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dac_nids</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
		   <span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dac_nids</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
		   <span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dac_nids</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
		   <span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dac_nids</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* create volume control/switch for the given prefx type */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">create_controls_idx</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">pfx</span><span class="p">,</span>
			       <span class="kt">int</span> <span class="n">idx</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">,</span> <span class="kt">int</span> <span class="n">chs</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">err</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">check_volume_offset</span><span class="p">)</span> <span class="p">{</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">caps</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">nums</span><span class="p">,</span> <span class="n">db_scale</span><span class="p">;</span>
		<span class="n">caps</span> <span class="o">=</span> <span class="n">query_amp_caps</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">);</span>
		<span class="n">step</span> <span class="o">=</span> <span class="p">(</span><span class="n">caps</span> <span class="o">&amp;</span> <span class="n">AC_AMPCAP_STEP_SIZE</span><span class="p">)</span> <span class="o">&gt;&gt;</span>
			<span class="n">AC_AMPCAP_STEP_SIZE_SHIFT</span><span class="p">;</span>
		<span class="n">step</span> <span class="o">=</span> <span class="p">(</span><span class="n">step</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">25</span><span class="p">;</span> <span class="cm">/* in .01dB unit */</span>
		<span class="n">nums</span> <span class="o">=</span> <span class="p">(</span><span class="n">caps</span> <span class="o">&amp;</span> <span class="n">AC_AMPCAP_NUM_STEPS</span><span class="p">)</span> <span class="o">&gt;&gt;</span>
			<span class="n">AC_AMPCAP_NUM_STEPS_SHIFT</span><span class="p">;</span>
		<span class="n">db_scale</span> <span class="o">=</span> <span class="n">nums</span> <span class="o">*</span> <span class="n">step</span><span class="p">;</span>
		<span class="cm">/* if dB scale is over -64dB, and finer enough,</span>
<span class="cm">		 * let&#39;s reduce it to half</span>
<span class="cm">		 */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">db_scale</span> <span class="o">&gt;</span> <span class="mi">6400</span> <span class="o">&amp;&amp;</span> <span class="n">nums</span> <span class="o">&gt;=</span> <span class="mh">0x1f</span><span class="p">)</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">volume_offset</span> <span class="o">=</span> <span class="n">nums</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">check_volume_offset</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">sprintf</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s">&quot;%s Playback Volume&quot;</span><span class="p">,</span> <span class="n">pfx</span><span class="p">);</span>
	<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_add_control_idx</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">STAC_CTL_WIDGET_VOL</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
		<span class="n">HDA_COMPOSE_AMP_VAL_OFS</span><span class="p">(</span><span class="n">nid</span><span class="p">,</span> <span class="n">chs</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">,</span>
					<span class="n">spec</span><span class="o">-&gt;</span><span class="n">volume_offset</span><span class="p">));</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="n">sprintf</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s">&quot;%s Playback Switch&quot;</span><span class="p">,</span> <span class="n">pfx</span><span class="p">);</span>
	<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_add_control_idx</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">STAC_CTL_WIDGET_MUTE</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
				   <span class="n">HDA_COMPOSE_AMP_VAL</span><span class="p">(</span><span class="n">nid</span><span class="p">,</span> <span class="n">chs</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">));</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#define create_controls(codec, pfx, nid, chs) \</span>
<span class="cp">	create_controls_idx(codec, pfx, 0, nid, chs)</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">add_spec_dacs</span><span class="p">(</span><span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">num_dacs</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_WARNING</span> <span class="s">&quot;stac92xx: No space for DAC 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">snd_BUG_ON</span><span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dac_nids</span> <span class="o">!=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dac_nids</span><span class="p">);</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">dac_nids</span><span class="p">[</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">num_dacs</span><span class="p">]</span> <span class="o">=</span> <span class="n">nid</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">num_dacs</span><span class="o">++</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">add_spec_extra_dacs</span><span class="p">(</span><span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">extra_out_nid</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">extra_out_nid</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="p">{</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">extra_out_nid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">nid</span><span class="p">;</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">printk</span><span class="p">(</span><span class="n">KERN_WARNING</span> <span class="s">&quot;stac92xx: No space for extra DAC 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* Create output controls</span>
<span class="cm"> * The mixer elements are named depending on the given type (AUTO_PIN_XXX_OUT)</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">create_multi_out_ctls</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="kt">int</span> <span class="n">num_outs</span><span class="p">,</span>
				 <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="o">*</span><span class="n">pins</span><span class="p">,</span>
				 <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="o">*</span><span class="n">dac_nids</span><span class="p">,</span>
				 <span class="kt">int</span> <span class="n">type</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="k">const</span> <span class="n">chname</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
		<span class="s">&quot;Front&quot;</span><span class="p">,</span> <span class="s">&quot;Surround&quot;</span><span class="p">,</span> <span class="nb">NULL</span> <span class="cm">/*CLFE*/</span><span class="p">,</span> <span class="s">&quot;Side&quot;</span>
	<span class="p">};</span>
	<span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">err</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">wid_caps</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num_outs</span> <span class="o">&amp;&amp;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">chname</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">type</span> <span class="o">==</span> <span class="n">AUTO_PIN_HP_OUT</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">hp_detect</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">is_jack_detectable</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">pins</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
				<span class="n">spec</span><span class="o">-&gt;</span><span class="n">hp_detect</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">nid</span> <span class="o">=</span> <span class="n">dac_nids</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">nid</span><span class="p">)</span>
			<span class="k">continue</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">type</span> <span class="o">!=</span> <span class="n">AUTO_PIN_HP_OUT</span> <span class="o">&amp;&amp;</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
			<span class="cm">/* Center/LFE */</span>
			<span class="n">err</span> <span class="o">=</span> <span class="n">create_controls</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="s">&quot;Center&quot;</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
				<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
			<span class="n">err</span> <span class="o">=</span> <span class="n">create_controls</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="s">&quot;LFE&quot;</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
				<span class="k">return</span> <span class="n">err</span><span class="p">;</span>

			<span class="n">wid_caps</span> <span class="o">=</span> <span class="n">get_wcaps</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>

			<span class="k">if</span> <span class="p">(</span><span class="n">wid_caps</span> <span class="o">&amp;</span> <span class="n">AC_WCAP_LR_SWAP</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_add_control</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span>
					<span class="n">STAC_CTL_WIDGET_CLFE_SWITCH</span><span class="p">,</span>
					<span class="s">&quot;Swap Center/LFE Playback Switch&quot;</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>

				<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
					<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
			<span class="p">}</span>

		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">;</span>
			<span class="kt">int</span> <span class="n">idx</span><span class="p">;</span>
			<span class="k">switch</span> <span class="p">(</span><span class="n">type</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">case</span> <span class="n">AUTO_PIN_HP_OUT</span>:
				<span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Headphone&quot;</span><span class="p">;</span>
				<span class="n">idx</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">AUTO_PIN_SPEAKER_OUT</span>:
				<span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Speaker&quot;</span><span class="p">;</span>
				<span class="n">idx</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="nl">default:</span>
				<span class="n">name</span> <span class="o">=</span> <span class="n">chname</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
				<span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">err</span> <span class="o">=</span> <span class="n">create_controls_idx</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
				<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_add_capvol_ctls</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">vol</span><span class="p">,</span>
				    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">sw</span><span class="p">,</span> <span class="kt">int</span> <span class="n">idx</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">err</span><span class="p">;</span>
	<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_add_control_idx</span><span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">,</span> <span class="n">STAC_CTL_WIDGET_VOL</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span>
				       <span class="s">&quot;Capture Volume&quot;</span><span class="p">,</span> <span class="n">vol</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_add_control_idx</span><span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">,</span> <span class="n">STAC_CTL_WIDGET_MUTE</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span>
				       <span class="s">&quot;Capture Switch&quot;</span><span class="p">,</span> <span class="n">sw</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* add playback controls from the parsed DAC table */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_auto_create_multi_out_ctls</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
					       <span class="k">const</span> <span class="k">struct</span> <span class="n">auto_pin_cfg</span> <span class="o">*</span><span class="n">cfg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">err</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">idx</span><span class="p">;</span>

	<span class="n">err</span> <span class="o">=</span> <span class="n">create_multi_out_ctls</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_outs</span><span class="p">,</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_out_pins</span><span class="p">,</span>
				    <span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dac_nids</span><span class="p">,</span>
				    <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_out_type</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">cfg</span><span class="o">-&gt;</span><span class="n">hp_outs</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_out_type</span> <span class="o">==</span> <span class="n">AUTO_PIN_LINE_OUT</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_add_control</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span>
			<span class="n">STAC_CTL_WIDGET_HP_SWITCH</span><span class="p">,</span>
			<span class="s">&quot;Headphone as Line Out Switch&quot;</span><span class="p">,</span>
			<span class="n">cfg</span><span class="o">-&gt;</span><span class="n">hp_pins</span><span class="p">[</span><span class="n">cfg</span><span class="o">-&gt;</span><span class="n">hp_outs</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">num_inputs</span><span class="p">;</span> <span class="n">idx</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">cfg</span><span class="o">-&gt;</span><span class="n">inputs</span><span class="p">[</span><span class="n">idx</span><span class="p">].</span><span class="n">type</span> <span class="o">&gt;</span> <span class="n">AUTO_PIN_LINE_IN</span><span class="p">)</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="n">nid</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">inputs</span><span class="p">[</span><span class="n">idx</span><span class="p">].</span><span class="n">pin</span><span class="p">;</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_add_jack_mode_control</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">idx</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* add playback controls for Speaker and HP outputs */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_auto_create_hp_ctls</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
					<span class="k">struct</span> <span class="n">auto_pin_cfg</span> <span class="o">*</span><span class="n">cfg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">err</span><span class="p">;</span>

	<span class="n">err</span> <span class="o">=</span> <span class="n">create_multi_out_ctls</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">hp_outs</span><span class="p">,</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">hp_pins</span><span class="p">,</span>
				    <span class="n">spec</span><span class="o">-&gt;</span><span class="n">hp_dacs</span><span class="p">,</span> <span class="n">AUTO_PIN_HP_OUT</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>

	<span class="n">err</span> <span class="o">=</span> <span class="n">create_multi_out_ctls</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">speaker_outs</span><span class="p">,</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">speaker_pins</span><span class="p">,</span>
				    <span class="n">spec</span><span class="o">-&gt;</span><span class="n">speaker_dacs</span><span class="p">,</span> <span class="n">AUTO_PIN_SPEAKER_OUT</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* labels for mono mux outputs */</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="k">const</span> <span class="n">stac92xx_mono_labels</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="s">&quot;DAC0&quot;</span><span class="p">,</span> <span class="s">&quot;DAC1&quot;</span><span class="p">,</span> <span class="s">&quot;Mixer&quot;</span><span class="p">,</span> <span class="s">&quot;DAC2&quot;</span>
<span class="p">};</span>

<span class="cm">/* create mono mux for mono out on capable codecs */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_auto_create_mono_output_ctls</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hda_input_mux</span> <span class="o">*</span><span class="n">mono_mux</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">private_mono_mux</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">num_cons</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="n">con_lst</span><span class="p">[</span><span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac92xx_mono_labels</span><span class="p">)];</span>

	<span class="n">num_cons</span> <span class="o">=</span> <span class="n">snd_hda_get_connections</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
				<span class="n">spec</span><span class="o">-&gt;</span><span class="n">mono_nid</span><span class="p">,</span>
				<span class="n">con_lst</span><span class="p">,</span>
				<span class="n">HDA_MAX_NUM_INPUTS</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">num_cons</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">num_cons</span> <span class="o">&gt;</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac92xx_mono_labels</span><span class="p">))</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num_cons</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
		<span class="n">snd_hda_add_imux_item</span><span class="p">(</span><span class="n">mono_mux</span><span class="p">,</span> <span class="n">stac92xx_mono_labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span>
				      <span class="nb">NULL</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">stac92xx_add_control</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">STAC_CTL_WIDGET_MONO_MUX</span><span class="p">,</span>
				<span class="s">&quot;Mono Mux&quot;</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">mono_nid</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* create PC beep volume controls */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_auto_create_beep_ctls</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
						<span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">caps</span> <span class="o">=</span> <span class="n">query_amp_caps</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">err</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="n">STAC_CTL_WIDGET_MUTE_BEEP</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">anabeep_nid</span> <span class="o">==</span> <span class="n">nid</span><span class="p">)</span>
		<span class="n">type</span> <span class="o">=</span> <span class="n">STAC_CTL_WIDGET_MUTE</span><span class="p">;</span>

	<span class="cm">/* check for mute support for the the amp */</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">caps</span> <span class="o">&amp;</span> <span class="n">AC_AMPCAP_MUTE</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">AC_AMPCAP_MUTE_SHIFT</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_add_control</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">type</span><span class="p">,</span>
			<span class="s">&quot;Beep Playback Switch&quot;</span><span class="p">,</span>
			<span class="n">HDA_COMPOSE_AMP_VAL</span><span class="p">(</span><span class="n">nid</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">));</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
				<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="cm">/* check to see if there is volume support for the amp */</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">caps</span> <span class="o">&amp;</span> <span class="n">AC_AMPCAP_NUM_STEPS</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">AC_AMPCAP_NUM_STEPS_SHIFT</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_add_control</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">STAC_CTL_WIDGET_VOL</span><span class="p">,</span>
			<span class="s">&quot;Beep Playback Volume&quot;</span><span class="p">,</span>
			<span class="n">HDA_COMPOSE_AMP_VAL</span><span class="p">(</span><span class="n">nid</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">));</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
				<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#ifdef CONFIG_SND_HDA_INPUT_BEEP</span>
<span class="cp">#define stac92xx_dig_beep_switch_info snd_ctl_boolean_mono_info</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_dig_beep_switch_get</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
					<span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">integer</span><span class="p">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">beep</span><span class="o">-&gt;</span><span class="n">enabled</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_dig_beep_switch_put</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
					<span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">snd_hda_enable_beep_device</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">integer</span><span class="p">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">stac92xx_dig_beep_ctrl</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">iface</span> <span class="o">=</span> <span class="n">SNDRV_CTL_ELEM_IFACE_MIXER</span><span class="p">,</span>
	<span class="p">.</span><span class="n">info</span> <span class="o">=</span> <span class="n">stac92xx_dig_beep_switch_info</span><span class="p">,</span>
	<span class="p">.</span><span class="n">get</span> <span class="o">=</span> <span class="n">stac92xx_dig_beep_switch_get</span><span class="p">,</span>
	<span class="p">.</span><span class="n">put</span> <span class="o">=</span> <span class="n">stac92xx_dig_beep_switch_put</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_beep_switch_ctl</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">stac92xx_add_control_temp</span><span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">stac92xx_dig_beep_ctrl</span><span class="p">,</span>
					 <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Beep Playback Switch&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
<span class="cp">#endif</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_auto_create_mux_input_ctls</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_muxes</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">wcaps</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">val</span><span class="p">;</span>

		<span class="n">nid</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">mux_nids</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="n">wcaps</span> <span class="o">=</span> <span class="n">get_wcaps</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">wcaps</span> <span class="o">&amp;</span> <span class="n">AC_WCAP_OUT_AMP</span><span class="p">))</span>
			<span class="k">continue</span><span class="p">;</span>

		<span class="cm">/* check whether already the same control was created as</span>
<span class="cm">		 * normal Capture Volume.</span>
<span class="cm">		 */</span>
		<span class="n">val</span> <span class="o">=</span> <span class="n">HDA_COMPOSE_AMP_VAL</span><span class="p">(</span><span class="n">nid</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_caps</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">capvols</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">val</span><span class="p">)</span>
				<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_caps</span><span class="p">)</span>
			<span class="k">continue</span><span class="p">;</span>

		<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_add_control_idx</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">STAC_CTL_WIDGET_VOL</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span>
					       <span class="s">&quot;Mux Capture Volume&quot;</span><span class="p">,</span> <span class="n">val</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="k">const</span> <span class="n">stac92xx_spdif_labels</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="s">&quot;Digital Playback&quot;</span><span class="p">,</span> <span class="s">&quot;Analog Mux 1&quot;</span><span class="p">,</span> <span class="s">&quot;Analog Mux 2&quot;</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_auto_create_spdif_mux_ctls</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hda_input_mux</span> <span class="o">*</span><span class="n">spdif_mux</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">private_smux</span><span class="p">;</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="k">const</span> <span class="o">*</span><span class="n">labels</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">spdif_labels</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">num_cons</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="n">con_lst</span><span class="p">[</span><span class="n">HDA_MAX_NUM_INPUTS</span><span class="p">];</span>

	<span class="n">num_cons</span> <span class="o">=</span> <span class="n">snd_hda_get_connections</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
				<span class="n">spec</span><span class="o">-&gt;</span><span class="n">smux_nids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
				<span class="n">con_lst</span><span class="p">,</span>
				<span class="n">HDA_MAX_NUM_INPUTS</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">num_cons</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">labels</span><span class="p">)</span>
		<span class="n">labels</span> <span class="o">=</span> <span class="n">stac92xx_spdif_labels</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num_cons</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
		<span class="n">snd_hda_add_imux_item</span><span class="p">(</span><span class="n">spdif_mux</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* labels for dmic mux inputs */</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="k">const</span> <span class="n">stac92xx_dmic_labels</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="s">&quot;Analog Inputs&quot;</span><span class="p">,</span> <span class="s">&quot;Digital Mic 1&quot;</span><span class="p">,</span> <span class="s">&quot;Digital Mic 2&quot;</span><span class="p">,</span>
	<span class="s">&quot;Digital Mic 3&quot;</span><span class="p">,</span> <span class="s">&quot;Digital Mic 4&quot;</span>
<span class="p">};</span>

<span class="k">static</span> <span class="n">hda_nid_t</span> <span class="nf">get_connected_node</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">mux</span><span class="p">,</span>
				    <span class="kt">int</span> <span class="n">idx</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">hda_nid_t</span> <span class="n">conn</span><span class="p">[</span><span class="n">HDA_MAX_NUM_INPUTS</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">nums</span><span class="p">;</span>
	<span class="n">nums</span> <span class="o">=</span> <span class="n">snd_hda_get_connections</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">mux</span><span class="p">,</span> <span class="n">conn</span><span class="p">,</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">conn</span><span class="p">));</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">idx</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="n">nums</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">conn</span><span class="p">[</span><span class="n">idx</span><span class="p">];</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* look for NID recursively */</span>
<span class="cp">#define get_connection_index(codec, mux, nid) \</span>
<span class="cp">	snd_hda_get_conn_index(codec, mux, nid, 1)</span>

<span class="cm">/* create a volume assigned to the given pin (only if supported) */</span>
<span class="cm">/* return 1 if the volume control is created */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">create_elem_capture_vol</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">,</span>
				   <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">label</span><span class="p">,</span> <span class="kt">int</span> <span class="n">idx</span><span class="p">,</span> <span class="kt">int</span> <span class="n">direction</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">caps</span><span class="p">,</span> <span class="n">nums</span><span class="p">;</span>
	<span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">err</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">direction</span> <span class="o">==</span> <span class="n">HDA_OUTPUT</span><span class="p">)</span>
		<span class="n">caps</span> <span class="o">=</span> <span class="n">AC_WCAP_OUT_AMP</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="n">caps</span> <span class="o">=</span> <span class="n">AC_WCAP_IN_AMP</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">get_wcaps</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">caps</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">caps</span> <span class="o">=</span> <span class="n">query_amp_caps</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">direction</span><span class="p">);</span>
	<span class="n">nums</span> <span class="o">=</span> <span class="p">(</span><span class="n">caps</span> <span class="o">&amp;</span> <span class="n">AC_AMPCAP_NUM_STEPS</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">AC_AMPCAP_NUM_STEPS_SHIFT</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">nums</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">snprintf</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="s">&quot;%s Capture Volume&quot;</span><span class="p">,</span> <span class="n">label</span><span class="p">);</span>
	<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_add_control_idx</span><span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">,</span> <span class="n">STAC_CTL_WIDGET_VOL</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
				       <span class="n">HDA_COMPOSE_AMP_VAL</span><span class="p">(</span><span class="n">nid</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">direction</span><span class="p">));</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* create playback/capture controls for input pins on dmic capable codecs */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_auto_create_dmic_input_ctls</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
						<span class="k">const</span> <span class="k">struct</span> <span class="n">auto_pin_cfg</span> <span class="o">*</span><span class="n">cfg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hda_input_mux</span> <span class="o">*</span><span class="n">imux</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">private_imux</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hda_input_mux</span> <span class="o">*</span><span class="n">dimux</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">private_dimux</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">err</span><span class="p">,</span> <span class="n">i</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">def_conf</span><span class="p">;</span>

	<span class="n">snd_hda_add_imux_item</span><span class="p">(</span><span class="n">dimux</span><span class="p">,</span> <span class="n">stac92xx_dmic_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmics</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">index</span><span class="p">,</span> <span class="n">type_idx</span><span class="p">;</span>
		<span class="kt">char</span> <span class="n">label</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>

		<span class="n">nid</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmic_nids</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">get_wcaps_type</span><span class="p">(</span><span class="n">get_wcaps</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">))</span> <span class="o">!=</span> <span class="n">AC_WID_PIN</span><span class="p">)</span>
			<span class="k">continue</span><span class="p">;</span>
		<span class="n">def_conf</span> <span class="o">=</span> <span class="n">snd_hda_codec_get_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">get_defcfg_connect</span><span class="p">(</span><span class="n">def_conf</span><span class="p">)</span> <span class="o">==</span> <span class="n">AC_JACK_PORT_NONE</span><span class="p">)</span>
			<span class="k">continue</span><span class="p">;</span>

		<span class="n">index</span> <span class="o">=</span> <span class="n">get_connection_index</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmux_nids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nid</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">continue</span><span class="p">;</span>

		<span class="n">snd_hda_get_pin_label</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">,</span>
				      <span class="n">label</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">label</span><span class="p">),</span> <span class="nb">NULL</span><span class="p">);</span>
		<span class="n">snd_hda_add_imux_item</span><span class="p">(</span><span class="n">dimux</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">type_idx</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">snd_hda_get_bool_hint</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="s">&quot;separate_dmux&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span>
			<span class="n">snd_hda_add_imux_item</span><span class="p">(</span><span class="n">imux</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">type_idx</span><span class="p">);</span>

		<span class="n">err</span> <span class="o">=</span> <span class="n">create_elem_capture_vol</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">type_idx</span><span class="p">,</span>
					      <span class="n">HDA_INPUT</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">err</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">err</span> <span class="o">=</span> <span class="n">create_elem_capture_vol</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span>
						      <span class="n">type_idx</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
				<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">err</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">nid</span> <span class="o">=</span> <span class="n">get_connected_node</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
						<span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmux_nids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">index</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">nid</span><span class="p">)</span>
					<span class="n">err</span> <span class="o">=</span> <span class="n">create_elem_capture_vol</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
							<span class="n">nid</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span>
							<span class="n">type_idx</span><span class="p">,</span> <span class="n">HDA_INPUT</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
					<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">check_mic_pin</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">,</span>
			 <span class="n">hda_nid_t</span> <span class="o">*</span><span class="n">fixed</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="o">*</span><span class="n">ext</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="o">*</span><span class="n">dock</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cfg</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">type</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">nid</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">cfg</span> <span class="o">=</span> <span class="n">snd_hda_codec_get_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
	<span class="n">type</span> <span class="o">=</span> <span class="n">get_defcfg_device</span><span class="p">(</span><span class="n">cfg</span><span class="p">);</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">snd_hda_get_input_pin_attr</span><span class="p">(</span><span class="n">cfg</span><span class="p">))</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">INPUT_PIN_ATTR_INT</span>:
		<span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="n">fixed</span><span class="p">)</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/* already occupied */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">type</span> <span class="o">!=</span> <span class="n">AC_JACK_MIC_IN</span><span class="p">)</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/* invalid type */</span>
		<span class="o">*</span><span class="n">fixed</span> <span class="o">=</span> <span class="n">nid</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">INPUT_PIN_ATTR_UNUSED</span>:
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">INPUT_PIN_ATTR_DOCK</span>:
		<span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="n">dock</span><span class="p">)</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/* already occupied */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">type</span> <span class="o">!=</span> <span class="n">AC_JACK_MIC_IN</span> <span class="o">&amp;&amp;</span> <span class="n">type</span> <span class="o">!=</span> <span class="n">AC_JACK_LINE_IN</span><span class="p">)</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/* invalid type */</span>
		<span class="o">*</span><span class="n">dock</span> <span class="o">=</span> <span class="n">nid</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="n">ext</span><span class="p">)</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/* already occupied */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">type</span> <span class="o">!=</span> <span class="n">AC_JACK_MIC_IN</span><span class="p">)</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/* invalid type */</span>
		<span class="o">*</span><span class="n">ext</span> <span class="o">=</span> <span class="n">nid</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">set_mic_route</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
			 <span class="k">struct</span> <span class="n">sigmatel_mic_route</span> <span class="o">*</span><span class="n">mic</span><span class="p">,</span>
			 <span class="n">hda_nid_t</span> <span class="n">pin</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">auto_pin_cfg</span> <span class="o">*</span><span class="n">cfg</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="n">mic</span><span class="o">-&gt;</span><span class="n">pin</span> <span class="o">=</span> <span class="n">pin</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">pin</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">num_inputs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">pin</span> <span class="o">==</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">inputs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">pin</span><span class="p">)</span>
			<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">num_inputs</span> <span class="o">&amp;&amp;</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">inputs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">type</span> <span class="o">==</span> <span class="n">AUTO_PIN_MIC</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* analog pin */</span>
		<span class="n">i</span> <span class="o">=</span> <span class="n">get_connection_index</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">mux_nids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pin</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">mic</span><span class="o">-&gt;</span><span class="n">mux_idx</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
		<span class="n">mic</span><span class="o">-&gt;</span><span class="n">dmux_idx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmux_nids</span><span class="p">)</span>
			<span class="n">mic</span><span class="o">-&gt;</span><span class="n">dmux_idx</span> <span class="o">=</span> <span class="n">get_connection_index</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
							     <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmux_nids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
							     <span class="n">spec</span><span class="o">-&gt;</span><span class="n">mux_nids</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="p">}</span>  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmux_nids</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* digital pin */</span>
		<span class="n">i</span> <span class="o">=</span> <span class="n">get_connection_index</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmux_nids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pin</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">mic</span><span class="o">-&gt;</span><span class="n">dmux_idx</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
		<span class="n">mic</span><span class="o">-&gt;</span><span class="n">mux_idx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">mux_nids</span><span class="p">)</span>
			<span class="n">mic</span><span class="o">-&gt;</span><span class="n">mux_idx</span> <span class="o">=</span> <span class="n">get_connection_index</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
							    <span class="n">spec</span><span class="o">-&gt;</span><span class="n">mux_nids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
							    <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmux_nids</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* return non-zero if the device is for automatic mic switch */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac_check_auto_mic</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">auto_pin_cfg</span> <span class="o">*</span><span class="n">cfg</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">ext</span><span class="p">,</span> <span class="n">dock</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="n">fixed</span> <span class="o">=</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">dock</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">num_inputs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">check_mic_pin</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">inputs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">pin</span><span class="p">,</span>
		    <span class="o">&amp;</span><span class="n">fixed</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ext</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">dock</span><span class="p">))</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmics</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">check_mic_pin</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmic_nids</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
		    <span class="o">&amp;</span><span class="n">fixed</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ext</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">dock</span><span class="p">))</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">fixed</span> <span class="o">||</span> <span class="p">(</span><span class="o">!</span><span class="n">ext</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">dock</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span> <span class="cm">/* no input to switch */</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">is_jack_detectable</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">ext</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span> <span class="cm">/* no unsol support */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">set_mic_route</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">ext_mic</span><span class="p">,</span> <span class="n">ext</span><span class="p">)</span> <span class="o">||</span>
	    <span class="n">set_mic_route</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">int_mic</span><span class="p">,</span> <span class="n">fixed</span><span class="p">)</span> <span class="o">||</span>
	    <span class="n">set_mic_route</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">dock_mic</span><span class="p">,</span> <span class="n">dock</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span> <span class="cm">/* something is wrong */</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* create playback/capture controls for input pins */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_auto_create_analog_input_ctls</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">auto_pin_cfg</span> <span class="o">*</span><span class="n">cfg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hda_input_mux</span> <span class="o">*</span><span class="n">imux</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">private_imux</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">;</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">label</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">num_inputs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">hda_nid_t</span> <span class="n">nid</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">inputs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">pin</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">index</span><span class="p">,</span> <span class="n">err</span><span class="p">,</span> <span class="n">type_idx</span><span class="p">;</span>

		<span class="n">index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_muxes</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">index</span> <span class="o">=</span> <span class="n">get_connection_index</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">mux_nids</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>
						     <span class="n">nid</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
				<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">continue</span><span class="p">;</span>

		<span class="n">label</span> <span class="o">=</span> <span class="n">hda_get_autocfg_input_label</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
		<span class="n">snd_hda_add_imux_item</span><span class="p">(</span><span class="n">imux</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">type_idx</span><span class="p">);</span>

		<span class="n">err</span> <span class="o">=</span> <span class="n">create_elem_capture_vol</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span>
					      <span class="n">label</span><span class="p">,</span> <span class="n">type_idx</span><span class="p">,</span>
					      <span class="n">HDA_INPUT</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_analog_muxes</span> <span class="o">=</span> <span class="n">imux</span><span class="o">-&gt;</span><span class="n">num_items</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">imux</span><span class="o">-&gt;</span><span class="n">num_items</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/*</span>
<span class="cm">		 * Set the current input for the muxes.</span>
<span class="cm">		 * The STAC9221 has two input muxes with identical source</span>
<span class="cm">		 * NID lists.  Hopefully this won&#39;t get confused.</span>
<span class="cm">		 */</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_muxes</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">snd_hda_codec_write_cache</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">mux_nids</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span>
						  <span class="n">AC_VERB_SET_CONNECT_SEL</span><span class="p">,</span>
						  <span class="n">imux</span><span class="o">-&gt;</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">index</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac92xx_auto_init_multi_out</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">line_outs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">hda_nid_t</span> <span class="n">nid</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">line_out_pins</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="n">stac92xx_auto_set_pinctl</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">AC_PINCTL_OUT_EN</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac92xx_auto_init_hp_out</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">hp_outs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">hda_nid_t</span> <span class="n">pin</span><span class="p">;</span>
		<span class="n">pin</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">hp_pins</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">pin</span><span class="p">)</span> <span class="cm">/* connect to front */</span>
			<span class="n">stac92xx_auto_set_pinctl</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">pin</span><span class="p">,</span> <span class="n">AC_PINCTL_OUT_EN</span> <span class="o">|</span> <span class="n">AC_PINCTL_HP_EN</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">speaker_outs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">hda_nid_t</span> <span class="n">pin</span><span class="p">;</span>
		<span class="n">pin</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">speaker_pins</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">pin</span><span class="p">)</span> <span class="cm">/* connect to front */</span>
			<span class="n">stac92xx_auto_set_pinctl</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">pin</span><span class="p">,</span> <span class="n">AC_PINCTL_OUT_EN</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">is_dual_headphones</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">valid_hps</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">line_out_type</span> <span class="o">!=</span> <span class="n">AUTO_PIN_SPEAKER_OUT</span> <span class="o">||</span>
	    <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">hp_outs</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">valid_hps</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">hp_outs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">hda_nid_t</span> <span class="n">nid</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">hp_pins</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cfg</span> <span class="o">=</span> <span class="n">snd_hda_codec_get_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">get_defcfg_location</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">AC_JACK_LOC_SEPARATE</span><span class="p">)</span>
			<span class="k">continue</span><span class="p">;</span>
		<span class="n">valid_hps</span><span class="o">++</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">valid_hps</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>


<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_parse_auto_config</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="n">dig_out</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dig_in</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">hp_swap</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">err</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">((</span><span class="n">err</span> <span class="o">=</span> <span class="n">snd_hda_parse_pin_def_config</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
						<span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">,</span>
						<span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmic_nids</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">line_outs</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span> <span class="cm">/* can&#39;t find valid pin config */</span>

	<span class="cm">/* If we have no real line-out pin and multiple hp-outs, HPs should</span>
<span class="cm">	 * be set up as multi-channel outputs.</span>
<span class="cm">	 */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">is_dual_headphones</span><span class="p">(</span><span class="n">codec</span><span class="p">))</span> <span class="p">{</span>
		<span class="cm">/* Copy hp_outs to line_outs, backup line_outs in</span>
<span class="cm">		 * speaker_outs so that the following routines can handle</span>
<span class="cm">		 * HP pins as primary outputs.</span>
<span class="cm">		 */</span>
		<span class="n">snd_printdd</span><span class="p">(</span><span class="s">&quot;stac92xx: Enabling multi-HPs workaround</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="n">memcpy</span><span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">speaker_pins</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">line_out_pins</span><span class="p">,</span>
		       <span class="k">sizeof</span><span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">line_out_pins</span><span class="p">));</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">speaker_outs</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">line_outs</span><span class="p">;</span>
		<span class="n">memcpy</span><span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">line_out_pins</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">hp_pins</span><span class="p">,</span>
		       <span class="k">sizeof</span><span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">hp_pins</span><span class="p">));</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">line_outs</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">hp_outs</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">line_out_type</span> <span class="o">=</span> <span class="n">AUTO_PIN_HP_OUT</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">hp_outs</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">hp_swap</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">mono_out_pin</span><span class="p">)</span> <span class="p">{</span>
		<span class="kt">int</span> <span class="n">dir</span> <span class="o">=</span> <span class="n">get_wcaps</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">mono_out_pin</span><span class="p">)</span> <span class="o">&amp;</span>
			<span class="p">(</span><span class="n">AC_WCAP_OUT_AMP</span> <span class="o">|</span> <span class="n">AC_WCAP_IN_AMP</span><span class="p">);</span>
		<span class="n">u32</span> <span class="n">caps</span> <span class="o">=</span> <span class="n">query_amp_caps</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
				<span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">mono_out_pin</span><span class="p">,</span> <span class="n">dir</span><span class="p">);</span>
		<span class="n">hda_nid_t</span> <span class="n">conn_list</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>

		<span class="cm">/* get the mixer node and then the mono mux if it exists */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">snd_hda_get_connections</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
				<span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">mono_out_pin</span><span class="p">,</span> <span class="n">conn_list</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
				<span class="n">snd_hda_get_connections</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">conn_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
				<span class="n">conn_list</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>

				<span class="kt">int</span> <span class="n">wcaps</span> <span class="o">=</span> <span class="n">get_wcaps</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">conn_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
				<span class="kt">int</span> <span class="n">wid_type</span> <span class="o">=</span> <span class="n">get_wcaps_type</span><span class="p">(</span><span class="n">wcaps</span><span class="p">);</span>
				<span class="cm">/* LR swap check, some stac925x have a mux that</span>
<span class="cm"> 				 * changes the DACs output path instead of the</span>
<span class="cm"> 				 * mono-mux path.</span>
<span class="cm"> 				 */</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">wid_type</span> <span class="o">==</span> <span class="n">AC_WID_AUD_SEL</span> <span class="o">&amp;&amp;</span>
						<span class="o">!</span><span class="p">(</span><span class="n">wcaps</span> <span class="o">&amp;</span> <span class="n">AC_WCAP_LR_SWAP</span><span class="p">))</span>
					<span class="n">spec</span><span class="o">-&gt;</span><span class="n">mono_nid</span> <span class="o">=</span> <span class="n">conn_list</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">dir</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">hda_nid_t</span> <span class="n">nid</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">mono_out_pin</span><span class="p">;</span>

			<span class="cm">/* most mono outs have a least a mute/unmute switch */</span>
			<span class="n">dir</span> <span class="o">=</span> <span class="p">(</span><span class="n">dir</span> <span class="o">&amp;</span> <span class="n">AC_WCAP_OUT_AMP</span><span class="p">)</span> <span class="o">?</span> <span class="n">HDA_OUTPUT</span> <span class="o">:</span> <span class="n">HDA_INPUT</span><span class="p">;</span>
			<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_add_control</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">STAC_CTL_WIDGET_MUTE</span><span class="p">,</span>
				<span class="s">&quot;Mono Playback Switch&quot;</span><span class="p">,</span>
				<span class="n">HDA_COMPOSE_AMP_VAL</span><span class="p">(</span><span class="n">nid</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dir</span><span class="p">));</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
				<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
			<span class="cm">/* check for volume support for the amp */</span>
			<span class="k">if</span> <span class="p">((</span><span class="n">caps</span> <span class="o">&amp;</span> <span class="n">AC_AMPCAP_NUM_STEPS</span><span class="p">)</span>
					<span class="o">&gt;&gt;</span> <span class="n">AC_AMPCAP_NUM_STEPS_SHIFT</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_add_control</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span>
					<span class="n">STAC_CTL_WIDGET_VOL</span><span class="p">,</span>
					<span class="s">&quot;Mono Playback Volume&quot;</span><span class="p">,</span>
				<span class="n">HDA_COMPOSE_AMP_VAL</span><span class="p">(</span><span class="n">nid</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dir</span><span class="p">));</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
					<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>

		<span class="n">stac92xx_auto_set_pinctl</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">mono_out_pin</span><span class="p">,</span>
					 <span class="n">AC_PINCTL_OUT_EN</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">num_dacs</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_auto_fill_dac_nids</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_auto_create_multi_out_ctls</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
							  <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="cm">/* setup analog beep controls */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">anabeep_nid</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_auto_create_beep_ctls</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">anabeep_nid</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="cm">/* setup digital beep controls and input device */</span>
<span class="cp">#ifdef CONFIG_SND_HDA_INPUT_BEEP</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">digbeep_nid</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">hda_nid_t</span> <span class="n">nid</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">digbeep_nid</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">caps</span><span class="p">;</span>

		<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_auto_create_beep_ctls</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">snd_hda_attach_beep_device</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">beep</span><span class="p">)</span> <span class="p">{</span>
			<span class="cm">/* IDT/STAC codecs have linear beep tone parameter */</span>
			<span class="n">codec</span><span class="o">-&gt;</span><span class="n">beep</span><span class="o">-&gt;</span><span class="n">linear_tone</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">linear_tone_beep</span><span class="p">;</span>
			<span class="cm">/* if no beep switch is available, make its own one */</span>
			<span class="n">caps</span> <span class="o">=</span> <span class="n">query_amp_caps</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">caps</span> <span class="o">&amp;</span> <span class="n">AC_AMPCAP_MUTE</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_beep_switch_ctl</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
					<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="cp">#endif</span>

	<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_auto_create_hp_ctls</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>

	<span class="cm">/* All output parsing done, now restore the swapped hp pins */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">hp_swap</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">memcpy</span><span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">hp_pins</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">line_out_pins</span><span class="p">,</span>
		       <span class="k">sizeof</span><span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">hp_pins</span><span class="p">));</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">hp_outs</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">line_outs</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">line_out_type</span> <span class="o">=</span> <span class="n">AUTO_PIN_HP_OUT</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">line_outs</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">stac_check_auto_mic</span><span class="p">(</span><span class="n">codec</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_mic</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="cm">/* only one capture for auto-mic */</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_adcs</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_caps</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_muxes</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_caps</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_add_capvol_ctls</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">capvols</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
					       <span class="n">spec</span><span class="o">-&gt;</span><span class="n">capsws</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">i</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_auto_create_analog_input_ctls</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">mono_nid</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_auto_create_mono_output_ctls</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmics</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">dinput_mux</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">((</span><span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_auto_create_dmic_input_ctls</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
						<span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_muxes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_auto_create_mux_input_ctls</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_smuxes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_auto_create_spdif_mux_ctls</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_add_input_source</span><span class="p">(</span><span class="n">spec</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">max_channels</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">num_dacs</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">max_channels</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">surr_switch</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

	<span class="cm">/* find digital out and in converters */</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">start_nid</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">start_nid</span> <span class="o">+</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">num_nodes</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">wid_caps</span> <span class="o">=</span> <span class="n">get_wcaps</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">wid_caps</span> <span class="o">&amp;</span> <span class="n">AC_WCAP_DIGITAL</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">switch</span> <span class="p">(</span><span class="n">get_wcaps_type</span><span class="p">(</span><span class="n">wid_caps</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">case</span> <span class="n">AC_WID_AUD_OUT</span>:
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">dig_out</span><span class="p">)</span>
					<span class="n">dig_out</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">AC_WID_AUD_IN</span>:
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">dig_in</span><span class="p">)</span>
					<span class="n">dig_in</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">dig_outs</span><span class="p">)</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dig_out_nid</span> <span class="o">=</span> <span class="n">dig_out</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">dig_in</span> <span class="o">&amp;&amp;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">dig_in_pin</span><span class="p">)</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">dig_in_nid</span> <span class="o">=</span> <span class="n">dig_in</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">kctls</span><span class="p">.</span><span class="n">list</span><span class="p">)</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">mixers</span><span class="p">[</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_mixers</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">kctls</span><span class="p">.</span><span class="n">list</span><span class="p">;</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">input_mux</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">private_imux</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">dinput_mux</span><span class="p">)</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">dinput_mux</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">private_dimux</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">sinput_mux</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">private_smux</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">mono_mux</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">private_mono_mux</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* add playback controls for HP output */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac9200_auto_create_hp_ctls</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
					<span class="k">struct</span> <span class="n">auto_pin_cfg</span> <span class="o">*</span><span class="n">cfg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="n">pin</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">hp_pins</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="n">pin</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">is_jack_detectable</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">pin</span><span class="p">))</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">hp_detect</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* add playback controls for LFE output */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac9200_auto_create_lfe_ctls</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
					<span class="k">struct</span> <span class="n">auto_pin_cfg</span> <span class="o">*</span><span class="n">cfg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">err</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="n">lfe_pin</span> <span class="o">=</span> <span class="mh">0x0</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="cm">/*</span>
<span class="cm">	 * search speaker outs and line outs for a mono speaker pin</span>
<span class="cm">	 * with an amp.  If one is found, add LFE controls</span>
<span class="cm">	 * for it.</span>
<span class="cm">	 */</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">speaker_outs</span> <span class="o">&amp;&amp;</span> <span class="n">lfe_pin</span> <span class="o">==</span> <span class="mh">0x0</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">hda_nid_t</span> <span class="n">pin</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">speaker_pins</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">wcaps</span> <span class="o">=</span> <span class="n">get_wcaps</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">pin</span><span class="p">);</span>
		<span class="n">wcaps</span> <span class="o">&amp;=</span> <span class="p">(</span><span class="n">AC_WCAP_STEREO</span> <span class="o">|</span> <span class="n">AC_WCAP_OUT_AMP</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">wcaps</span> <span class="o">==</span> <span class="n">AC_WCAP_OUT_AMP</span><span class="p">)</span>
			<span class="cm">/* found a mono speaker with an amp, must be lfe */</span>
			<span class="n">lfe_pin</span> <span class="o">=</span> <span class="n">pin</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="cm">/* if speaker_outs is 0, then speakers may be in line_outs */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">lfe_pin</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">speaker_outs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">line_outs</span> <span class="o">&amp;&amp;</span> <span class="n">lfe_pin</span> <span class="o">==</span> <span class="mh">0x0</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">hda_nid_t</span> <span class="n">pin</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">line_out_pins</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
			<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">defcfg</span><span class="p">;</span>
			<span class="n">defcfg</span> <span class="o">=</span> <span class="n">snd_hda_codec_get_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">pin</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">get_defcfg_device</span><span class="p">(</span><span class="n">defcfg</span><span class="p">)</span> <span class="o">==</span> <span class="n">AC_JACK_SPEAKER</span><span class="p">)</span> <span class="p">{</span>
				<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">wcaps</span> <span class="o">=</span> <span class="n">get_wcaps</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">pin</span><span class="p">);</span>
				<span class="n">wcaps</span> <span class="o">&amp;=</span> <span class="p">(</span><span class="n">AC_WCAP_STEREO</span> <span class="o">|</span> <span class="n">AC_WCAP_OUT_AMP</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">wcaps</span> <span class="o">==</span> <span class="n">AC_WCAP_OUT_AMP</span><span class="p">)</span>
					<span class="cm">/* found a mono speaker with an amp,</span>
<span class="cm">					   must be lfe */</span>
					<span class="n">lfe_pin</span> <span class="o">=</span> <span class="n">pin</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">lfe_pin</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">create_controls</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="s">&quot;LFE&quot;</span><span class="p">,</span> <span class="n">lfe_pin</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac9200_parse_auto_config</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">err</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">((</span><span class="n">err</span> <span class="o">=</span> <span class="n">snd_hda_parse_pin_def_config</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">((</span><span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_auto_create_analog_input_ctls</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">((</span><span class="n">err</span> <span class="o">=</span> <span class="n">stac9200_auto_create_hp_ctls</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">((</span><span class="n">err</span> <span class="o">=</span> <span class="n">stac9200_auto_create_lfe_ctls</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_muxes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_auto_create_mux_input_ctls</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_add_input_source</span><span class="p">(</span><span class="n">spec</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">dig_outs</span><span class="p">)</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dig_out_nid</span> <span class="o">=</span> <span class="mh">0x05</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">dig_in_pin</span><span class="p">)</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">dig_in_nid</span> <span class="o">=</span> <span class="mh">0x04</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">kctls</span><span class="p">.</span><span class="n">list</span><span class="p">)</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">mixers</span><span class="p">[</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_mixers</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">kctls</span><span class="p">.</span><span class="n">list</span><span class="p">;</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">input_mux</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">private_imux</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">dinput_mux</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">private_dimux</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * Early 2006 Intel Macintoshes with STAC9220X5 codecs seem to have a</span>
<span class="cm"> * funky external mute control using GPIO pins.</span>
<span class="cm"> */</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac_gpio_set</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mask</span><span class="p">,</span>
			  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dir_mask</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">gpiostate</span><span class="p">,</span> <span class="n">gpiomask</span><span class="p">,</span> <span class="n">gpiodir</span><span class="p">;</span>

	<span class="n">snd_printdd</span><span class="p">(</span><span class="s">&quot;%s msk %x dir %x gpio %x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">dir_mask</span><span class="p">,</span> <span class="n">data</span><span class="p">);</span>

	<span class="n">gpiostate</span> <span class="o">=</span> <span class="n">snd_hda_codec_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">afg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
				       <span class="n">AC_VERB_GET_GPIO_DATA</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">gpiostate</span> <span class="o">=</span> <span class="p">(</span><span class="n">gpiostate</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">dir_mask</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">data</span> <span class="o">&amp;</span> <span class="n">dir_mask</span><span class="p">);</span>

	<span class="n">gpiomask</span> <span class="o">=</span> <span class="n">snd_hda_codec_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">afg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
				      <span class="n">AC_VERB_GET_GPIO_MASK</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">gpiomask</span> <span class="o">|=</span> <span class="n">mask</span><span class="p">;</span>

	<span class="n">gpiodir</span> <span class="o">=</span> <span class="n">snd_hda_codec_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">afg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
				     <span class="n">AC_VERB_GET_GPIO_DIRECTION</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">gpiodir</span> <span class="o">|=</span> <span class="n">dir_mask</span><span class="p">;</span>

	<span class="cm">/* Configure GPIOx as CMOS */</span>
	<span class="n">snd_hda_codec_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">afg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x7e7</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

	<span class="n">snd_hda_codec_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">afg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
			    <span class="n">AC_VERB_SET_GPIO_MASK</span><span class="p">,</span> <span class="n">gpiomask</span><span class="p">);</span>
	<span class="n">snd_hda_codec_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">afg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
			   <span class="n">AC_VERB_SET_GPIO_DIRECTION</span><span class="p">,</span> <span class="n">gpiodir</span><span class="p">);</span> <span class="cm">/* sync */</span>

	<span class="n">msleep</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

	<span class="n">snd_hda_codec_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">afg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
			   <span class="n">AC_VERB_SET_GPIO_DATA</span><span class="p">,</span> <span class="n">gpiostate</span><span class="p">);</span> <span class="cm">/* sync */</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac_add_event</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">,</span>
			  <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">type</span><span class="p">,</span> <span class="kt">int</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_jack_tbl</span> <span class="o">*</span><span class="n">event</span><span class="p">;</span>

	<span class="n">event</span> <span class="o">=</span> <span class="n">snd_hda_jack_tbl_new</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">event</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>
	<span class="n">event</span><span class="o">-&gt;</span><span class="n">action</span> <span class="o">=</span> <span class="n">type</span><span class="p">;</span>
	<span class="n">event</span><span class="o">-&gt;</span><span class="n">private_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* check if given nid is a valid pin and no other events are assigned</span>
<span class="cm"> * to it.  If OK, assign the event, set the unsol flag, and returns 1.</span>
<span class="cm"> * Otherwise, returns zero.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">enable_pin_detect</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">,</span>
			     <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">type</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_jack_tbl</span> <span class="o">*</span><span class="n">event</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">is_jack_detectable</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">event</span> <span class="o">=</span> <span class="n">snd_hda_jack_tbl_new</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">event</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">event</span><span class="o">-&gt;</span><span class="n">action</span> <span class="o">&amp;&amp;</span> <span class="n">event</span><span class="o">-&gt;</span><span class="n">action</span> <span class="o">!=</span> <span class="n">type</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">event</span><span class="o">-&gt;</span><span class="n">action</span> <span class="o">=</span> <span class="n">type</span><span class="p">;</span>
	<span class="n">snd_hda_jack_detect_enable</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">is_nid_out_jack_pin</span><span class="p">(</span><span class="k">struct</span> <span class="n">auto_pin_cfg</span> <span class="o">*</span><span class="n">cfg</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">hp_outs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">cfg</span><span class="o">-&gt;</span><span class="n">hp_pins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">nid</span><span class="p">)</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/* nid is a HP-Out */</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_outs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_out_pins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">nid</span><span class="p">)</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/* nid is a line-Out */</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span> <span class="cm">/* nid is not a HP-Out */</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac92xx_power_down</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>

	<span class="cm">/* power down inactive DACs */</span>
	<span class="k">const</span> <span class="n">hda_nid_t</span> <span class="o">*</span><span class="n">dac</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">dac</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dac_list</span><span class="p">;</span> <span class="o">*</span><span class="n">dac</span><span class="p">;</span> <span class="n">dac</span><span class="o">++</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">check_all_dac_nids</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="o">*</span><span class="n">dac</span><span class="p">))</span>
			<span class="n">snd_hda_codec_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="o">*</span><span class="n">dac</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
					<span class="n">AC_VERB_SET_POWER_STATE</span><span class="p">,</span> <span class="n">AC_PWRST_D3</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="n">stac_toggle_power_map</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">,</span>
				  <span class="kt">int</span> <span class="n">enable</span><span class="p">);</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">get_int_hint</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span>
			       <span class="kt">int</span> <span class="o">*</span><span class="n">valp</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>
	<span class="n">p</span> <span class="o">=</span> <span class="n">snd_hda_get_hint</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">key</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="p">{</span>
		<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">val</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strict_strtoul</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">val</span><span class="p">))</span> <span class="p">{</span>
			<span class="o">*</span><span class="n">valp</span> <span class="o">=</span> <span class="n">val</span><span class="p">;</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* override some hints from the hwdep entry */</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac_store_hints</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">val</span><span class="p">;</span>

	<span class="n">val</span> <span class="o">=</span> <span class="n">snd_hda_get_bool_hint</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="s">&quot;hp_detect&quot;</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">hp_detect</span> <span class="o">=</span> <span class="n">val</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">get_int_hint</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="s">&quot;gpio_mask&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mask</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">eapd_mask</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_dir</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_data</span> <span class="o">=</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mask</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">get_int_hint</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="s">&quot;gpio_dir&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_dir</span><span class="p">))</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mask</span> <span class="o">&amp;=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mask</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">get_int_hint</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="s">&quot;gpio_data&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_data</span><span class="p">))</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_dir</span> <span class="o">&amp;=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mask</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">get_int_hint</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="s">&quot;eapd_mask&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">eapd_mask</span><span class="p">))</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">eapd_mask</span> <span class="o">&amp;=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mask</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">get_int_hint</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="s">&quot;gpio_mute&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mute</span><span class="p">))</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mute</span> <span class="o">&amp;=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mask</span><span class="p">;</span>
	<span class="n">val</span> <span class="o">=</span> <span class="n">snd_hda_get_bool_hint</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="s">&quot;eapd_switch&quot;</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">eapd_switch</span> <span class="o">=</span> <span class="n">val</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac_issue_unsol_events</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="kt">int</span> <span class="n">num_pins</span><span class="p">,</span>
				    <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="o">*</span><span class="n">pins</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">num_pins</span><span class="o">--</span><span class="p">)</span>
		<span class="n">stac_issue_unsol_event</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="o">*</span><span class="n">pins</span><span class="o">++</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* fake event to set up pins */</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac_fake_hp_events</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">hp_outs</span><span class="p">)</span>
		<span class="n">stac_issue_unsol_events</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">hp_outs</span><span class="p">,</span>
					<span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">hp_pins</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">line_outs</span> <span class="o">&amp;&amp;</span>
	    <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">line_out_pins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">hp_pins</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
		<span class="n">stac_issue_unsol_events</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">line_outs</span><span class="p">,</span>
					<span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">line_out_pins</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">auto_pin_cfg</span> <span class="o">*</span><span class="n">cfg</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">gpio</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="n">snd_hda_sequence_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">init</span><span class="p">);</span>

	<span class="cm">/* power down adcs initially */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">powerdown_adcs</span><span class="p">)</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_adcs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
			<span class="n">snd_hda_codec_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
				<span class="n">spec</span><span class="o">-&gt;</span><span class="n">adc_nids</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span>
				<span class="n">AC_VERB_SET_POWER_STATE</span><span class="p">,</span> <span class="n">AC_PWRST_D3</span><span class="p">);</span>

	<span class="cm">/* override some hints */</span>
	<span class="n">stac_store_hints</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>

	<span class="cm">/* set up GPIO */</span>
	<span class="n">gpio</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_data</span><span class="p">;</span>
	<span class="cm">/* turn on EAPD statically when spec-&gt;eapd_switch isn&#39;t set.</span>
<span class="cm">	 * otherwise, unsol event will turn it on/off dynamically</span>
<span class="cm">	 */</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">eapd_switch</span><span class="p">)</span>
		<span class="n">gpio</span> <span class="o">|=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">eapd_mask</span><span class="p">;</span>
	<span class="n">stac_gpio_set</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mask</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_dir</span><span class="p">,</span> <span class="n">gpio</span><span class="p">);</span>

	<span class="cm">/* set up pins */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">hp_detect</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* Enable unsolicited responses on the HP widget */</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">hp_outs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">hda_nid_t</span> <span class="n">nid</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">hp_pins</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
			<span class="n">enable_pin_detect</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">STAC_HP_EVENT</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_out_type</span> <span class="o">==</span> <span class="n">AUTO_PIN_LINE_OUT</span> <span class="o">&amp;&amp;</span>
		    <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">speaker_outs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="cm">/* enable pin-detect for line-outs as well */</span>
			<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_outs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">hda_nid_t</span> <span class="n">nid</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_out_pins</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
				<span class="n">enable_pin_detect</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">STAC_LO_EVENT</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>

		<span class="cm">/* force to enable the first line-out; the others are set up</span>
<span class="cm">		 * in unsol_event</span>
<span class="cm">		 */</span>
		<span class="n">stac92xx_auto_set_pinctl</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">.</span><span class="n">line_out_pins</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
				<span class="n">AC_PINCTL_OUT_EN</span><span class="p">);</span>
		<span class="cm">/* fake event to set up pins */</span>
		<span class="n">stac_fake_hp_events</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">stac92xx_auto_init_multi_out</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
		<span class="n">stac92xx_auto_init_hp_out</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">hp_outs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
			<span class="n">stac_toggle_power_map</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">hp_pins</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_mic</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* initialize connection to analog input */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmux_nids</span><span class="p">)</span>
			<span class="n">snd_hda_codec_write_cache</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmux_nids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span>
					  <span class="n">AC_VERB_SET_CONNECT_SEL</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">enable_pin_detect</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">ext_mic</span><span class="p">.</span><span class="n">pin</span><span class="p">,</span> <span class="n">STAC_MIC_EVENT</span><span class="p">))</span>
			<span class="n">stac_issue_unsol_event</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">ext_mic</span><span class="p">.</span><span class="n">pin</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">enable_pin_detect</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dock_mic</span><span class="p">.</span><span class="n">pin</span><span class="p">,</span>
		    <span class="n">STAC_MIC_EVENT</span><span class="p">))</span>
			<span class="n">stac_issue_unsol_event</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dock_mic</span><span class="p">.</span><span class="n">pin</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">num_inputs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">hda_nid_t</span> <span class="n">nid</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">inputs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">pin</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">type</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">inputs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">type</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">pinctl</span><span class="p">,</span> <span class="n">conf</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">type</span> <span class="o">==</span> <span class="n">AUTO_PIN_MIC</span><span class="p">)</span> <span class="p">{</span>
			<span class="cm">/* for mic pins, force to initialize */</span>
			<span class="n">pinctl</span> <span class="o">=</span> <span class="n">snd_hda_get_default_vref</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
			<span class="n">pinctl</span> <span class="o">|=</span> <span class="n">AC_PINCTL_IN_EN</span><span class="p">;</span>
			<span class="n">stac92xx_auto_set_pinctl</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">pinctl</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">pinctl</span> <span class="o">=</span> <span class="n">snd_hda_codec_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
					<span class="n">AC_VERB_GET_PIN_WIDGET_CONTROL</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
			<span class="cm">/* if PINCTL already set then skip */</span>
			<span class="cm">/* Also, if both INPUT and OUTPUT are set,</span>
<span class="cm">			 * it must be a BIOS bug; need to override, too</span>
<span class="cm">			 */</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">pinctl</span> <span class="o">&amp;</span> <span class="n">AC_PINCTL_IN_EN</span><span class="p">)</span> <span class="o">||</span>
			    <span class="p">(</span><span class="n">pinctl</span> <span class="o">&amp;</span> <span class="n">AC_PINCTL_OUT_EN</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">pinctl</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">AC_PINCTL_OUT_EN</span><span class="p">;</span>
				<span class="n">pinctl</span> <span class="o">|=</span> <span class="n">AC_PINCTL_IN_EN</span><span class="p">;</span>
				<span class="n">stac92xx_auto_set_pinctl</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">pinctl</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="n">conf</span> <span class="o">=</span> <span class="n">snd_hda_codec_get_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">get_defcfg_connect</span><span class="p">(</span><span class="n">conf</span><span class="p">)</span> <span class="o">!=</span> <span class="n">AC_JACK_PORT_FIXED</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">enable_pin_detect</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">STAC_INSERT_EVENT</span><span class="p">))</span>
				<span class="n">stac_issue_unsol_event</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmics</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
		<span class="n">stac92xx_auto_set_pinctl</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmic_nids</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
					<span class="n">AC_PINCTL_IN_EN</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">cfg</span><span class="o">-&gt;</span><span class="n">dig_out_pins</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
		<span class="n">stac92xx_auto_set_pinctl</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">dig_out_pins</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
					 <span class="n">AC_PINCTL_OUT_EN</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">cfg</span><span class="o">-&gt;</span><span class="n">dig_in_pin</span><span class="p">)</span>
		<span class="n">stac92xx_auto_set_pinctl</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">dig_in_pin</span><span class="p">,</span>
					 <span class="n">AC_PINCTL_IN_EN</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pwrs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>  <span class="p">{</span>
		<span class="n">hda_nid_t</span> <span class="n">nid</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">pwr_nids</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">pinctl</span><span class="p">,</span> <span class="n">def_conf</span><span class="p">;</span>

		<span class="n">def_conf</span> <span class="o">=</span> <span class="n">snd_hda_codec_get_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
		<span class="n">def_conf</span> <span class="o">=</span> <span class="n">get_defcfg_connect</span><span class="p">(</span><span class="n">def_conf</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">def_conf</span> <span class="o">==</span> <span class="n">AC_JACK_PORT_NONE</span><span class="p">)</span> <span class="p">{</span>
			<span class="cm">/* power off unused ports */</span>
			<span class="n">stac_toggle_power_map</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
			<span class="k">continue</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">def_conf</span> <span class="o">==</span> <span class="n">AC_JACK_PORT_FIXED</span><span class="p">)</span> <span class="p">{</span>
			<span class="cm">/* no need for jack detection for fixed pins */</span>
			<span class="n">stac_toggle_power_map</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">continue</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="cm">/* power on when no jack detection is available */</span>
		<span class="cm">/* or when the VREF is used for controlling LED */</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">hp_detect</span> <span class="o">||</span>
		    <span class="n">spec</span><span class="o">-&gt;</span><span class="n">vref_mute_led_nid</span> <span class="o">==</span> <span class="n">nid</span> <span class="o">||</span>
		    <span class="o">!</span><span class="n">is_jack_detectable</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">stac_toggle_power_map</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">continue</span><span class="p">;</span>
		<span class="p">}</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">is_nid_out_jack_pin</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">nid</span><span class="p">))</span>
			<span class="k">continue</span><span class="p">;</span> <span class="cm">/* already has an unsol event */</span>

		<span class="n">pinctl</span> <span class="o">=</span> <span class="n">snd_hda_codec_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
					    <span class="n">AC_VERB_GET_PIN_WIDGET_CONTROL</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
		<span class="cm">/* outputs are only ports capable of power management</span>
<span class="cm">		 * any attempts on powering down a input port cause the</span>
<span class="cm">		 * referenced VREF to act quirky.</span>
<span class="cm">		 */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">pinctl</span> <span class="o">&amp;</span> <span class="n">AC_PINCTL_IN_EN</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">stac_toggle_power_map</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">continue</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">enable_pin_detect</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">STAC_PWR_EVENT</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">stac_issue_unsol_event</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
			<span class="k">continue</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="cm">/* none of the above, turn the port OFF */</span>
		<span class="n">stac_toggle_power_map</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">snd_hda_jack_report_sync</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>

	<span class="cm">/* sync mute LED */</span>
	<span class="n">snd_hda_sync_vmaster_hook</span><span class="p">(</span><span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">vmaster_mute</span><span class="p">);</span>

	<span class="cm">/* sync the power-map */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pwrs</span><span class="p">)</span>
		<span class="n">snd_hda_codec_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">afg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
				    <span class="n">AC_VERB_IDT_SET_POWER_MAP</span><span class="p">,</span>
				    <span class="n">spec</span><span class="o">-&gt;</span><span class="n">power_map_bits</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">dac_list</span><span class="p">)</span>
		<span class="n">stac92xx_power_down</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac92xx_free_kctls</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">kctls</span><span class="p">.</span><span class="n">list</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="o">*</span><span class="n">kctl</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">kctls</span><span class="p">.</span><span class="n">list</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">kctls</span><span class="p">.</span><span class="n">used</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
			<span class="n">kfree</span><span class="p">(</span><span class="n">kctl</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">name</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">snd_array_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">kctls</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac92xx_shutup_pins</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">def_conf</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">bus</span><span class="o">-&gt;</span><span class="n">shutdown</span><span class="p">)</span>
		<span class="k">return</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">init_pins</span><span class="p">.</span><span class="n">used</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="n">hda_pincfg</span> <span class="o">*</span><span class="n">pin</span> <span class="o">=</span> <span class="n">snd_array_elem</span><span class="p">(</span><span class="o">&amp;</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">init_pins</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
		<span class="n">def_conf</span> <span class="o">=</span> <span class="n">snd_hda_codec_get_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">pin</span><span class="o">-&gt;</span><span class="n">nid</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">get_defcfg_connect</span><span class="p">(</span><span class="n">def_conf</span><span class="p">)</span> <span class="o">!=</span> <span class="n">AC_JACK_PORT_NONE</span><span class="p">)</span>
			<span class="n">snd_hda_set_pin_ctl</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">pin</span><span class="o">-&gt;</span><span class="n">nid</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac92xx_shutup</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>

	<span class="n">stac92xx_shutup_pins</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">eapd_mask</span><span class="p">)</span>
		<span class="n">stac_gpio_set</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mask</span><span class="p">,</span>
				<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_dir</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_data</span> <span class="o">&amp;</span>
				<span class="o">~</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">eapd_mask</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac92xx_free</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="n">spec</span><span class="p">)</span>
		<span class="k">return</span><span class="p">;</span>

	<span class="n">stac92xx_shutup</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>

	<span class="n">kfree</span><span class="p">(</span><span class="n">spec</span><span class="p">);</span>
	<span class="n">snd_hda_detach_beep_device</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac92xx_set_pinctl</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">,</span>
				<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">flag</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">old_ctl</span><span class="p">,</span> <span class="n">pin_ctl</span><span class="p">;</span>

	<span class="n">pin_ctl</span> <span class="o">=</span> <span class="n">snd_hda_codec_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span>
			<span class="mi">0</span><span class="p">,</span> <span class="n">AC_VERB_GET_PIN_WIDGET_CONTROL</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">pin_ctl</span> <span class="o">&amp;</span> <span class="n">AC_PINCTL_IN_EN</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/*</span>
<span class="cm">		 * we need to check the current set-up direction of</span>
<span class="cm">		 * shared input pins since they can be switched via</span>
<span class="cm">		 * &quot;xxx as Output&quot; mixer switch</span>
<span class="cm">		 */</span>
		<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">nid</span> <span class="o">==</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">line_switch</span> <span class="o">||</span> <span class="n">nid</span> <span class="o">==</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">mic_switch</span><span class="p">)</span>
			<span class="k">return</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">old_ctl</span> <span class="o">=</span> <span class="n">pin_ctl</span><span class="p">;</span>
	<span class="cm">/* if setting pin direction bits, clear the current</span>
<span class="cm">	   direction bits first */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">flag</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">AC_PINCTL_IN_EN</span> <span class="o">|</span> <span class="n">AC_PINCTL_OUT_EN</span><span class="p">))</span>
		<span class="n">pin_ctl</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="p">(</span><span class="n">AC_PINCTL_IN_EN</span> <span class="o">|</span> <span class="n">AC_PINCTL_OUT_EN</span><span class="p">);</span>
	
	<span class="n">pin_ctl</span> <span class="o">|=</span> <span class="n">flag</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">old_ctl</span> <span class="o">!=</span> <span class="n">pin_ctl</span><span class="p">)</span>
		<span class="n">snd_hda_set_pin_ctl_cache</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">pin_ctl</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac92xx_reset_pinctl</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">,</span>
				  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">flag</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">pin_ctl</span> <span class="o">=</span> <span class="n">snd_hda_codec_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span>
			<span class="mi">0</span><span class="p">,</span> <span class="n">AC_VERB_GET_PIN_WIDGET_CONTROL</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">pin_ctl</span> <span class="o">&amp;</span> <span class="n">flag</span><span class="p">)</span>
		<span class="n">snd_hda_set_pin_ctl_cache</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">pin_ctl</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">flag</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">get_pin_presence</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">nid</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">snd_hda_jack_detect</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac92xx_line_out_detect</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
				     <span class="kt">int</span> <span class="n">presence</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">auto_pin_cfg</span> <span class="o">*</span><span class="n">cfg</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_outs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">presence</span><span class="p">)</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="n">presence</span> <span class="o">=</span> <span class="n">get_pin_presence</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_out_pins</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">presence</span><span class="p">)</span> <span class="p">{</span>
			<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">pinctl</span><span class="p">;</span>
			<span class="n">pinctl</span> <span class="o">=</span> <span class="n">snd_hda_codec_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
						    <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_out_pins</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span>
					    <span class="n">AC_VERB_GET_PIN_WIDGET_CONTROL</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">pinctl</span> <span class="o">&amp;</span> <span class="n">AC_PINCTL_IN_EN</span><span class="p">)</span>
				<span class="n">presence</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="cm">/* mic- or line-input */</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">presence</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* disable speakers */</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">speaker_outs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
			<span class="n">stac92xx_reset_pinctl</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">speaker_pins</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
						<span class="n">AC_PINCTL_OUT_EN</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">eapd_mask</span> <span class="o">&amp;&amp;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">eapd_switch</span><span class="p">)</span>
			<span class="n">stac_gpio_set</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mask</span><span class="p">,</span>
				<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_dir</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_data</span> <span class="o">&amp;</span>
				<span class="o">~</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">eapd_mask</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="cm">/* enable speakers */</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">speaker_outs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
			<span class="n">stac92xx_set_pinctl</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">speaker_pins</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
						<span class="n">AC_PINCTL_OUT_EN</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">eapd_mask</span> <span class="o">&amp;&amp;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">eapd_switch</span><span class="p">)</span>
			<span class="n">stac_gpio_set</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mask</span><span class="p">,</span>
				<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_dir</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_data</span> <span class="o">|</span>
				<span class="n">spec</span><span class="o">-&gt;</span><span class="n">eapd_mask</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span> 

<span class="cm">/* return non-zero if the hp-pin of the given array index isn&#39;t</span>
<span class="cm"> * a jack-detection target</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">no_hp_sensing</span><span class="p">(</span><span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span><span class="p">,</span> <span class="kt">int</span> <span class="n">i</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">auto_pin_cfg</span> <span class="o">*</span><span class="n">cfg</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">;</span>

	<span class="cm">/* ignore sensing of shared line and mic jacks */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">cfg</span><span class="o">-&gt;</span><span class="n">hp_pins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">line_switch</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">cfg</span><span class="o">-&gt;</span><span class="n">hp_pins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">mic_switch</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="cm">/* ignore if the pin is set as line-out */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">cfg</span><span class="o">-&gt;</span><span class="n">hp_pins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">hp_switch</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac92xx_hp_detect</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">auto_pin_cfg</span> <span class="o">*</span><span class="n">cfg</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">autocfg</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">presence</span><span class="p">;</span>

	<span class="n">presence</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mute</span><span class="p">)</span>
		<span class="n">presence</span> <span class="o">=</span> <span class="o">!</span><span class="p">(</span><span class="n">snd_hda_codec_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">afg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
			<span class="n">AC_VERB_GET_GPIO_DATA</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mute</span><span class="p">);</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">hp_outs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">presence</span><span class="p">)</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">no_hp_sensing</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
			<span class="k">continue</span><span class="p">;</span>
		<span class="n">presence</span> <span class="o">=</span> <span class="n">get_pin_presence</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">hp_pins</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">presence</span><span class="p">)</span> <span class="p">{</span>
			<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">pinctl</span><span class="p">;</span>
			<span class="n">pinctl</span> <span class="o">=</span> <span class="n">snd_hda_codec_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">hp_pins</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span>
					    <span class="n">AC_VERB_GET_PIN_WIDGET_CONTROL</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">pinctl</span> <span class="o">&amp;</span> <span class="n">AC_PINCTL_IN_EN</span><span class="p">)</span>
				<span class="n">presence</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="cm">/* mic- or line-input */</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">presence</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* disable lineouts */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">hp_switch</span><span class="p">)</span>
			<span class="n">stac92xx_reset_pinctl</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">hp_switch</span><span class="p">,</span>
					      <span class="n">AC_PINCTL_OUT_EN</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_outs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
			<span class="n">stac92xx_reset_pinctl</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_out_pins</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
						<span class="n">AC_PINCTL_OUT_EN</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="cm">/* enable lineouts */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">hp_switch</span><span class="p">)</span>
			<span class="n">stac92xx_set_pinctl</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">hp_switch</span><span class="p">,</span>
					    <span class="n">AC_PINCTL_OUT_EN</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_outs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
			<span class="n">stac92xx_set_pinctl</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">line_out_pins</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
						<span class="n">AC_PINCTL_OUT_EN</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">stac92xx_line_out_detect</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">presence</span><span class="p">);</span>
	<span class="cm">/* toggle hp outs */</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">hp_outs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">val</span> <span class="o">=</span> <span class="n">AC_PINCTL_OUT_EN</span> <span class="o">|</span> <span class="n">AC_PINCTL_HP_EN</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">no_hp_sensing</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
			<span class="k">continue</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="mi">1</span> <span class="cm">/*presence*/</span><span class="p">)</span>
			<span class="n">stac92xx_set_pinctl</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">cfg</span><span class="o">-&gt;</span><span class="n">hp_pins</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">val</span><span class="p">);</span>
<span class="cp">#if 0</span><span class="c"> /* FIXME */</span>
<span class="c">/* Resetting the pinctl like below may lead to (a sort of) regressions</span>
<span class="c"> * on some devices since they use the HP pin actually for line/speaker</span>
<span class="c"> * outs although the default pin config shows a different pin (that is</span>
<span class="c"> * wrong and useless).</span>
<span class="c"> *</span>
<span class="c"> * So, it&#39;s basically a problem of default pin configs, likely a BIOS issue.</span>
<span class="c"> * But, disabling the code below just works around it, and I&#39;m too tired of</span>
<span class="c"> * bug reports with such devices... </span>
<span class="c"> */</span>
<span class="c">		else</span>
<span class="c">			stac92xx_reset_pinctl(codec, cfg-&gt;hp_pins[i], val);</span>
<span class="cp">#endif /* FIXME */</span>
	<span class="p">}</span>
<span class="p">}</span> 

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac_toggle_power_map</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">,</span>
				  <span class="kt">int</span> <span class="n">enable</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">idx</span><span class="p">,</span> <span class="n">val</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pwrs</span><span class="p">;</span> <span class="n">idx</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">pwr_nids</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">==</span> <span class="n">nid</span><span class="p">)</span>
			<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">idx</span> <span class="o">&gt;=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pwrs</span><span class="p">)</span>
		<span class="k">return</span><span class="p">;</span>

	<span class="n">idx</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">idx</span><span class="p">;</span>

	<span class="n">val</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">power_map_bits</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">enable</span><span class="p">)</span>
		<span class="n">val</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">idx</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="n">val</span> <span class="o">|=</span> <span class="n">idx</span><span class="p">;</span>

	<span class="cm">/* power down unused output ports */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">!=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">power_map_bits</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">power_map_bits</span> <span class="o">=</span> <span class="n">val</span><span class="p">;</span>
		<span class="n">snd_hda_codec_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">afg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
				    <span class="n">AC_VERB_IDT_SET_POWER_MAP</span><span class="p">,</span> <span class="n">val</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac92xx_pin_sense</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">stac_toggle_power_map</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">get_pin_presence</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">));</span>
<span class="p">}</span>

<span class="cm">/* get the pin connection (fixed, none, etc) */</span>
<span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">stac_get_defcfg_connect</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="kt">int</span> <span class="n">idx</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cfg</span><span class="p">;</span>

	<span class="n">cfg</span> <span class="o">=</span> <span class="n">snd_hda_codec_get_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">pin_nids</span><span class="p">[</span><span class="n">idx</span><span class="p">]);</span>
	<span class="k">return</span> <span class="n">get_defcfg_connect</span><span class="p">(</span><span class="n">cfg</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_connected_ports</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
				    <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="o">*</span><span class="n">nids</span><span class="p">,</span> <span class="kt">int</span> <span class="n">num_nids</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">idx</span><span class="p">,</span> <span class="n">num</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">def_conf</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">num</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="n">num_nids</span><span class="p">;</span> <span class="n">num</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pins</span><span class="p">;</span> <span class="n">idx</span><span class="o">++</span><span class="p">)</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">pin_nids</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">==</span> <span class="n">nids</span><span class="p">[</span><span class="n">num</span><span class="p">])</span>
				<span class="k">break</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">idx</span> <span class="o">&gt;=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pins</span><span class="p">)</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="n">def_conf</span> <span class="o">=</span> <span class="n">stac_get_defcfg_connect</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">idx</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">def_conf</span> <span class="o">==</span> <span class="n">AC_JACK_PORT_NONE</span><span class="p">)</span>
			<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">num</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac92xx_mic_detect</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sigmatel_mic_route</span> <span class="o">*</span><span class="n">mic</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">get_pin_presence</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">ext_mic</span><span class="p">.</span><span class="n">pin</span><span class="p">))</span>
		<span class="n">mic</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">ext_mic</span><span class="p">;</span>
	<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">get_pin_presence</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dock_mic</span><span class="p">.</span><span class="n">pin</span><span class="p">))</span>
		<span class="n">mic</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">dock_mic</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="n">mic</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">int_mic</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">mic</span><span class="o">-&gt;</span><span class="n">dmux_idx</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">snd_hda_codec_write_cache</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmux_nids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span>
					  <span class="n">AC_VERB_SET_CONNECT_SEL</span><span class="p">,</span>
					  <span class="n">mic</span><span class="o">-&gt;</span><span class="n">dmux_idx</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">mic</span><span class="o">-&gt;</span><span class="n">mux_idx</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">snd_hda_codec_write_cache</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">mux_nids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span>
					  <span class="n">AC_VERB_SET_CONNECT_SEL</span><span class="p">,</span>
					  <span class="n">mic</span><span class="o">-&gt;</span><span class="n">mux_idx</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">handle_unsol_event</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">hda_jack_tbl</span> <span class="o">*</span><span class="n">event</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">data</span><span class="p">;</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">event</span><span class="o">-&gt;</span><span class="n">action</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">STAC_HP_EVENT</span>:
	<span class="k">case</span> <span class="n">STAC_LO_EVENT</span>:
		<span class="n">stac92xx_hp_detect</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">STAC_MIC_EVENT</span>:
		<span class="n">stac92xx_mic_detect</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">event</span><span class="o">-&gt;</span><span class="n">action</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">STAC_HP_EVENT</span>:
	<span class="k">case</span> <span class="n">STAC_LO_EVENT</span>:
	<span class="k">case</span> <span class="n">STAC_MIC_EVENT</span>:
	<span class="k">case</span> <span class="n">STAC_INSERT_EVENT</span>:
	<span class="k">case</span> <span class="n">STAC_PWR_EVENT</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pwrs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="n">stac92xx_pin_sense</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">event</span><span class="o">-&gt;</span><span class="n">nid</span><span class="p">);</span>

		<span class="k">switch</span> <span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">subsystem_id</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="mh">0x103c308f</span>:
			<span class="k">if</span> <span class="p">(</span><span class="n">event</span><span class="o">-&gt;</span><span class="n">nid</span> <span class="o">==</span> <span class="mh">0xb</span><span class="p">)</span> <span class="p">{</span>
				<span class="kt">int</span> <span class="n">pin</span> <span class="o">=</span> <span class="n">AC_PINCTL_IN_EN</span><span class="p">;</span>

				<span class="k">if</span> <span class="p">(</span><span class="n">get_pin_presence</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0xa</span><span class="p">)</span>
						<span class="o">&amp;&amp;</span> <span class="n">get_pin_presence</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0xb</span><span class="p">))</span>
					<span class="n">pin</span> <span class="o">|=</span> <span class="n">AC_PINCTL_VREF_80</span><span class="p">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">get_pin_presence</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0xb</span><span class="p">))</span>
					<span class="n">pin</span> <span class="o">|=</span> <span class="n">AC_PINCTL_VREF_80</span><span class="p">;</span>

				<span class="cm">/* toggle VREF state based on mic + hp pin</span>
<span class="cm">				 * status</span>
<span class="cm">				 */</span>
				<span class="n">stac92xx_auto_set_pinctl</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0x0a</span><span class="p">,</span> <span class="n">pin</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">STAC_VREF_EVENT</span>:
		<span class="n">data</span> <span class="o">=</span> <span class="n">snd_hda_codec_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">afg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
					  <span class="n">AC_VERB_GET_GPIO_DATA</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
		<span class="cm">/* toggle VREF state based on GPIOx status */</span>
		<span class="n">snd_hda_codec_write</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">afg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x7e0</span><span class="p">,</span>
				    <span class="o">!!</span><span class="p">(</span><span class="n">data</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">event</span><span class="o">-&gt;</span><span class="n">private_data</span><span class="p">)));</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac_issue_unsol_event</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_jack_tbl</span> <span class="o">*</span><span class="n">event</span> <span class="o">=</span> <span class="n">snd_hda_jack_tbl_get</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">event</span><span class="p">)</span>
		<span class="k">return</span><span class="p">;</span>
	<span class="n">handle_unsol_event</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">event</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac92xx_unsol_event</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">res</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_jack_tbl</span> <span class="o">*</span><span class="n">event</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">tag</span><span class="p">;</span>

	<span class="n">tag</span> <span class="o">=</span> <span class="p">(</span><span class="n">res</span> <span class="o">&gt;&gt;</span> <span class="mi">26</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x7f</span><span class="p">;</span>
	<span class="n">event</span> <span class="o">=</span> <span class="n">snd_hda_jack_tbl_get_from_tag</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">tag</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">event</span><span class="p">)</span>
		<span class="k">return</span><span class="p">;</span>
	<span class="n">event</span><span class="o">-&gt;</span><span class="n">jack_dirty</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">handle_unsol_event</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">event</span><span class="p">);</span>
	<span class="n">snd_hda_jack_report_sync</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="n">hp_blike_system</span><span class="p">(</span><span class="n">u32</span> <span class="n">subsystem_id</span><span class="p">);</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">set_hp_led_gpio</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">gpio</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led</span><span class="p">)</span>
		<span class="k">return</span><span class="p">;</span>

	<span class="n">gpio</span> <span class="o">=</span> <span class="n">snd_hda_param_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">afg</span><span class="p">,</span> <span class="n">AC_PAR_GPIO_CAP</span><span class="p">);</span>
	<span class="n">gpio</span> <span class="o">&amp;=</span> <span class="n">AC_GPIO_IO_COUNT</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">gpio</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led</span> <span class="o">=</span> <span class="mh">0x08</span><span class="p">;</span> <span class="cm">/* GPIO 3 */</span>
	<span class="k">else</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led</span> <span class="o">=</span> <span class="mh">0x01</span><span class="p">;</span> <span class="cm">/* GPIO 0 */</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * This method searches for the mute LED GPIO configuration</span>
<span class="cm"> * provided as OEM string in SMBIOS. The format of that string</span>
<span class="cm"> * is HP_Mute_LED_P_G or HP_Mute_LED_P</span>
<span class="cm"> * where P can be 0 or 1 and defines mute LED GPIO control state (low/high)</span>
<span class="cm"> * that corresponds to the NOT muted state of the master volume</span>
<span class="cm"> * and G is the index of the GPIO to use as the mute LED control (0..9)</span>
<span class="cm"> * If _G portion is missing it is assigned based on the codec ID</span>
<span class="cm"> *</span>
<span class="cm"> * So, HP B-series like systems may have HP_Mute_LED_0 (current models)</span>
<span class="cm"> * or  HP_Mute_LED_0_3 (future models) OEM SMBIOS strings</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> * The dv-series laptops don&#39;t seem to have the HP_Mute_LED* strings in</span>
<span class="cm"> * SMBIOS - at least the ones I have seen do not have them - which include</span>
<span class="cm"> * my own system (HP Pavilion dv6-1110ax) and my cousin&#39;s</span>
<span class="cm"> * HP Pavilion dv9500t CTO.</span>
<span class="cm"> * Need more information on whether it is true across the entire series.</span>
<span class="cm"> * -- kunal</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">find_mute_led_cfg</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="kt">int</span> <span class="n">default_polarity</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">dmi_device</span> <span class="o">*</span><span class="n">dev</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">get_int_hint</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="s">&quot;gpio_led&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">get_int_hint</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="s">&quot;gpio_led_polarity&quot;</span><span class="p">,</span>
			     <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led_polarity</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">subsystem_id</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">==</span> <span class="n">PCI_VENDOR_ID_HP</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">while</span> <span class="p">((</span><span class="n">dev</span> <span class="o">=</span> <span class="n">dmi_find_device</span><span class="p">(</span><span class="n">DMI_DEV_TYPE_OEM_STRING</span><span class="p">,</span>
								<span class="nb">NULL</span><span class="p">,</span> <span class="n">dev</span><span class="p">)))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">sscanf</span><span class="p">(</span><span class="n">dev</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="s">&quot;HP_Mute_LED_%d_%x&quot;</span><span class="p">,</span>
				  <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led_polarity</span><span class="p">,</span>
				  <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
				<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">max_gpio</span><span class="p">;</span>
				<span class="n">max_gpio</span> <span class="o">=</span> <span class="n">snd_hda_param_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">afg</span><span class="p">,</span>
							      <span class="n">AC_PAR_GPIO_CAP</span><span class="p">);</span>
				<span class="n">max_gpio</span> <span class="o">&amp;=</span> <span class="n">AC_GPIO_IO_COUNT</span><span class="p">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led</span> <span class="o">&lt;</span> <span class="n">max_gpio</span><span class="p">)</span>
					<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led</span><span class="p">;</span>
				<span class="k">else</span>
					<span class="n">spec</span><span class="o">-&gt;</span><span class="n">vref_mute_led_nid</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led</span><span class="p">;</span>
				<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">sscanf</span><span class="p">(</span><span class="n">dev</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="s">&quot;HP_Mute_LED_%d&quot;</span><span class="p">,</span>
				  <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led_polarity</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">set_hp_led_gpio</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
				<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="cm">/* BIOS bug: unfilled OEM string */</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">strstr</span><span class="p">(</span><span class="n">dev</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="s">&quot;HP_Mute_LED_P_G&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">set_hp_led_gpio</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
				<span class="k">switch</span> <span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">subsystem_id</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">case</span> <span class="mh">0x103c148a</span>:
					<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led_polarity</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="nl">default:</span>
					<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led_polarity</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="p">}</span>
				<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>

		<span class="cm">/*</span>
<span class="cm">		 * Fallback case - if we don&#39;t find the DMI strings,</span>
<span class="cm">		 * we statically set the GPIO - if not a B-series system</span>
<span class="cm">		 * and default polarity is provided</span>
<span class="cm">		 */</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">hp_blike_system</span><span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">subsystem_id</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
			<span class="p">(</span><span class="n">default_polarity</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">default_polarity</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">set_hp_led_gpio</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led_polarity</span> <span class="o">=</span> <span class="n">default_polarity</span><span class="p">;</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">hp_blike_system</span><span class="p">(</span><span class="n">u32</span> <span class="n">subsystem_id</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">subsystem_id</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="mh">0x103c1520</span>:
	<span class="k">case</span> <span class="mh">0x103c1521</span>:
	<span class="k">case</span> <span class="mh">0x103c1523</span>:
	<span class="k">case</span> <span class="mh">0x103c1524</span>:
	<span class="k">case</span> <span class="mh">0x103c1525</span>:
	<span class="k">case</span> <span class="mh">0x103c1722</span>:
	<span class="k">case</span> <span class="mh">0x103c1723</span>:
	<span class="k">case</span> <span class="mh">0x103c1724</span>:
	<span class="k">case</span> <span class="mh">0x103c1725</span>:
	<span class="k">case</span> <span class="mh">0x103c1726</span>:
	<span class="k">case</span> <span class="mh">0x103c1727</span>:
	<span class="k">case</span> <span class="mh">0x103c1728</span>:
	<span class="k">case</span> <span class="mh">0x103c1729</span>:
	<span class="k">case</span> <span class="mh">0x103c172a</span>:
	<span class="k">case</span> <span class="mh">0x103c172b</span>:
	<span class="k">case</span> <span class="mh">0x103c307e</span>:
	<span class="k">case</span> <span class="mh">0x103c307f</span>:
	<span class="k">case</span> <span class="mh">0x103c3080</span>:
	<span class="k">case</span> <span class="mh">0x103c3081</span>:
	<span class="k">case</span> <span class="mh">0x103c7007</span>:
	<span class="k">case</span> <span class="mh">0x103c7008</span>:
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#ifdef CONFIG_PROC_FS</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac92hd_proc_hook</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_info_buffer</span> <span class="o">*</span><span class="n">buffer</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">nid</span> <span class="o">==</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">afg</span><span class="p">)</span>
		<span class="n">snd_iprintf</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="s">&quot;Power-Map: 0x%02x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> 
			    <span class="n">snd_hda_codec_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
					       <span class="n">AC_VERB_IDT_GET_POWER_MAP</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">analog_loop_proc_hook</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_info_buffer</span> <span class="o">*</span><span class="n">buffer</span><span class="p">,</span>
				  <span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
				  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">verb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">snd_iprintf</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="s">&quot;Analog Loopback: 0x%02x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
		    <span class="n">snd_hda_codec_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">afg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">verb</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
<span class="p">}</span>

<span class="cm">/* stac92hd71bxx, stac92hd73xx */</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac92hd7x_proc_hook</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_info_buffer</span> <span class="o">*</span><span class="n">buffer</span><span class="p">,</span>
				 <span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">stac92hd_proc_hook</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">nid</span> <span class="o">==</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">afg</span><span class="p">)</span>
		<span class="n">analog_loop_proc_hook</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">codec</span><span class="p">,</span> <span class="mh">0xfa0</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac9205_proc_hook</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_info_buffer</span> <span class="o">*</span><span class="n">buffer</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">nid</span> <span class="o">==</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">afg</span><span class="p">)</span>
		<span class="n">analog_loop_proc_hook</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">codec</span><span class="p">,</span> <span class="mh">0xfe0</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac927x_proc_hook</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_info_buffer</span> <span class="o">*</span><span class="n">buffer</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">nid</span> <span class="o">==</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">afg</span><span class="p">)</span>
		<span class="n">analog_loop_proc_hook</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">codec</span><span class="p">,</span> <span class="mh">0xfeb</span><span class="p">);</span>
<span class="p">}</span>
<span class="cp">#else</span>
<span class="cp">#define stac92hd_proc_hook	NULL</span>
<span class="cp">#define stac92hd7x_proc_hook	NULL</span>
<span class="cp">#define stac9205_proc_hook	NULL</span>
<span class="cp">#define stac927x_proc_hook	NULL</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef CONFIG_PM</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_resume</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">stac92xx_init</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
	<span class="n">snd_hda_codec_resume_amp</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
	<span class="n">snd_hda_codec_resume_cache</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
	<span class="cm">/* fake event to set up pins again to override cached values */</span>
	<span class="n">stac_fake_hp_events</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92xx_suspend</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="n">pm_message_t</span> <span class="n">state</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">stac92xx_shutup</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac92xx_set_power_state</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">fg</span><span class="p">,</span>
				<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">power_state</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">afg_power_state</span> <span class="o">=</span> <span class="n">power_state</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">power_state</span> <span class="o">==</span> <span class="n">AC_PWRST_D3</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">vref_mute_led_nid</span><span class="p">)</span> <span class="p">{</span>
			<span class="cm">/* with vref-out pin used for mute led control</span>
<span class="cm">			 * codec AFG is prevented from D3 state</span>
<span class="cm">			 */</span>
			<span class="n">afg_power_state</span> <span class="o">=</span> <span class="n">AC_PWRST_D1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="cm">/* this delay seems necessary to avoid click noise at power-down */</span>
		<span class="n">msleep</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">snd_hda_codec_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">fg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">AC_VERB_SET_POWER_STATE</span><span class="p">,</span>
			<span class="n">afg_power_state</span><span class="p">);</span>
	<span class="n">snd_hda_codec_set_power_to_all</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">fg</span><span class="p">,</span> <span class="n">power_state</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
<span class="p">}</span>
<span class="cp">#else</span>
<span class="cp">#define stac92xx_suspend	NULL</span>
<span class="cp">#define stac92xx_resume		NULL</span>
<span class="cp">#define stac92xx_set_power_state NULL</span>
<span class="cp">#endif </span><span class="cm">/* CONFIG_PM */</span><span class="cp"></span>

<span class="cm">/* update mute-LED accoring to the master switch */</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac92xx_update_led_status</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="kt">int</span> <span class="n">enabled</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">muted</span> <span class="o">=</span> <span class="o">!</span><span class="n">enabled</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led</span><span class="p">)</span>
		<span class="k">return</span><span class="p">;</span>

	<span class="cm">/* LED state is inverted on these systems */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led_polarity</span><span class="p">)</span>
		<span class="n">muted</span> <span class="o">=</span> <span class="o">!</span><span class="n">muted</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">vref_mute_led_nid</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">muted</span><span class="p">)</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_data</span> <span class="o">|=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led</span><span class="p">;</span>
		<span class="k">else</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_data</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led</span><span class="p">;</span>
		<span class="n">stac_gpio_set</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mask</span><span class="p">,</span>
				<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_dir</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_data</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">vref_led</span> <span class="o">=</span> <span class="n">muted</span> <span class="o">?</span> <span class="n">AC_PINCTL_VREF_50</span> <span class="o">:</span> <span class="n">AC_PINCTL_VREF_GRD</span><span class="p">;</span>
		<span class="n">stac_vrefout_set</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">vref_mute_led_nid</span><span class="p">,</span>
				 <span class="n">spec</span><span class="o">-&gt;</span><span class="n">vref_led</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hda_codec_ops</span> <span class="n">stac92xx_patch_ops</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">build_controls</span> <span class="o">=</span> <span class="n">stac92xx_build_controls</span><span class="p">,</span>
	<span class="p">.</span><span class="n">build_pcms</span> <span class="o">=</span> <span class="n">stac92xx_build_pcms</span><span class="p">,</span>
	<span class="p">.</span><span class="n">init</span> <span class="o">=</span> <span class="n">stac92xx_init</span><span class="p">,</span>
	<span class="p">.</span><span class="n">free</span> <span class="o">=</span> <span class="n">stac92xx_free</span><span class="p">,</span>
	<span class="p">.</span><span class="n">unsol_event</span> <span class="o">=</span> <span class="n">stac92xx_unsol_event</span><span class="p">,</span>
<span class="cp">#ifdef CONFIG_PM</span>
	<span class="p">.</span><span class="n">suspend</span> <span class="o">=</span> <span class="n">stac92xx_suspend</span><span class="p">,</span>
	<span class="p">.</span><span class="n">resume</span> <span class="o">=</span> <span class="n">stac92xx_resume</span><span class="p">,</span>
<span class="cp">#endif</span>
	<span class="p">.</span><span class="n">reboot_notify</span> <span class="o">=</span> <span class="n">stac92xx_shutup</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">patch_stac9200</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">err</span><span class="p">;</span>

	<span class="n">spec</span>  <span class="o">=</span> <span class="n">kzalloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">spec</span><span class="p">),</span> <span class="n">GFP_KERNEL</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>

	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">no_trigger_sense</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span> <span class="o">=</span> <span class="n">spec</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">linear_tone_beep</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pins</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac9200_pin_nids</span><span class="p">);</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">pin_nids</span> <span class="o">=</span> <span class="n">stac9200_pin_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">=</span> <span class="n">snd_hda_check_board_config</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">STAC_9200_MODELS</span><span class="p">,</span>
							<span class="n">stac9200_models</span><span class="p">,</span>
							<span class="n">stac9200_cfg_tbl</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">snd_printdd</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;hda_codec: %s: BIOS auto-probing.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
			    <span class="n">codec</span><span class="o">-&gt;</span><span class="n">chip_name</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="n">stac92xx_set_config_regs</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
					 <span class="n">stac9200_brd_tbl</span><span class="p">[</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span><span class="p">]);</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">max_channels</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">num_dacs</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dac_nids</span> <span class="o">=</span> <span class="n">stac9200_dac_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">adc_nids</span> <span class="o">=</span> <span class="n">stac9200_adc_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">mux_nids</span> <span class="o">=</span> <span class="n">stac9200_mux_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_muxes</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmics</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_adcs</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pwrs</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">==</span> <span class="n">STAC_9200_M4</span> <span class="o">||</span>
	    <span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">==</span> <span class="n">STAC_9200_M4_2</span> <span class="o">||</span>
	    <span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">==</span> <span class="n">STAC_9200_OQO</span><span class="p">)</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">init</span> <span class="o">=</span> <span class="n">stac9200_eapd_init</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">init</span> <span class="o">=</span> <span class="n">stac9200_core_init</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">mixer</span> <span class="o">=</span> <span class="n">stac9200_mixer</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">==</span> <span class="n">STAC_9200_PANASONIC</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mask</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_dir</span> <span class="o">=</span> <span class="mh">0x09</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_data</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">err</span> <span class="o">=</span> <span class="n">stac9200_parse_auto_config</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">stac92xx_free</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="cm">/* CF-74 has no headphone detection, and the driver should *NOT*</span>
<span class="cm">	 * do detection and HP/speaker toggle because the hardware does it.</span>
<span class="cm">	 */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">==</span> <span class="n">STAC_9200_PANASONIC</span><span class="p">)</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">hp_detect</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">patch_ops</span> <span class="o">=</span> <span class="n">stac92xx_patch_ops</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">patch_stac925x</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">err</span><span class="p">;</span>

	<span class="n">spec</span>  <span class="o">=</span> <span class="n">kzalloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">spec</span><span class="p">),</span> <span class="n">GFP_KERNEL</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>

	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">no_trigger_sense</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span> <span class="o">=</span> <span class="n">spec</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">linear_tone_beep</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pins</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac925x_pin_nids</span><span class="p">);</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">pin_nids</span> <span class="o">=</span> <span class="n">stac925x_pin_nids</span><span class="p">;</span>

	<span class="cm">/* Check first for codec ID */</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">=</span> <span class="n">snd_hda_check_board_codec_sid_config</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
							<span class="n">STAC_925x_MODELS</span><span class="p">,</span>
							<span class="n">stac925x_models</span><span class="p">,</span>
							<span class="n">stac925x_codec_id_cfg_tbl</span><span class="p">);</span>

	<span class="cm">/* Now checks for PCI ID, if codec ID is not found */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">=</span> <span class="n">snd_hda_check_board_config</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
							<span class="n">STAC_925x_MODELS</span><span class="p">,</span>
							<span class="n">stac925x_models</span><span class="p">,</span>
							<span class="n">stac925x_cfg_tbl</span><span class="p">);</span>
 <span class="nl">again:</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">snd_printdd</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;hda_codec: %s: BIOS auto-probing.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
			    <span class="n">codec</span><span class="o">-&gt;</span><span class="n">chip_name</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="n">stac92xx_set_config_regs</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
					 <span class="n">stac925x_brd_tbl</span><span class="p">[</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span><span class="p">]);</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">max_channels</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">num_dacs</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dac_nids</span> <span class="o">=</span> <span class="n">stac925x_dac_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">adc_nids</span> <span class="o">=</span> <span class="n">stac925x_adc_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">mux_nids</span> <span class="o">=</span> <span class="n">stac925x_mux_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_muxes</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_adcs</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pwrs</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">vendor_id</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="mh">0x83847632</span>: <span class="cm">/* STAC9202  */</span>
	<span class="k">case</span> <span class="mh">0x83847633</span>: <span class="cm">/* STAC9202D */</span>
	<span class="k">case</span> <span class="mh">0x83847636</span>: <span class="cm">/* STAC9251  */</span>
	<span class="k">case</span> <span class="mh">0x83847637</span>: <span class="cm">/* STAC9251D */</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmics</span> <span class="o">=</span> <span class="n">STAC925X_NUM_DMICS</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmic_nids</span> <span class="o">=</span> <span class="n">stac925x_dmic_nids</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmuxes</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac925x_dmux_nids</span><span class="p">);</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmux_nids</span> <span class="o">=</span> <span class="n">stac925x_dmux_nids</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmics</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">init</span> <span class="o">=</span> <span class="n">stac925x_core_init</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">mixer</span> <span class="o">=</span> <span class="n">stac925x_mixer</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_caps</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">capvols</span> <span class="o">=</span> <span class="n">stac925x_capvols</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">capsws</span> <span class="o">=</span> <span class="n">stac925x_capsws</span><span class="p">;</span>

	<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_parse_auto_config</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">err</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_WARNING</span> <span class="s">&quot;hda_codec: No auto-config is &quot;</span>
			       <span class="s">&quot;available, default to model=ref</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">=</span> <span class="n">STAC_925x_REF</span><span class="p">;</span>
			<span class="k">goto</span> <span class="n">again</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">err</span> <span class="o">=</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">stac92xx_free</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">patch_ops</span> <span class="o">=</span> <span class="n">stac92xx_patch_ops</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">patch_stac92hd73xx</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span><span class="p">;</span>
	<span class="n">hda_nid_t</span> <span class="n">conn</span><span class="p">[</span><span class="n">STAC92HD73_DAC_COUNT</span> <span class="o">+</span> <span class="mi">2</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">err</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">num_dacs</span><span class="p">;</span>

	<span class="n">spec</span>  <span class="o">=</span> <span class="n">kzalloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">spec</span><span class="p">),</span> <span class="n">GFP_KERNEL</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>

	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">no_trigger_sense</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span> <span class="o">=</span> <span class="n">spec</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">linear_tone_beep</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">slave_dig_outs</span> <span class="o">=</span> <span class="n">stac92hd73xx_slave_dig_outs</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pins</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac92hd73xx_pin_nids</span><span class="p">);</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">pin_nids</span> <span class="o">=</span> <span class="n">stac92hd73xx_pin_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">=</span> <span class="n">snd_hda_check_board_config</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
							<span class="n">STAC_92HD73XX_MODELS</span><span class="p">,</span>
							<span class="n">stac92hd73xx_models</span><span class="p">,</span>
							<span class="n">stac92hd73xx_cfg_tbl</span><span class="p">);</span>
	<span class="cm">/* check codec subsystem id if not found */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">=</span>
			<span class="n">snd_hda_check_board_codec_sid_config</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
				<span class="n">STAC_92HD73XX_MODELS</span><span class="p">,</span> <span class="n">stac92hd73xx_models</span><span class="p">,</span>
				<span class="n">stac92hd73xx_codec_id_cfg_tbl</span><span class="p">);</span>
<span class="nl">again:</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">snd_printdd</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;hda_codec: %s: BIOS auto-probing.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
			    <span class="n">codec</span><span class="o">-&gt;</span><span class="n">chip_name</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="n">stac92xx_set_config_regs</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
				<span class="n">stac92hd73xx_brd_tbl</span><span class="p">[</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span><span class="p">]);</span>

	<span class="n">num_dacs</span> <span class="o">=</span> <span class="n">snd_hda_get_connections</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0x0a</span><span class="p">,</span>
			<span class="n">conn</span><span class="p">,</span> <span class="n">STAC92HD73_DAC_COUNT</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">num_dacs</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="o">||</span> <span class="n">num_dacs</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_WARNING</span> <span class="s">&quot;hda_codec: Could not determine &quot;</span>
		       <span class="s">&quot;number of channels defaulting to DAC count</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="n">num_dacs</span> <span class="o">=</span> <span class="n">STAC92HD73_DAC_COUNT</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">init</span> <span class="o">=</span> <span class="n">stac92hd73xx_core_init</span><span class="p">;</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">num_dacs</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="mh">0x3</span>: <span class="cm">/* 6 Channel */</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">aloopback_ctl</span> <span class="o">=</span> <span class="n">stac92hd73xx_6ch_loopback</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mh">0x4</span>: <span class="cm">/* 8 Channel */</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">aloopback_ctl</span> <span class="o">=</span> <span class="n">stac92hd73xx_8ch_loopback</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mh">0x5</span>: <span class="cm">/* 10 Channel */</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">aloopback_ctl</span> <span class="o">=</span> <span class="n">stac92hd73xx_10ch_loopback</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dac_nids</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dac_nids</span><span class="p">;</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">aloopback_mask</span> <span class="o">=</span> <span class="mh">0x01</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">aloopback_shift</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">digbeep_nid</span> <span class="o">=</span> <span class="mh">0x1c</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">mux_nids</span> <span class="o">=</span> <span class="n">stac92hd73xx_mux_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">adc_nids</span> <span class="o">=</span> <span class="n">stac92hd73xx_adc_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmic_nids</span> <span class="o">=</span> <span class="n">stac92hd73xx_dmic_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmux_nids</span> <span class="o">=</span> <span class="n">stac92hd73xx_dmux_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">smux_nids</span> <span class="o">=</span> <span class="n">stac92hd73xx_smux_nids</span><span class="p">;</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_muxes</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac92hd73xx_mux_nids</span><span class="p">);</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_adcs</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac92hd73xx_adc_nids</span><span class="p">);</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmuxes</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac92hd73xx_dmux_nids</span><span class="p">);</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_caps</span> <span class="o">=</span> <span class="n">STAC92HD73XX_NUM_CAPS</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">capvols</span> <span class="o">=</span> <span class="n">stac92hd73xx_capvols</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">capsws</span> <span class="o">=</span> <span class="n">stac92hd73xx_capsws</span><span class="p">;</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">STAC_DELL_EQ</span>:
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">init</span> <span class="o">=</span> <span class="n">dell_eq_core_init</span><span class="p">;</span>
		<span class="cm">/* fallthru */</span>
	<span class="k">case</span> <span class="n">STAC_DELL_M6_AMIC</span>:
	<span class="k">case</span> <span class="n">STAC_DELL_M6_DMIC</span>:
	<span class="k">case</span> <span class="n">STAC_DELL_M6_BOTH</span>:
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_smuxes</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">eapd_switch</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

		<span class="k">switch</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="n">STAC_DELL_M6_AMIC</span>: <span class="cm">/* Analog Mics */</span>
			<span class="n">snd_hda_codec_set_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0x0b</span><span class="p">,</span> <span class="mh">0x90A70170</span><span class="p">);</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmics</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">STAC_DELL_M6_DMIC</span>: <span class="cm">/* Digital Mics */</span>
			<span class="n">snd_hda_codec_set_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span> <span class="mh">0x90A60160</span><span class="p">);</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmics</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">STAC_DELL_M6_BOTH</span>: <span class="cm">/* Both */</span>
			<span class="n">snd_hda_codec_set_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0x0b</span><span class="p">,</span> <span class="mh">0x90A70170</span><span class="p">);</span>
			<span class="n">snd_hda_codec_set_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span> <span class="mh">0x90A60160</span><span class="p">);</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmics</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">STAC_ALIENWARE_M17X</span>:
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmics</span> <span class="o">=</span> <span class="n">STAC92HD73XX_NUM_DMICS</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_smuxes</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac92hd73xx_smux_nids</span><span class="p">);</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">eapd_switch</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmics</span> <span class="o">=</span> <span class="n">STAC92HD73XX_NUM_DMICS</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_smuxes</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac92hd73xx_smux_nids</span><span class="p">);</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">eapd_switch</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">!=</span> <span class="n">STAC_92HD73XX_REF</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* GPIO0 High = Enable EAPD */</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">eapd_mask</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mask</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_dir</span> <span class="o">=</span> <span class="mh">0x1</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_data</span> <span class="o">=</span> <span class="mh">0x01</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pwrs</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac92hd73xx_pwr_nids</span><span class="p">);</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">pwr_nids</span> <span class="o">=</span> <span class="n">stac92hd73xx_pwr_nids</span><span class="p">;</span>

	<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_parse_auto_config</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">err</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_WARNING</span> <span class="s">&quot;hda_codec: No auto-config is &quot;</span>
			       <span class="s">&quot;available, default to model=ref</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">=</span> <span class="n">STAC_92HD73XX_REF</span><span class="p">;</span>
			<span class="k">goto</span> <span class="n">again</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">err</span> <span class="o">=</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">stac92xx_free</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">==</span> <span class="n">STAC_92HD73XX_NO_JD</span><span class="p">)</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">hp_detect</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">patch_ops</span> <span class="o">=</span> <span class="n">stac92xx_patch_ops</span><span class="p">;</span>

	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">proc_widget_hook</span> <span class="o">=</span> <span class="n">stac92hd7x_proc_hook</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">hp_bnb2011_with_dock</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">vendor_id</span> <span class="o">!=</span> <span class="mh">0x111d7605</span> <span class="o">&amp;&amp;</span>
	    <span class="n">codec</span><span class="o">-&gt;</span><span class="n">vendor_id</span> <span class="o">!=</span> <span class="mh">0x111d76d1</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">subsystem_id</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="mh">0x103c1618</span>:
	<span class="k">case</span> <span class="mh">0x103c1619</span>:
	<span class="k">case</span> <span class="mh">0x103c161a</span>:
	<span class="k">case</span> <span class="mh">0x103c161b</span>:
	<span class="k">case</span> <span class="mh">0x103c161c</span>:
	<span class="k">case</span> <span class="mh">0x103c161d</span>:
	<span class="k">case</span> <span class="mh">0x103c161e</span>:
	<span class="k">case</span> <span class="mh">0x103c161f</span>:

	<span class="k">case</span> <span class="mh">0x103c162a</span>:
	<span class="k">case</span> <span class="mh">0x103c162b</span>:

	<span class="k">case</span> <span class="mh">0x103c1630</span>:
	<span class="k">case</span> <span class="mh">0x103c1631</span>:

	<span class="k">case</span> <span class="mh">0x103c1633</span>:
	<span class="k">case</span> <span class="mh">0x103c1634</span>:
	<span class="k">case</span> <span class="mh">0x103c1635</span>:

	<span class="k">case</span> <span class="mh">0x103c3587</span>:
	<span class="k">case</span> <span class="mh">0x103c3588</span>:
	<span class="k">case</span> <span class="mh">0x103c3589</span>:
	<span class="k">case</span> <span class="mh">0x103c358a</span>:

	<span class="k">case</span> <span class="mh">0x103c3667</span>:
	<span class="k">case</span> <span class="mh">0x103c3668</span>:
	<span class="k">case</span> <span class="mh">0x103c3669</span>:

		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac92hd8x_add_pin</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">def_conf</span> <span class="o">=</span> <span class="n">snd_hda_codec_get_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_pin_nids</span><span class="p">[</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_pin_cnt</span><span class="p">]</span> <span class="o">=</span> <span class="n">nid</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_pin_cnt</span><span class="o">++</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">get_defcfg_device</span><span class="p">(</span><span class="n">def_conf</span><span class="p">)</span> <span class="o">==</span> <span class="n">AC_JACK_MIC_IN</span> <span class="o">&amp;&amp;</span>
	    <span class="n">get_defcfg_connect</span><span class="p">(</span><span class="n">def_conf</span><span class="p">)</span> <span class="o">!=</span> <span class="n">AC_JACK_PORT_NONE</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac92hd83xxx_dmic_nids</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">nid</span> <span class="o">==</span> <span class="n">stac92hd83xxx_dmic_nids</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="p">{</span>
				<span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_dmic_nids</span><span class="p">[</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_dmic_cnt</span><span class="p">]</span> <span class="o">=</span> <span class="n">nid</span><span class="p">;</span>
				<span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_dmic_cnt</span><span class="o">++</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac92hd8x_add_adc</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_adc_nids</span><span class="p">[</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_adc_cnt</span><span class="p">]</span> <span class="o">=</span> <span class="n">nid</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_adc_cnt</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac92hd8x_add_mux</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span> <span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_adc_cnt</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">get_connection_index</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
				<span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_adc_nids</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">nid</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="cm">/* mux and volume for adc_nids[i] */</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_mux_nids</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="p">{</span>
				<span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_mux_nids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">nid</span><span class="p">;</span>
				<span class="cm">/* 92hd codecs capture volume is in mux */</span>
				<span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_capvols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">HDA_COMPOSE_AMP_VAL</span><span class="p">(</span><span class="n">nid</span><span class="p">,</span>
							<span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_dmic_cnt</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">get_connection_index</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span>
						<span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_dmic_nids</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
					<span class="cm">/* dmux for adc_nids[i] */</span>
					<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_dmux_nids</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
						<span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_dmux_nids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">nid</span><span class="p">;</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">stac92hd8x_fill_auto_spec</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">hda_nid_t</span> <span class="n">nid</span><span class="p">,</span> <span class="n">end_nid</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">wid_caps</span><span class="p">,</span> <span class="n">wid_type</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>

	<span class="n">end_nid</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">start_nid</span> <span class="o">+</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">num_nodes</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">nid</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">start_nid</span><span class="p">;</span> <span class="n">nid</span> <span class="o">&lt;</span> <span class="n">end_nid</span><span class="p">;</span> <span class="n">nid</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">wid_caps</span> <span class="o">=</span> <span class="n">get_wcaps</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
		<span class="n">wid_type</span> <span class="o">=</span> <span class="n">get_wcaps_type</span><span class="p">(</span><span class="n">wid_caps</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">wid_type</span> <span class="o">==</span> <span class="n">AC_WID_PIN</span><span class="p">)</span>
			<span class="n">stac92hd8x_add_pin</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">wid_type</span> <span class="o">==</span> <span class="n">AC_WID_AUD_IN</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="n">wid_caps</span> <span class="o">&amp;</span> <span class="n">AC_WCAP_DIGITAL</span><span class="p">))</span>
			<span class="n">stac92hd8x_add_adc</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">nid</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">start_nid</span><span class="p">;</span> <span class="n">nid</span> <span class="o">&lt;</span> <span class="n">end_nid</span><span class="p">;</span> <span class="n">nid</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">wid_caps</span> <span class="o">=</span> <span class="n">get_wcaps</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
		<span class="n">wid_type</span> <span class="o">=</span> <span class="n">get_wcaps_type</span><span class="p">(</span><span class="n">wid_caps</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">wid_type</span> <span class="o">==</span> <span class="n">AC_WID_AUD_SEL</span><span class="p">)</span>
			<span class="n">stac92hd8x_add_mux</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">nid</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">pin_nids</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_pin_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pins</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_pin_cnt</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">adc_nids</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_adc_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_adcs</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_adc_cnt</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">capvols</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_capvols</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">capsws</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_capvols</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_caps</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_adc_cnt</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">mux_nids</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_mux_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_muxes</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_adc_cnt</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmux_nids</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_dmux_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmuxes</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_adc_cnt</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmic_nids</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_dmic_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmics</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">auto_dmic_cnt</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">patch_stac92hd83xxx</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">err</span><span class="p">;</span>

	<span class="n">spec</span>  <span class="o">=</span> <span class="n">kzalloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">spec</span><span class="p">),</span> <span class="n">GFP_KERNEL</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">hp_bnb2011_with_dock</span><span class="p">(</span><span class="n">codec</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">snd_hda_codec_set_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0xa</span><span class="p">,</span> <span class="mh">0x2101201f</span><span class="p">);</span>
		<span class="n">snd_hda_codec_set_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0xf</span><span class="p">,</span> <span class="mh">0x2181205e</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">no_trigger_sense</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span> <span class="o">=</span> <span class="n">spec</span><span class="p">;</span>

	<span class="n">stac92hd8x_fill_auto_spec</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">linear_tone_beep</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">slave_dig_outs</span> <span class="o">=</span> <span class="n">stac92hd83xxx_slave_dig_outs</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">digbeep_nid</span> <span class="o">=</span> <span class="mh">0x21</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">pwr_nids</span> <span class="o">=</span> <span class="n">stac92hd83xxx_pwr_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pwrs</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac92hd83xxx_pwr_nids</span><span class="p">);</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dac_nids</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dac_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">init</span> <span class="o">=</span> <span class="n">stac92hd83xxx_core_init</span><span class="p">;</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">=</span> <span class="n">snd_hda_check_board_config</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
							<span class="n">STAC_92HD83XXX_MODELS</span><span class="p">,</span>
							<span class="n">stac92hd83xxx_models</span><span class="p">,</span>
							<span class="n">stac92hd83xxx_cfg_tbl</span><span class="p">);</span>
	<span class="cm">/* check codec subsystem id if not found */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">=</span>
			<span class="n">snd_hda_check_board_codec_sid_config</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
				<span class="n">STAC_92HD83XXX_MODELS</span><span class="p">,</span> <span class="n">stac92hd83xxx_models</span><span class="p">,</span>
				<span class="n">stac92hd83xxx_codec_id_cfg_tbl</span><span class="p">);</span>
<span class="nl">again:</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">snd_printdd</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;hda_codec: %s: BIOS auto-probing.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
			    <span class="n">codec</span><span class="o">-&gt;</span><span class="n">chip_name</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="n">stac92xx_set_config_regs</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
				<span class="n">stac92hd83xxx_brd_tbl</span><span class="p">[</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span><span class="p">]);</span>

	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">patch_ops</span> <span class="o">=</span> <span class="n">stac92xx_patch_ops</span><span class="p">;</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">STAC_HP_ZEPHYR</span>:
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">init</span> <span class="o">=</span> <span class="n">stac92hd83xxx_hp_zephyr_init</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">find_mute_led_cfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="cm">/*no default cfg*/</span><span class="p">))</span>
		<span class="n">snd_printd</span><span class="p">(</span><span class="s">&quot;mute LED gpio %d polarity %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
				<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led</span><span class="p">,</span>
				<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led_polarity</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">vref_mute_led_nid</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mask</span> <span class="o">|=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led</span><span class="p">;</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_dir</span> <span class="o">|=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led</span><span class="p">;</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_data</span> <span class="o">|=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">codec</span><span class="o">-&gt;</span><span class="n">patch_ops</span><span class="p">.</span><span class="n">set_power_state</span> <span class="o">=</span>
					<span class="n">stac92xx_set_power_state</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_parse_auto_config</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">err</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_WARNING</span> <span class="s">&quot;hda_codec: No auto-config is &quot;</span>
			       <span class="s">&quot;available, default to model=ref</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">=</span> <span class="n">STAC_92HD83XXX_REF</span><span class="p">;</span>
			<span class="k">goto</span> <span class="n">again</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">err</span> <span class="o">=</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">stac92xx_free</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">proc_widget_hook</span> <span class="o">=</span> <span class="n">stac92hd_proc_hook</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac92hd71bxx_connected_smuxes</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">,</span>
					  <span class="n">hda_nid_t</span> <span class="n">dig0pin</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">idx</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pins</span><span class="p">;</span> <span class="n">idx</span><span class="o">++</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">pin_nids</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">==</span> <span class="n">dig0pin</span><span class="p">)</span>
			<span class="k">break</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pins</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="cm">/* dig1pin case */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">stac_get_defcfg_connect</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="n">AC_JACK_PORT_NONE</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">2</span><span class="p">;</span>

	<span class="cm">/* dig0pin + dig2pin case */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">stac_get_defcfg_connect</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">!=</span> <span class="n">AC_JACK_PORT_NONE</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">2</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">stac_get_defcfg_connect</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span> <span class="o">!=</span> <span class="n">AC_JACK_PORT_NONE</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* HP dv7 bass switch - GPIO5 */</span>
<span class="cp">#define stac_hp_bass_gpio_info	snd_ctl_boolean_mono_info</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac_hp_bass_gpio_get</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
				 <span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">integer</span><span class="p">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">!!</span><span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_data</span> <span class="o">&amp;</span> <span class="mh">0x20</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac_hp_bass_gpio_put</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
				 <span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span> <span class="o">=</span> <span class="n">snd_kcontrol_chip</span><span class="p">(</span><span class="n">kcontrol</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">gpio_data</span><span class="p">;</span>

	<span class="n">gpio_data</span> <span class="o">=</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_data</span> <span class="o">&amp;</span> <span class="o">~</span><span class="mh">0x20</span><span class="p">)</span> <span class="o">|</span>
		<span class="p">(</span><span class="n">ucontrol</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">.</span><span class="n">integer</span><span class="p">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">?</span> <span class="mh">0x20</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">gpio_data</span> <span class="o">==</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_data</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_data</span> <span class="o">=</span> <span class="n">gpio_data</span><span class="p">;</span>
	<span class="n">stac_gpio_set</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mask</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_dir</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_data</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="n">stac_hp_bass_sw_ctrl</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">iface</span> <span class="o">=</span> <span class="n">SNDRV_CTL_ELEM_IFACE_MIXER</span><span class="p">,</span>
	<span class="p">.</span><span class="n">info</span> <span class="o">=</span> <span class="n">stac_hp_bass_gpio_info</span><span class="p">,</span>
	<span class="p">.</span><span class="n">get</span> <span class="o">=</span> <span class="n">stac_hp_bass_gpio_get</span><span class="p">,</span>
	<span class="p">.</span><span class="n">put</span> <span class="o">=</span> <span class="n">stac_hp_bass_gpio_put</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">stac_add_hp_bass_switch</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span> <span class="o">=</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">stac_control_new</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">stac_hp_bass_sw_ctrl</span><span class="p">,</span>
			      <span class="s">&quot;Bass Speaker Playback Switch&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mask</span> <span class="o">|=</span> <span class="mh">0x20</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_dir</span> <span class="o">|=</span> <span class="mh">0x20</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_data</span> <span class="o">|=</span> <span class="mh">0x20</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">patch_stac92hd71bxx</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span><span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">hda_verb</span> <span class="o">*</span><span class="n">unmute_init</span> <span class="o">=</span> <span class="n">stac92hd71bxx_unmute_core_init</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">pin_cfg</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">err</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">spec</span>  <span class="o">=</span> <span class="n">kzalloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">spec</span><span class="p">),</span> <span class="n">GFP_KERNEL</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>

	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">no_trigger_sense</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span> <span class="o">=</span> <span class="n">spec</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">linear_tone_beep</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">patch_ops</span> <span class="o">=</span> <span class="n">stac92xx_patch_ops</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pins</span> <span class="o">=</span> <span class="n">STAC92HD71BXX_NUM_PINS</span><span class="p">;</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">vendor_id</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="mh">0x111d76b6</span>:
	<span class="k">case</span> <span class="mh">0x111d76b7</span>:
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">pin_nids</span> <span class="o">=</span> <span class="n">stac92hd71bxx_pin_nids_4port</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mh">0x111d7603</span>:
	<span class="k">case</span> <span class="mh">0x111d7608</span>:
		<span class="cm">/* On 92HD75Bx 0x27 isn&#39;t a pin nid */</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pins</span><span class="o">--</span><span class="p">;</span>
		<span class="cm">/* fallthrough */</span>
	<span class="nl">default:</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">pin_nids</span> <span class="o">=</span> <span class="n">stac92hd71bxx_pin_nids_6port</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pwrs</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac92hd71bxx_pwr_nids</span><span class="p">);</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">=</span> <span class="n">snd_hda_check_board_config</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
							<span class="n">STAC_92HD71BXX_MODELS</span><span class="p">,</span>
							<span class="n">stac92hd71bxx_models</span><span class="p">,</span>
							<span class="n">stac92hd71bxx_cfg_tbl</span><span class="p">);</span>
<span class="nl">again:</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">snd_printdd</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;hda_codec: %s: BIOS auto-probing.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
			    <span class="n">codec</span><span class="o">-&gt;</span><span class="n">chip_name</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="n">stac92xx_set_config_regs</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
				<span class="n">stac92hd71bxx_brd_tbl</span><span class="p">[</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span><span class="p">]);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">!=</span> <span class="n">STAC_92HD71BXX_REF</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* GPIO0 = EAPD */</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mask</span> <span class="o">=</span> <span class="mh">0x01</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_dir</span> <span class="o">=</span> <span class="mh">0x01</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_data</span> <span class="o">=</span> <span class="mh">0x01</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmic_nids</span> <span class="o">=</span> <span class="n">stac92hd71bxx_dmic_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmux_nids</span> <span class="o">=</span> <span class="n">stac92hd71bxx_dmux_nids</span><span class="p">;</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_caps</span> <span class="o">=</span> <span class="n">STAC92HD71BXX_NUM_CAPS</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">capvols</span> <span class="o">=</span> <span class="n">stac92hd71bxx_capvols</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">capsws</span> <span class="o">=</span> <span class="n">stac92hd71bxx_capsws</span><span class="p">;</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">vendor_id</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="mh">0x111d76b6</span>: <span class="cm">/* 4 Port without Analog Mixer */</span>
	<span class="k">case</span> <span class="mh">0x111d76b7</span>:
		<span class="n">unmute_init</span><span class="o">++</span><span class="p">;</span>
		<span class="cm">/* fallthru */</span>
	<span class="k">case</span> <span class="mh">0x111d76b4</span>: <span class="cm">/* 6 Port without Analog Mixer */</span>
	<span class="k">case</span> <span class="mh">0x111d76b5</span>:
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">init</span> <span class="o">=</span> <span class="n">stac92hd71bxx_core_init</span><span class="p">;</span>
		<span class="n">codec</span><span class="o">-&gt;</span><span class="n">slave_dig_outs</span> <span class="o">=</span> <span class="n">stac92hd71bxx_slave_dig_outs</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmics</span> <span class="o">=</span> <span class="n">stac92xx_connected_ports</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
					<span class="n">stac92hd71bxx_dmic_nids</span><span class="p">,</span>
					<span class="n">STAC92HD71BXX_NUM_DMICS</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mh">0x111d7608</span>: <span class="cm">/* 5 Port with Analog Mixer */</span>
		<span class="k">switch</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="n">STAC_HP_M4</span>:
			<span class="cm">/* Enable VREF power saving on GPIO1 detect */</span>
			<span class="n">err</span> <span class="o">=</span> <span class="n">stac_add_event</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">afg</span><span class="p">,</span>
					     <span class="n">STAC_VREF_EVENT</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
				<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
			<span class="n">snd_hda_codec_write_cache</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">afg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
				<span class="n">AC_VERB_SET_GPIO_UNSOLICITED_RSP_MASK</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">);</span>
			<span class="n">snd_hda_jack_detect_enable</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">afg</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mask</span> <span class="o">|=</span> <span class="mh">0x02</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">((</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">revision_id</span> <span class="o">&amp;</span> <span class="mh">0xf</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span>
		    <span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">revision_id</span> <span class="o">&amp;</span> <span class="mh">0xf</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">stream_delay</span> <span class="o">=</span> <span class="mi">40</span><span class="p">;</span> <span class="cm">/* 40 milliseconds */</span>

		<span class="cm">/* disable VSW */</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">init</span> <span class="o">=</span> <span class="n">stac92hd71bxx_core_init</span><span class="p">;</span>
		<span class="n">unmute_init</span><span class="o">++</span><span class="p">;</span>
		<span class="n">snd_hda_codec_set_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x40f000f0</span><span class="p">);</span>
		<span class="n">snd_hda_codec_set_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0x19</span><span class="p">,</span> <span class="mh">0x40f000f3</span><span class="p">);</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmic_nids</span> <span class="o">=</span> <span class="n">stac92hd71bxx_dmic_5port_nids</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmics</span> <span class="o">=</span> <span class="n">stac92xx_connected_ports</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
					<span class="n">stac92hd71bxx_dmic_5port_nids</span><span class="p">,</span>
					<span class="n">STAC92HD71BXX_NUM_DMICS</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mh">0x111d7603</span>: <span class="cm">/* 6 Port with Analog Mixer */</span>
		<span class="k">if</span> <span class="p">((</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">revision_id</span> <span class="o">&amp;</span> <span class="mh">0xf</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">stream_delay</span> <span class="o">=</span> <span class="mi">40</span><span class="p">;</span> <span class="cm">/* 40 milliseconds */</span>

		<span class="cm">/* fallthru */</span>
	<span class="nl">default:</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">init</span> <span class="o">=</span> <span class="n">stac92hd71bxx_core_init</span><span class="p">;</span>
		<span class="n">codec</span><span class="o">-&gt;</span><span class="n">slave_dig_outs</span> <span class="o">=</span> <span class="n">stac92hd71bxx_slave_dig_outs</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmics</span> <span class="o">=</span> <span class="n">stac92xx_connected_ports</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
					<span class="n">stac92hd71bxx_dmic_nids</span><span class="p">,</span>
					<span class="n">STAC92HD71BXX_NUM_DMICS</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">get_wcaps</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0xa</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">AC_WCAP_IN_AMP</span><span class="p">)</span>
		<span class="n">snd_hda_sequence_write_cache</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">unmute_init</span><span class="p">);</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">aloopback_ctl</span> <span class="o">=</span> <span class="n">stac92hd71bxx_loopback</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">aloopback_mask</span> <span class="o">=</span> <span class="mh">0x50</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">aloopback_shift</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">powerdown_adcs</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">digbeep_nid</span> <span class="o">=</span> <span class="mh">0x26</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">mux_nids</span> <span class="o">=</span> <span class="n">stac92hd71bxx_mux_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">adc_nids</span> <span class="o">=</span> <span class="n">stac92hd71bxx_adc_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">smux_nids</span> <span class="o">=</span> <span class="n">stac92hd71bxx_smux_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">pwr_nids</span> <span class="o">=</span> <span class="n">stac92hd71bxx_pwr_nids</span><span class="p">;</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_muxes</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac92hd71bxx_mux_nids</span><span class="p">);</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_adcs</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac92hd71bxx_adc_nids</span><span class="p">);</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmuxes</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac92hd71bxx_dmux_nids</span><span class="p">);</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_smuxes</span> <span class="o">=</span> <span class="n">stac92hd71bxx_connected_smuxes</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0x1e</span><span class="p">);</span>

	<span class="n">snd_printdd</span><span class="p">(</span><span class="s">&quot;Found board config: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span><span class="p">);</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">STAC_HP_M4</span>:
		<span class="cm">/* enable internal microphone */</span>
		<span class="n">snd_hda_codec_set_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span> <span class="mh">0x01813040</span><span class="p">);</span>
		<span class="n">stac92xx_auto_set_pinctl</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span>
			<span class="n">AC_PINCTL_IN_EN</span> <span class="o">|</span> <span class="n">AC_PINCTL_VREF_80</span><span class="p">);</span>
		<span class="cm">/* fallthru */</span>
	<span class="k">case</span> <span class="n">STAC_DELL_M4_2</span>:
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmics</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_smuxes</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmuxes</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">STAC_DELL_M4_1</span>:
	<span class="k">case</span> <span class="n">STAC_DELL_M4_3</span>:
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmics</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_smuxes</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmuxes</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">STAC_HP_DV4_1222NR</span>:
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmics</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="cm">/* I don&#39;t know if it needs 1 or 2 smuxes - will wait for</span>
<span class="cm">		 * bug reports to fix if needed</span>
<span class="cm">		 */</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_smuxes</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmuxes</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="cm">/* fallthrough */</span>
	<span class="k">case</span> <span class="n">STAC_HP_DV4</span>:
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led</span> <span class="o">=</span> <span class="mh">0x01</span><span class="p">;</span>
		<span class="cm">/* fallthrough */</span>
	<span class="k">case</span> <span class="n">STAC_HP_DV5</span>:
		<span class="n">snd_hda_codec_set_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0x90170010</span><span class="p">);</span>
		<span class="n">stac92xx_auto_set_pinctl</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">,</span> <span class="n">AC_PINCTL_OUT_EN</span><span class="p">);</span>
		<span class="cm">/* HP dv6 gives the headphone pin as a line-out.  Thus we</span>
<span class="cm">		 * need to set hp_detect flag here to force to enable HP</span>
<span class="cm">		 * detection.</span>
<span class="cm">		 */</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">hp_detect</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">STAC_HP_HDX</span>:
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmics</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmuxes</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_smuxes</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led</span> <span class="o">=</span> <span class="mh">0x08</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">hp_blike_system</span><span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">subsystem_id</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">pin_cfg</span> <span class="o">=</span> <span class="n">snd_hda_codec_get_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">get_defcfg_device</span><span class="p">(</span><span class="n">pin_cfg</span><span class="p">)</span> <span class="o">==</span> <span class="n">AC_JACK_LINE_OUT</span> <span class="o">||</span>
			<span class="n">get_defcfg_device</span><span class="p">(</span><span class="n">pin_cfg</span><span class="p">)</span> <span class="o">==</span> <span class="n">AC_JACK_SPEAKER</span>  <span class="o">||</span>
			<span class="n">get_defcfg_device</span><span class="p">(</span><span class="n">pin_cfg</span><span class="p">)</span> <span class="o">==</span> <span class="n">AC_JACK_HP_OUT</span><span class="p">)</span> <span class="p">{</span>
			<span class="cm">/* It was changed in the BIOS to just satisfy MS DTM.</span>
<span class="cm">			 * Lets turn it back into slaved HP</span>
<span class="cm">			 */</span>
			<span class="n">pin_cfg</span> <span class="o">=</span> <span class="p">(</span><span class="n">pin_cfg</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">AC_DEFCFG_DEVICE</span><span class="p">))</span>
					<span class="o">|</span> <span class="p">(</span><span class="n">AC_JACK_HP_OUT</span> <span class="o">&lt;&lt;</span>
						<span class="n">AC_DEFCFG_DEVICE_SHIFT</span><span class="p">);</span>
			<span class="n">pin_cfg</span> <span class="o">=</span> <span class="p">(</span><span class="n">pin_cfg</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="p">(</span><span class="n">AC_DEFCFG_DEF_ASSOC</span>
							<span class="o">|</span> <span class="n">AC_DEFCFG_SEQUENCE</span><span class="p">)))</span>
								<span class="o">|</span> <span class="mh">0x1f</span><span class="p">;</span>
			<span class="n">snd_hda_codec_set_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="n">pin_cfg</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">find_mute_led_cfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
		<span class="n">snd_printd</span><span class="p">(</span><span class="s">&quot;mute LED gpio %d polarity %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
				<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led</span><span class="p">,</span>
				<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led_polarity</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">vref_mute_led_nid</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mask</span> <span class="o">|=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led</span><span class="p">;</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_dir</span> <span class="o">|=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led</span><span class="p">;</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_data</span> <span class="o">|=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_led</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">codec</span><span class="o">-&gt;</span><span class="n">patch_ops</span><span class="p">.</span><span class="n">set_power_state</span> <span class="o">=</span>
					<span class="n">stac92xx_set_power_state</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dac_nids</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dac_nids</span><span class="p">;</span>

	<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_parse_auto_config</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">err</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_WARNING</span> <span class="s">&quot;hda_codec: No auto-config is &quot;</span>
			       <span class="s">&quot;available, default to model=ref</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">=</span> <span class="n">STAC_92HD71BXX_REF</span><span class="p">;</span>
			<span class="k">goto</span> <span class="n">again</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">err</span> <span class="o">=</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">stac92xx_free</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="cm">/* enable bass on HP dv7 */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">==</span> <span class="n">STAC_HP_DV4</span> <span class="o">||</span>
	    <span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">==</span> <span class="n">STAC_HP_DV5</span><span class="p">)</span> <span class="p">{</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cap</span><span class="p">;</span>
		<span class="n">cap</span> <span class="o">=</span> <span class="n">snd_hda_param_read</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0x1</span><span class="p">,</span> <span class="n">AC_PAR_GPIO_CAP</span><span class="p">);</span>
		<span class="n">cap</span> <span class="o">&amp;=</span> <span class="n">AC_GPIO_IO_COUNT</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">cap</span> <span class="o">&gt;=</span> <span class="mi">6</span><span class="p">)</span>
			<span class="n">stac_add_hp_bass_switch</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">proc_widget_hook</span> <span class="o">=</span> <span class="n">stac92hd7x_proc_hook</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">patch_stac922x</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">err</span><span class="p">;</span>

	<span class="n">spec</span>  <span class="o">=</span> <span class="n">kzalloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">spec</span><span class="p">),</span> <span class="n">GFP_KERNEL</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>

	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">no_trigger_sense</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span> <span class="o">=</span> <span class="n">spec</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">linear_tone_beep</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pins</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac922x_pin_nids</span><span class="p">);</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">pin_nids</span> <span class="o">=</span> <span class="n">stac922x_pin_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">=</span> <span class="n">snd_hda_check_board_config</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">STAC_922X_MODELS</span><span class="p">,</span>
							<span class="n">stac922x_models</span><span class="p">,</span>
							<span class="n">stac922x_cfg_tbl</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">==</span> <span class="n">STAC_INTEL_MAC_AUTO</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mask</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_dir</span> <span class="o">=</span> <span class="mh">0x03</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_data</span> <span class="o">=</span> <span class="mh">0x03</span><span class="p">;</span>
		<span class="cm">/* Intel Macs have all same PCI SSID, so we need to check</span>
<span class="cm">		 * codec SSID to distinguish the exact models</span>
<span class="cm">		 */</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;hda_codec: STAC922x, Apple subsys_id=%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">subsystem_id</span><span class="p">);</span>
		<span class="k">switch</span> <span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">subsystem_id</span><span class="p">)</span> <span class="p">{</span>

		<span class="k">case</span> <span class="mh">0x106b0800</span>:
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">=</span> <span class="n">STAC_INTEL_MAC_V1</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mh">0x106b0600</span>:
		<span class="k">case</span> <span class="mh">0x106b0700</span>:
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">=</span> <span class="n">STAC_INTEL_MAC_V2</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mh">0x106b0e00</span>:
		<span class="k">case</span> <span class="mh">0x106b0f00</span>:
		<span class="k">case</span> <span class="mh">0x106b1600</span>:
		<span class="k">case</span> <span class="mh">0x106b1700</span>:
		<span class="k">case</span> <span class="mh">0x106b0200</span>:
		<span class="k">case</span> <span class="mh">0x106b1e00</span>:
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">=</span> <span class="n">STAC_INTEL_MAC_V3</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mh">0x106b1a00</span>:
		<span class="k">case</span> <span class="mh">0x00000100</span>:
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">=</span> <span class="n">STAC_INTEL_MAC_V4</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mh">0x106b0a00</span>:
		<span class="k">case</span> <span class="mh">0x106b2200</span>:
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">=</span> <span class="n">STAC_INTEL_MAC_V5</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="nl">default:</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">=</span> <span class="n">STAC_INTEL_MAC_V3</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>

 <span class="nl">again:</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">snd_printdd</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;hda_codec: %s: BIOS auto-probing.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
			    <span class="n">codec</span><span class="o">-&gt;</span><span class="n">chip_name</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="n">stac92xx_set_config_regs</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
				<span class="n">stac922x_brd_tbl</span><span class="p">[</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span><span class="p">]);</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">adc_nids</span> <span class="o">=</span> <span class="n">stac922x_adc_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">mux_nids</span> <span class="o">=</span> <span class="n">stac922x_mux_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_muxes</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac922x_mux_nids</span><span class="p">);</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_adcs</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac922x_adc_nids</span><span class="p">);</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmics</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pwrs</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">init</span> <span class="o">=</span> <span class="n">stac922x_core_init</span><span class="p">;</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_caps</span> <span class="o">=</span> <span class="n">STAC922X_NUM_CAPS</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">capvols</span> <span class="o">=</span> <span class="n">stac922x_capvols</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">capsws</span> <span class="o">=</span> <span class="n">stac922x_capsws</span><span class="p">;</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dac_nids</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dac_nids</span><span class="p">;</span>
	
	<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_parse_auto_config</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">err</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_WARNING</span> <span class="s">&quot;hda_codec: No auto-config is &quot;</span>
			       <span class="s">&quot;available, default to model=ref</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">=</span> <span class="n">STAC_D945_REF</span><span class="p">;</span>
			<span class="k">goto</span> <span class="n">again</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">err</span> <span class="o">=</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">stac92xx_free</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">patch_ops</span> <span class="o">=</span> <span class="n">stac92xx_patch_ops</span><span class="p">;</span>

	<span class="cm">/* Fix Mux capture level; max to 2 */</span>
	<span class="n">snd_hda_override_amp_caps</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="n">HDA_OUTPUT</span><span class="p">,</span>
				  <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;&lt;</span> <span class="n">AC_AMPCAP_OFFSET_SHIFT</span><span class="p">)</span> <span class="o">|</span>
				  <span class="p">(</span><span class="mi">2</span> <span class="o">&lt;&lt;</span> <span class="n">AC_AMPCAP_NUM_STEPS_SHIFT</span><span class="p">)</span> <span class="o">|</span>
				  <span class="p">(</span><span class="mh">0x27</span> <span class="o">&lt;&lt;</span> <span class="n">AC_AMPCAP_STEP_SIZE_SHIFT</span><span class="p">)</span> <span class="o">|</span>
				  <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;&lt;</span> <span class="n">AC_AMPCAP_MUTE_SHIFT</span><span class="p">));</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">patch_stac927x</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">err</span><span class="p">;</span>

	<span class="n">spec</span>  <span class="o">=</span> <span class="n">kzalloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">spec</span><span class="p">),</span> <span class="n">GFP_KERNEL</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>

	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">no_trigger_sense</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span> <span class="o">=</span> <span class="n">spec</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">linear_tone_beep</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">slave_dig_outs</span> <span class="o">=</span> <span class="n">stac927x_slave_dig_outs</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pins</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac927x_pin_nids</span><span class="p">);</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">pin_nids</span> <span class="o">=</span> <span class="n">stac927x_pin_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">=</span> <span class="n">snd_hda_check_board_config</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">STAC_927X_MODELS</span><span class="p">,</span>
							<span class="n">stac927x_models</span><span class="p">,</span>
							<span class="n">stac927x_cfg_tbl</span><span class="p">);</span>
 <span class="nl">again:</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">snd_printdd</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;hda_codec: %s: BIOS auto-probing.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
			    <span class="n">codec</span><span class="o">-&gt;</span><span class="n">chip_name</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="n">stac92xx_set_config_regs</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
				<span class="n">stac927x_brd_tbl</span><span class="p">[</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span><span class="p">]);</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">digbeep_nid</span> <span class="o">=</span> <span class="mh">0x23</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">adc_nids</span> <span class="o">=</span> <span class="n">stac927x_adc_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_adcs</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac927x_adc_nids</span><span class="p">);</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">mux_nids</span> <span class="o">=</span> <span class="n">stac927x_mux_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_muxes</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac927x_mux_nids</span><span class="p">);</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">smux_nids</span> <span class="o">=</span> <span class="n">stac927x_smux_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_smuxes</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac927x_smux_nids</span><span class="p">);</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">spdif_labels</span> <span class="o">=</span> <span class="n">stac927x_spdif_labels</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">dac_list</span> <span class="o">=</span> <span class="n">stac927x_dac_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dac_nids</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dac_nids</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">!=</span> <span class="n">STAC_D965_REF</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* GPIO0 High = Enable EAPD */</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">eapd_mask</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mask</span> <span class="o">=</span> <span class="mh">0x01</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_dir</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_data</span> <span class="o">=</span> <span class="mh">0x01</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">STAC_D965_3ST</span>:
	<span class="k">case</span> <span class="n">STAC_D965_5ST</span>:
		<span class="cm">/* GPIO0 High = Enable EAPD */</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmics</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">init</span> <span class="o">=</span> <span class="n">d965_core_init</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">STAC_DELL_BIOS</span>:
		<span class="k">switch</span> <span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">subsystem_id</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="mh">0x10280209</span>:
		<span class="k">case</span> <span class="mh">0x1028022e</span>:
			<span class="cm">/* correct the device field to SPDIF out */</span>
			<span class="n">snd_hda_codec_set_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x01442070</span><span class="p">);</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="cm">/* configure the analog microphone on some laptops */</span>
		<span class="n">snd_hda_codec_set_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0x0c</span><span class="p">,</span> <span class="mh">0x90a79130</span><span class="p">);</span>
		<span class="cm">/* correct the front output jack as a hp out */</span>
		<span class="n">snd_hda_codec_set_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x0227011f</span><span class="p">);</span>
		<span class="cm">/* correct the front input jack as a mic */</span>
		<span class="n">snd_hda_codec_set_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span> <span class="mh">0x02a79130</span><span class="p">);</span>
		<span class="cm">/* fallthru */</span>
	<span class="k">case</span> <span class="n">STAC_DELL_3ST</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">codec</span><span class="o">-&gt;</span><span class="n">subsystem_id</span> <span class="o">!=</span> <span class="mh">0x1028022f</span><span class="p">)</span> <span class="p">{</span>
			<span class="cm">/* GPIO2 High = Enable EAPD */</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">eapd_mask</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mask</span> <span class="o">=</span> <span class="mh">0x04</span><span class="p">;</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_dir</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_data</span> <span class="o">=</span> <span class="mh">0x04</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmic_nids</span> <span class="o">=</span> <span class="n">stac927x_dmic_nids</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmics</span> <span class="o">=</span> <span class="n">STAC927X_NUM_DMICS</span><span class="p">;</span>

		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">init</span> <span class="o">=</span> <span class="n">dell_3st_core_init</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmux_nids</span> <span class="o">=</span> <span class="n">stac927x_dmux_nids</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmuxes</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac927x_dmux_nids</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">STAC_927X_VOLKNOB</span>:
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmics</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">init</span> <span class="o">=</span> <span class="n">stac927x_volknob_core_init</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmics</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">init</span> <span class="o">=</span> <span class="n">stac927x_core_init</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_caps</span> <span class="o">=</span> <span class="n">STAC927X_NUM_CAPS</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">capvols</span> <span class="o">=</span> <span class="n">stac927x_capvols</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">capsws</span> <span class="o">=</span> <span class="n">stac927x_capsws</span><span class="p">;</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pwrs</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">aloopback_ctl</span> <span class="o">=</span> <span class="n">stac927x_loopback</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">aloopback_mask</span> <span class="o">=</span> <span class="mh">0x40</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">aloopback_shift</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">eapd_switch</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

	<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_parse_auto_config</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">err</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_WARNING</span> <span class="s">&quot;hda_codec: No auto-config is &quot;</span>
			       <span class="s">&quot;available, default to model=ref</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">=</span> <span class="n">STAC_D965_REF</span><span class="p">;</span>
			<span class="k">goto</span> <span class="n">again</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">err</span> <span class="o">=</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">stac92xx_free</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">patch_ops</span> <span class="o">=</span> <span class="n">stac92xx_patch_ops</span><span class="p">;</span>

	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">proc_widget_hook</span> <span class="o">=</span> <span class="n">stac927x_proc_hook</span><span class="p">;</span>

	<span class="cm">/*</span>
<span class="cm">	 * !!FIXME!!</span>
<span class="cm">	 * The STAC927x seem to require fairly long delays for certain</span>
<span class="cm">	 * command sequences.  With too short delays (even if the answer</span>
<span class="cm">	 * is set to RIRB properly), it results in the silence output</span>
<span class="cm">	 * on some hardwares like Dell.</span>
<span class="cm">	 *</span>
<span class="cm">	 * The below flag enables the longer delay (see get_response</span>
<span class="cm">	 * in hda_intel.c).</span>
<span class="cm">	 */</span>
	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">bus</span><span class="o">-&gt;</span><span class="n">needs_damn_long_delay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

	<span class="cm">/* no jack detecion for ref-no-jd model */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">==</span> <span class="n">STAC_D965_REF_NO_JD</span><span class="p">)</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">hp_detect</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">patch_stac9205</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">err</span><span class="p">;</span>

	<span class="n">spec</span>  <span class="o">=</span> <span class="n">kzalloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">spec</span><span class="p">),</span> <span class="n">GFP_KERNEL</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>

	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">no_trigger_sense</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span> <span class="o">=</span> <span class="n">spec</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">linear_tone_beep</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pins</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac9205_pin_nids</span><span class="p">);</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">pin_nids</span> <span class="o">=</span> <span class="n">stac9205_pin_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">=</span> <span class="n">snd_hda_check_board_config</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">STAC_9205_MODELS</span><span class="p">,</span>
							<span class="n">stac9205_models</span><span class="p">,</span>
							<span class="n">stac9205_cfg_tbl</span><span class="p">);</span>
 <span class="nl">again:</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">snd_printdd</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;hda_codec: %s: BIOS auto-probing.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
			    <span class="n">codec</span><span class="o">-&gt;</span><span class="n">chip_name</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="n">stac92xx_set_config_regs</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
					 <span class="n">stac9205_brd_tbl</span><span class="p">[</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span><span class="p">]);</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">digbeep_nid</span> <span class="o">=</span> <span class="mh">0x23</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">adc_nids</span> <span class="o">=</span> <span class="n">stac9205_adc_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_adcs</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac9205_adc_nids</span><span class="p">);</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">mux_nids</span> <span class="o">=</span> <span class="n">stac9205_mux_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_muxes</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac9205_mux_nids</span><span class="p">);</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">smux_nids</span> <span class="o">=</span> <span class="n">stac9205_smux_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_smuxes</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac9205_smux_nids</span><span class="p">);</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmic_nids</span> <span class="o">=</span> <span class="n">stac9205_dmic_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmics</span> <span class="o">=</span> <span class="n">STAC9205_NUM_DMICS</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">dmux_nids</span> <span class="o">=</span> <span class="n">stac9205_dmux_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_dmuxes</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac9205_dmux_nids</span><span class="p">);</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pwrs</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">init</span> <span class="o">=</span> <span class="n">stac9205_core_init</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">aloopback_ctl</span> <span class="o">=</span> <span class="n">stac9205_loopback</span><span class="p">;</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_caps</span> <span class="o">=</span> <span class="n">STAC9205_NUM_CAPS</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">capvols</span> <span class="o">=</span> <span class="n">stac9205_capvols</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">capsws</span> <span class="o">=</span> <span class="n">stac9205_capsws</span><span class="p">;</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">aloopback_mask</span> <span class="o">=</span> <span class="mh">0x40</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">aloopback_shift</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="cm">/* Turn on/off EAPD per HP plugging */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">!=</span> <span class="n">STAC_9205_EAPD</span><span class="p">)</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">eapd_switch</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dac_nids</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dac_nids</span><span class="p">;</span>
	
	<span class="k">switch</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span><span class="p">){</span>
	<span class="k">case</span> <span class="n">STAC_9205_DELL_M43</span>:
		<span class="cm">/* Enable SPDIF in/out */</span>
		<span class="n">snd_hda_codec_set_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="mh">0x01441030</span><span class="p">);</span>
		<span class="n">snd_hda_codec_set_pincfg</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x1c410030</span><span class="p">);</span>

		<span class="cm">/* Enable unsol response for GPIO4/Dock HP connection */</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">stac_add_event</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">afg</span><span class="p">,</span> <span class="n">STAC_VREF_EVENT</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
		<span class="n">snd_hda_codec_write_cache</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">afg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
			<span class="n">AC_VERB_SET_GPIO_UNSOLICITED_RSP_MASK</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">);</span>
		<span class="n">snd_hda_jack_detect_enable</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">codec</span><span class="o">-&gt;</span><span class="n">afg</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_dir</span> <span class="o">=</span> <span class="mh">0x0b</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">eapd_mask</span> <span class="o">=</span> <span class="mh">0x01</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mask</span> <span class="o">=</span> <span class="mh">0x1b</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mute</span> <span class="o">=</span> <span class="mh">0x10</span><span class="p">;</span>
		<span class="cm">/* GPIO0 High = EAPD, GPIO1 Low = Headphone Mute,</span>
<span class="cm">		 * GPIO3 Low = DRM</span>
<span class="cm">		 */</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_data</span> <span class="o">=</span> <span class="mh">0x01</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">STAC_9205_REF</span>:
		<span class="cm">/* SPDIF-In enabled */</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="cm">/* GPIO0 High = EAPD */</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">eapd_mask</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_mask</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_dir</span> <span class="o">=</span> <span class="mh">0x1</span><span class="p">;</span>
		<span class="n">spec</span><span class="o">-&gt;</span><span class="n">gpio_data</span> <span class="o">=</span> <span class="mh">0x01</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_parse_auto_config</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">err</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_WARNING</span> <span class="s">&quot;hda_codec: No auto-config is &quot;</span>
			       <span class="s">&quot;available, default to model=ref</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
			<span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">=</span> <span class="n">STAC_9205_REF</span><span class="p">;</span>
			<span class="k">goto</span> <span class="n">again</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">err</span> <span class="o">=</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">stac92xx_free</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">patch_ops</span> <span class="o">=</span> <span class="n">stac92xx_patch_ops</span><span class="p">;</span>

	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">proc_widget_hook</span> <span class="o">=</span> <span class="n">stac9205_proc_hook</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * STAC9872 hack</span>
<span class="cm"> */</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hda_verb</span> <span class="n">stac9872_core_init</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span><span class="mh">0x15</span><span class="p">,</span> <span class="n">AC_VERB_SET_CONNECT_SEL</span><span class="p">,</span> <span class="mh">0x1</span><span class="p">},</span> <span class="cm">/* mic-sel: 0a,0d,14,02 */</span>
	<span class="p">{</span><span class="mh">0x15</span><span class="p">,</span> <span class="n">AC_VERB_SET_AMP_GAIN_MUTE</span><span class="p">,</span> <span class="n">AMP_OUT_UNMUTE</span><span class="p">},</span> <span class="cm">/* Mic-in -&gt; 0x9 */</span>
	<span class="p">{}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac9872_pin_nids</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0x0b</span><span class="p">,</span> <span class="mh">0x0c</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span>
	<span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac9872_adc_nids</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x8</span> <span class="cm">/*,0x6*/</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">hda_nid_t</span> <span class="n">stac9872_mux_nids</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x15</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">stac9872_capvols</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">HDA_COMPOSE_AMP_VAL</span><span class="p">(</span><span class="mh">0x09</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HDA_INPUT</span><span class="p">),</span>
<span class="p">};</span>
<span class="cp">#define stac9872_capsws		stac9872_capvols</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">stac9872_vaio_pin_configs</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x03211020</span><span class="p">,</span> <span class="mh">0x411111f0</span><span class="p">,</span> <span class="mh">0x411111f0</span><span class="p">,</span> <span class="mh">0x03a15030</span><span class="p">,</span>
	<span class="mh">0x411111f0</span><span class="p">,</span> <span class="mh">0x90170110</span><span class="p">,</span> <span class="mh">0x411111f0</span><span class="p">,</span> <span class="mh">0x411111f0</span><span class="p">,</span>
	<span class="mh">0x90a7013e</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="k">const</span> <span class="n">stac9872_models</span><span class="p">[</span><span class="n">STAC_9872_MODELS</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">[</span><span class="n">STAC_9872_AUTO</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;auto&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">STAC_9872_VAIO</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;vaio&quot;</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">stac9872_brd_tbl</span><span class="p">[</span><span class="n">STAC_9872_MODELS</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">[</span><span class="n">STAC_9872_VAIO</span><span class="p">]</span> <span class="o">=</span> <span class="n">stac9872_vaio_pin_configs</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">snd_pci_quirk</span> <span class="n">stac9872_cfg_tbl</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">SND_PCI_QUIRK_MASK</span><span class="p">(</span><span class="mh">0x104d</span><span class="p">,</span> <span class="mh">0xfff0</span><span class="p">,</span> <span class="mh">0x81e0</span><span class="p">,</span>
			   <span class="s">&quot;Sony VAIO F/S&quot;</span><span class="p">,</span> <span class="n">STAC_9872_VAIO</span><span class="p">),</span>
	<span class="p">{}</span> <span class="cm">/* terminator */</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">patch_stac9872</span><span class="p">(</span><span class="k">struct</span> <span class="n">hda_codec</span> <span class="o">*</span><span class="n">codec</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">sigmatel_spec</span> <span class="o">*</span><span class="n">spec</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">err</span><span class="p">;</span>

	<span class="n">spec</span>  <span class="o">=</span> <span class="n">kzalloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">spec</span><span class="p">),</span> <span class="n">GFP_KERNEL</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>
	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">no_trigger_sense</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">spec</span> <span class="o">=</span> <span class="n">spec</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">linear_tone_beep</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_pins</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac9872_pin_nids</span><span class="p">);</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">pin_nids</span> <span class="o">=</span> <span class="n">stac9872_pin_nids</span><span class="p">;</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">=</span> <span class="n">snd_hda_check_board_config</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span> <span class="n">STAC_9872_MODELS</span><span class="p">,</span>
							<span class="n">stac9872_models</span><span class="p">,</span>
							<span class="n">stac9872_cfg_tbl</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">snd_printdd</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;hda_codec: %s: BIOS auto-probing.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
			    <span class="n">codec</span><span class="o">-&gt;</span><span class="n">chip_name</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="n">stac92xx_set_config_regs</span><span class="p">(</span><span class="n">codec</span><span class="p">,</span>
					 <span class="n">stac9872_brd_tbl</span><span class="p">[</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">board_config</span><span class="p">]);</span>

	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">multiout</span><span class="p">.</span><span class="n">dac_nids</span> <span class="o">=</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">dac_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_adcs</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac9872_adc_nids</span><span class="p">);</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">adc_nids</span> <span class="o">=</span> <span class="n">stac9872_adc_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_muxes</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">stac9872_mux_nids</span><span class="p">);</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">mux_nids</span> <span class="o">=</span> <span class="n">stac9872_mux_nids</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">init</span> <span class="o">=</span> <span class="n">stac9872_core_init</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">num_caps</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">capvols</span> <span class="o">=</span> <span class="n">stac9872_capvols</span><span class="p">;</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">capsws</span> <span class="o">=</span> <span class="n">stac9872_capsws</span><span class="p">;</span>

	<span class="n">err</span> <span class="o">=</span> <span class="n">stac92xx_parse_auto_config</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">stac92xx_free</span><span class="p">(</span><span class="n">codec</span><span class="p">);</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">spec</span><span class="o">-&gt;</span><span class="n">input_mux</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">private_imux</span><span class="p">;</span>
	<span class="n">codec</span><span class="o">-&gt;</span><span class="n">patch_ops</span> <span class="o">=</span> <span class="n">stac92xx_patch_ops</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>


<span class="cm">/*</span>
<span class="cm"> * patch entries</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">hda_codec_preset</span> <span class="n">snd_hda_preset_sigmatel</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847690</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9200&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac9200</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847882</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9220 A1&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac922x</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847680</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9221 A1&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac922x</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847880</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9220 A2&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac922x</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847681</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9220D/9223D A2&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac922x</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847682</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9221 A2&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac922x</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847683</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9221D A2&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac922x</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847618</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9227&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac927x</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847619</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9227&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac927x</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847616</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9228&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac927x</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847617</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9228&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac927x</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847614</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9229&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac927x</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847615</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9229&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac927x</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847620</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9274&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac927x</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847621</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9274D&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac927x</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847622</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9273X&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac927x</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847623</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9273D&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac927x</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847624</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9272X&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac927x</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847625</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9272D&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac927x</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847626</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9271X&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac927x</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847627</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9271D&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac927x</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847628</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9274X5NH&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac927x</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847629</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9274D5NH&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac927x</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847632</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9202&quot;</span><span class="p">,</span>  <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac925x</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847633</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9202D&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac925x</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847634</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9250&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac925x</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847635</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9250D&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac925x</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847636</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9251&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac925x</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847637</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9250D&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac925x</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847645</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD206X&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac927x</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847646</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD206D&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac927x</span> <span class="p">},</span>
 	<span class="cm">/* The following does not take into account .id=0x83847661 when subsys =</span>
<span class="cm"> 	 * 104D0C00 which is STAC9225s. Because of this, some SZ Notebooks are</span>
<span class="cm"> 	 * currently not fully supported.</span>
<span class="cm"> 	 */</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847661</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;CXD9872RD/K&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac9872</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847662</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9872AK&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac9872</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847664</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;CXD9872AKD&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac9872</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x83847698</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9205&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac9205</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x838476a0</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9205&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac9205</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x838476a1</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9205D&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac9205</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x838476a2</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9204&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac9205</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x838476a3</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9204D&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac9205</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x838476a4</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9255&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac9205</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x838476a5</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9255D&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac9205</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x838476a6</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9254&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac9205</span> <span class="p">},</span>
 	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x838476a7</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;STAC9254D&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac9205</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d7603</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD75B3X5&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd71bxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d7604</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD83C1X5&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd83xxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76d4</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD83C1C5&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd83xxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d7605</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD81B1X5&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd83xxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76d5</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD81B1C5&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd83xxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76d1</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD87B1/3&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd83xxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76d9</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD87B2/4&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd83xxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d7666</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD88B3&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd83xxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d7667</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD88B1&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd83xxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d7668</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD88B2&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd83xxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d7669</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD88B4&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd83xxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d7608</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD75B2X5&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd71bxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d7674</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD73D1X5&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd73xx</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d7675</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD73C1X5&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd73xx</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d7676</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD73E1X5&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd73xx</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76b0</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD71B8X&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd71bxx</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76b1</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD71B8X&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd71bxx</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76b2</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD71B7X&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd71bxx</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76b3</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD71B7X&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd71bxx</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76b4</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD71B6X&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd71bxx</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76b5</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD71B6X&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd71bxx</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76b6</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD71B5X&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd71bxx</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76b7</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD71B5X&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd71bxx</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76c0</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD89C3&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd73xx</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76c1</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD89C2&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd73xx</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76c2</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD89C1&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd73xx</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76c3</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD89B3&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd73xx</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76c4</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD89B2&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd73xx</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76c5</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD89B1&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd73xx</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76c6</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD89E3&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd73xx</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76c7</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD89E2&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd73xx</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76c8</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD89E1&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd73xx</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76c9</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD89D3&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd73xx</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76ca</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD89D2&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd73xx</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76cb</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD89D1&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd73xx</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76cc</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD89F3&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd73xx</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76cd</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD89F2&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd73xx</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76ce</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD89F1&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd73xx</span> <span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76df</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD93BXX&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd83xxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76e0</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD91BXX&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd83xxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76e3</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD98BXX&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd83xxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76e5</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD99BXX&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd83xxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76e7</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD90BXX&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd83xxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76e8</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD66B1X5&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd83xxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76e9</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD66B2X5&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd83xxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76ea</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD66B3X5&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd83xxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76eb</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD66C1X5&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd83xxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76ec</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD66C2X5&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd83xxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76ed</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD66C3X5&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd83xxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76ee</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD66B1X3&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd83xxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76ef</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD66B2X3&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd83xxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76f0</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD66B3X3&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd83xxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76f1</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD66C1X3&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd83xxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76f2</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD66C2X3&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd83xxx</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mh">0x111d76f3</span><span class="p">,</span> <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;92HD66C3/65&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch_stac92hd83xxx</span><span class="p">},</span>
	<span class="p">{}</span> <span class="cm">/* terminator */</span>
<span class="p">};</span>

<span class="n">MODULE_ALIAS</span><span class="p">(</span><span class="s">&quot;snd-hda-codec-id:8384*&quot;</span><span class="p">);</span>
<span class="n">MODULE_ALIAS</span><span class="p">(</span><span class="s">&quot;snd-hda-codec-id:111d*&quot;</span><span class="p">);</span>

<span class="n">MODULE_LICENSE</span><span class="p">(</span><span class="s">&quot;GPL&quot;</span><span class="p">);</span>
<span class="n">MODULE_DESCRIPTION</span><span class="p">(</span><span class="s">&quot;IDT/Sigmatel HD-audio codec&quot;</span><span class="p">);</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">hda_codec_preset_list</span> <span class="n">sigmatel_list</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">preset</span> <span class="o">=</span> <span class="n">snd_hda_preset_sigmatel</span><span class="p">,</span>
	<span class="p">.</span><span class="n">owner</span> <span class="o">=</span> <span class="n">THIS_MODULE</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="n">__init</span> <span class="nf">patch_sigmatel_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">snd_hda_add_codec_preset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sigmatel_list</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="n">__exit</span> <span class="nf">patch_sigmatel_exit</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">snd_hda_delete_codec_preset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sigmatel_list</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">module_init</span><span class="p">(</span><span class="n">patch_sigmatel_init</span><span class="p">)</span>
<span class="n">module_exit</span><span class="p">(</span><span class="n">patch_sigmatel_exit</span><span class="p">)</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
