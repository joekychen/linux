<!DOCTYPE html>
<html><head><title>joekychen/linux » sound › pci › oxygen › oxygen.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>oxygen.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef OXYGEN_H_INCLUDED</span>
<span class="cp">#define OXYGEN_H_INCLUDED</span>

<span class="cp">#include &lt;linux/mutex.h&gt;</span>
<span class="cp">#include &lt;linux/spinlock.h&gt;</span>
<span class="cp">#include &lt;linux/wait.h&gt;</span>
<span class="cp">#include &lt;linux/workqueue.h&gt;</span>
<span class="cp">#include &quot;oxygen_regs.h&quot;</span>

<span class="cm">/* 1 &lt;&lt; PCM_x == OXYGEN_CHANNEL_x */</span>
<span class="cp">#define PCM_A		0</span>
<span class="cp">#define PCM_B		1</span>
<span class="cp">#define PCM_C		2</span>
<span class="cp">#define PCM_SPDIF	3</span>
<span class="cp">#define PCM_MULTICH	4</span>
<span class="cp">#define PCM_AC97	5</span>
<span class="cp">#define PCM_COUNT	6</span>

<span class="cp">#define OXYGEN_MCLKS(f_single, f_double, f_quad) ((MCLK_##f_single &lt;&lt; 0) | \</span>
<span class="cp">						  (MCLK_##f_double &lt;&lt; 2) | \</span>
<span class="cp">						  (MCLK_##f_quad   &lt;&lt; 4))</span>

<span class="cp">#define OXYGEN_IO_SIZE	0x100</span>

<span class="cp">#define OXYGEN_EEPROM_ID	0x434d	</span><span class="cm">/* &quot;CM&quot; */</span><span class="cp"></span>

<span class="cm">/* model-specific configuration of outputs/inputs */</span>
<span class="cp">#define PLAYBACK_0_TO_I2S	0x0001</span>
     <span class="cm">/* PLAYBACK_0_TO_AC97_0		not implemented */</span>
<span class="cp">#define PLAYBACK_1_TO_SPDIF	0x0004</span>
<span class="cp">#define PLAYBACK_2_TO_AC97_1	0x0008</span>
<span class="cp">#define CAPTURE_0_FROM_I2S_1	0x0010</span>
<span class="cp">#define CAPTURE_0_FROM_I2S_2	0x0020</span>
     <span class="cm">/* CAPTURE_0_FROM_AC97_0		not implemented */</span>
<span class="cp">#define CAPTURE_1_FROM_SPDIF	0x0080</span>
<span class="cp">#define CAPTURE_2_FROM_I2S_2	0x0100</span>
<span class="cp">#define CAPTURE_2_FROM_AC97_1	0x0200</span>
     <span class="cm">/* CAPTURE_3_FROM_I2S_3		not implemented */</span>
<span class="cp">#define MIDI_OUTPUT		0x0800</span>
<span class="cp">#define MIDI_INPUT		0x1000</span>
<span class="cp">#define AC97_CD_INPUT		0x2000</span>
<span class="cp">#define AC97_FMIC_SWITCH	0x4000</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">CONTROL_SPDIF_PCM</span><span class="p">,</span>
	<span class="n">CONTROL_SPDIF_INPUT_BITS</span><span class="p">,</span>
	<span class="n">CONTROL_MIC_CAPTURE_SWITCH</span><span class="p">,</span>
	<span class="n">CONTROL_LINE_CAPTURE_SWITCH</span><span class="p">,</span>
	<span class="n">CONTROL_CD_CAPTURE_SWITCH</span><span class="p">,</span>
	<span class="n">CONTROL_AUX_CAPTURE_SWITCH</span><span class="p">,</span>
	<span class="n">CONTROL_COUNT</span>
<span class="p">};</span>

<span class="cp">#define OXYGEN_PCI_SUBID(sv, sd) \</span>
<span class="cp">	.vendor = PCI_VENDOR_ID_CMEDIA, \</span>
<span class="cp">	.device = 0x8788, \</span>
<span class="cp">	.subvendor = sv, \</span>
<span class="cp">	.subdevice = sd</span>

<span class="cp">#define BROKEN_EEPROM_DRIVER_DATA ((unsigned long)-1)</span>
<span class="cp">#define OXYGEN_PCI_SUBID_BROKEN_EEPROM \</span>
<span class="cp">	OXYGEN_PCI_SUBID(PCI_VENDOR_ID_CMEDIA, 0x8788), \</span>
<span class="cp">	.driver_data = BROKEN_EEPROM_DRIVER_DATA</span>

<span class="k">struct</span> <span class="n">pci_dev</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">pci_device_id</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">snd_card</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">snd_pcm_substream</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">snd_pcm_hardware</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">snd_pcm_hw_params</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">snd_kcontrol_new</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">snd_rawmidi</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">snd_info_buffer</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">oxygen</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">oxygen_model</span> <span class="p">{</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">shortname</span><span class="p">;</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">longname</span><span class="p">;</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">chip</span><span class="p">;</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">init</span><span class="p">)(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">control_filter</span><span class="p">)(</span><span class="k">struct</span> <span class="n">snd_kcontrol_new</span> <span class="o">*</span><span class="n">template</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">mixer_init</span><span class="p">)(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">cleanup</span><span class="p">)(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">suspend</span><span class="p">)(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">resume</span><span class="p">)(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">pcm_hardware_filter</span><span class="p">)(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">channel</span><span class="p">,</span>
				    <span class="k">struct</span> <span class="n">snd_pcm_hardware</span> <span class="o">*</span><span class="n">hardware</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">set_dac_params</span><span class="p">)(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">snd_pcm_hw_params</span> <span class="o">*</span><span class="n">params</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">set_adc_params</span><span class="p">)(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">snd_pcm_hw_params</span> <span class="o">*</span><span class="n">params</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">update_dac_volume</span><span class="p">)(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">update_dac_mute</span><span class="p">)(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">update_center_lfe_mix</span><span class="p">)(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="n">bool</span> <span class="n">mixed</span><span class="p">);</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">adjust_dac_routing</span><span class="p">)(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span>
					   <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">play_routing</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">gpio_changed</span><span class="p">)(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">uart_input</span><span class="p">)(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">ac97_switch</span><span class="p">)(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span>
			    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">reg</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mute</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">dump_registers</span><span class="p">)(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">snd_info_buffer</span> <span class="o">*</span><span class="n">buffer</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">dac_tlv</span><span class="p">;</span>
	<span class="kt">size_t</span> <span class="n">model_data_size</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">device_config</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">dac_channels_pcm</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">dac_channels_mixer</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">dac_volume_min</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">dac_volume_max</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">misc_flags</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">function_flags</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">dac_mclks</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">adc_mclks</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">dac_i2s_format</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">adc_i2s_format</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">oxygen</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">addr</span><span class="p">;</span>
	<span class="n">spinlock_t</span> <span class="n">reg_lock</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">mutex</span> <span class="n">mutex</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">snd_card</span> <span class="o">*</span><span class="n">card</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">pci_dev</span> <span class="o">*</span><span class="n">pci</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">snd_rawmidi</span> <span class="o">*</span><span class="n">midi</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">irq</span><span class="p">;</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">model_data</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">interrupt_mask</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">dac_volume</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">dac_mute</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">pcm_active</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">pcm_running</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">dac_routing</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">spdif_playback_enable</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">has_ac97_0</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">has_ac97_1</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">spdif_bits</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">spdif_pcm_bits</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">snd_pcm_substream</span> <span class="o">*</span><span class="n">streams</span><span class="p">[</span><span class="n">PCM_COUNT</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">controls</span><span class="p">[</span><span class="n">CONTROL_COUNT</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">work_struct</span> <span class="n">spdif_input_bits_work</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">work_struct</span> <span class="n">gpio_work</span><span class="p">;</span>
	<span class="n">wait_queue_head_t</span> <span class="n">ac97_waitqueue</span><span class="p">;</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="n">u8</span> <span class="n">_8</span><span class="p">[</span><span class="n">OXYGEN_IO_SIZE</span><span class="p">];</span>
		<span class="n">__le16</span> <span class="n">_16</span><span class="p">[</span><span class="n">OXYGEN_IO_SIZE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">];</span>
		<span class="n">__le32</span> <span class="n">_32</span><span class="p">[</span><span class="n">OXYGEN_IO_SIZE</span> <span class="o">/</span> <span class="mi">4</span><span class="p">];</span>
	<span class="p">}</span> <span class="n">saved_registers</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">saved_ac97_registers</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mh">0x40</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">uart_input_count</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">uart_input</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">oxygen_model</span> <span class="n">model</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* oxygen_lib.c */</span>

<span class="kt">int</span> <span class="n">oxygen_pci_probe</span><span class="p">(</span><span class="k">struct</span> <span class="n">pci_dev</span> <span class="o">*</span><span class="n">pci</span><span class="p">,</span> <span class="kt">int</span> <span class="n">index</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">id</span><span class="p">,</span>
		     <span class="k">struct</span> <span class="n">module</span> <span class="o">*</span><span class="n">owner</span><span class="p">,</span>
		     <span class="k">const</span> <span class="k">struct</span> <span class="n">pci_device_id</span> <span class="o">*</span><span class="n">ids</span><span class="p">,</span>
		     <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">get_model</span><span class="p">)(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span>
				      <span class="k">const</span> <span class="k">struct</span> <span class="n">pci_device_id</span> <span class="o">*</span><span class="n">id</span>
				     <span class="p">)</span>
		    <span class="p">);</span>
<span class="kt">void</span> <span class="n">oxygen_pci_remove</span><span class="p">(</span><span class="k">struct</span> <span class="n">pci_dev</span> <span class="o">*</span><span class="n">pci</span><span class="p">);</span>
<span class="cp">#ifdef CONFIG_PM</span>
<span class="kt">int</span> <span class="n">oxygen_pci_suspend</span><span class="p">(</span><span class="k">struct</span> <span class="n">pci_dev</span> <span class="o">*</span><span class="n">pci</span><span class="p">,</span> <span class="n">pm_message_t</span> <span class="n">state</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">oxygen_pci_resume</span><span class="p">(</span><span class="k">struct</span> <span class="n">pci_dev</span> <span class="o">*</span><span class="n">pci</span><span class="p">);</span>
<span class="cp">#endif</span>
<span class="kt">void</span> <span class="n">oxygen_pci_shutdown</span><span class="p">(</span><span class="k">struct</span> <span class="n">pci_dev</span> <span class="o">*</span><span class="n">pci</span><span class="p">);</span>

<span class="cm">/* oxygen_mixer.c */</span>

<span class="kt">int</span> <span class="n">oxygen_mixer_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">oxygen_update_dac_routing</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">oxygen_update_spdif_source</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>

<span class="cm">/* oxygen_pcm.c */</span>

<span class="kt">int</span> <span class="n">oxygen_pcm_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>

<span class="cm">/* oxygen_io.c */</span>

<span class="n">u8</span> <span class="n">oxygen_read8</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">reg</span><span class="p">);</span>
<span class="n">u16</span> <span class="n">oxygen_read16</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">reg</span><span class="p">);</span>
<span class="n">u32</span> <span class="n">oxygen_read32</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">reg</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">oxygen_write8</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">reg</span><span class="p">,</span> <span class="n">u8</span> <span class="n">value</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">oxygen_write16</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">reg</span><span class="p">,</span> <span class="n">u16</span> <span class="n">value</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">oxygen_write32</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">reg</span><span class="p">,</span> <span class="n">u32</span> <span class="n">value</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">oxygen_write8_masked</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">reg</span><span class="p">,</span>
			  <span class="n">u8</span> <span class="n">value</span><span class="p">,</span> <span class="n">u8</span> <span class="n">mask</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">oxygen_write16_masked</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">reg</span><span class="p">,</span>
			   <span class="n">u16</span> <span class="n">value</span><span class="p">,</span> <span class="n">u16</span> <span class="n">mask</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">oxygen_write32_masked</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">reg</span><span class="p">,</span>
			   <span class="n">u32</span> <span class="n">value</span><span class="p">,</span> <span class="n">u32</span> <span class="n">mask</span><span class="p">);</span>

<span class="n">u16</span> <span class="n">oxygen_read_ac97</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">codec</span><span class="p">,</span>
		     <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">index</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">oxygen_write_ac97</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">codec</span><span class="p">,</span>
		       <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">index</span><span class="p">,</span> <span class="n">u16</span> <span class="n">data</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">oxygen_write_ac97_masked</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">codec</span><span class="p">,</span>
			      <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">index</span><span class="p">,</span> <span class="n">u16</span> <span class="n">data</span><span class="p">,</span> <span class="n">u16</span> <span class="n">mask</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">oxygen_write_spi</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="n">u8</span> <span class="n">control</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">data</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">oxygen_write_i2c</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="n">u8</span> <span class="n">device</span><span class="p">,</span> <span class="n">u8</span> <span class="n">map</span><span class="p">,</span> <span class="n">u8</span> <span class="n">data</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">oxygen_reset_uart</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">oxygen_write_uart</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="n">u8</span> <span class="n">data</span><span class="p">);</span>

<span class="n">u16</span> <span class="n">oxygen_read_eeprom</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">index</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">oxygen_write_eeprom</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">index</span><span class="p">,</span> <span class="n">u16</span> <span class="n">value</span><span class="p">);</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">oxygen_set_bits8</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span>
				    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">reg</span><span class="p">,</span> <span class="n">u8</span> <span class="n">value</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">oxygen_write8_masked</span><span class="p">(</span><span class="n">chip</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">oxygen_set_bits16</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span>
				     <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">reg</span><span class="p">,</span> <span class="n">u16</span> <span class="n">value</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">oxygen_write16_masked</span><span class="p">(</span><span class="n">chip</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">oxygen_set_bits32</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span>
				     <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">reg</span><span class="p">,</span> <span class="n">u32</span> <span class="n">value</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">oxygen_write32_masked</span><span class="p">(</span><span class="n">chip</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">oxygen_clear_bits8</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span>
				      <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">reg</span><span class="p">,</span> <span class="n">u8</span> <span class="n">value</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">oxygen_write8_masked</span><span class="p">(</span><span class="n">chip</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">oxygen_clear_bits16</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span>
				       <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">reg</span><span class="p">,</span> <span class="n">u16</span> <span class="n">value</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">oxygen_write16_masked</span><span class="p">(</span><span class="n">chip</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">oxygen_clear_bits32</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span>
				       <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">reg</span><span class="p">,</span> <span class="n">u32</span> <span class="n">value</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">oxygen_write32_masked</span><span class="p">(</span><span class="n">chip</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">oxygen_ac97_set_bits</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">codec</span><span class="p">,</span>
					<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">index</span><span class="p">,</span> <span class="n">u16</span> <span class="n">value</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">oxygen_write_ac97_masked</span><span class="p">(</span><span class="n">chip</span><span class="p">,</span> <span class="n">codec</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">oxygen_ac97_clear_bits</span><span class="p">(</span><span class="k">struct</span> <span class="n">oxygen</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span>
					  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">codec</span><span class="p">,</span>
					  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">index</span><span class="p">,</span> <span class="n">u16</span> <span class="n">value</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">oxygen_write_ac97_masked</span><span class="p">(</span><span class="n">chip</span><span class="p">,</span> <span class="n">codec</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
<span class="p">}</span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
