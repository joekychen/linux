<!DOCTYPE html>
<html><head><title>joekychen/linux » sound › pci › au88x0 › au8830.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>au8830.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm">    Aureal Vortex Soundcard driver.</span>

<span class="cm">    IO addr collected from asp4core.vxd:</span>
<span class="cm">    function    address</span>
<span class="cm">    0005D5A0    13004</span>
<span class="cm">    00080674    14004</span>
<span class="cm">    00080AFF    12818</span>

<span class="cm"> */</span>

<span class="cp">#define CHIP_AU8830</span>

<span class="cp">#define CARD_NAME &quot;Aureal Vortex 2&quot;</span>
<span class="cp">#define CARD_NAME_SHORT &quot;au8830&quot;</span>

<span class="cp">#define NR_ADB 0x20</span>
<span class="cp">#define NR_SRC 0x10</span>
<span class="cp">#define NR_A3D 0x10</span>
<span class="cp">#define NR_MIXIN 0x20</span>
<span class="cp">#define NR_MIXOUT 0x10</span>
<span class="cp">#define NR_WT 0x40</span>

<span class="cm">/* ADBDMA */</span>
<span class="cp">#define VORTEX_ADBDMA_STAT 0x27e00	</span><span class="cm">/* read only, subbuffer, DMA pos */</span><span class="cp"></span>
<span class="cp">#define		POS_MASK 0x00000fff</span>
<span class="cp">#define     POS_SHIFT 0x0</span>
<span class="cp">#define 	ADB_SUBBUF_MASK 0x00003000	</span><span class="cm">/* ADB only. */</span><span class="cp"></span>
<span class="cp">#define     ADB_SUBBUF_SHIFT 0xc	</span><span class="cm">/* ADB only. */</span><span class="cp"></span>
<span class="cp">#define VORTEX_ADBDMA_CTRL 0x27a00	</span><span class="cm">/* write only; format, flags, DMA pos */</span><span class="cp"></span>
<span class="cp">#define		OFFSET_MASK 0x00000fff</span>
<span class="cp">#define     OFFSET_SHIFT 0x0</span>
<span class="cp">#define		IE_MASK 0x00001000	</span><span class="cm">/* interrupt enable. */</span><span class="cp"></span>
<span class="cp">#define     IE_SHIFT 0xc</span>
<span class="cp">#define     DIR_MASK 0x00002000	</span><span class="cm">/* Direction. */</span><span class="cp"></span>
<span class="cp">#define     DIR_SHIFT 0xd</span>
<span class="cp">#define		FMT_MASK 0x0003c000</span>
<span class="cp">#define		FMT_SHIFT 0xe</span>
<span class="cp">#define		ADB_FIFO_EN_SHIFT	0x15</span>
<span class="cp">#define		ADB_FIFO_EN			(1 &lt;&lt; 0x15)</span></pre></div></td></tr>


<tr id="section-2"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-2">&#182;</a></div><p>The ADB masks and shift also are valid for the wtdma, except if specified otherwise.</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define VORTEX_ADBDMA_BUFCFG0 0x27800</span>
<span class="cp">#define VORTEX_ADBDMA_BUFCFG1 0x27804</span>
<span class="cp">#define VORTEX_ADBDMA_BUFBASE 0x27400</span>
<span class="cp">#define VORTEX_ADBDMA_START 0x27c00	</span><span class="cm">/* Which subbuffer starts */</span><span class="cp"></span>

<span class="cp">#define VORTEX_ADBDMA_STATUS 0x27A90	</span><span class="cm">/* stored at AdbDma-&gt;this_10 / 2 DWORD in size. */</span><span class="cp"></span>
<span class="cm">/* Starting at the MSB, each pair of bits seem to be the current DMA page. */</span>
<span class="cm">/* This current page bits are consistent (same value) with VORTEX_ADBDMA_STAT) */</span>

<span class="cm">/* DMA */</span>
<span class="cp">#define VORTEX_ENGINE_CTRL 0x27ae8</span>
<span class="cp">#define 	ENGINE_INIT 0x1380000</span>

<span class="cm">/* WTDMA */</span>
<span class="cp">#define VORTEX_WTDMA_CTRL 0x27900	</span><span class="cm">/* format, DMA pos */</span><span class="cp"></span>
<span class="cp">#define VORTEX_WTDMA_STAT 0x27d00	</span><span class="cm">/* DMA subbuf, DMA pos */</span><span class="cp"></span>
<span class="cp">#define     WT_SUBBUF_MASK 0x3</span>
<span class="cp">#define     WT_SUBBUF_SHIFT 0xc</span>
<span class="cp">#define VORTEX_WTDMA_BUFBASE 0x27000</span>
<span class="cp">#define VORTEX_WTDMA_BUFCFG0 0x27600</span>
<span class="cp">#define VORTEX_WTDMA_BUFCFG1 0x27604</span>
<span class="cp">#define VORTEX_WTDMA_START 0x27b00	</span><span class="cm">/* which subbuffer is first */</span><span class="cp"></span>

<span class="cm">/* ADB */</span>
<span class="cp">#define VORTEX_ADB_SR 0x28400	</span><span class="cm">/* Samplerates enable/disable */</span><span class="cp"></span>
<span class="cp">#define VORTEX_ADB_RTBASE 0x28000</span>
<span class="cp">#define VORTEX_ADB_RTBASE_COUNT 173</span>
<span class="cp">#define VORTEX_ADB_CHNBASE 0x282b4</span>
<span class="cp">#define VORTEX_ADB_CHNBASE_COUNT 24</span>
<span class="cp">#define 	ROUTE_MASK	0xffff</span>
<span class="cp">#define		SOURCE_MASK	0xff00</span>
<span class="cp">#define     ADB_MASK   0xff</span>
<span class="cp">#define		ADB_SHIFT 0x8</span>
<span class="cm">/* ADB address */</span>
<span class="cp">#define		OFFSET_ADBDMA	0x00</span>
<span class="cp">#define		OFFSET_ADBDMAB	0x20</span>
<span class="cp">#define		OFFSET_SRCIN	0x40</span>
<span class="cp">#define		OFFSET_SRCOUT	0x20	</span><span class="cm">/* ch 0x11 */</span><span class="cp"></span>
<span class="cp">#define		OFFSET_MIXIN	0x50	</span><span class="cm">/* ch 0x11 */</span><span class="cp"></span>
<span class="cp">#define		OFFSET_MIXOUT	0x30	</span><span class="cm">/* ch 0x11 */</span><span class="cp"></span>
<span class="cp">#define		OFFSET_CODECIN	0x70 </span><span class="cm">/* ch 0x11 */</span><span class="cp">	</span><span class="cm">/* adb source */</span><span class="cp"></span>
<span class="cp">#define		OFFSET_CODECOUT	0x88 </span><span class="cm">/* ch 0x11 */</span><span class="cp">	</span><span class="cm">/* adb target */</span><span class="cp"></span>
<span class="cp">#define		OFFSET_SPORTIN	0x78	</span><span class="cm">/* ch 0x13 ADB source. 2 routes. */</span><span class="cp"></span>
<span class="cp">#define		OFFSET_SPORTOUT	0x90	</span><span class="cm">/* ch 0x13 ADB sink. 2 routes. */</span><span class="cp"></span>
<span class="cp">#define		OFFSET_SPDIFIN	0x7A	</span><span class="cm">/* ch 0x14 ADB source. */</span><span class="cp"></span>
<span class="cp">#define		OFFSET_SPDIFOUT	0x92	</span><span class="cm">/* ch 0x14 ADB sink. */</span><span class="cp"></span>
<span class="cp">#define		OFFSET_AC98IN	0x7c	</span><span class="cm">/* ch 0x14 ADB source. */</span><span class="cp"></span>
<span class="cp">#define		OFFSET_AC98OUT	0x94	</span><span class="cm">/* ch 0x14 ADB sink. */</span><span class="cp"></span>
<span class="cp">#define		OFFSET_EQIN		0xa0	</span><span class="cm">/* ch 0x11 */</span><span class="cp"></span>
<span class="cp">#define		OFFSET_EQOUT	0x7e </span><span class="cm">/* ch 0x11 */</span><span class="cp">	</span><span class="cm">/* 2 routes on ch 0x11 */</span><span class="cp"></span>
<span class="cp">#define		OFFSET_A3DIN	0x70	</span><span class="cm">/* ADB sink. */</span><span class="cp"></span>
<span class="cp">#define		OFFSET_A3DOUT	0xA6	</span><span class="cm">/* ADB source. 2 routes per slice = 8 */</span><span class="cp"></span>
<span class="cp">#define		OFFSET_WT0		0x40	</span><span class="cm">/* WT bank 0 output. 0x40 - 0x65 */</span><span class="cp"></span>
<span class="cp">#define		OFFSET_WT1		0x80	</span><span class="cm">/* WT bank 1 output. 0x80 - 0xA5 */</span><span class="cp"></span>
<span class="cm">/* WT sources offset : 0x00-0x1f Direct stream. */</span>
<span class="cm">/* WT sources offset : 0x20-0x25 Mixed Output. */</span>
<span class="cp">#define		OFFSET_XTALKOUT	0x66	</span><span class="cm">/* crosstalk canceller (source) 2 routes */</span><span class="cp"></span>
<span class="cp">#define		OFFSET_XTALKIN	0x96	</span><span class="cm">/* crosstalk canceller (sink). 10 routes */</span><span class="cp"></span>
<span class="cp">#define		OFFSET_EFXOUT	0x68	</span><span class="cm">/* ADB source. 8 routes. */</span><span class="cp"></span>
<span class="cp">#define		OFFSET_EFXIN	0x80	</span><span class="cm">/* ADB sink. 8 routes. */</span><span class="cp"></span>

<span class="cm">/* ADB route translate helper */</span>
<span class="cp">#define ADB_DMA(x) (x)</span>
<span class="cp">#define ADB_SRCOUT(x) (x + OFFSET_SRCOUT)</span>
<span class="cp">#define ADB_SRCIN(x) (x + OFFSET_SRCIN)</span>
<span class="cp">#define ADB_MIXOUT(x) (x + OFFSET_MIXOUT)</span>
<span class="cp">#define ADB_MIXIN(x) (x + OFFSET_MIXIN)</span>
<span class="cp">#define ADB_CODECIN(x) (x + OFFSET_CODECIN)</span>
<span class="cp">#define ADB_CODECOUT(x) (x + OFFSET_CODECOUT)</span>
<span class="cp">#define ADB_SPORTIN(x) (x + OFFSET_SPORTIN)</span>
<span class="cp">#define ADB_SPORTOUT(x) (x + OFFSET_SPORTOUT)</span>
<span class="cp">#define ADB_SPDIFIN(x)	(x + OFFSET_SPDIFIN)</span>
<span class="cp">#define ADB_SPDIFOUT(x)	(x + OFFSET_SPDIFOUT)</span>
<span class="cp">#define ADB_EQIN(x) (x + OFFSET_EQIN)</span>
<span class="cp">#define ADB_EQOUT(x) (x + OFFSET_EQOUT)</span>
<span class="cp">#define ADB_A3DOUT(x) (x + OFFSET_A3DOUT)	</span><span class="cm">/* 0x10 A3D blocks */</span><span class="cp"></span>
<span class="cp">#define ADB_A3DIN(x) (x + OFFSET_A3DIN)</span></pre></div></td></tr>


<tr id="section-3"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-3">&#182;</a></div><h1>define ADB<em>WTOUT(x) ((x<x20)?(x + OFFSET</em>WT0):(x + OFFSET_WT1))</h1></td><td class="code"><div class="highlight"><pre><span class="cp">#define ADB_WTOUT(x,y) (((x)==0)?((y) + OFFSET_WT0):((y) + OFFSET_WT1))</span>
<span class="cp">#define ADB_XTALKIN(x) ((x) + OFFSET_XTALKIN)</span>
<span class="cp">#define ADB_XTALKOUT(x) ((x) + OFFSET_XTALKOUT)</span>

<span class="cp">#define MIX_DEFIGAIN 0x08</span>
<span class="cp">#define MIX_DEFOGAIN 0x08	</span><span class="cm">/* 0x8-&gt;6dB  (6dB = x4) 16 to 18 bit conversion? */</span><span class="cp"></span>

<span class="cm">/* MIXER */</span>
<span class="cp">#define VORTEX_MIXER_SR 0x21f00</span>
<span class="cp">#define VORTEX_MIXER_CLIP 0x21f80</span>
<span class="cp">#define VORTEX_MIXER_CHNBASE 0x21e40</span>
<span class="cp">#define VORTEX_MIXER_RTBASE 0x21e00</span>
<span class="cp">#define 	MIXER_RTBASE_SIZE 0x38</span>
<span class="cp">#define VORTEX_MIX_ENIN 0x21a00	</span><span class="cm">/* Input enable bits. 4 bits wide. */</span><span class="cp"></span>
<span class="cp">#define VORTEX_MIX_SMP 0x21c00	</span><span class="cm">/* wave data buffers. AU8820: 0x9c00 */</span><span class="cp"></span>

<span class="cm">/* MIX */</span>
<span class="cp">#define VORTEX_MIX_INVOL_B 0x20000	</span><span class="cm">/* Input volume current */</span><span class="cp"></span>
<span class="cp">#define VORTEX_MIX_VOL_B 0x20800	</span><span class="cm">/* Output Volume current */</span><span class="cp"></span>
<span class="cp">#define VORTEX_MIX_INVOL_A 0x21000	</span><span class="cm">/* Input Volume target */</span><span class="cp"></span>
<span class="cp">#define VORTEX_MIX_VOL_A 0x21800	</span><span class="cm">/* Output Volume target */</span><span class="cp"></span>

<span class="cp">#define 	VOL_MIN 0x80	</span><span class="cm">/* Input volume when muted. */</span><span class="cp"></span>
<span class="cp">#define		VOL_MAX 0x7f	</span><span class="cm">/* FIXME: Not confirmed! Just guessed. */</span><span class="cp"></span>

<span class="cm">/* SRC */</span>
<span class="cp">#define VORTEX_SRC_CHNBASE		0x26c40</span>
<span class="cp">#define VORTEX_SRC_RTBASE		0x26c00</span>
<span class="cp">#define VORTEX_SRCBLOCK_SR		0x26cc0</span>
<span class="cp">#define VORTEX_SRC_SOURCE		0x26cc4</span>
<span class="cp">#define VORTEX_SRC_SOURCESIZE	0x26cc8</span>
<span class="cm">/* Params</span>
<span class="cm">	0x26e00	: 1 U0</span>
<span class="cm">	0x26e40	: 2 CR</span>
<span class="cm">	0x26e80	: 3 U3</span>
<span class="cm">	0x26ec0	: 4 DRIFT1</span>
<span class="cm">	0x26f00 : 5 U1</span>
<span class="cm">	0x26f40	: 6 DRIFT2</span>
<span class="cm">	0x26f80	: 7 U2 : Target rate, direction</span>
<span class="cm">*/</span>

<span class="cp">#define VORTEX_SRC_CONVRATIO	0x26e40</span>
<span class="cp">#define VORTEX_SRC_DRIFT0		0x26e80</span>
<span class="cp">#define VORTEX_SRC_DRIFT1		0x26ec0</span>
<span class="cp">#define VORTEX_SRC_DRIFT2		0x26f40</span>
<span class="cp">#define VORTEX_SRC_U0			0x26e00</span>
<span class="cp">#define		U0_SLOWLOCK		0x200</span>
<span class="cp">#define VORTEX_SRC_U1			0x26f00</span>
<span class="cp">#define VORTEX_SRC_U2			0x26f80</span>
<span class="cp">#define VORTEX_SRC_DATA			0x26800	</span><span class="cm">/* 0xc800 */</span><span class="cp"></span>
<span class="cp">#define VORTEX_SRC_DATA0		0x26000</span>

<span class="cm">/* FIFO */</span>
<span class="cp">#define VORTEX_FIFO_ADBCTRL 0x16100	</span><span class="cm">/* Control bits. */</span><span class="cp"></span>
<span class="cp">#define VORTEX_FIFO_WTCTRL 0x16000</span>
<span class="cp">#define		FIFO_RDONLY	0x00000001</span>
<span class="cp">#define		FIFO_CTRL	0x00000002	</span><span class="cm">/* Allow ctrl. ? */</span><span class="cp"></span>
<span class="cp">#define		FIFO_VALID	0x00000010</span>
<span class="cp">#define 	FIFO_EMPTY	0x00000020</span>
<span class="cp">#define		FIFO_U0		0x00002000	</span><span class="cm">/* Unknown. */</span><span class="cp"></span>
<span class="cp">#define		FIFO_U1		0x00040000</span>
<span class="cp">#define		FIFO_SIZE_BITS 6</span>
<span class="cp">#define		FIFO_SIZE	(1&lt;&lt;(FIFO_SIZE_BITS))	</span><span class="c1">// 0x40</span>
<span class="cp">#define 	FIFO_MASK	(FIFO_SIZE-1)	</span><span class="c1">//0x3f    /* at shift left 0xc */</span>
<span class="cp">#define 	FIFO_BITS	0x1c400000</span>
<span class="cp">#define VORTEX_FIFO_ADBDATA 0x14000</span>
<span class="cp">#define VORTEX_FIFO_WTDATA 0x10000</span>

<span class="cp">#define VORTEX_FIFO_GIRT	0x17000	</span><span class="cm">/* wt0, wt1, adb */</span><span class="cp"></span>
<span class="cp">#define		GIRT_COUNT	3</span>

<span class="cm">/* CODEC */</span>

<span class="cp">#define VORTEX_CODEC_CHN 0x29080	</span><span class="cm">/* The name &quot;CHN&quot; is wrong. */</span><span class="cp"></span>

<span class="cp">#define VORTEX_CODEC_CTRL 0x29184</span>
<span class="cp">#define VORTEX_CODEC_IO 0x29188</span>

<span class="cp">#define VORTEX_CODEC_SPORTCTRL 0x2918c</span>

<span class="cp">#define VORTEX_CODEC_EN 0x29190</span>
<span class="cp">#define		EN_AUDIO0		0x00000300</span>
<span class="cp">#define		EN_MODEM		0x00000c00</span>
<span class="cp">#define		EN_AUDIO1		0x00003000</span>
<span class="cp">#define		EN_SPORT		0x00030000</span>
<span class="cp">#define		EN_SPDIF		0x000c0000</span>
<span class="cp">#define		EN_CODEC		(EN_AUDIO1 | EN_AUDIO0)</span>

<span class="cp">#define VORTEX_SPDIF_SMPRATE	0x29194</span>

<span class="cp">#define VORTEX_SPDIF_FLAGS		0x2205c</span>
<span class="cp">#define VORTEX_SPDIF_CFG0		0x291D0	</span><span class="cm">/* status data */</span><span class="cp"></span>
<span class="cp">#define VORTEX_SPDIF_CFG1		0x291D4</span>

<span class="cp">#define VORTEX_SMP_TIME			0x29198	</span><span class="cm">/* Sample counter/timer */</span><span class="cp"></span>
<span class="cp">#define VORTEX_SMP_TIMER		0x2919c</span>
<span class="cp">#define VORTEX_CODEC2_CTRL		0x291a0</span>

<span class="cp">#define VORTEX_MODEM_CTRL		0x291ac</span>

<span class="cm">/* IRQ */</span>
<span class="cp">#define VORTEX_IRQ_SOURCE 0x2a000	</span><span class="cm">/* Interrupt source flags. */</span><span class="cp"></span>
<span class="cp">#define VORTEX_IRQ_CTRL 0x2a004	</span><span class="cm">/* Interrupt source mask. */</span><span class="cp"></span></pre></div></td></tr>


<tr id="section-4"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-4">&#182;</a></div><h1>define VORTEX<em>IRQ</em>U0 0x2a008 /* ?? */</h1></td><td class="code"><div class="highlight"><pre><span class="cp">#define VORTEX_STAT		0x2a008	</span><span class="cm">/* Some sort of status */</span><span class="cp"></span>
<span class="cp">#define 	STAT_IRQ	0x00000001	</span><span class="cm">/* This bitis set if the IRQ is valid. */</span><span class="cp"></span>

<span class="cp">#define VORTEX_CTRL		0x2a00c</span>
<span class="cp">#define 	CTRL_MIDI_EN	0x00000001</span>
<span class="cp">#define 	CTRL_MIDI_PORT	0x00000060</span>
<span class="cp">#define 	CTRL_GAME_EN	0x00000008</span>
<span class="cp">#define 	CTRL_GAME_PORT	0x00000e00</span>
<span class="cp">#define 	CTRL_IRQ_ENABLE	0x00004000</span>
<span class="cp">#define		CTRL_SPDIF		0x00000000	</span><span class="cm">/* unknown. Please find this value */</span><span class="cp"></span>
<span class="cp">#define 	CTRL_SPORT		0x00200000</span>
<span class="cp">#define 	CTRL_RST		0x00800000</span>
<span class="cp">#define 	CTRL_UNKNOWN	0x01000000</span>

<span class="cm">/* write: Timer period config / read: TIMER IRQ ack. */</span>
<span class="cp">#define VORTEX_IRQ_STAT 0x2919c</span>

		     <span class="cm">/* MIDI *//* GAME. */</span>
<span class="cp">#define VORTEX_MIDI_DATA 0x28800</span>
<span class="cp">#define VORTEX_MIDI_CMD 0x28804	</span><span class="cm">/* Write command / Read status */</span><span class="cp"></span>

<span class="cp">#define VORTEX_GAME_LEGACY 0x28808</span>
<span class="cp">#define VORTEX_CTRL2 0x2880c</span>
<span class="cp">#define		CTRL2_GAME_ADCMODE 0x40</span>
<span class="cp">#define VORTEX_GAME_AXIS 0x28810	</span><span class="cm">/* Axis base register. 4 axis&#39;s */</span><span class="cp"></span>
<span class="cp">#define		AXIS_SIZE 4</span>
<span class="cp">#define		AXIS_RANGE 0x1fff</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
