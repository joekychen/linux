<!DOCTYPE html>
<html><head><title>joekychen/linux » sound › isa › gus › gus_io.c

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>gus_io.c</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> *  Copyright (c) by Jaroslav Kysela &lt;perex@perex.cz&gt;</span>
<span class="cm"> *  I/O routines for GF1/InterWave synthesizer chips</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> *   This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> *   it under the terms of the GNU General Public License as published by</span>
<span class="cm"> *   the Free Software Foundation; either version 2 of the License, or</span>
<span class="cm"> *   (at your option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> *   This program is distributed in the hope that it will be useful,</span>
<span class="cm"> *   but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm"> *   GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> *   You should have received a copy of the GNU General Public License</span>
<span class="cm"> *   along with this program; if not, write to the Free Software</span>
<span class="cm"> *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cp">#include &lt;linux/delay.h&gt;</span>
<span class="cp">#include &lt;linux/time.h&gt;</span>
<span class="cp">#include &lt;sound/core.h&gt;</span>
<span class="cp">#include &lt;sound/gus.h&gt;</span>

<span class="kt">void</span> <span class="nf">snd_gf1_delay</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">mb</span><span class="p">();</span>
		<span class="n">inb</span><span class="p">(</span><span class="n">GUSP</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">DRAM</span><span class="p">));</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> *  =======================================================================</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> *  ok.. stop of control registers (wave &amp; ramp) need some special things..</span>
<span class="cm"> *       big UltraClick (tm) elimination...</span>
<span class="cm"> */</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">__snd_gf1_ctrl_stop</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">value</span><span class="p">;</span>

	<span class="n">outb</span><span class="p">(</span><span class="n">reg</span> <span class="o">|</span> <span class="mh">0x80</span><span class="p">,</span> <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_regsel</span><span class="p">);</span>
	<span class="n">mb</span><span class="p">();</span>
	<span class="n">value</span> <span class="o">=</span> <span class="n">inb</span><span class="p">(</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_data8</span><span class="p">);</span>
	<span class="n">mb</span><span class="p">();</span>
	<span class="n">outb</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_regsel</span><span class="p">);</span>
	<span class="n">mb</span><span class="p">();</span>
	<span class="n">outb</span><span class="p">((</span><span class="n">value</span> <span class="o">|</span> <span class="mh">0x03</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span><span class="mh">0x80</span> <span class="o">|</span> <span class="mh">0x20</span><span class="p">),</span> <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_data8</span><span class="p">);</span>
	<span class="n">mb</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">__snd_gf1_write8</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span>
				    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">,</span>
				    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">outb</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_regsel</span><span class="p">);</span>
	<span class="n">mb</span><span class="p">();</span>
	<span class="n">outb</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_data8</span><span class="p">);</span>
	<span class="n">mb</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="nf">__snd_gf1_look8</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span>
					    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">outb</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_regsel</span><span class="p">);</span>
	<span class="n">mb</span><span class="p">();</span>
	<span class="k">return</span> <span class="n">inb</span><span class="p">(</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_data8</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">__snd_gf1_write16</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span>
				     <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">outb</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_regsel</span><span class="p">);</span>
	<span class="n">mb</span><span class="p">();</span>
	<span class="n">outw</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kt">short</span><span class="p">)</span> <span class="n">data</span><span class="p">,</span> <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_data16</span><span class="p">);</span>
	<span class="n">mb</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="nf">__snd_gf1_look16</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span>
					      <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">outb</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_regsel</span><span class="p">);</span>
	<span class="n">mb</span><span class="p">();</span>
	<span class="k">return</span> <span class="n">inw</span><span class="p">(</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_data16</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">__snd_gf1_adlib_write</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span>
					 <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">outb</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_timerctrl</span><span class="p">);</span>
	<span class="n">inb</span><span class="p">(</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_timerctrl</span><span class="p">);</span>
	<span class="n">inb</span><span class="p">(</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_timerctrl</span><span class="p">);</span>
	<span class="n">outb</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_timerdata</span><span class="p">);</span>
	<span class="n">inb</span><span class="p">(</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_timerctrl</span><span class="p">);</span>
	<span class="n">inb</span><span class="p">(</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_timerctrl</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">__snd_gf1_write_addr</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">,</span>
                                        <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">addr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">w_16bit</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">enh_mode</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">w_16bit</span><span class="p">)</span>
			<span class="n">addr</span> <span class="o">=</span> <span class="p">((</span><span class="n">addr</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="mh">0x0000000f</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">addr</span> <span class="o">&amp;</span> <span class="mh">0x0000000f</span><span class="p">);</span>
		<span class="n">__snd_gf1_write8</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">SNDRV_GF1_VB_UPPER_ADDRESS</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="p">)</span> <span class="p">((</span><span class="n">addr</span> <span class="o">&gt;&gt;</span> <span class="mi">26</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x03</span><span class="p">));</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">w_16bit</span><span class="p">)</span>
		<span class="n">addr</span> <span class="o">=</span> <span class="p">(</span><span class="n">addr</span> <span class="o">&amp;</span> <span class="mh">0x00c0000f</span><span class="p">)</span> <span class="o">|</span> <span class="p">((</span><span class="n">addr</span> <span class="o">&amp;</span> <span class="mh">0x003ffff0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">__snd_gf1_write16</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">short</span><span class="p">)</span> <span class="p">(</span><span class="n">addr</span> <span class="o">&gt;&gt;</span> <span class="mi">11</span><span class="p">));</span>
	<span class="n">__snd_gf1_write16</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">reg</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">short</span><span class="p">)</span> <span class="p">(</span><span class="n">addr</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">__snd_gf1_read_addr</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span>
					       <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">,</span> <span class="kt">short</span> <span class="n">w_16bit</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">res</span><span class="p">;</span>

	<span class="n">res</span> <span class="o">=</span> <span class="p">((</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span> <span class="n">__snd_gf1_look16</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">reg</span> <span class="o">|</span> <span class="mh">0x80</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xfff800</span><span class="p">;</span>
	<span class="n">res</span> <span class="o">|=</span> <span class="p">((</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span> <span class="n">__snd_gf1_look16</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="p">(</span><span class="n">reg</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="mh">0x80</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x0007ff</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">enh_mode</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">res</span> <span class="o">|=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span> <span class="n">__snd_gf1_look8</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">SNDRV_GF1_VB_UPPER_ADDRESS</span> <span class="o">|</span> <span class="mh">0x80</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">26</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">w_16bit</span><span class="p">)</span>
			<span class="n">res</span> <span class="o">=</span> <span class="p">((</span><span class="n">res</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xffffffe0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">res</span> <span class="o">&amp;</span> <span class="mh">0x0000000f</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">w_16bit</span><span class="p">)</span>
		<span class="n">res</span> <span class="o">=</span> <span class="p">((</span><span class="n">res</span> <span class="o">&amp;</span> <span class="mh">0x001ffff0</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">res</span> <span class="o">&amp;</span> <span class="mh">0x00c0000f</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>


<span class="cm">/*</span>
<span class="cm"> *  =======================================================================</span>
<span class="cm"> */</span>

<span class="kt">void</span> <span class="nf">snd_gf1_ctrl_stop</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">__snd_gf1_ctrl_stop</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">reg</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">snd_gf1_write8</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span>
		    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">,</span>
		    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">__snd_gf1_write8</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">data</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">unsigned</span> <span class="kt">char</span> <span class="nf">snd_gf1_look8</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">__snd_gf1_look8</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">reg</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">snd_gf1_write16</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span>
		     <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">,</span>
		     <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">__snd_gf1_write16</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">data</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">unsigned</span> <span class="kt">short</span> <span class="nf">snd_gf1_look16</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">__snd_gf1_look16</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">reg</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">snd_gf1_adlib_write</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span>
                         <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">,</span>
                         <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">__snd_gf1_adlib_write</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">data</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">snd_gf1_write_addr</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">,</span>
                        <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">addr</span><span class="p">,</span> <span class="kt">short</span> <span class="n">w_16bit</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">__snd_gf1_write_addr</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">w_16bit</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">snd_gf1_read_addr</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span>
                               <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">,</span>
                               <span class="kt">short</span> <span class="n">w_16bit</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">__snd_gf1_read_addr</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">w_16bit</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/*</span>

<span class="cm"> */</span>

<span class="kt">void</span> <span class="nf">snd_gf1_i_ctrl_stop</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">flags</span><span class="p">;</span>

	<span class="n">spin_lock_irqsave</span><span class="p">(</span><span class="o">&amp;</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">reg_lock</span><span class="p">,</span> <span class="n">flags</span><span class="p">);</span>
	<span class="n">__snd_gf1_ctrl_stop</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">reg</span><span class="p">);</span>
	<span class="n">spin_unlock_irqrestore</span><span class="p">(</span><span class="o">&amp;</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">reg_lock</span><span class="p">,</span> <span class="n">flags</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">snd_gf1_i_write8</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span>
		      <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">,</span>
                      <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">flags</span><span class="p">;</span>

	<span class="n">spin_lock_irqsave</span><span class="p">(</span><span class="o">&amp;</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">reg_lock</span><span class="p">,</span> <span class="n">flags</span><span class="p">);</span>
	<span class="n">__snd_gf1_write8</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">data</span><span class="p">);</span>
	<span class="n">spin_unlock_irqrestore</span><span class="p">(</span><span class="o">&amp;</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">reg_lock</span><span class="p">,</span> <span class="n">flags</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">unsigned</span> <span class="kt">char</span> <span class="nf">snd_gf1_i_look8</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">flags</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">res</span><span class="p">;</span>

	<span class="n">spin_lock_irqsave</span><span class="p">(</span><span class="o">&amp;</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">reg_lock</span><span class="p">,</span> <span class="n">flags</span><span class="p">);</span>
	<span class="n">res</span> <span class="o">=</span> <span class="n">__snd_gf1_look8</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">reg</span><span class="p">);</span>
	<span class="n">spin_unlock_irqrestore</span><span class="p">(</span><span class="o">&amp;</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">reg_lock</span><span class="p">,</span> <span class="n">flags</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">snd_gf1_i_write16</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span>
		       <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">,</span>
		       <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">flags</span><span class="p">;</span>

	<span class="n">spin_lock_irqsave</span><span class="p">(</span><span class="o">&amp;</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">reg_lock</span><span class="p">,</span> <span class="n">flags</span><span class="p">);</span>
	<span class="n">__snd_gf1_write16</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">data</span><span class="p">);</span>
	<span class="n">spin_unlock_irqrestore</span><span class="p">(</span><span class="o">&amp;</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">reg_lock</span><span class="p">,</span> <span class="n">flags</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">unsigned</span> <span class="kt">short</span> <span class="nf">snd_gf1_i_look16</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">flags</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">res</span><span class="p">;</span>

	<span class="n">spin_lock_irqsave</span><span class="p">(</span><span class="o">&amp;</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">reg_lock</span><span class="p">,</span> <span class="n">flags</span><span class="p">);</span>
	<span class="n">res</span> <span class="o">=</span> <span class="n">__snd_gf1_look16</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">reg</span><span class="p">);</span>
	<span class="n">spin_unlock_irqrestore</span><span class="p">(</span><span class="o">&amp;</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">reg_lock</span><span class="p">,</span> <span class="n">flags</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#if 0</span><span class="c"></span>

<span class="c">void snd_gf1_i_adlib_write(struct snd_gus_card * gus,</span>
<span class="c">		           unsigned char reg,</span>
<span class="c">		           unsigned char data)</span>
<span class="c">{</span>
<span class="c">	unsigned long flags;</span>

<span class="c">	spin_lock_irqsave(&amp;gus-&gt;reg_lock, flags);</span>
<span class="c">	__snd_gf1_adlib_write(gus, reg, data);</span>
<span class="c">	spin_unlock_irqrestore(&amp;gus-&gt;reg_lock, flags);</span>
<span class="c">}</span>

<span class="c">void snd_gf1_i_write_addr(struct snd_gus_card * gus, unsigned char reg,</span>
<span class="c">			  unsigned int addr, short w_16bit)</span>
<span class="c">{</span>
<span class="c">	unsigned long flags;</span>

<span class="c">	spin_lock_irqsave(&amp;gus-&gt;reg_lock, flags);</span>
<span class="c">	__snd_gf1_write_addr(gus, reg, addr, w_16bit);</span>
<span class="c">	spin_unlock_irqrestore(&amp;gus-&gt;reg_lock, flags);</span>
<span class="c">}</span>

<span class="cp">#endif  /*  0  */</span>

<span class="cp">#ifdef CONFIG_SND_DEBUG</span>
<span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">snd_gf1_i_read_addr</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span>
					<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">,</span> <span class="kt">short</span> <span class="n">w_16bit</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">res</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">flags</span><span class="p">;</span>

	<span class="n">spin_lock_irqsave</span><span class="p">(</span><span class="o">&amp;</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">reg_lock</span><span class="p">,</span> <span class="n">flags</span><span class="p">);</span>
	<span class="n">res</span> <span class="o">=</span> <span class="n">__snd_gf1_read_addr</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">w_16bit</span><span class="p">);</span>
	<span class="n">spin_unlock_irqrestore</span><span class="p">(</span><span class="o">&amp;</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">reg_lock</span><span class="p">,</span> <span class="n">flags</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">#endif</span>

<span class="cm">/*</span>

<span class="cm"> */</span>

<span class="kt">void</span> <span class="nf">snd_gf1_dram_addr</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">addr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">outb</span><span class="p">(</span><span class="mh">0x43</span><span class="p">,</span> <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_regsel</span><span class="p">);</span>
	<span class="n">mb</span><span class="p">();</span>
	<span class="n">outw</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kt">short</span><span class="p">)</span> <span class="n">addr</span><span class="p">,</span> <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_data16</span><span class="p">);</span>
	<span class="n">mb</span><span class="p">();</span>
	<span class="n">outb</span><span class="p">(</span><span class="mh">0x44</span><span class="p">,</span> <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_regsel</span><span class="p">);</span>
	<span class="n">mb</span><span class="p">();</span>
	<span class="n">outb</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="p">)</span> <span class="p">(</span><span class="n">addr</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">),</span> <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_data8</span><span class="p">);</span>
	<span class="n">mb</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">snd_gf1_poke</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">addr</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">flags</span><span class="p">;</span>

	<span class="n">spin_lock_irqsave</span><span class="p">(</span><span class="o">&amp;</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">reg_lock</span><span class="p">,</span> <span class="n">flags</span><span class="p">);</span>
	<span class="n">outb</span><span class="p">(</span><span class="n">SNDRV_GF1_GW_DRAM_IO_LOW</span><span class="p">,</span> <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_regsel</span><span class="p">);</span>
	<span class="n">mb</span><span class="p">();</span>
	<span class="n">outw</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kt">short</span><span class="p">)</span> <span class="n">addr</span><span class="p">,</span> <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_data16</span><span class="p">);</span>
	<span class="n">mb</span><span class="p">();</span>
	<span class="n">outb</span><span class="p">(</span><span class="n">SNDRV_GF1_GB_DRAM_IO_HIGH</span><span class="p">,</span> <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_regsel</span><span class="p">);</span>
	<span class="n">mb</span><span class="p">();</span>
	<span class="n">outb</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="p">)</span> <span class="p">(</span><span class="n">addr</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">),</span> <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_data8</span><span class="p">);</span>
	<span class="n">mb</span><span class="p">();</span>
	<span class="n">outb</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_dram</span><span class="p">);</span>
	<span class="n">spin_unlock_irqrestore</span><span class="p">(</span><span class="o">&amp;</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">reg_lock</span><span class="p">,</span> <span class="n">flags</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">unsigned</span> <span class="kt">char</span> <span class="nf">snd_gf1_peek</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">addr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">flags</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">res</span><span class="p">;</span>

	<span class="n">spin_lock_irqsave</span><span class="p">(</span><span class="o">&amp;</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">reg_lock</span><span class="p">,</span> <span class="n">flags</span><span class="p">);</span>
	<span class="n">outb</span><span class="p">(</span><span class="n">SNDRV_GF1_GW_DRAM_IO_LOW</span><span class="p">,</span> <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_regsel</span><span class="p">);</span>
	<span class="n">mb</span><span class="p">();</span>
	<span class="n">outw</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kt">short</span><span class="p">)</span> <span class="n">addr</span><span class="p">,</span> <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_data16</span><span class="p">);</span>
	<span class="n">mb</span><span class="p">();</span>
	<span class="n">outb</span><span class="p">(</span><span class="n">SNDRV_GF1_GB_DRAM_IO_HIGH</span><span class="p">,</span> <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_regsel</span><span class="p">);</span>
	<span class="n">mb</span><span class="p">();</span>
	<span class="n">outb</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="p">)</span> <span class="p">(</span><span class="n">addr</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">),</span> <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_data8</span><span class="p">);</span>
	<span class="n">mb</span><span class="p">();</span>
	<span class="n">res</span> <span class="o">=</span> <span class="n">inb</span><span class="p">(</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">reg_dram</span><span class="p">);</span>
	<span class="n">spin_unlock_irqrestore</span><span class="p">(</span><span class="o">&amp;</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">reg_lock</span><span class="p">,</span> <span class="n">flags</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#if 0</span><span class="c"></span>

<span class="c">void snd_gf1_pokew(struct snd_gus_card * gus, unsigned int addr, unsigned short data)</span>
<span class="c">{</span>
<span class="c">	unsigned long flags;</span>

<span class="cp">#ifdef CONFIG_SND_DEBUG</span>
<span class="c">	if (!gus-&gt;interwave)</span>
<span class="c">		snd_printk(KERN_DEBUG &quot;snd_gf1_pokew - GF1!!!\n&quot;);</span>
<span class="cp">#endif</span>
<span class="c">	spin_lock_irqsave(&amp;gus-&gt;reg_lock, flags);</span>
<span class="c">	outb(SNDRV_GF1_GW_DRAM_IO_LOW, gus-&gt;gf1.reg_regsel);</span>
<span class="c">	mb();</span>
<span class="c">	outw((unsigned short) addr, gus-&gt;gf1.reg_data16);</span>
<span class="c">	mb();</span>
<span class="c">	outb(SNDRV_GF1_GB_DRAM_IO_HIGH, gus-&gt;gf1.reg_regsel);</span>
<span class="c">	mb();</span>
<span class="c">	outb((unsigned char) (addr &gt;&gt; 16), gus-&gt;gf1.reg_data8);</span>
<span class="c">	mb();</span>
<span class="c">	outb(SNDRV_GF1_GW_DRAM_IO16, gus-&gt;gf1.reg_regsel);</span>
<span class="c">	mb();</span>
<span class="c">	outw(data, gus-&gt;gf1.reg_data16);</span>
<span class="c">	spin_unlock_irqrestore(&amp;gus-&gt;reg_lock, flags);</span>
<span class="c">}</span>

<span class="c">unsigned short snd_gf1_peekw(struct snd_gus_card * gus, unsigned int addr)</span>
<span class="c">{</span>
<span class="c">	unsigned long flags;</span>
<span class="c">	unsigned short res;</span>

<span class="cp">#ifdef CONFIG_SND_DEBUG</span>
<span class="c">	if (!gus-&gt;interwave)</span>
<span class="c">		snd_printk(KERN_DEBUG &quot;snd_gf1_peekw - GF1!!!\n&quot;);</span>
<span class="cp">#endif</span>
<span class="c">	spin_lock_irqsave(&amp;gus-&gt;reg_lock, flags);</span>
<span class="c">	outb(SNDRV_GF1_GW_DRAM_IO_LOW, gus-&gt;gf1.reg_regsel);</span>
<span class="c">	mb();</span>
<span class="c">	outw((unsigned short) addr, gus-&gt;gf1.reg_data16);</span>
<span class="c">	mb();</span>
<span class="c">	outb(SNDRV_GF1_GB_DRAM_IO_HIGH, gus-&gt;gf1.reg_regsel);</span>
<span class="c">	mb();</span>
<span class="c">	outb((unsigned char) (addr &gt;&gt; 16), gus-&gt;gf1.reg_data8);</span>
<span class="c">	mb();</span>
<span class="c">	outb(SNDRV_GF1_GW_DRAM_IO16, gus-&gt;gf1.reg_regsel);</span>
<span class="c">	mb();</span>
<span class="c">	res = inw(gus-&gt;gf1.reg_data16);</span>
<span class="c">	spin_unlock_irqrestore(&amp;gus-&gt;reg_lock, flags);</span>
<span class="c">	return res;</span>
<span class="c">}</span>

<span class="c">void snd_gf1_dram_setmem(struct snd_gus_card * gus, unsigned int addr,</span>
<span class="c">			 unsigned short value, unsigned int count)</span>
<span class="c">{</span>
<span class="c">	unsigned long port;</span>
<span class="c">	unsigned long flags;</span>

<span class="cp">#ifdef CONFIG_SND_DEBUG</span>
<span class="c">	if (!gus-&gt;interwave)</span>
<span class="c">		snd_printk(KERN_DEBUG &quot;snd_gf1_dram_setmem - GF1!!!\n&quot;);</span>
<span class="cp">#endif</span>
<span class="c">	addr &amp;= ~1;</span>
<span class="c">	count &gt;&gt;= 1;</span>
<span class="c">	port = GUSP(gus, GF1DATALOW);</span>
<span class="c">	spin_lock_irqsave(&amp;gus-&gt;reg_lock, flags);</span>
<span class="c">	outb(SNDRV_GF1_GW_DRAM_IO_LOW, gus-&gt;gf1.reg_regsel);</span>
<span class="c">	mb();</span>
<span class="c">	outw((unsigned short) addr, gus-&gt;gf1.reg_data16);</span>
<span class="c">	mb();</span>
<span class="c">	outb(SNDRV_GF1_GB_DRAM_IO_HIGH, gus-&gt;gf1.reg_regsel);</span>
<span class="c">	mb();</span>
<span class="c">	outb((unsigned char) (addr &gt;&gt; 16), gus-&gt;gf1.reg_data8);</span>
<span class="c">	mb();</span>
<span class="c">	outb(SNDRV_GF1_GW_DRAM_IO16, gus-&gt;gf1.reg_regsel);</span>
<span class="c">	while (count--)</span>
<span class="c">		outw(value, port);</span>
<span class="c">	spin_unlock_irqrestore(&amp;gus-&gt;reg_lock, flags);</span>
<span class="c">}</span>

<span class="cp">#endif  /*  0  */</span>

<span class="kt">void</span> <span class="nf">snd_gf1_select_active_voices</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">voices</span><span class="p">;</span>

	<span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">voices_tbl</span><span class="p">[</span><span class="mi">32</span> <span class="o">-</span> <span class="mi">14</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span>
	<span class="p">{</span>
	    <span class="mi">44100</span><span class="p">,</span> <span class="mi">41160</span><span class="p">,</span> <span class="mi">38587</span><span class="p">,</span> <span class="mi">36317</span><span class="p">,</span> <span class="mi">34300</span><span class="p">,</span> <span class="mi">32494</span><span class="p">,</span> <span class="mi">30870</span><span class="p">,</span> <span class="mi">29400</span><span class="p">,</span> <span class="mi">28063</span><span class="p">,</span> <span class="mi">26843</span><span class="p">,</span>
	    <span class="mi">25725</span><span class="p">,</span> <span class="mi">24696</span><span class="p">,</span> <span class="mi">23746</span><span class="p">,</span> <span class="mi">22866</span><span class="p">,</span> <span class="mi">22050</span><span class="p">,</span> <span class="mi">21289</span><span class="p">,</span> <span class="mi">20580</span><span class="p">,</span> <span class="mi">19916</span><span class="p">,</span> <span class="mi">19293</span>
	<span class="p">};</span>

	<span class="n">voices</span> <span class="o">=</span> <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">active_voices</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">voices</span> <span class="o">&gt;</span> <span class="mi">32</span><span class="p">)</span>
		<span class="n">voices</span> <span class="o">=</span> <span class="mi">32</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">voices</span> <span class="o">&lt;</span> <span class="mi">14</span><span class="p">)</span>
		<span class="n">voices</span> <span class="o">=</span> <span class="mi">14</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">enh_mode</span><span class="p">)</span>
		<span class="n">voices</span> <span class="o">=</span> <span class="mi">32</span><span class="p">;</span>
	<span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">active_voices</span> <span class="o">=</span> <span class="n">voices</span><span class="p">;</span>
	<span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">playback_freq</span> <span class="o">=</span>
	    <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">enh_mode</span> <span class="o">?</span> <span class="mi">44100</span> <span class="o">:</span> <span class="n">voices_tbl</span><span class="p">[</span><span class="n">voices</span> <span class="o">-</span> <span class="mi">14</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">enh_mode</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">snd_gf1_i_write8</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">SNDRV_GF1_GB_ACTIVE_VOICES</span><span class="p">,</span> <span class="mh">0xc0</span> <span class="o">|</span> <span class="p">(</span><span class="n">voices</span> <span class="o">-</span> <span class="mi">1</span><span class="p">));</span>
		<span class="n">udelay</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="cp">#ifdef CONFIG_SND_DEBUG</span>

<span class="kt">void</span> <span class="nf">snd_gf1_print_voice_registers</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">mode</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">voice</span><span class="p">,</span> <span class="n">ctrl</span><span class="p">;</span>

	<span class="n">voice</span> <span class="o">=</span> <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">active_voice</span><span class="p">;</span>
	<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot; -%i- GF1  voice ctrl, ramp ctrl  = 0x%x, 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">voice</span><span class="p">,</span> <span class="n">ctrl</span> <span class="o">=</span> <span class="n">snd_gf1_i_read8</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">snd_gf1_i_read8</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">));</span>
	<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot; -%i- GF1  frequency              = 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">voice</span><span class="p">,</span> <span class="n">snd_gf1_i_read16</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
	<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot; -%i- GF1  loop start, end        = 0x%x (0x%x), 0x%x (0x%x)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">voice</span><span class="p">,</span> <span class="n">snd_gf1_i_read_addr</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ctrl</span> <span class="o">&amp;</span> <span class="mi">4</span><span class="p">),</span> <span class="n">snd_gf1_i_read_addr</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">ctrl</span> <span class="o">&amp;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">^</span> <span class="mi">4</span><span class="p">),</span> <span class="n">snd_gf1_i_read_addr</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">ctrl</span> <span class="o">&amp;</span> <span class="mi">4</span><span class="p">),</span> <span class="n">snd_gf1_i_read_addr</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="n">ctrl</span> <span class="o">&amp;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">^</span> <span class="mi">4</span><span class="p">));</span>
	<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot; -%i- GF1  ramp start, end, rate  = 0x%x, 0x%x, 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">voice</span><span class="p">,</span> <span class="n">snd_gf1_i_read8</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">snd_gf1_i_read8</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">snd_gf1_i_read8</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mi">6</span><span class="p">));</span>
	<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span><span class="s">&quot; -%i- GF1  volume                 = 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">voice</span><span class="p">,</span> <span class="n">snd_gf1_i_read16</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mi">9</span><span class="p">));</span>
	<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot; -%i- GF1  position               = 0x%x (0x%x)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">voice</span><span class="p">,</span> <span class="n">snd_gf1_i_read_addr</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mh">0x0a</span><span class="p">,</span> <span class="n">ctrl</span> <span class="o">&amp;</span> <span class="mi">4</span><span class="p">),</span> <span class="n">snd_gf1_i_read_addr</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mh">0x0a</span><span class="p">,</span> <span class="p">(</span><span class="n">ctrl</span> <span class="o">&amp;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">^</span> <span class="mi">4</span><span class="p">));</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">interwave</span> <span class="o">&amp;&amp;</span> <span class="n">snd_gf1_i_read8</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mh">0x19</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x01</span><span class="p">)</span> <span class="p">{</span>	<span class="cm">/* enhanced mode */</span>
		<span class="n">mode</span> <span class="o">=</span> <span class="n">snd_gf1_i_read8</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">);</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot; -%i- GFA1 mode                   = 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">voice</span><span class="p">,</span> <span class="n">mode</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">mode</span> <span class="o">&amp;</span> <span class="mh">0x01</span><span class="p">)</span> <span class="p">{</span>	<span class="cm">/* Effect processor */</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot; -%i- GFA1 effect address         = 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">voice</span><span class="p">,</span> <span class="n">snd_gf1_i_read_addr</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="n">ctrl</span> <span class="o">&amp;</span> <span class="mi">4</span><span class="p">));</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot; -%i- GFA1 effect volume          = 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">voice</span><span class="p">,</span> <span class="n">snd_gf1_i_read16</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">));</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot; -%i- GFA1 effect volume final    = 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">voice</span><span class="p">,</span> <span class="n">snd_gf1_i_read16</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mh">0x1d</span><span class="p">));</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot; -%i- GFA1 effect acumulator      = 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">voice</span><span class="p">,</span> <span class="n">snd_gf1_i_read8</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">));</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">mode</span> <span class="o">&amp;</span> <span class="mh">0x20</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot; -%i- GFA1 left offset            = 0x%x (%i)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">voice</span><span class="p">,</span> <span class="n">snd_gf1_i_read16</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">),</span> <span class="n">snd_gf1_i_read16</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">);</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot; -%i- GFA1 left offset final      = 0x%x (%i)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">voice</span><span class="p">,</span> <span class="n">snd_gf1_i_read16</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mh">0x1c</span><span class="p">),</span> <span class="n">snd_gf1_i_read16</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mh">0x1c</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">);</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot; -%i- GFA1 right offset           = 0x%x (%i)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">voice</span><span class="p">,</span> <span class="n">snd_gf1_i_read16</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mh">0x0c</span><span class="p">),</span> <span class="n">snd_gf1_i_read16</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mh">0x0c</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">);</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot; -%i- GFA1 right offset final     = 0x%x (%i)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">voice</span><span class="p">,</span> <span class="n">snd_gf1_i_read16</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mh">0x1b</span><span class="p">),</span> <span class="n">snd_gf1_i_read16</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mh">0x1b</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot; -%i- GF1  pan                    = 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">voice</span><span class="p">,</span> <span class="n">snd_gf1_i_read8</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mh">0x0c</span><span class="p">));</span>
	<span class="p">}</span> <span class="k">else</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot; -%i- GF1  pan                    = 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">voice</span><span class="p">,</span> <span class="n">snd_gf1_i_read8</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="mh">0x0c</span><span class="p">));</span>
<span class="p">}</span>

<span class="cp">#if 0</span><span class="c"></span>

<span class="c">void snd_gf1_print_global_registers(struct snd_gus_card * gus)</span>
<span class="c">{</span>
<span class="c">	unsigned char global_mode = 0x00;</span>

<span class="c">	printk(KERN_INFO &quot; -G- GF1 active voices            = 0x%x\n&quot;, snd_gf1_i_look8(gus, SNDRV_GF1_GB_ACTIVE_VOICES));</span>
<span class="c">	if (gus-&gt;interwave) {</span>
<span class="c">		global_mode = snd_gf1_i_read8(gus, SNDRV_GF1_GB_GLOBAL_MODE);</span>
<span class="c">		printk(KERN_INFO &quot; -G- GF1 global mode              = 0x%x\n&quot;, global_mode);</span>
<span class="c">	}</span>
<span class="c">	if (global_mode &amp; 0x02)	/* LFO enabled? */</span>
<span class="c">		printk(KERN_INFO &quot; -G- GF1 LFO base                 = 0x%x\n&quot;, snd_gf1_i_look16(gus, SNDRV_GF1_GW_LFO_BASE));</span>
<span class="c">	printk(KERN_INFO &quot; -G- GF1 voices IRQ read          = 0x%x\n&quot;, snd_gf1_i_look8(gus, SNDRV_GF1_GB_VOICES_IRQ_READ));</span>
<span class="c">	printk(KERN_INFO &quot; -G- GF1 DRAM DMA control         = 0x%x\n&quot;, snd_gf1_i_look8(gus, SNDRV_GF1_GB_DRAM_DMA_CONTROL));</span>
<span class="c">	printk(KERN_INFO &quot; -G- GF1 DRAM DMA high/low        = 0x%x/0x%x\n&quot;, snd_gf1_i_look8(gus, SNDRV_GF1_GB_DRAM_DMA_HIGH), snd_gf1_i_read16(gus, SNDRV_GF1_GW_DRAM_DMA_LOW));</span>
<span class="c">	printk(KERN_INFO &quot; -G- GF1 DRAM IO high/low         = 0x%x/0x%x\n&quot;, snd_gf1_i_look8(gus, SNDRV_GF1_GB_DRAM_IO_HIGH), snd_gf1_i_read16(gus, SNDRV_GF1_GW_DRAM_IO_LOW));</span>
<span class="c">	if (!gus-&gt;interwave)</span>
<span class="c">		printk(KERN_INFO &quot; -G- GF1 record DMA control       = 0x%x\n&quot;, snd_gf1_i_look8(gus, SNDRV_GF1_GB_REC_DMA_CONTROL));</span>
<span class="c">	printk(KERN_INFO &quot; -G- GF1 DRAM IO 16               = 0x%x\n&quot;, snd_gf1_i_look16(gus, SNDRV_GF1_GW_DRAM_IO16));</span>
<span class="c">	if (gus-&gt;gf1.enh_mode) {</span>
<span class="c">		printk(KERN_INFO &quot; -G- GFA1 memory config           = 0x%x\n&quot;, snd_gf1_i_look16(gus, SNDRV_GF1_GW_MEMORY_CONFIG));</span>
<span class="c">		printk(KERN_INFO &quot; -G- GFA1 memory control          = 0x%x\n&quot;, snd_gf1_i_look8(gus, SNDRV_GF1_GB_MEMORY_CONTROL));</span>
<span class="c">		printk(KERN_INFO &quot; -G- GFA1 FIFO record base        = 0x%x\n&quot;, snd_gf1_i_look16(gus, SNDRV_GF1_GW_FIFO_RECORD_BASE_ADDR));</span>
<span class="c">		printk(KERN_INFO &quot; -G- GFA1 FIFO playback base      = 0x%x\n&quot;, snd_gf1_i_look16(gus, SNDRV_GF1_GW_FIFO_PLAY_BASE_ADDR));</span>
<span class="c">		printk(KERN_INFO &quot; -G- GFA1 interleave control      = 0x%x\n&quot;, snd_gf1_i_look16(gus, SNDRV_GF1_GW_INTERLEAVE));</span>
<span class="c">	}</span>
<span class="c">}</span>

<span class="c">void snd_gf1_print_setup_registers(struct snd_gus_card * gus)</span>
<span class="c">{</span>
<span class="c">	printk(KERN_INFO &quot; -S- mix control                  = 0x%x\n&quot;, inb(GUSP(gus, MIXCNTRLREG)));</span>
<span class="c">	printk(KERN_INFO &quot; -S- IRQ status                   = 0x%x\n&quot;, inb(GUSP(gus, IRQSTAT)));</span>
<span class="c">	printk(KERN_INFO &quot; -S- timer control                = 0x%x\n&quot;, inb(GUSP(gus, TIMERCNTRL)));</span>
<span class="c">	printk(KERN_INFO &quot; -S- timer data                   = 0x%x\n&quot;, inb(GUSP(gus, TIMERDATA)));</span>
<span class="c">	printk(KERN_INFO &quot; -S- status read                  = 0x%x\n&quot;, inb(GUSP(gus, REGCNTRLS)));</span>
<span class="c">	printk(KERN_INFO &quot; -S- Sound Blaster control        = 0x%x\n&quot;, snd_gf1_i_look8(gus, SNDRV_GF1_GB_SOUND_BLASTER_CONTROL));</span>
<span class="c">	printk(KERN_INFO &quot; -S- AdLib timer 1/2              = 0x%x/0x%x\n&quot;, snd_gf1_i_look8(gus, SNDRV_GF1_GB_ADLIB_TIMER_1), snd_gf1_i_look8(gus, SNDRV_GF1_GB_ADLIB_TIMER_2));</span>
<span class="c">	printk(KERN_INFO &quot; -S- reset                        = 0x%x\n&quot;, snd_gf1_i_look8(gus, SNDRV_GF1_GB_RESET));</span>
<span class="c">	if (gus-&gt;interwave) {</span>
<span class="c">		printk(KERN_INFO &quot; -S- compatibility                = 0x%x\n&quot;, snd_gf1_i_look8(gus, SNDRV_GF1_GB_COMPATIBILITY));</span>
<span class="c">		printk(KERN_INFO &quot; -S- decode control               = 0x%x\n&quot;, snd_gf1_i_look8(gus, SNDRV_GF1_GB_DECODE_CONTROL));</span>
<span class="c">		printk(KERN_INFO &quot; -S- version number               = 0x%x\n&quot;, snd_gf1_i_look8(gus, SNDRV_GF1_GB_VERSION_NUMBER));</span>
<span class="c">		printk(KERN_INFO &quot; -S- MPU-401 emul. control A/B    = 0x%x/0x%x\n&quot;, snd_gf1_i_look8(gus, SNDRV_GF1_GB_MPU401_CONTROL_A), snd_gf1_i_look8(gus, SNDRV_GF1_GB_MPU401_CONTROL_B));</span>
<span class="c">		printk(KERN_INFO &quot; -S- emulation IRQ                = 0x%x\n&quot;, snd_gf1_i_look8(gus, SNDRV_GF1_GB_EMULATION_IRQ));</span>
<span class="c">	}</span>
<span class="c">}</span>

<span class="c">void snd_gf1_peek_print_block(struct snd_gus_card * gus, unsigned int addr, int count, int w_16bit)</span>
<span class="c">{</span>
<span class="c">	if (!w_16bit) {</span>
<span class="c">		while (count-- &gt; 0)</span>
<span class="c">			printk(count &gt; 0 ? &quot;%02x:&quot; : &quot;%02x&quot;, snd_gf1_peek(gus, addr++));</span>
<span class="c">	} else {</span>
<span class="c">		while (count-- &gt; 0) {</span>
<span class="c">			printk(count &gt; 0 ? &quot;%04x:&quot; : &quot;%04x&quot;, snd_gf1_peek(gus, addr) | (snd_gf1_peek(gus, addr + 1) &lt;&lt; 8));</span>
<span class="c">			addr += 2;</span>
<span class="c">		}</span>
<span class="c">	}</span>
<span class="c">}</span>

<span class="cp">#endif  /*  0  */</span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
