f | xfrm_user.c | s | 69K | 2456 | David S. Miller | davem@davemloft.net | 1333318296 |  | xfrm_user: Stop using NLA_PUT*().  These macros contain a hidden goto, and are thus extremely error prone and make code hard to audit.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | xfrm_state.c | s | 53K | 1896 | Alexey Dobriyan | adobriyan@gmail.com | 1321998212 |  | net: remove ipv6_addr_copy()  C assignment can handle struct in6_addr copying.  Signed-off-by: Alexey Dobriyan <adobriyan@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | Makefile | g | 342B |  | Jan Beulich | JBeulich@suse.com | 1337102014 |  | xfrm: make xfrm_algo.c a module  By making this a standalone config option (auto-selected as needed), selecting CRYPTO from here rather than from XFRM (which is boolean) allows the core crypto code to become a module again even when XFRM=y.  Signed-off-by: Jan Beulich <jbeulich@suse.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | xfrm_output.c | s | 4.2K | 172 | Steffen Klassert | steffen.klassert@secunet.com | 1332458998 |  | xfrm: Remove unused xfrm_state from xfrm_state_check_space  The xfrm_state argument is unused in this function, so remove it. Also the name xfrm_state_check_space does not really match what this function does. It actually checks if we have enough head and tailroom on the skb. So we rename the function to xfrm_skb_check_space.  Signed-off-by: Steffen Klassert <steffen.klassert@secunet.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | xfrm_ipcomp.c | s | 7.7K | 307 | Eric Dumazet | eric.dumazet@gmail.com | 1319008246 |  | net: add skb frag size accessors  To ease skb->truesize sanitization, its better to be able to localize all references to skb frags size.  Define accessors : skb_frag_size() to fetch frag size, and skb_frag_size_{set||add||sub}() to manipulate it.  Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | xfrm_input.c | s | 6.2K | 238 | Steffen Klassert | steffen.klassert@secunet.com | 1316632857 |  | xfrm: Perform a replay check after return from async codepaths  When asyncronous crypto algorithms are used, there might be many packets that passed the xfrm replay check, but the replay advance function is not called yet for these packets. So the replay check function would accept a replay of all of these packets. Also the system might crash if there are more packets in async processing than the size of the anti replay window, because the replay advance function would try to update the replay window beyond the bounds.  This pach adds a second replay check after resuming from the async processing to fix these issues.  Signed-off-by: Steffen Klassert <steffen.klassert@secunet.com> Acked-by: Herbert Xu <herbert@gondor.apana.org.au> Signed-off-by: David S. Miller <davem@davemloft.net>
f | xfrm_proc.c | s | 3.1K | 79 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103830 |  | net: Add export.h for EXPORT_SYMBOL/THIS_MODULE to non-modules  These files are non modular, but need to export symbols using the macros now living in export.h -- call out the include so that things won't break when we remove the implicit presence of module.h from everywhere.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | xfrm_hash.c | s | 766B | 33 | Eric Dumazet | eric.dumazet@gmail.com | 1290362644 |  | net: allow GFP_HIGHMEM in __vmalloc()  We forgot to use __GFP_HIGHMEM in several __vmalloc() calls.  In ceph, add the missing flag.  In fib_trie.c, xfrm_hash.c and request_sock.c, using vzalloc() is cleaner and allows using HIGHMEM pages as well.  Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | xfrm_policy.c | s | 71K | 2564 | Gao feng | gaofeng@cn.fujitsu.com | 1338095482 |  | ipv6: fix incorrect ipsec fragment  Since commit ad0081e43a "ipv6: Fragment locally generated tunnel-mode IPSec6 packets as needed" the fragment of packets is incorrect. because tunnel mode needs IPsec headers and trailer for all fragments, while on transport mode it is sufficient to add the headers to the first fragment and the trailer to the last.  so modify mtu and maxfraglen base on ipsec mode and if fragment is first or last.  with my test,it work well(every fragment's size is the mtu) and does not trigger slow fragment path.  Changes from v1: 	though optimization, mtu_prev and maxfraglen_prev can be delete. 	replace xfrm mode codes with dst_entry's new frag DST_XFRM_TUNNEL. 	add fuction ip6_append_data_mtu to make codes clearer.  Signed-off-by: Gao feng <gaofeng@cn.fujitsu.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | xfrm_algo.c | s | 13K | 653 | Jan Beulich | JBeulich@suse.com | 1337102014 |  | xfrm_algo: drop an unnecessary inclusion  For several releases, this has not been needed anymore, as no helper functions declared in net/ah.h get implemented by xfrm_algo.c anymore.  Signed-off-by: Jan Beulich <jbeulich@suse.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | xfrm_replay.c | s | 12K | 428 | Steffen Klassert | steffen.klassert@secunet.com | 1332458998 |  | xfrm: Access the replay notify functions via the registered callbacks  We call the wrong replay notify function when we use ESN replay handling. This leads to the fact that we don't send notifications if we use ESN. Fix this by calling the registered callbacks instead of xfrm_replay_notify().  Signed-off-by: Steffen Klassert <steffen.klassert@secunet.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | Kconfig | g | 2.3K |  | Jan Beulich | JBeulich@suse.com | 1337102014 |  | xfrm: make xfrm_algo.c a module  By making this a standalone config option (auto-selected as needed), selecting CRYPTO from here rather than from XFRM (which is boolean) allows the core crypto code to become a module again even when XFRM=y.  Signed-off-by: Jan Beulich <jbeulich@suse.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | xfrm_hash.h | s | 3.1K | 117 | Eric Dumazet | eric.dumazet@gmail.com | 1334508280 |  | net: cleanup unsigned to unsigned int  Use of "unsigned int" is preferred to bare "unsigned" in net tree.  Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | xfrm_sysctl.c | s | 1.7K | 73 | Eric W. Biederman | ebiederm@xmission.com | 1334971350 |  | net: Convert all sysctl registrations to register_net_sysctl  This results in code with less boiler plate that is a bit easier to read.  Additionally stops us from using compatibility code in the sysctl core, hastening the day when the compatibility code can be removed.  Signed-off-by: Eric W. Biederman <ebiederm@xmission.com> Acked-by: Pavel Emelyanov <xemul@parallels.com> Signed-off-by: David S. Miller <davem@davemloft.net>
