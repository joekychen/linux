<!DOCTYPE html>
<html><head><title>joekychen/linux » net › sctp › sm_statetable.c

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>sm_statetable.c</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/* SCTP kernel implementation</span>
<span class="cm"> * (C) Copyright IBM Corp. 2001, 2004</span>
<span class="cm"> * Copyright (c) 1999-2000 Cisco, Inc.</span>
<span class="cm"> * Copyright (c) 1999-2001 Motorola, Inc.</span>
<span class="cm"> * Copyright (c) 2001 Intel Corp.</span>
<span class="cm"> * Copyright (c) 2001 Nokia, Inc.</span>
<span class="cm"> *</span>
<span class="cm"> * This file is part of the SCTP kernel implementation</span>
<span class="cm"> *</span>
<span class="cm"> * These are the state tables for the SCTP state machine.</span>
<span class="cm"> *</span>
<span class="cm"> * This SCTP implementation is free software;</span>
<span class="cm"> * you can redistribute it and/or modify it under the terms of</span>
<span class="cm"> * the GNU General Public License as published by</span>
<span class="cm"> * the Free Software Foundation; either version 2, or (at your option)</span>
<span class="cm"> * any later version.</span>
<span class="cm"> *</span>
<span class="cm"> * This SCTP implementation is distributed in the hope that it</span>
<span class="cm"> * will be useful, but WITHOUT ANY WARRANTY; without even the implied</span>
<span class="cm"> *                 ************************</span>
<span class="cm"> * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span>
<span class="cm"> * See the GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License</span>
<span class="cm"> * along with GNU CC; see the file COPYING.  If not, write to</span>
<span class="cm"> * the Free Software Foundation, 59 Temple Place - Suite 330,</span>
<span class="cm"> * Boston, MA 02111-1307, USA.</span>
<span class="cm"> *</span>
<span class="cm"> * Please send any bug reports or fixes you make to the</span>
<span class="cm"> * email address(es):</span>
<span class="cm"> *    lksctp developers &lt;lksctp-developers@lists.sourceforge.net&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * Or submit a bug report through the following website:</span>
<span class="cm"> *    http://www.sf.net/projects/lksctp</span>
<span class="cm"> *</span>
<span class="cm"> * Written or modified by:</span>
<span class="cm"> *    La Monte H.P. Yarroll &lt;piggy@acm.org&gt;</span>
<span class="cm"> *    Karl Knutson          &lt;karl@athena.chicago.il.us&gt;</span>
<span class="cm"> *    Jon Grimm             &lt;jgrimm@us.ibm.com&gt;</span>
<span class="cm"> *    Hui Huang		    &lt;hui.huang@nokia.com&gt;</span>
<span class="cm"> *    Daisy Chang	    &lt;daisyc@us.ibm.com&gt;</span>
<span class="cm"> *    Ardelle Fan	    &lt;ardelle.fan@intel.com&gt;</span>
<span class="cm"> *    Sridhar Samudrala	    &lt;sri@us.ibm.com&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * Any bugs reported given to us we will try to fix... any fixes shared will</span>
<span class="cm"> * be incorporated into the next SCTP release.</span>
<span class="cm"> */</span>

<span class="cp">#define pr_fmt(fmt) KBUILD_MODNAME &quot;: &quot; fmt</span>

<span class="cp">#include &lt;linux/skbuff.h&gt;</span>
<span class="cp">#include &lt;net/sctp/sctp.h&gt;</span>
<span class="cp">#include &lt;net/sctp/sm.h&gt;</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">sctp_sm_table_entry_t</span>
<span class="n">primitive_event_table</span><span class="p">[</span><span class="n">SCTP_NUM_PRIMITIVE_TYPES</span><span class="p">][</span><span class="n">SCTP_STATE_NUM_STATES</span><span class="p">];</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">sctp_sm_table_entry_t</span>
<span class="n">other_event_table</span><span class="p">[</span><span class="n">SCTP_NUM_OTHER_TYPES</span><span class="p">][</span><span class="n">SCTP_STATE_NUM_STATES</span><span class="p">];</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">sctp_sm_table_entry_t</span>
<span class="n">timeout_event_table</span><span class="p">[</span><span class="n">SCTP_NUM_TIMEOUT_TYPES</span><span class="p">][</span><span class="n">SCTP_STATE_NUM_STATES</span><span class="p">];</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">sctp_sm_table_entry_t</span> <span class="o">*</span><span class="n">sctp_chunk_event_lookup</span><span class="p">(</span><span class="n">sctp_cid_t</span> <span class="n">cid</span><span class="p">,</span>
							    <span class="n">sctp_state_t</span> <span class="n">state</span><span class="p">);</span>


<span class="k">static</span> <span class="k">const</span> <span class="n">sctp_sm_table_entry_t</span> <span class="n">bug</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">fn</span> <span class="o">=</span> <span class="n">sctp_sf_bug</span><span class="p">,</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;sctp_sf_bug&quot;</span>
<span class="p">};</span>

<span class="cp">#define DO_LOOKUP(_max, _type, _table)					\</span>
<span class="cp">({									\</span>
<span class="cp">	const sctp_sm_table_entry_t *rtn;				\</span>
<span class="cp">									\</span>
<span class="cp">	if ((event_subtype._type &gt; (_max))) {				\</span>
<span class="cp">		pr_warn(&quot;table %p possible attack: event %d exceeds max %d\n&quot;, \</span>
<span class="cp">			_table, event_subtype._type, _max);		\</span>
<span class="cp">	        rtn = &amp;bug;						\</span>
<span class="cp">	} else								\</span>
<span class="cp">		rtn = &amp;_table[event_subtype._type][(int)state];		\</span>
<span class="cp">									\</span>
<span class="cp">	rtn;								\</span>
<span class="cp">})</span>

<span class="k">const</span> <span class="n">sctp_sm_table_entry_t</span> <span class="o">*</span><span class="nf">sctp_sm_lookup_event</span><span class="p">(</span><span class="n">sctp_event_t</span> <span class="n">event_type</span><span class="p">,</span>
						  <span class="n">sctp_state_t</span> <span class="n">state</span><span class="p">,</span>
						  <span class="n">sctp_subtype_t</span> <span class="n">event_subtype</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">event_type</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">SCTP_EVENT_T_CHUNK</span>:
		<span class="k">return</span> <span class="n">sctp_chunk_event_lookup</span><span class="p">(</span><span class="n">event_subtype</span><span class="p">.</span><span class="n">chunk</span><span class="p">,</span> <span class="n">state</span><span class="p">);</span>
	<span class="k">case</span> <span class="n">SCTP_EVENT_T_TIMEOUT</span>:
		<span class="k">return</span> <span class="n">DO_LOOKUP</span><span class="p">(</span><span class="n">SCTP_EVENT_TIMEOUT_MAX</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span>
				 <span class="n">timeout_event_table</span><span class="p">);</span>
	<span class="k">case</span> <span class="n">SCTP_EVENT_T_OTHER</span>:
		<span class="k">return</span> <span class="n">DO_LOOKUP</span><span class="p">(</span><span class="n">SCTP_EVENT_OTHER_MAX</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span>
				 <span class="n">other_event_table</span><span class="p">);</span>
	<span class="k">case</span> <span class="n">SCTP_EVENT_T_PRIMITIVE</span>:
		<span class="k">return</span> <span class="n">DO_LOOKUP</span><span class="p">(</span><span class="n">SCTP_EVENT_PRIMITIVE_MAX</span><span class="p">,</span> <span class="n">primitive</span><span class="p">,</span>
				 <span class="n">primitive_event_table</span><span class="p">);</span>
	<span class="nl">default:</span>
		<span class="cm">/* Yikes!  We got an illegal event type.  */</span>
		<span class="k">return</span> <span class="o">&amp;</span><span class="n">bug</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="cp">#define TYPE_SCTP_FUNC(func) {.fn = func, .name = #func}</span>

<span class="cp">#define TYPE_SCTP_DATA { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_ootb), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_eat_data_6_2), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_eat_data_6_2), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_eat_data_fast_4_4), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">} </span><span class="cm">/* TYPE_SCTP_DATA */</span><span class="cp"></span>

<span class="cp">#define TYPE_SCTP_INIT { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_5_1B_init), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_5_2_1_siminit), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_5_2_1_siminit), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_5_2_2_dupinit), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_5_2_2_dupinit), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_5_2_2_dupinit), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_5_2_2_dupinit), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_9_2_reshutack), \</span>
<span class="cp">} </span><span class="cm">/* TYPE_SCTP_INIT */</span><span class="cp"></span>

<span class="cp">#define TYPE_SCTP_INIT_ACK { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_5_2_3_initack), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_5_1C_ack), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">} </span><span class="cm">/* TYPE_SCTP_INIT_ACK */</span><span class="cp"></span>

<span class="cp">#define TYPE_SCTP_SACK { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_ootb), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_eat_sack_6_2), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_eat_sack_6_2), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_eat_sack_6_2), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_eat_sack_6_2), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">} </span><span class="cm">/* TYPE_SCTP_SACK */</span><span class="cp"></span>

<span class="cp">#define TYPE_SCTP_HEARTBEAT { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_ootb), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_beat_8_3), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_beat_8_3), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_beat_8_3), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_beat_8_3), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_beat_8_3), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	</span><span class="cm">/* This should not happen, but we are nice.  */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_beat_8_3), \</span>
<span class="cp">} </span><span class="cm">/* TYPE_SCTP_HEARTBEAT */</span><span class="cp"></span>

<span class="cp">#define TYPE_SCTP_HEARTBEAT_ACK { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_ootb), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_violation), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_backbeat_8_3), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_backbeat_8_3), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_backbeat_8_3), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_backbeat_8_3), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">} </span><span class="cm">/* TYPE_SCTP_HEARTBEAT_ACK */</span><span class="cp"></span>

<span class="cp">#define TYPE_SCTP_ABORT { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_pdiscard), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_cookie_wait_abort), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_cookie_echoed_abort), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_9_1_abort), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_shutdown_pending_abort), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_shutdown_sent_abort), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_9_1_abort), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_shutdown_ack_sent_abort), \</span>
<span class="cp">} </span><span class="cm">/* TYPE_SCTP_ABORT */</span><span class="cp"></span>

<span class="cp">#define TYPE_SCTP_SHUTDOWN { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_ootb), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_9_2_shutdown), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_9_2_shutdown), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_9_2_shutdown_ack), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_9_2_shut_ctsn), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">} </span><span class="cm">/* TYPE_SCTP_SHUTDOWN */</span><span class="cp"></span>

<span class="cp">#define TYPE_SCTP_SHUTDOWN_ACK { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_ootb), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_8_5_1_E_sa), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_8_5_1_E_sa), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_violation), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_violation), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_9_2_final), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_violation), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_9_2_final), \</span>
<span class="cp">} </span><span class="cm">/* TYPE_SCTP_SHUTDOWN_ACK */</span><span class="cp"></span>

<span class="cp">#define TYPE_SCTP_ERROR { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_ootb), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_cookie_echoed_err), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_operr_notify), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_operr_notify), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_operr_notify), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">} </span><span class="cm">/* TYPE_SCTP_ERROR */</span><span class="cp"></span>

<span class="cp">#define TYPE_SCTP_COOKIE_ECHO { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_5_1D_ce), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_5_2_4_dupcook), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_5_2_4_dupcook), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_5_2_4_dupcook), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_5_2_4_dupcook), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_5_2_4_dupcook), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_5_2_4_dupcook), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_5_2_4_dupcook), \</span>
<span class="cp">} </span><span class="cm">/* TYPE_SCTP_COOKIE_ECHO */</span><span class="cp"></span>

<span class="cp">#define TYPE_SCTP_COOKIE_ACK { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_5_1E_ca), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">} </span><span class="cm">/* TYPE_SCTP_COOKIE_ACK */</span><span class="cp"></span>

<span class="cp">#define TYPE_SCTP_ECN_ECNE { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_ecne), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_ecne), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_ecne), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_ecne), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_ecne), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">} </span><span class="cm">/* TYPE_SCTP_ECN_ECNE */</span><span class="cp"></span>

<span class="cp">#define TYPE_SCTP_ECN_CWR { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_ecn_cwr), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_ecn_cwr), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_ecn_cwr), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">} </span><span class="cm">/* TYPE_SCTP_ECN_CWR */</span><span class="cp"></span>

<span class="cp">#define TYPE_SCTP_SHUTDOWN_COMPLETE { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_4_C), \</span>
<span class="cp">} </span><span class="cm">/* TYPE_SCTP_SHUTDOWN_COMPLETE */</span><span class="cp"></span>

<span class="cm">/* The primary index for this table is the chunk type.</span>
<span class="cm"> * The secondary index for this table is the state.</span>
<span class="cm"> *</span>
<span class="cm"> * For base protocol (RFC 2960).</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">sctp_sm_table_entry_t</span> <span class="n">chunk_event_table</span><span class="p">[</span><span class="n">SCTP_NUM_BASE_CHUNK_TYPES</span><span class="p">][</span><span class="n">SCTP_STATE_NUM_STATES</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">TYPE_SCTP_DATA</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_INIT</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_INIT_ACK</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_SACK</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_HEARTBEAT</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_HEARTBEAT_ACK</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_ABORT</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_SHUTDOWN</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_SHUTDOWN_ACK</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_ERROR</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_COOKIE_ECHO</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_COOKIE_ACK</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_ECN_ECNE</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_ECN_CWR</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_SHUTDOWN_COMPLETE</span><span class="p">,</span>
<span class="p">};</span> <span class="cm">/* state_fn_t chunk_event_table[][] */</span>

<span class="cp">#define TYPE_SCTP_ASCONF { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_asconf), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_asconf), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_asconf), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_asconf), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">} </span><span class="cm">/* TYPE_SCTP_ASCONF */</span><span class="cp"></span>

<span class="cp">#define TYPE_SCTP_ASCONF_ACK { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_asconf_ack), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_asconf_ack), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_asconf_ack), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_asconf_ack), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">} </span><span class="cm">/* TYPE_SCTP_ASCONF_ACK */</span><span class="cp"></span>

<span class="cm">/* The primary index for this table is the chunk type.</span>
<span class="cm"> * The secondary index for this table is the state.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">sctp_sm_table_entry_t</span> <span class="n">addip_chunk_event_table</span><span class="p">[</span><span class="n">SCTP_NUM_ADDIP_CHUNK_TYPES</span><span class="p">][</span><span class="n">SCTP_STATE_NUM_STATES</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">TYPE_SCTP_ASCONF</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_ASCONF_ACK</span><span class="p">,</span>
<span class="p">};</span> <span class="cm">/*state_fn_t addip_chunk_event_table[][] */</span>

<span class="cp">#define TYPE_SCTP_FWD_TSN { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_ootb), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_eat_fwd_tsn), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_eat_fwd_tsn), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_eat_fwd_tsn_fast), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">} </span><span class="cm">/* TYPE_SCTP_FWD_TSN */</span><span class="cp"></span>

<span class="cm">/* The primary index for this table is the chunk type.</span>
<span class="cm"> * The secondary index for this table is the state.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">sctp_sm_table_entry_t</span> <span class="n">prsctp_chunk_event_table</span><span class="p">[</span><span class="n">SCTP_NUM_PRSCTP_CHUNK_TYPES</span><span class="p">][</span><span class="n">SCTP_STATE_NUM_STATES</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">TYPE_SCTP_FWD_TSN</span><span class="p">,</span>
<span class="p">};</span> <span class="cm">/*state_fn_t prsctp_chunk_event_table[][] */</span>

<span class="cp">#define TYPE_SCTP_AUTH { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_ootb), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_discard_chunk), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_eat_auth), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_eat_auth), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_eat_auth), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_eat_auth), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_eat_auth), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_eat_auth), \</span>
<span class="cp">} </span><span class="cm">/* TYPE_SCTP_AUTH */</span><span class="cp"></span>

<span class="cm">/* The primary index for this table is the chunk type.</span>
<span class="cm"> * The secondary index for this table is the state.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">sctp_sm_table_entry_t</span> <span class="n">auth_chunk_event_table</span><span class="p">[</span><span class="n">SCTP_NUM_AUTH_CHUNK_TYPES</span><span class="p">][</span><span class="n">SCTP_STATE_NUM_STATES</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">TYPE_SCTP_AUTH</span><span class="p">,</span>
<span class="p">};</span> <span class="cm">/*state_fn_t auth_chunk_event_table[][] */</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">sctp_sm_table_entry_t</span>
<span class="n">chunk_event_table_unknown</span><span class="p">[</span><span class="n">SCTP_STATE_NUM_STATES</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* SCTP_STATE_CLOSED */</span>
	<span class="n">TYPE_SCTP_FUNC</span><span class="p">(</span><span class="n">sctp_sf_ootb</span><span class="p">),</span>
	<span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span>
	<span class="n">TYPE_SCTP_FUNC</span><span class="p">(</span><span class="n">sctp_sf_unk_chunk</span><span class="p">),</span>
	<span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span>
	<span class="n">TYPE_SCTP_FUNC</span><span class="p">(</span><span class="n">sctp_sf_unk_chunk</span><span class="p">),</span>
	<span class="cm">/* SCTP_STATE_ESTABLISHED */</span>
	<span class="n">TYPE_SCTP_FUNC</span><span class="p">(</span><span class="n">sctp_sf_unk_chunk</span><span class="p">),</span>
	<span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span>
	<span class="n">TYPE_SCTP_FUNC</span><span class="p">(</span><span class="n">sctp_sf_unk_chunk</span><span class="p">),</span>
	<span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span>
	<span class="n">TYPE_SCTP_FUNC</span><span class="p">(</span><span class="n">sctp_sf_unk_chunk</span><span class="p">),</span>
	<span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span>
	<span class="n">TYPE_SCTP_FUNC</span><span class="p">(</span><span class="n">sctp_sf_unk_chunk</span><span class="p">),</span>
	<span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span>
	<span class="n">TYPE_SCTP_FUNC</span><span class="p">(</span><span class="n">sctp_sf_unk_chunk</span><span class="p">),</span>
<span class="p">};</span>	<span class="cm">/* chunk unknown */</span>


<span class="cp">#define TYPE_SCTP_PRIMITIVE_ASSOCIATE  { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_prm_asoc), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_not_impl), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_not_impl), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_not_impl), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_not_impl), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_not_impl), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_not_impl), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_not_impl), \</span>
<span class="cp">} </span><span class="cm">/* TYPE_SCTP_PRIMITIVE_ASSOCIATE */</span><span class="cp"></span>

<span class="cp">#define TYPE_SCTP_PRIMITIVE_SHUTDOWN  { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_error_closed), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_cookie_wait_prm_shutdown), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_cookie_echoed_prm_shutdown),\</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_9_2_prm_shutdown), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_ignore_primitive), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_ignore_primitive), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_ignore_primitive), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_ignore_primitive), \</span>
<span class="cp">} </span><span class="cm">/* TYPE_SCTP_PRIMITIVE_SHUTDOWN */</span><span class="cp"></span>

<span class="cp">#define TYPE_SCTP_PRIMITIVE_ABORT  { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_error_closed), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_cookie_wait_prm_abort), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_cookie_echoed_prm_abort), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_9_1_prm_abort), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_shutdown_pending_prm_abort), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_shutdown_sent_prm_abort), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_9_1_prm_abort), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_shutdown_ack_sent_prm_abort), \</span>
<span class="cp">} </span><span class="cm">/* TYPE_SCTP_PRIMITIVE_ABORT */</span><span class="cp"></span>

<span class="cp">#define TYPE_SCTP_PRIMITIVE_SEND  { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_error_closed), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_prm_send), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_prm_send), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_prm_send), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_error_shutdown), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_error_shutdown), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_error_shutdown), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_error_shutdown), \</span>
<span class="cp">} </span><span class="cm">/* TYPE_SCTP_PRIMITIVE_SEND */</span><span class="cp"></span>

<span class="cp">#define TYPE_SCTP_PRIMITIVE_REQUESTHEARTBEAT  { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_error_closed), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_prm_requestheartbeat),          \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_prm_requestheartbeat),          \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_prm_requestheartbeat),          \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_prm_requestheartbeat),          \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_prm_requestheartbeat),          \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_prm_requestheartbeat),          \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_prm_requestheartbeat),          \</span>
<span class="cp">} </span><span class="cm">/* TYPE_SCTP_PRIMITIVE_REQUESTHEARTBEAT */</span><span class="cp"></span>

<span class="cp">#define TYPE_SCTP_PRIMITIVE_ASCONF { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_error_closed), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_error_closed), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_error_closed), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_prm_asconf), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_prm_asconf), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_prm_asconf), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_prm_asconf), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_error_shutdown), \</span>
<span class="cp">} </span><span class="cm">/* TYPE_SCTP_PRIMITIVE_ASCONF */</span><span class="cp"></span>

<span class="cm">/* The primary index for this table is the primitive type.</span>
<span class="cm"> * The secondary index for this table is the state.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">sctp_sm_table_entry_t</span> <span class="n">primitive_event_table</span><span class="p">[</span><span class="n">SCTP_NUM_PRIMITIVE_TYPES</span><span class="p">][</span><span class="n">SCTP_STATE_NUM_STATES</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">TYPE_SCTP_PRIMITIVE_ASSOCIATE</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_PRIMITIVE_SHUTDOWN</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_PRIMITIVE_ABORT</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_PRIMITIVE_SEND</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_PRIMITIVE_REQUESTHEARTBEAT</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_PRIMITIVE_ASCONF</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define TYPE_SCTP_OTHER_NO_PENDING_TSN  { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_ignore_other), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_ignore_other), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_ignore_other), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_no_pending_tsn), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_9_2_start_shutdown), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_ignore_other), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_9_2_shutdown_ack), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_ignore_other), \</span>
<span class="cp">}</span>

<span class="cp">#define TYPE_SCTP_OTHER_ICMP_PROTO_UNREACH  { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_ignore_other), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_cookie_wait_icmp_abort), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_ignore_other), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_ignore_other), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_ignore_other), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_ignore_other), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_ignore_other), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_ignore_other), \</span>
<span class="cp">}</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">sctp_sm_table_entry_t</span> <span class="n">other_event_table</span><span class="p">[</span><span class="n">SCTP_NUM_OTHER_TYPES</span><span class="p">][</span><span class="n">SCTP_STATE_NUM_STATES</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">TYPE_SCTP_OTHER_NO_PENDING_TSN</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_OTHER_ICMP_PROTO_UNREACH</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define TYPE_SCTP_EVENT_TIMEOUT_NONE { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_bug), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_bug), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_bug), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_bug), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_bug), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_bug), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_bug), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_bug), \</span>
<span class="cp">}</span>

<span class="cp">#define TYPE_SCTP_EVENT_TIMEOUT_T1_COOKIE { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_bug), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_t1_cookie_timer_expire), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">}</span>

<span class="cp">#define TYPE_SCTP_EVENT_TIMEOUT_T1_INIT { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_t1_init_timer_expire), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">}</span>

<span class="cp">#define TYPE_SCTP_EVENT_TIMEOUT_T2_SHUTDOWN { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_t2_timer_expire), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_t2_timer_expire), \</span>
<span class="cp">}</span>

<span class="cp">#define TYPE_SCTP_EVENT_TIMEOUT_T3_RTX { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_6_3_3_rtx), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_6_3_3_rtx), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_6_3_3_rtx), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_6_3_3_rtx), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">}</span>

<span class="cp">#define TYPE_SCTP_EVENT_TIMEOUT_T4_RTO { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_t4_timer_expire), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">}</span>

<span class="cp">#define TYPE_SCTP_EVENT_TIMEOUT_T5_SHUTDOWN_GUARD { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_t5_timer_expire), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_t5_timer_expire), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">}</span>

<span class="cp">#define TYPE_SCTP_EVENT_TIMEOUT_HEARTBEAT { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_sendbeat_8_3), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_sendbeat_8_3), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_sendbeat_8_3), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">}</span>

<span class="cp">#define TYPE_SCTP_EVENT_TIMEOUT_SACK { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_6_2_sack), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_6_2_sack), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_do_6_2_sack), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">}</span>

<span class="cp">#define TYPE_SCTP_EVENT_TIMEOUT_AUTOCLOSE { \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_CLOSED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_WAIT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_COOKIE_ECHOED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_ESTABLISHED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_autoclose_timer_expire), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_PENDING */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_RECEIVED */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">	</span><span class="cm">/* SCTP_STATE_SHUTDOWN_ACK_SENT */</span><span class="cp"> \</span>
<span class="cp">	TYPE_SCTP_FUNC(sctp_sf_timer_ignore), \</span>
<span class="cp">}</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">sctp_sm_table_entry_t</span> <span class="n">timeout_event_table</span><span class="p">[</span><span class="n">SCTP_NUM_TIMEOUT_TYPES</span><span class="p">][</span><span class="n">SCTP_STATE_NUM_STATES</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">TYPE_SCTP_EVENT_TIMEOUT_NONE</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_EVENT_TIMEOUT_T1_COOKIE</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_EVENT_TIMEOUT_T1_INIT</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_EVENT_TIMEOUT_T2_SHUTDOWN</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_EVENT_TIMEOUT_T3_RTX</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_EVENT_TIMEOUT_T4_RTO</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_EVENT_TIMEOUT_T5_SHUTDOWN_GUARD</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_EVENT_TIMEOUT_HEARTBEAT</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_EVENT_TIMEOUT_SACK</span><span class="p">,</span>
	<span class="n">TYPE_SCTP_EVENT_TIMEOUT_AUTOCLOSE</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">sctp_sm_table_entry_t</span> <span class="o">*</span><span class="nf">sctp_chunk_event_lookup</span><span class="p">(</span><span class="n">sctp_cid_t</span> <span class="n">cid</span><span class="p">,</span>
							    <span class="n">sctp_state_t</span> <span class="n">state</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">state</span> <span class="o">&gt;</span> <span class="n">SCTP_STATE_MAX</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">&amp;</span><span class="n">bug</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">cid</span> <span class="o">&lt;=</span> <span class="n">SCTP_CID_BASE_MAX</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">&amp;</span><span class="n">chunk_event_table</span><span class="p">[</span><span class="n">cid</span><span class="p">][</span><span class="n">state</span><span class="p">];</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">sctp_prsctp_enable</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">cid</span> <span class="o">==</span> <span class="n">SCTP_CID_FWD_TSN</span><span class="p">)</span>
			<span class="k">return</span> <span class="o">&amp;</span><span class="n">prsctp_chunk_event_table</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">state</span><span class="p">];</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">sctp_addip_enable</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">cid</span> <span class="o">==</span> <span class="n">SCTP_CID_ASCONF</span><span class="p">)</span>
			<span class="k">return</span> <span class="o">&amp;</span><span class="n">addip_chunk_event_table</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">state</span><span class="p">];</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">cid</span> <span class="o">==</span> <span class="n">SCTP_CID_ASCONF_ACK</span><span class="p">)</span>
			<span class="k">return</span> <span class="o">&amp;</span><span class="n">addip_chunk_event_table</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">state</span><span class="p">];</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">sctp_auth_enable</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">cid</span> <span class="o">==</span> <span class="n">SCTP_CID_AUTH</span><span class="p">)</span>
			<span class="k">return</span> <span class="o">&amp;</span><span class="n">auth_chunk_event_table</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">state</span><span class="p">];</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="o">&amp;</span><span class="n">chunk_event_table_unknown</span><span class="p">[</span><span class="n">state</span><span class="p">];</span>
<span class="p">}</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
