f | ip_set_bitmap_port.c | s | 12K | 435 | David S. Miller | davem@davemloft.net | 1333355621 |  | ipset: Stop using NLA_PUT*().  These macros contain a hidden goto, and are thus extremely error prone and make code hard to audit.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | ip_set_hash_net.c | s | 13K | 477 | David S. Miller | davem@davemloft.net | 1337221057 |  | Merge git://git.kernel.org/pub/scm/linux/kernel/git/davem/net
f | ip_set_getport.c | s | 3.4K | 135 | Jan Engelhardt | jengelh@medozas.de | 1331138429 |  | netfilter: ipset: use NFPROTO_ constants  ipset is actually using NFPROTO values rather than AF (xt_set passes that along).  Signed-off-by: Jan Engelhardt <jengelh@medozas.de> Signed-off-by: Jozsef Kadlecsik <kadlec@blackhole.kfki.hu> Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
f | Makefile | g | 802B |  | Jozsef Kadlecsik | kadlec@blackhole.kfki.hu | 1308243648 |  | netfilter: ipset: hash:net,iface type introduced  The hash:net,iface type makes possible to store network address and interface name pairs in a set. It's mostly suitable for egress and ingress filtering. Examples:          # ipset create test hash:net,iface         # ipset add test 192.168.0.0/16,eth0         # ipset add test 192.168.0.0/24,eth1  Signed-off-by: Jozsef Kadlecsik <kadlec@blackhole.kfki.hu> Signed-off-by: Patrick McHardy <kaber@trash.net>
f | ip_set_core.c | s | 43K | 1529 | Tomasz Bursztyka | tomasz.bursztyka@linux.intel.com | 1340967844 |  | netfilter: ipset: fix crash if IPSET_CMD_NONE command is sent  This patch fixes a crash if that ipset command is sent over nfnetlink.  Signed-off-by: Tomasz Bursztyka <tomasz.bursztyka@linux.intel.com> Acked-by: Jozsef Kadlecsik <kadlec@blackhole.kfki.hu> Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
f | ip_set_hash_ipportnet.c | s | 19K | 624 | David S. Miller | davem@davemloft.net | 1337221057 |  | Merge git://git.kernel.org/pub/scm/linux/kernel/git/davem/net
f | ip_set_bitmap_ipmac.c | s | 16K | 562 | Joe Perches | joe@perches.com | 1336610958 |  | netfilter: Convert compare_ether_addr to ether_addr_equal  Use the new bool function ether_addr_equal to add some clarity and reduce the likelihood for misuse of compare_ether_addr for sorting.  Done via cocci script:  $ cat compare_ether_addr.cocci @@ expression a,b; @@ -	!compare_ether_addr(a, b) +	ether_addr_equal(a, b)  @@ expression a,b; @@ -	compare_ether_addr(a, b) +	!ether_addr_equal(a, b)  @@ expression a,b; @@ -	!ether_addr_equal(a, b) == 0 +	ether_addr_equal(a, b)  @@ expression a,b; @@ -	!ether_addr_equal(a, b) != 0 +	!ether_addr_equal(a, b)  @@ expression a,b; @@ -	ether_addr_equal(a, b) == 0 +	!ether_addr_equal(a, b)  @@ expression a,b; @@ -	ether_addr_equal(a, b) != 0 +	ether_addr_equal(a, b)  @@ expression a,b; @@ -	!!ether_addr_equal(a, b) +	ether_addr_equal(a, b)  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | ip_set_bitmap_ip.c | s | 13K | 494 | David S. Miller | davem@davemloft.net | 1333355621 |  | ipset: Stop using NLA_PUT*().  These macros contain a hidden goto, and are thus extremely error prone and make code hard to audit.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | ip_set_hash_netport.c | s | 17K | 581 | David S. Miller | davem@davemloft.net | 1337221057 |  | Merge git://git.kernel.org/pub/scm/linux/kernel/git/davem/net
f | ip_set_hash_netiface.c | s | 19K | 691 | Florian Westphal | fw@strlen.de | 1340618601 |  | netfilter: ipset: fix interface comparision in hash-netiface sets  ifname_compare() assumes that skb->dev is zero-padded, e.g 'eth1\0\0\0\0\0...'. This isn't always the case. e1000 driver does  strncpy(netdev->name, pci_name(pdev), sizeof(netdev->name) - 1);  in e1000_probe(), so once device is registered dev->name memory contains 'eth1\0:0:3\0\0\0' (or something like that), which makes eth1 compare fail.  Use plain strcmp() instead.  Signed-off-by: Florian Westphal <fw@strlen.de> Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
f | ip_set_list_set.c | s | 14K | 535 | David S. Miller | davem@davemloft.net | 1333355621 |  | ipset: Stop using NLA_PUT*().  These macros contain a hidden goto, and are thus extremely error prone and make code hard to audit.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | Kconfig | g | 3.9K |  | Jozsef Kadlecsik | kadlec@blackhole.kfki.hu | 1308243648 |  | netfilter: ipset: hash:net,iface type introduced  The hash:net,iface type makes possible to store network address and interface name pairs in a set. It's mostly suitable for egress and ingress filtering. Examples:          # ipset create test hash:net,iface         # ipset add test 192.168.0.0/16,eth0         # ipset add test 192.168.0.0/24,eth1  Signed-off-by: Jozsef Kadlecsik <kadlec@blackhole.kfki.hu> Signed-off-by: Patrick McHardy <kaber@trash.net>
f | ip_set_hash_ipportip.c | s | 14K | 485 | David S. Miller | davem@davemloft.net | 1337221057 |  | Merge git://git.kernel.org/pub/scm/linux/kernel/git/davem/net
f | ip_set_hash_ip.c | s | 11K | 401 | David S. Miller | davem@davemloft.net | 1337221057 |  | Merge git://git.kernel.org/pub/scm/linux/kernel/git/davem/net
f | ip_set_hash_ipport.c | s | 13K | 469 | David S. Miller | davem@davemloft.net | 1337221057 |  | Merge git://git.kernel.org/pub/scm/linux/kernel/git/davem/net
f | pfxlen.c | s | 14K | 306 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103830 |  | net: Add export.h for EXPORT_SYMBOL/THIS_MODULE to non-modules  These files are non modular, but need to export symbols using the macros now living in export.h -- call out the include so that things won't break when we remove the implicit presence of module.h from everywhere.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
