f | reg.h | s | 4.4K | 92 | Luis R. Rodriguez | mcgrof@qca.qualcomm.com | 1325705441 |  | cfg80211: relicense reg.c reg.h and genregdb.awk to ISC  Following the tradition we have had with ath5k, ath9k, CRDA, wireless-regdb I'd like to license this code under the permissive ISC license for the code sharing purposes with other OSes, it'd sure be nice to help the landscape in this area. Although I am %82.89 owner of the regulatory code I have asked every contributor to the regulatory code and have receieved positive Acked-bys from everyone except two deceased entities:   o Frans Pop RIP 2010 [0] 	- Frans Pop <elendil@planet.nl> 	- Frans Pop <fjp@debian.org>  o Nokia     RIP February, 11, 2011 [1], [2] 	- ext-yuri.ershov@nokia.com 	- kalle.valo@nokia.com  Frans Pop's contribution was a simple patch 55f98938, titled, "wireless: remove trailing space in messages" which just add a \n to some printk lines. I'm going to treat these additions as uncopyrightable.  As for the contributions made by employees on behalf of Nokia my contact point was Petri Karhula <petri.karhula@nokia.com> but after one month he noted he had not been able to get traction from the legal department on this request, as such it I proceeded by replacing their contributions in previous patches.  The end goal is to help a clean rewrite that starts in userspace that is shared under ISC license which currently is taking place with the regulatory simulator [3].  [0] http://lists.debian.org/debian-devel/2011/12/msg00263.html [1] http://press.nokia.com/2011/02/11/nokia-outlines-new-strategy-introduces-new-leadership-operational-structure/ [2] http://NokiaPlanB.com [3] git://github.com/mcgrof/regsim.git  Acked-by: Thadeu Lima de Souza Cascardo <cascardo@holoscopio.com> Acked-by: Dan Carpenter <error27@gmail.com> Acked-by: Mihai Moldovan <ionic@ionic.de> Acked-by: Uwe Kleine-König <u.kleine-koenig@pengutronix.de> Acked-by: Sven Neumann <s.neumann@raumfeld.com> Acked-by: Johannes Berg <johannes@sipsolutions.net> Acked-by: Tomas Winkler <tomas.winkler@intel.com> Acked-by: Tony Vroon <tony@linx.net> Acked-by: Pavel Roskin <proski@gnu.org> Acked-by: Bob Copeland <me@bobcopeland.com> Acked-by: Lucas De Marchi <lucas.demarchi@profusion.mobi> Acked-by: Pat Erley <pat-lkml@erley.org> Acked-by: Tejun Heo <tj@kernel.org> Acked-by: John W. Linville <linville@tuxdriver.com> Acked-by: Chris Wright <chrisw@sous-sol.org> Acked-by: Joe Perches <joe@perches.com> Acked-by: Paul Gortmaker <paul.gortmaker@windriver.com> Acked-by: John Gordon <john@devicescape.com> Acked-by: Simon Barber <protocolmagic@gmail.com> Acked-by: Rajkumar Manoharan <rmanohar@qca.qualcomm.com> Acked-by: Jiri Benc <jbenc@upir.cz> Acked-by: Bruno Randolf <br1@einfach.org> Acked-by: Scott James Remnant <keybuk@google.com> Acked-by: Roel Kluin <roel.kluin@gmail.com> Signed-off-by: Luis R. Rodriguez <mcgrof@qca.qualcomm.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | ethtool.c | s | 3.1K | 88 | Ben Greear | greearb@candelatech.com | 1336528429 |  | cfg80211: Add framework to support ethtool stats.  Signed-off-by: Ben Greear <greearb@candelatech.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | Makefile | g | 858B |  | Johannes Berg | johannes.berg@intel.com | 1291669289 |  | cfg80211/mac80211: add mesh join/leave commands  Instead of tying mesh activity to interface up, add join and leave commands for mesh. Since we must be backward compatible, let cfg80211 handle joining a mesh if a mesh ID was pre-configured when the device goes up.  Note that this therefore must modify mac80211 as well since mac80211 needs to lose the logic to start the mesh on interface up.  We now allow querying mesh parameters before the mesh is connected, which simply returns defaults. Setting them (internally renamed to "update") is only allowed while connected. Specify them with the new mesh join command instead where needed.  In mac80211, beaconing must now also follow the mesh enabled/not enabled state, which is done by testing the mesh ID.  Signed-off-by: Javier Cardona <javier@cozybit.com> Signed-off-by: Johannes Berg <johannes.berg@intel.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | regdb.h | s | 948B | 20 | Luis R. Rodriguez | mcgrof@qca.qualcomm.com | 1325705441 |  | cfg80211: relicense reg.c reg.h and genregdb.awk to ISC  Following the tradition we have had with ath5k, ath9k, CRDA, wireless-regdb I'd like to license this code under the permissive ISC license for the code sharing purposes with other OSes, it'd sure be nice to help the landscape in this area. Although I am %82.89 owner of the regulatory code I have asked every contributor to the regulatory code and have receieved positive Acked-bys from everyone except two deceased entities:   o Frans Pop RIP 2010 [0] 	- Frans Pop <elendil@planet.nl> 	- Frans Pop <fjp@debian.org>  o Nokia     RIP February, 11, 2011 [1], [2] 	- ext-yuri.ershov@nokia.com 	- kalle.valo@nokia.com  Frans Pop's contribution was a simple patch 55f98938, titled, "wireless: remove trailing space in messages" which just add a \n to some printk lines. I'm going to treat these additions as uncopyrightable.  As for the contributions made by employees on behalf of Nokia my contact point was Petri Karhula <petri.karhula@nokia.com> but after one month he noted he had not been able to get traction from the legal department on this request, as such it I proceeded by replacing their contributions in previous patches.  The end goal is to help a clean rewrite that starts in userspace that is shared under ISC license which currently is taking place with the regulatory simulator [3].  [0] http://lists.debian.org/debian-devel/2011/12/msg00263.html [1] http://press.nokia.com/2011/02/11/nokia-outlines-new-strategy-introduces-new-leadership-operational-structure/ [2] http://NokiaPlanB.com [3] git://github.com/mcgrof/regsim.git  Acked-by: Thadeu Lima de Souza Cascardo <cascardo@holoscopio.com> Acked-by: Dan Carpenter <error27@gmail.com> Acked-by: Mihai Moldovan <ionic@ionic.de> Acked-by: Uwe Kleine-König <u.kleine-koenig@pengutronix.de> Acked-by: Sven Neumann <s.neumann@raumfeld.com> Acked-by: Johannes Berg <johannes@sipsolutions.net> Acked-by: Tomas Winkler <tomas.winkler@intel.com> Acked-by: Tony Vroon <tony@linx.net> Acked-by: Pavel Roskin <proski@gnu.org> Acked-by: Bob Copeland <me@bobcopeland.com> Acked-by: Lucas De Marchi <lucas.demarchi@profusion.mobi> Acked-by: Pat Erley <pat-lkml@erley.org> Acked-by: Tejun Heo <tj@kernel.org> Acked-by: John W. Linville <linville@tuxdriver.com> Acked-by: Chris Wright <chrisw@sous-sol.org> Acked-by: Joe Perches <joe@perches.com> Acked-by: Paul Gortmaker <paul.gortmaker@windriver.com> Acked-by: John Gordon <john@devicescape.com> Acked-by: Simon Barber <protocolmagic@gmail.com> Acked-by: Rajkumar Manoharan <rmanohar@qca.qualcomm.com> Acked-by: Jiri Benc <jbenc@upir.cz> Acked-by: Bruno Randolf <br1@einfach.org> Acked-by: Scott James Remnant <keybuk@google.com> Acked-by: Roel Kluin <roel.kluin@gmail.com> Signed-off-by: Luis R. Rodriguez <mcgrof@qca.qualcomm.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | sme.c | s | 26K | 857 | Johannes Berg | johannes.berg@intel.com | 1328557837 |  | cfg80211: stop tracking authenticated state  To track authenticated state seems to have been a design mistake in cfg80211. It is possible to have out of band authentication (FT), tracking multiple authentications caused more problems than it ever helped, and the implementation in mac80211 is too complex.  Remove all this complexity, and let userspace do whatever it wants to, mac80211 can deal with that just fine. Association is still tracked of course, but authentication no longer is. Local auth state changes are thus no longer of value, so ignore them completely.  This will also help implement SAE -- asking the driver to do an authentication is now almost equivalent to sending an authentication frame, with the exception of shared key authentication which is still handled completely.  Signed-off-by: Johannes Berg <johannes.berg@intel.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | reg.c | s | 62K | 2004 | Eliad Peller | eliad@wizery.com | 1339575473 |  | cfg80211: fix potential deadlock in regulatory  reg_timeout_work() calls restore_regulatory_settings() which takes cfg80211_mutex.  reg_set_request_processed() already holds cfg80211_mutex before calling cancel_delayed_work_sync(reg_timeout), so it might deadlock.  Call the async cancel_delayed_work instead, in order to avoid the potential deadlock.  This is the relevant lockdep warning:  cfg80211: Calling CRDA for country: XX  ====================================================== [ INFO: possible circular locking dependency detected ] 3.4.0-rc5-wl+ #26 Not tainted ------------------------------------------------------- kworker/0:2/1391 is trying to acquire lock:  (cfg80211_mutex){+.+.+.}, at: [<bf28ae00>] restore_regulatory_settings+0x34/0x418 [cfg80211]  but task is already holding lock:  ((reg_timeout).work){+.+...}, at: [<c0059e94>] process_one_work+0x1f0/0x480  which lock already depends on the new lock.  the existing dependency chain (in reverse order) is:  -> #2 ((reg_timeout).work){+.+...}:        [<c008fd44>] validate_chain+0xb94/0x10f0        [<c0090b68>] __lock_acquire+0x8c8/0x9b0        [<c0090d40>] lock_acquire+0xf0/0x114        [<c005b600>] wait_on_work+0x4c/0x154        [<c005c000>] __cancel_work_timer+0xd4/0x11c        [<c005c064>] cancel_delayed_work_sync+0x1c/0x20        [<bf28b274>] reg_set_request_processed+0x50/0x78 [cfg80211]        [<bf28bd84>] set_regdom+0x550/0x600 [cfg80211]        [<bf294cd8>] nl80211_set_reg+0x218/0x258 [cfg80211]        [<c03c7738>] genl_rcv_msg+0x1a8/0x1e8        [<c03c6a00>] netlink_rcv_skb+0x5c/0xc0        [<c03c7584>] genl_rcv+0x28/0x34        [<c03c6720>] netlink_unicast+0x15c/0x228        [<c03c6c7c>] netlink_sendmsg+0x218/0x298        [<c03933c8>] sock_sendmsg+0xa4/0xc0        [<c039406c>] __sys_sendmsg+0x1e4/0x268        [<c0394228>] sys_sendmsg+0x4c/0x70        [<c0013840>] ret_fast_syscall+0x0/0x3c  -> #1 (reg_mutex){+.+.+.}:        [<c008fd44>] validate_chain+0xb94/0x10f0        [<c0090b68>] __lock_acquire+0x8c8/0x9b0        [<c0090d40>] lock_acquire+0xf0/0x114        [<c04734dc>] mutex_lock_nested+0x48/0x320        [<bf28b2cc>] reg_todo+0x30/0x538 [cfg80211]        [<c0059f44>] process_one_work+0x2a0/0x480        [<c005a4b4>] worker_thread+0x1bc/0x2bc        [<c0061148>] kthread+0x98/0xa4        [<c0014af4>] kernel_thread_exit+0x0/0x8  -> #0 (cfg80211_mutex){+.+.+.}:        [<c008ed58>] print_circular_bug+0x68/0x2cc        [<c008fb28>] validate_chain+0x978/0x10f0        [<c0090b68>] __lock_acquire+0x8c8/0x9b0        [<c0090d40>] lock_acquire+0xf0/0x114        [<c04734dc>] mutex_lock_nested+0x48/0x320        [<bf28ae00>] restore_regulatory_settings+0x34/0x418 [cfg80211]        [<bf28b200>] reg_timeout_work+0x1c/0x20 [cfg80211]        [<c0059f44>] process_one_work+0x2a0/0x480        [<c005a4b4>] worker_thread+0x1bc/0x2bc        [<c0061148>] kthread+0x98/0xa4        [<c0014af4>] kernel_thread_exit+0x0/0x8  other info that might help us debug this:  Chain exists of:   cfg80211_mutex --> reg_mutex --> (reg_timeout).work   Possible unsafe locking scenario:         CPU0                    CPU1        ----                    ----   lock((reg_timeout).work);                                lock(reg_mutex);                                lock((reg_timeout).work);   lock(cfg80211_mutex);   *** DEADLOCK ***  2 locks held by kworker/0:2/1391:  #0:  (events){.+.+.+}, at: [<c0059e94>] process_one_work+0x1f0/0x480  #1:  ((reg_timeout).work){+.+...}, at: [<c0059e94>] process_one_work+0x1f0/0x480  stack backtrace: [<c001b928>] (unwind_backtrace+0x0/0x12c) from [<c0471d3c>] (dump_stack+0x20/0x24) [<c0471d3c>] (dump_stack+0x20/0x24) from [<c008ef70>] (print_circular_bug+0x280/0x2cc) [<c008ef70>] (print_circular_bug+0x280/0x2cc) from [<c008fb28>] (validate_chain+0x978/0x10f0) [<c008fb28>] (validate_chain+0x978/0x10f0) from [<c0090b68>] (__lock_acquire+0x8c8/0x9b0) [<c0090b68>] (__lock_acquire+0x8c8/0x9b0) from [<c0090d40>] (lock_acquire+0xf0/0x114) [<c0090d40>] (lock_acquire+0xf0/0x114) from [<c04734dc>] (mutex_lock_nested+0x48/0x320) [<c04734dc>] (mutex_lock_nested+0x48/0x320) from [<bf28ae00>] (restore_regulatory_settings+0x34/0x418 [cfg80211]) [<bf28ae00>] (restore_regulatory_settings+0x34/0x418 [cfg80211]) from [<bf28b200>] (reg_timeout_work+0x1c/0x20 [cfg80211]) [<bf28b200>] (reg_timeout_work+0x1c/0x20 [cfg80211]) from [<c0059f44>] (process_one_work+0x2a0/0x480) [<c0059f44>] (process_one_work+0x2a0/0x480) from [<c005a4b4>] (worker_thread+0x1bc/0x2bc) [<c005a4b4>] (worker_thread+0x1bc/0x2bc) from [<c0061148>] (kthread+0x98/0xa4) [<c0061148>] (kthread+0x98/0xa4) from [<c0014af4>] (kernel_thread_exit+0x0/0x8) cfg80211: Calling CRDA to update world regulatory domain cfg80211: World regulatory domain updated: cfg80211:   (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp) cfg80211:   (2402000 KHz - 2472000 KHz @ 40000 KHz), (300 mBi, 2000 mBm) cfg80211:   (2457000 KHz - 2482000 KHz @ 20000 KHz), (300 mBi, 2000 mBm) cfg80211:   (2474000 KHz - 2494000 KHz @ 20000 KHz), (300 mBi, 2000 mBm) cfg80211:   (5170000 KHz - 5250000 KHz @ 40000 KHz), (300 mBi, 2000 mBm) cfg80211:   (5735000 KHz - 5835000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)  Cc: stable@kernel.org Signed-off-by: Eliad Peller <eliad@wizery.com> Signed-off-by: Johannes Berg <johannes.berg@intel.com>
f | wext-sme.c | s | 9.2K | 331 | Joe Perches | joe@perches.com | 1336610959 |  | wireless: Convert compare_ether_addr to ether_addr_equal  Use the new bool function ether_addr_equal to add some clarity and reduce the likelihood for misuse of compare_ether_addr for sorting.  I removed a conversion from scan.c/cmp_bss_core that appears to be a sorting function.  Done via cocci script:  $ cat compare_ether_addr.cocci @@ expression a,b; @@ -	!compare_ether_addr(a, b) +	ether_addr_equal(a, b)  @@ expression a,b; @@ -	compare_ether_addr(a, b) +	!ether_addr_equal(a, b)  @@ expression a,b; @@ -	!ether_addr_equal(a, b) == 0 +	ether_addr_equal(a, b)  @@ expression a,b; @@ -	!ether_addr_equal(a, b) != 0 +	!ether_addr_equal(a, b)  @@ expression a,b; @@ -	ether_addr_equal(a, b) == 0 +	!ether_addr_equal(a, b)  @@ expression a,b; @@ -	ether_addr_equal(a, b) != 0 +	ether_addr_equal(a, b)  @@ expression a,b; @@ -	!!ether_addr_equal(a, b) +	ether_addr_equal(a, b)  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | debugfs.h | s | 300B | 9 | Johannes Berg | johannes@sipsolutions.net | 1256935758 |  | cfg80211/mac80211: use debugfs_remove_recursive  We can save a lot of code and pointers in the structs by using debugfs_remove_recursive().  First, change cfg80211 to use debugfs_remove_recursive() so that drivers do not need to clean up any files they added to the per-wiphy debugfs (if and only if they are ok to be accessed until after wiphy_unregister!).  Then also make mac80211 use debugfs_remove_recursive() where necessary -- it need not remove per-wiphy files as cfg80211 now removes those, but netdev etc. files still need to be handled but can now be removed without needing struct dentry pointers to all of them.  Signed-off-by: Johannes Berg <johannes@sipsolutions.net> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | util.c | s | 26K | 918 | Michal Kazior | michal.kazior@tieto.com | 1339230716 |  | cfg80211: check iface combinations only when iface is running  Don't validate interface combinations on a stopped interface. Otherwise we might end up being able to create a new interface with a certain type, but won't be able to change an existing interface into that type.  This also skips some other functions when interface is stopped and changing interface type.  Signed-off-by: Michal Kazior <michal.kazior@tieto.com> Signed-off-by: Johannes Berg <johannes.berg@intel.com>
f | ibss.c | s | 12K | 423 | Amitkumar Karwar | akarwar@marvell.com | 1338837688 |  | cfg80211: use sme_state in ibss start/join path  CFG80211_DEV_WARN_ON() at "net/wireless/ibss.c line 63" is unnecessarily triggered even after successful connection, when cfg80211_ibss_joined() is called by driver inside .join_ibss handler.  This patch fixes the problem by changing 'sme_state' in ibss path and having WARN_ON() check for 'sme_state' similar to infra association.  Signed-off-by: Amitkumar Karwar <akarwar@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | nl80211.c | s | 216K | 6927 | Johannes Berg | johannes.berg@intel.com | 1337188096 |  | nl80211: refactor valid channel type check  There are four instances in nl80211 of getting the channel type from the attribute and validating it, refactor those.  Signed-off-by: Johannes Berg <johannes.berg@intel.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | radiotap.c | s | 11K | 314 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103830 |  | net: Add export.h for EXPORT_SYMBOL/THIS_MODULE to non-modules  These files are non modular, but need to export symbols using the macros now living in export.h -- call out the include so that things won't break when we remove the implicit presence of module.h from everywhere.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | scan.c | s | 33K | 1138 | David S. Miller | davem@davemloft.net | 1337032848 |  | Merge branch 'master' of git://git.kernel.org/pub/scm/linux/kernel/git/linville/wireless-next
f | lib80211.c | s | 7.1K | 238 | Pavel Roskin | proski@gnu.org | 1312918956 |  | lib80211: remove exports for functions not called by other modules  Signed-off-by: Pavel Roskin <proski@gnu.org> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | wext-proc.c | s | 4.0K | 133 | Alexey Dobriyan | adobriyan@gmail.com | 1263784562 |  | net: spread __net_init, __net_exit  __net_init/__net_exit are apparently not going away, so use them to full extent.  In some cases __net_init was removed, because it was called from __net_exit code.  Signed-off-by: Alexey Dobriyan <adobriyan@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | wext-compat.h | s | 2.1K | 49 | Johannes Berg | johannes.berg@intel.com | 1312827989 |  | cfg80211: remove unused wext handler exports  A lot of code is dedicated to giving drivers the ability to use cfg80211's wext handlers without completely converting. However, only orinoco is currently using this, and it is only partially using it.  We reduce the size of both the source and binary by removing those that nobody needs. If a driver shows up that needs it during conversion, we can add back those that are needed.  Signed-off-by: Johannes Berg <johannes.berg@intel.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | wext-core.c | s | 28K | 969 | Eric Dumazet | eric.dumazet@gmail.com | 1334508280 |  | net: cleanup unsigned to unsigned int  Use of "unsigned int" is preferred to bare "unsigned" in net tree.  Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | core.h | s | 14K | 407 | Johannes Berg | johannes.berg@intel.com | 1337186793 |  | cfg80211: remove double prototype  cfg80211_calculate_bitrate() is defined in the external header file cfg80211.h now, so no need to keep it in the internal one as well.  Signed-off-by: Johannes Berg <johannes.berg@intel.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | lib80211_crypt_ccmp.c | s | 11K | 407 | Joe Perches | joe@perches.com | 1337103903 |  | net: Convert net_ratelimit uses to net_<level>_ratelimited  Standardize the net core ratelimited logging functions.  Coalesce formats, align arguments. Change a printk then vprintk sequence to use printf extension %pV.  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | sysfs.h | s | 197B | 6 | Johannes Berg | johannes@sipsolutions.net | 1177565381 |  | [WIRELESS] cfg80211: New wireless config infrastructure.  This patch creates the core cfg80211 code along with some sysfs bits. This is a stripped down version to allow mac80211 to function, but doesn't include any configuration yet except for creating and removing virtual interfaces.  This patch includes the nl80211 header file but it only contains the interface types which the cfg80211 interface for creating virtual interfaces relies on.  Signed-off-by: Johannes Berg <johannes@sipsolutions.net> Signed-off-by: John W. Linville <linville@tuxdriver.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | wext-compat.c | s | 38K | 1296 | Pontus Fuchs | pontus.fuchs@gmail.com | 1334341969 |  | cfg80211: Add channel information to NL80211_CMD_GET_INTERFACE  If the current channel is known, add frequency and channel type to NL80211_CMD_GET_INTERFACE.  Signed-off-by: Pontus Fuchs <pontus.fuchs@gmail.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | chan.c | s | 3.2K | 113 | Johannes Berg | johannes.berg@intel.com | 1337188095 |  | cfg80211: fix cfg80211_can_beacon_sec_chan prototype  It should return bool, not int. The function even does return true/false.  Signed-off-by: Johannes Berg <johannes.berg@intel.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | wext-spy.c | s | 6.6K | 201 | Joe Perches | joe@perches.com | 1336610959 |  | wireless: Convert compare_ether_addr to ether_addr_equal  Use the new bool function ether_addr_equal to add some clarity and reduce the likelihood for misuse of compare_ether_addr for sorting.  I removed a conversion from scan.c/cmp_bss_core that appears to be a sorting function.  Done via cocci script:  $ cat compare_ether_addr.cocci @@ expression a,b; @@ -	!compare_ether_addr(a, b) +	ether_addr_equal(a, b)  @@ expression a,b; @@ -	compare_ether_addr(a, b) +	!ether_addr_equal(a, b)  @@ expression a,b; @@ -	!ether_addr_equal(a, b) == 0 +	ether_addr_equal(a, b)  @@ expression a,b; @@ -	!ether_addr_equal(a, b) != 0 +	!ether_addr_equal(a, b)  @@ expression a,b; @@ -	ether_addr_equal(a, b) == 0 +	!ether_addr_equal(a, b)  @@ expression a,b; @@ -	ether_addr_equal(a, b) != 0 +	ether_addr_equal(a, b)  @@ expression a,b; @@ -	!!ether_addr_equal(a, b) +	ether_addr_equal(a, b)  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | db.txt | g | 759B |  | John W. Linville | linville@tuxdriver.com | 1261439770 |  | wireless: support internal statically compiled regulatory database  This patch provides infrastructure for machine translation of the regulatory rules database used by CRDA into a C data structure. It includes code for searching that database as an alternative to dynamic regulatory rules updates via CRDA.  Most people should use CRDA instead of this infrastructure, but it provides a better alternative than the WIRELESS_OLD_REGULATORY infrastructure (which can now be removed).  Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | nl80211.h | s | 5.4K | 116 | Thomas Pedersen | c_tpeder@qca.qualcomm.com | 1334175839 |  | cfg80211: add channel switch notify event  The firmware may decide to switch channels while already beaconing, e.g. in response to a cfg80211 connect request on a different vif. Add this event to notify userspace when an AP or GO interface has successfully migrated to a new channel, so it can update its configuration accordingly.  Signed-off-by: Thomas Pedersen <c_tpeder@qca.qualcomm.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | sysfs.c | s | 3.4K | 126 | Stanislaw Gruszka | sgruszka@redhat.com | 1314037300 |  | mac80211: fix suspend/resume races with unregister hw  Do not call ->suspend, ->resume methods after we unregister wiphy. Also delete sta_clanup timer after we finish wiphy unregister to avoid this:  WARNING: at lib/debugobjects.c:262 debug_print_object+0x85/0xa0() Hardware name: 6369CTO ODEBUG: free active (active state 0) object type: timer_list hint: sta_info_cleanup+0x0/0x180 [mac80211] Modules linked in: aes_i586 aes_generic fuse bridge stp llc autofs4 sunrpc cpufreq_ondemand acpi_cpufreq mperf ext2 dm_mod uinput thinkpad_acpi hwmon sg arc4 rt2800usb rt2800lib crc_ccitt rt2x00usb rt2x00lib mac80211 cfg80211 i2c_i801 iTCO_wdt iTCO_vendor_support e1000e ext4 mbcache jbd2 sd_mod crc_t10dif sr_mod cdrom yenta_socket ahci libahci pata_acpi ata_generic ata_piix i915 drm_kms_helper drm i2c_algo_bit video [last unloaded: microcode] Pid: 5663, comm: pm-hibernate Not tainted 3.1.0-rc1-wl+ #19 Call Trace:  [<c0454cfd>] warn_slowpath_common+0x6d/0xa0  [<c05e05e5>] ? debug_print_object+0x85/0xa0  [<c05e05e5>] ? debug_print_object+0x85/0xa0  [<c0454dae>] warn_slowpath_fmt+0x2e/0x30  [<c05e05e5>] debug_print_object+0x85/0xa0  [<f8a808e0>] ? sta_info_alloc+0x1a0/0x1a0 [mac80211]  [<c05e0bd2>] debug_check_no_obj_freed+0xe2/0x180  [<c051175b>] kfree+0x8b/0x150  [<f8a126ae>] cfg80211_dev_free+0x7e/0x90 [cfg80211]  [<f8a13afd>] wiphy_dev_release+0xd/0x10 [cfg80211]  [<c068d959>] device_release+0x19/0x80  [<c05d06ba>] kobject_release+0x7a/0x1c0  [<c07646a8>] ? rtnl_unlock+0x8/0x10  [<f8a13adb>] ? wiphy_resume+0x6b/0x80 [cfg80211]  [<c05d0640>] ? kobject_del+0x30/0x30  [<c05d1a6d>] kref_put+0x2d/0x60  [<c05d056d>] kobject_put+0x1d/0x50  [<c08015f4>] ? mutex_lock+0x14/0x40  [<c068d60f>] put_device+0xf/0x20  [<c069716a>] dpm_resume+0xca/0x160  [<c04912bd>] hibernation_snapshot+0xcd/0x260  [<c04903df>] ? freeze_processes+0x3f/0x90  [<c049151b>] hibernate+0xcb/0x1e0  [<c048fdc0>] ? pm_async_store+0x40/0x40  [<c048fe60>] state_store+0xa0/0xb0  [<c048fdc0>] ? pm_async_store+0x40/0x40  [<c05d0200>] kobj_attr_store+0x20/0x30  [<c0575ea4>] sysfs_write_file+0x94/0xf0  [<c051e26a>] vfs_write+0x9a/0x160  [<c0575e10>] ? sysfs_open_file+0x200/0x200  [<c051e3fd>] sys_write+0x3d/0x70  [<c080959f>] sysenter_do_call+0x12/0x28  Cc: stable@kernel.org Signed-off-by: Stanislaw Gruszka <sgruszka@redhat.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | Kconfig | g | 4.2K |  | Johannes Berg | johannes.berg@intel.com | 1323289179 |  | wireless: disable wext sysfs by default  This code has been on the list to remove for a long time, so disable it by default, add a warning to its Kconfig, and schedule it for removal in 3.5.  The only known dependency, hal, has not required it since its 0.5.12 release, which was in early 2009 and hal has since been deprecated completely.  Signed-off-by: Johannes Berg <johannes.berg@intel.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | debugfs.c | s | 3.0K | 97 | Stephen Boyd | sboyd@codeaurora.org | 1333664750 |  | simple_open: automatically convert to simple_open()  Many users of debugfs copy the implementation of default_open() when they want to support a custom read/write function op.  This leads to a proliferation of the default_open() implementation across the entire tree.  Now that the common implementation has been consolidated into libfs we can replace all the users of this function with simple_open().  This replacement was done with the following semantic patch:  <smpl> @ open @ identifier open_f != simple_open; identifier i, f; @@ -int open_f(struct inode *i, struct file *f) -{ ( -if (i->i_private) -f->private_data = i->i_private; || -f->private_data = i->i_private; ) -return 0; -}  @ has_open depends on open @ identifier fops; identifier open.open_f; @@ struct file_operations fops = { ... -.open = open_f, +.open = simple_open, ... }; </smpl>  [akpm@linux-foundation.org: checkpatch fixes] Signed-off-by: Stephen Boyd <sboyd@codeaurora.org> Cc: Greg Kroah-Hartman <gregkh@linuxfoundation.org> Cc: Al Viro <viro@zeniv.linux.org.uk> Cc: Julia Lawall <Julia.Lawall@lip6.fr> Acked-by: Ingo Molnar <mingo@elte.hu> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | mlme.c | s | 26K | 797 | Joe Perches | joe@perches.com | 1336610959 |  | wireless: Convert compare_ether_addr to ether_addr_equal  Use the new bool function ether_addr_equal to add some clarity and reduce the likelihood for misuse of compare_ether_addr for sorting.  I removed a conversion from scan.c/cmp_bss_core that appears to be a sorting function.  Done via cocci script:  $ cat compare_ether_addr.cocci @@ expression a,b; @@ -	!compare_ether_addr(a, b) +	ether_addr_equal(a, b)  @@ expression a,b; @@ -	compare_ether_addr(a, b) +	!ether_addr_equal(a, b)  @@ expression a,b; @@ -	!ether_addr_equal(a, b) == 0 +	ether_addr_equal(a, b)  @@ expression a,b; @@ -	!ether_addr_equal(a, b) != 0 +	!ether_addr_equal(a, b)  @@ expression a,b; @@ -	ether_addr_equal(a, b) == 0 +	!ether_addr_equal(a, b)  @@ expression a,b; @@ -	ether_addr_equal(a, b) != 0 +	ether_addr_equal(a, b)  @@ expression a,b; @@ -	!!ether_addr_equal(a, b) +	ether_addr_equal(a, b)  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | mesh.c | s | 4.6K | 140 | Ashok Nagarajan | ashok@cozybit.com | 1336528439 |  | {nl,cfg,mac}80211: Allow user to see/configure HT protection mode  This patch introduces a new mesh configuration parameter "ht_opmode" and will allow user to check the current HT protection mode selected. Users could configure the protection mode by the command "iw mesh_iface set mesh_param mesh_ht_protection_mode=2". The default protection mode of mesh is set to non-HT mixed mode.  Signed-off-by: Ashok Nagarajan <ashok@cozybit.com> Reviewed-by: Thomas Pedersen <thomas@cozybit.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | wext-priv.c | s | 6.9K | 210 | Johannes Berg | johannes.berg@intel.com | 1285004500 |  | wext: fix potential private ioctl memory content leak  When a driver doesn't fill the entire buffer, old heap contents may remain, and if it also doesn't update the length properly, this old heap content will be copied back to userspace.  It is very unlikely that this happens in any of the drivers using private ioctls since it would show up as junk being reported by iwpriv, but it seems better to be safe here, so use kzalloc.  Reported-by: Jeff Mahoney <jeffm@suse.com> Cc: stable@kernel.org Signed-off-by: Johannes Berg <johannes.berg@intel.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | ethtool.h | s | 148B | 4 | John W. Linville | linville@tuxdriver.com | 1254947989 |  | net/wireless/ethtool.h: drop unnecessary include of linux/ethtool.h  Everything including this header includes net/cfg80211.h, which includes linux/netdevice.h, which includes linux/ethtool.h already.  Why slow-down the build, even a little bit?  Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | core.c | s | 26K | 880 | Cristian Chilipirea | cristian.chilipirea@gmail.com | 1337186792 |  | Net: wireless: core.c: fixed checkpatch warnings  Fixed some checkpatch warnings.  Signed-off-by: Cristian Chilipirea <cristian.chilipirea@gmail.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | lib80211_crypt_tkip.c | s | 20K | 651 | Joe Perches | joe@perches.com | 1337103903 |  | net: Convert net_ratelimit uses to net_<level>_ratelimited  Standardize the net core ratelimited logging functions.  Coalesce formats, align arguments. Change a printk then vprintk sequence to use printf extension %pV.  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | lib80211_crypt_wep.c | s | 7.1K | 239 | Joe Perches | joe@perches.com | 1315943102 |  | wireless: Remove unnecessary OOM logging messages  Removing unnecessary messages saves code and text.  Site specific OOM messages are duplications of a generic MM out of memory message and aren't really useful, so just delete them.  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | genregdb.awk | g | 3.4K |  | Luis R. Rodriguez | mcgrof@qca.qualcomm.com | 1325705441 |  | cfg80211: relicense reg.c reg.h and genregdb.awk to ISC  Following the tradition we have had with ath5k, ath9k, CRDA, wireless-regdb I'd like to license this code under the permissive ISC license for the code sharing purposes with other OSes, it'd sure be nice to help the landscape in this area. Although I am %82.89 owner of the regulatory code I have asked every contributor to the regulatory code and have receieved positive Acked-bys from everyone except two deceased entities:   o Frans Pop RIP 2010 [0] 	- Frans Pop <elendil@planet.nl> 	- Frans Pop <fjp@debian.org>  o Nokia     RIP February, 11, 2011 [1], [2] 	- ext-yuri.ershov@nokia.com 	- kalle.valo@nokia.com  Frans Pop's contribution was a simple patch 55f98938, titled, "wireless: remove trailing space in messages" which just add a \n to some printk lines. I'm going to treat these additions as uncopyrightable.  As for the contributions made by employees on behalf of Nokia my contact point was Petri Karhula <petri.karhula@nokia.com> but after one month he noted he had not been able to get traction from the legal department on this request, as such it I proceeded by replacing their contributions in previous patches.  The end goal is to help a clean rewrite that starts in userspace that is shared under ISC license which currently is taking place with the regulatory simulator [3].  [0] http://lists.debian.org/debian-devel/2011/12/msg00263.html [1] http://press.nokia.com/2011/02/11/nokia-outlines-new-strategy-introduces-new-leadership-operational-structure/ [2] http://NokiaPlanB.com [3] git://github.com/mcgrof/regsim.git  Acked-by: Thadeu Lima de Souza Cascardo <cascardo@holoscopio.com> Acked-by: Dan Carpenter <error27@gmail.com> Acked-by: Mihai Moldovan <ionic@ionic.de> Acked-by: Uwe Kleine-König <u.kleine-koenig@pengutronix.de> Acked-by: Sven Neumann <s.neumann@raumfeld.com> Acked-by: Johannes Berg <johannes@sipsolutions.net> Acked-by: Tomas Winkler <tomas.winkler@intel.com> Acked-by: Tony Vroon <tony@linx.net> Acked-by: Pavel Roskin <proski@gnu.org> Acked-by: Bob Copeland <me@bobcopeland.com> Acked-by: Lucas De Marchi <lucas.demarchi@profusion.mobi> Acked-by: Pat Erley <pat-lkml@erley.org> Acked-by: Tejun Heo <tj@kernel.org> Acked-by: John W. Linville <linville@tuxdriver.com> Acked-by: Chris Wright <chrisw@sous-sol.org> Acked-by: Joe Perches <joe@perches.com> Acked-by: Paul Gortmaker <paul.gortmaker@windriver.com> Acked-by: John Gordon <john@devicescape.com> Acked-by: Simon Barber <protocolmagic@gmail.com> Acked-by: Rajkumar Manoharan <rmanohar@qca.qualcomm.com> Acked-by: Jiri Benc <jbenc@upir.cz> Acked-by: Bruno Randolf <br1@einfach.org> Acked-by: Scott James Remnant <keybuk@google.com> Acked-by: Roel Kluin <roel.kluin@gmail.com> Signed-off-by: Luis R. Rodriguez <mcgrof@qca.qualcomm.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
