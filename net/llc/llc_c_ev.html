<!DOCTYPE html>
<html><head><title>joekychen/linux » net › llc › llc_c_ev.c

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>llc_c_ev.c</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * llc_c_ev.c - Connection component state transition event qualifiers</span>
<span class="cm"> *</span>
<span class="cm"> * A &#39;state&#39; consists of a number of possible event matching functions,</span>
<span class="cm"> * the actions associated with each being executed when that event is</span>
<span class="cm"> * matched; a &#39;state machine&#39; accepts events in a serial fashion from an</span>
<span class="cm"> * event queue. Each event is passed to each successive event matching</span>
<span class="cm"> * function until a match is made (the event matching function returns</span>
<span class="cm"> * success, or &#39;0&#39;) or the list of event matching functions is exhausted.</span>
<span class="cm"> * If a match is made, the actions associated with the event are executed</span>
<span class="cm"> * and the state is changed to that event&#39;s transition state. Before some</span>
<span class="cm"> * events are recognized, even after a match has been made, a certain</span>
<span class="cm"> * number of &#39;event qualifier&#39; functions must also be executed. If these</span>
<span class="cm"> * all execute successfully, then the event is finally executed.</span>
<span class="cm"> *</span>
<span class="cm"> * These event functions must return 0 for success, to show a matched</span>
<span class="cm"> * event, of 1 if the event does not match. Event qualifier functions</span>
<span class="cm"> * must return a 0 for success or a non-zero for failure. Each function</span>
<span class="cm"> * is simply responsible for verifying one single thing and returning</span>
<span class="cm"> * either a success or failure.</span>
<span class="cm"> *</span>
<span class="cm"> * All of followed event functions are described in 802.2 LLC Protocol</span>
<span class="cm"> * standard document except two functions that we added that will explain</span>
<span class="cm"> * in their comments, at below.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (c) 1997 by Procom Technology, Inc.</span>
<span class="cm"> * 		 2001-2003 by Arnaldo Carvalho de Melo &lt;acme@conectiva.com.br&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * This program can be redistributed or modified under the terms of the</span>
<span class="cm"> * GNU General Public License as published by the Free Software Foundation.</span>
<span class="cm"> * This program is distributed without any warranty or implied warranty</span>
<span class="cm"> * of merchantability or fitness for a particular purpose.</span>
<span class="cm"> *</span>
<span class="cm"> * See the GNU General Public License for more details.</span>
<span class="cm"> */</span>
<span class="cp">#include &lt;linux/netdevice.h&gt;</span>
<span class="cp">#include &lt;net/llc_conn.h&gt;</span>
<span class="cp">#include &lt;net/llc_sap.h&gt;</span>
<span class="cp">#include &lt;net/sock.h&gt;</span>
<span class="cp">#include &lt;net/llc_c_ac.h&gt;</span>
<span class="cp">#include &lt;net/llc_c_ev.h&gt;</span>
<span class="cp">#include &lt;net/llc_pdu.h&gt;</span>

<span class="cp">#if 1</span>
<span class="cp">#define dprintk(args...) printk(KERN_DEBUG args)</span>
<span class="cp">#else</span>
<span class="cp">#define dprintk(args...)</span>
<span class="cp">#endif</span>

<span class="cm">/**</span>
<span class="cm"> *	llc_util_ns_inside_rx_window - check if sequence number is in rx window</span>
<span class="cm"> *	@ns: sequence number of received pdu.</span>
<span class="cm"> *	@vr: sequence number which receiver expects to receive.</span>
<span class="cm"> *	@rw: receive window size of receiver.</span>
<span class="cm"> *</span>
<span class="cm"> *	Checks if sequence number of received PDU is in range of receive</span>
<span class="cm"> *	window. Returns 0 for success, 1 otherwise</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="n">u16</span> <span class="nf">llc_util_ns_inside_rx_window</span><span class="p">(</span><span class="n">u8</span> <span class="n">ns</span><span class="p">,</span> <span class="n">u8</span> <span class="n">vr</span><span class="p">,</span> <span class="n">u8</span> <span class="n">rw</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="o">!</span><span class="n">llc_circular_between</span><span class="p">(</span><span class="n">vr</span><span class="p">,</span> <span class="n">ns</span><span class="p">,</span>
				     <span class="p">(</span><span class="n">vr</span> <span class="o">+</span> <span class="n">rw</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">LLC_2_SEQ_NBR_MODULO</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> *	llc_util_nr_inside_tx_window - check if sequence number is in tx window</span>
<span class="cm"> *	@sk: current connection.</span>
<span class="cm"> *	@nr: N(R) of received PDU.</span>
<span class="cm"> *</span>
<span class="cm"> *	This routine checks if N(R) of received PDU is in range of transmit</span>
<span class="cm"> *	window; on the other hand checks if received PDU acknowledges some</span>
<span class="cm"> *	outstanding PDUs that are in transmit window. Returns 0 for success, 1</span>
<span class="cm"> *	otherwise.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="n">u16</span> <span class="nf">llc_util_nr_inside_tx_window</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="n">u8</span> <span class="n">nr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u8</span> <span class="n">nr1</span><span class="p">,</span> <span class="n">nr2</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span><span class="n">pdu</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">llc_sock</span> <span class="o">*</span><span class="n">llc</span> <span class="o">=</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">rc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">llc</span><span class="o">-&gt;</span><span class="n">dev</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">IFF_LOOPBACK</span><span class="p">)</span>
		<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>
	<span class="n">rc</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">skb_queue_empty</span><span class="p">(</span><span class="o">&amp;</span><span class="n">llc</span><span class="o">-&gt;</span><span class="n">pdu_unack_q</span><span class="p">))</span>
		<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>
	<span class="n">skb</span> <span class="o">=</span> <span class="n">skb_peek</span><span class="p">(</span><span class="o">&amp;</span><span class="n">llc</span><span class="o">-&gt;</span><span class="n">pdu_unack_q</span><span class="p">);</span>
	<span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>
	<span class="n">nr1</span> <span class="o">=</span> <span class="n">LLC_I_GET_NS</span><span class="p">(</span><span class="n">pdu</span><span class="p">);</span>
	<span class="n">skb</span> <span class="o">=</span> <span class="n">skb_peek_tail</span><span class="p">(</span><span class="o">&amp;</span><span class="n">llc</span><span class="o">-&gt;</span><span class="n">pdu_unack_q</span><span class="p">);</span>
	<span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>
	<span class="n">nr2</span> <span class="o">=</span> <span class="n">LLC_I_GET_NS</span><span class="p">(</span><span class="n">pdu</span><span class="p">);</span>
	<span class="n">rc</span> <span class="o">=</span> <span class="o">!</span><span class="n">llc_circular_between</span><span class="p">(</span><span class="n">nr1</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="p">(</span><span class="n">nr2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">LLC_2_SEQ_NBR_MODULO</span><span class="p">);</span>
<span class="nl">out:</span>
	<span class="k">return</span> <span class="n">rc</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_conn_req</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_conn_state_ev</span> <span class="o">*</span><span class="n">ev</span> <span class="o">=</span> <span class="n">llc_conn_ev</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">ev</span><span class="o">-&gt;</span><span class="n">prim</span> <span class="o">==</span> <span class="n">LLC_CONN_PRIM</span> <span class="o">&amp;&amp;</span>
	       <span class="n">ev</span><span class="o">-&gt;</span><span class="n">prim_type</span> <span class="o">==</span> <span class="n">LLC_PRIM_TYPE_REQ</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_data_req</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_conn_state_ev</span> <span class="o">*</span><span class="n">ev</span> <span class="o">=</span> <span class="n">llc_conn_ev</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">ev</span><span class="o">-&gt;</span><span class="n">prim</span> <span class="o">==</span> <span class="n">LLC_DATA_PRIM</span> <span class="o">&amp;&amp;</span>
	       <span class="n">ev</span><span class="o">-&gt;</span><span class="n">prim_type</span> <span class="o">==</span> <span class="n">LLC_PRIM_TYPE_REQ</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_disc_req</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_conn_state_ev</span> <span class="o">*</span><span class="n">ev</span> <span class="o">=</span> <span class="n">llc_conn_ev</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">ev</span><span class="o">-&gt;</span><span class="n">prim</span> <span class="o">==</span> <span class="n">LLC_DISC_PRIM</span> <span class="o">&amp;&amp;</span>
	       <span class="n">ev</span><span class="o">-&gt;</span><span class="n">prim_type</span> <span class="o">==</span> <span class="n">LLC_PRIM_TYPE_REQ</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rst_req</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_conn_state_ev</span> <span class="o">*</span><span class="n">ev</span> <span class="o">=</span> <span class="n">llc_conn_ev</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">ev</span><span class="o">-&gt;</span><span class="n">prim</span> <span class="o">==</span> <span class="n">LLC_RESET_PRIM</span> <span class="o">&amp;&amp;</span>
	       <span class="n">ev</span><span class="o">-&gt;</span><span class="n">prim_type</span> <span class="o">==</span> <span class="n">LLC_PRIM_TYPE_REQ</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_local_busy_detected</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_conn_state_ev</span> <span class="o">*</span><span class="n">ev</span> <span class="o">=</span> <span class="n">llc_conn_ev</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">ev</span><span class="o">-&gt;</span><span class="n">type</span> <span class="o">==</span> <span class="n">LLC_CONN_EV_TYPE_SIMPLE</span> <span class="o">&amp;&amp;</span>
	       <span class="n">ev</span><span class="o">-&gt;</span><span class="n">prim_type</span> <span class="o">==</span> <span class="n">LLC_CONN_EV_LOCAL_BUSY_DETECTED</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_local_busy_cleared</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_conn_state_ev</span> <span class="o">*</span><span class="n">ev</span> <span class="o">=</span> <span class="n">llc_conn_ev</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">ev</span><span class="o">-&gt;</span><span class="n">type</span> <span class="o">==</span> <span class="n">LLC_CONN_EV_TYPE_SIMPLE</span> <span class="o">&amp;&amp;</span>
	       <span class="n">ev</span><span class="o">-&gt;</span><span class="n">prim_type</span> <span class="o">==</span> <span class="n">LLC_CONN_EV_LOCAL_BUSY_CLEARED</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_bad_pdu</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_disc_cmd_pbit_set_x</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_un</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_un_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">LLC_PDU_IS_CMD</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_U</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_U_PDU_CMD</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">==</span> <span class="n">LLC_2_PDU_CMD_DISC</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_dm_rsp_fbit_set_x</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_un</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_un_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">LLC_PDU_IS_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_U</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_U_PDU_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">==</span> <span class="n">LLC_2_PDU_RSP_DM</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_frmr_rsp_fbit_set_x</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_un</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_un_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">LLC_PDU_IS_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_U</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_U_PDU_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">==</span> <span class="n">LLC_2_PDU_RSP_FRMR</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_i_cmd_pbit_set_0</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">llc_conn_space</span><span class="p">(</span><span class="n">sk</span><span class="p">,</span> <span class="n">skb</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_PDU_IS_CMD</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_I</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_I_PF_IS_0</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_I_GET_NS</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">==</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">vR</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_i_cmd_pbit_set_1</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">llc_conn_space</span><span class="p">(</span><span class="n">sk</span><span class="p">,</span> <span class="n">skb</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_PDU_IS_CMD</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_I</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_I_PF_IS_1</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_I_GET_NS</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">==</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">vR</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_i_cmd_pbit_set_0_unexpd_ns</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span>
					      <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">u8</span> <span class="n">vr</span> <span class="o">=</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">vR</span><span class="p">;</span>
	<span class="k">const</span> <span class="n">u8</span> <span class="n">ns</span> <span class="o">=</span> <span class="n">LLC_I_GET_NS</span><span class="p">(</span><span class="n">pdu</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">LLC_PDU_IS_CMD</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_I</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_I_PF_IS_0</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">ns</span> <span class="o">!=</span> <span class="n">vr</span> <span class="o">&amp;&amp;</span>
	       <span class="o">!</span><span class="n">llc_util_ns_inside_rx_window</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span> <span class="n">vr</span><span class="p">,</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">rw</span><span class="p">)</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_i_cmd_pbit_set_1_unexpd_ns</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span>
					      <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">u8</span> <span class="n">vr</span> <span class="o">=</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">vR</span><span class="p">;</span>
	<span class="k">const</span> <span class="n">u8</span> <span class="n">ns</span> <span class="o">=</span> <span class="n">LLC_I_GET_NS</span><span class="p">(</span><span class="n">pdu</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">LLC_PDU_IS_CMD</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_I</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_I_PF_IS_1</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">ns</span> <span class="o">!=</span> <span class="n">vr</span> <span class="o">&amp;&amp;</span>
	       <span class="o">!</span><span class="n">llc_util_ns_inside_rx_window</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span> <span class="n">vr</span><span class="p">,</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">rw</span><span class="p">)</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_i_cmd_pbit_set_x_inval_ns</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span>
					     <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span> <span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">u8</span> <span class="n">vr</span> <span class="o">=</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">vR</span><span class="p">;</span>
	<span class="k">const</span> <span class="n">u8</span> <span class="n">ns</span> <span class="o">=</span> <span class="n">LLC_I_GET_NS</span><span class="p">(</span><span class="n">pdu</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">u16</span> <span class="n">rc</span> <span class="o">=</span> <span class="n">LLC_PDU_IS_CMD</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_I</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
		<span class="n">ns</span> <span class="o">!=</span> <span class="n">vr</span> <span class="o">&amp;&amp;</span>
		 <span class="n">llc_util_ns_inside_rx_window</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span> <span class="n">vr</span><span class="p">,</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">rw</span><span class="p">)</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">rc</span><span class="p">)</span>
		<span class="n">dprintk</span><span class="p">(</span><span class="s">&quot;%s: matched, state=%d, ns=%d, vr=%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
			<span class="n">__func__</span><span class="p">,</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">state</span><span class="p">,</span> <span class="n">ns</span><span class="p">,</span> <span class="n">vr</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">rc</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_i_rsp_fbit_set_0</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">llc_conn_space</span><span class="p">(</span><span class="n">sk</span><span class="p">,</span> <span class="n">skb</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_PDU_IS_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_I</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_I_PF_IS_0</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_I_GET_NS</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">==</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">vR</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_i_rsp_fbit_set_1</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">LLC_PDU_IS_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_I</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_I_PF_IS_1</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_I_GET_NS</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">==</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">vR</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_i_rsp_fbit_set_x</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">llc_conn_space</span><span class="p">(</span><span class="n">sk</span><span class="p">,</span> <span class="n">skb</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_PDU_IS_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_I</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_I_GET_NS</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">==</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">vR</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_i_rsp_fbit_set_0_unexpd_ns</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span>
					      <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">u8</span> <span class="n">vr</span> <span class="o">=</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">vR</span><span class="p">;</span>
	<span class="k">const</span> <span class="n">u8</span> <span class="n">ns</span> <span class="o">=</span> <span class="n">LLC_I_GET_NS</span><span class="p">(</span><span class="n">pdu</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">LLC_PDU_IS_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_I</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_I_PF_IS_0</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">ns</span> <span class="o">!=</span> <span class="n">vr</span> <span class="o">&amp;&amp;</span>
	       <span class="o">!</span><span class="n">llc_util_ns_inside_rx_window</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span> <span class="n">vr</span><span class="p">,</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">rw</span><span class="p">)</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_i_rsp_fbit_set_1_unexpd_ns</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span>
					      <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">u8</span> <span class="n">vr</span> <span class="o">=</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">vR</span><span class="p">;</span>
	<span class="k">const</span> <span class="n">u8</span> <span class="n">ns</span> <span class="o">=</span> <span class="n">LLC_I_GET_NS</span><span class="p">(</span><span class="n">pdu</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">LLC_PDU_IS_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_I</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_I_PF_IS_1</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">ns</span> <span class="o">!=</span> <span class="n">vr</span> <span class="o">&amp;&amp;</span>
	       <span class="o">!</span><span class="n">llc_util_ns_inside_rx_window</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span> <span class="n">vr</span><span class="p">,</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">rw</span><span class="p">)</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_i_rsp_fbit_set_x_unexpd_ns</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span>
					      <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">u8</span> <span class="n">vr</span> <span class="o">=</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">vR</span><span class="p">;</span>
	<span class="k">const</span> <span class="n">u8</span> <span class="n">ns</span> <span class="o">=</span> <span class="n">LLC_I_GET_NS</span><span class="p">(</span><span class="n">pdu</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">LLC_PDU_IS_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_I</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">ns</span> <span class="o">!=</span> <span class="n">vr</span> <span class="o">&amp;&amp;</span>
	       <span class="o">!</span><span class="n">llc_util_ns_inside_rx_window</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span> <span class="n">vr</span><span class="p">,</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">rw</span><span class="p">)</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_i_rsp_fbit_set_x_inval_ns</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span>
					     <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">u8</span> <span class="n">vr</span> <span class="o">=</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">vR</span><span class="p">;</span>
	<span class="k">const</span> <span class="n">u8</span> <span class="n">ns</span> <span class="o">=</span> <span class="n">LLC_I_GET_NS</span><span class="p">(</span><span class="n">pdu</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">u16</span> <span class="n">rc</span> <span class="o">=</span> <span class="n">LLC_PDU_IS_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_I</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
		<span class="n">ns</span> <span class="o">!=</span> <span class="n">vr</span> <span class="o">&amp;&amp;</span>
		 <span class="n">llc_util_ns_inside_rx_window</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span> <span class="n">vr</span><span class="p">,</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">rw</span><span class="p">)</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">rc</span><span class="p">)</span>
		<span class="n">dprintk</span><span class="p">(</span><span class="s">&quot;%s: matched, state=%d, ns=%d, vr=%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
			<span class="n">__func__</span><span class="p">,</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">state</span><span class="p">,</span> <span class="n">ns</span><span class="p">,</span> <span class="n">vr</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">rc</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_rej_cmd_pbit_set_0</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">LLC_PDU_IS_CMD</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_S</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_S_PF_IS_0</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_S_PDU_CMD</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">==</span> <span class="n">LLC_2_PDU_CMD_REJ</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_rej_cmd_pbit_set_1</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">LLC_PDU_IS_CMD</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_S</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_S_PF_IS_1</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_S_PDU_CMD</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">==</span> <span class="n">LLC_2_PDU_CMD_REJ</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_rej_rsp_fbit_set_0</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">LLC_PDU_IS_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_S</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_S_PF_IS_0</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_S_PDU_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">==</span> <span class="n">LLC_2_PDU_RSP_REJ</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_rej_rsp_fbit_set_1</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">LLC_PDU_IS_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_S</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_S_PF_IS_1</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_S_PDU_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">==</span> <span class="n">LLC_2_PDU_RSP_REJ</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_rej_rsp_fbit_set_x</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_un</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_un_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">LLC_PDU_IS_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_S</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_S_PDU_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">==</span> <span class="n">LLC_2_PDU_RSP_REJ</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_rnr_cmd_pbit_set_0</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">LLC_PDU_IS_CMD</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_S</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_S_PF_IS_0</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_S_PDU_CMD</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">==</span> <span class="n">LLC_2_PDU_CMD_RNR</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_rnr_cmd_pbit_set_1</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">LLC_PDU_IS_CMD</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_S</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_S_PF_IS_1</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_S_PDU_CMD</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">==</span> <span class="n">LLC_2_PDU_CMD_RNR</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_rnr_rsp_fbit_set_0</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">LLC_PDU_IS_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_S</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_S_PF_IS_0</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_S_PDU_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">==</span> <span class="n">LLC_2_PDU_RSP_RNR</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_rnr_rsp_fbit_set_1</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">LLC_PDU_IS_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_S</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_S_PF_IS_1</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_S_PDU_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">==</span> <span class="n">LLC_2_PDU_RSP_RNR</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_rr_cmd_pbit_set_0</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">LLC_PDU_IS_CMD</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_S</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_S_PF_IS_0</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_S_PDU_CMD</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">==</span> <span class="n">LLC_2_PDU_CMD_RR</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_rr_cmd_pbit_set_1</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">LLC_PDU_IS_CMD</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_S</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_S_PF_IS_1</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_S_PDU_CMD</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">==</span> <span class="n">LLC_2_PDU_CMD_RR</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_rr_rsp_fbit_set_0</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">llc_conn_space</span><span class="p">(</span><span class="n">sk</span><span class="p">,</span> <span class="n">skb</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_PDU_IS_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_S</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_S_PF_IS_0</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_S_PDU_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">==</span> <span class="n">LLC_2_PDU_RSP_RR</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_rr_rsp_fbit_set_1</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">llc_conn_space</span><span class="p">(</span><span class="n">sk</span><span class="p">,</span> <span class="n">skb</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_PDU_IS_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_S</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_S_PF_IS_1</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_S_PDU_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">==</span> <span class="n">LLC_2_PDU_RSP_RR</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_sabme_cmd_pbit_set_x</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_un</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_un_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">LLC_PDU_IS_CMD</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_U</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_U_PDU_CMD</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">==</span> <span class="n">LLC_2_PDU_CMD_SABME</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_ua_rsp_fbit_set_x</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">llc_pdu_un</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_un_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">LLC_PDU_IS_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_PDU_TYPE_IS_U</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	       <span class="n">LLC_U_PDU_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">==</span> <span class="n">LLC_2_PDU_RSP_UA</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_xxx_cmd_pbit_set_1</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u16</span> <span class="n">rc</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">LLC_PDU_IS_CMD</span><span class="p">(</span><span class="n">pdu</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">LLC_PDU_TYPE_IS_I</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">||</span> <span class="n">LLC_PDU_TYPE_IS_S</span><span class="p">(</span><span class="n">pdu</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">LLC_I_PF_IS_1</span><span class="p">(</span><span class="n">pdu</span><span class="p">))</span>
				<span class="n">rc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">LLC_PDU_TYPE_IS_U</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">LLC_U_PF_IS_1</span><span class="p">(</span><span class="n">pdu</span><span class="p">))</span>
			<span class="n">rc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">rc</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_xxx_cmd_pbit_set_x</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u16</span> <span class="n">rc</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_un</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_un_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">LLC_PDU_IS_CMD</span><span class="p">(</span><span class="n">pdu</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">LLC_PDU_TYPE_IS_I</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">||</span> <span class="n">LLC_PDU_TYPE_IS_S</span><span class="p">(</span><span class="n">pdu</span><span class="p">))</span>
			<span class="n">rc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">LLC_PDU_TYPE_IS_U</span><span class="p">(</span><span class="n">pdu</span><span class="p">))</span>
			<span class="k">switch</span> <span class="p">(</span><span class="n">LLC_U_PDU_CMD</span><span class="p">(</span><span class="n">pdu</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">case</span> <span class="n">LLC_2_PDU_CMD_SABME</span>:
			<span class="k">case</span> <span class="n">LLC_2_PDU_CMD_DISC</span>:
				<span class="n">rc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">rc</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_xxx_rsp_fbit_set_x</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u16</span> <span class="n">rc</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_un</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_un_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">LLC_PDU_IS_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">LLC_PDU_TYPE_IS_I</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">||</span> <span class="n">LLC_PDU_TYPE_IS_S</span><span class="p">(</span><span class="n">pdu</span><span class="p">))</span>
			<span class="n">rc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">LLC_PDU_TYPE_IS_U</span><span class="p">(</span><span class="n">pdu</span><span class="p">))</span>
			<span class="k">switch</span> <span class="p">(</span><span class="n">LLC_U_PDU_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">case</span> <span class="n">LLC_2_PDU_RSP_UA</span>:
			<span class="k">case</span> <span class="n">LLC_2_PDU_RSP_DM</span>:
			<span class="k">case</span> <span class="n">LLC_2_PDU_RSP_FRMR</span>:
				<span class="n">rc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="n">rc</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_zzz_cmd_pbit_set_x_inval_nr</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span>
					       <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u16</span> <span class="n">rc</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">u8</span> <span class="n">vs</span> <span class="o">=</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">vS</span><span class="p">;</span>
	<span class="k">const</span> <span class="n">u8</span> <span class="n">nr</span> <span class="o">=</span> <span class="n">LLC_I_GET_NR</span><span class="p">(</span><span class="n">pdu</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">LLC_PDU_IS_CMD</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	    <span class="p">(</span><span class="n">LLC_PDU_TYPE_IS_I</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">||</span> <span class="n">LLC_PDU_TYPE_IS_S</span><span class="p">(</span><span class="n">pdu</span><span class="p">))</span> <span class="o">&amp;&amp;</span>
	    <span class="n">nr</span> <span class="o">!=</span> <span class="n">vs</span> <span class="o">&amp;&amp;</span> <span class="n">llc_util_nr_inside_tx_window</span><span class="p">(</span><span class="n">sk</span><span class="p">,</span> <span class="n">nr</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">dprintk</span><span class="p">(</span><span class="s">&quot;%s: matched, state=%d, vs=%d, nr=%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
			<span class="n">__func__</span><span class="p">,</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">state</span><span class="p">,</span> <span class="n">vs</span><span class="p">,</span> <span class="n">nr</span><span class="p">);</span>
		<span class="n">rc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">rc</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_zzz_rsp_fbit_set_x_inval_nr</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span>
					       <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u16</span> <span class="n">rc</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_pdu_sn</span> <span class="o">*</span><span class="n">pdu</span> <span class="o">=</span> <span class="n">llc_pdu_sn_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">u8</span> <span class="n">vs</span> <span class="o">=</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">vS</span><span class="p">;</span>
	<span class="k">const</span> <span class="n">u8</span> <span class="n">nr</span> <span class="o">=</span> <span class="n">LLC_I_GET_NR</span><span class="p">(</span><span class="n">pdu</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">LLC_PDU_IS_RSP</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	    <span class="p">(</span><span class="n">LLC_PDU_TYPE_IS_I</span><span class="p">(</span><span class="n">pdu</span><span class="p">)</span> <span class="o">||</span> <span class="n">LLC_PDU_TYPE_IS_S</span><span class="p">(</span><span class="n">pdu</span><span class="p">))</span> <span class="o">&amp;&amp;</span>
	    <span class="n">nr</span> <span class="o">!=</span> <span class="n">vs</span> <span class="o">&amp;&amp;</span> <span class="n">llc_util_nr_inside_tx_window</span><span class="p">(</span><span class="n">sk</span><span class="p">,</span> <span class="n">nr</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">rc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">dprintk</span><span class="p">(</span><span class="s">&quot;%s: matched, state=%d, vs=%d, nr=%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
			<span class="n">__func__</span><span class="p">,</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">state</span><span class="p">,</span> <span class="n">vs</span><span class="p">,</span> <span class="n">nr</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">rc</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rx_any_frame</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_p_tmr_exp</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_conn_state_ev</span> <span class="o">*</span><span class="n">ev</span> <span class="o">=</span> <span class="n">llc_conn_ev</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">ev</span><span class="o">-&gt;</span><span class="n">type</span> <span class="o">!=</span> <span class="n">LLC_CONN_EV_TYPE_P_TMR</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_ack_tmr_exp</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_conn_state_ev</span> <span class="o">*</span><span class="n">ev</span> <span class="o">=</span> <span class="n">llc_conn_ev</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">ev</span><span class="o">-&gt;</span><span class="n">type</span> <span class="o">!=</span> <span class="n">LLC_CONN_EV_TYPE_ACK_TMR</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_rej_tmr_exp</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_conn_state_ev</span> <span class="o">*</span><span class="n">ev</span> <span class="o">=</span> <span class="n">llc_conn_ev</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">ev</span><span class="o">-&gt;</span><span class="n">type</span> <span class="o">!=</span> <span class="n">LLC_CONN_EV_TYPE_REJ_TMR</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_busy_tmr_exp</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_conn_state_ev</span> <span class="o">*</span><span class="n">ev</span> <span class="o">=</span> <span class="n">llc_conn_ev</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">ev</span><span class="o">-&gt;</span><span class="n">type</span> <span class="o">!=</span> <span class="n">LLC_CONN_EV_TYPE_BUSY_TMR</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_init_p_f_cycle</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_tx_buffer_full</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">llc_conn_state_ev</span> <span class="o">*</span><span class="n">ev</span> <span class="o">=</span> <span class="n">llc_conn_ev</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">ev</span><span class="o">-&gt;</span><span class="n">type</span> <span class="o">==</span> <span class="n">LLC_CONN_EV_TYPE_SIMPLE</span> <span class="o">&amp;&amp;</span>
	       <span class="n">ev</span><span class="o">-&gt;</span><span class="n">prim_type</span> <span class="o">==</span> <span class="n">LLC_CONN_EV_TX_BUFF_FULL</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* Event qualifier functions</span>
<span class="cm"> *</span>
<span class="cm"> * these functions simply verify the value of a state flag associated with</span>
<span class="cm"> * the connection and return either a 0 for success or a non-zero value</span>
<span class="cm"> * for not-success; verify the event is the type we expect</span>
<span class="cm"> */</span>
<span class="kt">int</span> <span class="nf">llc_conn_ev_qlfy_data_flag_eq_1</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">data_flag</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_qlfy_data_flag_eq_0</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">data_flag</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_qlfy_data_flag_eq_2</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">data_flag</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_qlfy_p_flag_eq_1</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">p_flag</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> *	conn_ev_qlfy_last_frame_eq_1 - checks if frame is last in tx window</span>
<span class="cm"> *	@sk: current connection structure.</span>
<span class="cm"> *	@skb: current event.</span>
<span class="cm"> *</span>
<span class="cm"> *	This function determines when frame which is sent, is last frame of</span>
<span class="cm"> *	transmit window, if it is then this function return zero else return</span>
<span class="cm"> *	one.  This function is used for sending last frame of transmit window</span>
<span class="cm"> *	as I-format command with p-bit set to one. Returns 0 if frame is last</span>
<span class="cm"> *	frame, 1 otherwise.</span>
<span class="cm"> */</span>
<span class="kt">int</span> <span class="nf">llc_conn_ev_qlfy_last_frame_eq_1</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="o">!</span><span class="p">(</span><span class="n">skb_queue_len</span><span class="p">(</span><span class="o">&amp;</span><span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">pdu_unack_q</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">k</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> *	conn_ev_qlfy_last_frame_eq_0 - checks if frame isn&#39;t last in tx window</span>
<span class="cm"> *	@sk: current connection structure.</span>
<span class="cm"> *	@skb: current event.</span>
<span class="cm"> *</span>
<span class="cm"> *	This function determines when frame which is sent, isn&#39;t last frame of</span>
<span class="cm"> *	transmit window, if it isn&#39;t then this function return zero else return</span>
<span class="cm"> *	one. Returns 0 if frame isn&#39;t last frame, 1 otherwise.</span>
<span class="cm"> */</span>
<span class="kt">int</span> <span class="nf">llc_conn_ev_qlfy_last_frame_eq_0</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">skb_queue_len</span><span class="p">(</span><span class="o">&amp;</span><span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">pdu_unack_q</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">k</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_qlfy_p_flag_eq_0</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">p_flag</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_qlfy_p_flag_eq_f</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u8</span> <span class="n">f_bit</span><span class="p">;</span>

	<span class="n">llc_pdu_decode_pf_bit</span><span class="p">(</span><span class="n">skb</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">f_bit</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">p_flag</span> <span class="o">==</span> <span class="n">f_bit</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_qlfy_remote_busy_eq_0</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">remote_busy_flag</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_qlfy_remote_busy_eq_1</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="o">!</span><span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">remote_busy_flag</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_qlfy_retry_cnt_lt_n2</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="o">!</span><span class="p">(</span><span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">retry_count</span> <span class="o">&lt;</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">n2</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_qlfy_retry_cnt_gte_n2</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="o">!</span><span class="p">(</span><span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">retry_count</span> <span class="o">&gt;=</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">n2</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_qlfy_s_flag_eq_1</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="o">!</span><span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">s_flag</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_qlfy_s_flag_eq_0</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">s_flag</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_qlfy_cause_flag_eq_1</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="o">!</span><span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">cause_flag</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_qlfy_cause_flag_eq_0</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">llc_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">cause_flag</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_qlfy_set_status_conn</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">llc_conn_state_ev</span> <span class="o">*</span><span class="n">ev</span> <span class="o">=</span> <span class="n">llc_conn_ev</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="n">ev</span><span class="o">-&gt;</span><span class="n">status</span> <span class="o">=</span> <span class="n">LLC_STATUS_CONN</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_qlfy_set_status_disc</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">llc_conn_state_ev</span> <span class="o">*</span><span class="n">ev</span> <span class="o">=</span> <span class="n">llc_conn_ev</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="n">ev</span><span class="o">-&gt;</span><span class="n">status</span> <span class="o">=</span> <span class="n">LLC_STATUS_DISC</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_qlfy_set_status_failed</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">llc_conn_state_ev</span> <span class="o">*</span><span class="n">ev</span> <span class="o">=</span> <span class="n">llc_conn_ev</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="n">ev</span><span class="o">-&gt;</span><span class="n">status</span> <span class="o">=</span> <span class="n">LLC_STATUS_FAILED</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_qlfy_set_status_remote_busy</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span>
					    <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">llc_conn_state_ev</span> <span class="o">*</span><span class="n">ev</span> <span class="o">=</span> <span class="n">llc_conn_ev</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="n">ev</span><span class="o">-&gt;</span><span class="n">status</span> <span class="o">=</span> <span class="n">LLC_STATUS_REMOTE_BUSY</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_qlfy_set_status_refuse</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">llc_conn_state_ev</span> <span class="o">*</span><span class="n">ev</span> <span class="o">=</span> <span class="n">llc_conn_ev</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="n">ev</span><span class="o">-&gt;</span><span class="n">status</span> <span class="o">=</span> <span class="n">LLC_STATUS_REFUSE</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_qlfy_set_status_conflict</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">llc_conn_state_ev</span> <span class="o">*</span><span class="n">ev</span> <span class="o">=</span> <span class="n">llc_conn_ev</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="n">ev</span><span class="o">-&gt;</span><span class="n">status</span> <span class="o">=</span> <span class="n">LLC_STATUS_CONFLICT</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">llc_conn_ev_qlfy_set_status_rst_done</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">llc_conn_state_ev</span> <span class="o">*</span><span class="n">ev</span> <span class="o">=</span> <span class="n">llc_conn_ev</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="n">ev</span><span class="o">-&gt;</span><span class="n">status</span> <span class="o">=</span> <span class="n">LLC_STATUS_RESET_DONE</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
