f | trans_fd.c | s | 23K | 908 | Eric Dumazet | eric.dumazet@gmail.com | 1334508280 |  | net: cleanup unsigned to unsigned int  Use of "unsigned int" is preferred to bare "unsigned" in net tree.  Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | protocol.h | s | 1.3K | 33 | Aneesh Kumar K.V | aneesh.kumar@linux.vnet.ibm.com | 1319472792 |  | net/9p: Convert net/9p protocol dumps to tracepoints  This helps in more control over debugging. root@qemu-img-64:~# ls /pass/123 ls: cannot access /pass/123: No such file or directory root@qemu-img-64:~# cat /sys/kernel/debug/tracing/trace # tracer: nop # #           TASK-PID    CPU#    TIMESTAMP  FUNCTION #              || ||       ||          ||         ||               ls-1536  [001]    70.928584: 9p_protocol_dump: clnt 18446612132784021504 P9_TWALK(tag = 1) 000: 16 00 00 00 6e 01 00 01 00 00 00 02 00 00 00 01 010: 00 03 00 31 32 33 00 00 00 ff ff ff ff 00 00 00                ls-1536  [001]    70.928587: <stack trace>  => trace_9p_protocol_dump  => p9pdu_finalize  => p9_client_rpc  => p9_client_walk  => v9fs_vfs_lookup  => d_alloc_and_lookup  => walk_component  => path_lookupat               ls-1536  [000]    70.929696: 9p_protocol_dump: clnt 18446612132784021504 P9_RLERROR(tag = 1) 000: 0b 00 00 00 07 01 00 02 00 00 00 4e 03 00 02 00 010: 00 00 00 00 03 00 02 00 00 00 00 00 ff 43 00 00                ls-1536  [000]    70.929697: <stack trace>  => trace_9p_protocol_dump  => p9_client_rpc  => p9_client_walk  => v9fs_vfs_lookup  => d_alloc_and_lookup  => walk_component  => path_lookupat  => do_path_lookup  Signed-off-by: Aneesh Kumar K.V <aneesh.kumar@linux.vnet.ibm.com> Signed-off-by: Eric Van Hensbergen <ericvh@gmail.com>
f | util.c | s | 3.3K | 122 | Joe Perches | joe@perches.com | 1325782304 |  | 9p: Reduce object size with CONFIG_NET_9P_DEBUG  Reduce object size by deduplicating formats.  Use vsprintf extension %pV. Rename P9_DPRINTK uses to p9_debug, align arguments. Add function for _p9_debug and macro to add __func__. Add missing "\n"s to p9_debug uses. Remove embedded function names as p9_debug adds it. Remove P9_EPRINTK macro and convert use to pr_<level>. Add and use pr_fmt and pr_<level>.  $ size fs/9p/built-in.o*    text	   data	    bss	    dec	    hex	filename   62133	    984	  16000	  79117	  1350d	fs/9p/built-in.o.new   67342	    984	  16928	  85254	  14d06	fs/9p/built-in.o.old $ size net/9p/built-in.o*    text	   data	    bss	    dec	    hex	filename   88792	   4148	  22024	 114964	  1c114	net/9p/built-in.o.new   94072	   4148	  23232	 121452	  1da6c	net/9p/built-in.o.old  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: Eric Van Hensbergen <ericvh@gmail.com>
f | Makefile | g | 305B |  | Venkateswararao Jujjuri (JV) | jvrao@linux.vnet.ibm.com | 1300201054 |  | [net/9p] Preparation and helper functions for zero copy  This patch prepares p9_fcall structure for zero copy. Added fields send the payload buffer information to the transport layer. In addition it adds a 'private' field for the transport layer to store mapped/pinned page information so that it can be freed/unpinned during req_done.  This patch also creates trans_common.[ch] to house helper functions. It adds the following helper functions.  p9_release_req_pages - Release pages after the transaction. p9_nr_pages - Return number of pages needed to accomodate the payload. payload_gup - Translates user buffer into kernel pages.  Signed-off-by: Venkateswararao Jujjuri <jvrao@linux.vnet.ibm.com> Signed-off-by: Eric Van Hensbergen <ericvh@gmail.com>
f | protocol.c | s | 12K | 538 | Dan Carpenter | dan.carpenter@oracle.com | 1340835984 |  | 9p: fix min_t() casting in p9pdu_vwritef()  I don't think we're actually likely to hit this limit but if we do then the comparison should be done as size_t.  The original code is equivalent to:         len = strlen(sptr) % USHRT_MAX;  Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | trans_rdma.c | s | 17K | 629 | Joe Perches | joe@perches.com | 1325782304 |  | 9p: Reduce object size with CONFIG_NET_9P_DEBUG  Reduce object size by deduplicating formats.  Use vsprintf extension %pV. Rename P9_DPRINTK uses to p9_debug, align arguments. Add function for _p9_debug and macro to add __func__. Add missing "\n"s to p9_debug uses. Remove embedded function names as p9_debug adds it. Remove P9_EPRINTK macro and convert use to pr_<level>. Add and use pr_fmt and pr_<level>.  $ size fs/9p/built-in.o*    text	   data	    bss	    dec	    hex	filename   62133	    984	  16000	  79117	  1350d	fs/9p/built-in.o.new   67342	    984	  16928	  85254	  14d06	fs/9p/built-in.o.old $ size net/9p/built-in.o*    text	   data	    bss	    dec	    hex	filename   88792	   4148	  22024	 114964	  1c114	net/9p/built-in.o.new   94072	   4148	  23232	 121452	  1da6c	net/9p/built-in.o.old  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: Eric Van Hensbergen <ericvh@gmail.com>
f | trans_common.c | s | 2.0K | 62 | Aneesh Kumar K.V | aneesh.kumar@linux.vnet.ibm.com | 1319472791 |  | fs/9p: Update zero-copy implementation in 9p  * remove lot of update to different data structure * add a seperate callback for zero copy request. * above makes non zero copy code path simpler * remove conditionalizing TREAD/TREADDIR/TWRITE in the zero copy path * Fix the dotu p9_check_errors with zero copy. Add sufficient doc around * Add support for both in and output buffers in zero copy callback * pin and unpin pages in the same context * use helpers instead of defining page offset and rest of page ourself * Fix mem leak in p9_check_errors * Remove 'E' and 'F' in p9pdu_vwritef  Signed-off-by: Aneesh Kumar K.V <aneesh.kumar@linux.vnet.ibm.com> Signed-off-by: Eric Van Hensbergen <ericvh@gmail.com>
f | error.c | s | 7.4K | 233 | Joe Perches | joe@perches.com | 1325782304 |  | 9p: Reduce object size with CONFIG_NET_9P_DEBUG  Reduce object size by deduplicating formats.  Use vsprintf extension %pV. Rename P9_DPRINTK uses to p9_debug, align arguments. Add function for _p9_debug and macro to add __func__. Add missing "\n"s to p9_debug uses. Remove embedded function names as p9_debug adds it. Remove P9_EPRINTK macro and convert use to pr_<level>. Add and use pr_fmt and pr_<level>.  $ size fs/9p/built-in.o*    text	   data	    bss	    dec	    hex	filename   62133	    984	  16000	  79117	  1350d	fs/9p/built-in.o.new   67342	    984	  16928	  85254	  14d06	fs/9p/built-in.o.old $ size net/9p/built-in.o*    text	   data	    bss	    dec	    hex	filename   88792	   4148	  22024	 114964	  1c114	net/9p/built-in.o.new   94072	   4148	  23232	 121452	  1da6c	net/9p/built-in.o.old  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: Eric Van Hensbergen <ericvh@gmail.com>
f | trans_virtio.c | s | 17K | 615 | Sasha Levin | levinsasha928@gmail.com | 1339428547 |  | 9p: BUG before corrupting memory  The BUG_ON() in pack_sg_list() would get triggered only one time after we've corrupted some memory by sg_set_buf() into an invalid sg buffer.  I'm still working on figuring out why I manage to trigger that bug...  Signed-off-by: Sasha Levin <levinsasha928@gmail.com> Signed-off-by: Eric Van Hensbergen <ericvh@gmail.com>
f | mod.c | s | 4.3K | 169 | Joe Perches | joe@perches.com | 1325782304 |  | 9p: Reduce object size with CONFIG_NET_9P_DEBUG  Reduce object size by deduplicating formats.  Use vsprintf extension %pV. Rename P9_DPRINTK uses to p9_debug, align arguments. Add function for _p9_debug and macro to add __func__. Add missing "\n"s to p9_debug uses. Remove embedded function names as p9_debug adds it. Remove P9_EPRINTK macro and convert use to pr_<level>. Add and use pr_fmt and pr_<level>.  $ size fs/9p/built-in.o*    text	   data	    bss	    dec	    hex	filename   62133	    984	  16000	  79117	  1350d	fs/9p/built-in.o.new   67342	    984	  16928	  85254	  14d06	fs/9p/built-in.o.old $ size net/9p/built-in.o*    text	   data	    bss	    dec	    hex	filename   88792	   4148	  22024	 114964	  1c114	net/9p/built-in.o.new   94072	   4148	  23232	 121452	  1da6c	net/9p/built-in.o.old  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: Eric Van Hensbergen <ericvh@gmail.com>
f | trans_common.h | s | 632B | 16 | Aneesh Kumar K.V | aneesh.kumar@linux.vnet.ibm.com | 1319472791 |  | fs/9p: Update zero-copy implementation in 9p  * remove lot of update to different data structure * add a seperate callback for zero copy request. * above makes non zero copy code path simpler * remove conditionalizing TREAD/TREADDIR/TWRITE in the zero copy path * Fix the dotu p9_check_errors with zero copy. Add sufficient doc around * Add support for both in and output buffers in zero copy callback * pin and unpin pages in the same context * use helpers instead of defining page offset and rest of page ourself * Fix mem leak in p9_check_errors * Remove 'E' and 'F' in p9pdu_vwritef  Signed-off-by: Aneesh Kumar K.V <aneesh.kumar@linux.vnet.ibm.com> Signed-off-by: Eric Van Hensbergen <ericvh@gmail.com>
f | Kconfig | g | 804B |  | Eric Van Hensbergen | ericvh@gmail.com | 1306331198 |  | 9p: remove experimental tag from tested configurations  The 9p client is currently undergoing regular regresssion and stress testing as a by-product of the virtfs work.  I think its finally time to take off the experimental tags from the well-tested code paths.  Signed-off-by: Eric Van Hensbergen <ericvh@gmail.com>
f | client.c | s | 51K | 1906 | Eric Dumazet | eric.dumazet@gmail.com | 1334508280 |  | net: cleanup unsigned to unsigned int  Use of "unsigned int" is preferred to bare "unsigned" in net tree.  Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
