f | masterkey_trusted.c | s | 1.3K | 43 | Mimi Zohar | zohar@linux.vnet.ibm.com | 1326843690 |  | encrypted-keys: fix rcu and sparse messages  Enabling CONFIG_PROVE_RCU and CONFIG_SPARSE_RCU_POINTER resulted in "suspicious rcu_dereference_check() usage!" and "incompatible types in comparison expression (different address spaces)" messages.  Access the masterkey directly when holding the rwsem.  Changelog v1: - Use either rcu_read_lock()/rcu_derefence_key()/rcu_read_unlock() or remove the unnecessary rcu_derefence() - David Howells  Reported-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com> Signed-off-by: Mimi Zohar <zohar@us.ibm.com> Signed-off-by: David Howells <dhowells@redhat.com> Signed-off-by: James Morris <jmorris@namei.org>
f | encrypted.h | s | 1.8K | 58 | Mimi Zohar | zohar@linux.vnet.ibm.com | 1321471394 |  | encrypted-keys: module build fixes  Encrypted keys are encrypted/decrypted using either a trusted or user-defined key type, which is referred to as the 'master' key. The master key may be of type trusted iff the trusted key is builtin or both the trusted key and encrypted keys are built as modules.  This patch resolves the build dependency problem.  - Use "masterkey-$(CONFIG_TRUSTED_KEYS)-$(CONFIG_ENCRYPTED_KEYS)" construct to encapsulate the above logic. (Suggested by Dimtry Kasatkin.) - Fixing the encrypted-keys Makefile, results in a module name change from encrypted.ko to encrypted-keys.ko. - Add module dependency for request_trusted_key() definition  Signed-off-by: Mimi Zohar <zohar@us.ibm.com>
f | Makefile | g | 324B |  | Mimi Zohar | zohar@linux.vnet.ibm.com | 1321471394 |  | encrypted-keys: module build fixes  Encrypted keys are encrypted/decrypted using either a trusted or user-defined key type, which is referred to as the 'master' key. The master key may be of type trusted iff the trusted key is builtin or both the trusted key and encrypted keys are built as modules.  This patch resolves the build dependency problem.  - Use "masterkey-$(CONFIG_TRUSTED_KEYS)-$(CONFIG_ENCRYPTED_KEYS)" construct to encapsulate the above logic. (Suggested by Dimtry Kasatkin.) - Fixing the encrypted-keys Makefile, results in a module name change from encrypted.ko to encrypted-keys.ko. - Add module dependency for request_trusted_key() definition  Signed-off-by: Mimi Zohar <zohar@us.ibm.com>
f | ecryptfs_format.h | s | 973B | 25 | Mimi Zohar | zohar@linux.vnet.ibm.com | 1316028146 |  | encrypted-keys: create encrypted-keys directory  Move all files associated with encrypted keys to keys/encrypted-keys.  Signed-off-by: Mimi Zohar <zohar@us.ibm.com>
f | encrypted.c | s | 25K | 897 | Mimi Zohar | zohar@linux.vnet.ibm.com | 1326843690 |  | encrypted-keys: fix rcu and sparse messages  Enabling CONFIG_PROVE_RCU and CONFIG_SPARSE_RCU_POINTER resulted in "suspicious rcu_dereference_check() usage!" and "incompatible types in comparison expression (different address spaces)" messages.  Access the masterkey directly when holding the rwsem.  Changelog v1: - Use either rcu_read_lock()/rcu_derefence_key()/rcu_read_unlock() or remove the unnecessary rcu_derefence() - David Howells  Reported-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com> Signed-off-by: Mimi Zohar <zohar@us.ibm.com> Signed-off-by: David Howells <dhowells@redhat.com> Signed-off-by: James Morris <jmorris@namei.org>
f | ecryptfs_format.c | s | 2.6K | 75 | Mimi Zohar | zohar@linux.vnet.ibm.com | 1316028146 |  | encrypted-keys: create encrypted-keys directory  Move all files associated with encrypted keys to keys/encrypted-keys.  Signed-off-by: Mimi Zohar <zohar@us.ibm.com>
