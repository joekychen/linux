d | evm |  | 7 items |  | James Morris | jmorris@namei.org | 1326071808 |  | Merge branch 'next' into for-linus  Conflicts: 	security/integrity/evm/evm_crypto.c  Resolved upstream fix vs. next conflict manually.  Signed-off-by: James Morris <jmorris@namei.org>
f | integrity.h | s | 1.8K | 58 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1326843987 |  | integrity: digital signature config option name change  Similar to SIGNATURE, rename INTEGRITY_DIGSIG to INTEGRITY_SIGNATURE.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com> Signed-off-by: James Morris <jmorris@namei.org>
f | Makefile | g | 301B |  | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1326843987 |  | integrity: digital signature config option name change  Similar to SIGNATURE, rename INTEGRITY_DIGSIG to INTEGRITY_SIGNATURE.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com> Signed-off-by: James Morris <jmorris@namei.org>
f | digsig.c | s | 1.1K | 40 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1320850269 |  | integrity: digital signature verification using multiple keyrings  Define separate keyrings for each of the different use cases - evm, ima, and modules. Using different keyrings improves search performance, and also allows "locking" specific keyring to prevent adding new keys. This is useful for evm and module keyrings, when keys are usually only added from initramfs.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
f | Kconfig | g | 695B |  | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1326843987 |  | integrity: digital signature config option name change  Similar to SIGNATURE, rename INTEGRITY_DIGSIG to INTEGRITY_SIGNATURE.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com> Signed-off-by: James Morris <jmorris@namei.org>
d | ima |  | 11 items |  | Mimi Zohar | zohar@us.ibm.com | 1337128601 |  | ima: fix filename hint to reflect script interpreter name  When IMA was first upstreamed, the bprm filename and interp were always the same.  Currently, the bprm->filename and bprm->interp are the same, except for when only bprm->interp contains the interpreter name.  So instead of using the bprm->filename as the IMA filename hint in the measurement list, we could replace it with bprm->interp, but this feels too fragil.  The following patch is not much better, but at least there is some indication that sometimes we're passing the filename and other times the interpreter name.  Reported-by: Andrew Lunn <andrew@lunn.ch> Signed-off-by: Mimi Zohar <zohar@linux.vnet.ibm.com> Signed-off-by: James Morris <james.l.morris@oracle.com>
f | iint.c | s | 3.8K | 144 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1316028292 |  | evm: clean verification status  When allocating from slab, initialization is done the first time in init_once() and subsequently on free.  Because evm_status was not re-initialized on free, evm_verify_hmac() skipped verifications.  This patch re-initializes evm_status.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com> Signed-off-by: Mimi Zohar <zohar@us.ibm.com>
