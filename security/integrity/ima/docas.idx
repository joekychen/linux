f | ima_policy.c | s | 12K | 437 | Eric Paris | eparis@redhat.com | 1329354102 |  | IMA: fix audit res field to indicate 1 for success and 0 for failure  The audit res field ususally indicates success with a 1 and 0 for a failure.  So make IMA do it the same way.  Signed-off-by: Eric Paris <eparis@redhat.com> Signed-off-by: Mimi Zohar <zohar@us.ibm.com> Signed-off-by: James Morris <jmorris@namei.org>
f | ima_api.c | s | 5.5K | 170 | Roberto Sassu | roberto.sassu@polito.it | 1324350272 |  | ima: free duplicate measurement memory  Info about new measurements are cached in the iint for performance.  When the inode is flushed from cache, the associated iint is flushed as well. Subsequent access to the inode will cause the inode to be re-measured and will attempt to add a duplicate entry to the measurement list.  This patch frees the duplicate measurement memory, fixing a memory leak.  Signed-off-by: Roberto Sassu <roberto.sassu@polito.it> Signed-off-by: Mimi Zohar <zohar@us.ibm.com> Cc: stable@vger.kernel.org
f | ima.h | s | 4.3K | 122 | James Morris | jmorris@namei.org | 1315612584 |  | integrity: sparse fix: move iint_initialized to integrity.h  Sparse fix: move iint_initialized to integrity.h  Signed-off-by: James Morris <jmorris@namei.org>
f | Makefile | g | 243B |  | Mimi Zohar | zohar@linux.vnet.ibm.com | 1311006578 |  | integrity: move ima inode integrity data management  Move the inode integrity data(iint) management up to the integrity directory in order to share the iint among the different integrity models.  Changelog: - don't define MAX_DIGEST_SIZE - rename several globally visible 'ima_' prefixed functions, structs,   locks, etc to 'integrity_' - replace '20' with SHA1_DIGEST_SIZE - reflect location change in appropriate Kconfig and Makefiles - remove unnecessary initialization of iint_initialized to 0 - rebased on current ima_iint.c - define integrity_iint_store/lock as static  There should be no other functional changes.  Signed-off-by: Mimi Zohar <zohar@us.ibm.com> Acked-by: Serge Hallyn <serge.hallyn@ubuntu.com>
f | ima_audit.c | s | 1.8K | 58 | Eric Paris | eparis@redhat.com | 1329354102 |  | IMA: fix audit res field to indicate 1 for success and 0 for failure  The audit res field ususally indicates success with a 1 and 0 for a failure.  So make IMA do it the same way.  Signed-off-by: Eric Paris <eparis@redhat.com> Signed-off-by: Mimi Zohar <zohar@us.ibm.com> Signed-off-by: James Morris <jmorris@namei.org>
f | ima_main.c | s | 5.8K | 210 | Mimi Zohar | zohar@us.ibm.com | 1337128601 |  | ima: fix filename hint to reflect script interpreter name  When IMA was first upstreamed, the bprm filename and interp were always the same.  Currently, the bprm->filename and bprm->interp are the same, except for when only bprm->interp contains the interpreter name.  So instead of using the bprm->filename as the IMA filename hint in the measurement list, we could replace it with bprm->interp, but this feels too fragil.  The following patch is not much better, but at least there is some indication that sometimes we're passing the filename and other times the interpreter name.  Reported-by: Andrew Lunn <andrew@lunn.ch> Signed-off-by: Mimi Zohar <zohar@linux.vnet.ibm.com> Signed-off-by: James Morris <james.l.morris@oracle.com>
f | ima_crypto.c | s | 2.9K | 127 | James Morris | jmorris@namei.org | 1273107367 |  | Merge branch 'master' into next
f | ima_init.c | s | 2.6K | 87 | James Morris | jmorris@namei.org | 1273107367 |  | Merge branch 'master' into next
f | ima_queue.c | s | 3.9K | 131 | Roberto Sassu | roberto.sassu@polito.it | 1324350474 |  | ima: fix invalid memory reference  Don't free a valid measurement entry on TPM PCR extend failure.  Signed-off-by: Roberto Sassu <roberto.sassu@polito.it> Signed-off-by: Mimi Zohar <zohar@us.ibm.com> Cc: stable@vger.kernel.org
f | Kconfig | g | 1.7K |  | Randy Dunlap | rdunlap@xenotime.net | 1330387275 |  | security: fix ima kconfig warning  Fix IMA kconfig warning on non-X86 architectures:  warning: (IMA) selects TCG_TIS which has unmet direct dependencies (TCG_TPM && X86)  Signed-off-by: Randy Dunlap <rdunlap@xenotime.net> Reported-by: Geert Uytterhoeven <geert@linux-m68k.org> Acked-by: Rajiv Andrade <srajiv@linux.vnet.ibm.com> Signed-off-by: James Morris <james.l.morris@oracle.com>
f | ima_fs.c | s | 9.3K | 328 | James Morris | jmorris@namei.org | 1315612589 |  | ima: sparse fix: make ima_open_policy static  Fixes sparse warning: security/integrity/ima/ima_fs.c:290:5: warning: symbol 'ima_open_policy' was not declared. Should it be static?  Signed-off-by: James Morris <jmorris@namei.org>
